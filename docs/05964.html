<html>
<head>
<title>Do This Additional Step, You Have Made A Generalize Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">做这个额外的步骤，你就做了一个一般化的机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/do-this-additional-step-you-have-made-a-generalize-machine-learning-model-9d85b7e09313?source=collection_archive---------57-----------------------#2020-05-15">https://towardsdatascience.com/do-this-additional-step-you-have-made-a-generalize-machine-learning-model-9d85b7e09313?source=collection_archive---------57-----------------------#2020-05-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f2c0ce505a88bd39480d0200a127aca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oyEEAx1t-pdzP-HEl9cXVQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Jukan Tateisi 在<a class="ae jg" href="https://unsplash.com/s/photos/step?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="5945" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">只是一个额外的步骤，它可以增加我们对预测未知数据的模型的信心。</h2></div><p id="86f8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想象一下，你正在做一些机器学习项目，并且你已经计算了指标。假设您的度量标准，在示例准确性中，大约是 90%，并且您已经基于 k 倍交叉验证计算了它。当您训练模型时，您通过拆分训练和测试数据来训练模型，因此您训练模型，然后使用我们制作的模型直接测试它。因为它不可推广，所以我们引入了 k 倍交叉验证的概念，这是通过 k 次对训练和测试数据进行不同的采样。由于使用了这种方法，模型开始变得更具普遍性，并在此基础上具有良好的准确性。</p><blockquote class="lu"><p id="7b7d" class="lv lw jj bd lx ly lz ma mb mc md lt dk translated">你确定吗？</p><p id="8ae6" class="lv lw jj bd lx ly lz ma mb mc md lt dk translated">模型如何处理不存在的看不见的数据呢？</p><p id="01be" class="lv lw jj bd lx ly lz ma mb mc md lt dk translated">如果模型是基于交叉验证分数而不是基于看不见的数据那么好呢？</p></blockquote><p id="b8a4" class="pw-post-body-paragraph ky kz jj la b lb me kk ld le mf kn lg lh mg lj lk ll mh ln lo lp mi lr ls lt im bi translated">这就是<strong class="la jk">保留数据集</strong>概念的由来。什么是拒绝数据集？保留数据集是在我们使用交叉验证时不用于训练模型的数据集。因此，不用于交叉验证的数据集将成为看不见的数据。因此，这个数据集将增加我们的信心，证明我们的模型可以准确地预测看不见的数据，也更具普遍性。</p><figure class="mk ml mm mn gt iv gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/20cd77ea93019d097fed3b982cd78f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*9cF8wnU1WNNhctRhmylITA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">交叉验证和保留数据集的图示</p></figure><p id="a638" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据这个定义，我们知道拒绝数据集是我们分割的数据，这样一个可以用于交叉验证，然后另一个可以用作看不见的数据。现在的问题是我们如何在我们的模型上应用这个概念？我已经有了一个例子，我将向您展示如何使用 Python 应用保留数据集概念。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="73df" class="mv mw jj bd mx my mz na nb nc nd ne nf kp ng kq nh ks ni kt nj kv nk kw nl nm bi translated">履行</h1><p id="d721" class="pw-post-body-paragraph ky kz jj la b lb nn kk ld le no kn lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">第一步是将数据拆分为训练和测试数据。训练数据将被用于交叉验证，而测试数据将被用作看不见的数据。然后，拆分数据后，我们可以对训练数据进行交叉验证，您可以调整想要使用的 k 值。最后，我们可以对看不见的数据进行预测，我们可以看到模型的得分。执行这些操作的代码如下所示，</p><pre class="mk ml mm mn gt ns nt nu nv aw nw bi"><span id="41fa" class="nx mw jj nt b gy ny nz l oa ob">from sklearn.tree import DecisionTreeClassifier, plot_tree<br/>from sklearn.pipeline import make_pipeline<br/>from sklearn.model_selection import GridSearchCV, train_test_split<br/>from sklearn.metrics import classification_report, confusion_matrix</span><span id="96c5" class="nx mw jj nt b gy oc nz l oa ob"><strong class="nt jk"># Split the X and Y</strong><br/>X = df_preprocessed.drop(default, axis = 1).values<br/>y = df_preprocessed[default].values</span><span id="f1c9" class="nx mw jj nt b gy oc nz l oa ob"><strong class="nt jk"># Split the dataset for cross validation and unseen data</strong><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42, stratify=y)</span><span id="eef5" class="nx mw jj nt b gy oc nz l oa ob"><strong class="nt jk"># Doing Hyperparameter Tuning and Cross Validation without the <br/># unseen data using Decision Tree. Then, fit the model on it</strong><br/>param_grid = {<br/>    'max_depth': [i for i in range(3, 10, 2)]<br/>}<br/>dt = DecisionTreeClassifier(random_state=42)<br/>clf = GridSearchCV(dt, param_grid, cv=5)<br/>clf.fit(X_train, y_train)</span><span id="1c14" class="nx mw jj nt b gy oc nz l oa ob"><strong class="nt jk"># Predict the unseen data and print the score<br/></strong>y_pred = clf.predict(X_test)<br/>clf.score(X_test, y_test)<br/>classification_report(y_test, y_pred)</span></pre><p id="c5d8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">基于上面的实现，我在测试数据上获得了大约 88.3%的准确率。这意味着该模型得分很高，能够处理看不见的数据。此外，当我们使用 classification_report 函数创建分类报告时，结果如下所示:</p><figure class="mk ml mm mn gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7705da237f7dd544c397b945e8a773a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*0SE1Hnp9bzNh0_idSIjotw.png"/></div></figure><p id="46ba" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们要预测的主要标签是 1，它有 92%的准确率和 71%的召回率。该模型还可以通过调整超参数以及进行一些特征选择和工程来改进。如果你想看看我在这方面的工作，你可以在这里看到我的 GitHub<a class="ae jg" href="https://github.com/khalidmeister/my-projects/blob/master/DS2_Credit%20Default%20Prediction%20(DAC%20ITS)/Credit%20Default%20Prediction.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="la jk"/></a>。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="6258" class="mv mw jj bd mx my mz na nb nc nd ne nf kp ng kq nh ks ni kt nj kv nk kw nl nm bi translated">结论</h1><p id="10ce" class="pw-post-body-paragraph ky kz jj la b lb nn kk ld le no kn lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">如你所知，拥有一个可概括的模型非常重要，因为我们将预测以前从未存在过的数据。通过执行这一额外的步骤，即拆分数据以进行交叉验证和保留，也许我们的模型没有任何改进，但我们可以增加我们的信心，即我们的模型可以通过使用这些数据来准确预测未知的数据。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h2 id="47df" class="nx mw jj bd mx oe of dn nb og oh dp nf lh oi oj nh ll ok ol nj lp om on nl oo bi translated">感谢您阅读我的文章，您也可以在下面查看我以前的文章:</h2><div class="is it gp gr iu op"><a rel="noopener follow" target="_blank" href="/greater-accuracy-does-not-mean-greater-machine-learning-model-performance-771222345e61"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jk gy z fp ou fr fs ov fu fw ji bi translated">更高的准确性并不意味着更好的机器学习模型性能</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">我们可以定量地衡量机器学习模型的性能，但不仅仅是准确性，还有很多…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ja op"/></div></div></a></div><div class="is it gp gr iu op"><a rel="noopener follow" target="_blank" href="/this-is-how-i-will-learn-data-science-if-i-got-back-my-own-time-e9148c909ce9"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jk gy z fp ou fr fs ov fu fw ji bi translated">如果我有自己的时间，我会这样学习数据科学</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">感觉不知所措和筋疲力尽让我在释放数据科学技能方面表现不佳。这个…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd ja op"/></div></div></a></div></div></div>    
</body>
</html>