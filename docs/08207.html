<html>
<head>
<title>DeepDow — Portfolio optimization with deep learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DeepDow —深度学习的投资组合优化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deepdow-portfolio-optimization-with-deep-learning-a3ffdf36eb00?source=collection_archive---------19-----------------------#2020-06-16">https://towardsdatascience.com/deepdow-portfolio-optimization-with-deep-learning-a3ffdf36eb00?source=collection_archive---------19-----------------------#2020-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6096d6ddbaf8f25a81f919b6c5bf5051.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*GLa6DT216UZ7gwJX.png"/></div></figure><p id="6882" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://github.com/jankrepl/deepdow" rel="noopener ugc nofollow" target="_blank"> DeepDow </a>是一个 Python 包，专注于在单次正向传递中执行资产分配的神经网络。</p><h1 id="e94f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">单前锋传球？</h1><p id="48b7" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">投资组合优化传统上是一个两步程序:</p><ol class=""><li id="e0dc" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mb mc md me bi translated">建立对证券未来表现的信念</li><li id="175d" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mb mc md me bi translated">根据这些信念寻找最优投资组合</li></ol><p id="9350" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">两步程序的一个臭名昭著的例子(受 Markowitz 启发)是</p><ol class=""><li id="3a1a" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mb mc md me bi translated">预期收益估计<strong class="jw ir"> μ </strong>和协方差矩阵<strong class="jw ir">σ</strong></li><li id="3f95" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mb mc md me bi translated">求解凸优化问题</li></ol><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/b5606aa64a2817ed11eced291f70aff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/0*hsSaG9-azxcGAO03.png"/></div></figure><p id="4c09" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通常，这两个步骤是完全分开的，因为它们需要不同的方法和不同的软件。</p><p id="9204" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><code class="fe mp mq mr ms b">deepdow</code>绝对抛弃这种范式。它力求将上述两个步骤合二为一。基本思想是构建端到端的深度网络，输入最原始的特征(回报、交易量……)并输出资产配置。这种方法有多种好处:</p><ul class=""><li id="1531" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mt mc md me bi translated">超参数可以变成可训练的重量(即第二阶段的𝛾)</li><li id="e2d8" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">利用深度学习提取有用的特征进行分配，不需要技术指标</li><li id="f32c" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">单一损失函数</li></ul><h1 id="a13a" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">核心理念</h1><p id="3408" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">金融时间序列可以被视为一个三维张量，具有以下维度</p><ul class=""><li id="e18f" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mt mc md me bi translated">时间</li><li id="d3f1" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">资产</li><li id="089a" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">指示器/通道</li></ul><p id="4168" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">举一个具体的例子，我们可以研究多个纳斯达克股票(资产维度)的每日(时间维度)开盘价回报、收盘价回报和交易量(渠道维度)。形象地说，人们可以想象</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/31fc4dc79377297012bb367571c3165e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fog7Rr1mQ5b_JKRc.png"/></div></div></figure><p id="fd6d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过固定一个时间步长(代表现在)，我们可以将张量分成 3 个不相交的子张量</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/e1e8f0cd24e73ebd70610d8832026dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jgL6zks4FG8KWO9Q.png"/></div></div></figure><p id="fbf0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，<strong class="jw ir"> x </strong>代表所有关于过去和现在的知识。第二个张量<strong class="jw ir"> g </strong>代表包含在不久的将来的信息，我们不能用它来做投资决策。最后，<strong class="jw ir"> y </strong>是市场的未来演变。现在可以沿着时间维度移动，并在每个时间步长应用相同的分解。这种生成数据集的方法称为滚动窗口。</p><p id="78db" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们关注一种特殊类型的神经网络，它输入<strong class="jw ir"> x </strong>并返回所有资产的单个权重分配<strong class="jw ir"> w </strong>，使得它们的总和为 1。换句话说，根据我们过去的知识,<strong class="jw ir"> x </strong>我们构建了一个投资组合,<strong class="jw ir"> w </strong>我们立即买入并持有一段时间。设<strong class="jw ir"> F </strong>是带有参数𝜃的神经网络，下图代表高级预测管道。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mz"><img src="../Images/b2fd157653b97df050dcf5f2baa6a0b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TElLrb78NWFd3ej3aGW5ag.png"/></div></div></figure><p id="56eb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">难题的最后一块是损失函数的定义。在最一般的术语中，每样本损失<strong class="jw ir"> L </strong>是输入<strong class="jw ir"> w </strong>和<strong class="jw ir"> y </strong>并输出实数的任何函数。然而，在大多数情况下，我们首先计算投资组合在时间范围内每个时间步的回报率<strong class="jw ir"> r </strong>，然后应用一些汇总函数<strong class="jw ir"> S </strong>如均值、标准差等。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/8a25aa303f6c9f245b3d0bf657b72d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kb4MSFYc4gx12hgB.png"/></div></div></figure><h1 id="4fa3" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">网络层</h1><p id="9464" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">好吧，但是我们如何构建这样的网络呢？不是硬编码一个单一的架构<code class="fe mp mq mr ms b">deepdow</code>实现强大的构建块(层),用户可以自己组装。两个最重要的图层组是</p><h2 id="5b6b" class="na ku iq bd kv nb nc dn kz nd ne dp ld kf nf ng lh kj nh ni ll kn nj nk lp nl bi translated">变形层</h2><p id="4a32" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">目标是从输入中提取特征。</p><ul class=""><li id="4978" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mt mc md me bi translated">RNN</li><li id="9768" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">1D 卷积</li><li id="4dc3" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">时间扭曲</li><li id="3dbe" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi">…</li></ul><h2 id="1d15" class="na ku iq bd kv nb nc dn kz nd ne dp ld kf nf ng lh kj nh ni ll kn nj nk lp nl bi translated">分配层</h2><p id="2441" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">给定输入张量，它们输出有效的资产分配。</p><ul class=""><li id="8102" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mt mc md me bi translated">可微凸优化(<code class="fe mp mq mr ms b">cvxpylayers</code>)即 Markowitz</li><li id="fbac" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">Softmax(稀疏和约束变量也是)</li><li id="2000" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated">基于聚类的分配器</li><li id="f593" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi">…</li></ul><p id="d141" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一般的模式是创建一个由多个转换层组成的管道，最后是一个分配层。注意，几乎任何实值超参数都可以变成一个可学习的参数，甚至可以被某个子网络预测。</p><h1 id="132f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">想了解更多？</h1><p id="5004" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">如果这篇文章引起了你的兴趣，请随时查看下面的链接。</p><ul class=""><li id="7639" class="lw lx iq jw b jx jy kb kc kf ly kj lz kn ma kr mt mc md me bi translated"><a class="ae ks" href="https://github.com/jankrepl/deepdow" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li><li id="d3b5" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated"><a class="ae ks" href="https://deepdow.readthedocs.io/en/latest/auto_examples/end_to_end/getting_started.html#sphx-glr-auto-examples-end-to-end-getting-started-py" rel="noopener ugc nofollow" target="_blank">入门教程</a></li><li id="a7dd" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated"><a class="ae ks" href="https://deepdow.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">单据</a></li><li id="c31a" class="lw lx iq jw b jx mf kb mg kf mh kj mi kn mj kr mt mc md me bi translated"><a class="ae ks" href="https://deepdow.readthedocs.io/en/latest/auto_examples/index.html" rel="noopener ugc nofollow" target="_blank">更多例子</a></li></ul><p id="45fb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我将非常乐意回答任何问题。此外，建设性的批评或帮助发展是非常受欢迎的。</p></div></div>    
</body>
</html>