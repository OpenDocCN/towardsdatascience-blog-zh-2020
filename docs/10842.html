<html>
<head>
<title>Handling imbalanced data using Geometric SMOTE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用几何 SMOTE 处理不平衡数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handling-imbalanced-data-using-geometric-smote-770b49d5c7b5?source=collection_archive---------47-----------------------#2020-07-28">https://towardsdatascience.com/handling-imbalanced-data-using-geometric-smote-770b49d5c7b5?source=collection_archive---------47-----------------------#2020-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2965" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">SMOTE 变体的几何方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bba10b1dc62bf5b4cfcbd308a5b0c627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A-wmw0_Jnz_TCFcy_QIeJA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 1 .作者随机生成的数据</p></figure><p id="4fca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的图中，很明显，红色的点占多数，绿色的点占少数。少数数据的存在在异常检测、攻击和入侵检测、医学领域[癌症预测]和网络物理环境的研究中至关重要。但是数据样本中少数民族的数量是至关重要的。比方说，如果只有 0.01%的有用少数数据，通常算法会将其视为噪声或异常，并试图通过忽略这一点来提高准确性。如上所述，在许多情况下，不考虑少数群体数据样本比因其代表性不足而删除或忽略它们更为关键。</p><blockquote class="lr ls lt"><p id="10ed" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">当类别样本的数量大致相等时，通常的机器学习算法工作得最好，并且通常朝着提高准确度和最小化误差的方向调整[1]</p></blockquote><p id="bffc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，基于这种说法，数据不平衡必须得到处理，因为当数据接近平衡时，算法会工作得更好，技术世界有许多方法来解决这一常见现象。</p><h2 id="9353" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">处理不平衡数据</h2><p id="b774" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">我们可以通过算法和框架来解决不平衡数据的琐碎机器学习问题，这些算法和框架大致分为两个主要领域；预处理和代价敏感学习。重采样和特征选择是预处理方法的主要方式。</p><h2 id="b88b" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">数据重采样:</h2><p id="e447" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">这种方法修改了数据样本的数量，从而解决了偏斜类别分布或不平衡数据的不利影响。</p><ol class=""><li id="e643" class="mw mx iq kx b ky kz lb lc le my li mz lm na lq nb nc nd ne bi translated">过采样:过采样是添加少数类的更多副本。当您没有大量数据要处理时，过采样可能是一个不错的选择。但是过度的过采样可能会导致过度拟合。但是我们不会丢失有用的信息或特征。</li><li id="442f" class="mw mx iq kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">欠采样:欠采样是去除多数类的副本。当有大量数据时，可以设计欠采样。但是这里主要关注的是我们删除了有价值的信息。这可能导致对测试集的拟合不足和泛化能力差。</li><li id="8b4c" class="mw mx iq kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">混合:过采样和欠采样的适当混合。</li><li id="e97c" class="mw mx iq kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">SMOTE:与过采样类似的技术，但这里我们合成新的少数数据样本。</li></ol></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="7266" class="nr lz iq bd ma ns nt nu md nv nw nx mg jw ny jx mj jz nz ka mm kc oa kd mp ob bi translated">重击</h1><p id="a58c" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">SMOTE 算法是由舒拉、鲍耶、霍尔和凯格尔迈耶在 2002 年提出的，作为随机过采样的替代方案。合成少数过采样技术(SMOTE)的思想是在相邻少数类实例之间进行插值。SMOTE 的任务是通过对数据进行随机重采样来克服过度拟合的问题，并继续协助泛化。SMOTE 能够通过在邻域中合成新的少数类样本来增加少数类实例的数量，从而帮助分类器提高泛化能力。</p><p id="5052" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SMOTE 在少数实例之间生成新的少数样本。考虑两个少数点，算法沿着连接这些少数点的线生成新的少数样本。这是 SMOTE 算法的抽象视图。</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="3e0a" class="ly lz iq od b gy oh oi l oj ok">k = nearest neighbours<br/>n = no. of samples to be generated based on Imbalanced Ratio.</span></pre><blockquote class="lr ls lt"><p id="9907" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">SMOTE 算法(k，n):</p><p id="2492" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir">第一步:</strong>设置少数类集合<strong class="kx ir"> A. </strong>对于每个属于 A 的 x，找到 x 的<strong class="kx ir"> k 个最近邻</strong>(通过计算<strong class="kx ir"> x </strong>与集合<strong class="kx ir"> A)中每隔一个少数点的<strong class="kx ir">欧氏距离</strong>)</strong></p><p id="3978" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="iq"> A = {x1，x2，…XT }&amp;x1 的 k 近邻= {x6，x7，…xk} &amp;相似</em> </strong></p><p id="8c68" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir">第二步:</strong>对于每一个属于<strong class="kx ir"> A </strong>的<strong class="kx ir"> x，从其 k 个最近邻中选择<strong class="kx ir"> n 个</strong>少数点，它们构成集合<strong class="kx ir"> A1。</strong></strong></p><p id="a33d" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"><em class="iq">x1 的 x1 = { x7，x4，…xn} </em> </strong></p><p id="2a6c" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir">第三步:</strong>为每个点<strong class="kx ir"> p </strong>中的<strong class="kx ir"> A </strong>生成一个新的样本</p><p id="9678" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="iq">新点= p + rand(0，1) * |p-x1| </em> </strong></p><p id="2187" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">其中 rand(0，1)表示 0 和 1 之间的随机数</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/28cf7ea0f2a591b885a3d35c5d96be2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvKkuORUzmJaz042NgB0oA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 2 .作者对 SMOTE 功能的概述</p></figure><p id="5b0d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">SMOTE 仍然是一个有趣的工作，许多研究工作已经引入了 SMOTE 的变体，这些变体具有以它们自己的方式合成新的少数点的不同方法。SMOTE 的原始论文被引用超过 5000 次，开发 SMOTE 扩展的研究仍然是新鲜的。边界线-SMOTE(韩等，2005)，安全级-SMOTE (Bunkhumpornpat 等，2009)，DBM SMOTE(Bunkhumpornpat 等，2012)，ROSE (Menardi &amp; Torelli，2014)，MWMOTE (Barua 等，2014)，(Abdi &amp; Hashemi，2016)，Geometric SMOTE(Douzas 等，2017)就是相当多的例子。</p><p id="1649" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我发现 Geometric SMOTE 很有趣，因为它利用几何来优雅地开发解决方案，识别和解决可能导致的潜在问题。虽然它被称为 SMOTE 的变体，但不是真正的扩展。它模仿合成新的少数样本的核心思想。几何 SMOTE 也是一种基于该原理和插值的算法。让我们进入几何 SMOTE 的症结。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="b844" class="nr lz iq bd ma ns nt nu md nv nw nx mg jw ny jx mj jz nz ka mm kc oa kd mp ob bi translated">几何 SMOTE</h1><p id="6fb9" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">现有的 SMOTE 及其变体具有在合成少数样本时必须解决的各种问题，并且几何 SMOTE 已经确定了如下问题。</p><ol class=""><li id="0110" class="mw mx iq kx b ky kz lb lc le my li mz lm na lq nb nc nd ne bi translated">噪声示例的生成</li></ol><p id="d3e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当合成新的少数样本时，在多数聚类空间中合成特定样本的可能性更高。这种数据被称为噪声点。它们只能作为噪声融入集群。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f9e2ca115250ad6e4e07ccb2db2f0683.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*y_5kJ9kxHLYaiy-t-pSPzA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 3 .从几何 SMOTE 纸上获取的噪声样本的生成</p></figure><p id="9e58" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的图 3 中，噪声样本是选择<code class="fe on oo op od b">x’</code>作为应用 SMOTE 的最近点的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/250b7975b96e83b7bc68dd901e59b8ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*qQ5TxoKWm7wbSYiIvvD1Og.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 4 .来自几何 SMOTE 纸的噪声样本-2 的生成</p></figure><p id="b900" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于点的选择，还有另一种最终产生噪声样本的可能性。在图 4 中。由于<code class="fe on oo op od b">x</code>已经是一个噪声点，并且所选择的点也是噪声点，所以所生成的样本最终也是一个噪声样本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5bef973c66ba29562b50f08610572566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*QR-m0nLhic6oOhT_SDPqfg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 5 .来自几何 SMOTE 纸的噪声样本-3 的生成</p></figure><p id="8a0a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在上面的图 5 中，同样通过选择随机选择的<code class="fe on oo op od b">x</code>和<code class="fe on oo op od b">x’</code>，生成的点落在多数簇内，并导致噪声样本的形成</p><p id="872c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.属于相同子聚类的样本的生成导致过度拟合和不适当的表示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/572149e5bae486d8bf2b6d0bf40b15c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*r1lNoPo1lNbUXiBUkybQ9A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 6 .几乎相似样本的生成</p></figure><p id="4eb2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里，虽然不存在噪声样本的问题，但是生成属于一个少数子聚类的新样本会引入“聚类内不平衡”并导致原始数据的偏斜表示。并且高度密集的子群的新样本的生成将导致</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h2 id="4868" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">G-SMOTE 的主要目标</h2><p id="952b" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">Smote 在确定潜在泄漏后，确定了其主要目标，以解决一些问题和解决问题的机制。</p><ol class=""><li id="c2de" class="mw mx iq kx b ky kz lb lc le my li mz lm na lq nb nc nd ne bi translated">G-SMOTE 想要定义一个安全区域来合成新点。这是为了确保没有合成点被生成为噪声样本。</li><li id="e9a3" class="mw mx iq kx b ky nf lb ng le nh li ni lm nj lq nb nc nd ne bi translated">G-SMOTE 希望增加生成的少数类样本的多样性。这将防止少数样本的相同子类的生成导致群内偏斜。</li></ol><h2 id="e1cd" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">G-SMOTE 的参数</h2><blockquote class="lr ls lt"><p id="f763" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> Smaj </strong>:多数类样本集。</p><p id="2a9f" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> Smin </strong>:少数类样本集。</p><p id="f9a2" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> N </strong>:要生成的合成样本总数。</p><p id="b131" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> k </strong>:最近邻数。</p><p id="e590" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir">α_ trunc</strong>:1≤<strong class="kx ir">α_ trunc</strong>≤1 的截断因子。</p><p id="963b" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir">α_ def</strong>:0≤<strong class="kx ir">α_ def</strong>≤1 的变形因子。</p><p id="1516" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated"><strong class="kx ir"> α_sel </strong>:带有<strong class="kx ir">α_ sel</strong>∈n {少数，多数，组合}的邻居选择策略</p><p id="6066" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">S_gen:生成的合成示例集。(输出)</p></blockquote></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h2 id="2247" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">算法</h2><p id="eae8" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">关于完整的算法和解释，请参考 G-SMOTE 论文。在这里，我希望用例子来解释算法，并抽象出来。</p><blockquote class="lr ls lt"><p id="d965" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">1.对<strong class="kx ir"> Smin </strong>元素进行混洗，并初始化空集 Sgen</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="8a08" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">Smaj = {smaj1,smaj2,smaj3,.......}<br/>Smin = {smin1,smin2,smin3,........} -&gt; after being shuffled<br/>Sgen = {}</strong></span></pre><blockquote class="lr ls lt"><p id="1157" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.重复，直到 Sgen 中生成<strong class="kx ir"> N </strong>个少数实例:</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="aaee" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">N = 0<br/></strong>- Have to run the procedure till N number of samples are generated</span></pre><blockquote class="lr ls lt"><p id="3cb3" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.1.设<strong class="kx ir"> x_center ∈ Smin </strong>所选的 p 组件的少数类实例。</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="88dd" class="ly lz iq od b gy oh oi l oj ok">- A minority point from Smin is chosen as the center of a geometric region<br/> <strong class="od ir">x_center</strong> = <strong class="od ir">smin1</strong></span><span id="1d93" class="ly lz iq od b gy ot oi l oj ok">- The order of choosing the minority point will be the order of shuffled data points and in case of <strong class="od ir">N &gt; size of Smin</strong>, continue to re-run from the beginning again.</span></pre><blockquote class="lr ls lt"><p id="6b1c" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.2.如果<strong class="kx ir"> α_sel = minority </strong>:</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="3e94" class="ly lz iq od b gy oh oi l oj ok">In <strong class="od ir">G-SMOTE</strong> algorithm they defined 3 neighbor selection strategies ; minority,majority and mixed.</span><span id="06ab" class="ly lz iq od b gy ot oi l oj ok">- Find the k nearest neighbors of x_center from the set of Smin<br/>  <strong class="od ir">k_nearest_neighbors = {smin6,smin5......}</strong></span><span id="bcc9" class="ly lz iq od b gy ot oi l oj ok">- randomly select <strong class="od ir">x_surface</strong> from the <strong class="od ir">k_nearest_neighbors <br/>  x_surface = smin5</strong></span><span id="8a4f" class="ly lz iq od b gy ot oi l oj ok">- Calculate a radius from the relation <br/>  <strong class="od ir">R ← d(x_center, x_surface)</strong></span></pre><blockquote class="lr ls lt"><p id="54de" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.3.如果<strong class="kx ir"> α_sel =多数</strong>:</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="a2f4" class="ly lz iq od b gy oh oi l oj ok">- choose the nearest majority neighbor (from Smaj) of x_center <br/>  <strong class="od ir">x_surface = smaj3</strong></span><span id="9d8a" class="ly lz iq od b gy ot oi l oj ok">- Calculate a radius from the relation <br/>  <strong class="od ir">R ← d(x_center, x_surface)</strong></span></pre><blockquote class="lr ls lt"><p id="4e4b" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.4.如果<strong class="kx ir"> α_sel = mixed </strong>:</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="d8ab" class="ly lz iq od b gy oh oi l oj ok">- Find the k nearest neighbors of x_center from Smin. <br/>  <strong class="od ir">k_nearest_neighbors</strong> = {smin6,smin5......}</span><span id="5f79" class="ly lz iq od b gy ot oi l oj ok">- randomly choose one from <strong class="od ir">k_nearest_neighbors <br/>  smin6</strong></span><span id="6b5e" class="ly lz iq od b gy ot oi l oj ok">- Calculate the euclidean distance <br/>  <strong class="od ir">dmin ← d(x_center, smin6)</strong></span><span id="7550" class="ly lz iq od b gy ot oi l oj ok">----------------------------------------------------------------</span><span id="edb4" class="ly lz iq od b gy ot oi l oj ok">- Find nearest majority neighbor of x_center from Smaj<br/>  <strong class="od ir">xmaj= smaj3</strong></span><span id="7a8a" class="ly lz iq od b gy ot oi l oj ok">- Calculate the euclidean distance <br/>  <strong class="od ir">dmaj ← d(x_center, xmaj)</strong></span><span id="ed5f" class="ly lz iq od b gy ot oi l oj ok">----------------------------------------------------------------</span><span id="e096" class="ly lz iq od b gy ot oi l oj ok">- Calculate a radius from the relation <br/>  <strong class="od ir">x_surface ← argmin (dmin, dmaj)</strong><br/>  <strong class="od ir">R ← d(x_center, x_surface)</strong></span><span id="b6e4" class="ly lz iq od b gy ot oi l oj ok">----------------------------------------------------------------<br/><strong class="od ir">Note: Since d ≤ R ≤ dmaj; where d is distance from x_center to the generated sample<br/>=&gt; G</strong>eneration of noisy samples is avoided</span></pre><blockquote class="lr ls lt"><p id="d8e8" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.5.生成一个合成样本<strong class="kx ir"> x_gen ← hyperball(中心=0，半径=1) </strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/cd3515e8dbd09be76a21cf91c57fcd53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*hoz2lOeLOdwXQJnueYXFJg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 7。生成 e_sphere</p></figure><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="2e58" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">hyberball</strong>:</span><span id="0291" class="ly lz iq od b gy ot oi l oj ok">- function is meant for creating the e-sphere</span><span id="7f62" class="ly lz iq od b gy ot oi l oj ok">- <strong class="od ir">e_sphere</strong> is generated on the surface of a unit hyper-sphere </span></pre><blockquote class="lr ls lt"><p id="ed96" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.6.通过<strong class="kx ir"> x_gen ← truncate(x_gen，x_center，x_surface，α_trunc) </strong>变换 1 合成样本。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2872aa9ca34d023186bcbc71fcf91a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*bxkMRaStY-3AAPibBd_b1A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 8 .α_ trunc 的截断效应</p></figure><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="62d1" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">Truncation:</strong></span><span id="1a3d" class="ly lz iq od b gy ot oi l oj ok">- defined with bit of complex mathematics. But intuitively tells us which side of the hyper-sphere to be truncated to secure a safe space to generate a minority sample. </span><span id="fdf6" class="ly lz iq od b gy ot oi l oj ok">- When <strong class="od ir">α_trunc</strong> &gt; 0, the area that is opposite to the x_surface is truncated from the interior of the hyper-sphere.</span><span id="9f97" class="ly lz iq od b gy ot oi l oj ok">- When <strong class="od ir">α_trunc</strong> &lt; 0, the truncation occurs in the area that includes the x_surface point.</span><span id="5dc9" class="ly lz iq od b gy ot oi l oj ok">- <strong class="od ir">α_trunc v</strong>alue is generally -1 to 1. If it is -1.0, it truncates the exact <strong class="od ir">semi</strong>-hyper sphere on the same side of surface point and truncates the opposite side  of <strong class="od ir">semi</strong>-hyper sphere if <strong class="od ir">α_trunc equals </strong>1.0</span></pre><blockquote class="lr ls lt"><p id="cde1" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.7.通过<strong class="kx ir"> x_gen ← deform(xgen，xcenter，xsurface，α_def)变换 2 合成样本。</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/b4665bf360f7b2c6a42743d6f189c802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT6QqWuM0b4Ou-d68XXbXA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 9 .变形对α_def 的影响</p></figure><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="13ed" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">Deformation:</strong><br/>- corresponds to the deformation of the hyper-sphere in to a hyper-spheroid</span><span id="d03e" class="ly lz iq od b gy ot oi l oj ok">- <strong class="od ir">α_def</strong> relates the story of hyper-plane that to be chosen on which the new minority sample will be synthesized</span><span id="a129" class="ly lz iq od b gy ot oi l oj ok">- <strong class="od ir">α_def </strong>typically takes value 0 to 1 allowing the Deformation method to choose the proper plane to place generated sample.</span></pre><blockquote class="lr ls lt"><p id="91d2" class="kv kw lu kx b ky kz jr la lb lc ju ld lv lf lg lh lw lj lk ll lx ln lo lp lq ij bi translated">2.8.通过 x_gen ← translate(xgen，xcenter，R)转换 3 合成样本。</p></blockquote><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="a56e" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">Translation:</strong></span><span id="3d98" class="ly lz iq od b gy ot oi l oj ok">- translation of the generated point by the x_center vector and the resealing by the value of the radius R</span><span id="0b3f" class="ly lz iq od b gy ot oi l oj ok">- return (x_center + R * x_gen)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/88bdf17540e5058f405c408c16d37ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*yb6QrmFCRyAeRrtRvz6ylA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图 10 .少数样本的生成</p></figure><p id="d5d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.9.将生成的样本 x_gen 添加到生成的样本 S_gen 的集合中</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="9fc8" class="ly lz iq od b gy oh oi l oj ok"><strong class="od ir">S_gen {x_gen}<br/>N = N+1</strong></span></pre></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="8066" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读 G-SMOTE 到这一步。该博客旨在对 SMOTE 及其变体中的问题、G-SMOTE 算法和主要目标进行概述。看到 G-SMOTE 算法的缺点也很有趣，让我们在一个单独的博客中讨论它们。</p><h2 id="3e52" class="ly lz iq bd ma mb mc dn md me mf dp mg le mh mi mj li mk ml mm lm mn mo mp mq bi translated">参考</h2><p id="7d3e" class="pw-post-body-paragraph kv kw iq kx b ky mr jr la lb ms ju ld le mt lg lh li mu lk ll lm mv lo lp lq ij bi translated">[1] Johnson，J.M .，Khoshgoftaar，T.M .关于深度学习存在类不平衡的调查。<em class="lu"> J 大数据</em> <strong class="kx ir"> 6、</strong> 27 (2019)。<a class="ae oy" href="https://doi.org/10.1186/s40537-019-0192-5" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1186/s40537-019-0192-5</a></p><p id="d208" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[2] <a class="ae oy" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Chawla%2C+N+V" rel="noopener ugc nofollow" target="_blank"> N. V .舒拉</a>，<a class="ae oy" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Bowyer%2C+K+W" rel="noopener ugc nofollow" target="_blank"> K. W .鲍耶</a>，<a class="ae oy" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Hall%2C+L+O" rel="noopener ugc nofollow" target="_blank"> L. O .霍尔</a>，<a class="ae oy" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Kegelmeyer%2C+W+P" rel="noopener ugc nofollow" target="_blank"> W. P .凯格尔迈耶</a> (2011)。“SMOTE:合成少数过采样技术”</p><p id="b552" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[3]圣乔治·杜萨斯和费尔南多·巴桑。(2017).几何 SMOTE:通过 SMOTE 的几何扩展实现不平衡学习的有效过采样。</p><p id="9135" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[4] G. Douzas 和 F. Bacao，“几何 SMOTE 对 SMOTE 的一种几何增强的插入式替代”，<em class="lu">信息科学</em>，第 501 卷，第 118–135 页，2019 年。可用:10.1016/j.ins.2019.06.007</p><p id="4303" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[5] G-SMOTE 实现—<a class="ae oy" href="https://github.com/AlgoWit/geometric-smote" rel="noopener ugc nofollow" target="_blank">https://github.com/AlgoWit/geometric-smote</a></p></div></div>    
</body>
</html>