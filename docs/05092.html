<html>
<head>
<title>Simulate Covid-19 in your area with Python — beyond SIR models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python模拟您所在地区的新冠肺炎-超越SIR模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/model-the-covid-19-epidemic-in-detail-with-python-98f0d13f3a0e?source=collection_archive---------16-----------------------#2020-05-02">https://towardsdatascience.com/model-the-covid-19-epidemic-in-detail-with-python-98f0d13f3a0e?source=collection_archive---------16-----------------------#2020-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8de5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">结合基于个人的模拟和概率框架的详细和准确的建模，以及如何在几个步骤中建立自己的模拟</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5ffd5b9c63ad4e280af6e28ffc314a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_l7AC1z7SjMKuEFFf5fBBA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1370977" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</p></figure><p id="2db4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">疫情会持续多久？我们需要保持多长时间的社交距离？如果解除了呢？如果什么都没做呢？</em></p><p id="83d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个月前，在医生和数据科学家的帮助下，我用Python创建了一个模型，以预测圣保罗大都市地区冠状病毒疫情的演变，并回答上述问题。虽然有些人对预测的情景持怀疑态度，但我现在对预测的准确性感到震惊。这个模型已经得到了改进和开源，这就是为什么我想和你分享如何使用它，为任何你想建模的地区。</p><h1 id="6d91" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">关于我早期的预测</h1><h2 id="fd23" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">圣保罗大都市区新冠肺炎预测死亡人数</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/2af8a6b0b3887789279f42ce86780376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dB7ZcuOCclx9vo5grhsWsw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><em class="my">红线代表悲观的情况。蓝色的，乐观。星星，后来加上，显示官方死亡人数。预测是在3月30日计算的。</em></p></figure><p id="20f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当进行预测时，我们预计死亡的确认会有一些延迟，但这还不是模型的一部分。那时，在官方统计数据出来之前，我们仍然从医院的报告中得知死亡人数。因此，我们预计官方数据会像预测的那样，向右移动几天。</p><p id="0b44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型在说:我不知道长期会发生什么，但未来2-3周，任何情景看起来都一样。如果我们对疾病的建模是正确的，那么毫不奇怪我们在这三周内是正确的。在过去的10天里，曲线的倾斜度似乎在两种情况的中间<strong class="ky ir">。</strong></p><h1 id="79bf" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">用模型回答问题</h1><p id="bd41" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">当前的模型可以处理关于流行病如何表现的不确定性，并且<em class="ls">【学习】</em>来自观察。没有人确切知道这种疾病的传染性如何，或者人们的行为如何。图表中投影周围的阴影区域代表了这种不确定性。在学习时，模型识别哪些假设组合可以解释现实，哪些不能。</p><p id="11c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管如此，我们还是可以开始提问。</p><p id="fb98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">如果… </em> </strong>截止到4月20日有封锁怎么办？(在圣保罗，呆在家里只是一个建议，一些数据表明40%的人每天不呆在家里)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/108be03e40d726900973f1ebc7078f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHAuISHoGwLWPRFGM3YWdA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">封锁之后，重症监护室的入住率大约需要24天才能降至初始水平以下。如果在封锁前没有社交距离，这个时间可能会更长。</p></figure><p id="aa78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">如果……</em></strong>医院外面没人戴口罩怎么办？假设病人戴上后有40%的效果，易感者有20%的效果，我们预计如果没有人使用，病毒的传播会更严重。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/43af4162505a676b9a6c1d836ea00e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JwT39Nf7JrBAHVh4oJFgSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">虽然不能控制疫情，但在户外使用口罩可能会减少传染，并有助于使曲线变平。</p></figure><p id="e5a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">什么是… </em> </strong>社会距离感的效果？让我们来看看模型预期的<strong class="ky ir">生殖数</strong>(每个感染者感染的人数)在里约热内卢是如何表现的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/dcee7a37156405662b304d508255b64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wdgz5otzkFhzZcG__owwwg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每个收入水平的每日生育数。在所有的社会阶层中，生殖数量在三月中旬显著下降，那时社会距离在里约热内卢开始。</p></figure><p id="7443" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如所料，社交距离在减少传播方面非常有效。负担不起呆在家里的费用的人，或者甚至没有家可住的人，不能有效地隔离，正如较高的生殖数量所显示的那样。</p><p id="f477" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是等等…为什么对于<em class="ls">收入很低的</em>来说，再生号有更高的起点(<strong class="ky ir"> R0 </strong>)？其他社会阶层从<em class="ls"> 3.4 </em>开始，<em class="ls">极低收入</em>从<em class="ls"> 4.0 </em>开始。这种不明显的行为有一个简单的解释:正如模型正确指出的那样，更多的人生活在一起增加了在家里传播的机会。</p><p id="6c6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，<strong class="ky ir"> <em class="ls">为什么… </em> </strong>死亡人数在4月中旬加速上升如此之快，到那时似乎下降了，然后又再次上升？<em class="ls">(此事发生在圣保罗，解说解释了纽约等地的类似模式)</em></p><p id="be69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑到诊断和死亡确认的延迟，以及它们如何随时间变化，可以解释在官方数字中看到的不明显的行为。我们预计，由于缺乏检测能力，实际死亡人数在4月中旬之前的许多周都高于官方统计数字。当测试赶上时，事情似乎会在几天内失去控制。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/817cce4ba61796dc96965f03f453eac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6Zg8qnDFaudrfwoND0Tuw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">模拟的每日确诊死亡人数(红色)和每日实际死亡人数(蓝色)。测试能力的增加导致了4月中旬官方数字的激增——圣保罗大都市地区的预测。</p></figure><p id="0d27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于巴西的模拟，可以在这里找到详细的历史数据<a class="ae kv" href="https://brasil.io/dataset/covid19/caso/" rel="noopener ugc nofollow" target="_blank">。对于世界数据来说，</a><a class="ae kv" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank">这个Kaggle数据集</a>可以是一个好的开始。</p><h1 id="8e9f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">模型是如何构建的</h1><p id="f5dd" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated"><em class="ls">(如果你对Python建模不感兴趣，你可以跳到靠近末尾的图表，带有对纽约州的预测)</em></p><p id="416a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我在圣保罗做模特时，有一件事从一开始就很清楚:社会不平等很重要。所以我知道这个模型会比之前的大多数模型更复杂。使用时间序列模型是无助的，因为在曲线上领先的国家有非常不同的社会。建立一个<a class="ae kv" href="https://en.wikipedia.org/wiki/Multi-compartment_model" rel="noopener ugc nofollow" target="_blank">房室模型</a> (SIR，SEIR之类的)，预先定义状态，并详细说明转换的微分方程，由于要建模的许多重要方面，将是不可行的。一个基于个人的模拟<a class="ae kv" href="https://en.wikipedia.org/wiki/Agent-based_model" rel="noopener ugc nofollow" target="_blank">正在进行。</a></p><p id="dc0f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过使用<a class="ae kv" href="https://simpy.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Simpy </strong> </a>，很容易对疾病的任意特征或人们的行为进行建模。不需要预先知道什么是状态转换，甚至不需要知道有多少可能的状态，只需要知道状态变量和控制它们的逻辑。</p><p id="55a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简而言之，我们随机创建一个群体，根据其亚群体的特征，我们指定一些种子感染，并让个体相互作用。所有关于人们如何互动的规则，病人会有什么结果，疾病的每个阶段会持续多长时间，所有这些都可以被明确编程。一个事件可以触发并行逻辑，彼此独立运行，具有独立的随机性。这就像编写异步代码，将在模拟时间同步运行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="eac1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Python </strong>很棒，但是当对一种可能对一小部分人群产生影响的疾病建模时，需要模拟大量的个体。10.000个人，内存消耗和CPU使用率直线上升。为了解决这个问题，每个个体都变成了<a class="ae kv" href="https://cython.readthedocs.io/en/latest/src/tutorial/cython_tutorial.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Cython </strong> </a>中的一个对象，代码几乎没有变化，但可以模拟1000000个个体，消耗大约1GB RAM，性能大幅提升。</p><p id="dfee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，对疾病演变和传播进行了详细建模。大多数参数来自以下两个来源:</p><ul class=""><li id="5fd0" class="ni nj iq ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">【2019年冠状病毒疾病严重程度的估计:基于模型的分析</li><li id="28a6" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated"><a class="ae kv" href="http://gabgoh.github.io/COVID/index.html" rel="noopener ugc nofollow" target="_blank">流行病计算器</a> —包含几个疾病参数的估计值。</li></ul><p id="71f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型的当前源代码可以在这里找到:</p><div class="nw nx gp gr ny nz"><a href="https://github.com/ArroyoAndre/covidsimulation" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">ArroyoAndre/covidsimulation</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Covid流行病模拟python和cython中基于个体的动态模型，带有Simpy“所有模型都是错误的，但是…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on kp nz"/></div></div></a></div><h1 id="2fd3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">模拟一个地区的疫情</h1><h2 id="7284" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">安装</h2><p id="241d" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">首先，让我们克隆回购，建立一个虚拟环境，并安装模拟代码。(安装将下载需求，编译Cython代码，并将所有内容作为一个包安装)</p><pre class="kg kh ki kj gt oo op oq or aw os bi"><span id="7a4f" class="ml lu iq op b gy ot ou l ov ow">git clone <a class="ae kv" href="https://github.com/ArroyoAndre/covidsimulation.git" rel="noopener ugc nofollow" target="_blank">https://github.com/ArroyoAndre/covidsimulation.git</a></span><span id="3545" class="ml lu iq op b gy ox ou l ov ow">cd covidsimulation/</span><span id="3a44" class="ml lu iq op b gy ox ou l ov ow">python3 -m venv venv</span><span id="e7fe" class="ml lu iq op b gy ox ou l ov ow">. venv/bin/activate</span><span id="4ef6" class="ml lu iq op b gy ox ou l ov ow">./setup.sh</span></pre><p id="86c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，启动Jupyter:</p><pre class="kg kh ki kj gt oo op oq or aw os bi"><span id="3213" class="ml lu iq op b gy ot ou l ov ow">jupyter notebook</span></pre><h2 id="780a" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">配置您的区域</h2><p id="9e3f" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">在笔记本中，让我们从导入开始:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="5119" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将定义一个群体。为了真实地模拟一个地区，您可以定义几个人口(例如，城市和乡村、富人和穷人、普通人口和基本服务人员……)</p><p id="a408" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将模拟<strong class="ky ir">纽约州</strong>。提供数字是为了教学目的。(例如，我发明了年龄分布和房屋大小)</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="d674" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要指定<strong class="ky ir">干预</strong>。我们将使用两种干预措施。3月10日，学校停课，社交聚会被禁止，3月22日，家庭订单被取消。4月10日和12日，我们将使用<strong class="ky ir">诊断延迟变更</strong>干预来减少测试结果的延迟，以解决几天后报告的死亡人数激增的问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="cd90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">等等…为什么我在10天开始<strong class="ky ir">诊断_延迟</strong>，然后减少到5天？似乎合理的是，从收集检查结果，送到实验室，测试，结果出来，到死亡报告，总共需要大约5天时间。根据维基百科的数据，在4月10日到4月15日期间，纽约每天大约有700人死亡。在16日和17日，死亡人数比之前的平均值多3500人，然后回到之前的趋势。所以我们可以假设有大约5天的死亡等待确认，最终得到确认。因此之前的10天延迟。</p><p id="e181" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要将所有这些包装到一个区域的<strong class="ky ir">参数</strong>对象中。</p><p id="e738" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于感染人数很少，疫情发展的时间可能会有很大差异，我们将所有模拟都放在<strong class="ky ir"> D0 </strong>中，定义为感染人数达到阈值的日期。我们将把<strong class="ky ir"> D0 </strong>定义为3月10日(因为在此之前发生的事情不多)。因为我们不知道那时有多少人被感染，我们把它设为一个在10k到200k之间均匀分布的<strong class="ky ir">随机参数</strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h2 id="2a48" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">校准我们的模型</h2><p id="4e58" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">我们在模型中加入了两个不确定的参数。其他一些，如来自感染者的传播率，也是未知的，或者可能因地区而异，默认为<strong class="ky ir">随机参数</strong>。这就是为什么我们需要校准我们的模型。</p><p id="6050" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，我们可以用来校准的偏差较小的变量是官方的死亡人数。可能会有一些系统性的漏报和系统延迟，但这比其他偏见要好。我们已经假设病例确认的平均延迟从10天开始，到4月中旬变为5天，所以我们应该没问题。</p><p id="5dba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将创建一个得分函数，为模拟提供更低的损失值，以更好地匹配特定日期的官方死亡人数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="a0bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将开始校准过程。首先，我们将使用100，000个个体的小群体，尝试模型内部参数值的几种组合。(<strong class="ky ir">为此，我使用了一个具有32个CPU内核的虚拟实例</strong>。在笔记本电脑上，可能需要一段时间……)我们将进行1000次试验，并保留100个最佳结果(<em class="ls"> p=0.1 </em>)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="fa95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其次，我们将在100万人的群体中尝试这100个最佳，以减少分离最佳时的噪音。然后我们会保留16个最好的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="d824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那些<strong class="ky ir">随机状态</strong>是模型中所有不确定参数联合分布的<em class="ls">后验</em>。通过适当的命名，可以使用一个区域的<em class="ls">后验</em>作为另一个区域的<em class="ls">前验</em>，以获得精确的<em class="ls">后验</em>。</p><h2 id="34d8" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">(终于！)运行模拟并绘制结果</h2><p id="5650" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">在花了这么多时间校准之后，你可能想保存目前为止找到的<strong class="ky ir">随机状态</strong><strong class="ky ir">。</strong>(如何使用<strong class="ky ir">泡菜</strong>做这件事超出了这篇文章的目的，但是鼓励你去谷歌一下)</p><p id="553b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在可以进行真正的模拟，并预测未来的事情。我们将选取找到的16个最佳随机状态，并在200万个体的群体中分别应用两次。同样，我们将保留最符合我们校准数据的16个模拟(<em class="ls">其中0.5个</em>)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="29b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们画出已确认的死亡人数，来做第一次检查:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/1e10e8976d4d02455b92d1b44af6a2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lA1bRSW1Cn3YunbWnGy5BA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">该模型用截至3月19日的真实数据训练，预测死亡人数在5月初趋于稳定。请注意4月中旬死亡人数的正确预测。</p></figure><p id="8c35" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和总死亡数，没有确认延迟，以对数标度:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/758be8a2087ec3a44124b43c54caff21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JAc613Tkxl62AdJ8qQGQqw.png"/></div></div></figure><p id="44c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还可以满足我们的好奇心，看看我们的随机参数学习了哪些值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/3396bffa105fe3bb4af0e4ac242cbc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*UExQ9i3pRDq7PciuFWrUeA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">尽管对数先验范围在1万到20万之间，但我们的模型认为3月10日更有可能有大约7万人已经被感染。不同的先验可能导致不同的结论，除非我们可以观察到足够的数据来减少其他参数的不确定性。</p></figure><p id="29c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以看到实现的指标:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">列出实施的指标的输出</p></figure><p id="5474" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">死亡率呢？没有一个衡量标准，但是我们可以创建一个。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/ef14877d18cc442a6ef01cbd2443e216.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dO-GEIGjaIPrFx1Uex-DQA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">该中心对预测感染死亡率的估计接近0.5%，与最近通过血清学检测对已感染人群的估计一致。60-69岁年龄组的IFR可能高达3%。</p></figure><p id="c425" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管这是出于教学目的的快速建模(抱歉，如果你用的是笔记本电脑)，但结果却非常真实。</p><h2 id="facc" class="ml lu iq bd lv mm mn dn lz mo mp dp md lf mq mr mf lj ms mt mh ln mu mv mj mw bi translated">经验之谈</h2><ul class=""><li id="08dd" class="ni nj iq ky b kz mz lc na lf oz lj pa ln pb lr nn no np nq bi translated">良好的前科是金。在许多情况下，避免<strong class="ky ir">统一参数</strong>，即使用不同的分布来代替它们，也可以在只能学习过去的模型和能够真正预测未来不明显行为的模型之间产生差异。请记住:</li></ul><blockquote class="pc"><p id="2f04" class="pd pe iq bd pf pg ph pi pj pk pl lr dk translated">进→出</p></blockquote><ul class=""><li id="a8ce" class="ni nj iq ky b kz pm lc pn lf po lj pp ln pq lr nn no np nq bi translated">进行许多模拟(至少从10k <strong class="ky ir"> random_states </strong>开始)，并用大量人群(200万用于演示目的)进行模拟也可以显著提高准确性。</li><li id="f1f3" class="ni nj iq ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">向评分函数添加不同类型的度量可以使更多的输出变量更加准确。</li></ul><h1 id="e93f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">如果你走到这一步…</h1><p id="3782" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">这里没有探讨更多的功能，比如研究卫生措施或使用口罩的效果。也有可能模拟不同的社会距离情景，包括间歇性距离，并考虑到卫生系统的能力。</p><p id="5577" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你可以很好地利用这个模型，或者告诉人们你所在地区的预测和情景，或者只是了解它是如何构建的，以及如何用Python做更酷的事情。</p><p id="b8b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">邀请<a class="ae kv" href="https://github.com/ArroyoAndre/covidsimulation" rel="noopener ugc nofollow" target="_blank">与您合作改进模型</a>，为新区域建模，添加新功能，并分享您的成果。</p></div><div class="ab cl pr ps hu pt" role="separator"><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw"/></div><div class="ij ik il im in"><p id="27be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">编者按:</em> </strong> <em class="ls"> </em> <a class="ae kv" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="ls">走向数据科学</em> </a> <em class="ls">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae kv" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="ls">这里</em> </a> <em class="ls">。</em></p></div></div>    
</body>
</html>