<html>
<head>
<title>Coronavirus in Wikipedia by language — visualized</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">维基百科中冠状病毒的语言-可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/coronavirus-interest-inwikipedia-by-language-1b3e6562040d?source=collection_archive---------20-----------------------#2020-02-29">https://towardsdatascience.com/coronavirus-interest-inwikipedia-by-language-1b3e6562040d?source=collection_archive---------20-----------------------#2020-02-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/dcc63f87ca3ab84fc6e4b9cee5f13482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KgHwHyjsbMOUl3l_xE1hqQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">按冠状病毒语言分类的维基百科页面浏览量</p></figure><div class=""/><div class=""><h2 id="4e8b" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">查看维基百科的页面浏览量，深入了解新闻在世界各地的传播和趋势。首先，我们将从维基百科的页面浏览量中提取数据来创建一个新的仪表板。坚持到最后，看看在Data Studio中使用Vega和Vega Lite实现高度可配置的可视化的秘密。</h2></div><p id="5574" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">一些有趣的趋势你可以很快想象出来:</p><ul class=""><li id="1bbb" class="lq lr jf kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">中文的冠状病毒比其他语言早9天开始流行。</li><li id="ea47" class="lq lr jf kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">日语和韩语是最先赶上的语言。</li><li id="4490" class="lq lr jf kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">在过去的几天里，意大利、挪威和波斯的反弹最为强劲。</li></ul><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi me"><img src="../Images/89ce706ccfe45e050ceee101b5dbfc7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QrEH8H-C8KPuVLYZ5qyNUg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">一些有趣的趋势你可以很快想象出来</p></figure><p id="8edd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在开头的图表中，您可以找到每种语言的冠状病毒页面的浏览量。下一个图表显示了当前新闻之后的<a class="ae mj" href="https://en.wikipedia.org/wiki/2019%E2%80%9320_coronavirus_outbreak" rel="noopener ugc nofollow" target="_blank">维基百科文章的相同情况:</a></p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mk"><img src="../Images/7947865c5d0dbe744ab84b6c76a3004e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0P7XwDVQUB_UtaL64iXWQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">主题<a class="ae mj" href="https://en.wikipedia.org/wiki/2019%E2%80%9320_coronavirus_outbreak" rel="noopener ugc nofollow" target="_blank">2019–20 _武汉_冠状病毒_爆发</a>的每种语言的维基百科浏览量。请看<a class="ae mj" href="https://en.wikipedia.org/wiki/Coronavirus" rel="noopener ugc nofollow" target="_blank">冠状病毒</a>的开场图。</p></figure><p id="0b93" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在BigQuery中从维基数据中获取所有冠状病毒页面标题:</p><pre class="mf mg mh mi gt ml mm mn mo aw mp bi"><span id="3468" class="mq mr jf mm b gy ms mt l mu mv">CREATE OR REPLACE TABLE `temp.wikidata_coronavirus`<br/>AS<br/>SELECT REGEXP_EXTRACT(site, '(..)wiki') language, encoded value<br/>FROM `bigquery-public-data.wikipedia.wikidata`, UNNEST(sitelinks)<br/>WHERE numeric_id = 290805<br/>AND LENGTH(site)=6</span><span id="fc90" class="mq mr jf mm b gy mw mt l mu mv"># 1.9 sec elapsed, 9.7 MB processed</span></pre><p id="fb0f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">修正了西班牙语、荷兰语、斯洛伐克语页面的重命名:</p><pre class="mf mg mh mi gt ml mm mn mo aw mp bi"><span id="55da" class="mq mr jf mm b gy ms mt l mu mv">INSERT INTO `temp.wikidata_coronavirus` <br/>SELECT 'es', 'Orthocoronavirinae';<br/>INSERT INTO `temp.wikidata_coronavirus`<br/>SELECT 'nl', 'Coronavirussen'<br/>INSERT INTO `temp.wikidata_coronavirus`<br/>SELECT 'sk', 'Coronavírus'</span></pre><p id="76df" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">为Data Studio创建一个表:</p><pre class="mf mg mh mi gt ml mm mn mo aw mp bi"><span id="d01a" class="mq mr jf mm b gy ms mt l mu mv">CREATE OR REPLACE TABLE <br/>  `fh-bigquery.wikipedia_extracts.wikipedia_corona_views`<br/>AS<br/>WITH sumviews AS (<br/>  SELECT * REPLACE(IF(date=CURRENT_DATE(), views*24/hours_day, views) AS views) # last fractional day correction<br/>  FROM (<br/>    SELECT SUM(views) views, SUBSTR(a.wiki, 0, 2) wiki, title,  DATE(datehour) date, COUNT(DISTINCT datehour) hours_day<br/>    FROM `bigquery-public-data.wikipedia.pageviews_20*`  a <br/>    JOIN `temp.wikidata_coronavirus` b<br/>    ON ((a.title=b.value AND SUBSTR(a.wiki, 0, 2)=b.language))<br/>    WHERE DATE(a.datehour) &gt; '2019-12-28'<br/>    GROUP BY wiki, title, date<br/>  )<br/>)<br/>SELECT *, (FORMAT('%s - %s', language, title)) wiki_title<br/>FROM (<br/>  SELECT * <br/>    REPLACE((SELECT STRING_AGG(DISTINCT title ORDER BY title) FROM sumviews WHERE a.wiki=wiki) AS title)<br/>    , (views)/ (MAX(views) OVER(PARTITION BY wiki)) ratio<br/>    , (SELECT language FROM `wikipedia_extracts.wiki_langs` WHERE a.wiki=wiki ) language<br/>  FROM sumviews a<br/>  WHERE wiki IN (SELECT wiki FROM (SELECT wiki, SUM(views) FROM sumviews GROUP BY 1 ORDER BY 2 DESC LIMIT 28 ))<br/>)</span><span id="8fcd" class="mq mr jf mm b gy mw mt l mu mv"># (13.4 sec elapsed, 411.3 GB processed)</span></pre><p id="da31" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">优化待办事项</strong>:这411.3 GB可以进行大量优化——尤其是如果在持续的基础上，我只是加载增量小时的视图，而不是重新处理整个事情。</p><h1 id="a0b7" class="mx mr jf bd my mz na nb nc nd ne nf ng kl nh km ni ko nj kp nk kr nl ks nm nn bi translated">玩弄结果</h1><p id="f250" class="pw-post-body-paragraph ku kv jf kw b kx no kg kz la np kj lc ld nq lf lg lh nr lj lk ll ns ln lo lp ij bi translated">包含结果的整个表只有1，239行，您可以在BigQuery上找到它:</p><pre class="mf mg mh mi gt ml mm mn mo aw mp bi"><span id="3edc" class="mq mr jf mm b gy ms mt l mu mv">SELECT *<br/>FROM `fh-bigquery.wikipedia_extracts.wikipedia_corona_views`</span></pre><p id="648d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae mj" rel="noopener" target="_blank" href="/bigquery-without-a-credit-card-discover-learn-and-share-199e08d4a064"> <em class="nt">新加入BigQuery？从这里开始</em> </a>。</p><h1 id="e601" class="mx mr jf bd my mz na nb nc nd ne nf ng kl nh km ni ko nj kp nk kr nl ks nm nn bi translated">数据工作室</h1><p id="afa6" class="pw-post-body-paragraph ku kv jf kw b kx no kg kz la np kj lc ld nq lf lg lh nr lj lk ll ns ln lo lp ij bi translated">你见过这样的图表:</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nu"><img src="../Images/d1c0a95b9e2469c43067cb37fe70de6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ay9P-msstptcP8ff6gk36A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">典型的数据工作室面积图</p></figure><p id="dc43" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">但是这有多酷？</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/1e19fa1ae7cc4a48e7609e99e0711add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2FZljzZvSRHGxdDrigI22g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Data Studio中连接到BigQuery的Vega Lite可视化</p></figure><p id="5b1c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">秘密:我们现在可以在Data Studio 中使用<a class="ae mj" href="https://twitter.com/googleanalytics/status/1233170199211380736" rel="noopener ugc nofollow" target="_blank"> Vega &amp; Vega lite图表。有了这个社区可视化，我只需要为Vega lite提供一个配置:</a></p><pre class="mf mg mh mi gt ml mm mn mo aw mp bi"><span id="5cab" class="mq mr jf mm b gy ms mt l mu mv">{<br/>   "$schema":"<a class="ae mj" href="https://vega.github.io/schema/vega-lite/v3.json" rel="noopener ugc nofollow" target="_blank">https://vega.github.io/schema/vega-lite/v3.json</a>",<br/>   "mark":"rect",<br/>   "config":{<br/>      "axisRight":{<br/>         "labelFontSize":15<br/>      }<br/>   },<br/>   "encoding":{<br/>      "y":{<br/>         "title":"",<br/>         "field":"$dimension0",<br/>         "type":"nominal",<br/>         "axis":{<br/>            "labelAlign":"left",<br/>            "orient":"right"<br/>         }<br/>      },<br/>      "x":{<br/>         "field":"$dimension1",<br/>         "type":"ordinal"<br/>      },<br/>      "color":{<br/>         "field":"$metric0",<br/>         "type":"quantitative",<br/>         "legend":{<br/>            "orient":"left"<br/>         },<br/>         "scale":{<br/>            "type":"sqrt",<br/>            "range":[<br/>               "#fffaff",<br/>               "blue"<br/>            ]<br/>         }<br/>      }<br/>   }<br/>}</span></pre><p id="8bc5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">不同的尝试:</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/09332e3a247fa253bac0ab9d4d079aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D3N4-nJhKz6kwb1gT-q2gg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">在Data Studio中使用Vega Lite</p></figure><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="012b" class="mx mr jf bd my mz na nb nc nd ne nf ng kl nh km ni ko nj kp nk kr nl ks nm nn bi translated">想要更多吗？</h1><p id="cfd8" class="pw-post-body-paragraph ku kv jf kw b kx no kg kz la np kj lc ld nq lf lg lh nr lj lk ll ns ln lo lp ij bi translated">敬请关注交互式仪表盘和更多更新。请给我留下您的意见和任何建议或更正。</p><p id="f4e5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">感谢</strong>:<a class="nz oa ep" href="https://medium.com/u/ac7d3bcad193?source=post_page-----1b3e6562040d--------------------------------" rel="noopener" target="_blank">Denny vrandei</a>，感谢维基数据和对这篇文章的最后修正。<a class="nz oa ep" href="https://medium.com/u/1f225b5f22b2?source=post_page-----1b3e6562040d--------------------------------" rel="noopener" target="_blank">马克·科恩</a>在BigQuery中为维基数据和维基百科数据建立了一个可靠的管道。更多详情请见下文。</p><h2 id="ead6" class="mq mr jf bd my ob oc dn nc od oe dp ng ld of og ni lh oh oi nk ll oj ok nm ol bi translated">冠状病毒和Meetup RSVPs</h2><p id="9ccc" class="pw-post-body-paragraph ku kv jf kw b kx no kg kz la np kj lc ld nq lf lg lh nr lj lk ll ns ln lo lp ij bi translated">哦，我也在看世界各地的Meetup RSVPs是如何受到影响的。看看这个:</p><div class="mf mg mh mi gt ab cb"><figure class="om is on oo op oq or paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/e6e44748278b1c199007552bdf48e08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/0*lj9Qu_1Y2KPmgqM-.png"/></div></figure><figure class="om is os oo op oq or paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/5c763026063dad85a162bcccaad762ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/0*jhG5lnJLPGpxhXIE"/></div><p class="iz ja gj gh gi jb jc bd b be z dk ot di ou ov translated">参加Meetup.com技术会议的回复数量下降(与去年相比)</p></figure></div><p id="a741" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我是Felipe Hoffa，谷歌云的开发者倡导者。在<a class="ae mj" href="https://twitter.com/felipehoffa" rel="noopener ugc nofollow" target="_blank"> @felipehoffa </a>上关注我，在<a class="ae mj" href="https://medium.com/@hoffa" rel="noopener">medium.com/@hoffa</a>上找到我以前的帖子，在<a class="ae mj" href="https://reddit.com/r/bigquery" rel="noopener ugc nofollow" target="_blank">reddit.com/r/bigquery</a>上找到所有关于BigQuery的帖子。</p><div class="ip iq gp gr ir ow"><a rel="noopener follow" target="_blank" href="/bigquery-without-a-credit-card-discover-learn-and-share-199e08d4a064"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jg gy z fp pb fr fs pc fu fw je bi translated">没有信用卡的BigQuery:发现、学习和分享</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">如果你在注册BigQuery时遇到了困难，不用担心——现在注册和开始使用比以往任何时候都容易</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk ix ow"/></div></div></a></div><div class="ip iq gp gr ir ow"><a rel="noopener follow" target="_blank" href="/inequality-how-to-draw-a-lorenz-curve-with-sql-bigquery-and-data-studio-c70824b0748d"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jg gy z fp pb fr fs pc fu fw je bi translated">不等式:如何用SQL、BigQuery和Data Studio绘制洛伦兹曲线</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">所有维基百科页面中排名前0.1%的页面获得了25%的浏览量。最底层的99%只获得了42%的浏览量。还有……</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pl l ph pi pj pf pk ix ow"/></div></div></a></div><div class="ip iq gp gr ir ow"><a rel="noopener follow" target="_blank" href="/interactive-the-top-2019-wikipedia-pages-d3b96335b6ae"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jg gy z fp pb fr fs pc fu fw je bi translated">互动:2019年维基百科页面排行榜</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">维基媒体公布了他们2019年最受欢迎的页面——但我们能更深入吗？当然，这里有BigQuery和…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pm l ph pi pj pf pk ix ow"/></div></div></a></div><div class="ip iq gp gr ir ow"><a href="https://medium.com/google-cloud/bigquery-optimized-cluster-your-tables-65e2f684594b" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jg gy z fp pb fr fs pc fu fw je bi translated">优化BigQuery:聚集您的表</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">BigQuery刚刚宣布了对表进行集群的能力——我将在这里进行描述。如果您正在寻找大量的…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pn l ph pi pj pf pk ix ow"/></div></div></a></div></div></div>    
</body>
</html>