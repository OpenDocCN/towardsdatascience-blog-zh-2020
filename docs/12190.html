<html>
<head>
<title>Predicting the NBA Playoffs Bracket with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测 NBA 季后赛比分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-2020-nba-playoffs-bracket-with-machine-learning-2030f80fa62c?source=collection_archive---------32-----------------------#2020-08-22">https://towardsdatascience.com/predicting-the-2020-nba-playoffs-bracket-with-machine-learning-2030f80fa62c?source=collection_archive---------32-----------------------#2020-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="14eb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用历史篮球数据和机器学习预测每个系列赛的结果是可能的吗？</h2></div><p id="ecf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">章鱼保罗是一只短命的头足类动物(2008 年 1 月 26 日-2010 年 10 月 26 日),饲养在德国奥伯豪森的<a class="ae le" href="https://en.wikipedia.org/wiki/Sea_Life_Centres" rel="noopener ugc nofollow" target="_blank">海洋生物中心</a>,他因被指能够预测国际足联世界杯足球赛的结果而一夜成名。他所要做的就是吃两个盒子中的一个，除了参赛国家队的旗帜之外，其他方面都一样。许多人认为章鱼是地球上最接近外星智慧的 T4 生物，人们可能会怀疑这种德国无脊椎动物(无意冒犯)是否知道一些关于足球的秘密，而这些秘密可能是更聪明的无毛猿(<em class="lf">又名</em>人类)事实上不知道的。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/e5f172675fd31c59aaff449f3df0f471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwgEBJpuGLLgaxbwI7EjYw.jpeg"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">有时候你只有一次机会赢得比赛。[图片由<a class="ae le" href="https://unsplash.com/@rapiana" rel="noopener ugc nofollow" target="_blank"> Ramiro Pianarosa </a>在<a class="ae le" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank">Unsplash.com</a>上拍摄]</p></figure><p id="ea46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基于计算机预测体育赛事结果的历史很长。内特·西尔弗的《信号与噪声的 T2》讲述了一个很好的故事，这是对这个主题感兴趣的人的必读之作。这本书还提醒读者，大多数这样的预测都失败了。然而，特别是自从<a class="ae le" href="https://www.dataversity.net/brief-history-deep-learning/#:~:text=The%20history%20of%20Deep%20Learning,to%20mimic%20the%20thought%20process." rel="noopener ugc nofollow" target="_blank">深度学习</a>的出现，先进的统计方法在体育赛事中的应用变得越来越重要，例如导致<a class="ae le" href="https://en.wikipedia.org/wiki/Moneyball" rel="noopener ugc nofollow" target="_blank">对棒球中的年轻球员</a>进行球探，或者改进训练<em class="lf">，例如</em>到篮球中的<a class="ae le" href="https://www.reddit.com/r/dataisbeautiful/comments/837qnu/heat_map_of_1058383_basketball_shots_from_ncaa/" rel="noopener ugc nofollow" target="_blank">投三分球</a>。在这个历史时刻，我们很自然会问自己，在利用历史数据预测体育运动方面，人工智能能比我们强多少。在这篇文章中，我们将探索预测 NBA 季后赛的可能性，谁知道呢，甚至可能赢得 100 万美元。</p><h2 id="2338" class="lw lx it bd ly lz ma dn mb mc md dp me kr mf mg mh kv mi mj mk kz ml mm mn mo bi translated">用人工智能赢得 NBA 支架挑战赛</h2><p id="76cc" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">今年，美国国家篮球协会(NBA)发起了一项挑战，鼓励人们预测所有季后赛系列赛(加上决胜局)的结果，名为<a class="ae le" href="https://picks.nba.com/bracket-challenge" rel="noopener ugc nofollow" target="_blank"> NBA 括号挑战</a>。虽然加入挑战的窗口现在已经关闭，并且在撰写本文时已经有了一些结果，但总体来看，如何安排机器学习系统来做出这样的预测是很有趣的。这当然是一种相当简化的方法，尽管在过去已经提出了更先进的例子<a class="ae le" href="https://www.mdpi.com/1099-4300/18/12/450/pdf" rel="noopener ugc nofollow" target="_blank">，例如基于最大熵</a>的<a class="ae le" href="https://en.wikipedia.org/wiki/Principle_of_maximum_entropy" rel="noopener ugc nofollow" target="_blank">原理。我准备了一个 Google Colab </a><a class="ae le" href="https://colab.research.google.com/drive/1bG_4lY4INWFLKf0buWWdoJcf3KntztR7?usp=sharing" rel="noopener ugc nofollow" target="_blank">笔记本</a>，你可以用它来玩。您还需要输入数据，您可以从<a class="ae le" href="https://drive.google.com/drive/folders/1WzIHocxpkGF4TfywVAdLOi4w8v6Co6HA?usp=sharing" rel="noopener ugc nofollow" target="_blank">这个共享文件夹</a>中复制这些数据。</p><p id="46cd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们从<a class="ae le" href="https://www.basketball-reference.com/leagues/NBA_2019.html" rel="noopener ugc nofollow" target="_blank">篮球参考网站</a>收集数据。人们可以方便地下载常规赛和季后赛的统计数据。在这里，我们限制到 1990 年至 2019 年，我们将使用 2020 年的常规赛数据来预测 2020 年的支架。</p><p id="2c9d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于每支球队，每年都有以下“经典”功能可用(平均每场比赛):</p><ul class=""><li id="2f99" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated">常规赛末排名(Rk)</li><li id="474c" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">玩游戏的次数(克)</li><li id="6d1c" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">播放分钟数(MP)</li><li id="8b03" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">现场目标(FG)</li><li id="1a3a" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">投篮尝试(FGA)</li><li id="ebb5" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">现场目标百分比(FG%)</li><li id="2552" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">三分球射门(3P)</li><li id="0993" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">3 分投篮尝试(3PA)</li><li id="98ee" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">三分球命中率(3P%)</li><li id="c989" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">两分投篮得分(2P)</li><li id="943f" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">2 分投篮尝试(2PA)</li><li id="a494" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">两分投篮命中率(2P%)</li><li id="0d6e" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">罚球(英尺)</li><li id="4c85" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">罚球次数</li><li id="810c" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">罚球百分比(英尺%)</li><li id="d0ab" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">进攻篮板</li><li id="6f0f" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">防守篮板(DRB)</li><li id="f39f" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">篮板总数(TRB)</li><li id="4222" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">助攻数(AST)</li><li id="cd50" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">偷窃(短期)</li><li id="1849" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">街区(BLK)</li><li id="1b35" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">周转率</li><li id="e618" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">个人犯规</li><li id="df31" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">点</li></ul><p id="c8a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">人们可以以 CSV 格式下载所有这些数据，这些数据可以很容易地作为一个<a class="ae le" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a> dataframe 来处理。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ni"><img src="../Images/e62559c19494e063037af3a2afc11175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*haXwz9iDf0kQyFsgTi4DMQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">熊猫数据框包含 1990 年至 2020 年的常规季节数据</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nj"><img src="../Images/75ed5a7bfe8fbd20966ce04f63889d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cxhaYfS-R5_IbF7yUmQmYA.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">一些数据探索揭示了输入特征的平均值和百分位数。</p></figure><p id="d337" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">毫不奇怪，这些特征之间存在相关性。为了减少输入特征的数量并尽可能消除相关性，习惯上是将<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" rel="noopener ugc nofollow" target="_blank">标准化</a> ( <em class="lf">即</em>去除平均值并缩放方差)，然后对输入应用<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" rel="noopener ugc nofollow" target="_blank">主成分分析</a>分解。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/025d4bfadd9ea911b7bb52ddd36ce9f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*iVMLdFyQTjc2_1K5ojgUnw.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">输入要素之间相关性的热图</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nl"><img src="../Images/c8e121ef6261f9230d592d1f659d5ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86wfQFaMZKmzADNf7wXEow.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">成对输入特征变量的相关图。看起来像斑点的子图对应于不相关的变量。相反，一些子图显示了很强的相关性，如射门次数(FGA)与得分(pts)或得分(PTS)与排名(Rk)。</p></figure><p id="0b59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了训练机器学习模型，在这个例子中只是一个浅层神经网络，我们假设常规赛数据包含足够的信息来预测季后赛比赛的结果，这有点夸张，但也不太疯狂。</p><pre class="lh li lj lk gt nm nn no np aw nq bi"><span id="7808" class="lw lx it nn b gy nr ns l nt nu">Model: "DNN_regresson" _________________________________________________________________ Layer (type)                 Output Shape              Param #    ================================================================= input_69 (InputLayer)        [(None, 32)]              0          _________________________________________________________________ dense_185 (Dense)            (None, 32)                1056       _________________________________________________________________ dropout_98 (Dropout)         (None, 32)                0          _________________________________________________________________ dense_186 (Dense)            (None, 16)                528        _________________________________________________________________ dropout_99 (Dropout)         (None, 16)                0          _________________________________________________________________ dense_187 (Dense)            (None, 14)                238        ================================================================= Total params: 1,822 Trainable params: 1,822 Non-trainable params: 0 _________________________________________________________________</span></pre><p id="eab9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从技术角度来看，必须创建一组输入示例和相应的标签。有人可能天真地认为，预测比赛结果最明显的方法是让模型输出每个队赢的比赛数，<em class="lf">例如</em>4–1，2–4，等等。事实上，这种多维预测是不必要的，通常会产生 3-3、1-3 等不可能的结果。认识到可能结果的数量是有限的，这个问题就可以大大简化。例如，由于每个系列都必须以七局三胜结束(或在 2005 年前的第一轮中以五局三胜结束)，因此只允许以下系列，因此可以在地图中进行编码:</p><pre class="lh li lj lk gt nm nn no np aw nq bi"><span id="faa7" class="lw lx it nn b gy nr ns l nt nu">valid_results = [(3,0), (3,1), (3,2), (4,0), (4,1), (4,2), (4,3), (3,4), (2,4), (1,4), (0,4), (2,3), (1,3), (0,3)]</span><span id="0c86" class="lw lx it nn b gy nv ns l nt nu">result_to_idx = {res: i for i, res in enumerate(valid_results)}<br/>idx_to_result = {i: res for i, res in enumerate(valid_results)}</span></pre><p id="cab6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这样，我们可以要求网络输出 14 种可能结果中每一种的<a class="ae le" href="https://stats.stackexchange.com/questions/189331/why-is-the-softmax-used-to-represent-a-probability-distribution" rel="noopener ugc nofollow" target="_blank"> <em class="lf"> softmax </em>概率</a>。这样就不会得到不可能的结果作为输出。这种情况下的损失函数是<a class="ae le" href="https://jovianlin.io/cat-crossentropy-vs-sparse-cat-crossentropy/" rel="noopener ugc nofollow" target="_blank">sparse _ categorial _ cross entropy</a>，它基本上是一个 categorial _ cross entropy，它不需要将标签表示为独热向量，而只是表示为整数，在这种情况下对应于有效游戏结果的索引。</p><p id="8799" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该网络可以训练几十个时期和小批量。这种图的关键特征是训练和验证损失之间的必要一致。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9c8749b5ee7367b4a78eb0507be03273.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*DCm-m-57wAlxI_6uMeGJEQ.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">作为训练时期的函数的训练(蓝色)和验证(橙色)损失。</p></figure><h2 id="c22b" class="lw lx it bd ly lz ma dn mb mc md dp me kr mf mg mh kv mi mj mk kz ml mm mn mo bi translated">决赛成绩</h2><p id="beff" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">为了得到最终结果，训练好的网络被多次调用，每次比赛调用一次。首先，有必要定义一下互相对抗的队伍的名字。每个名字都被转换成一个表示索引的整数，该整数又被用于获取给定团队和给定年份(在本例中为 2020 年)的输入特征。</p><pre class="lh li lj lk gt nm nn no np aw nq bi"><span id="93e7" class="lw lx it nn b gy nr ns l nt nu">first_round = [<br/>  ["milwaukee bucks", "orlando magic"],<br/>  ["miami heat", "indiana pacers"],<br/>  ["boston celtics", "philadelphia 76ers"],<br/>  ["toronto raptors", "brooklyn nets"],<br/>  ["los angeles lakers", "portland trail blazers"],<br/>  ["oklahoma city thunder", "houston rockets"],<br/>  ["denver nuggets", "utah jazz"],<br/>  ["los angeles clippers", "dallas mavericks"]]</span></pre><p id="9373" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，该程序计算第一轮的结果，并根据结果，为半决赛、决赛和决赛创建类似的列表。</p><p id="6ffb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以…预测如下:</p><p id="069c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第一轮</strong></p><ul class=""><li id="eab1" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated">密尔沃基雄鹿队 4-3 奥兰多魔术队</li><li id="11b4" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">迈阿密热火队 4-3 印第安纳步行者队</li><li id="9c0c" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">波士顿凯尔特人队 4 比 1 费城 76 人队</li><li id="9f76" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">多伦多猛龙队 4 比 1 布鲁克林篮网队</li><li id="9e8c" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">洛杉矶湖人队 2-4 波特兰开拓者队</li><li id="bf96" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">俄克拉荷马雷霆队 2-4 休斯顿火箭队</li><li id="5c76" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">丹佛掘金队 2-4 犹他爵士队</li><li id="844a" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">洛杉矶快船队 4-1 达拉斯小牛队</li></ul><p id="10cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">胡人</strong></p><ul class=""><li id="6d43" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated">密尔沃基雄鹿队 4 比 3 迈阿密热火队</li><li id="7300" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">波士顿凯尔特人队 2-4 多伦多猛龙队</li><li id="727a" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">波特兰开拓者队 2-4 休斯顿火箭队</li><li id="1b3b" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">犹他爵士队 2-4 洛杉矶快船队</li></ul><p id="843a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">大会决赛</strong></p><ul class=""><li id="11fc" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated">密尔沃基雄鹿队 4-3 多伦多猛龙队</li><li id="4e10" class="mu mv it kk b kl nd ko ne kr nf kv ng kz nh ld mz na nb nc bi translated">休斯顿火箭队 2-4 洛杉矶快船队</li></ul><p id="3026" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">总决赛</strong></p><ul class=""><li id="fd35" class="mu mv it kk b kl km ko kp kr mw kv mx kz my ld mz na nb nc bi translated">密尔沃基雄鹿队 4 比 1 洛杉矶快船队</li></ul><p id="cf62" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，今年真的是扬尼斯·阿德托昆博年吗？</p></div></div>    
</body>
</html>