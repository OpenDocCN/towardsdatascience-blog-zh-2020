<html>
<head>
<title>Data Leakage with Hyper-Parameter Tuning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超参数调整的数据泄漏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-leakage-with-hyper-parameter-tuning-c57ba2006046?source=collection_archive---------34-----------------------#2020-09-13">https://towardsdatascience.com/data-leakage-with-hyper-parameter-tuning-c57ba2006046?source=collection_archive---------34-----------------------#2020-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c0e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">超参数调优有时会打乱您的模型，并导致对看不见的数据产生不可预测的结果。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7c421f46d5a8b26411cb2d73f60966d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6lapZ6guKeWg1sCP7E37w@2x.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="138f" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="df32" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi mm translated"><span class="l mn mo mp bm mq mr ms mt mu di"> D </span> <strong class="ls iu">数据泄漏</strong>是指模型在其训练阶段不知何故知道了测试数据中的模式。换句话说，你用来训练最大似然算法的数据恰好包含了你试图预测的信息。</p><p id="1afc" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">数据泄漏阻碍了模型的推广。数据科学家很难识别数据泄露。数据泄露的一些原因是</p><ul class=""><li id="769d" class="na nb it ls b lt mv lw mw lz nc md nd mh ne ml nf ng nh ni bi translated">分割前使用中心值处理异常值和缺失值</li><li id="50fc" class="na nb it ls b lt nj lw nk lz nl md nm mh nn ml nf ng nh ni bi translated">在划分为培训和测试之前，对数据进行缩放</li><li id="c072" class="na nb it ls b lt nj lw nk lz nl md nm mh nn ml nf ng nh ni bi translated">使用训练和测试数据训练您的模型。</li></ul><p id="c20f" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated"><strong class="ls iu">超参数调整</strong>是寻找提供最佳性能的 ML 算法的最佳超参数集的过程。</p><p id="76ae" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">关于超参数和调优技术的更多信息，请参考我以前的文章。</p><div class="no np gp gr nq nr"><a href="https://medium.com/swlh/4-hyper-parameter-tuning-techniques-924cb188d199" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">4 种超参数调整技术</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">每个数据科学家都应该知道的流行超参数调整技术</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><p id="1adf" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">大多数超参数调整技术使用交叉验证来选择最佳超参数集。交叉验证将数据分成训练测试集，在训练集上用不同的超参数集建立不同的模型，并在测试集上验证性能。最终，它会选择最佳的参数组合来获得最高的性能。</p><p id="4e43" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">但是，当我们使用网格搜索、随机搜索等交叉验证的调整技术执行缩放、输入等预处理步骤时，会导致数据泄漏。</p><p id="eb94" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">让我们用代码更详细地理解这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="0871" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">在上面的代码中，我首先对训练数据执行缩放(StandardScaler <strong class="ls iu"> ) </strong>，然后使用支持向量分类器作为<em class="oi">估计器和 cv = </em> 3 <em class="oi">即</em> 3 重交叉验证来训练我的 GridSearchCV。使用三重交叉验证，训练数据将分成 3 组，在每组中，它进一步分成 2 组作为训练集，1 组作为测试集。对于具有唯一参数集的每个模型，将在训练集上进行训练，并在测试集上进行评估，稍后将评估分数并丢弃模型。这一过程对所有 3 组继续进行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/5364b4d119e14cd0dcd75a3239ca5fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iax9jnl5X2J5Wti4029eDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3361" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">这里的模型在训练时受到了测试集中的数据的影响(数据泄漏),数据是用 StandardScaler 操作泄漏的。标准标度/ z 分数通过平均值和标准差计算得出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ed6afd73e9f586f91d3cd253387aedbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*m823FnsPYCCNVTcuEsiVVg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="40d8" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">在网格搜索之前，对列车数据进行了缩放(<strong class="ls iu">平均值和标准缩放器的标准差根据列车数据</strong>进行计算，然后通过交叉验证将列车数据分成列车&amp;测试组。用于训练/拟合算法的训练组已经有了关于测试组的信息(即训练数据的平均值和标准差，它是训练&amp;测试组的组合)。这就是超参数调优发生数据泄漏的原因。</p><h1 id="34c8" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">解决办法</h1><p id="712a" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这种情况下数据泄露的解决方案是<strong class="ls iu">管道。</strong></p><p id="cd32" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">一个<strong class="ls iu">管道</strong>被用来帮助自动化机器学习工作流，如缩放、降维、模型拟合和验证等。它基本上在机器学习过程中采取多个步骤，并将其组合成单个对象，这使得开发和使用以及保存和以后重用都变得更容易。</p><p id="fabe" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">我们先来了解一下 pipeline 是如何用代码解决数据泄露的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="5499" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">在上面的代码中，我将 StandardScaler 和 SVC 与 pipeline 一起使用，然后将 pipeline 对象传递给 cv = 3 的网格搜索。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/9f387978baa467adb1035815175b4aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aGicWPpkP3QPuv9ev7j1QA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7654" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">在这种情况下，数据首先被分成 3 组(cv=3)，即 2 个训练组和 1 个测试组。在每个组上，将执行缩放。所以，这里没有数据泄露。</p><p id="ea01" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">这样，我们可以成功地避免数据泄漏。</p><h1 id="8866" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="26c7" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">使用交叉验证技术进行超参数调整时，应注意数据泄漏。在这种情况下，使用管道将有助于避免数据泄漏。</p><h1 id="edf4" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">感谢您的阅读！</h1><p id="4c54" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">非常感谢您的任何反馈和意见！</p><p id="b947" class="pw-post-body-paragraph lq lr it ls b lt mv ju lv lw mw jx ly lz mx mb mc md my mf mg mh mz mj mk ml im bi translated">你可能喜欢我的其他文章，</p><div class="no np gp gr nq nr"><a rel="noopener follow" target="_blank" href="/data-leakage-with-hyper-parameter-tuning-c57ba2006046"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">超参数调整的数据泄漏</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">超参数调优有时会打乱您的模型，并导致对看不见的数据产生不可预测的结果。</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">towardsdatascience.com</p></div></div><div class="oa l"><div class="om l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://medium.com/swlh/is-and-in-python-f084f36cbc0e" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">Python 中的“是”和“==”</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">加快字符串比较的速度</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="on l oc od oe oa of ks nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://medium.com/swlh/4-hyper-parameter-tuning-techniques-924cb188d199" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">4 种超参数调整技术</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">每个数据科学家都应该知道的流行超参数调整技术</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div></div></div>    
</body>
</html>