# ä»€ä¹ˆæ˜¯äº¤å‰ç†µï¼Ÿ

> åŸæ–‡ï¼š<https://towardsdatascience.com/what-is-cross-entropy-3bdb04c13616?source=collection_archive---------2----------------------->

## äº¤å‰ç†µçš„ç®€è¦è¯´æ˜:ä»€ä¹ˆæ˜¯äº¤å‰ç†µï¼Œå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠç¤ºä¾‹ä»£ç 

![](img/b689594ddc309941e8ca941c468720ad.png)

ä» [ImgFlip](https://imgflip.com/memegenerator) ç”Ÿæˆçš„å›¾åƒ

> *äº¤å‰ç†µæ˜¯åˆ†ç±»é—®é¢˜ä¸­å¸¸ç”¨çš„æŸå¤±å‡½æ•°ã€‚*

å‡ å‘¨å‰ï¼Œæˆ‘åšäº†ä¸€ä¸ªç›¸å½“é‡å¤§çš„å†³å®šã€‚å¤œæ·±äº†ï¼Œæˆ‘èººåœ¨åºŠä¸Šæƒ³ç€ä¸€å¤©æ˜¯æ€ä¹ˆè¿‡çš„ã€‚å› ä¸ºæˆ‘ä¸€ç›´æ˜¯ä¸€ä¸ªåˆ†æè‡ªå·±é€‰æ‹©çš„äººï¼Œæ‰€ä»¥æˆ‘é—®äº†è‡ªå·±ä¸¤ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ã€‚

1.  æˆ‘åº”è¯¥åœ¨ç¡è§‰å‰åœæ­¢åƒè–¯æ¡å—ï¼Ÿå®ƒä»¬ç›¸å½“ä¸å¥åº·â€¦
2.  æˆ‘æ˜¯å¦æŒ‰ç…§è‡ªå·±æƒ³è¦çš„æ–¹å¼åº¦è¿‡æ—¶é—´ï¼Ÿ

åœ¨è€ƒè™‘äº†è¿™äº›æƒ³æ³•ä¹‹åï¼Œæˆ‘æ„è¯†åˆ°è¿™ä¸¤ä¸ªé—®é¢˜çš„ç­”æ¡ˆéƒ½æ˜¯å¦å®šçš„ã€‚ä¸ï¼Œæˆ‘ä¸åº”è¯¥åœ¨ç¡è§‰å‰åœæ­¢åƒè–¯æ¡ã€‚ä¸ï¼Œæˆ‘æ²¡æœ‰ç”¨æˆ‘æƒ³è¦çš„æ–¹å¼åº¦è¿‡æˆ‘çš„æ—¶é—´ã€‚å› æ­¤ï¼Œå‡ å‘¨å‰ï¼Œæˆ‘å†³å®šå°½æˆ‘æ‰€èƒ½å­¦ä¹ å…³äºæ·±åº¦å­¦ä¹ è¿™ä¸€æ–°å…´é¢†åŸŸçš„ä¸€åˆ‡ã€‚æˆ‘è¿˜é€‰æ‹©å†™ä¸‹æˆ‘æ‰€å­¦åˆ°çš„ä¸€åˆ‡(æ‰€ä»¥å¦‚æœä½ å¯¹æ—…ç¨‹æ„Ÿå…´è¶£ï¼Œä¸€å®šè¦[è·Ÿéšæˆ‘](https://medium.com/@anjalibhardwaj2700))ã€‚è¿™äº›æ–‡ç« çš„çµæ„Ÿæ¥è‡ª Udacity çš„ä¸€é—¨è¯¾ç¨‹ï¼Œåä¸º[ç”¨ PyTorch è¿›è¡Œæ·±åº¦å­¦ä¹ ](https://www.udacity.com/course/deep-learning-pytorch--ud188)ã€‚æˆ‘å¼ºçƒˆå»ºè®®ä½ å»çœ‹çœ‹ã€‚

å¦‚æœä½ æ˜¯ä»æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« æ¥åˆ°è¿™é‡Œçš„ï¼Œä½ å·²ç»çŸ¥é“æˆ‘ä»¬æ­£åœ¨åŠªåŠ›å¯»æ‰¾æ•°æ®åˆ†ç±»çš„æœ€ä½³æ–¹æ³•ã€‚ä¸ºäº†å¯¹æ•°æ®è¿›è¡Œæœ€ä½³åˆ†ç±»ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–æ¨¡å‹çš„æ¦‚ç‡ï¼Œæœ€å°åŒ–å…¶è¯¯å·®å‡½æ•°ã€‚è¿™ä¸¤ä»¶äº‹æ˜¯åå‘ç›¸å…³çš„ã€‚äº¤å‰ç†µåŸºäºæ¦‚ç‡å’Œè¯¯å·®æ¥è¡¡é‡åˆ†ç±»æ¨¡å‹çš„æ€§èƒ½ï¼Œå…¶ä¸­æŸä¸ªäº‹ç‰©çš„å¯èƒ½æ€§è¶Šå¤§ï¼Œäº¤å‰ç†µå°±è¶Šä½ã€‚è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°ç ”ç©¶è¿™ä¸ªé—®é¢˜ã€‚

# äº¤å‰ç†µ 101

äº¤å‰ç†µæ˜¯ä¸€ä¸ª[æŸå¤±å‡½æ•°](https://machinelearningmastery.com/loss-and-loss-functions-for-training-deep-learning-neural-networks/)ï¼Œå¯ä»¥ç”¨æ¥é‡åŒ–ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚è¿™å¯ä»¥é€šè¿‡ä¸€ä¸ªä¾‹å­å¾—åˆ°æœ€å¥½çš„è§£é‡Šã€‚

å‡è®¾ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ¨¡å‹ï¼ŒA å’Œ Bï¼Œæˆ‘ä»¬æƒ³æ‰¾å‡ºå“ªä¸ªæ¨¡å‹æ›´å¥½ï¼Œ

![](img/63e60e5cf9c978b174649c7de3959da5.png)

ä½œè€…å›¾ç‰‡

> *æ³¨æ„:æ•°æ®ç‚¹é™„è¿‘çš„æ•°å­—ä»£è¡¨è¯¥ç‚¹æ˜¯è¯¥é¢œè‰²çš„æ¦‚ç‡ã€‚ä¾‹å¦‚ï¼Œæ¨¡å‹ A ä¸­å›¾å½¢é¡¶éƒ¨çš„è“ç‚¹æ˜¯è“è‰²çš„æ¦‚ç‡æ˜¯ 0.4ã€‚*

å‡­ç›´è§‰ï¼Œæˆ‘ä»¬çŸ¥é“æ¨¡å‹ B æ›´å¥½ï¼Œå› ä¸ºçº¢ç‚¹åœ¨çº¢è‰²åˆ†å¸ƒä¸Šï¼Œè“ç‚¹åœ¨è“è‰²åˆ†å¸ƒä¸Šã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•è®©ä¸€ä¸ªæ¨¡å‹é¢„æµ‹è¿™ä¸ªå‘¢ï¼Ÿ

ä¸€ç§æ–¹æ³•æ˜¯å°†æ¨¡å‹ A ä¸­æ¯ä¸ªç‚¹çš„æ¦‚ç‡ç›¸ä¹˜ã€‚è¿™å°†ç»™å‡ºæ¨¡å‹çš„æ€»æ¦‚ç‡ï¼Œæ­£å¦‚æˆ‘ä»¬ä»æ¦‚ç‡ä¸­çš„[ä¸€èˆ¬ä¹˜æ³•æ³•åˆ™æ‰€çŸ¥ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ¨¡å‹ B åšç±»ä¼¼çš„äº‹æƒ…ï¼Œ](https://www.khanacademy.org/math/ap-statistics/probability-ap/probability-multiplication-rule/a/general-multiplication-rule#:~:text=When%20we%20calculate%20probabilities%20involving,probability%20of%20the%20second%20event.)

![](img/658fcb2b25e59a042736d44236b10bfb.png)

ä½œè€…å›¾ç‰‡

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæœ€æœ‰å¯èƒ½çš„æ¨¡å‹æ˜¯æ¨¡å‹ Bï¼Œå› ä¸ºæ¦‚ç‡æ›´é«˜ã€‚å¤ªé…·äº†ï¼æˆ‘ä»¬å¯ä»¥ç”¨æ¦‚ç‡æ¥æ‰¾å‡ºå“ªä¸ªæ¨¡å‹æ›´å¥½ã€‚

é™¤äº†â€¦â€¦è¿™ä¸ªæ¨¡å‹æœ‰äº›é—®é¢˜ã€‚æ­£å¦‚ä½ å¯èƒ½å·²ç»çŒœåˆ°çš„ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è®¸å¤šæ•°æ®ç‚¹ï¼Œè¿™å°†å¯¼è‡´ç»“æœæ¦‚ç‡éå¸¸å°ã€‚æ­¤å¤–ï¼Œå¦‚æœæˆ‘ä»¬æ”¹å˜äº†ä¸€ä¸ªæ•°æ®ç‚¹ï¼Œé‚£ä¹ˆç»“æœæ¦‚ç‡å°±ä¼šå‘ç”Ÿå·¨å¤§å˜åŒ–ã€‚

ç®€è€Œè¨€ä¹‹ï¼Œä½¿ç”¨äº§å“å¹¶ä¸æ˜¯æœ€å¥½çš„ä¸»æ„ã€‚é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿä¸€ç§æ–¹æ³•æ˜¯ç”¨æ±‚å’Œæ¥ä»£æ›¿ã€‚å¦‚æœæ‚¨è®°å¾—æ‚¨çš„[æ—¥å¿—è§„åˆ™](https://www.rapidtables.com/math/algebra/Logarithm.html)ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥å°†ä¹˜ç§¯ä¸æ€»å’Œè”ç³»èµ·æ¥ï¼Œ

![](img/b9aebd202a374abc7d2326d904b20f4a.png)

ä½œè€…å›¾ç‰‡

è®©æˆ‘ä»¬æŠŠè¿™ä¸ªè§„åˆ™åº”ç”¨åˆ°æˆ‘ä»¬çš„æ¦‚ç‡ä¸Šï¼Œ

![](img/af654c7f0705cd7d6588eb3b4d21dd55.png)

ä½œè€…å›¾ç‰‡

ç°åœ¨ï¼Œè¿™å‡ ä¹çœ‹èµ·æ¥ä¸é”™ï¼Œä½†è®©æˆ‘ä»¬é€šè¿‡ä½¿å¯¹æ•°ä¸ºè´Ÿå€¼æ¥æ¶ˆé™¤è´Ÿå€¼ï¼Œè®©æˆ‘ä»¬ä¹Ÿè®¡ç®—ä¸€ä¸‹æ€»æ•°ã€‚

![](img/128e4e56507cb51c2f9aec59970bcdbd.png)

ä½œè€…å›¾ç‰‡

å¯¹æ¦‚ç‡ä½¿ç”¨è´Ÿå¯¹æ•°å°±æ˜¯æ‰€è°“çš„äº¤å‰ç†µï¼Œå…¶ä¸­é«˜æ•°å€¼æ„å‘³ç€åæ¨¡å‹ï¼Œä½æ•°å€¼æ„å‘³ç€å¥½æ¨¡å‹ã€‚

å½“æˆ‘ä»¬è®¡ç®—æ¯ä¸ªæ•°æ®ç‚¹çš„å¯¹æ•°æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¾—åˆ°æ¯ä¸ªç‚¹çš„è¯¯å·®å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œæ¨¡å‹ A ä¸­ç‚¹ 0.2 çš„è¯¯å·®å‡½æ•°ä¸º-ln(0.2)ï¼Œç­‰äº 1.61ã€‚è¯·æ³¨æ„ï¼Œè¢«é”™è¯¯åˆ†ç±»çš„ç‚¹å…·æœ‰è¾ƒå¤§çš„å€¼ï¼Œå› æ­¤å…·æœ‰è¾ƒå¤§çš„è¯¯å·®ã€‚

æ‰€ä»¥è®©æˆ‘ä»¬å¤šç†è§£ä¸€ç‚¹äº¤å‰ç†µã€‚äº¤å‰ç†µçœŸæ­£æƒ³è¯´çš„æ˜¯ï¼Œå¦‚æœä½ æœ‰äº‹ä»¶å’Œæ¦‚ç‡ï¼ŒåŸºäºæ¦‚ç‡äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§æœ‰å¤šå¤§ï¼Ÿå¦‚æœå¯èƒ½æ€§å¾ˆå¤§ï¼Œæˆ‘ä»¬å°±æœ‰ä¸€ä¸ªå°çš„äº¤å‰ç†µï¼Œå¦‚æœå¯èƒ½æ€§ä¸å¤§ï¼Œæˆ‘ä»¬å°±æœ‰ä¸€ä¸ªå¤§çš„äº¤å‰ç†µã€‚æˆ‘ä»¬å°†åœ¨ä¸€ä¸ªä¾‹å­åçœ‹åˆ°æ›´å¤š

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å‡è®¾ä¸‰æ‰‡é—¨åæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œæˆ‘ä»¬æœ‰ä¸€å¼ å¦‚ä¸‹æ‰€ç¤ºçš„æ¡Œå­ï¼Œ

![](img/aba3f634c6e107a00a5a590ec53618cd.png)

ä½œè€…å›¾ç‰‡

> æ³¨æ„:æœ‰æ›´å¤šçš„å¯èƒ½æ€§

è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœäº¤å‰ç†µå¾ˆå¤§ï¼Œé‚£ä¹ˆäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡å°±å¾ˆä½ï¼Œåä¹‹äº¦ç„¶ã€‚

è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚å‡è®¾ï¼Œæˆ‘ä»¬å–ç¬¬ä¸€ç§æƒ…å†µï¼Œé—¨ 1 æ˜¯ p(gift) = 0.8ï¼Œé—¨ 2 æ˜¯ p(gift) =0.7ï¼Œé—¨ 3 æ˜¯ p(gift)=0.1ï¼Œ

![](img/522fed3c30fb1e6f78c6ef36f64325d9.png)

ä½œè€…å›¾ç‰‡

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å°†ç¬¬ä¸‰æ‰‡é—¨æè¿°ä¸º 1-pï¼Œè¿™æ„å‘³ç€ 1 å‡å»æœ‰ç¤¼ç‰©çš„æ¦‚ç‡ã€‚è¿™æ ·ä¼šç»™æˆ‘ä»¬æ²¡æœ‰ç¤¼ç‰©çš„æ¦‚ç‡ã€‚å¦å¤–ï¼Œæ³¨æ„ y æè¿°äº†é—¨åæœ‰å¤šå°‘ç¤¼ç‰©ã€‚

æ‰€ä»¥äº¤å‰ç†µå¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼æ¥æè¿°ï¼Œ

![](img/fbd7d2f15d84e296b7f0f3c24c9cba70.png)

ä½œè€…å›¾ç‰‡

> æ³¨æ„:è¿™æ˜¯æè¿°è´Ÿå¯¹æ•°çš„å¦ä¸€ç§æ–¹å¼ã€‚

è¿™ä¸ªå…¬å¼è®¡ç®—äº†ä¸Šè¿°æƒ…å†µçš„ç†µã€‚å®ƒè®¡ç®—è´Ÿå¯¹æ•°ï¼Œä¹Ÿå°±æ˜¯äº¤å‰ç†µã€‚

è¿™ä¸ªå‡½æ•°çš„æœ‰ç”¨ä¹‹å¤„åœ¨äºå®ƒä¹Ÿå¯ä»¥å†™æˆè¿™ç§å½¢å¼ï¼Œ

![](img/b855636a4ceebd25dd6fb46d886c79ac.png)

ä½œè€…å›¾ç‰‡

> æ³¨æ„:è¿™ä¸ªå…¬å¼åªé’ˆå¯¹äºŒå…ƒäº¤å‰ç†µã€‚å¦‚æœä½ å¯¹å¤šç±»äº¤å‰ç†µæ„Ÿå…´è¶£ï¼Œçœ‹çœ‹è¿™ä¸ªè§†é¢‘å§ï¼

è¯¥å‡½æ•°å…è®¸ä¸¤ä¸ªå‡½æ•°ï¼Œp(x)å’Œ q(x)ã€‚æˆ‘ä»¬å¯ä»¥æŠŠ p(x)æè¿°ä¸ºæœŸæœ›æ¦‚ç‡ï¼Œq(x)æè¿°ä¸ºå®é™…æ¦‚ç‡ã€‚

å› æ­¤ï¼Œäº¤å‰ç†µå…¬å¼æè¿°äº†é¢„æµ‹åˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒçš„æ¥è¿‘ç¨‹åº¦ã€‚

## ç»“è®º

æ€»çš„æ¥è¯´ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œäº¤å‰ç†µåªæ˜¯ä¸€ç§åº¦é‡æ¨¡å‹æ¦‚ç‡çš„æ–¹æ³•ã€‚äº¤å‰ç†µæ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥æè¿°æ¨¡å‹çš„å¯èƒ½æ€§ä»¥åŠæ¯ä¸ªæ•°æ®ç‚¹çš„è¯¯å·®å‡½æ•°ã€‚å®ƒè¿˜å¯ä»¥ç”¨æ¥æè¿°ä¸çœŸå®ç»“æœç›¸æ¯”çš„é¢„æµ‹ç»“æœã€‚æ‰€ä»¥å¸Œæœ›ä½ å¼€å§‹çœ‹åˆ°è¿™æ˜¯å¤šä¹ˆå¼ºå¤§ï¼

## ä¸€äº›ä»£ç 

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨ python æ¥ç¼–å†™ä»£ç ï¼

```
import numpy as np# This function takes as input two lists Y, P,
# and returns the float corresponding to their cross-entropy.def cross_entropy(Y, P):
    Y = np.float_(Y)
    P = np.float_(P)
    return -np.sum(Y * np.log(P) + (1 - Y) * np.log(1 - P))
```

*è¿™æ®µä»£ç ç›´æ¥å–è‡ª Udacity è¯¾ç¨‹ï¼Œ* [*æ·±åº¦å­¦ä¹ ç”¨ PyTorchã€‚*](https://classroom.udacity.com/courses/ud188/lessons/b4ca7aaa-b346-43b1-ae7d-20d27b2eab65/concepts/760235e0-a3ec-4e56-8cdb-56d762886690)

è¿™ä¸ªç®€å•çš„ä»£ç æ¥å—ä¸¤ä¸ªè¾“å…¥å¹¶è¿”å›äº¤å‰ç†µã€‚

# å…³é”®è¦ç‚¹

**ä»€ä¹ˆæ˜¯äº¤å‰ç†µï¼Ÿ**
äº¤å‰ç†µæ˜¯ä¸€ä¸ª[æŸå¤±å‡½æ•°](https://machinelearningmastery.com/loss-and-loss-functions-for-training-deep-learning-neural-networks/)ï¼Œç”¨äºé‡åŒ–ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„å·®å¼‚ã€‚

# Weekâœ¨çš„ DL è§†é¢‘

è¿™ä¸ªäººå·¥æ™ºèƒ½å¯ä»¥æŠŠä½ çš„è„¸å˜æˆè¿ªæ–¯å°¼äººç‰©ï¼

# é¢å¤–èµ„æº/å¼•ç”¨

[è¿™æ˜¯ä¸€ä¸ªå…³äºäº¤å‰ç†µçš„å¾ˆå¥½çš„å½¢å¼ã€‚](https://stackoverflow.com/questions/41990250/what-is-cross-entropy)

å…³äºäº¤å‰ç†µçš„å®Œç¾çš„[å¤‡å¿˜å•](https://ml-cheatsheet.readthedocs.io/en/latest/loss_functions.html)

# ä½ èƒ½åœ¨å“ªé‡Œæ‰¾åˆ°æˆ‘ğŸ˜

[æˆ‘çš„ LinkedInï¼è¯·éšæ—¶ä¸æˆ‘è”ç³»ï¼Œæˆ‘å–œæ¬¢è°ˆè®ºäººå·¥æ™ºèƒ½ï¼](http://www.linkedin.com/in/anjalibhardwaj2700)

[å…³æ³¨æˆ‘çš„ä¸­é¡µäº†è§£æ›´å¤š](https://medium.com/@anjalibhardwaj2700)ï¼