<html>
<head>
<title>Exploring the Python Pandas Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Python熊猫图书馆</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-the-python-pandas-library-67243960271e?source=collection_archive---------40-----------------------#2020-04-26">https://towardsdatascience.com/exploring-the-python-pandas-library-67243960271e?source=collection_archive---------40-----------------------#2020-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5782" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python熊猫图书馆</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/91f3383e22d702385a2c5a6cf7e66e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8CmE8D9sfb2_yJubxF74w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/marketing-iphone-smartphone-notebook-97078/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="9ce0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个python库，用于从数据中分析、转换和生成统计数据。在本帖中，我们将讨论Pandas中用于数据争论和探索的几种有用的方法。出于我们的目的，我们将使用来自<a class="ae ky" href="https://www.kaggle.com/mirichoi0218/insurance" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的<em class="lv">医疗费用个人数据集</em>数据。</p><p id="8e48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><h1 id="8d33" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">读取数据</strong></h1><p id="f311" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">首先，让我们导入pandas库:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="9687" class="my lx it mu b gy mz na l nb nc">import pandas as pd</span></pre><p id="9ade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们读入熊猫数据框。Pandas数据框基本上是一个由行和列组成的类似于表格数组的数据结构。为了读入数据，我们可以使用。read_csv()'方法:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="fd4f" class="my lx it mu b gy mz na l nb nc">df = pd.read_csv("insurance.csv")</span></pre><p id="aea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们可以使用。head()'和'。tail()'方法分别查看第一行和最后五行数据:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a5bd" class="my lx it mu b gy mz na l nb nc">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/1b7234d352317918408f0be31404f9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuZf65utz_pgTGalDW6IXw.png"/></div></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bb37" class="my lx it mu b gy mz na l nb nc">print(df.tail())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/04fb316d64c858bf12f72ecef791e297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hL1V3mMOVi677t111sy-5A.png"/></div></div></figure><p id="d155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以查看列名:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bad5" class="my lx it mu b gy mz na l nb nc">print(df.columns)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/4ecfaf0c3f483e77fb14a52a29557bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f_ScPJcDzBTovJjRNMGOig.png"/></div></div></figure><p id="bd32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这对于包含大量列的数据集尤其有用。</p><h1 id="0028" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">清洗数据</strong></h1><p id="3680" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">很多时候，当使用真实数据时，我们必须处理数据列中缺失的值。使用pandas，我们可以很快了解数据有多稀疏。isnull()”方法:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8e6e" class="my lx it mu b gy mz na l nb nc">print(df.isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/56539d763c57bf603f2fd6a7b596faa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*Ghx8wW9UvO64OMDfV5f9XQ.png"/></div></figure><p id="bbb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到该数据不包含任何缺失值。让我们人为地为“儿童”和“地区”列添加缺失的值，以演示我们如何删除这些值:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="35a8" class="my lx it mu b gy mz na l nb nc">df.loc[df.region == 'southwest', 'region'] = np.nan<br/>df.loc[df.children == 1, 'children'] = np.nan</span></pre><p id="577c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们计算一下我们添加的缺失值的数量:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0a3e" class="my lx it mu b gy mz na l nb nc">print(df.isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6c0c07fd24b0a334d8c8ac10aab939b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*cYCZSsZnAbGe1EUd-y9S4g.png"/></div></div></figure><p id="693e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用。“dropna()”方法来移除这些缺少的值。这既可以就地完成，也可以返回一个值，存储在一个新的变量中。为了适当地删除丢失的值，我们执行以下操作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b8ab" class="my lx it mu b gy mz na l nb nc">df.dropna(inplace=True)<br/>print(df.isnull().sum())</span></pre><p id="1a80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，df变量已经被修改。或者，我们可以执行以下操作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="cbed" class="my lx it mu b gy mz na l nb nc">df = df.dropna()</span></pre><p id="0253" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们再次打印缺失的值:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a12e" class="my lx it mu b gy mz na l nb nc">print(df.isnull().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/7e5f353eaee6ead49fc9b43a14ab0f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*0chkTh53v_4aPsVQfC6XHw.png"/></div></figure><p id="1067" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以在丢失值之前和之后检查数据帧的长度:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="efa7" class="my lx it mu b gy mz na l nb nc">print("Length Before:", len(df))<br/>df.dropna(inplace=True)<br/>print("Length After:", len(df))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/30f6a512804810f3f690f887b1826255.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*Xj4mLwVP2T6-QNzwKDinrQ.png"/></div></figure><p id="93d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，如果想要填充数据框中缺失的值，可以使用。fillna()”方法。要做到这一点:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e459" class="my lx it mu b gy mz na l nb nc">df.fillna(0, inplace=True)</span></pre><p id="faaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2ecc" class="my lx it mu b gy mz na l nb nc">df = df.fillna(0)</span></pre><p id="edb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于我们输入的是缺失值，因此数据帧的长度不应改变:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8f7d" class="my lx it mu b gy mz na l nb nc">print("Length Before:", len(df))<br/>df.fillna(0, inplace=True)<br/>print("Length After:", len(df))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/56b81b4b0d03f2230dcd61e31ac081b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*XMezy2QJ02tLaj--pS7ndw.png"/></div></figure><h1 id="fef0" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">过滤数据</strong></h1><p id="0425" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们可以根据列值轻松过滤数据帧。例如，如果我们想要对应于30岁以下患者的记录，我们可以写:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="38b7" class="my lx it mu b gy mz na l nb nc">df = df[df['age'] &lt; 30]<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/0a71b5212de9cc06025031f7db8ed0b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2YObMPWZ9btjejNxtiVW5g.png"/></div></div></figure><p id="31ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想要与超过10，000美元的费用相对应的记录，我们可以写:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ebca" class="my lx it mu b gy mz na l nb nc">df = df[df['charges'] &gt; 10000]<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/06fcea98991ab4cff1cca144501a611d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTfbBgGgfHllO-bO49W9nw.png"/></div></div></figure><p id="804d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以过滤数据框，仅包含吸烟者:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="e387" class="my lx it mu b gy mz na l nb nc">df = df[df['smoker'] == 'yes']</span></pre><p id="b9ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印前五行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="4cb5" class="my lx it mu b gy mz na l nb nc">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/3d7028edb1e1085d86aa6779d7509b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-LTdDJog0hYaZSTzQciX5A.png"/></div></div></figure><p id="595b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，在删除数据后，索引已经被修改。我们可以通过使用“reset_index”方法来解决这个问题:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f561" class="my lx it mu b gy mz na l nb nc">df.reset_index(inplace=True)<br/>del df['index']<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/4bb7ff8bcc92853930e3f86d28bb4c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsvjM_nxFh0B25ZWeqwMPg.png"/></div></div></figure><p id="4695" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用多个条件进行过滤。假设我们想要提取与女性吸烟者相对应的数据。我们可以使用。loc[]'方法如下:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5bb7" class="my lx it mu b gy mz na l nb nc">df = df.loc[(df.sex == 'female') &amp; (df.smoker == 'yes')]<br/>df.reset_index(inplace=True)<br/>del df['index']<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/2ece1a05f6b95176207cfa35ed328d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvbzvHh53UXT0lETU6T4rA.png"/></div></div></figure><p id="f863" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们甚至可以添加两个以上的条件。让我们过滤50岁以上的女性吸烟者:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="aa58" class="my lx it mu b gy mz na l nb nc">df = df.loc[(df.sex == 'female') &amp; (df.smoker == 'yes') &amp; (df.age &gt;= 50)]<br/>df.reset_index(inplace=True)<br/>del df['index']<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1a34c30ef4e8f8c5af793d58408530f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHNaMBLBY2RSapMrhqPXMg.png"/></div></div></figure><h1 id="cc5a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">选择行和列</strong></h1><p id="5f90" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在我们将讨论如何使用。iloc[]'方法来选择索引。为了选择数据集中的第一个、第二个和最后一个索引，我们执行以下操作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0256" class="my lx it mu b gy mz na l nb nc">print(df.head())<br/>print("---------------------First---------------------")<br/>print(df.iloc[0])<br/>print("---------------------Second---------------------") <br/>print(df.iloc[1])<br/>print("---------------------Last---------------------")<br/>print(df.iloc[-1])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/4323c052adb00bf179edc1595f157735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*PQDmU4b6Os5PqdAkPcPWXA.png"/></div></figure><p id="6205" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以用'做类似的事情。特定列的loc[]。要选择第一行和第二行，我们执行以下操作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c1f5" class="my lx it mu b gy mz na l nb nc">print("---------------------First---------------------")<br/>print(df.loc[0, 'sex'])<br/>print("---------------------Second---------------------") <br/>print(df.loc[1, 'sex'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/592d640ec56214f9cfdf5090babcb8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*7gPsCP8WsjZuZ_r5g6ZKiw.png"/></div></figure><p id="4ca3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以在一列中选择多行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="45ab" class="my lx it mu b gy mz na l nb nc">print("---------------------First---------------------")<br/>print(df.loc[0:3, 'sex'])<br/>print("---------------------Second---------------------") <br/>print(df.loc[3:6, 'sex'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/d3a4210d643f679e5276cda4e795da0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sjyeeR4sJgo59B3L8HOoKQ.png"/></div></div></figure><h1 id="f3c6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">汇总数据&amp;生成统计数据</strong></h1><p id="5bcc" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在，我们将讨论如何从数据框中的数据生成统计数据。我们可以为特定类别创建单独的数据框，并从结果数据框中生成统计数据。让我们为男性和女性记录创建单独的数据框:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="09fd" class="my lx it mu b gy mz na l nb nc">df_female = df[df['sex'] == 'female']<br/>df_male = df[df['sex'] == 'male']</span></pre><p id="1e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看女性的平均费用:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7d85" class="my lx it mu b gy mz na l nb nc">print("Female charges: ", df_female['charges'].mean())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a11b43a93c4fb992bd1e14f82dcc9e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*zYUgO98cKHS27I7m151VCg.png"/></div></figure><p id="2f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看男性的平均费用:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c33b" class="my lx it mu b gy mz na l nb nc">print("Male charges: ", df_male['charges'].mean())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fecc1521abd382afbdc877abd5c5db87.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*3CgyRzXzpOWXXBBpwvTj6w.png"/></div></figure><p id="76d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以使用'找到任何数字列的最大值。max()”方法。让我们对完整的数据集这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="cb64" class="my lx it mu b gy mz na l nb nc">print("Maximum Value: ", df['charges'].max())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/f01c561246dad159e7d3c14dfdb58229.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*ZcWg1c3oP-K5_vHTpKQ7aQ.png"/></div></div></figure><p id="1172" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以找到最小值:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c759" class="my lx it mu b gy mz na l nb nc">print("Minimum Value: ", df['charges'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3de8bceb79358615f7834221cbdcaed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*L9UyeazKeQ0NlKHYZlooYg.png"/></div></figure><p id="2eda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将这些方法应用于其他数值列。让我们对“年龄”列也这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a3e7" class="my lx it mu b gy mz na l nb nc">print("Maximum Value: ", df['age'].max())<br/>print("Minimum Value: ", df['age'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/38c01bc104c76e1ea4eb447254596a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*I2w2fFd9mHI-JexcmIWaZw.png"/></div></figure><p id="3d79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们对“bmi”列进行同样的操作:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8afd" class="my lx it mu b gy mz na l nb nc">print("Maximum Value: ", df['bmi'].max())<br/>print("Minimum Value: ", df['bmi'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/1659a4781582cc893a9fbd265ecbb2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*7xs2Z064MK51Nf5wTug3wQ.png"/></div></figure><p id="1233" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个有用的方法是。可用于聚合数据的“groupby()”方法。假设我们想知道男性和女性吸烟者的数量:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0436" class="my lx it mu b gy mz na l nb nc">df_yes = df[df['smoker'] == 'yes']<br/>df_yes  = df_yes.groupby(['sex'])['smoker'].count()<br/>print(df_yes.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/944b9c592c820cc480259a47513beb09.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*4n_B7j7xoSGFKB7o3tcFNQ.png"/></div></figure><p id="f634" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到男性吸烟者的数量大于女性吸烟者的数量。我们也可以看看非吸烟者的分组统计数据:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0c8d" class="my lx it mu b gy mz na l nb nc">df_no = df[df['smoker'] == 'no']<br/>df_no  = df_no.groupby(['sex'])['smoker'].count()<br/>print(df_no.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/0893657a02d8b8ebcd5ab7063d53b111.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*Yu_VuB8n7IlbY9UgeLYNfw.png"/></div></figure><p id="a4fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用。“groupby()”方法来获取不同类别类型的平均医疗费用。之前我们看了男性和女性的平均医疗费用。我们可以用'再次生成那些统计数据。groupby()':</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="17f1" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['sex'])['charges'].mean()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/9272f69bd9736810b31185def75ffd76.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*BpGCN15mjDTzkMhUAJ_yww.png"/></div></figure><p id="ecd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以为每个区域组生成这些统计数据:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a0e5" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['region'])['charges'].mean()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/6e1f6ccac89dbeeed93580c962d32850.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*E9Gn7CBIcWWlwAkn7rcyNA.png"/></div></figure><p id="90da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看每个吸烟者群体的平均医疗费用也是很有趣的:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="36d1" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['smoker'])['charges'].mean()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7e497b858b9fe36acef6fe1ed4cc6ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*5g4fkD0-h6O4d9tZG5OdBg.png"/></div></figure><p id="3dca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所料，吸烟者的医疗费用明显高于不吸烟者。我们也可以按吸烟者和性别分组:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="77ce" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['smoker', 'sex'])['charges'].mean()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/2e4f512cd66be4167056dfb093a85426.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*zZE8zq9VHhegxsm41Y-cTQ.png"/></div></figure><p id="3fc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以查看其他统计数据，如跨类别收费的标准偏差。标准差衡量一组值的离差量。在这种情况下，我们将考虑电荷的标准偏差，它对应于电荷数据的分散。让我们来看看不同性别间电荷的标准差:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6c6e" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['sex'])['charges'].std()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/482f32a6a0884648893e1f045562726d.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*qAr_GIMPfLD57n1yAljRHQ.png"/></div></figure><p id="1cf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以查看不同地区的收费标准偏差:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="43fa" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['region'])['charges'].std()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/fbad1640ed53862e5de303a9fdcbc152.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*UW8M9_UJA2BEI4VyVkyrRA.png"/></div></figure><p id="c070" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者我们可以应用。跨多列的“groupby()”。让我们计算跨地区/性别组的费用标准偏差:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5cc7" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['region', 'sex'])['charges'].std()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ce6f4f3f54c2bb37a4a23da511e6ae8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*6rVGazBxy0jN3mUKVqVwTg.png"/></div></figure><p id="83ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们计算不同吸烟者/性别群体的标准偏差:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bb23" class="my lx it mu b gy mz na l nb nc">df  = df.groupby(['smoker', 'sex'])['charges'].std()<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/9b35eec5e898b7b869bc6623efa84276.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*WOk3vKhM_jTry3vOvftBbQ.png"/></div></figure><h1 id="6f45" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">迭代数据帧</strong></h1><p id="9135" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，我们将讨论如何迭代数据框行。我们可以使用一种叫做。iterrows()'，这将允许我们对行和索引值进行迭代:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c640" class="my lx it mu b gy mz na l nb nc">for index, rows in df.iterrows():<br/>    print(index, rows)</span></pre><p id="1528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一些输出值的屏幕截图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/54c2869971859df7bbec4ba75bc89085.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*djPm42d9t16yCMvV-ItF7g.png"/></div></figure><p id="d78f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以为我们的迭代选择特定的行。让我们对“性别”、“费用”和“吸烟者”栏也这样做:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7df2" class="my lx it mu b gy mz na l nb nc">for index, rows in df.iterrows():<br/>    print('sex:', rows['sex'], 'charges:', rows['charges'], 'smoker:', rows['smoker'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/6a16aeb7f5e7aaf1b15f7742283eaef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ta58v-jzmm4693npb6HC-Q.png"/></div></div></figure><p id="143b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以根据其他列的值创建新列。假设我们想要创建一个新列来指定一个记录是否对应于一个女性吸烟者。我们可以使用。iterrows()'和'。用布尔值标记女性吸烟者的at[]'方法:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="94a8" class="my lx it mu b gy mz na l nb nc">for index, rows in df.iterrows():<br/>    if (rows.sex == 'female') and (rows.smoker == 'yes'): <br/>        df.at[index, 'female_smoker'] = True<br/>    else:<br/>        df.at[index, 'female_smoker'] = False</span></pre><p id="8dbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印修改后的数据框的前五行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="a7e1" class="my lx it mu b gy mz na l nb nc">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/0915c240442ff8a1f40a8f5bbffd9426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PMFdsiGJ1VPf35eKo-PrQ.png"/></div></div></figure><p id="3d49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用'执行更复杂的标记。iterrows()'和'。位于[]'。假设我们要创建一列布尔值，对应于50岁以上有孩子的男性吸烟者:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8a8d" class="my lx it mu b gy mz na l nb nc">for index, rows in df.iterrows():<br/>    if (rows.sex == 'male') and (rows.smoker == 'yes') and (rows.age &gt; 50) and (rows.children &gt; 0): <br/>        df.at[index, 'male_smoker_with_children'] = True<br/>    else:<br/>        df.at[index, 'male_smoker_with_children'] = False</span></pre><p id="4b26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印结果数据框的前五行:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="70ac" class="my lx it mu b gy mz na l nb nc">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/d527fba206430d0ae2c83c39ce3c7b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrKv5o8YvCI_lXebrGkyig.png"/></div></div></figure><p id="fd80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以做的另一件事是使用collections模块中的“Counter”方法来了解新列的布尔值分布。让我们将“计数器”方法应用于“女性吸烟者”列:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3d74" class="my lx it mu b gy mz na l nb nc">from collections import Counter<br/>print(Counter(df['female_smoker']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/8fa7f15a1d5a3a8638ed3c26c909ed1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*ljse2D9ozcEia-Y1uVVblg.png"/></div></figure><p id="033d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这对应于115个女性吸烟者的记录。让我们将“计数器”应用于50岁以上有孩子的男性吸烟者一栏:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5254" class="my lx it mu b gy mz na l nb nc">print(Counter(df['male_smoker_with_children']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/f58afdc7cde6626b017f012287269be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*IpAP9duFLF_9UqvbS6RBzg.png"/></div></figure><p id="af5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这相当于21个50岁以上有孩子的男性吸烟者的记录。</p><h1 id="f326" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">写入文件</strong></h1><p id="46b5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">最后，如果我们对数据框进行了足够的修改，以至于我们希望将其保存到一个单独的文件中，那么我们可以使用。“to_csv()”方法:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="16b4" class="my lx it mu b gy mz na l nb nc">df.to_csv("insurance_edit.csv")</span></pre><h1 id="16b3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="37e4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">总之，在这篇文章中，我们讨论了熊猫的几种方法。我们讨论了如何使用Pandas方法读取、清理和过滤数据。我们还讨论了如何生成聚合统计数据、迭代数据帧以及将数据写入新文件。我希望这有所帮助。这篇文章中的代码可以在<a class="ae ky" href="https://github.com/spierre91/saturncloud_blog/blob/master/pandas_tuorials/pandas_methods.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>