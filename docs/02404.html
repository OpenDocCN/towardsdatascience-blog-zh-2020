<html>
<head>
<title>Clustering Customers Using K-means Machine Learning Algorithm (in R)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用K均值机器学习算法对客户进行聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clustering-customers-using-k-means-machine-learning-algorithm-fb0a28948975?source=collection_archive---------12-----------------------#2020-03-07">https://towardsdatascience.com/clustering-customers-using-k-means-machine-learning-algorithm-fb0a28948975?source=collection_archive---------12-----------------------#2020-03-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="759d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这个故事是关于使用K-means算法对网上购物者进行聚类的。一种有趣的方法，使用机器学习来细分您的客户，或者检查您的细分是否正确。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e21da6f0069f4db122878f6fed1f754e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qi0P-t9lkaPMsR642OrSMQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拉胡尔·潘迪特来自Pexels.com的照片</p></figure><h1 id="3577" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么要细分？</h1><p id="3763" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">营销人员的工作是找到客户的模式和共同特征，对他们进行细分。这是你想出正确的信息和渠道与客户沟通并建立持久关系的第一步。</p><p id="6c92" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对具有共同特征的客户进行细分并不容易，需要大量的人力和智慧。</p><h1 id="8e40" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">基于机器学习算法的聚类</h1><p id="922e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">机器学习算法的最新发展给了我们一个新的工具集，使用机器在数据集中寻找模式并创建聚类。无监督学习K-means <strong class="lt iu">算法搜索数据集中的隐藏模式(人类不可见)，并将每个观察值分配到相关的聚类</strong>。我们将使用R进行K均值聚类。</p><h1 id="daad" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">关于数据集</h1><p id="a244" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">数据集是从<a class="ae ky" href="https://www.kaggle.com/arawind/retail-marketing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中获取的。它包含零售购物网站的客户信息。数据集有10个变量和1000条记录(在数据清理之前)。让我们看看数据集的详细信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集中的前几条记录</p></figure><p id="e8b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据集有8个分类变量和2个连续变量(<em class="mu">薪水</em>和<em class="mu">花费金额</em>)。由于缺少很多值，我们将删除<em class="mu">历史</em>变量，剩下7个分类变量。此外，删除缺少值的行会留下994条记录。我们还是好好的:)</p><p id="318a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们把分类变量的因子级别变成整数。例如，对于<em class="mu">年龄</em>设置年轻=0，中间=1，年老=2。对于<em class="mu">性别</em>，设置女性=0，男性=1，其他分类变量也是如此。</p><h2 id="fc2f" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">变量及其分布:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/005ff085e76355d0ae9777f6043eb2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbkdHafYpSdonXuR86z7GA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个分类变量的数据分布</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/c8dcbf86e3c209dd02fa4d59e28122d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qS1g88BUkJBVIAzIbSyfOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连续变量的分布</p></figure><h1 id="273a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相互关系</h1><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="c47f" class="mv la it nk b gy no np l nq nr">cor.matrix &lt;- cor(data, method = "pearson", use = "complete.obs")</span><span id="6bd2" class="mv la it nk b gy ns np l nq nr">corrplot(cor.matrix)</span></pre><p id="922b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">分析9个变量(7个分类变量和2个连续变量)的相关矩阵，揭示了一些直观的见解，其中一些令人惊讶:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/6bc79e90cbfd3f79cce0e9dad91a98b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*1jrGQg4nkCH4uLu4ngttmQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相互关系</p></figure><p id="ef69" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mu">结婚</em>和<em class="mu">工资</em>，以及<em class="mu">花费</em>和<em class="mu">工资</em>都呈高度正相关。</p><p id="bcdd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mu">子女</em>(子女数量)与<em class="mu">年龄</em>呈负相关，在数据集中，老年人有少量子女——要么是0，要么是1。</p><p id="8f80" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">来自关联矩阵的另一个令人惊讶的发现是<em class="mu">结婚了</em>和<em class="mu">有了孩子</em>——他们没有关联。经过调查，我们发现已婚和单身的孩子数量差不多。</p><p id="0cae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不那么令人惊讶和更直观的是，<em class="mu">性别</em>和<em class="mu">年龄</em>之间没有明显的相关性。</p><p id="1015" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们有非常有趣的顾客在网站上购物:)</p><h1 id="a655" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">聚类数</h1><p id="fcca" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们需要多少个集群？为了确定这一点，让我们使用肘法，轮廓评分和Calinski-Harabasz指数。一种方法可能无法给我们一个明确的答案。这就是为什么我们需要尝试另一种方法来决定正确的集群数量。</p><p id="4d5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些方法在R中有现成的公式，我们只需要应用到我们的数据集。</p><blockquote class="nu"><p id="0860" class="nv nw it bd nx ny nz oa ob oc od mm dk translated">E <!-- --> lbow方法:</p></blockquote><p id="9306" class="pw-post-body-paragraph lr ls it lt b lu oe ju lw lx of jx lz ma og mc md me oh mg mh mi oi mk ml mm im bi translated">此方法的r代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="8476" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上述R代码的结果显示在下图中。从图中可以看出，很难决定最佳的集群数量。2个3个还是4个？嗯…很难说…我们用另一种方法吧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5c6a2019694e45ea15b23e4d30126c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*pfNYBsPUSRyN-oTqb_1kZQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">肘法</p></figure><blockquote class="nu"><p id="109f" class="nv nw it bd nx ny ok ol om on oo mm dk translated">剪影分数:</p></blockquote><p id="6530" class="pw-post-body-paragraph lr ls it lt b lu oe ju lw lx of jx lz ma og mc md me oh mg mh mi oi mk ml mm im bi translated">r代码:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="20c1" class="mv la it nk b gy no np l nq nr">opt.k.sil &lt;- Optimal_Clusters_KMeans(data, max_clusters=10, plot_clusters = TRUE, criterion = "silhouette")</span></pre><p id="64c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果如下图所示。较高的轮廓分数为我们提供了最佳聚类数的指示。在我们的例子中，两个和四个集群都有最高的分数，但是问题是两个都是一样的，我们不能决定选择哪一个:(。让我们转到卡林斯基-哈拉巴斯指数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4e3258b30ba2e827dab866b5b6a14039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*2JGuKvJCqawjkSEJMWy22g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">剪影配乐</p></figure><blockquote class="nu"><p id="a9c4" class="nv nw it bd nx ny ok ol om on oo mm dk translated">卡林斯基-哈拉巴斯指数:</p></blockquote><p id="5290" class="pw-post-body-paragraph lr ls it lt b lu oe ju lw lx of jx lz ma og mc md me oh mg mh mi oi mk ml mm im bi translated">r代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="cbab" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">较高的Calinski-Harabasz指数决定了要选择的聚类数。现在很明显，4个集群是最好的:)</p><h1 id="66fa" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">聚类结果</h1><p id="034d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">K均值算法的r代码:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="e2a2" class="mv la it nk b gy no np l nq nr">KMC &lt;- kmeans(data, centers = 4, iter.max = 999, nstart=50)</span></pre><p id="a893" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">应用算法后，让我们看看每个集群中有多少客户:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/6be99efd1071326e0c1762cb80c70492.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*KGf2Ai-1aUX1K9SV"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个集群中的客户数量</p></figure><p id="8b74" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">集群1、2、4几乎均匀分布，分别有269、285和283个客户，而集群3有157个客户。</p><h2 id="4add" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">每个集群中的数据:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/acba31cb1386c92a546c33b6db611ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*TdUVk8xZ92zm5c15nE_iNg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">聚类结果</p></figure><p id="bcf9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi or translated">C  <strong class="lt iu">光泽1</strong>——大多是年轻的单身女性，没有孩子，租房居住。该集群具有最低的平均工资和最低的平均支出额。</p><p id="3c53" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi or translated"><span class="l os ot ou bm ov ow ox oy oz di"> C </span>第二低的平均工资和花费。</p><p id="659a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi or translated"><span class="l os ot ou bm ov ow ox oy oz di">C</span>T19】光泽3——多为中年男性，自有住房。这个群体中的每个人都结婚了。相对于其他群体，他们有2到3个孩子的比例最高。他们收入最高，花费也最多。</p><p id="98a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi or translated"><span class="l os ot ou bm ov ow ox oy oz di"> C </span>买高端产品，花第二高的金额。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/bf7f553150dddba07e8e045f4ba5d1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIB4kse2ChBS0aFvtg5mnA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">米盖尔·Á的照片。来自Pexels.com的帕德里纳</p></figure><p id="abf1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每个聚类的特征都是非常独特的，并且产生几乎相同的部分。很容易注意到，<strong class="lt iu">集群1 </strong>拥有“最没有价值”的客户，但是，我们没有关于该细分市场购买频率的数据。但是这个片段描绘的是一个年轻的女学生，她没有赚很多钱，也不花钱。</p><p id="d53f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">集群2 </strong>是收入不高、消费也不多的中老年客户，几乎类似于<strong class="lt iu">集群4 </strong>但是这些中年人确实工资高，确实消费多，大多是高端产品。</p><p id="9a92" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">集群3 </strong>则是中年男性，收入稳定高，有孩子，消费金额最高。</p><p id="eb7c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在就看我们针对每个集群的策略了。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><blockquote class="pi pj pk"><p id="4326" class="lr ls mu lt b lu mn ju lw lx mo jx lz pl mp mc md pm mq mg mh pn mr mk ml mm im bi translated">这个故事是基于我和我的同事诺姆·施穆尔在华沙大学教授亚采克·卢科维兹博士的“无监督学习”课上共同完成的项目</p></blockquote><p id="cffe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">完整的R代码和数据库在我的GitHub上。</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="ac5a" class="kz la it bd lb lc po le lf lg pp li lj jz pq ka ll kc pr kd ln kf ps kg lp lq bi translated">参考资料:</h1><p id="7c15" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1] A. Rezaeian，S. Shokouhyar和F. Dehghan，<a class="ae ky" href="https://pdfs.semanticscholar.org/1d00/e195eea6cd870285952576451afbed37eb6d.pdf" rel="noopener ugc nofollow" target="_blank">使用聚类技术测量电子商务网站的客户满意度:Nyazco网站的案例研究</a>。国际管理、会计和经济学杂志，(2016)，3(1)，61–74。</p><p id="03b6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[2] A. Sagar，<a class="ae ky" rel="noopener" target="_blank" href="/customer-segmentation-using-k-means-clustering-d33964f238c3">利用K均值聚类进行客户细分</a> (2019)，towardsdatascience.com</p><p id="a7d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[3] Dataflair团队，数据科学项目— <a class="ae ky" href="https://data-flair.training/blogs/r-data-science-project-customer-segmentation/" rel="noopener ugc nofollow" target="_blank">在R </a>使用机器学习进行客户细分(2019)</p><p id="60a3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[4]cran . R-project . org上的R包描述:<a class="ae ky" href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html" rel="noopener ugc nofollow" target="_blank">corr plot包介绍</a>和r-blogger上R 中的<a class="ae ky" href="https://www.r-bloggers.com/rfm-analysis-in-r/" rel="noopener ugc nofollow" target="_blank"> RFM分析</a></p><p id="56fe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">[5] <a class="ae ky" href="https://www.kaggle.com/arawind/retail-marketing" rel="noopener ugc nofollow" target="_blank">数据集</a>取自Kaggle.com</p></div></div>    
</body>
</html>