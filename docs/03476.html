<html>
<head>
<title>A Simple Way to Optimize “Something” in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Python 中优化“某物”的简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-way-to-optimize-something-in-python-740cda7fd3e0?source=collection_archive---------15-----------------------#2020-04-02">https://towardsdatascience.com/a-simple-way-to-optimize-something-in-python-740cda7fd3e0?source=collection_archive---------15-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0484" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Python 中的线性规划解决预算优化问题</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c25e32abc2712733ab7f5f9a77268346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gW5JXaTU4RMDiqAksybOlA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/money?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@neonbrand?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> NeONBRAND </a>拍摄的照片</p></figure><p id="84ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">为什么优化预算很重要？它让我们能够控制广告支出，决定花费多少，并最大化预期结果(访问，点击等)。例如，给定 10，000 美元的预算及其约束条件，我们能够确定每个营销渠道的<strong class="lb iu">最优预算分配</strong>，从而使<strong class="lb iu">结果最大化。</strong>这将使我们能够避免在单一渠道上的拥挤，即我们把所有东西都放在一个篮子里，而是分散到表现最好的渠道。</span></p><p id="d002" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">优质的预算优化策略可以显著提高搜索广告活动的效果，从而帮助广告主在激烈的在线营销竞争中取得成功。</p><h1 id="4c15" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">什么是线性规划？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/dd605d1b55488efe643a71d1cda2902a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*F3fPtiE9QYYLthtyWoXj6w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性规划优化中的一个线性规划问题的图解</p></figure><p id="7e82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">线性规划(LP)是获得最佳结果的最广泛使用的优化技术之一。David G. Luenberger 所著《线性和非线性编程》一书摘录:</p><blockquote class="mx my mz"><p id="17c6" class="kz la na lb b lc ld ju le lf lg jx lh nb lj lk ll nc ln lo lp nd lr ls lt lu im bi translated">顾名思义，线性规划问题的特征在于未知数的线性函数；目标在未知数中是线性的，约束是未知数中的线性等式或线性不等式。</p></blockquote><p id="30a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">似乎线性规划的流行主要在于分析的公式化阶段，而不是求解阶段——这是有道理的。因此，对于我们今天所关心的问题，它可以表述为:</p><blockquote class="ne"><p id="c5b2" class="nf ng it bd nh ni nj nk nl nm nn lu dk translated">预算约束限制在三个不同渠道(电视、广播、报纸)之间分配的资金总量，预算约束采用 x1 + x2 + x3 ≤ B 的形式，其中 B 是预算。电视的总花费应该少于 200 美元，广播应该少于 500 美元，报纸应该少于 500 美元。而总预算上限为 1000 美元。</p></blockquote><p id="aadf" class="pw-post-body-paragraph kz la it lb b lc no ju le lf np jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">除此之外，我们还应该找出一个问题的<strong class="lb iu">目标函数</strong>，在这个问题中，我们计划最大化或最小化我们喜欢的结果(点击、销售等)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/4ce7d0c7f6537da81f15a291f09eb390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NWoe60a7QlZitya-bD1Ig.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从 David G. Luenberger 于 1973 年出版的《线性和非线性规划》一书中获得的线性规划问题公式示例</p></figure><p id="3567" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用来自<a class="ae ky" href="https://www.kaggle.com/ashydv/advertising-dataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的开源广告数据集来展示它是如何工作的！</p><h1 id="841c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">履行</h1><p id="ecac" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">理想情况下，当使用 LP 时，目标函数应该是线性的。</p><blockquote class="mx my mz"><p id="7808" class="kz la na lb b lc ld ju le lf lg jx lh nb lj lk ll nc ln lo lp nd lr ls lt lu im bi translated">如果一个目标函数由于其固有的定义而不是纯线性的，那么将其定义为线性的往往比决定某种其他函数形式并使其他人相信更复杂的形式是最好的选择要容易得多。因此，线性由于其简单性，经常被选择作为简单的解决方法，或者当寻求一般性时，被选择作为在一类类似问题中同样适用(或不适用)的唯一函数形式</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/59e2a9d0970fab6e481c7eba7337361f.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*ElBR3enMHpQe4J_eryLFOw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="http://coin-or.github.io/pulp/" rel="noopener ugc nofollow" target="_blank">纸浆优化工艺</a>2009</p></figure><h2 id="cfe9" class="oa mf it bd mg ob oc dn mk od oe dp mo li of og mq lm oh oi ms lq oj ok mu ol bi translated">建立预测模型</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/d2070e30bfe86a21c0c9aa3c2cfc87f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*rth3c5dkGGc6WhJSKB3vgg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据帧</p></figure><p id="02ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先使用 SK-Learn 的线性回归建立一个多元线性回归模型。这个<a class="ae ky" href="https://www.kaggle.com/vipulgandhi/linear-regression" rel="noopener ugc nofollow" target="_blank">内核</a>提供了一个很好的方法来验证线性回归是否可以被使用，因为线性回归受到几个假设的限制。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="3f29" class="oa mf it oo b gy os ot l ou ov">### SCIKIT-LEARN ###</span><span id="89b2" class="oa mf it oo b gy ow ot l ou ov">feature_cols = ['TV', 'Radio', 'Newspaper']<br/>X = df_advertising[feature_cols]<br/>y = df_advertising[["Sales"]]</span><span id="ebc3" class="oa mf it oo b gy ow ot l ou ov"># instantiate and fit<br/>lr = LinearRegression()<br/>model = lr.fit(X, y)</span><span id="b9d0" class="oa mf it oo b gy ow ot l ou ov"># print the coefficients<br/>print(SkLearn_result.intercept_)<br/>print(SkLearn_result.coef_)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/698158053731f1f8b9fe64a645731e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*3SMbPw81UXeedNEycmutew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">y 轴截距和系数</p></figure><p id="0962" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能够从给定的模型中获得 y 截距和系数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/1e71ec45f24957facde0cabc81b098f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S722nigs9apJ3VxDWWWOgg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们模型的准确性</p></figure><p id="ffba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RMSE 为 1.509，我们的模型非常准确，根据上图，我们可以看到，与实际值相比，它的预测相对较好。有了预测模型，我们现在可以开始构建线性规划的目标函数。</p><h2 id="c2fb" class="oa mf it bd mg ob oc dn mk od oe dp mo li of og mq lm oh oi ms lq oj ok mu ol bi translated">使用 LP 优化</h2><p id="5fa9" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">我们将使用一个名为<a class="ae ky" href="http://coin-or.github.io/pulp/" rel="noopener ugc nofollow" target="_blank"> PuLP </a>的 python 包。这是一个针对 Python 的优化包。纸浆是直截了当的，非常容易使用！</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="413f" class="oa mf it oo b gy os ot l ou ov">prob = LpProblem("Ads Sales Problem", LpMaximize)</span></pre><p id="28b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从使用 LpProblem 函数定义问题开始，我们希望最大化输出，因此“LpMaximize”将是参数。然后，我们将指定我们的约束条件，例如我们应该为给定的渠道花费多少预算。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="9690" class="oa mf it oo b gy os ot l ou ov">#TV &lt;= 200<br/>x = LpVariable("x", 0, 200)</span><span id="5431" class="oa mf it oo b gy ow ot l ou ov">#Radio &lt;= 500<br/>y = LpVariable("y", 0, 500)</span><span id="6f60" class="oa mf it oo b gy ow ot l ou ov">#Newspaper &lt;= 500<br/>z = LpVariable("z", 0, 500)</span><span id="3467" class="oa mf it oo b gy ow ot l ou ov">#Should be less than $1000<br/>prob += x + y + z &lt;= 1000</span></pre><p id="e279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了约束条件，我们现在可以使用模型给出的系数构建我们的目标函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/9d9057f3141b56e8aa1007b967c9944f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fruAExhjJtDAYRQFsCbGqA.png"/></div></div></figure><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="8c82" class="oa mf it oo b gy os ot l ou ov">coef = model.coef_</span><span id="09be" class="oa mf it oo b gy ow ot l ou ov">prob += coef.item(0) * x + coef.item(1) * y + coef.item(2) * z + model.intercept_[0]</span></pre><p id="64f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后通过调用 solve()函数，它将为我们解决这个问题，我们还可以检查优化的状态。通过打印它，我们可以得到下面的结果。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="6abd" class="oa mf it oo b gy os ot l ou ov">prob.solve()<br/>LpStatus[status]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/27367a06f65e4faf9f657b724c8c0c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*bgY2sjQtHd9_R7cgJbH_cw.png"/></div></figure><h2 id="8e5b" class="oa mf it bd mg ob oc dn mk od oe dp mo li of og mq lm oh oi ms lq oj ok mu ol bi translated">我们如何知道每个变量的最优值？</h2><p id="69ac" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">只需使用一个简单的 for 循环来访问概率变量，我们就能够获得每个变量的最优值以及下面的最大目标值。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="1469" class="oa mf it oo b gy os ot l ou ov">for v in prob.variables():<br/>    print(v.name, "=", v.varValue)<br/><br/>print("Objective = %f" % (prob.objective.value()))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/b15ac76d9a30d04597f53e2e3d139e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*QTNynrTLYCmjnMNZybjI0g.png"/></div></figure><h1 id="d749" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">分析</h1><p id="a57d" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">现在我们知道了每个营销渠道应该花多少钱，我们肯定应该使用它作为基线模型来分配我们下一次营销活动的预算。实际上，我们可以实现整个流程的自动化，在这一过程中，每天都可以为一次活动分配或优化预算。</p><h1 id="9189" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="77b9" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">当可以应用于正确的用例时，优化的线性规划是强大的，因为它提供了关键的管理洞察力。广告商通常将预算视为简单的约束，并投入大量精力来寻找更有效的方式，以实现各种市场所定义的可能运营。一个简单的预算分配和调整策略可以在活动管理中显著减少有效点击/收入/销售方面的损失。</p></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><h2 id="dce0" class="oa mf it bd mg ob oc dn mk od oe dp mo li of og mq lm oh oi ms lq oj ok mu ol bi translated">参考</h2><ol class=""><li id="d9dd" class="pj pk it lb b lc nu lf nv li pl lm pm lq pn lu po pp pq pr bi translated">线性和非线性规划<a class="ae ky" href="https://www.springer.com/gp/book/9780387745022" rel="noopener ugc nofollow" target="_blank">https://www.springer.com/gp/book/9780387745022</a></li><li id="13d5" class="pj pk it lb b lc ps lf pt li pu lm pv lq pw lu po pp pq pr bi translated">纸浆—【http://coin-or.github.io/pulp/ T2】</li><li id="304a" class="pj pk it lb b lc ps lf pt li pu lm pv lq pw lu po pp pq pr bi translated">本教程的资源库—<a class="ae ky" href="https://github.com/georgeblu1/Data-Projects/blob/master/Budget%20Optimization.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/georgeblu 1/Data-Projects/blob/master/Budget % 20 optimization . ipynb</a></li><li id="95a1" class="pj pk it lb b lc ps lf pt li pu lm pv lq pw lu po pp pq pr bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/linear-programming-and-discrete-optimization-with-python-using-pulp-449f3c5f6e99">https://towards data science . com/linear-programming-and-discrete-optimization-with-python-using-pulp-449 F3 C5 F6 e 99</a></li></ol><h2 id="edea" class="oa mf it bd mg ob oc dn mk od oe dp mo li of og mq lm oh oi ms lq oj ok mu ol bi translated">图像引用</h2><ol class=""><li id="ee5c" class="pj pk it lb b lc nu lf nv li pl lm pm lq pn lu po pp pq pr bi translated"><a class="ae ky" href="https://www.researchgate.net/figure/Graphical-solution-of-a-linear-programming-problem_fig1_2420905" rel="noopener ugc nofollow" target="_blank">https://www . researchgate . net/figure/Graphical-solution-of-a-linear-programming-problem _ fig 1 _ 2420905</a></li><li id="7ecd" class="pj pk it lb b lc ps lf pt li pu lm pv lq pw lu po pp pq pr bi translated"><a class="ae ky" href="https://link.springer.com/book/10.1007/978-0-387-74503-9" rel="noopener ugc nofollow" target="_blank">https://link.springer.com/book/10.1007/978-0-387-74503-9</a></li><li id="d8a2" class="pj pk it lb b lc ps lf pt li pu lm pv lq pw lu po pp pq pr bi translated"><a class="ae ky" href="http://coin-or.github.io/pulp/" rel="noopener ugc nofollow" target="_blank">http://coin-or.github.io/pulp/</a></li></ol></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="e119" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您有任何问题或反馈，请随时通过我的<a class="ae ky" href="https://www.linkedin.com/in/georgewongsinhong/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。简单介绍一下，我是 Airasia.com 的一名数据科学家，专注于打造优秀的产品和推动增长，因为我热爱我所做的事情。</p></div></div>    
</body>
</html>