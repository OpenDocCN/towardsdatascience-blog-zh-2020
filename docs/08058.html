<html>
<head>
<title>Optimizing the… Target Variable (?) An Example for Trading Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化…目标变量(？)交易机器学习模型的例子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimizing-the-target-variable-an-example-for-trading-machine-learning-models-48a1587d7b9a?source=collection_archive---------23-----------------------#2020-06-14">https://towardsdatascience.com/optimizing-the-target-variable-an-example-for-trading-machine-learning-models-48a1587d7b9a?source=collection_archive---------23-----------------------#2020-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c6b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们的目标是静态的吗？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c19884f1659688be6a135baf6e8b4358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tN8yi9vgj9bGoK5P"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Clem Onojeghuo 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="5603" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">0.a)动机和…飞镖(？)</h1><p id="b2bc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是的，你没看错，<em class="mn">优化目标变量</em>。你可能会想，“但是，那就像欺骗”或者“你能改变过去吗？”。别担心了！我既不是一个骗子，也不是一个试图改变过去只是为了改善他的机器学习模型的时间旅行者(利用这种能力还有很多更令人兴奋的事情要做)。</p><p id="753c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果你去找你的第一个数据集，学习关于<a class="ae ky" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank">泰坦尼克号</a>，在那里你尝试一切来预测乘客是否幸存，或者<a class="ae ky" href="https://www.kaggle.com/c/digit-recognizer" rel="noopener ugc nofollow" target="_blank"> MNIST </a>数据库，那里有你甚至不能识别的数字，你可能会有点困惑。“如果有乘客幸存，这个人能优化吗”或者“他选择9是4来提高他们的准确性吗？”</p><p id="8bb3" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">显而易见的答案是否定的。但是正如你将看到的，有时目标变量不是事实(可能是事实，但不是事实-事实)。所以今天，我们要谈论我们最喜欢的朋友，当它是关于监督学习！</p><p id="43ee" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我想把这个问题比作飞镖比赛(如果我们谈论目标，你能想出更好的例子吗？).典型的职业比赛分为几段，在这几段比赛中，选手们试图准确地达到501分，条件是在最后一次投掷中，飞镖必须进入“双程”，这意味着，到达外环上的任何区域或“公牛”(50)，将结束这一段比赛。每个玩家每回合有三次飞镖。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/0a0fcbbd13078bd7f9a535096034451a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtEWcOXTRfwRM1LBc_44mQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">摘自<a class="ae ky" href="https://en.wikipedia.org/wiki/Darts#/media/File:Dartboard_heatmap.svg" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="49c4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">从数字上看，很明显每个玩家都会试图在第一轮中获得尽可能多的分数。在实际比赛中是这样的:他们开始主要瞄准60岁。</p><p id="7b26" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当他们必须完成游戏时，有趣的部分出现了。想象你有441分的最后一个转弯(还剩60分)。你必须打出“双杀”，所以瞄准60是不可能的。稍加思考后，你扔出祈祷50，奇迹般地你得到了它！。</p><p id="cee2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">你现在还有10分，所以你可以直接扔向外10分区域来结束游戏。你扔了，你甚至没有接近，你打了一个8。在你最后的机会里，你瞄准外围2区。整个球场都在等待，你的对手在咽口水，你有了最后的想法“我什么时候成了飞镖职业选手？”，但你忘了那一秒，深呼吸，最后抛…胜负？你成功了！这条腿是给你的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/ba3f04da140650c339fecbff60fd5cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*F2Gfsl5FjHZlPZECOMAYTA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">摘自<a class="ae ky" href="https://en.wikipedia.org/wiki/Darts#/media/File:Dartboard_heatmap.svg" rel="noopener ugc nofollow" target="_blank">维基百科</a>和来自<a class="ae ky" href="https://www.pngitem.com/middle/iibmbTi_dart-png-transparent-background-dart-png-png-download/" rel="noopener ugc nofollow" target="_blank">这里的飞镖</a></p></figure><p id="2433" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">有数百种组合可以得到60分，所以每次投掷后，你必须灵活并检查你站在哪里(在这样做的时候，我看到了很棒的比赛，首先是<a class="ae ky" href="https://www.youtube.com/watch?v=pWgdh-m6EzU" rel="noopener ugc nofollow" target="_blank">这个</a>和复仇<a class="ae ky" href="https://www.youtube.com/watch?v=zEG_xUcGHwg" rel="noopener ugc nofollow" target="_blank">这里</a>，稍后感谢我)。不可思议，你可以向你的朋友炫耀你的飞镖知识，但我们能从中获得什么？</p><p id="2956" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">嗯，现实生活中发生的问题与飞镖游戏中发生的问题是一样的:你的目标是赢得比赛，但你可以扔向不同的区域来实现这个目标！镖靶是静态的，但你的目标可能会不断变化！。</p><p id="41ab" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">好吧，但是你怎么把它和真正的问题联系起来呢？。别急，我先给你讲讲背景。</p><p id="9705" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当你想训练一个机器学习模型进行交易的时候，有无数种方法可以做到。您可以训练自回归模型并跟踪预测的运动。此外，您可以创建解释变量来预测积极或消极的目标，定义战略要点中的信号，如果讨论这是本文的目标，我认为我们可以讨论您的想法几个小时。</p><p id="c3f7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们的目标与标题相关，因此，我不会详细阐述，因为定义一种方法来面对这个问题是一个独立的世界。相反，我将向您简要介绍一种具体的可能方法。如果你觉得你想知道更多，我建议你从以下几点开始:</p><div class="mv mw gp gr mx my"><a rel="noopener follow" target="_blank" href="/probabilistic-machine-learning-approach-to-trading-macd-business-understanding-6b81f465aef6"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">交易的概率机器学习方法+ MACD商业理解</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">在文章的最后，你会知道如何用概率的方式构造一个交易问题。此外，您将…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ks my"/></div></div></a></div><p id="7b1b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这也是一个很好的第一步，如果在读完接下来的内容后，你对一些概念感到不知所措，想要清楚地理解它们。它还有一些关于模型构造的重要细节。技术方面的问题将在这里浅尝辄止。但是，不要担心，如果你对优化目标变量的想法更感兴趣，我为你准备了一个温和的介绍。</p><blockquote class="nn"><p id="8be6" class="no np it bd nq nr ns nt nu nv nw mm dk translated">事实上，我们将使用股票价格来阐述所有的想法，并不意味着你需要知道任何关于交易留在这里。交易问题将只是一个工具！。</p><p id="c5c6" class="no np it bd nq nr ns nt nu nv nw mm dk translated">此外，我们将在问题表述和模型的结果解释方面做出巨大努力，将它们与商业价值联系起来，这不仅仅是为了准确性而奋斗！</p></blockquote><p id="0d41" class="pw-post-body-paragraph lr ls it lt b lu nx ju lw lx ny jx lz ma nz mc md me oa mg mh mi ob mk ml mm im bi translated">所以留在这里！这完全值得，因为我属于方型的人，让我们从时间表开始吧！</p><h1 id="5c44" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">0.b)议程</h1><ol class=""><li id="0877" class="oc od it lt b lu lv lx ly ma oe me of mi og mm oh oi oj ok bi translated">快速概述分配给问题的结构及其与darts的联系(也是对流失问题的认可)。</li><li id="e184" class="oc od it lt b lu ol lx om ma on me oo mi op mm oh oi oj ok bi translated">我们将描述为什么这是一个提高我们<a class="ae ky" href="https://www.investopedia.com/terms/e/expectedreturn.asp" rel="noopener ugc nofollow" target="_blank">预期回报</a>的机会，展示从币安收集的ETH-USDT配对数据的见解。</li><li id="d68e" class="oc od it lt b lu ol lx om ma on me oo mi op mm oh oi oj ok bi translated">我们将考虑优化目标变量的想法，在我们的头脑中，在你的屏幕上阐述问题，引导我们思考如何解决这个问题。</li><li id="c447" class="oc od it lt b lu ol lx om ma on me oo mi op mm oh oi oj ok bi translated">是时候应用我们将学到的一切了！我们将训练不同的随机森林，以检查我们的目标变量的哪个组合使我们的回报最大化。</li><li id="906a" class="oc od it lt b lu ol lx om ma on me oo mi op mm oh oi oj ok bi translated">最后回顾一下我们的主要成就和对这一想法的进一步改进。</li></ol><h1 id="b146" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1)问题概述，还有更多飞镖！</h1><p id="fd9f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">考虑一下交易问题，假设我们有一些解释变量，它们都是基于股票交易量和价格创建的。我们还开发了一种方法来确定先发生什么:在接下来的N个周期中I%增加或D%减少。</p><p id="9a6e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们的目标是根据我们的变量(监督学习)来预测这两种结果中哪一种更有可能发生。).这可以看作是一个二元分类问题。当第一个收盘价上涨时，我们用1标记，否则用0标记。我们都准备好了！</p><p id="2eeb" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">等等……是吗？但是，I%和D%呢？我们如何选择这些数字？最后，我们需要开始的问题！</p><p id="f27c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如你所见，我们的目标会有所不同，这取决于我们选择哪些数字来决定成功或失败。如果我们首先达到I%，我们就称之为我们的<a class="ae ky" href="https://www.investopedia.com/terms/t/take-profitorder.asp" rel="noopener ugc nofollow" target="_blank"> T/P，</a>否则，我们就称之为<a class="ae ky" href="https://www.investopedia.com/terms/s/stop-lossorder.asp" rel="noopener ugc nofollow" target="_blank"> S/L </a>。</p><p id="9020" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">为了更好地理解这一点，我为你准备了一个简单的图示。让我们用我们未来公司“概率ML贸易公司”的股票价格来分析一下，1只股票的价值在第一天将是100美元，在随后的12天里，这些值将分别是96，110，104，91，84，93，107，118，111，101，91，80。</p><p id="88e8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在下面的图表中，将有四种情况，每个人将代表相同的股票价格。你会看到T/P和S/L点是绿色和红色的水平线。每个散射颜色将是一个增加-减少(I-D)的组合。顺序如下:</p><ul class=""><li id="1429" class="oc od it lt b lu mo lx mp ma oq me or mi os mm ot oi oj ok bi translated">第一种情况，黄色散射:10%I-10%D。</li><li id="30a3" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">第二种情况，青色散射:15%I-15%D</li><li id="3a32" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">第三种情况，蓝色散射:15%I-20%D</li><li id="086e" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">第四种情况，洋红色散射:20%I-20%D</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0a4b7db5c222274f98c6fed6532d40ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vRs0B71E5vxc82Q7DZ0g5Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">同一数据集上的不同目标变量。</p></figure><p id="aac6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">尽管我们公司最终崩溃了，但理解正在发生的事情是一个很好的视觉化。</p><p id="d6de" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">正如你所看到的，当价格超出预定线时，我们就到达了终点。第一种情况和第三种情况的目标变量是相同的。但是对于第二个和第四个，情况恰恰相反。基于相同变量训练的模型可能认为价格会上涨，而另一个模型可以肯定价格会下跌。有趣吧！。</p><p id="c183" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这就是我告诉你我们的目标变量是一个事实，但不是事实-事实的意思。这是一个事实，因为我们无法改变收盘价——以我们的飞镖为例，我们无法改变镖靶——然而，这不是一个事实——事实，因为根据我们为结果设定的条件，我们的目标可能会有所不同——<strong class="lt iu">——我们的目标可能是“双倍”——</strong>。</p><p id="0144" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我相信这可以应用于不同类型的问题，所以如果你开始考虑你的目标变量，而不是一个静态的建筑，而是一个乐高积木，我相信你可以为自己和你的公司获得很多价值！。</p><h1 id="dd4b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.1)少量流失参考</h1><p id="35d8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">举个简单的例子，当你定义客户何时离开时，让我们考虑一下<strong class="lt iu">流失问题</strong>。需要做出一些决定。设想一个月订阅，当你在设计问题时，当客户要离开时，你必须选择<strong class="lt iu">。如果你选择两个或三个月，而不是定义他在下个月“翻腾”，会怎么样？</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/497d869bdc07a4bbf57f9428ee08a3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_a3R6cipeOEPemyC"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Alex Holyoake 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="103d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这可以让你找到不同的模式！想象一下，当客户不打算流失时，但当他们只是在思考时，保留策略会有更好的结果。也许使用更长的时间段会导致更高的保留率！独立于模型，你的商业目标可能会有更好的结果。因此，我们需要根据问题的业务属性来定义我们的度量标准。</p><p id="2adb" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这1.1节，只是让你看看这个想法的应用的另一个例子，但是我知道你仍然对我们将如何在我们的交易实际问题上测试这些概念感到有点好奇，所以和我呆在一起吧！我并没有在第一部分做出如此荒谬的努力，以至于忽略了核心内容。事实上，这个介绍只是一个工具，激励你去阅读接下来的内容。</p><h1 id="2222" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2)机会</h1><p id="54ec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">好吧，为什么这是一个机会？为了解释这一点，我们有必要(重新)回顾一下预期收益的概念。简而言之，它只是一个场景的回报和它的概率之间的乘积之和(<a class="ae ky" href="https://en.wikipedia.org/wiki/Expected_return" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多细节)。</p><p id="535f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu">我们的目标是最大化预期收益</strong>，除了模型的准确性，你还应该考虑将解决最大价值的公式。</p><p id="face" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在特定的交易问题中，我们需要把I%和D%和这个表达式联系起来。做一个简单的开始，让我们想象一下，我们甚至不会训练一个模型。我们想随机进入市场。我们会选择不同的I%和D%的组合，我会在图表和等式中向你们展示发生了什么。同样，假设我们将持有<a class="ae ky" href="https://www.investopedia.com/terms/l/long.asp" rel="noopener ugc nofollow" target="_blank">多头头寸</a>。</p><blockquote class="ow ox oy"><p id="0136" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">技术说明:我们今天工作的数据将从币安检索，选择ETH-USDT对的最后550天，间隔5分钟。有157.912个数据点。</p><p id="34a1" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">我们将使用N=200，每5分钟一次，大约17个小时的结果。如果价格从未越过障碍，将被标记为“没有结果”。从币安收集数据的代码在这里<a class="ae ky" rel="noopener" target="_blank" href="/probabilistic-machine-learning-approach-to-trading-macd-business-understanding-6b81f465aef6">有更详细的解释</a>。</p></blockquote><p id="e40a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">让我们看看如何用重要的特性来检索数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="870f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这种情况下，我们将假设，如果我们“没有结果”，我们将失去的只是费用(如果您激活您的币安档案，您将获得0.075%的接受者和0.075%的与BNB支付<a class="ae ky" href="https://www.binance.com/en/support/articles/115000583311" rel="noopener ugc nofollow" target="_blank">费用的制造者)。我们将每次购买100 USDT ETH。这是定义结果的方法。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="0d85" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">接下来，您将看到我们将训练不同的模型，因此代码是在牢记这一点的情况下创建的。矩阵里有所有的组合。这是我们保存每个场景的方式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="66e5" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">首先，我们将看到两种不同的情况(I=3%，D=-1.5%)和(I=1.5%，D=-1.5%)。我们能从这两个人身上期待什么？如果你的第一个想法是我们可以在第一个案例中预见到更多的“减少”和“没有结果”的案例，我们可能开始相互理解了！。我们来对比一下！。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/91990e3769c9502eae574d2a219b6135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhNr5fWemeW8x7wqoP23-g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于I=3.0%和D=-1.5%的病例结果百分比</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/97b507d481af377c935380825677584f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sg3JNcEfIvda4nIG635tyw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于I=1.5%和D=-1.5%的病例结果百分比</p></figure><p id="afce" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">发生这种情况是因为D%的值越高，价格越难达到该点。</p><p id="3263" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">但是，他们的预期回报是什么呢？好了，我在这里给你留下了通用的公式(0。)，然后是两种情况的计算。该值将假设100个条目，每个条目100个USDT(如果您只想要单个实例的预期回报，只需将预期回报除以100)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/051792451a6a66e47ef7f7477bd63119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqBSOx2W_B0eqi-uCjE8uw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">随机进入市场的预期收益</p></figure><p id="2a4f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于第一种情况(I=3%，D=-1.5%):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/37d9431a06a192e6139e859f2b662056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cAy6NUV3DACH7Pf7BcHnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于I=3.0%和D=-1.5%随机进入市场的预期回报</p></figure><p id="5ee7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于第二种情况(I=1.5%，D=-1.5%):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/35cccfb772de1ec7f39680a5889b2ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KpBRAPATbynid---CyE-nA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于I=1.5%和D=-1.5%随机进入市场的预期收益</p></figure><p id="1268" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">好吧，这些公式可能很烦人，但它们是开始构建我们将要做的事情的极好基础。我不仅仅是在两个案例中这样做的。事实上，我为《黑客帝国》中的每一种组合都做了一个网格。</p><p id="8c7e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">因为我知道你在等着看一些东西，我创建了这个3d散点图，y轴是积极的结果障碍，x轴是消极的，z轴将代表一个条目的预期回报。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/51ac2b827a6e833c3dd5b82919c70dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*PncibehxYAZ6wP2zdo0HGw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我使用了一些我们将在下一节看到的结果，所以为了避免误解，这里是<a class="ae ky" href="https://gist.github.com/MauricioLetelier/1d856a86d9f1b21d43a022babdd85ec1" rel="noopener ugc nofollow" target="_blank">要点</a></p></figure><p id="1eae" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如你所见，我们不能用随机进场来战胜市场。但是，通过选择在[2，-0.3]区域附近，我们得到接近0的值，尽管有费用和随机性！。因此，根据I%和D%的组合，我们进入市场可能处于更好或更坏的位置，<strong class="lt iu">只要仔细定义我们的目标变量。</strong></p><p id="d600" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">但是正如你所知道的，我们需要训练一个模型，所以程序并不像这样直接。但那是下一节的事情，这一节的任务，只是向你们介绍，我们的目标变量的不同组合如何影响我们的预期收益，取决于它的行为。</p><h1 id="6e4f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3)我们能解决这个问题吗？</h1><p id="0aaa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">思考一个提议的解决方案时，我们需要稍微停顿一下，给我们的创造力发挥的机会。此外，我们不会在这一部分编写任何代码。我想引用爱因斯坦关于解决问题过程的陈词滥调，或者亚伯拉罕·林肯关于T2斧头的陈词滥调。但正如你将在嵌入的文字中看到的，没有证据表明他们说过这些话。不管怎样…我知道你明白了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/6cd49ca9e7d6fdacf35477a1223618b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VR-4xt99r4KcpMqU"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ugurpeker?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乌古尔·皮克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ac38" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们路线图上的第一件事应该是:什么实际上代表了更高或更低的I%或D%？。您是否注意到，在我们的场景图表中，它们的值越高，等待时间越长的可能性就越大？好吧，让我们详细解释一下为什么会这样。</p><p id="8590" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">第一个原因似乎是显而易见的:考虑到某个特定时间段的增加或减少并不是那么高，我们需要等待更多的时间段才能达到该值。如果我们有一个趋势，价值需要以自己的速度前进的时候到了。</p><p id="448e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">因此，我们可以注意到，数据粒度(时间间隔)和预期的I%或D%之间必须有一定的比例。如果我们想预测股票在未来一年的价值，看过去8小时是没有任何意义的。正因为如此，我们应该在一个合理的邻域中寻找这些值。</p><p id="6cb4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">第二个原因更重要:想象一下，我们在上涨趋势前买入，在价格突破这个阈值几个小时后，我们希望价格上涨5%。我们想“为什么我们现在必须离开？…正在上升”。我们等了一会儿，发现价格开始下降。可能会有逆转！我们可以误导我们的模型！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/8ee57dfb517e09462142c59a18770e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*O7WFsscV6y4zGsuY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="fee4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">为什么反转如此重要？因为当我们进去的时候，信号显示市场正在上涨，而且确实发生了！但当出现逆转时，迹象可能恰恰相反。我们看到的信号只在某一点上有效！所以如果a在周期T上有一个信号，那个信号每秒钟都会开始失去值！。</p><p id="c35d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">当I%或D%的值太小时，情况完全相同:价格的轻微波动可能会产生与信号相反的结果，因为我们为股票移动定义了一个超级短的空间。</p><p id="24ac" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">那么，从这里我们能学到什么呢？这些信号在I%和D%上有一个阈值，它们不再与结果相关，导致模型显示出比它们应该显示的更多的随机性。</p><h1 id="6f8b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.1)我们的方法</h1><p id="f5f9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">好了，现在我们有了一些原则，可以开始考虑解决方案了。我们如何选择我们的D%和I%？为此，我们应该重新思考我们的目标是什么:<strong class="lt iu">最大化预期收益</strong>！我不会停止重复它！但我们如何做到这一点，我们不能构建一个公式，并根据检查约束的目标函数进行优化，因为我们需要首先训练模型。</p><blockquote class="ow ox oy"><p id="f785" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">为了继续，我们需要定义这个特定案例的一些东西。<br/>我们将假设我们已经完成了所有的特征工程过程，并选择训练一个随机森林。</p></blockquote><p id="c8c1" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">那么…我们将如何评估模型性能？我们可以选择一些数据，并将其分成测试集和训练集。测试数据将代表一个我们不知道的场景，它可以被看作是我们将使用的策略的模拟。为了避免误解，我们将随机但均衡地选择数据。</p><h1 id="b898" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.1.1)我们不会做什么</h1><p id="c7dc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以匆忙采用这个解决方案:</p><p id="dafc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">该模型将为我们提供进入市场的可能性。如果我们可以相信predict_proba方法(它决定了一个特定案件的结果的几率，从此将成为我们的主角)，我们就知道如果我们进去，成功的概率是多少(我们将称之为P(p))。此外，如果我们将P(p)乘以场景的回报，我们甚至可以在训练模型之前就知道我们的最佳选择是什么。</p><blockquote class="ow ox oy"><p id="a1aa" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">值得一提的是，如果我们有两个结果(P(n)是一个负结果的概率)，P(p)+P(n)=1，predict_proba方法知道这一点。</p></blockquote><p id="10be" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">例如，我们评估一种情况，我们选择I=1.5%，D=-1%。如果我们不考虑费用，我们只需要0.4或更高的P(p)值(计算如下)。但是，如果不看模型和它的结果，似乎很难优化我们的目标变量的组合:我们如何知道有多少情况将满足该条件？。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/6df7a00c8047af9d91b2622c39aec488.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*2_sBzTdURaUi5BFJcGzwyQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">示例公式</p></figure><p id="051e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">另一个问题是，一般来说，模型不是完美校准的，predict_proba可以告诉我们0.4，但在测试集中，它可能做得更好或更差。这里的关键是我们不能避免训练模型。</p><h1 id="5767" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.1.2)在这个解决方案中，我们信任！</h1><p id="5915" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们的解决方案需要评估我们训练的每个模型，并检查每个P(p)的回报，这可能会给我们带来正的金额。为了做到这一点，你将在下一节看到关于我们将如何创建返回场景的图表，但现在，我将解释这个想法。</p><p id="7ce4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们将训练我们的模型，并利用测试数据，在P(p)应该高于特定值的条件下，我们将计算每个数据点的正面结果(P(p))的概率。我们将评估每一个概率高于某个数字的案例，我们将检查其中有多少实际上成功了。</p><p id="2ffe" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们可以假设我们将在每笔交易中投入相同数量的资金:100 USDT。由于我们的最终金额的简单性，这就是在百分比上做这件事的重要性所在。我们可以计算真实的回报，只需要稍微改变一下我们原来的公式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/4dd87548abfd1348f0a61c6d92d949dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwJBM4sTpshIx5zn-_zrqA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">返回选择市场条目。</p></figure><p id="2dcc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">你注意到不同了吗？它只是将“% Cases”更改为相应的“Cases”例如，如果我们训练一个模型，其中I%=1.5，D=-1%，其中1000个数据点的概率I&gt;0.5。我们会看到其中有多少是准确的。在这种情况下，我们会说450有积极的结果，50没有结果。我们可以这样翻译:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/31145637b49d2d8a296f9732d4def506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tA1gfl6BLWDn6NE7vcQp9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">回报计算示例</p></figure><p id="873a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这种特殊情况下，我们将在期末获得24.875 USDT的利润。</p><p id="15fd" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">您可以注意到，返回的值取决于案例的数量和条目的质量。在模型的情况下，如果我们要求更高的概率，我们将有更少的情况。<strong class="lt iu">这是我们的主要权衡！许多“常规条目”可能比少数“好条目”更差或更好</strong></p><blockquote class="nn"><p id="9dbb" class="no np it bd nq nr ns nt nu nv nw mm dk translated">所以会有两个优化过程！首先，给定每个模型的P(p ),我们将最大化回报。之后，我们将评估所有组合的每个模型的最佳回报！</p></blockquote><p id="4a56" class="pw-post-body-paragraph lr ls it lt b lu nx ju lw lx ny jx lz ma nz mc md me oa mg mh mi ob mk ml mm im bi translated">这将类似于网格搜索，但在我们的情况下，我们不会校准参数，我们将比较他们的回报！正如我所承诺的，我们将改变我们的目标变量，而不是改变参数！</p><p id="a246" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">似乎是个好计划？如果您同意，让我们看看我们刚刚构建的解决方案的结果！</p><h1 id="f1c1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4)真相时刻！</h1><p id="69aa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">所有的精心制作过程可能有点苛刻，但它即将得到回报！</p><blockquote class="ow ox oy"><p id="170e" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">技术说明:我取了20%的平衡数据用于下面的评估，另一部分用于训练模型。假设我们使用了550天，我们可能会说在110个随机的日子里预期会有回报。我更喜欢这种方法，而不是在上升趋势或下降趋势中进行评估，因为我认为这更可靠。</p><p id="c64f" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">此外，本节我只补充模型训练和模型评估的要点。图表代码会在gists和jupyter笔记本中，我会在这个<a class="ae ky" href="https://github.com/MauricioLetelier/Optimizing-the-target-variable" rel="noopener ugc nofollow" target="_blank"> repo </a>中留给你。我刚刚上传了结果，因为模型太重了。</p></blockquote><p id="c632" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">遵循我们在第3节中设定的原则，如果我们有18个小时来观察结果，那么设置0.3个隔离屏障是合理的。还有，事实上我们无法知道什么时候是太多或太少的信号来误导我们的模型，我们应该尝试很多组合！。</p><p id="983c" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在本节中，我们将训练许多随机森林，每一个都基于I%和D%的不同组合(“矩阵”)。这将引导我们找到确切的概率，我们应该要求的模型，以确定我们是否可以进入市场，最大化我们的回报。</p><p id="7192" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这里是模型的代码，我保存它们是因为每个模型的训练需要大约5分钟，而对于169，你可以自己计算一下，了解一下仅仅训练它们就需要一个晚上:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="f991" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在第<strong class="lt iu"> 4.1 </strong>节中，我们将通过一个组合<strong class="lt iu">来了解每次</strong>我们测试一个新的组合时会发生什么。在第<strong class="lt iu"> 4.2节</strong>中，我们都在期待什么:最终的<strong class="lt iu">目标变量优化</strong> …!</p><h1 id="f960" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.1)我们的第一个完整场景</h1><p id="a228" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我之前告诉你的，这里，会有更多的图表！我将从展示一个开始，这样我们可以巩固我们在上一节中所做的内容。第一个柱状图包含I%=1.5和D=-1.5组合的模型结果。此外，每个条形顶部的病例数。</p><p id="aad6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">X轴表示P(p)&gt;X输出(所有满足此条件的案例)的筛选器，我们将使用它来选择模型预测为市场进入的案例。条形图的高度代表成功率，散点图的点可以看作是特定点的回报。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/31001f51000724af48007ba1192574a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gUAuKAUiSnGwy3RUinxGw.png"/></div></div></figure><p id="7161" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">不要觉得不知所措！这里有很多信息，但是如果你停下来理解它，你会发现没有什么可怕的。在这一节结束的时候，你可以重温这个图表，我发誓！这完全说得通。我将把这个分析分成两部分:第一部分，我们将讨论predict_proba给我们的信息，第二部分，我们将分析回报。</p><h1 id="cacb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.1.1)预测概率重要性</h1><p id="a1a2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可能已经注意到predict_proba方法是这篇博文的亮点，现在我将向你解释为什么。数据科学过程的这一部分至关重要，因为这是我们理解模型给我们的信心的时候。</p><p id="0c9e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于这个组合，我将根据概率将它们分成三份，并解释这个数字在我们的情况下代表什么。请注意，我用的是0.5，因为I%与D%相同:</p><ul class=""><li id="58c9" class="oc od it lt b lu mo lx mp ma oq me or mi os mm ot oi oj ok bi translated">P(p) &lt;&lt;0.5: What’s the difference between going into the market randomly and filtering these cases? Well, the model is telling us that he (I’m talking about him as a person, I know) has some clarity and thinks that the outcome will be negative. For our situation, this means that if we avoid those cases, we are not sure if we will have a good outcome, but at least we will leave behind those that are bad-looking.</li><li id="172e" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">P(p)~0.5: If we choose the cases around 0.5, we will be hitting the most uncertainty scenarios. The model is practically saying you ‘flip a coin’. For cases like this, we should avoid using the confusion matrix, these cases are meant to be less accurate!</li><li id="5354" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">P(p)&gt; &gt;0.5:这是我们最好的猜测。模特在说，“如果可以选择，就挑这些！”。这就是为什么它们很重要。我们的目标不是预测所有的情况，我们只想对其中的一部分有信心。</li></ul><p id="b01e" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">现在回到图表，您可以注意到每个条形都是基于x轴数字过滤的特定置信范围。成功率越来越高。这是因为另一个右边的每一个条形都比左边的条形更挑剔。。</p><p id="0793" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这也意味着，当我们向右走的时候，我们的情况更少，正如在第三节中讨论的，随着情况的减少，我们的回报达到了一个不能再攀升的点。但那是4.1.2节的事。</p><p id="e1c6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我强调P(p)过滤器只是为了提醒您，选择的阈值应该与问题中的商业价值相联系，使用AUC-ROC曲线可能是不够的。你需要把模型的结果和你的目标函数联系起来！。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/4e8978010fb81b661f6f3669cb73bb62.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*2daympxq9IAj90AiuThCiw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://imgflip.com/memegenerator/Panik-Kalm-Panik" rel="noopener ugc nofollow" target="_blank"> imgflip </a></p></figure><h1 id="579f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">4.1.2)返回时间！</h1><p id="e380" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">回报是用我们在上一节中构建的公式计算的。我只是根据S/L和T/P点，对“无结果案例”给他们一点惩罚或奖励。例如，如果我们有[-3.6，0.3]，该值很可能超过0，因此该效果被包含在内(代码中有详细说明)。</p><p id="d17d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果你认为我们每笔交易都有100 USDT，不要因为图表显示的110天回报率是750%而惊慌失措。回报没有那么高，因为你可能有很多同时交易等待达到阈值。所以你需要超过100个USDT来应用这些策略。</p><p id="ffd2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">因此，回报是我们将寻求优化的价值。现在分析散点图点会更容易。在这种特殊情况下，你可以清楚地看到，回报找到一个点(大约在0.485)，在那里它有0回报，并继续上升，直到0.55，在那里它达到最高回报。之后不出所料，往下走，因为太挑剔涉及机会少。</p><blockquote class="nn"><p id="da6e" class="no np it bd nq nr ns nt nu nv nw mm dk translated">看到这一点给了我们一个很好的洞察力:仅仅通过选择一个正确的P(p)阈值就可以决定是否达到我们的业务目标。</p></blockquote><h1 id="1b73" class="kz la it bd lb lc ld le lf lg lh li lj jz pr ka ll kc ps kd ln kf pt kg lp lq bi translated">4.2)优化目标变量！</h1><p id="808b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">但是，如你所知，我们不会就此止步。我们的主要目标是优化目标变量，定义最佳的I%和D%组合。现在是时候来评价这些车型了！下面的代码可以避免重复前面几节的整个过程，但我还是会向您展示它。这是由于模型和数据的保存和加载过程。它可以通过一个更快的选项来避免。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="7a5b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们加载数据和具有各自特征的模型，重新创建训练过的环境。在代码的后半部分，我们使用P(p)过滤器来保存成功率的所有概率，以便在将来进行分析。</p><p id="3651" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对其中的每一个，我们将重复本节第一部分的程序，以获得局部最佳回报。之后，我们会比较每个组合的最佳回报。在这里你将看到我们最佳的五款车型回归！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/aad8bd4cf28407687db5093df2912cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YX4fkEV3UVqxF7iu52BcCQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们最好的5个模型的P(p)与回报。动画<a class="ae ky" href="https://gist.github.com/MauricioLetelier/81aa8b69f7a12d0ec34e89564613d1cc" rel="noopener ugc nofollow" target="_blank">的要点在这里</a>。</p></figure><p id="b997" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们注意到的第一件事是，第一个P(p)滤波器的回波是相同的。这是因为模型不会给我们低于0.25的概率，所以回报和随机进入市场是一样的。另一件重要的事情是，在所有的模型中，回报率回到0，因为没有足够的案例达到P(p)值。</p><p id="6418" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">正如你所看到的，在这五种情况下，当P(p)高于一个概率可以处理I%和D%之间的差异的值时，模型越过0返回障碍。比如模型[2.4，-3.6]比其他几个持续的时间稍微长一点达到顶峰，因为你需要更多的正面案例来中和负面的。</p><blockquote class="nn"><p id="3bf8" class="no np it bd nq nr ns nt nu nv nw mm dk translated">我们的赢家[3.9，-3.6]，能够达到超过3000 USDT的回报！这令人难以置信，因为如果我们只使用第4.1节的标准——只评估一个组合——我们最终只会得到750 USDT的回报。</p></blockquote><p id="6fba" class="pw-post-body-paragraph lr ls it lt b lu nx ju lw lx ny jx lz ma nz mc md me oa mg mh mi ob mk ml mm im bi translated">优化目标变量的价值是惊人的！现在，您已经了解了理解我们在本节开始时看到的图表所需的所有重要内容，我现在可以添加相同的图表，但针对的是我们的最佳情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/ecd6f8f7556c6ba7a395526310a27f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPo4FOqti9v6byuxMVTXGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的最优案例，比较P(p)与成功率，回报与案例数之和。<a class="ae ky" href="https://gist.github.com/MauricioLetelier/08e18dbc47869181b0098d7c88bb6a37" rel="noopener ugc nofollow" target="_blank">要诀</a>。</p></figure><p id="d34a" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">最佳情况是寻找-3.6%的S/L和3.9%的T/P，并且我们应该进入P(p)&gt;0.53的每种情况的市场。看到这里，我们可以带着自负的微笑结束这一节。每笔交易的预期回报大约是0.85 USDT，包括费用！</p><h1 id="a2b0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">5)简单回顾一下，回头见！</h1><p id="2a63" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我在这里想要做的是将我们的注意力集中在可以给我们模型的商业价值上。我们动态地改变概率过滤器和结果定义来提高我们策略的回报。</p><p id="f3ef" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">进一步的改进可以通过交叉验证的方式进行分析。此外，回报的衡量还可以做很多事情，例如，它可以除以同时平均交易的次数，以标准化每一美元的投资，但我认为这对今天来说已经足够了。</p><p id="ffc1" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我希望您可以看到，除了模型准确性之外，还有其他可以评估的东西。如果你读过我以前的一篇文章，你就知道接下来会发生什么。我们的主要收获:</p><ul class=""><li id="d863" class="oc od it lt b lu mo lx mp ma oq me or mi os mm ot oi oj ok bi translated">我们现在是飞镖专家。</li><li id="f600" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">我们知道我们的目标变量可以根据问题陈述而改变。</li><li id="a42b" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">我们看到了在概率模型上定义不同阈值以最大化我们的业务目标的重要性。</li><li id="49ad" class="oc od it lt b lu ol lx om ma on me oo mi op mm ot oi oj ok bi translated">我们制作了一个应用案例，以便更好地理解如何在实际环境中应用这一点。</li></ul><p id="a785" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">各位，今天就到这里。如果你到了这一步，我希望这二十多分钟是值得的。</p><p id="ded8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果我感受到你的热情支持——就像我对上一个一样——我可以给你带来新的东西！请在下面留下你的评论和想法！读懂你的想法对我来说超级重要。</p><blockquote class="ow ox oy"><p id="9a36" class="lr ls mn lt b lu mo ju lw lx mp jx lz oz mq mc md pa mr mg mh pb ms mk ml mm im bi translated">这是强制性的，你不能用这个策略投资或交易，因为这篇文章的主要目的是讨论目标变量。交易的理念:它只是一个获取真实问题和真实数据的工具。如果你遵循这个未经证实的系统，你很容易失去你的存款！。</p></blockquote></div><div class="ab cl pv pw hx px" role="separator"><span class="py bw bk pz qa qb"/><span class="py bw bk pz qa qb"/><span class="py bw bk pz qa"/></div><div class="im in io ip iq"><p id="d746" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如果你喜欢，就在<a class="ae ky" href="https://medium.com/@maletelier" rel="noopener"> Medium </a>和<a class="ae ky" href="http://www.linkedin.com/in/maletelier" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我。如果你想给我写信，我最近在<a class="ae ky" href="https://twitter.com/maletelier" rel="noopener ugc nofollow" target="_blank">推特</a>上。我很乐意与你交谈！</p><p id="96c6" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><strong class="lt iu"> <em class="mn">来自《走向数据科学》编辑的提示:</em> </strong> <em class="mn">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="mn">规则和指南</em> </a> <em class="mn">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="mn">读者术语</em> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>