<html>
<head>
<title>Why Do GANs Need So Much Noise?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么 GANs 需要这么多噪音？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-do-gans-need-so-much-noise-1eae6c0fb177?source=collection_archive---------10-----------------------#2020-02-26">https://towardsdatascience.com/why-do-gans-need-so-much-noise-1eae6c0fb177?source=collection_archive---------10-----------------------#2020-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="55e3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">形象化甘人如何在低维潜在空间中学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e38640250061903cb73d7a3cf2201bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OaftI9dECYyw8QPPU0Uw1Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.pexels.com/photo/acrylic-art-chaos-chaotic-989580/" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="912a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生成对抗网络(GANs)是一种在给定一组旧的“真实”样本的情况下生成新的“虚假”样本的工具。这些样本实际上可以是任何东西:手绘数字、脸部照片、表现主义绘画，你能想到的都有。为此，GANs 学习原始数据集背后的底层分布。在整个训练过程中，生成器逼近这个分布，而鉴别器告诉它哪里出错了，两者通过军备竞赛交替改进。为了从分布中抽取随机样本，给发生器随机噪声作为输入。但是，你有没有想过为什么 GANs 需要随机输入？常见的答案是“所以它们不会每次都生成相同的东西”，这是真的，但答案比这稍微微妙一些。</p><h1 id="713d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">随意采样</h1><p id="8a57" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我们继续 GANs 之前，让我们绕道考虑从正态分布中抽样。假设你想用 Python 来做这件事，但是你从来没有读过<code class="fe ms mt mu mv b">numpy</code>文档，也不知道<code class="fe ms mt mu mv b">np.random.normal()</code>的存在。相反，你所要做的就是<code class="fe ms mt mu mv b">random.random()</code>，它在区间(0，1)内均匀地产生值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/ae84b7582ac7f05183ffa3ec370e4ea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*rQI0VZY51sAniTpWQ5HA3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:从我们的输入均匀分布(蓝色)和目标正态分布(橙色)中抽取的 100k 个样本的直方图。</p></figure><p id="fa55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，我们希望将图 1 中的蓝色分布转换成橙色分布。幸运的是，有一个函数可以做到这一点:<em class="mx">逆累积分布函数</em>，也称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Quantile_function" rel="noopener ugc nofollow" target="_blank">分位数函数</a>。图 2 中所示的(非反转)累积分布函数(CDF)描述了对于某些指定的<em class="mx"> x </em>，从所讨论的分布中抽取的任何随机值将等于或小于<em class="mx"> x </em>的概率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8536c016d2b62abaab54720eb97f60c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*i_JIU9ERU-wS63PnCStSfA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:标准正态分布的 CDF。</p></figure><p id="09dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，在图 2 中的点<em class="mx"> x=0 </em>，y = 0.5；这意味着 50%的分布低于零。CDF 的一个便利特性是输出范围从 0 到 1，这正是我们从<code class="fe ms mt mu mv b">random.random()</code>函数中获得的输入！如果我们将 CDF 倒置(翻转过来)，我们得到分位数函数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/bb746a1c0d4878ddd029a0ce62ee5947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*IjLKZq1uXBvtyeJu08UnLQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:标准正态分布的分位数函数。</p></figure><p id="8b09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个函数给出了分位数(我们的<em class="mx"> x </em>，范围从 0 到 1)和正态分布中相应值之间的精确关系，允许我们直接从正态分布中采样。即<em class="mx"> f(random.random()) ~ N(0，1)，</em>其中<strong class="lb iu">输入空间中的每个点对应输出空间中的一个唯一点</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/162b569f0a5944176d6b96afcd95628d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*f9ij22W4931IUvqoFfPGnA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:说明使用分位数函数将均匀分布(蓝色)映射到正态分布(橙色)的动画。</p></figure><h2 id="a59d" class="my lw it bd lx mz na dn mb nb nc dp mf li nd ne mh lm nf ng mj lq nh ni ml nj bi translated">这和甘斯有什么关系？</h2><p id="783d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在上面的场景中，我们拥有分位数函数，但是如果我们没有，并且必须学习从输入空间到输出空间的映射，那该怎么办呢？这正是 GANs 要解决的问题。在<a class="ae ky" rel="noopener" target="_blank" href="/training-a-gan-to-sample-from-the-normal-distribution-4095a11e78de">之前的文章</a>中，我举例说明了如何使用 GANs 从正态分布中取样，如果你处于数据紧急状态，并且没有可用的分位数函数。在这种情况下，我发现更有帮助的是，不要把 GANs 想象成随机采样的工具，而是把某个<em class="mx"> k </em>维<em class="mx">潜在</em>维(输入)空间映射到某个<em class="mx"> p </em>维<em class="mx">样本</em>维(输出)空间的函数，然后可以用它把潜在空间的样本转换成样本空间的样本。在这种情况下，很像分位数函数，没有随机性。</p><p id="9a68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">头脑中有了地图，让我们考虑如何从 2D 正态分布中抽取随机样本，仅将 0 到 1 之间的 1D 随机样本作为输入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/55b7ffe326e6ed18fb5ba36396040deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*vLFMEXwOON4_LXUsNbClrw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 5:2D 正态分布(橙色)和 1D 均匀分布(蓝色)，各有 100k 个样本。</p></figure><p id="a3e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们如何将蓝线中的 100k 个样本映射到橙色斑点中的 100k 个样本？没有什么好办法。当然，我们可以使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Space-filling_curve" rel="noopener ugc nofollow" target="_blank">阿砣曲线</a>，但是这样我们就失去了有用的属性，即输入空间中的点靠在一起会导致输出空间中的点靠在一起，反之亦然。正是由于这个原因，<strong class="lb iu">GAN 的潜在空间的维数必须等于或超过其样本空间的维数。</strong>这样，函数就有足够的自由度将输入映射到输出。</p><p id="6e90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但为了好玩，让我们想象一下，当只有一维输入的 GAN 被赋予学习多维分布的任务时会发生什么。希望结果不会让你吃惊，但是看起来很有趣。</p><h1 id="ed6c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">2D 高斯</h1><p id="1be5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们从图 5 所示的问题开始:将 0 到 1 之间的 1D 范围映射到 2D 正态(或“高斯”)分布。我们将使用一个典型的普通 GAN 架构(代码在文章末尾)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/426d635c8b64528694e28426d68a73b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*IHiY4hLJsyQaAbbIDSQ5CQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 6:潜在维度为 1 的 GAN 试图学习 2D 高斯分布。灰点是从真实分布中抽取的样本，红点是生成的样本。每一帧都是一个训练步骤。</p></figure><p id="2d4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，这可怜的东西不知所措。只有一个自由度，它几乎不能探索样本空间。更糟糕的是，因为生成的样本在 1D 流形中是如此密集(这张 gif 中的灰点和红点一样多！)，鉴别器能够偷懒，从来不需要努力从假货中辨别出真正的点，因此生成器不能获得非常有用的信息(当然也不足以学习空间填充曲线，即使它有这个能力！).</p><p id="8d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图 6 显示了前 600 个训练步骤。30k 后，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/fb2b3186f0479e045e304a70138d5ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*n68R-P4BikcdMT2MrAgNmA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 GAN 在 30k 训练步骤后从图 6 中学习到的分布。</p></figure><p id="5d42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个可爱的小曲线，但几乎不是高斯分布。GAN 在 30k 步后完全无法学习映射。作为背景，让我们考虑当给定 2D、3D、10D 和 100D 潜在空间以映射到上述分布时，具有相同架构和训练例程的 GAN 的表现如何:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/43d8cadb439bb8915dbfeec815166e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKfYuQ9TpNxgkldMivwcLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 30k 训练步骤后，具有 2D、3D、10D 和 100D 潜在空间的 GANs 的输出</p></figure><p id="c8aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2D 潜在空间 GAN 比上面的 1D GAN 好得多，但是仍然离目标分布很远，并且有几个明显的缺陷。3D 和 10D 潜在空间产生具有视觉上令人信服的结果的 GAN，而 100D GAN 产生似乎是具有正确方差但错误均值的高斯分布。但是，我们应该记住，在这个特殊的问题上，高维 GANs 是作弊的，因为许多均匀分布的平均值近似正态分布。</p><h1 id="53ac" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">八个高斯人</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/1e3c7df501de62b3bc80b09d2fbe8fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ovh2AlY7Iy4eUDCwmgxabA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 9:八个高斯分布</p></figure><p id="099e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">八高斯分布(图 9)就像它听起来的那样:八个 2D 高斯分布围绕原点排列成一个圆，每个高斯分布的方差足够小，几乎不会重叠，并且协方差为零。虽然样本空间是 2D，但该分布的合理编码有三个维度:第一维是离散的，描述模式(编号为 1 到 8)，另外两个分别描述该模式的<em class="mx"> x </em>和<em class="mx"> y </em>位移。</p><p id="2a83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用<em class="mx"> latent_dim=1 </em>对一个 GAN 进行了八步高斯分布 600 步的训练，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/c5b6874f452c1aab22687d38fa3e3a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*Pm_V2iO2fEAkRD6F2W7TOQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 10:一个潜在维度为 1 的 GAN 试图学习八高斯分布。灰点是从真实分布中抽取的样本，红点是生成的样本。每一帧都是一个训练步骤。</p></figure><p id="cf07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如所料，GAN 努力学习有效的映射。30k 步后，这是学习到的分布:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/68eff26dc5deecb3584c19c18ab97878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*FKz3_NVD8v0Uc_pK4my6nQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 11:GAN 在 30k 训练步骤后从图 10 中学习到的分布。</p></figure><p id="ecd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">GAN 显然很难将 1D 潜在空间映射到这个 3D 分布:最右边的模式被忽略，模式之间产生了相当数量的样本，样本不是正态分布的。为了进行比较，让我们考虑 30k 步后的另外四个 gan，潜在维度分别为 2、3、10 和 100:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/1250af547b1f7430b53eb75eb5e86ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3kS5QnnUpIMhdxn1wUEXw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 12:30k 训练步骤后，具有 2D、3D、10D 和 100D 潜在空间的 GANs 的输出</p></figure><p id="ae05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果不实际测量真实分布和学习分布之间的 KL 差异，很难判断哪个是最好的(soon™️将在后续文章中推出！)，但低维 GANs 似乎在模式间的负空间产生的样本更少。更有趣的是，2D GAN 没有显示模式崩溃，3D 和 10D GAN 仅显示轻微的模式崩溃，而 100D GAN 在两种模式下都无法产生样本。</p><h1 id="ed05" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">螺旋形</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/5822f9a5fe933ad59b506ac36583c10b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*XbHtfS70AnW4jfiU-A9Z7A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 13:螺旋分布。随着螺旋从圆向外延伸，密度分布减小，并且在臂的横向上密度是均匀的</p></figure><p id="17cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图 13 所示的螺旋分布在某些方面比八高斯分布简单。GAN 只有一种模式(虽然拉长和扭曲)，不会被迫离散化其连续输入。可以用两个维度有效地描述它:一个描述沿螺旋的位置，另一个描述螺旋内的横向位置。</p><p id="43f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用<em class="mx"> latent_dim=1 </em>训练了一个 GAN 600 步，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/3ff1986d31b438f6f7e4337c03db42c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*Ll1TYhQJjDZHC7FhCq4lrA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 14:潜在维度为 1 的 GAN 试图拟合螺旋分布。灰点是从真实分布中抽取的样本，红点是生成的样本。每一帧都是一个训练步骤。</p></figure><p id="5210" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，GAN 努力学习有效的映射。30k 步后，这是学习到的分布:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/62a445d98c8f4a4b9a8c65b210c6d003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*wHL6iF3zRfshBXjDpQDJVA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 15:GAN 在 30k 训练步骤后从图 14 中学习到的分布。</p></figure><p id="17d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似于八高斯分布的情况，GAN 在映射螺旋分布方面做得很差。省略了螺旋的两个区域，并且在负空间中生成了许多样本。我在<a class="ae ky" rel="noopener" target="_blank" href="/gans-and-inefficient-mappings-f185fdd62a78">的另一篇文章</a>中详细讨论了这个低效的映射问题，所以我在这里不再赘述；相反，让我们考虑另外四个 gan，其任务是在 30k 步后学习该分布，同样具有 2、3、10 和 100 的潜在维度:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/4028e0e39284392e8e2b7dbba0416605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QylxlI19-A0xaP2rscSrJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 16:30k 训练步骤后，具有 2D、3D、10D 和 100D 潜在空间的 GANs 的输出</p></figure><p id="86cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，在没有实际测量 KL 散度的情况下，很难判断哪个是最好的，但是负空间中覆盖范围、均匀性和采样数量的差异是值得考虑的。</p><h1 id="211c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">关闭思路</strong></h1><p id="94b2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">人们很容易被 GAN 的热情所吸引，并把它们当作神奇的机器，用随机数作为燃料来弹出新的样本。了解工具的基本工作原理对于有效地使用它和在它出现故障时排除故障是至关重要的。对于 GANs，这意味着理解生成器正在学习从某个潜在空间到某个样本空间的映射，并理解这种学习是如何展开的。将 1D 分布映射到更高维度分布的极端情况清楚地说明了这项任务有多复杂。</p><p id="03cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本项目中使用的所有代码都可以在以下 GitHub repo 中获得:</p><div class="nn no gp gr np nq"><a href="https://github.com/ConorLazarou/medium/tree/master/12020/visualizing_gan_dimensions" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">ConorLazarou/培养基</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">甘斯和低维潜在空间:可视化甘斯如何学习时，饥饿的随机噪音。</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div></div></div>    
</body>
</html>