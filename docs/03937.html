<html>
<head>
<title>Interpret your Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释你的回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interpret-your-regression-d5f93908327b?source=collection_archive---------50-----------------------#2020-04-11">https://towardsdatascience.com/interpret-your-regression-d5f93908327b?source=collection_archive---------50-----------------------#2020-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6d80" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">逐步实现逻辑回归</h2></div><p id="5efe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你手头有一个分类任务，你的go-to算法是什么？如果不是逻辑回归或者即使是，你有没有发现线性回归和逻辑回归之间的相似之处？如果是，那是因为逻辑回归本身就是一个线性模型。但是不要担心，在这篇文章中，你将通过解释一个逻辑回归和它的参数，你将得到为什么这个算法被认为是线性的答案。</p><p id="b565" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用的数据集是UCI机器学习库中可用的<strong class="kk iu">宫颈癌(风险因素)数据集</strong>。你可以在这里从<a class="ae le" href="https://github.com/Anpr1211/Interpretable-ML/blob/master/Cervical%20Cancer%20Dataset/Cervical_Cancer_Dataset_Cleaned.csv" rel="noopener ugc nofollow" target="_blank">那里得到干净的版本。</a></p><p id="36ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">目标变量为‘活检’</strong>，存储布尔值0，代表癌症阴性病例，1，代表癌症阳性病例。</p><p id="a94b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">预测器或特征是-</p><ul class=""><li id="307c" class="lf lg it kk b kl km ko kp kr lh kv li kz lj ld lk ll lm ln bi translated">荷尔蒙避孕药——(对/错)</li><li id="3d61" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="kk iu">抽烟</strong>——(对/错)</li><li id="7c8e" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="kk iu">怀孕数量</strong></li><li id="a62c" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="kk iu">性病:诊断数量</strong></li><li id="5118" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="kk iu">宫内节育器</strong>——(对/错)</li></ul><p id="2256" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据集的清理和预处理、分类变量的虚拟编码和分割以通常的方式完成。接下来的步骤可以参考<a class="ae le" href="https://github.com/Anpr1211/Interpretable-ML/blob/master/Cervical%20Cancer%20Dataset/Cervical%20Cancer%20Dataset%20-%20Cleaning.ipynb" rel="noopener ugc nofollow" target="_blank">这里的</a>。</p><p id="5608" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">微软研究院的<a class="ae le" href="https://github.com/interpretml/interpret" rel="noopener ugc nofollow" target="_blank"> InterpretML python包</a>已经用于该数据集的探索。</p><p id="0c60" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章遵循类似于<a class="ae le" rel="noopener" target="_blank" href="/interpret-your-regressions-1-cae5c2f4c0f9">解释你的回归——线性回归</a>的结构，并处理逻辑回归的可解释性。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="d2ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从目标变量的可视化开始探索性数据分析，观察到2个类别非常不平衡，因此，这是<strong class="kk iu">不平衡分类</strong>的情况。所有的分类变量本身也是不平衡的。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/300f60c3728a1f2c04ce10da7c19371b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uY6IZUyMl-QgtH_hZlngHQ.png"/></div></div></figure><p id="3c25" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">连续特征“怀孕次数”是高度正偏的，即右尾巴比左尾巴更长。这种分布预计会减少怀孕次数，如1次、2次等。更加普遍。</p><p id="7c95" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归方法用于分类任务，假设<strong class="kk iu">二项式分布产生了目标变量</strong>，我们需要为一组给定预测值的成功概率建模“p”。这里的‘p’是女性患宫颈癌的概率。</p><p id="0484" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于逻辑回归被认为是线性模型，为了简单起见，首先考虑一个简单的线性方程</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/9f92acb8547c92fdcc15a60548076287.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*Gw-IfkyLvAFJ09nIA7joQA.png"/></div></figure><p id="646b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">记住标准8课，函数是在数学中首次引入的，考虑这样一个函数，<strong class="kk iu">logit函数</strong>，给出如下</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/c0aa38f0c110f518efdf04208828c109.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*Fi7JHYrNhlDbrUxxY7_M5g.png"/></div></figure><p id="152c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mj">logit函数的值域为[0，1],值域范围为∞到∞。</em></p><p id="4159" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，考虑这个函数的逆函数，</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/8afcb9289ca978cf351668dddaf03f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*f4A4ypLWsAVl3bMl0l0DGA.png"/></div></figure><p id="2ca5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mj">这是</em> <strong class="kk iu"> <em class="mj">逻辑函数</em> </strong> <em class="mj">，其范围在∞~之间，域在0 ~ 1之间。</em></p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/489efe17b778f807a45274700d376a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*Kh7P5c2YPCtwI1-zugSDvw.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">逻辑曲线</p></figure><p id="452a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们来看最有趣的部分。考虑一个介于0和1之间的值“p”。所以，<em class="mj"> f(p) = log { p/(1-p) } </em>。如果假设“p”是女性患宫颈癌的概率，那么<em class="mj"> p/(1-p) </em>是女性可能患宫颈癌的“几率”，其中“几率”只是定义事件概率的另一种方式。因此，<em class="mj"> f(p) </em>可以被认为是女性可能患有癌症的对数几率。</p><p id="9a64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，f(p)的范围位于∞和∞之间，可以有把握地假设:</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/a2a55cd7b4a37ab5f2160fdecc38d3d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*GcndIKeq-JVCPveP5W3d1A.png"/></div></figure><p id="8554" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一种写法是</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/fcaea66ce6efe1ee506a8d50cf321aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*fGmhi8-DhY7sICvAHa-paw.png"/></div></figure><p id="4820" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个公式用于解释模型，因为logit可以解释为<strong class="kk iu">成功几率的对数</strong>。</p><p id="2fb2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mj">对于将线性模型与结果参数联系起来的任意函数g(p) = y，该模型被称为</em> <strong class="kk iu"> <em class="mj">广义线性模型</em> </strong> <em class="mj">。所以，当你在线性回归模型上使用逻辑斯蒂函数时，你会得到逻辑斯蒂回归的算法。</em></p><p id="aca5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在剩下的唯一工作是将概率值分类，这是使用一个简单的条件完成的。如果' p' &gt; 0.5，则类为1，否则为0。</p><figure class="lt lu lv lw gt lx"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="4124" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在宫颈癌数据集上训练逻辑回归给出了<strong class="kk iu">93%的准确度，这看起来相当高</strong>，但是由于这是一个不平衡的分类，因此需要进一步分析。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/c69f32c585c138522c04e631588d3b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVVBKKOczVMklbr3_7YYrw.png"/></div></div></figure><p id="7e41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归的权重被解释为特征x的一个单位的变化改变了𝛽单位的成功几率的对数，就像简单线性回归的情况一样。但是为了简单起见，解释是根据比值比进行的，比值比只不过是对数比值的指数。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/24592d745b2799e584d1e85fbb7e297a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*yCzbpJYr1lpNr0kkPUyHDg.png"/></div></figure><p id="a6aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mj">在所有其他特征保持不变的情况下，怀孕数量的增加改变或增加了癌症与非癌症的几率1.07倍。</em></p><p id="7a49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mj">对于使用宫内节育器(IUD)的女性，在所有其他特征保持不变的情况下，与未使用IUD的女性相比，患癌与未患癌的几率低0.58倍。</em></p><p id="5ea5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">这些解释总是附带一个注释，即“所有其他特征保持不变”，以避免变量之间的相互作用。</strong></p><p id="5428" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了进一步分析分类模型的准确性，绘制了精度-召回曲线，因为这是不平衡分类的情况。</p><blockquote class="mt"><p id="1174" class="mu mv it bd mw mx my mz na nb nc ld dk translated">“然而，如果类分布中有很大的偏差，ROC曲线可能会对算法的性能表现出过于乐观的看法。[……]在信息检索中经常使用的精确回忆(PR)曲线，已经被引用作为ROC曲线的替代，用于类别分布中具有大偏斜的任务。”</p><p id="d3d9" class="mu mv it bd mw mx my mz na nb nc ld dk translated">——杰西·戴维斯和马克·戈德里奇，<br/>(引自戴维斯，j .和戈德里奇，M. 2006，</p><p id="28ad" class="mu mv it bd mw mx my mz na nb nc ld dk translated"><a class="ae le" href="https://dl.acm.org/doi/10.1145/1143844.1143874" rel="noopener ugc nofollow" target="_blank">精确回忆和ROC曲线的关系，</a>ICML 06:第23届机器学习国际会议论文集)</p></blockquote><figure class="nd ne nf ng nh lx gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/54543b727fd2a51717992c8e4a556c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bB1vyJ4Qq7YGBxia2MTWA.png"/></div></div></figure><p id="03ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">精确回忆曲线提醒人们注意这一点:对于大多数阈值来说，模型只是稍微高于无技能线。无技能线是一条平行于x轴的线，其值为数据集中阳性病例的比率，在本例中为0.06。但这与93%的高准确率相矛盾。</p><p id="3017" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对混乱矩阵的研究将澄清这种情况。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b821c18fa3e0f931ed33500423d48a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*j1sHBcvjgIC9WZMpyqlKzg.png"/></div></figure><p id="fda7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">观察到<strong class="kk iu">该分类器已经不能正确地分类任何阳性类别(类别1)</strong>。大多数情况属于0类，并且所有预测都属于0类，这一事实导致分类器的高准确度。因此，这种类的不平衡需要通过对数据集中的类1进行过采样或对类0进行欠采样来补偿，目前这已经超出了本文的范围。</p><p id="cf52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是逻辑回归如何发挥作用的，人们希望这种算法被认为是线性的背后的逻辑，以及对权重的解释现在已经很清楚了。逻辑回归仍然是机器学习世界中最强大的算法之一，由于其简单性，在不久的将来不会对其地位和重要性构成威胁。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="0035" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文基于Christoph Molnar的《可解释的机器学习》一书的探索，<a class="ae le" href="https://christophm.github.io/interpretable-ml-book/logistic.html" rel="noopener ugc nofollow" target="_blank">第4.2节</a>你可以在这里找到Github repo <a class="ae le" href="https://github.com/Anpr1211/Interpretable-ML" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>