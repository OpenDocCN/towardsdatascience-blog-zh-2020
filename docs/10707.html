<html>
<head>
<title>10 Programming Concepts to Tame A Myriad of Spreadsheets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">驯服无数电子表格的 10 个编程概念</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-programming-concepts-to-design-a-spreadsheet-system-around-9ab3f6704d06?source=collection_archive---------42-----------------------#2020-07-26">https://towardsdatascience.com/10-programming-concepts-to-design-a-spreadsheet-system-around-9ab3f6704d06?source=collection_archive---------42-----------------------#2020-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="89aa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何将你的一群电子表格从猫变成羊</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35e361708dd082c51871e0234f2fcc5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*giUaWKd3nd_ujW1C"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">制造者在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@nesabymakers?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> NESA 的照片</a></p></figure><p id="807e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> F </span>在工作中，我不时会听到同事们谈论找不到电子表格或忘记更新电子表格，因此信息错位，耗费他们的时间和精力来重做一切。</p><p id="6c03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管电子表格对于业务用户创建数据驱动的流程(例如，可视化的数据操作、BI 报告和某种程度的自动化)的门槛很低，但它们也很快滋生了孤岛，因为每个人都有自己版本的相同流程。</p><p id="dee1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，没有人喜欢“伟大的电子表格”，那么我们如何在他们成为我们最大的敌人之前和他们交朋友呢？</p><p id="76f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然<a class="ae ky" rel="noopener" target="_blank" href="/dear-businesses-perfect-spreadsheets-and-sql-first-747e2cbef825">我的上一篇文章</a>给出了一个理想化的案例研究，介绍了一家公司如何更容易地从使用电子表格过渡到使用 SQL 进行快速查询和报告周转，但 SQL 并不是最终答案。业务涉众必须定义一组电子表格解决的确切的业务问题以及它们收集的数据类型。</p><p id="29c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管 Knox 很好地强调了滞后指标和领先指标的区别，但我想补充的是，在探索更多领先指标之前，滞后指标的报告应该是高质量的。如果一份关于月收入、运营成本或客户订阅的报告来自多个电子表格，你将会把时间花在困惑和对数字进行质量评估上，而不是探索可能影响它们的领先指标。</p><p id="7f77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦为滞后指标建立了报告渠道，并且有少数领先指标显示出影响滞后指标的有希望的结果，这就是<a class="ae ky" rel="noopener" target="_blank" href="/designing-data-products-b6b93edf3d23">数据产品</a>的开始。</p><p id="1c08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不管将来它是否会被重构为 BI 工具或软件解决方案，<strong class="lb iu">已经设计了</strong> <a class="ae ky" href="https://medium.com/swlh/using-spreadsheets-for-prototyping-a17f011109d0" rel="noopener"> <strong class="lb iu">一个复杂的电子表格系统正在为一个成熟的数据产品</strong> </a>做原型。</p><p id="65b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事不宜迟，让我们来看看这 10 个从软件开发中借鉴来的概念，电子表格用户可以将它们添加到他们的技术技能工具箱中，并提高他们在“处理表格”中的生产率。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/7d975ea6124e5ef134f8a3f45f34ef9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OfLjZKPCAxyeIabl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">萨姆·丹·张在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="980b" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">1.整理资产</h1><p id="b5a8" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">用户如何识别数据集中的唯一记录？还记得当查找值依赖于多个字段时需要执行的串联吗？在 RDBMS 世界中，这些串联字段被视为“<a class="ae ky" href="https://www.guru99.com/dbms-keys.html" rel="noopener ugc nofollow" target="_blank">候选键</a>，或者在不同的上下文中也被称为“<a class="ae ky" href="http://www.agiledata.org/essays/keys.html" rel="noopener ugc nofollow" target="_blank">自然键</a>，因为它们是原始数据集的一部分，并且是最好不要由公式创建的独立变量。虽然使用自然键便于人们阅读和直观理解，但是使用它们有两个缺点。首先，如果业务逻辑发生变化，键的数量或一个键的含义也可能发生变化。其次，随着键的数量和/或这些键的潜在值的增加，它降低了电子表格的性能。因此，使用指定的惟一标识符(类似于 CAT-PRODUCT-1)跟踪自然键(每次真正有新记录时递增 1)是一种经得起未来考验的权衡，既保留了不断发展的业务逻辑，又实现了使用单个标识符(然后成为主键)而不使用纯整数代理键的优雅。</p><h1 id="30a3" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">2.数据类型</h1><p id="9c4c" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">请注意公式如何抛出“#VALUE！”当你试图用文本除一个数时出错，你希望早点知道这个愚蠢的问题？许多<a class="ae ky" href="https://support.google.com/docs/table/25273?hl=en" rel="noopener ugc nofollow" target="_blank">公式是特定于类型的</a>，因此理解值的数据类型确实有助于调试错误和清除数据，例如 2 而不是“2”或 07/20/2020 22:35 而不是 1595284509。有一些<a class="ae ky" href="https://en.wikipedia.org/wiki/Data_type" rel="noopener ugc nofollow" target="_blank">常见的数据类型</a>如字符串、整数、浮点、日期时间和布尔。人们也可以将数据类型视为计算机的记账系统，因为计算机内的资源是有限的。Integer 比 float 占用的内存空间少，boolean 占用的空间最少，只有两个可能的值，0 和 1。转换一个字段的数据类型就相当于告诉计算机你愿意给它分配多少空间，所以当一个对象占用了过多的空间时，性能可以得到调整。</p><h1 id="28ca" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">3.属性与价值</h1><p id="b8a9" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">或者电子表格行话中的<a class="ae ky" href="https://en.wikipedia.org/wiki/Attribute-value_system" rel="noopener ugc nofollow" target="_blank">列对</a>行。如果你说这两种语言中的任何一种，你都知道我在说什么，这是有区别的。许多用户根据他们当时正在开发的报告任意地确定这一点。虽然财务报表需要“一月”、“二月”、“三月”都是它们自己的列，但是提供给报表的原始数据可能不需要，所以您需要一个名为“月”的属性以及“一月”、“二月”、“三月”的值。在数据处理的不同阶段区分这两者与您的报告流程的简化程度有关，也是下一个指针中“整洁数据”的基石之一。</p><h1 id="f2a5" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">4.整洁的数据(英尺。宽或长的桌子)</h1><p id="06ca" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">许多用户花费大量的时间和精力来开发和维护一个丰富多彩的 Excel 报表，它通常看起来非常宽，尤其是财务报表。如果这些报告不是“中间”数据，仍然需要被操作来生成另一个报告，那么它们是非常好的。经理们也喜欢这种视图，因为它们看起来像数据透视表。另一方面，对于分析师来说，创建一个 fork 过程是至关重要的，其中一个过程导致一个“宽表”报告，另一个导致一个“长表”。一个规范化的长表就是 t <a class="ae ky" href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html" rel="noopener ugc nofollow" target="_blank"> idy 数据</a>(源自一个名为 tidyr 的 R 包)的样子。这种格式最适合分析和可视化。</p><h1 id="a9db" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">5.数据字典或映射</h1><p id="394d" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">有些价值观的组合根本没有意义，但是你如何在一开始就防止它们发生呢？在 Excel 中，无所不能的<a class="ae ky" href="https://www.contextures.com/xlDataVal02.html" rel="noopener ugc nofollow" target="_blank">间接函数</a>会帮你完成繁重的工作。只要您的公式是正确的，您将只看到根据其他值进行选择的有意义的值。但是即使是间接的也需要一个“地图”来知道哪些对是有效的。开始一个全新的选项卡并键入可能的组合很有诱惑力，但是等等，一个不太冗余的方法是将这些映射都放在一个共享目录中。这样，每个人都引用相同的内容，并避免手动创建可能与原始副本略有不同的冗余选项卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/68a4724ae2bf3e4de0908ba2523790fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*sMbHz29J1QSGpETpkdUCEg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托尼·赫斯特在谷歌电子表格中的数据验证</p></figure><h1 id="7109" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">6.数据有效性</h1><p id="25d4" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">数据验证通常不被重视，直到人们意识到“他们应该(或可能)在字段上设置一个简单的约束，这样至少当一个无效值出现时，它会对你怒目而视。为了补充这一点，利用数据字典来建议可能的值，而不是等待无效的值，特别是对于有类别的文本。此外，条件格式也是一个很好的工具，可以用来验证还没有任何“绑定”的数据。尤其是当您还不熟悉收集到的值时，使用条件格式会立即用突出显示的颜色突出重复或异常值。</p><h1 id="60c7" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">7.结构化目录</h1><p id="8fcf" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">也许这与一个人的组织技能有关，而不是操作电子表格的技术能力，但是即使在软件工程中，文件的<a class="ae ky" href="https://tutorialsinhand.com/tutorials/software-engineering-tutorial/software-design/modular-and-layered-design.aspx#:~:text=In%20the%20layered%20design%2C%20the,get%20a%20certain%20task%20done." rel="noopener ugc nofollow" target="_blank">位置对模块化应用程序</a>的功能也有重要影响。通常，更频繁使用的对象会更靠近根文件夹(第一层)，而更具体使用的对象会有自己专用的子文件夹。如果文件是以这种方式组织的，而不是按照个人偏好或特定部门的逻辑，那么它不仅可以方便任何人的文件导航，还可以激励未来的开发人员基于现有系统设计软件解决方案。</p><h1 id="73c8" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">8.公式与脚本</h1><p id="39eb" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">随着职业生涯的进一步发展，许多经验丰富的分析专家会发现自己至少是半个程序员。这是因为他们已经能够流利地编写公式，甚至是支持电子表格软件的脚本语言(Excel 的 VBA 和 Google Sheet 的 Google Apps 脚本)。虽然这是开始自动化手动工作的一个很好的地方，但人们应该将前面的要点纳入整体考虑，因为在 8 个电子表格中编写 8 个 Vlookup 也是手动的，并且不可伸缩。通常情况下，如果电子表格变慢了，或者调试脚本变得困难了，这就是分解或简化它试图执行的任务的信号。</p><h1 id="26fa" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">9.用户输入表单</h1><p id="3ab9" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">永远不要相信你的用户。这是很多人宣扬的，我再补充一条:也永远不要相信自己。如果您是输入数据或为其他人输入数据创建空间的人，最好不要让数据生成者看到基础表，尤其是当它还包含数据生成者不直接输入的数据时。数据生产者应该只关注需要他们输入的字段，这些字段应该有护栏，如不允许的值和/或必填字段。在这种情况下，表单会派上用场，为了进一步降低出现错误数据的可能性，可以使用下拉菜单(如果只有某些允许的值，请记住利用第 5 点中的数据映射！)和自动完成。</p><h1 id="ed46" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">10.机器生成的值</h1><p id="d4a6" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">如果我不得不相信其中一个，我会选择机器生成的值而不是用户输入的值。这应该有自己的一个小部分，因为利用机器为您生成/转换/推导值本身就是过程标准化和自动化的一个里程碑。还记得那些极其相似的电子邮件吗？它们的附件都是你应该关心的发票或明细表格。不要一个一个地打开，然后手动将它们转录到电子表格中。接入 API。自动化数据提取。如果有根据用户输入填充的日期时间字段，则在公式检测到用户输入时为他们填写，而不是要求他们填写。只要有替代用户输入的方法，就要考虑自动收集数据。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="3cfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">虽然我同意基于文件的系统所能提供的是有限的，但电子表格仍然被证明是业务人员和技术人员都理解的灵活、低预算的入门工具。我经常发现，从长远来看，应用更多的编程概念有助于分析专家帮助企业更好地控制他们的数据。</p><p id="da6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，买一个最新型号的吸尘器，它还可以拖地，如果你没有养成清理和清理吸尘器路径的习惯，它就不会得到很好的利用。聘请顾问或为软件解决方案付费是没有问题的，但如果电子表格用户继续在分散的手动电子表格上运行关键业务流程，这些就没有什么意义了。</p><p id="9f4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">决策者在顾问或软件解决方案上花费大量金钱，希望这些能清除他们低效的流程，当<strong class="lb iu">归结为一个更好的深思熟虑的(和记录在案的)业务流程和一个更有组织的电子表格系统。</strong></p><p id="db66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有太多的时候，我看到耸人听闻的文章标题炒作电子表格或 SQL 是否已经“到达其终点”，而事实上，每个人仍然非常依赖它。鉴于大多数企业的资源和知识有限，利用电子表格作为数据产品原型的起点，比眼睁睁地看着一个“遗留”的优秀电子表格不断增长，直到下一个最佳解决方案出现，要实用和高效得多。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="4d0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nk">特别感谢我的作品萌芽、</em> <a class="ae ky" href="https://www.linkedin.com/in/abe-train-81418714b/" rel="noopener ugc nofollow" target="_blank"> <em class="nk">安倍列车</em> </a> <em class="nk">，是他们给了我写作的灵感，并对本文进行了反馈。</em></p></div></div>    
</body>
</html>