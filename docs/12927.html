<html>
<head>
<title>Gaining an Intuition for Neural Networks from 16 lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从 16 行代码中获得神经网络的直觉</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gaining-an-intuition-for-neural-networks-c720b111031f?source=collection_archive---------22-----------------------#2020-09-05">https://towardsdatascience.com/gaining-an-intuition-for-neural-networks-c720b111031f?source=collection_archive---------22-----------------------#2020-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/98e835adac456ab74c518b877dbb07b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YECeOxlko9KoOJNw8RNm3A.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">艾莉娜·格鲁布尼亚克在<a class="ae kf" href="https://unsplash.com/s/photos/neural-network?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="749f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">神经网络相当令人困惑，尤其是当你从头开始编程的时候。本文将通过创建和训练一个单变量回归模型(在输入和输出之间有一个突触),让您直观地了解神经网络工作所需的相关概念。</p><h2 id="e91a" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">神经网络是如何工作的？</h2><p id="911b" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">假设你是一名医生，你希望找到身高和体重之间的定量关系:也就是说，你希望能够可靠地预测某人的体重，给定他们的身高。</p><p id="a214" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到目前为止，你有 5 个人的身高和体重数据。这是在笛卡尔平面上绘制数据时的图表:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/ceafea32fd4bd47d38811ce393bd91c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*RBAtwNwMaH-VOuOJ7-_2vg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="612a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们看这个图表时，我们可以想象出一条线来最好地解释这些数据，但是我们想对此进行量化。这就是使用神经网络的地方，或者在这种情况下，我们的单变量回归模型。</p><p id="4569" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">神经网络保存一个奇异变量α，当乘以给定的身高时，给出预测的体重。让我们随机生成α，并将其绘制在我们的图表上:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/c0727896cfd8a5527959924a2fd5d368.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*_tdomzdhm1xNziEFOTCD2A.png"/></div></figure><p id="46ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到这条线没有很好地包含数据。它对数据的量化有多糟糕？测量蓝点和这条线之间的距离，并将它们相加。平方这个值。为什么值是平方？两个原因:</p><ul class=""><li id="c22e" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">为了防止负数不受惩罚</li></ul><p id="0a48" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">距离较远的负数(线下的点)仍然是不准确的预测。当我们平方它们时，它们变成正数</p><ul class=""><li id="5a8e" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">惩罚更大的距离</li></ul><p id="a700" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">100–3 = 97，但是 100–3 = 9991。距离越大，网络受到的惩罚就越多。</p><p id="00da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是均方误差损失函数，衡量网络预测数据的好坏。这个值越大，模型越差。</p><p id="a7b9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">神经网络的目标是减少这种损失函数，从而使预测更加准确。我们如何做到这一点？我们不能改变数据，我们唯一能改变的值是α。</p><p id="f5ee" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们不太确定α的最佳值是多少，所以我们测试了不同的α值，记录了损失值，并绘制在图表上。因为我们想找到α的哪个值使损失值最低，所以需要找到最低点。在这种情况下，介于 0 和 0.5 之间。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/c49319646aaf28931c1157b386ff4a7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*oGva378wFmyTN2C4rR7Hkw.png"/></div></figure><p id="aa32" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们如何让计算机来做这件事？我们发现了一种叫做导数的东西。导数是图形在某一点的陡度。也是图形的梯度。我们要计算的是损失对α的导数，也就是说，当给定点 a 时，图有多陡。</p><p id="0646" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是我们不能把这两个变量直接联系起来，因为它们之间没有直接关系。我们用高度值乘以α，然后用它来计算损失。</p><p id="c267" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了计算α和损失之间的导数，我们必须计算损失和预测值之间的导数，然后计算预测值和α之间的导数。最后，我们将它们相乘，找出损失值与α之间的导数。</p><p id="45fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">损失值和预测值(高度* α)之间的导数是 2 *(真实-预测)，因为 x 的导数是 2x。预测值和 alpha 之间的导数就是数据，因为 alpha 要乘以数据。</p><p id="a2a2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了简单起见，不使用列表，我将体重身高的例子改为只预测值 2，作为 alpha。代码如下:</p><pre class="md me mf mg gt mr ms mt mu aw mv bi"><span id="b75c" class="le lf it ms b gy mw mx l my mz">import numpy as np<br/>x = 2<br/>y = x*2</span><span id="d0f0" class="le lf it ms b gy na mx l my mz">alpha = np.random.randn()</span><span id="7770" class="le lf it ms b gy na mx l my mz">for i in range(100):<br/>    pred = alpha*x<br/>    loss = np.square((y-pred))</span><span id="cff2" class="le lf it ms b gy na mx l my mz">dloss_dpred = 2*(y-pred)<br/>    dpred_dalpha = x<br/>    dloss_dalpha = dloss_dpred * dpred_dalpha</span><span id="1b6f" class="le lf it ms b gy na mx l my mz">alpha += dloss_dalpha*0.1<br/>alpha</span></pre><p id="a08f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 1 行:Python 中的一个有用工具。在这种情况下，它用于生成随机值。</p><p id="f1d4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 2–3 行:网络试图计算出 x 乘以多少得到 y。它应该趋向于 2。</p><p id="afba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 5 行:这是变量 alpha 的随机生成。</p><p id="deb4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 7–12 行:这段代码计算导数并将它们相乘。</p><p id="4f46" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 15 行:Alpha 向正确的方向变化，一点一点，直到趋于最佳值。</p><p id="256a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个程序应该输出 2 作为结果。</p></div></div>    
</body>
</html>