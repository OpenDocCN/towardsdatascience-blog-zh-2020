# Set-TSP çš„åŠ¨æ€è§„åˆ’æ–¹æ³•

> åŸæ–‡ï¼š<https://towardsdatascience.com/set-tsp-because-there-is-more-than-one-place-to-get-bread-712fdb5b381?source=collection_archive---------32----------------------->

![](img/3b7a7d225b59bcd384d6b89c3397309b.png)

## å› ä¸ºæœ‰ä¸æ­¢ä¸€ä¸ªåœ°æ–¹å¯ä»¥ä¹°åˆ°é¢åŒ…

[æ—…è¡Œæ¨é”€å‘˜é—®é¢˜](https://en.wikipedia.org/wiki/Travelling_salesman_problem) (TSP)æå‡ºäº†ä¸€ä¸ªç®€å•çš„éš¾é¢˜:ä½ æƒ³è¦è®¿é—®ä¸€ç»„åœ°æ–¹ï¼Œä¾‹å¦‚ï¼Œä½ åœ¨é•‡ä¸Šçš„å·®äº‹ï¼Œå¹¶ä¸”æƒ³è¦ä»¥æœ€æœ‰æ•ˆçš„æ–¹å¼è¿™æ ·åšã€‚è¿™ä¸ªé—®é¢˜å·²ç»ç”¨æ— æ•°ä¸åŒçš„æ–¹æ³•è§£å†³äº†ï¼Œæ—¢æœ‰[æœ€ä¼˜](/solving-tsp-using-dynamic-programming-2c77da86610d)ä¹Ÿæœ‰[å¯å‘å¼](https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8)ã€‚

ä½ ä¼šé—®ï¼Œæˆ‘ä»¬ä»Šå¤©åœ¨è¿™é‡Œåšä»€ä¹ˆï¼Ÿå—¯ï¼Œç”Ÿæ´»çš„äº‹å®æ˜¯ï¼Œæœ‰ä¸æ­¢ä¸€ä¸ªåœ°æ–¹å¯ä»¥ä¹°åˆ°é¢åŒ…ï¼Œæˆ–è€…æ„å¤§åˆ©é¢ï¼Œæˆ–è€…ä½ çš„å·®äº‹å•ä¸Šçš„ä»»ä½•ä¸œè¥¿ã€‚åœ¨ç”Ÿæ´»ä¸­ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬æƒ³è¦å®Œæˆä¸€ç»„ä»»åŠ¡ï¼Œè€Œä¸å¤ªå…³å¿ƒæ¯é¡¹ä»»åŠ¡æ˜¯å¦‚ä½•å®Œæˆçš„ã€‚

æƒ³è±¡ä¸€ä¸ªæ˜ŸæœŸäº”çš„æ—©æ™¨ï¼Œæˆ‘æƒ³(a)ä»æˆ‘æ‰€åœ¨åœ°åŒºçš„ä¸‰å®¶é¢åŒ…åº—ä¹‹ä¸€ä¹°é¢åŒ…ï¼Œ(b)ä»æˆ‘æ‰€åœ¨åœ°åŒºçš„ä¸‰å®¶å•†åº—ä¹‹ä¸€ä¹°è”¬èœï¼Œ(c)åœ¨é•‡ä¸­å¿ƒçš„ä¸¤å®¶é…’å§ä¹‹ä¸€å–æ¯å•¤é…’ã€‚

![](img/c419b751feead8c49eddb4f2fcf86442.png)

æ—¢ç„¶æœ‰äººé—®æˆ‘ï¼Œæˆ‘å°±åˆ†äº«ä¸€ä¸‹:æƒ³çŸ¥é“æˆ‘æ˜¯å¦‚ä½•åˆ¶ä½œè¿™äº›æ’å›¾çš„å—ï¼Ÿæˆ‘ä» [s2map](http://s2map.com/) ä¸­æ‹æ‘„äº†ä¸€å¼ å¿«ç…§ï¼Œå¹¶åœ¨ç¨åä½¿ç”¨ Google Slides æ·»åŠ äº†è¿™äº›å›¾åƒã€‚æ˜¯çš„ï¼Œé‚£æ˜¯æˆ‘æ‡’æƒ°çš„ç§˜å¯†ï¼›)

é‚£ä¹ˆï¼Œå®Œæˆè¿™ä¸‰é¡¹ä»»åŠ¡çš„æœ€å¿«æ–¹æ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ
è¿™æ­£æ˜¯ [Set-TSP](https://en.wikipedia.org/wiki/Set_TSP_problem) (Set -æ—…è¡Œæ¨é”€å‘˜é—®é¢˜)çš„åŠ¨æœºâ€”â€”å®Œæˆæ‰€æœ‰ä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡åªå®Œæˆä¸€æ¬¡ï¼Œè¿™æ ·æ¯ä¸ªä»»åŠ¡å°±æœ‰å‡ ä¸ªé€‰é¡¹å¯ä»¥å®Œæˆã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨[åŠ¨æ€è§„åˆ’](https://en.wikipedia.org/wiki/Dynamic_programming) (DP)æ„å»ºä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè¿™å°†ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªæœ€ä¼˜çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”åœ¨æœªæ¥æˆ‘ä»¬è¿˜å°†æ‰¾åˆ°ä¸€ä¸ªå¯å‘å¼çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥ç”¨äºæ›´å¤§çš„è¾“å…¥ï¼Œè€Œä¸ä¼šåœ¨æœ€ä¼˜æ€§ä¸ŠæŸå¤±å¤ªå¤š(æˆ–è€…æ˜¯è¿™æ ·å—ï¼Ÿï¼Ÿï¼Ÿæ•¬è¯·æœŸå¾…ä¸€æ¢ç©¶ç«Ÿï¼).

![](img/3373250b13f8f3f34a03e1afe3bb5aa9.png)

> **å…³äºè¿™ç¯‡æ–‡ç« åé¢çš„å®Œæ•´ä»£ç ï¼Œä½ å¯ä»¥å»** [**è¿™é‡Œ**](https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP) **ã€‚**

# å¥ å®šåŸºç¡€

ä¸ºäº†è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å†³å®šä¸€ç§è¡¨ç¤ºè¾“å…¥æ•°æ®çš„æ–¹å¼ï¼Œå¹¶ä»ä¸­å¯¼å‡ºç”¨äºè®¡ç®—æ‰€éœ€æœ€çŸ­è·¯å¾„çš„è·ç¦»åº¦é‡ã€‚

åœ¨å¤„ç†åœ°ç†æ•°æ®æ—¶ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨è¿™é‡Œæ‰€åšçš„ï¼Œä¹ æƒ¯ä¸Šä½¿ç”¨ç»çº¬åº¦åæ ‡æ¥æ ‡è¯†ä½ç½®ã€‚ä»¤æˆ‘ä»¬æ²®ä¸§çš„æ˜¯ï¼Œè¿™äº›æ˜¯[éæ¬§å‡ é‡Œå¾—åæ ‡](https://en.wikipedia.org/wiki/Non-Euclidean_geometry)ï¼Œå› æ­¤è®¡ç®—ç®€å•çš„[æ¬§å‡ é‡Œå¾—è·ç¦»](https://en.wikipedia.org/wiki/Euclidean_distance)å¤§å¤šæ˜¯é”™è¯¯çš„ã€‚

> å£°æ˜:åœ¨[ä¹‹å‰çš„ä¸€ç¯‡å¸–å­](https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8)ä¸­ï¼Œæˆ‘ç¡®å®ä½¿ç”¨äº†æ¬§å‡ é‡Œå¾·è·ç¦»æ¥è¡¨ç¤ºéæ¬§å‡ é‡Œå¾·åæ ‡ï¼Œä½†æ˜¯â€¦â€¦è¿™æ˜¯ä¸€ç¯‡ä»‹ç»æ€§çš„å¸–å­ï¼Œæˆ‘ä¸æƒ³è·‘é¢˜ï¼›)

æ‰€ä»¥â€”â€”è®©æˆ‘ä»¬æ¥è°ˆè°ˆæˆ¿é—´é‡Œçš„å¤§è±¡å§ï¼æˆ‘ä»¬å¦‚ä½•è®¡ç®—è·ç¦»ï¼Ÿ

![](img/09b7be22231371c776f0273a29795a78.png)

å¾ˆé«˜å…´ï¼Œè¿™ä¸ªä¸–ç•Œå·²ç»ä¸ºæˆ‘ä»¬æ­å¥½äº†èˆå°â€”â€”æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[å“ˆå¼—è¾›å…¬å¼](https://en.wikipedia.org/wiki/Haversine_formula)ï¼Œå¹¶ä»[è¿™ä¸ª](https://stackoverflow.com/a/21623206/2934048)å¾—åˆ°ä¸€äº›å¸®åŠ©:

ç°åœ¨æˆ‘ä»¬å¯ä»¥æ­£ç¡®è®¡ç®—è·ç¦»ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆã€‚

# æ„å»º DP æ ‘

æ„å»ºåŠ¨æ€è§„åˆ’(DP)ç®—æ³•éœ€è¦äº†è§£æˆ‘ä»¬å¸Œæœ›å¦‚ä½•éå†è§£ç©ºé—´ï¼Œä»¥åŠæˆ‘ä»¬å¸Œæœ›å¦‚ä½•è·Ÿè¸ªæˆ‘ä»¬çš„å½“å‰çŠ¶æ€ã€‚

å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘å‘ç°ç›´æ¥è¿›å…¥é›†åˆ-TSP é—®é¢˜ç›¸å½“ä»¤äººå›°æƒ‘ï¼Œå› æ­¤å†³å®šå…ˆè§£å†³ä¸€ä¸ªæ›´ç®€å•çš„é—®é¢˜â€”â€”â€œåªæ˜¯â€TSPï¼Œæ²¡æœ‰â€œé›†åˆâ€ã€‚

æˆ‘ç°åœ¨å°†æè¿°ä½¿ç”¨ DP çš„ Set-TSP è§£å†³æ–¹æ¡ˆçš„æ•´ä¸ªç®¡é“ï¼Œä½†æ˜¯å¦‚æœä½ å‘ç°è‡ªå·±æœ‰äº›å›°æƒ‘ï¼Œå°±åƒæˆ‘ä¸€æ ·ï¼Œæˆ‘å»ºè®®é¦–å…ˆé˜…è¯»[è¿™ä¸ª](/solving-tsp-using-dynamic-programming-2c77da86610d)ã€‚

ç±»ä¼¼äºè®¸å¤šç»å…¸çš„ DP ç®—æ³•ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå­—å…¸å­˜å‚¨å™¨ï¼Œå…¶å…³é”®å­—æ˜¯*çŠ¶æ€*ï¼Œå€¼æ˜¯åˆ°è¾¾è¯¥çŠ¶æ€çš„æœ€ä½³æ–¹å¼çš„â€œæ–¹å‘â€ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œè¯¥å€¼æ˜¯ä¸€ä¸ªåˆ°é”®çš„æœ€çŸ­è·¯å¾„ä¸­çš„*ç›´æ¥å‰ä»»*ã€‚è®©æˆ‘ä»¬ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¿™ä¸ªè¿‡ç¨‹:

![](img/040fe0d450a1040eaea4719d6759757c.png)

è¿™é‡Œï¼Œå…³é”®å­—([s1ï¼Œs2ï¼Œs3ï¼Œs4]ï¼Œs4ï¼Œv9)è¡¨ç¤ºå·²ç»è®¿é—®äº†æ‰€æœ‰é›†åˆçš„çŠ¶æ€ï¼Œä½¿å¾— s4 æ˜¯æœ€åè®¿é—®çš„é›†åˆï¼Œè€Œ v9 æ˜¯è¯¥é›†åˆä¸­è®¿é—®çš„ç‚¹ã€‚è¯¥é”®çš„å€¼æ˜¯(s2ï¼Œv4ï¼Œ1.5)ï¼Œå› ä¸ºä»¥æ­¥éª¤ v4->v9 ç»“æŸçš„è·¯å¾„æœ€çŸ­ã€‚

![](img/7325e064904ab001f0638956dbe73463.png)

ä»£ç å¯èƒ½çœ‹èµ·æ¥å¾ˆæ··ä¹±ï¼Œè€Œä¸”å……æ»¡äº†å˜é‡ï¼Œä½†æ˜¯ä¸€æ—¦ä½ ç†è§£äº† DP çš„ä¸€èˆ¬æ–¹æ³•ï¼Œå¹¶ä¸”ç†è§£äº†ä½ æƒ³è¦ä½¿ç”¨çš„å¤‡å¿˜å½•çš„é€»è¾‘ï¼Œå®ƒå°±â€œåªæ˜¯â€å¦ä¸€ä¸ª DP å®ç°ã€‚

# å›æº¯æœ€çŸ­è·¯å¾„

ä¸€æ—¦æˆ‘ä»¬åˆ°è¾¾äº†æ ‘çš„æœ«ç«¯ï¼Œæ„å‘³ç€æˆ‘ä»¬åœ¨å¤‡å¿˜å½•ä¸­ä¿å­˜çš„è·¯å¾„æ˜¯å®Œæ•´çš„ï¼Œé‚£ä¹ˆâ€œå‰©ä¸‹çš„ä¸€åˆ‡â€å°±æ˜¯æŠ˜å›æˆ‘ä»¬çš„æ­¥éª¤ä»¥æ‰¾åˆ°æœ€ä½³è·¯å¾„ã€‚

å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬è®°ä½äº†æ¯ä¸ªéƒ¨åˆ†è·¯å¾„ä¸­çš„æœ€åä¸€ä¸ªå’Œå€’æ•°ç¬¬äºŒä¸ªé›†åˆå’Œç‚¹ï¼

![](img/b145892a8333a15787566ddd9c278ce7.png)

æˆ‘ä»¬çš„çº¢è‰²æœ€ä¼˜è·¯å¾„:[(s1ï¼Œv3)ï¼Œ(s4ï¼Œv9)ï¼Œ(s2ï¼Œv4)ï¼Œ(s3ï¼Œv6)]

å› æ­¤ï¼Œç¬¬ä¸€æ­¥å°†æ˜¯æŸ¥çœ‹æœ€ç»ˆå›¾å±‚ï¼ŒåŒ…æ‹¬æ‰€æœ‰å®Œæ•´çš„è·¯å¾„ï¼Œå¹¶é€‰æ‹©æ€»æˆæœ¬æœ€ä½çš„æœ€åä¸€ä¸ªé›†åˆå’Œç‚¹ã€‚

ä»é‚£é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å€’æ•°ç¬¬äºŒä¸ªé›†åˆå’Œç‚¹æ¥è¿½æº¯æˆ‘ä»¬çš„æ­¥éª¤ã€‚

![](img/eafdcbdf4a8de7766295241c9025c56d.png)

# å®è´ï¼Œä¸ç”»å‡ºæ¥å°±ä¸ä¼šç»“æŸ

åœ¨æˆ‘ä¸ºè¿™ç¯‡æ–‡ç« å‡†å¤‡çš„ [jupyter ç¬”è®°æœ¬](https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP)ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæœ‰ç”¨çš„ç»˜å›¾åŠŸèƒ½ï¼Œè®©ä½ åœ¨ [geojson.io](http://geojson.io/) ä¸Šç»˜åˆ¶ä½ çš„è§£å†³æ–¹æ¡ˆ:

![](img/0eb312568511c278369773a19be9ce1e.png)

åœ¨åŒä¸€ä¸ªç¬”è®°æœ¬é‡Œï¼Œä½ è¿˜å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªè¾“å…¥é‡å¤§å¾—å¤šçš„ä¾‹å­ã€‚ç”±äºé›†åˆ TSP çš„å¤æ‚åº¦åœ¨é›†åˆæ•°é‡ä¸Šæ˜¯*æŒ‡æ•°*ï¼Œåœ¨æ¯ä¸ªé›†åˆä¸­çš„ç‚¹çš„æ•°é‡ä¸Šæ˜¯*å¤šé¡¹å¼*ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç›¸å½“å¤§çš„è¾“å…¥çš„æœ€ä¼˜è§£:

![](img/67241c5254f3ec96767635d34b74257f.png)

# æ”¶åœºç™½

å½“æˆ‘ç¬¬ä¸€æ¬¡äº†è§£ Set-TSP æ—¶ï¼Œå…³äºè¿™ä¸ªé—®é¢˜çš„ç»“æ„çš„ä¸€äº›ä¸œè¥¿å‘æˆ‘å°–å«ï¼Œå®ƒåº”è¯¥æœ‰ä¸€ä¸ªä½¿ç”¨åŠ¨æ€ç¼–ç¨‹(DP)çš„ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚çš„ç¡®ï¼Œè¿™ç¯‡æ–‡ç« ä¸­çš„ç®—æ³•è®©æˆ‘ç›¸ä¿¡æˆ‘çš„ç›´è§‰æ˜¯æ­£ç¡®çš„ã€‚

è€å®è¯´ï¼Œè¿™ä¸ªç®—æ³•å¯¹æˆ‘æ¥è¯´å¹¶ä¸å®¹æ˜“ã€‚å› æ­¤ï¼Œæˆ‘çš„è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†æ˜¯é¦–å…ˆè§£å†³ä¸€ä¸ªç±»ä¼¼çš„ï¼Œä½†æ›´ç®€å•çš„é—®é¢˜ã€‚æˆ‘å†³å®šå…ˆæ‰¾åˆ° TSP çš„ [DP è§£ï¼Œç„¶åæ‰æŠŠè§£æ‰©å±•åˆ° Set-TSPã€‚è¿™å¯¹æˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„æˆåŠŸï¼Œå› ä¸ºæˆ‘æ²¡æœ‰ä¸€æ¬¡ç»å°½è„‘æ±ï¼Œè€Œæ˜¯è·å¾—äº†ä¸¤æ¬¡è½»æ¾çš„èƒœåˆ©ï¼è€Œä¸”ï¼Œä¸¤æ¬¡è§£å†³*å‡ ä¹*åŒä¸€ä¸ªé—®é¢˜çš„ç»å†ï¼Œå¸®åŠ©æˆ‘æ›´å¥½åœ°â€œé“­è®°â€äº† DP æŠ€èƒ½ï¼Œç»™äº†æˆ‘â€œæˆ‘å¾—åˆ°äº†è¿™ä¸ªâ€çš„å®šå¿ƒä¸¸ã€‚](/solving-tsp-using-dynamic-programming-2c77da86610d)

æ‰€ä»¥ä¸‹æ¬¡ä½ æ‰‹å¤´æœ‰ä¸€ä¸ªæ£˜æ‰‹çš„ä»»åŠ¡æ—¶ï¼Œè¯•ç€å…ˆè§£å†³ä¸€ä¸ªç®€å•çš„ã€‚ä½ å¾ˆå¯èƒ½ä¼šæ›´å¿«åœ°æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œè€Œä¸”ä½ ä¹Ÿä¼šä»ç¬¬äºŒæ¬¡æ›´å¥½çš„æˆåŠŸä¸­è·å¾—ä¿¡å¿ƒğŸ’ªğŸ¿

å¸Œæœ›ä½ å–œæ¬¢æˆ‘çš„æ—…ç¨‹ï¼Œå¹¶åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°ä¸€ä¸ªå¯å‘å¼çš„è§£å†³æ–¹æ¡ˆæ¥è®¾ç½® TSPï¼Œå¹¶æ¯”è¾ƒç»“æœğŸ¤“

> **è¿™ç¯‡æ–‡ç« åé¢çš„å®Œæ•´ä»£ç ä½ å¯ä»¥å»** [**è¿™é‡Œ**](https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP) **ã€‚**

![](img/7f1c9f2f5cfb1ed9aaffac00bcf4dd77.png)