<html>
<head>
<title>Modeling the Risk of Traffic Accidents in New York City</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟纽约市的交通事故风险</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modeling-the-risk-of-traffic-accidents-in-new-york-city-9292c5ae4ab4?source=collection_archive---------28-----------------------#2020-02-01">https://towardsdatascience.com/modeling-the-risk-of-traffic-accidents-in-new-york-city-9292c5ae4ab4?source=collection_archive---------28-----------------------#2020-02-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6cbd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用convLSTM2D深度学习模型对交通事故风险进行分类</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a8600b8309120ad874866578b21c1251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9WTcb2qZ3CHcPySIcvcxQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://pixabay.com/users/patmikemckane-186417/" rel="noopener ugc nofollow" target="_blank">帕特米克凯恩</a>，经由<a class="ae ky" href="https://pixabay.com/photos/new-york-ny-nyc-new-york-city-city-286071/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a> (CC0)</p></figure><h1 id="56db" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">问题陈述</h1><p id="a8e7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">仅在2017年，美国就有超过3.7万人死于道路交通事故。2010年与交通事故相关的成本(来自2015年发表的一份报告)为2420亿美元，占当年国内生产总值的1.6%。以运输为生的公司将受益于关于哪里更可能发生事故的信息，因此他们可以避开这些地区，降低事故风险。优步和Lyft等拼车公司依赖于快速安全地从一个地方到达另一个地方，以获得客户满意度。优步为其司机提供保险，承担事故成本，因此如果发生事故，面临的风险不仅仅是客户满意度下降。这个项目将集中于整个纽约市事故风险的时空预测。拼车公司在生成路线以避开事故风险增加的区域时，可以使用这样的信息作为额外的数据层。</p><p id="cfb4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将使用的数据是由纽约市提供的NYPD机动车碰撞数据。</p><ul class=""><li id="fc1d" class="ms mt it lt b lu mn lx mo ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="https://data.cityofnewyork.us/Public-Safety/NYPD-Motor-Vehicle-Collisions/h9gi-nx95" rel="noopener ugc nofollow" target="_blank">https://data . cityofnewyork . us/Public-Safety/NYPD-机动车-碰撞/h9gi-nx95 </a></li></ul><p id="9242" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据以CSV格式提供，包括事故时间、地理坐标和其他信息，如事故原因、涉及的车辆、死亡人数等。数据将被清理，以确保每个条目包含有效的坐标和时间戳。在这一阶段，我们计划将数据表示为栅格，以确定一天中特定时间事故风险增加的区域。随着时间的推移而可视化的2D矩阵基本上是一个图像识别问题，因此我们计划开发一个卷积LSTM深度学习模型。像这样的方法是有先例的。</p><h1 id="b903" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据争论</h1><p id="fd5a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们决定将此作为一个分类问题，提出这样一个问题:在这一天的这个时候，这个地区发生事故的风险是否会增加。数据集包含1.58 MM的事故行，包括日期、时间、经度和纬度，以及涉及的车辆数量、促成因素、受伤人数等。在之前的项目中，我们对纽约市范围内发生的所有事故都很感兴趣，因此不关心是否有缺失的位置值。对于本项目，事故的位置和时间非常重要，因为我们试图建立一个模型来预测在选定的时间和日期发生事故的风险增加的位置。</p><p id="9353" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过上面的链接下载的. csv文件中的数据被导入到熊猫数据框架中。列标题被转换为小写，标题中的空格被替换为下划线以允许链接。创建了一个新的datetime列，并将其设置为索引，以便使用pandas进行索引。loc访问器。数据集中的每条线代表向NYPD报告的事故的时间和位置。最初检查数据时，日期时间数据的行数与经度和纬度的行数不匹配。更仔细的检查揭示了超过185，000个NaN实例，以及超过900个经度和纬度的0值。0经纬度在赤道上，加纳以南。由于事故的日期和位置对这项工作至关重要，所有的NaN值首先被转换为0，并与现有的0值一起删除。这些条目的删除导致了与经度和纬度相同数量的日期时间值。</p><p id="166f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所有事故都是用它们的纬度和经度值绘制的。这显示了多个外围点，很明显不在纽约市范围内。对经度和纬度的限制越来越严格，直到通过目视检查获得了一幅完整的纽约市地图。接下来，我们将经纬度转换为世界大地测量系统，这是将地球曲面投影到平面上的标准，就像地图一样。这一点很重要，因为地面距离测量会更精确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/087069903f411fec1d6cc56fc2b6a562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hd4GQUm1e8KKXUvySLDaQg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">并列显示坐标(绿色)和WGS投影(蓝色)</p></figure><p id="eaf4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这种差异很小，但在地面测量中会造成几十米的误差。美国东海岸位于通用横轴墨卡托坐标系的18T区域。更多信息见<a class="ae ky" href="https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system#Locating_a_position_using_UTM_coordinates" rel="noopener ugc nofollow" target="_blank">此处</a>。应用此功能可将纬度和经度转换为米东距和米北距，这是一种更精确的地面距离测量方法。这些值将用于这项工作的剩余部分。</p><h1 id="ed18" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">电子设计自动化(Electronic Design Automation)</h1><p id="c382" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了感受数据的一致性，我们首先按小时对事故进行分组，并绘制了两周的直方图。这表明在一天中似乎有一个双峰分布，大约在上午8点和下午4点达到峰值，这与正常的高峰时间交通一致。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/681df1df9ebd83c7b75b839ddd48676a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DGJz7vPO6B2CO68T7iHRow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从周一开始，绘制了两周的直方图，显示每小时的事故数量。</p></figure><p id="af3d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">双峰分布对许多人来说是明显的，并且总是在下午发生最多的事故。还有一段时间是凌晨，事故比较少，大概是因为路上车少。然后，我们绘制了整个数据集内每月的事故总数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/68f0c53c0dedab3ecc48f3d490b31de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*k-KvYXIN7xSrOXFmYuo14g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集期间每月的交通事故总数。</p></figure><p id="018a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">事故数量似乎是季节性的，年初时最低，夏季达到高峰，接近年底时逐渐减少。然而，我们不只是对预测事故何时发生感兴趣。我们感兴趣的是事故将在何时何地发生。为此，我们将按小时和地点汇总事故。如前所述，我们将把它放在2D数组中。最初，我们选择将数据离散成64 x 64的网格。这返回了一个更加像素化的数据视图，但是城市的许多特征仍然是可辨别的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d8585aa97608687e757ea76299dd1cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*lVjNHXLAawDNwvuqdrW_Sg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">所有的事故数据都被收集到一个64 x 64的数组中</p></figure><p id="5dbe" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">像这样分组为64×64个箱使得每个箱的宽度大约为712×765米。虽然这不是绕过事故的最实际距离，但它将允许我们展示我们的模型预测交通事故的能力。为了在合理的时间内进行计算，我们决定查看最近6个月的事故数据，该数据集包括2018年12月16日至2019年4月16日的数据。数据被分成70:20:10的训练:测试:验证集。使用训练集和测试集改进的模型，验证集是一个保留集，仅应用于训练模型。</p><h1 id="20c8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模型结构</h1><p id="ee13" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们选择用2D事故阵列来表示这个模型。这两个维度由规则的距离间隔定义，每个箱中的事故数量相加。这给了我们一个纽约市事故的像素化视图，但它适合看看这种方法是否有效。像这样排列的数据可以被认为是一幅图片，或者当考虑多个时间片时，是一部电影的帧。有鉴于此，我们可以把它当作一个“预测电影的下一帧”的问题。这是一个有趣的问题，因为这是一个时间序列问题，也是一个图像问题。时间序列问题通常受益于长短期记忆(LSTM)模型。这些是递归神经网络，具有存储先前信息以应用于当前帧的能力。这对于时间序列问题非常有用，因为在时间序列中可能会出现规则的模式。因为我们的问题也是一个图像问题，我们可以从卷积神经网络(CNN)中受益。CNN使用核函数从图像中提取重要特征。我们使用Keras进行了深度学习，Keras是一种运行在TensorFlow之上的高级API。该包包括convLSTM2D层，它类似于LSTM层，但输入层和变换都是卷积的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/735c5840424232e1fe2d36346354cfbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*g3qV4sW52UPE_sHbVXGaHw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们在这项工作中使用的深度学习convLSTM2D模型的图。</p></figure><p id="59cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第一次卷积输入后，我们应用了4个convLSTM2D层，每层之间都进行了relu激活和归一化。最终的conv2D层使用sigmoid激活和二进制交叉熵损失函数将张量折叠回2D图像，这提供了我们对事故发生概率的64 x 64 2D阵列的预测。</p><p id="cbe9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该层所需的数据的输入形状是具有形状(样本、时间、行、列、通道)的5D张量，在我们的情况下是(样本、时间，64，64，1)。因为我们有一个64×64的矩阵，并且它是一个二进制分类问题，所以1个通道。在这种情况下，时间是时间步长，我们必须选择要使用多少时间点来预测感兴趣的小时。对于这项工作，我们选择使用之前的6个小时来预测7日。我们选择了64个具有5×5内核的过滤器。</p><h1 id="a90e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">特征工程</h1><p id="cbcc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">由于所涉及的因素极其复杂，直接预测交通事故是一项极其困难的工作。几乎不可能包括导致事故的所有因素，包括但不限于司机分心、天气状况、交通状况和道路状况。我们将预测事故风险，而不是直接预测事故。目前，我们的事故数据是按小时在张量中时空排列的。每个网格代表一天中该时间该网格内发生的事故数量。要将事故转换为事故风险，我们需要找到过去x天内每个单元的平均事故数。对于这项工作，我们选择寻找6天内事故的平均数。例如，如果最近6天上午8点的一个格网单元包含以下事故数:3、0、6、2、4、1，则关注日上午8点的事故风险为(3 + 0 + 6 + 2 + 4 + 1)/6 = 16/6 = 2.67事故/小时。这种转换应用于所有数据，因此建模中使用的数据是64 x 64的事故率数组，基于同一时间的事故和过去6天的网格单元。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b15c400b10248ea6d5f78c0c7b5b1178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*y1CEOpmMcErN1Lum_2tl4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一小时内发生的事故。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/9cc15f1668b40b845948624f39be32f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*TDvBEFln-kwHml55dVLwnw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">n的事故率是用前6天每天的同一小时计算的</p></figure><p id="e04d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">同一小时的事故率是使用过去6天中一天的同一小时计算的(右图)。对于构建我们的模型来说，事故率比单独的事故数字提供了更多的信息。最终模型总共包含2，876，737个可训练参数，当在使用GPU的Google Colab笔记本中运行50个时期时，总训练时间约为6小时。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/5f458cab64833954f50a72682bb7fa5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*ilkt03ouuyddn7PXhK1uXA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">该模型似乎在第50个纪元时收敛，因此我们没有将训练时间延长到这之后。</p></figure><h1 id="aa0f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">评估模型</h1><p id="a19f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然Keras提供了许多内置分析，但为了简单起见，我们计算了自己的混淆矩阵。如前所述，该模型输出一个64 x 64的事故风险概率数组。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/57601900ea4fb7897b2c0be98002227f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYSLeW9PQAC3wzbkeqWnCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纽约市事故发生地点概率的基本事实(左)和预测(右)。</p></figure><p id="d953" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为我们想要二进制分类而不是概率，所以我们需要将结果分层为0或1。我们使用predict_classes函数来实现这一点，该函数为我们进行了分层。任何0.5或以上的概率变成1，其余的为0。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/b29fca9d3467221821c413c6f1ef40de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NGc3421bV3XbuZF9NOkqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纽约市交通事故地点的地面实况(左)和预测(右)。</p></figure><p id="93e9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">每个预测和地面实况64 x 64阵列被转换成pandas数据帧，该数据帧允许逐元素的乘法和减法。当两者相乘时，因为它们都是二进制矩阵，所以只有正确识别的值或真正值会保留下来。当我们从预测中减去地面真实矩阵时，真正值变成零(1 -1)，错误预测的事故或假正值变成1(1-0)，错过的预测或假负值变成-1(0-1)。然后，可以通过从矩阵的大小(64 x 64 = 4096)中减去真正值、假正值和假负值的总和来计算真负值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/f7f12f73f44809315de72f6473cf489d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6CAbBULikXuXvZgPqABTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于构建混淆矩阵的基础事实(右上)、预测(右上)、乘积图(左下)和差异图(右下)。</p></figure><p id="3221" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上面是四幅图像，分别显示了事故风险增加的基本事实(左上)、预测矩阵(右上)、显示正确预测像元的乘积矩阵(左下)以及差值图(右下)，如果像元被错误预测，则差值图返回-1(白色)，如果像元未被预测，但存在于基本事实(右)中，则差值图返回+1(黑色)。由于这两个阶层之间的不平衡(负值远远大于正值，这是一件好事！)，报告模型的准确性不是一个合适的指标。相反，我们可以使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Matthews_correlation_coefficient" rel="noopener ugc nofollow" target="_blank">马修相关系数</a>，或phi系数作为二进制预测质量的衡量标准。</p><p id="d34f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">MCC = TP * TN—FP * FN/sqrt((TP+FP)*(TP+FN)*(TN+FP)*(TN+FN))</p><p id="f337" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">其中TP，TN，FP，FN分别=真阳性，真阴性，假阳性，假阴性。应用此公式将返回一个介于1和-1之间的值，其中1表示基本事实和预测完全一致，0表示随机机会，而-1表示模型和基本事实完全不一致。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/4ccfefae2c9e2774ff5f63e5c76f2524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJgPDENWA1Rz8YHNW2u5yA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">跨训练集(左)、测试集(中)和验证集(右)计算的迈克尔相关系数。</p></figure><p id="fd33" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">计算我们三个集合的迈克尔相关系数，我们看到总体上非常好的分数，训练集、测试集和验证集的平均值分别为0.82、0.82和0.83。令人高兴的是，由于这些数据根本不包括在模型训练中，所以坚持组也与训练和测试组得分相似。然而，我们可以从上面图中较低值的重复模式和下面直方图中的负偏斜看出，我们的预测中存在一些异质性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/bd51d32d27fdcfa64bdaa0235c3dbe77.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*zFGjdOKQX6JF6Oi2Bs8Kxg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个机组的MCC值分布。</p></figure><p id="ab88" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">理想情况下，MCC直方图将是平均值周围的正态分布。这表明我们的模型在预测一天中特定时间的事故风险方面较弱。如果它在预测某个区域方面很弱，我们不会在MCC得分的急剧下降中看到这一点。</p><p id="5758" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，我们在混淆数据帧中添加了一个日期时间索引。然后，我们将阈值设置为0.7，并过滤出发生这些情况的小时的索引值。绘制这些值的直方图，我们看到绝大多数值出现在凌晨1点到3点之间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/62ca1d4d3550ff1685a90b1c6d02236f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f1jJDkI6gGtUE0cvUCkrmg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练组(左)、测试组(中)和验证组(右)的MCC值低于0.7的时间分布。</p></figure><p id="1d8f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们为我们的模型重新计算平均MCC值，如果我们排除这些数据点，我们的训练集、测试集和验证集的平均值都略微增加到0.84。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/28680302e9fe310e6a46630d48147a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*lq5uThFpLWe4J_AkJD9F1w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">去除低于0.7的值后，MCC在每组中的分布。</p></figure><h1 id="7f3b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="a72e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们生成了一个深度学习模型，用于预测纽约市的交通事故风险。该模型基于Keras convLSTM2D架构，该架构接受事故率的2D阵列，该阵列是过去6天每小时每个网格单元的平均值。</p><p id="62c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们证明了该模型对未来未知数据的预测性，其迈克尔相关系数为0.84。</p><p id="447f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">用原始事故数而不是事故率来训练同一模型的尝试未能收敛，导致对事故数量和位置的严重高估。</p><p id="fccf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要成为真正有用的模型，每个网格的分辨率最好是城市街区的分辨率。将时间分辨率增加到比1小时更频繁的周期也是令人感兴趣的。这当然会大大增加计算时间。</p><h1 id="80f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">编辑</h1><p id="e01b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你感兴趣，这里有我在这项工作中使用的笔记本的链接。第一个用于<a class="ae ky" href="https://github.com/ghopping/Springboard_Capstone_2/blob/master/GH_Capstone_2_accident.ipynb" rel="noopener ugc nofollow" target="_blank">数据处理</a>，第二个用于<a class="ae ky" href="https://github.com/ghopping/Springboard_Capstone_2/blob/master/convLSTM2D/GH_Capstone_2_convLSTM2D_model.ipynb" rel="noopener ugc nofollow" target="_blank">convlsm 2d</a>模型。</p></div></div>    
</body>
</html>