<html>
<head>
<title>Why and How to Use Dask with Big Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么以及如何将Dask与大数据结合使用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-and-how-to-use-dask-with-big-data-746e34dac7c3?source=collection_archive---------19-----------------------#2020-03-18">https://towardsdatascience.com/why-and-how-to-use-dask-with-big-data-746e34dac7c3?source=collection_archive---------19-----------------------#2020-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce26" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">作为一名数据科学家</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c91926ae8664c7759d18b1dcecd729b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KRRpJtq1bw7YZ3WL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/ia-kDal-Tqs" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="9d94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你一直在关注我的文章，很可能你已经读过我以前的一篇关于<a class="ae ky" rel="noopener" target="_blank" href="/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c"> <strong class="lb iu">为什么以及如何使用拥有大数据的熊猫</strong> </a>的文章。</p><p id="d241" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>是Python中用于数据清理和分析的最佳工具之一。</p><p id="9721" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在清理、转换、操作和分析数据方面，它是真正的游戏规则改变者。</p><p id="c27a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">毫无疑问。</p><p id="fa90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，我甚至创建了自己的<a class="ae ky" rel="noopener" target="_blank" href="/the-simple-yet-practical-data-cleaning-codes-ad27c4ce0a38"> <strong class="lb iu">工具箱，用于使用Pandas进行数据清理</strong> </a>。工具箱不过是用熊猫处理杂乱数据的常用技巧的汇编。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4299" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">我对熊猫又爱又恨</h1><p id="36d9" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">不要误解我。</p><p id="e5c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫很棒。很强大。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/e78b56250df8d626d12a70a6eec885cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VkJfLzCCvsUZOABk.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.kdnuggets.com/2019/11/speed-up-pandas-4x.html" rel="noopener ugc nofollow" target="_blank">堆栈溢出流量到关于所选Python包的问题</a></p></figure><p id="5dd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于数据清理和分析，它仍然是最受欢迎的数据科学工具之一。</p><p id="d344" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在进入数据科学领域一段时间后，我处理的数据量从10MB、10GB、100GB增加到500GB，有时甚至更多。</p><p id="95a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的电脑要么性能低，要么运行时间长，因为大于100GB的数据无法有效使用本地内存。</p><p id="5f5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那时我意识到熊猫最初不是为大规模数据而设计的。</p><p id="d230" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那时候我才意识到<strong class="lb iu">大数据和大数据</strong>的鲜明区别。</p><blockquote class="nb"><p id="3f98" class="nc nd it bd ne nf ng nh ni nj nk lu dk translated">丹·艾瑞里教授的一个著名笑话:</p></blockquote><figure class="nm nn no np nq kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ff06e416557e13e9ffb71c3cf298dfa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/0*ElifAGnflGIcO17i.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.facebook.com/dan.ariely/posts/904383595868" rel="noopener ugc nofollow" target="_blank">(来源)</a></p></figure><p id="0b14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“大”和“大”这两个词本身是“相对的”，以我的拙见，大数据是指小于100GB的数据集。</p><p id="8c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，Pandas处理小数据(通常从100MB到1GB)非常高效，性能很少成为问题。</p><p id="a03b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是当你有比你的本地<a class="ae ky" href="https://en.wikipedia.org/wiki/Random-access_memory" rel="noopener ugc nofollow" target="_blank"> RAM </a>(比如100GB)大得多的数据时，你或者仍然可以使用<a class="ae ky" rel="noopener" target="_blank" href="/why-and-how-to-use-pandas-with-large-data-9594dda2ea4c"> Pandas在一定程度上用一些技巧</a>来处理数据，或者选择一个更好的工具——在这种情况下是<a class="ae ky" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Dask </strong> </a>。</p><p id="921d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，我选择了后者。</p><h1 id="26c4" class="md me it bd mf mg nr mi mj mk ns mm mn jz nt ka mp kc nu kd mr kf nv kg mt mu bi translated">为什么Dask像魔术一样工作？🌟</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/edc57743c86b93fb1e4e2cff577855e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h4ZbcLyB3B3idib-.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank">达斯克</a></p></figure><p id="23cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对我们中的一些人来说，<a class="ae ky" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Dask </strong> </a>可能是你已经熟悉的东西。</p><p id="e738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是对于大多数有抱负的数据科学家或刚开始接触数据科学的人来说，Dask可能听起来有点陌生。</p><p id="892f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这完全没问题。</p><p id="b11d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，直到我面对熊猫的真正局限，我才开始了解达斯克。</p><blockquote class="nx ny nz"><p id="1e2e" class="kz la lv lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">请记住，如果您的数据量足够低，并且可以放入PC的内存空间，Dask不是必需的。</p></blockquote><blockquote class="nb"><p id="d72d" class="nc nd it bd ne nf od oe of og oh lu dk translated">所以现在的问题是…</p><p id="452c" class="nc nd it bd ne nf ng nh ni nj nk lu dk translated"><strong class="ak">Dask是什么，为什么Dask处理大数据比熊猫好？</strong></p></blockquote><h2 id="5e34" class="oi me it bd mf oj ok dn mj ol om dp mn li on oo mp lm op oq mr lq or os mt ot bi translated">⚡ ⚡️ ️Dask以Python并行计算库而闻名</h2><p id="7f66" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">通过它的并行计算特性，<a class="ae ky" href="https://docs.dask.org/en/latest/why.html" rel="noopener ugc nofollow" target="_blank"> Dask </a>允许快速有效的扩展计算。</p><p id="c7f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它提供了一种简单的方法来处理Python中的大数据，这比常规的Pandas工作流程要简单得多。</p><p id="f0e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，Dask允许我们轻松地<strong class="lb iu">扩展到集群</strong>来处理大数据，或者<strong class="lb iu">缩减到单台计算机</strong>来通过利用CPU/GPU的全部能力来处理大数据，所有这些都与Python代码完美集成。</p><p id="eae0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很酷不是吗？</p><p id="b8f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就性能和可伸缩性而言，可以将Dask视为Pandas的扩展。</p><p id="2cbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更酷的是，你可以在Dask dataframe和Pandas Dataframe之间切换，按需进行任何数据转换和操作。</p><h1 id="9ed5" class="md me it bd mf mg nr mi mj mk ns mm mn jz nt ka mp kc nu kd mr kf nv kg mt mu bi translated">大数据怎么用Dask？</h1><p id="e9e7" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">好了，理论到此为止。</p><p id="13f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候把手弄脏了。</p><p id="39d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以<a class="ae ky" href="https://docs.dask.org/en/latest/install.html" rel="noopener ugc nofollow" target="_blank">安装Dask </a>并在你的本地PC上尝试使用你的CPU/GPU。</p><blockquote class="nx ny nz"><p id="1b0d" class="kz la lv lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">B <!-- -->但是我们在这里谈论的是<strong class="lb iu">大数据</strong>，所以让我们做一些<strong class="lb iu">不同的</strong>。</p><p id="160d" class="kz la lv lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">走吧<strong class="lb iu">大</strong>。</p></blockquote><p id="e6cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不要通过缩小到单台计算机来驯服“野兽”，让我们通过<strong class="lb iu">扩展到集群</strong>来发现“野兽”的全部力量，因为<strong class="lb iu">是免费的</strong>。</p><p id="4738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我是认真的。</p><p id="1e30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解设置集群(例如AWS)并将Jupyter notebook连接到云对于一些数据科学家来说可能是一件痛苦的事情，特别是对于云计算的初学者来说，让我们使用<a class="ae ky" href="https://www.saturncloud.io/s/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">土星云</strong> </a>。</p><p id="afbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我最近在尝试的一个新平台。</p><p id="79d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Saturn Cloud是一个托管的数据科学和机器学习平台，可实现DevOps和ML基础设施工程的自动化。</p><p id="98eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">令我惊讶的是，它使用了<strong class="lb iu"> Jupyter和Dask </strong>到<strong class="lb iu"> scale Python来处理大数据</strong>使用了我们熟知和喜爱的库(Numpy、Pandas、Scikit-Learn等)。).它还利用了<a class="ae ky" href="https://www.docker.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Docker </strong> </a> <strong class="lb iu">和</strong><a class="ae ky" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Kubernetes</strong></a>，以便您的数据科学工作可重现、可共享并可投入生产。</p><p id="04eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Dask的用户界面主要有三种类型，即数组、包和数据帧。在下面的代码片段中，我们将主要关注<strong class="lb iu"> Dask Dataframe </strong>，因为作为一名数据科学家，这是我们最常用于数据清理和分析的。</p><h2 id="cd3b" class="oi me it bd mf oj ou dn mj ol ov dp mn li ow oo mp lm ox oq mr lq oy os mt ot bi translated">1.将CSV文件读取到Dask数据帧</h2><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="18be" class="oi me it pa b gy pe pf l pg ph">import dask.dataframe as dd</span><span id="a24c" class="oi me it pa b gy pi pf l pg ph">df = dd.read_csv('<a class="ae ky" href="https://e-commerce-data.s3.amazonaws.com/E-commerce+Data+(1).csv'," rel="noopener ugc nofollow" target="_blank">https://e-commerce-data.s3.amazonaws.com/E-commerce+Data+(1).csv',</a> encoding = 'ISO-8859-1', blocksize=32e6)</span></pre><p id="6c7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Dask dataframe在正常文件读取和数据转换方面与Pandas dataframe没有什么不同，这使得它对数据科学家非常有吸引力，稍后您将会看到这一点。</p><p id="f0ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们只是读取了存储在<a class="ae ky" href="https://aws.amazon.com/s3/" rel="noopener ugc nofollow" target="_blank"> S3 </a>中的一个CSV文件。因为我们只想测试Dask数据帧，所以文件大小很小，只有541909行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/f15dc3477ae23e76ce7be2f366bcdeb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qSBydmkhFAJ_cj9GD3Z28w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">读取CSV文件后的Dask数据帧</p></figure><p id="a0a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>我们也可以<a class="ae ky" href="http://docs.saturncloud.io/en/articles/3760116-read-public-data-from-s3-in-saturn" rel="noopener ugc nofollow" target="_blank">在一行代码中读取多个文件</a>到Dask数据帧，而不管文件大小。</p><p id="d31a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们从CSV加载数据时，Dask将创建一个数据帧，该数据帧是按行分区的，即行按索引值分组。这就是Dask能够按需将数据加载到内存中并超快速处理数据的方式— <strong class="lb iu">它通过分区</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/794668453e048892b049d02aa3b086f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*IZmDXucl3oksi6oF.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.saturncloud.io/s/practical-guide-to-dask/" rel="noopener ugc nofollow" target="_blank">由Dask完成的分区</a></p></figure><p id="1f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们看到Dask数据帧有2个分区(这是因为在读取CSV时指定了<code class="fe pl pm pn pa b">blocksize</code>),有8个任务。</p><p id="851e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">【分区】</strong>这里简单地指在Dask数据帧内分割的熊猫数据帧的数量。</p><p id="229c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们拥有的分区越多，每次计算需要的任务就越多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/828544c3d9838075053b522568225c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*OCPrJHdAbn3cAYNl6BcLSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Dask数据帧结构</p></figure><h2 id="e5c0" class="oi me it bd mf oj ou dn mj ol ov dp mn li ow oo mp lm ox oq mr lq oy os mt ot bi translated">2.使用<code class="fe pl pm pn pa b">compute()</code>执行操作</h2><p id="300f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">现在我们已经将CSV文件读入Dask dataframe。</p><p id="efda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的是要记住，虽然Dask数据帧与Pandas数据帧非常相似，但确实存在一些差异。</p><p id="f0a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我注意到的主要区别是Dask dataframe中的这个<code class="fe pl pm pn pa b">compute</code>方法。</p><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="002a" class="oi me it pa b gy pe pf l pg ph">df.UnitPrice.mean().compute()</span></pre><p id="808d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数Dask用户界面是<strong class="lb iu"><em class="lv"/></strong>懒惰的，这意味着<strong class="lb iu">它们不会评估，直到你使用<code class="fe pl pm pn pa b">compute</code>方法明确地要求一个结果</strong>。</p><p id="9edf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们如何通过在<code class="fe pl pm pn pa b">mean</code>方法后添加<code class="fe pl pm pn pa b">compute</code>方法来计算<code class="fe pl pm pn pa b">UnitPrice</code>的平均值。</p><h2 id="734f" class="oi me it bd mf oj ou dn mj ol ov dp mn li ow oo mp lm ox oq mr lq oy os mt ot bi translated">3.检查每列缺失值的数量</h2><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="e0b0" class="oi me it pa b gy pe pf l pg ph">df.isnull().sum().compute()</span></pre><p id="8855" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，如果我们想检查每一列的缺失值的数量，我们需要添加<code class="fe pl pm pn pa b">compute</code>方法。</p><h2 id="a1b8" class="oi me it bd mf oj ou dn mj ol ov dp mn li ow oo mp lm ox oq mr lq oy os mt ot bi translated">4.根据条件筛选行</h2><pre class="kj kk kl km gt oz pa pb pc aw pd bi"><span id="e423" class="oi me it pa b gy pe pf l pg ph">df[df.quantity &lt; 10].compute()</span></pre><p id="4da9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在数据清理或探索性数据分析(EDA)过程中，我们经常需要根据某些条件过滤行，以了解数据背后的“故事”。</p><p id="b7b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需添加<code class="fe pl pm pn pa b">compute</code>方法，就可以做和在熊猫身上做的完全一样的操作。</p><p id="77e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后嘣！我们得到了结果！</p><h2 id="08b0" class="oi me it bd mf oj ou dn mj ol ov dp mn li ow oo mp lm ox oq mr lq oy os mt ot bi translated">🚀使用Python创建Dask集群并大规模运行Jupyter的演示</h2><p id="bcaa" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">既然我们已经大体了解了如何使用Dask。</p><p id="cdbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候看看如何<a class="ae ky" href="http://docs.saturncloud.io/en/articles/3652101-spin-up-dask-on-saturn" rel="noopener ugc nofollow" target="_blank">在土星云上创建Dask集群</a>并在Jupyter中大规模运行Python代码了。</p><p id="8555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我录制了一个简短的视频，向您展示如何在几分钟内在Dask集群中进行设置和运行Python代码。尽情享受吧！😊</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pp pq l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="http://bit.ly/saturn-cloud-demo" rel="noopener ugc nofollow" target="_blank">如何创建Dask集群并在土星云上运行Jupyter笔记本</a></p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="e0b1" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">最后的想法</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/ab16a9dd189b0e14993ea7562054b99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/0*fH-Ov5qekGOaZa9T"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/man-in-white-button-up-shirt-3155367/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="e65d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。</p><p id="6985" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从功能上来说，熊猫还是赢了。</p><p id="fd0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在性能和可扩展性方面，Dask领先于Pandas。</p><p id="70ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我看来，如果您的数据大于几GB(相当于您的RAM)，出于性能和可伸缩性的目的，请使用Dask。</p><p id="8ba5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在几分钟内创建一个Dask集群，并大规模运行你的Python代码，我强烈推荐你在这里免费获得土星云的<a class="ae ky" href="http://bit.ly/saturn-cloud-community-edition" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">社区版</strong> </a>。</p><p id="7779" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一如既往，如果您有任何问题或意见，请随时在下面留下您的反馈，或者您可以随时通过<a class="ae ky" href="https://www.admondlee.com/" rel="noopener ugc nofollow" target="_blank">我的网站</a>或<a class="ae ky" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。在那之前，下一篇文章再见！😄</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ef42" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">关于作者</h1><p id="6af7" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated"><a class="ae ky" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Admond Lee </strong> </a>目前是东南亚排名第一的商业银行API平台<a class="ae ky" href="https://www.trystaq.com" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Staq</strong></a><strong class="lb iu">—</strong>的联合创始人/首席技术官。</p><p id="f20d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想要获得免费的每周数据科学和创业见解吗？</p><p id="f2b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://bit.ly/3pGF8jv" rel="noopener ugc nofollow" target="_blank"/></p><p id="c060" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在<a class="ae ky" href="https://www.linkedin.com/in/admond1994/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://medium.com/@admond1994" rel="noopener"> Medium </a>、<a class="ae ky" href="https://twitter.com/admond1994" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae ky" href="https://www.facebook.com/admond1994" rel="noopener ugc nofollow" target="_blank">脸书</a>上和他联系。</p><div class="ps pt gp gr pu pv"><a href="https://www.admondlee.com/" rel="noopener  ugc nofollow" target="_blank"><div class="pw ab fo"><div class="px ab py cl cj pz"><h2 class="bd iu gy z fp qa fr fs qb fu fw is bi translated">阿德蒙德·李</h2><div class="qc l"><h3 class="bd b gy z fp qa fr fs qb fu fw dk translated">让每个人都能接触到数据科学。Admond正在通过先进的社交分析和机器学习，利用可操作的见解帮助公司和数字营销机构实现营销投资回报。</h3></div><div class="qd l"><p class="bd b dl z fp qa fr fs qb fu fw dk translated">www.admondlee.com</p></div></div><div class="qe l"><div class="qf l qg qh qi qe qj ks pv"/></div></div></a></div></div></div>    
</body>
</html>