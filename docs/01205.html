<html>
<head>
<title>SVM: An optimization problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SVM:一个最优化问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/svm-an-optimization-problem-242cbb8d96a8?source=collection_archive---------13-----------------------#2020-02-03">https://towardsdatascience.com/svm-an-optimization-problem-242cbb8d96a8?source=collection_archive---------13-----------------------#2020-02-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e91b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用拉格朗日画线</h2></div><h1 id="da11" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">1.概观</h1><p id="1ebf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这个博客将探索支持向量机的机制。首先，让我们对这篇文章<a class="ae lw" rel="noopener" target="_blank" href="/support-vector-machines-22a51baba064">进行一个100英里每小时的概述(强烈建议你在阅读这篇文章之前浏览一下)。基本上，我们给定了n维空间中的一些点，其中每个点都有一个二进制标签，并希望用一个超平面来分隔它们。用x表示这个空间中的任何一点，那么，任何超平面都可以表示为:w^T x +b=0。让我们列出一些术语。</a></p><ol class=""><li id="eda0" class="lx ly it lc b ld lz lg ma lj mb ln mc lr md lv me mf mg mh bi translated">x^i:上面提到的d维空间中的第I个点。所以，它是一个长度为d的向量，它的所有元素都是实数(x ∈ R^d).</li><li id="7f4a" class="lx ly it lc b ld mi lg mj lj mk ln ml lr mm lv me mf mg mh bi translated">t^i:这第I点的二进制标号。它可以是1或0。</li><li id="f1c7" class="lx ly it lc b ld mi lg mj lj mk ln ml lr mm lv me mf mg mh bi translated">w:对于将空间分成两个区域的超平面，x向量的系数。</li><li id="d2cd" class="lx ly it lc b ld mi lg mj lj mk ln ml lr mm lv me mf mg mh bi translated">b:对于把空间分成两个区域的超平面，常数项。</li></ol><p id="9911" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">在<a class="ae lw" rel="noopener" target="_blank" href="/support-vector-machines-22a51baba064">之前的博客</a>中，我们导出了优化问题，如果解决了这个问题，我们就可以得到描述分离平面的w和b(我们将从那里继续我们的方程编号，γ是一个虚拟变量),它最大化了“余量”或离平面最近点的距离。请注意，每个数据点有一个不等式约束。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/783d7da13e3a463c61c057969acae40f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CnmDS0RMBeeJPoDC.png"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(4): SVM最优化问题</p></figure><p id="ebd4" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">然后，我们做了一些忍术来消除γ，并简化为以下优化问题:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ng"><img src="../Images/e2c732b16e603d14d2784159099ba17a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_SZLDtsdSphCxyHU.png"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(7):简化的SVM优化问题</p></figure><p id="a6a3" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">在这篇博客中，让我们来看看<a class="ae lw" rel="noopener" target="_blank" href="/lagrange-multipliers-with-pictures-and-code-ace8018dac5e">拉格朗日乘子</a>的方法对于解决像这样的约束优化问题可以提供什么样的支持向量机的见解。</p><h1 id="dbd6" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">2.使用拉格朗日乘数的解决方案</h1><p id="edb4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本系列的<a class="ae lw" rel="noopener" target="_blank" href="/support-vector-machines-22a51baba064">前一篇博客中，我们获得了两个约束优化问题(上面的等式(4)和(7 )),它们可用于获得最大化余量的平面。有一种求解带约束优化问题的通用方法(拉格朗日乘子法)。为了保持重点，我们将在这里陈述配方，并使用它来挖掘关于SVM问题的见解。至于这个方法为什么有效，请阅读这篇博客</a><a class="ae lw" rel="noopener" target="_blank" href="/lagrange-multipliers-with-pictures-and-code-ace8018dac5e">其中详细介绍了拉格朗日乘数。如果我们有一个一般性的优化问题，</a></p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d3ce2765f731c806ac4adc730fab2314.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*K18Q0n8IiDTli3hlK-wQig.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(8)一般约束优化问题。</p></figure><p id="d0ae" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">步骤1:定义拉格朗日函数:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/f706660877bb7b19124275cb231f04d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*g4VznTIf8ywbwalYDhuRpA.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">方程式(9)拉格朗日函数</p></figure><p id="dc76" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">其中α_i和β_i是称为“拉格朗日乘数”的附加变量。不等式α_i对应的乘数必须≥0，而等式β_i对应的乘数可以是任意实数。这里再次提供了一些直观的原因。那么，为了使w成为最佳值，必须满足的条件(称为KKT条件)是:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nj"><img src="../Images/575246482c2b3065f70b28a0cc1b1d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NToavQ5re69XdwAkB4To3w.png"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(10):找到约束最优化问题的解的KKT条件。</p></figure><p id="3911" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">方程10-e称为互补条件，它保证如果一个不等式约束不是“紧的”(g_i(w)&gt;0且不等于0)，那么对应于该约束的拉格朗日乘数必须等于零。事实证明，这是因为拉格朗日乘数可以被解释为指定不等式约束在最优点上被“推动”的力度。如果约束甚至不是严格的(有效的)，我们在解中根本没有推动它，因此，相应的拉格朗日乘数，α_i=0。等式10b和10c非常简单，因为它们简单地陈述了原始优化问题的约束应该在最优点处得到满足(几乎是一个重言式)。</p><h2 id="52d1" class="nk kj it bd kk nl nm dn ko nn no dp ks lj np nq ku ln nr ns kw lr nt nu ky nv bi translated">2.1.关于SVM的观察</h2><p id="94ee" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们回到支持向量机。在等式(4)和(7)中，我们根据每个点到分隔线的垂直距离(边距)为每个点指定了一个不等式约束。与线(边距)距离最小的点将是约束条件相等的点。如果有多个共享该最小距离的点，则它们的约束将根据等式(4)或(7)变成等式。这样的点被称为“支持向量”，因为它们“支持”它们之间的线(正如我们将看到的)。从问题的几何结构中，很容易看出必须有至少两个支持向量(与直线共享最小距离的点，因此具有“紧”约束)，一个具有正标签，一个具有负标签。假设不是这种情况，并且只有一个具有最小距离d的点。在不失一般性的情况下，我们可以假设该点具有正标签。然后，在距离为d+δd的线的另一侧有另一个带有负标签的点。可以沿着w向量向负点移动δd/2的距离，并增加相同距离的最小边距(现在，最近的正点和最近的负点都成为支持向量)。这意味着我们开始的另一行是一个假先知；不可能是真正的最佳利润线，因为我们很容易提高利润。</p><p id="2b92" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">但是，这完全依赖于问题的几何解释。如果我们只得到最优化问题(4)或(7)(我们假设我们知道如何从一个问题得到另一个问题)，我们会得到同样的结论吗？对于方程(4)中的问题，方程(9)中定义的拉格朗日量变成:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nw"><img src="../Images/60377600f59212917bb2623116f55bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUyaryxtgBss-xCXo5EWRA.png"/></div></div></figure><p id="98fd" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">对γ求导，我们得到，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/5425177cb44014f8174e8898df5b13b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*q8B8KtIvLBSHSH6uvqbGOw.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(11)</p></figure><p id="e757" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">对b求导，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/cad521ad423d30d4997e9ef1bcd21992.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*w8MrfW3yxvLYDma9h6CVRw.png"/></div></figure><p id="a5bc" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">如果我们认为{I}是正标签的集合而{J}是负标签的集合，我们可以重写上面的等式:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/f3dbf47fed1e0718c2abcf4834b6b096.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*viF7H6ajQE9sHo_xcan5PQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(12)</p></figure><p id="9039" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">等式(11)和(12)以及所有α都≥0的事实意味着在每个正类和负类中至少有一个非零α_i。并且由于α_i表示对应于第I个点的约束有多“紧”(0表示一点也不紧)，<em class="oa">这意味着两个类中的每一个都必须有至少两个点，约束是活动的，因此拥有最小余量(跨越点)</em>。</p><h1 id="0b75" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">2.2“支持向量”到底是什么意思？</h1><p id="a3d2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在上一节中，我们用公式表示了方程(4)中给出的系统的拉格朗日函数，并对γ求导。现在，让我们为等式(10)给出的公式形成拉格朗日量，因为这要简单得多:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/fbd65390b9d767b817398b8f9884ff8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*KKIMWulCJ5HJtAumN8RkRw.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(13):等式(7)的拉格朗日量</p></figure><p id="897e" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">根据10-a对w求导，并设为零，我们得到:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/faf0af0d074ddcc7cc95d4d10b371f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*f1eIEQRNWCG_GnXNc3j_wg.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(14):最优w。</p></figure><p id="6c75" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">与之前一样，每个点都有一个与之对应的不等式约束，拉格朗日乘数α_i也是如此。此外，除了与分隔线具有最小可能距离的点(等式(4)或(7)中的约束是有效的)，所有其他点的α_i都等于零(因为约束是无效的)。</p><p id="e006" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">从方程(14)中，我们看到这些点(α_ I = 0)对拉格朗日量没有贡献，因此对最佳线的w也没有贡献。同样容易看出，它们也不影响最优线的b。因此，在定义直线时，只有最接近直线的点(因此它们的不等式约束变成了等式)才是重要的。这就是为什么这些点被称为“支持向量”。通常只有少数几个，但它们支持它们之间的分离面。</p><h1 id="b0bb" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">3.最简单分类问题</h1><p id="500d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这一节中，我们将考虑一个非常简单的分类问题，它能够抓住优化行为的本质。所以我们可以把正在发生的事情可视化，我们把特征空间做成二维的。让我们在上面放两个点，并像这样标记它们(绿色表示正标签，红色表示负标签):</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/a7121accd4e64b05b13254738de1101a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*3hWr5y72zVC2uuT4RVWsaA.png"/></div></figure><p id="c2ec" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">很明显，分隔这两点的最佳位置是由x+y=0给出的紫色线。</p><p id="b484" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">现在让我们看看我们到目前为止学习的数学是如何告诉我们关于这个问题我们已经知道了什么。为什么要这么做？以便明天它能告诉我们一些我们不知道的事情。</p><p id="7458" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">由于我们有t⁰=1和t =-1，我们从方程(12)得到，α_0 = α_1 = α。将此代入方程(14)(这是一个向量方程)，我们得到w_0=w_1=2 α。因此，我们立即得到，对于x和y，该线必须具有相等的系数。我们还知道，因为只有两个点，所以对应于它们的拉格朗日乘数必须&gt; 0，并且对应于它们的不等式约束必须变得“紧密”(等式；见第2.1节最后一行)。这意味着，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0a0c84d917a8314a7f0cac089f39063f.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*itxWxvdtIx8yyWD71hFZOA.png"/></div></figure><p id="6832" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">减去这两个方程，我们得到b=0。所以，分离平面，在这种情况下，是直线:x+y=0，正如所料。</p><h1 id="e795" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">3.1.添加第三个浮点</h1><p id="e137" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了使问题更有趣，并涵盖一系列可能的SVM行为，让我们添加第三个浮点。因为(1，1)和(-1，-1)位于y-x=0的直线上，所以让第三点也位于这条直线上。让我们把它放在x=y=u，同样，让我们给这个点一个正的标签(就像绿色的(1，1)点一样)。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/b4815cb48d5a2db821489b0bffd05517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*zgMRG6ip5vdWshTcyvtyHQ.gif"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">只要u&gt;1，平面通过原点。但是当u &lt;1, the (u,u) point becomes the support vector and drives the separating purple plane downward.</p></figure><p id="cd7d" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">Now, the intuition about support vectors tells us:</p><ol class=""><li id="1339" class="lx ly it lc b ld lz lg ma lj mb ln mc lr md lv me mf mg mh bi translated">If u&gt; 1时，最佳SVM线不会改变，因为支持向量仍然是(1，1)和(-1，-1)。</li><li id="59d8" class="lx ly it lc b ld mi lg mj lj mk ln ml lr mm lv me mf mg mh bi translated">如果u∈ (-1，1)，SVM线随着u移动，因为支持向量现在从点(1，1)切换到(u，u)。</li><li id="9331" class="lx ly it lc b ld mi lg mj lj mk ln ml lr mm lv me mf mg mh bi translated">如果u </li></ol><p id="b08b" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">Let’s see how the Lagrange multipliers can help us reach this same conclusion. From equation (14),</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/d435fcf8046dad2422f4e99548ae742b.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*KuHFYBkAYP-UuwYDGpOMtg.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">Eq (15)</p></figure><p id="1530" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">Also, taking derivative of equation (13) with respect to b and setting to zero we get:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/a544e2fd19483161bc7fd1054b4d2bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*nM9MRtxDx9-Hqh--AaSqOQ.png"/></div></figure><p id="6494" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">And for our problem, this translates to: α_0-α_1+α_2=0 (because the first and third points — (1,1) and (u,u) belong to the positive class and the second point — (-1,-1) belongs to the negative class).</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4df2f4481e684a121da41a178a76dd9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*LIdyt2Y93u2dCYfm9hWRWQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">Eq (16)</p></figure><p id="ff5a" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">Next, equations 10-b imply simply that the inequalities should be satisfied. For our problem, we get three inequalities (one per data point). All specified by (per equation (7)):</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ea239f0a2463f78ea3a02d0837333182.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*-plggP37TblaUFFKmOLTqg.png"/></div></figure><p id="f3ef" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">for our three data points we get:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f1fb62cfb337bf37e654ed958a2eecb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*86Op1iv8Yxzxqm7IbPbvpA.png"/></div></figure><p id="fbdf" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">But from equation (15) we know that w_0=w_1. Further, the second point is the only one in the negative class. So, the inequality corresponding to it must be an equality. Using this and introducing new slack variables, k_0 and k_2 to convert the above inequalities into equalities (the squares ensure the three inequalities above are still ≥0):</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ok"><img src="../Images/13403aa4e77e814b32fb1a7215a12b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*sSWoZkuYQTqlU6OAdthdow.png"/></div></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">Eq (17)</p></figure><p id="79b6" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">And finally, we have the complementarity conditions:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/c133cfea6d2a0e353a31f9c15cab4348.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*aguv_zg8A35TGgfvSZdQ_g.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">Eq (18)</p></figure><p id="1e15" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">From equation (17) we get: b=2w-1. Further, since we require α_0&gt; 0，α_2&gt;0，我们用α_0，α_2来代替。从等式(15)和(16)我们得到:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/426d6e966fc88d83f108b3d6d9682303.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*OXnUXMWkjWQQoUh9ns1KKQ.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(19)</p></figure><p id="6f8a" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">将b=2w-1代入等式(17)的第一个，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/a939ca423da477c228e3698cd7e66135.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*Mievi3_V5m3gAgB4Qa75tg.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(20)</p></figure><p id="64c7" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">并进入等式(17)的第三个，</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/006b7caa31c0a2edd578d63e448cfba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*uYW8LyV36as0CJK3xVUnvA.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(21)</p></figure><p id="2107" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">现在，方程(18)到(21)很难手工求解。幸运的是，有一个用于求解多项式方程组的通用框架，称为“Buchberger算法”,上面描述的方程基本上是一个多项式方程组。我在这里写了一篇关于Buchberger求解多项式方程组的算法的详细博客。它可以用来根据我们感兴趣的变量简化方程组(简化的形式称为“Groebner基”)。该算法在python库sympy中实现。让我们看看它是如何工作的。</p><figure class="mr ms mt mu gt mv"><div class="bz fp l di"><div class="op oq l"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">等式(18)至(21)及其Groebner基，其中k2是第一个要消除的变量，k0是第二个。由于只有五个方程，但有六个变量，所以Groebner基的最后一个方程将只用k0和k2来表示。</p></figure><p id="94ba" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">上面代码中变量的顺序很重要，因为它告诉sympy它们的“重要性”。它试图让Groebner基末尾的方程，用末尾的变量来表示。在这种情况下，我们有六个变量，但只有五个方程。并且由于k_0和k_2是最后两个变量，所以基的最后一个方程将仅用它们来表示(如果有六个方程，则最后一个方程将仅用k2来表示)。我们得到:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/b836b5dd51cf993e0a068bd9388639e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*4XXMJSJ3y05X4Wgq5MIYPQ.png"/></div></figure><p id="7d05" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这意味着k0k 2 = 0，因此，它们中至少有一个是零。然而，我们知道它们不可能都为零(一般来说)，因为这意味着对应于(1，1)和(u，u)的约束都是紧的；这意味着它们都在离直线的最小距离处，这只有在u=1时才有可能。一个或另一个必须为0的事实是有意义的，因为(1，1)或(u，u)中恰好有一个必须最接近分隔线，使得相应的k =0。</p><p id="574b" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">做一个类似的练习，但是用u和k_0表示的最后一个等式，我们得到:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/611c06e8fdfb67c1c989ad5e39b7273a.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*AMdP9ytH7ESkyPljFAW7LA.png"/></div></figure><p id="5980" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这意味着要么0 = 0，要么</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a8c6406410f8f65bf95daceb0b822963.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*69CJRy79x13XxQ2W3OeqFQ.png"/></div></figure><p id="d1ed" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">类似地，根据k_2和u提取方程，我们得到:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ou"><img src="../Images/96da420f3ea3f30651c3516494ddeb4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*mi-qX4AM5BkIcFc2h2Q1Vg.png"/></div></div></figure><p id="2aa4" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这又意味着要么k_2=0，要么</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/1ca9b980d59ec4ebb4d72c97e4a71b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*0Dwa-8R85p4r3nG41dKu_A.png"/></div></figure><p id="e940" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这意味着，如果u&gt;1，那么我们必须有0 = 0，因为另一种可能性会使它成为虚数。因此，k_2不可能是0，而会变成(u-1)^.5.换句话说，对应于(1，1)的方程将变成等式，对应于(u，u)的方程将是“lose”(严格不等式)。这是有意义的，因为如果u&gt;1，(1，1)将是更接近超平面的点。</p><p id="b0b6" class="pw-post-body-paragraph la lb it lc b ld lz ju lf lg ma jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">类似地，如果u&lt;1，k_2将被迫变为0，因此，k_0将被迫取正值。我们看到了两点:(u，u)和(1，1)在u从小于1转变到大于1时切换作为支持向量的角色。另一方面，如果u&lt;0，则不可能找到均为非零实数的k_0和k_2，因此方程没有实数解。</p></div></div>    
</body>
</html>