<html>
<head>
<title>How to Install Tensorflow 2.1 on Ubuntu 18.04 LTS with GPU support: Nvidia Drivers, CUDA 10 and cuDNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在有 GPU 支持的 Ubuntu 18.04 LTS 上安装 tensor flow 2.1:Nvidia 驱动，CUDA 10，cuDNN</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/installing-nvidia-drivers-cuda-10-cudnn-for-tensorflow-2-1-on-ubuntu-18-04-lts-f1db8bff9ea?source=collection_archive---------6-----------------------#2020-05-09">https://towardsdatascience.com/installing-nvidia-drivers-cuda-10-cudnn-for-tensorflow-2-1-on-ubuntu-18-04-lts-f1db8bff9ea?source=collection_archive---------6-----------------------#2020-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac82" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为深度学习系列提升您的 PC——第 4 部分</h2></div><h1 id="2db9" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="7b39" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在本系列的第 1 部分中，我讨论了如何升级你的电脑硬件来整合 CUDA Toolkit 兼容图形处理卡，我安装了一个 Nvidia GTX 1060 6GB。<a class="ae lw" rel="noopener" target="_blank" href="/installing-tensorflow-with-cuda-cudnn-and-gpu-support-on-windows-10-60693e46e781">本系列的第 2 部分</a>讲述了在 Windows 10 上安装 CUDA、cuDNN 和 Tensorflow。在第 3 部分中，我从我的电脑上删除了 Windows 10，并从一张可启动的 DVD 上安装了 Ubuntu 18.04 LTS。</p><p id="9d62" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在本系列的第 4 部分，我正在为 Nvidia GPU 安装驱动程序，这些驱动程序与我希望安装在 Ubuntu 18.04 上的 CUDA Toolkit、cuDNN 和 Tensorflow 版本兼容，即 tensor flow 2.1——这需要 CUDA 10.1 或更高版本。在这样做的时候，在我的情况下，这也涉及到处理我的<em class="mc">当前</em>安装的 Nvidia 驱动程序、CUDA、cuDNN 和 Tensorflow(细节在步骤 1 中列出)。</p><h1 id="f1b5" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 1:检查要安装的驱动程序和软件版本是否与 Tensorflow 2.1 兼容</h1><p id="eed8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您选择的 Tensorflow 版本将决定 CUDA、cuDNN、编译器、工具链的兼容版本以及要安装的 Nvidia 驱动程序版本。因此，在安装 Nvidia 驱动程序、CUDA、cuDNN 以及 Tensorflow 2.1 之前，我会"<em class="mc">先想好最终目标</em>"，首先检查与我的 Tensorflow 目标版本兼容的正确软件版本。</p><p id="28e7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">根据<a class="ae lw" href="https://www.tensorflow.org/install/gpu#install_cuda_with_apt" rel="noopener ugc nofollow" target="_blank"> Tensorflow 网站</a>和<a class="ae lw" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#pre-installation-actions" rel="noopener ugc nofollow" target="_blank"> CUDA 安装指南</a>:</p><ul class=""><li id="b598" class="md me it lc b ld lx lg ly lj mf ln mg lr mh lv mi mj mk ml bi translated">NVIDIA GPU 驱动程序— CUDA 10.1 要求 418.x 或更高版本。</li><li id="b555" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae lw" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank"> CUDA 工具包</a> — TensorFlow 支持 CUDA 10.1 (TensorFlow &gt; = 2.1.0)。Tensorflow 1.13 及以上需要 CUDA 10。我希望能够在 1.13-2.1 之间安装各种版本的 Tensorflow(带 GPU 支持)，因此 CUDA 10.1 是绝对需要的</li><li id="f035" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae lw" href="http://docs.nvidia.com/cuda/cupti/" rel="noopener ugc nofollow" target="_blank"> CUPTI </a>(附带 CUDA 工具包)</li><li id="6ae5" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">g++编译器和工具链</li><li id="fed0" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><a class="ae lw" href="https://developer.nvidia.com/cudnn" rel="noopener ugc nofollow" target="_blank"> cuDNN SDK </a> ( &gt; = 7.6)</li><li id="efcf" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated"><em class="mc">(可选)</em> <a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html" rel="noopener ugc nofollow" target="_blank"> TensorRT 6.0 </a>提高某些模型上推理的延迟和吞吐量。</li></ul><p id="6ba9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当我之前在这台 Ubuntu 18.04 机器上安装 Tensorflow 时，只有 Tensorflow 1.12/CUDA 9 可用，CUDA 10 还不兼容 Tensorflow。因此，在完成下面的新步骤之前，我已经在该计算机上安装了以下内容:</p><ul class=""><li id="2e99" class="md me it lc b ld lx lg ly lj mf ln mg lr mh lv mi mj mk ml bi translated">Tensorflow 版本 1.12</li><li id="1f69" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">CUDA 工具包版本 9.0</li><li id="6afa" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">7.2 版 cuDNN，Tensorflow 版需要</li><li id="adca" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">gcc 和 g++编译器和工具链</li><li id="849a" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">NVIDIA GPU 驱动程序 390.132 (CUDA 9.0 需要 384.x 或更高版本)</li></ul><h1 id="678d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 2:CUDA 安装前:检查现有安装</h1><p id="e94c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在开始 CUDA 下载和安装之前，请在 Nvidia CUDA 网站上进行建议的检查<a class="ae lw" href="https://docs.nvidia.com/cuda/cuda-installation-guide-linux/index.html#ubuntu-installation" rel="noopener ugc nofollow" target="_blank">此处</a>:</p><ul class=""><li id="eb56" class="md me it lc b ld lx lg ly lj mf ln mg lr mh lv mi mj mk ml bi translated">验证系统是否具有支持 CUDA 的 GPU</li><li id="57cf" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">验证系统运行的是支持的 Linux 版本。</li><li id="03af" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">验证系统是否安装了 gcc。</li><li id="96fc" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">验证系统是否安装了正确的内核头文件和开发包。</li></ul><p id="b9d7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">步骤 2.1:检查系统是否有支持 CUDA 的 GPU </strong></p><p id="fb2b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在 Ubuntu 终端中运行以下命令来检查您的图形卡(GPU):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="fa4e" class="na kj it mw b gy nb nc l nd ne">lspci | grep -i nvidia</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/0083aac1b2f302f1425b2b0e09fffe5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQWIibKN3LKY1M5yj9wC0g.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.1:检查安装的图形卡(GPU)版本</p></figure><p id="71ce" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">如果您的显卡来自 NVIDIA，并且在此处<a class="ae lw" href="http://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank">列出</a>，则您的 GPU 支持 CUDA。</p><p id="69b2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">步骤 2.2:检查您即将安装的 CUDA 是否支持您的 linux 版本</strong></p><p id="a294" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">使用以下命令检查您的系统版本:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="1390" class="na kj it mw b gy nb nc l nd ne">uname -m &amp;&amp; cat /etc/*release</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/a71f0b1648baac8197285b310d5f8a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lv1UALKj8ec9AXZC0L4toQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.2:使用终端检查系统版本</p></figure><p id="18f5" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当您获得与您系统版本相关的结果时，您可以查看 CUDA 在线文档以确保该版本受支持。</p><p id="dd68" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">步骤 2.3:检查 gcc 安装</strong></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2420" class="na kj it mw b gy nb nc l nd ne">gcc --version</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/46fdd987906be38fe9f4bd674dd49c76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BTXj2EeDs-tq5PepnzihEQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.3:检查 gcc 安装(CUDA 所需)</p></figure><p id="dd47" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">步骤 2.4:检查 Ubuntu 系统是否有正确的内核头文件，开发包是否已安装</strong></p><p id="8fb0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">您的系统正在运行的内核版本可以通过运行以下命令找到:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="dacb" class="na kj it mw b gy nb nc l nd ne">uname -r</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/1300a9057ed988bdc28e98f192092afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p15IpD2ADh3RGB-46hAqkQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.4:检查系统的内核头</p></figure><p id="caab" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">对于 Ubuntu，当前运行的内核的内核头文件和开发包可以安装在:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="60ad" class="na kj it mw b gy nb nc l nd ne"># my current kernel header is 4.15.0-99-generic, yours may differ<br/>uname_r =”4.15.0-99-generic” <br/>sudo apt-get install linux-headers-${uname_r}</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/932e68776038e5f670efb91d67b6f027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gccv0Rf5JQIvef7AfQ-Ocw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.5:为当前运行的内核安装内核头文件和开发包</p></figure><p id="15d8" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">步骤 2.5:检查任何当前的 Nvidia 驱动程序</strong></p><p id="e36b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">您还可以通过运行“nvidia-smi”命令来检查您当前使用的 Nvidia GPU 驱动程序(如果有),您可以看到，最初，我使用的是 Nvidia 驱动程序 390.132:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/fe7292c960db33828917afc9fd0e5e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6am3721iBrAxZCRQli4eA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 2.6:开始升级前运行命令检查当前 GPU 驱动程序</p></figure><h1 id="4c9a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 3:下载 NVIDIA 软件包仓库</h1><p id="8ade" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">接下来，下载 Nvidia 软件包库。这些命令基于来自<a class="ae lw" href="https://www.tensorflow.org/install/gpu#install_cuda_with_apt" rel="noopener ugc nofollow" target="_blank"> Tensorflow 网站</a>的添加 Nvidia 包存储库的指令。从下载 CUDA 10.1 开始。deb 文件，方法是在 Ubuntu 18.04 机器上的 bash 终端中键入以下内容:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="06c1" class="na kj it mw b gy nb nc l nd ne">wget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/cuda-repo-ubuntu1804_10.1.243-1_amd64.deb</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/3cd4c57860fda5938c60cf4763fedf52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6zkyldXlhmxe6LtdZPiUbg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.1:下载 CUDA 10.1。deb 文件</p></figure><p id="0f44" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">接下来，拿钥匙:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9ed6" class="na kj it mw b gy nb nc l nd ne">sudo apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64/7fa2af80.pub</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/15b32d54808a76ad431ea9e9e1654ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pVOXAzbBCkdpEkXMwqsgbw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.2:从 Nvidia 网站获取密钥</p></figure><p id="d097" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后安装 CUDA 10.1。64 位 Ubuntu 18.04 的 deb 文件:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e747" class="na kj it mw b gy nb nc l nd ne">sudo dpkg -i cuda-repo-ubuntu1804_10.1.243-1_amd64.deb<br/></span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/f7cb013236caca9efa7d21a9d1b3066b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCRlrjnQM07nBQJEOrvAsg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.3:安装 CUDA 10.1 deb 文件</p></figure><p id="372a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">运行更新软件包命令下载各种软件包的更新版本:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="e4be" class="na kj it mw b gy nb nc l nd ne">sudo apt-get update</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/503a4465d94410964834e419b0416805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qOMfS0PiBxx4zzwhIuEagA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.4:更新软件包命令以获得最新版本</p></figure><p id="b47c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">获取更多适用于 CUDA 10.1 的 Nvidia 软件包库(根据<a class="ae lw" href="https://www.tensorflow.org/install/gpu#install_cuda_with_apt" rel="noopener ugc nofollow" target="_blank"> Tensorflow 网站</a>上的命令):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0379" class="na kj it mw b gy nb nc l nd ne">wget http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64/nvidia-machine-learning-repo-ubuntu1804_1.0.0-1_amd64.deb</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/dd82788ece10b045668adea4fcf540c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DIpHmh6DKDCt5oPr3_2lWA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.5:获取更多的 Nvidia 软件包库</p></figure><p id="411f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">一旦下载了 Nvidia 软件包库，安装 Nvidia。带权限的 deb 包(sudo):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5113" class="na kj it mw b gy nb nc l nd ne">sudo apt install ./nvidia-machine-learning-repo-ubuntu1804_1.0.0-1_amd64.deb</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/cbf2d912749b570c81245670c75b2088.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d5sKkoLpwlB0muZJges_rw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.6:安装。带权限的 deb 包</p></figure><p id="049d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">并再次更新软件包:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7609" class="na kj it mw b gy nb nc l nd ne">sudo apt-get update</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/e5de0e080f3ed6bea16e3ba4da85ff79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gszk47uLKTpFICmktz5MlA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 3.7:再次更新软件包</p></figure><h1 id="0d22" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 4:安装 NVIDIA 驱动程序版本 430</h1><p id="c229" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我已经安装了 NVIDIA 驱动程序版本 390；安装 nvidia 驱动程序版本 430。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="6cbb" class="na kj it mw b gy nb nc l nd ne">sudo apt-get install --no-install-recommends nvidia-driver-430</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/6995b1aeb48ff76eac313d9cac0afd51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BGTQbeByhJ0FK1Eh29NZeg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 4.1:首次尝试安装 nvidia 驱动程序 430</p></figure><p id="a323" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我得到消息说我的系统有未满足的依赖项，因此我通过使用以下命令删除 PPA 来解决这个问题(注意:-r 表示删除):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="559f" class="na kj it mw b gy nb nc l nd ne">sudo apt-add-repository -r ppa:graphics-drivers/ppa<br/></span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/a916c8597125c49af3e8c0cb0c0b29d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPPuqzrwDKq4fzBXACtiZg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 4.2:删除 PPA 的命令</p></figure><p id="7205" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">确保包列表是最新的:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2165" class="na kj it mw b gy nb nc l nd ne">sudo apt update</span></pre><p id="33ce" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">删除所有现有的 nvidia 驱动程序:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2d1f" class="na kj it mw b gy nb nc l nd ne">sudo apt-get remove --purge '^nvidia-.*'</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/0d76af752c9724cfce18702decf56834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXXD5gP2c1PkVUIDTyMsJg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 4.3:删除现有的 nvidia 驱动程序</p></figure><p id="7cdf" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后尝试重新安装 Nvidia 驱动程序版本 430:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="495c" class="na kj it mw b gy nb nc l nd ne">sudo apt-get install --no-install-recommends nvidia-driver-430</span></pre><p id="ffdd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">全新的 Nvidia 版本 430 驱动程序安装给出了下面的输出，并成功完成。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/c4776b129e168ffa17d2d52ce6a6376f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JsJpALVr7NeboCUKdRzWfw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 4.4:NVIDIA 驱动程序版本 430 的全新安装</p></figure><p id="bef0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> <em class="mc">一旦你安装了 nvidia 驱动 430，关闭并重启你的电脑。</em> </strong></p><h1 id="e4a2" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 5:检查新的 Nvidia GPU 驱动程序安装</h1><p id="a559" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在 bash 终端中使用以下命令检查新的 GPU 驱动程序是否可见:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="bf91" class="na kj it mw b gy nb nc l nd ne">nvidia-smi</span></pre><p id="0d5f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">该命令的输出如下所示，将确认新的 Nvidia 驱动程序版本是 430.50。请注意，CUDA 版本现在是 10.1(如上所述):</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/af4054aebb4ef682e69d68a1a1ead31e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WPW6oGHF65XFIZAQ3kvhFg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 5.1:检查 Nvidia 驱动程序 430.50 是否已成功安装</p></figure><h1 id="d6a4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 6:安装 CUDA 10.1 和 CuDNN 开发和运行时库</h1><p id="d186" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了安装 CUDA 和 cuDNN 开发和运行时库，Tensorflow 安装页面建议使用以下命令:</p><p id="853d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">第一，安装 CUDA 10.1 运行时，下载、解压缩和安装大约需要 20-30 分钟:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="562d" class="na kj it mw b gy nb nc l nd ne"># Install development and runtime libraries (~4GB)<br/>sudo apt-get install --no-install-recommends cuda-10-1 </span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nr"><img src="../Images/6079e92327d99ced36ded8c9a6c5a0c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eV2G3pZwyofiVB2bhZdVUQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 6.1:安装 CUDA 10.1(显示终端输出的第一部分)</p></figure><p id="2aa9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">请注意，在终端打印输出中，有一个“重新启动计算机并验证 NVIDIA 图形驱动程序是否可以加载”的指令(图 6.2)。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nr"><img src="../Images/b89fe345b30fc176a07fa577dcc05309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lL0LX1ziA25Pp1wBj_AQhQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 6.2:重新启动计算机并验证 NVIDIA 图形驱动程序的说明</p></figure><p id="0327" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">安装信息如下所示(图 6.3)</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nr"><img src="../Images/526224dac6de002e509e999336cc68dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QSCAdKCKnf2Zaosg5aZsRg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 6.3:完成 CUDA 10.1 的安装</p></figure><h1 id="58ca" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">第 7 步:重新启动计算机(按照上述说明)并检查驱动程序版本</h1><p id="05c5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">重启计算机(按照图 6.2 中的说明)。重新启动后，运行以下命令再次检查驱动程序的安装:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="b34a" class="na kj it mw b gy nb nc l nd ne">nvidia-smi</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/3d0abe476ed150d29e774b7c9131b8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GMWFvbs5qrDJmHvs-V2Rg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 7.1:安装/更新驱动程序后检查已安装的 Nvidia 驱动程序</p></figure><p id="bcab" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">请注意，重启后，NVIDIA 驱动程序(<em class="mc">意外地</em>)升级到版本 440.64.00，CUDA 版本从版本<strong class="lc iu"> 10.1 </strong>升级到版本<strong class="lc iu"> 10.2，</strong>，如图 7.1 所示。因此，我为 CUDA 10.2 选择了合适的 cuDNN 用于下面的说明。</p><h1 id="0784" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 8:为 Ubuntu 18.04 下载 CuDNN</h1><p id="f2ee" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">你可以从<a class="ae lw" href="https://developer.nvidia.com/cudnn" rel="noopener ugc nofollow" target="_blank">这里</a>下载 cuDNN。以下是我下载 cuDNN 文件的步骤。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ns"><img src="../Images/675c282e7ac31b34631b54fe0c4a1bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0yJia7JcJkYdsI6lL7XP8w.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.1:可以下载 cuDNN 的 Nvidia 网站截图</p></figure><p id="9a25" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">您必须注册才能下载 cuDNN(免费),登录截图如图 8.2 所示:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nt"><img src="../Images/ba3a162a036b7c7cc842fc8258e5fa22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pr7d1qMg5hSrXARkAiL6dg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.2:截图来自 Nvidia 网站:下载 cuDNN 必须登录</p></figure><p id="8f12" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">登录后，您将进入 cuDNN 下载页面:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nu"><img src="../Images/de456c7d7cfbe287595cae59b6fc56d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hzzE0nekWtwCRZgoiNLTw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.3:登录 Nvidia cuDNN 网站时可用的 cuDNN 下载选项</p></figure><p id="1f1d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">要获得 v.7.6.4 或任何其他稍旧的 cuDNN 版本，请单击图 8.3 所示的“存档的 cuDNN 版本”。由于我的机器上似乎安装了 CUDA 10.2(而不是 CUDA 10.1)，所以我为 CUDA 10.2 选择了合适的 cuDNN 库。这是 cuDNN 版本 7.6.5:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nv"><img src="../Images/4c7b702fd2dc57598b84d1dd72df265b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C3MdxQv2LEwe2SHpq9CXOQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.4:Nvidia cud nn 网站截图——下载 cuDNN 7.6.5 时不同操作系统的选项</p></figure><p id="80c7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">从图 8.4 中，从列表中选择以下三项:</p><ul class=""><li id="80a4" class="md me it lc b ld lx lg ly lj mf ln mg lr mh lv mi mj mk ml bi translated">Ubuntu 18.04 的 cuDNN 运行时库(Deb)</li><li id="1f48" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">适用于 Ubuntu 18.04 的 cuDNN 开发人员库(Deb)</li><li id="7f15" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">适用于 Ubuntu 18.04 (Deb)的 cuDNN 代码示例和用户指南—可选</li></ul><p id="d738" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这给出了以下内容。要下载的 deb 包:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a75d377b0608f4ffce5911effac9c421.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*wyYmFgcNcSBqNVRQhVfMHg.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.5:Ubuntu 的 cuDNN 运行时库。deb 包</p></figure><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4b5892926ba1441dcb69a8f57d3ef805.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*-P2NkypdAysmLuBoL_1OUA.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.6:Ubuntu 18.04 的 cuDNN 开发者库。deb 下载</p></figure><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/c846fa599b4315a1c1a2c77319930942.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*AmTx7gEMMxGXK7b1UfsW-g.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 8.7:Ubuntu 18.04 的 cuDNN 代码样本和用户指南。deb 下载</p></figure><h1 id="78d4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 9:为 Ubuntu 18.04 安装 CuDNN</h1><p id="5a74" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了安装 cuDNN，说明可从<a class="ae lw" href="https://www.tensorflow.org/install/gpu" rel="noopener ugc nofollow" target="_blank"> tensorflow 网站</a>获得一些说明，更详细的 cuDNN 库命令见<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installlinux-deb" rel="noopener ugc nofollow" target="_blank"> cuDNN 安装指南</a>。下面是一个截图:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nx"><img src="../Images/14898ba2c2fb29f348fc7ff8cf132ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e4sufMWRk-JUz5IkAkV_eA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 9.1:<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installlinux-deb" rel="noopener ugc nofollow" target="_blank">Nvidia 网站</a>上 cuDNN 安装指南的截图</p></figure><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="272f" class="na kj it mw b gy nb nc l nd ne"># change directory to where the cuDNN runtime library is downloaded <br/>cd ~/Downloads</span><span id="71fc" class="na kj it mw b gy ny nc l nd ne"># Install cuDNN runtime library<br/>sudo dpkg -i <!-- -->libcudnn7_7.6.5.32-1+cuda10.2_amd64<!-- -->.deb</span><span id="f681" class="na kj it mw b gy ny nc l nd ne"># Install cuDNN developer library<br/>sudo dpkg -i <!-- -->libcudnn7-dev_7.6.5.32-1+cuda10.2_amd64<!-- -->.deb</span><span id="5a52" class="na kj it mw b gy ny nc l nd ne"># (optional) install code samples and the cuDNN library documentation<br/>sudo dpkg -i libcudnn7-doc_7.6.5.32-1+cuda10.2_amd64.deb</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/f07b5439a48557ab74113250fbfbeee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4ln1YeB66r0xjGmBcxtmA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 9.2:安装 cuDNN 运行时库</p></figure><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/6d442686857d3f2d1a9c5be9f0cf26a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pClq_qvvJwOnHrdj3nCykQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 9.3:安装 cuDNN 开发人员库</p></figure><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/03735d8aeb7543161f830ce998134eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oxjaIIK5IGG6-EkzXuIUvw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 9.4:安装代码示例和 cuDNN 库文档</p></figure><h1 id="0c33" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 10:测试 cuDNN 安装</h1><p id="2e40" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在第 9 步下载了与 cuDNN 相关的内容之后，第 10 步将测试新的 cuDNN 安装。测试 cuDNN 安装的命令包含在<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installlinux-deb" rel="noopener ugc nofollow" target="_blank"> cuDNN 安装指南</a>中:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nz"><img src="../Images/94e3b2d4ace8eb053c706fafb62c6eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ROhyZ9kDv54GgAoWAW6lkw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 10.1:验证 cuDNN 安装的步骤截图，在这里找到了<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html#installlinux-deb" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="1915" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">应用 cuDNN 安装指南中的，通过编译位于/usr/scr/cudnn_samples_v7 中的 mnistCUDNN 示例(由 Debian 安装)来验证 cuDNN 是否已正确安装和运行。deb)文件。</p><p id="b26c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当您安装了。deb 文件，您可以通过转到/usr/src 文件夹找到下面的示例，在那里您可以看到“cudnn_samples_v7”(图 10.1):</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ebe71b4278b309e55b4db4e99f9401d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*npG30454bJd0w2yR9TGWkg.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 10.2:将目录更改为“/usr/src/”，其中可以找到 cudnn_samples_v7</p></figure><p id="9efc" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后将 cudnn_samples_v7 文件夹复制到 home，如图 10.1 所示:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/797bc38e8077a0b6b565525a81ac88ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHKSuRArUJ4WkCa-B0EJEA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 10.3:将 cuDNN v7 示例从那里复制到主文件夹</p></figure><p id="7714" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">将 samples 文件夹复制到主文件夹(您可以在那里运行它们)后，将目录切换到 mnistCUDNN 文件夹，并运行以下代码来编译 mnistCUDNN 示例:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="9b3a" class="na kj it mw b gy nb nc l nd ne">make clean &amp;&amp; make</span></pre><p id="47e3" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">该命令的输出如图 9.8 所示:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/85f65bc4be84ac0bc1aca7c975381175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpvYcvGDY-KwnLHaUziAHQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 10.4:编译 mnistCUDNN 示例后的输出</p></figure><p id="441e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后使用以下命令在 mnishCUDNN 文件夹中运行 mnistCUDNN 示例:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="d05d" class="na kj it mw b gy nb nc l nd ne">./mnistCUDNN</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/c4725f813c15aea82b7035ca046df0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUqhIIwuY2NmqQdMxIog9g.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 10.5:运行 mnistCUDNN 示例后的输出——“测试通过！”</p></figure><p id="3ee3" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当您运行 mnistCUDNN 示例时，成功的运行应该以“Test passed！”连同分类结果，如图 10.4 所示。</p><h1 id="491d" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">步骤 11:下载 Tensorflow RT </strong></h1><p id="bfdb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">作为软件需求的一部分列出的最后一个包是<strong class="lc iu"> <em class="mc">可选的</em> </strong> Tensorflow RT，可以下载并安装该包，“以提高某些模型上推理的延迟和吞吐量”。</p><p id="f05c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tensorflow RT 的安装说明在 Tensorflow 自己的网站<a class="ae lw" href="https://www.tensorflow.org/install/gpu" rel="noopener ugc nofollow" target="_blank">这里</a>有概述，但是关于不同操作系统的 tensorflow RT 安装的更详细的说明和更清晰的信息，包括我正在使用的 Linux Debian，可以在这里找到<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html#installing-debian" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ob"><img src="../Images/a741b6a2ce54509aebd8e61c5af2c387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Z0E_SJ4C0n7iH1OBZM3SA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.1:从<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html#installing-debian" rel="noopener ugc nofollow" target="_blank">深度学习 sdk 文档</a>安装 TensorRT 的说明</p></figure><p id="0da2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">点击图 11.1 中的“下载”将带您进入图 11.2 所示的屏幕截图页面(注意，您必须免费注册 cuDNN，并使用您在上面 cuDNN 中使用的 Nvidia 开发人员凭据再次登录，以便下载 TensorRT):</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi oc"><img src="../Images/bc41f57f5621379569b0fb749faf141e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iEIsUO48MOFP9PnI-tcSKg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.2:登录并下载 TensorRT</p></figure><p id="18a2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这将带您进入下一页(图 11.3)，其中显示了可用的 TensorRT 版本。按照步骤 1 中 Tensorflow 的建议，我选择下载 TensorRT 6。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi od"><img src="../Images/9c9d06718a710b58e0adf2f30e0e43af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yW7UCcMTkEYQT3vPXYuVA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.3:选择要下载的 tensort 版本(我选择了 TensorRT 6)</p></figure><p id="8d62" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">选择 TensorRT 6.0 后，这提供了更多下载选择，如图 11.4 所示:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi oe"><img src="../Images/a0b67c9d88ec4f42bdc4698043052b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCKi6ABiUSVSJ9t8LjPkIQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.4:各种 Ubuntu 和 CUDA 版本的 TensorRT 选择</p></figure><p id="1d04" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我将为 Ubuntu 1804 和 CUDA 10.2 选择 TensorRT 6.0.1.8 GA。deb 本地回购包(在上面的步骤中，我的系统从 10.1 升级到了 CUDA 10.2)。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/217c276a8b7dfe0465db0702fe1fb2b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*PeBCiAqz_aozbj9X30Z8yQ.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.5:为 Ubuntu 1804 和 CUDA 10.2 下载坦索特 6.0.1.8 GA。债券本地回购包</p></figure><p id="c72c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">您可以检查已安装的 CUDA 版本，如下所示:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/bed3d6f836ba273e7dfc8d72ea4473aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfzgusJilj4s_M9nZcUvWA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 11.6:检查已安装的 CUDA 版本</p></figure><p id="d625" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">图 11.6 显示我有 CUDA 9.0，CUDA 10.1，CUDA 10.2 (CUDA 10.2 是最后安装的)。基于这篇名为<a class="ae lw" href="https://medium.com/@peterjussi/multicuda-multiple-versions-of-cuda-on-one-machine-4b6ccda6faae" rel="noopener"> MultiCUDA </a> : <a class="ae lw" href="https://medium.com/@peterjussi/multicuda-multiple-versions-of-cuda-on-one-machine-4b6ccda6faae" rel="noopener">一机多版本 CUDA</a>的优秀文章，多个版本的 CUDA 可以并存。它说“<em class="mc">安装多个版本不会导致任何以前的版本被覆盖，所以没有必要担心。您安装的每个版本都将覆盖导致操作系统使用某个版本的配置，但是默认情况下，它们都按照版本号安装在/usr/local 下的单独目录中。</em></p><p id="627e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">因此，我保留了 CUDA 的所有三个版本——首先将使用 CUDA 10.2。</p><h1 id="408a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 12:安装 Tensorflow RT</h1><p id="117f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">安装 Tensorflow RT 的注意事项在 Nvidia 网站<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html#installing-debian" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi of"><img src="../Images/873de3661d941c3df036732678a0985d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-xgJctwpNlWKB5j1wzT0Q.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.1:为 Debian 安装 TensorRT 指令(。deb 文件)——在这里找到了<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html#installing-debian" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="64b0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我正在安装。Tensorflow RT 的 deb 版本，如上图 12.1 所示，自动安装依赖项。安装 Tensorflow RT 的版本独立说明如下:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="fa88" class="na kj it mw b gy nb nc l nd ne">os=”ubuntu1x04”<br/>tag=”cudax.x-trt7.x.x.x-ea-yyyymmdd”<br/>sudo dpkg -i nv-tensorrt-repo-${os}-${tag}_1-1_amd64.deb<br/>sudo apt-key add /var/nv-tensorrt-repo-${tag}/7fa2af80.pub<br/><br/>sudo apt-get update<br/>sudo apt-get install tensorrt</span></pre><p id="2d27" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">的。我下载的 TensorRT 的 deb 文件是“NV-tensor rt-repo-Ubuntu 1804-cuda 10.2-TRT 6 . 0 . 1 . 8-ga-2019 11 08 _ 1–1 _ amd64 . deb”，我已经下载到“下载”中。</p><p id="517e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">对于我的操作系统和 CUDA“标签”,这些安装说明变成:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="c01f" class="na kj it mw b gy nb nc l nd ne"># change directory to where you have downloaded the .deb file <br/># (in my case, downloads)<br/>cd ~/Downloads</span><span id="631f" class="na kj it mw b gy ny nc l nd ne"># specific instructions for nv-tensorrt-repo-ubuntu1804-cuda10.2-trt6.0.1.8-ga-20191108_1–1_amd64.deb </span><span id="61bb" class="na kj it mw b gy ny nc l nd ne">os=”ubuntu1804”<br/>tag=”cuda10.2-trt6.0.1.8-ga-20191108”<br/>sudo dpkg -i nv-tensorrt-repo-${os}-${tag}_1-1_amd64.deb</span><span id="75a0" class="na kj it mw b gy ny nc l nd ne">sudo apt-key add /var/nv-tensorrt-repo-${tag}/7fa2af80.pub</span></pre><p id="7134" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">转到下载文件夹并安装 TensorflowRT。deb 文件显示在图 12.2 的终端中。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi og"><img src="../Images/388a64dc90913206517daf493fbaabe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*rc9S_QoyWFNsFCgpP4SmfQ.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.2:运行 TensorRT 包</p></figure><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi og"><img src="../Images/3f03fbd563a9a4437dd8f5f3ac1dfbbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*TfsnZOuedj71XjaSy51qWg.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.3:为 TensorRT 安装添加密钥</p></figure><p id="bd85" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">添加 TensorRT 安装的密钥后，最后，更新软件包，并安装 Tensor RT。这将需要几分钟时间。在 tensor RT 安装过程中，系统会提示您输入“y/n”答案，您可以通过在安装命令中添加一个“-y”标志来预先设置。</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="df07" class="na kj it mw b gy nb nc l nd ne">sudo apt-get update</span><span id="9bc5" class="na kj it mw b gy ny nc l nd ne">#install tensor rt - optionally add a '-y' flag at the end of the command below to pre-empt the prompt </span><span id="7b13" class="na kj it mw b gy ny nc l nd ne">sudo apt-get install tensorrt -y</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/c9808f2361f50d3e25acb6e317b9911e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*VxNeC9x4wJLD3FvEOUDhWg.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.4:安装 TensorRT</p></figure><p id="f59a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">根据此处的指令<a class="ae lw" href="https://docs.nvidia.com/deeplearning/sdk/tensorrt-install-guide/index.html#installing-debian" rel="noopener ugc nofollow" target="_blank">，使用以下命令:</a></p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="456c" class="na kj it mw b gy nb nc l nd ne">sudo apt-get install python3-libnvinfer-dev</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/d7e4ab4a51ab6f41680dbae39ad0ab0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4oXgKQFqAT6Dl0QXUVMZag.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.5:安装 python3-libnvinfer-dev 包(TensorRT 的一部分)</p></figure><p id="3a07" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">如果您计划将 TensorRT 与 TensorFlow 一起使用，请运行以下命令:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="da3b" class="na kj it mw b gy nb nc l nd ne">sudo apt-get install uff-converter-tf</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi nf"><img src="../Images/ed7c5bc2c3ea4a867cdb5d86c6a57809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5lkoOLX4R91cXiFHuYIWA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.6:运行命令以使用 Tensorflow 启用 TensorRT</p></figure><p id="5507" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">使用以下命令验证 TensorRT 安装</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="5eac" class="na kj it mw b gy nb nc l nd ne">dpkg -l | grep TensorRT</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi oi"><img src="../Images/3eb278dbeb8b87abef2cc3befb02fec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cz6SKT5cJXrE3d3ew0l5Tg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 12.7:检查 TensorRT 安装</p></figure><h1 id="ef86" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 13:安装 Tensorflow(推荐:在虚拟环境中安装)</h1><p id="e9c7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">到目前为止，我执行的每一个安装步骤(如上所述)都是系统范围的安装。您<strong class="lc iu"> <em class="mc">可以</em> </strong>在类似的系统范围基础上安装 Tensorflow，但更可取的是<strong class="lc iu"> <em class="mc">将其安装在虚拟环境</em> </strong>中，这样它会在无意中安装/卸载(或通常干扰)其他包时停止您的 Tensorflow 安装。</p><p id="207e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这一步使用命令行和 Pycharm IDE 在新的虚拟环境中进行安装，但是您可以使用自己喜欢的方法创建一个虚拟环境。在虚拟环境中安装 Tensorflow 2 的命令是<a class="ae lw" href="https://www.tensorflow.org/install/pip#virtualenv-install" rel="noopener ugc nofollow" target="_blank">这里是</a>。从 Tensorflow 版本[X]开始，CPU 和 GPU 支持的版本没有单独的安装命令。</p><h2 id="01b5" class="na kj it bd kk oj ok dn ko ol om dp ks lj on oo ku ln op oq kw lr or os ky ot bi translated"><strong class="ak">步骤 13.1:用虚拟环境建立一个新的 Pycharm 项目</strong></h2><p id="dd85" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我在 Pycharm 中创建了一个说明性的项目来展示虚拟环境的最初创建。Pycharm 的版本是社区版 2020.1.1。</p><p id="5afd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">首先在 Pycharm 中创建一个新的(演示)项目，使用 File -&gt; New Project，如图 13.1 所示</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/7b1c216050ebd6846fe6ed37818ed66d.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*YKMrkQK_udYvSJW92CDxnQ.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.1:在 Pycharm 中创建新项目</p></figure><p id="f1dd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这将产生一个在虚拟环境中创建项目的窗口，如图 13.2 所示</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ov"><img src="../Images/ceb28be444ee1bed5e62b072ae746715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQxJiu3q0Me-BAK6Z3oCTw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.2:使用 Pycharm 在虚拟环境中创建新项目</p></figure><p id="7446" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">图 13.2 中的窗口给出了命名新项目的选项。如果您单击“项目解释器”左侧的箭头，它会提供如图 13.3 所示的选项。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ov"><img src="../Images/5779391f586702434ce3ce2b1f766fff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CWos1PC2BucIYlko2dzlHA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.3:在 pycharm 中设置新的环境设置</p></figure><p id="917f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在位置框中将项目命名为“example_tf_2”会对窗口进行更改，如图 13.4 所示</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ov"><img src="../Images/0dcfc848d4ab3f79b8b568f9cd5bd1cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKOdLgC-xyu9NOxJ34F8Zg.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.4:创建一个名为 example _ TF _ 2(tensor flow 2 的缩写)的新项目</p></figure><p id="25cd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当您单击“创建”来创建新项目时，会出现图 13.5 所示的窗口:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi ow"><img src="../Images/2747a2d81bc58dfd7bfcd1832e6856cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGyclq7L5s4R3st-gMi3uw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.5:显示新项目的选项</p></figure><p id="80c1" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我选择“attach ”,将这个新项目添加到我已经打开的 Pycharm 中其他项目的下拉列表中。这将创建一个名为“example_tf_2”的新项目文件夹；请注意，它有一个“venv”文件夹。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/b0a394708a1303e857d930365b32aa5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*U_Otsq0lB1WPTCQtsvXHYw.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.6:py charm 中的新项目结构，包括 venv 文件夹</p></figure><p id="fd90" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在 Pycharm 查看器(终端)的底部窗口中，将目录更改为相关目录(在本例中，新的项目目录是“example_tf_2”)。)</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi oy"><img src="../Images/2c216a6594f359c9818583b2f76f02a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A49Lv5jJS3-wYtGeTQ5Dzw.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 pycharm 中的终端显示了到新 example_tf_2 项目的路径</p></figure><p id="2340" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在命令行中使用以下命令激活新的虚拟环境(称为“venv”):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="1ae3" class="na kj it mw b gy nb nc l nd ne">source venv/bin/activate </span></pre><p id="63e1" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">如果你把你的虚拟环境叫做别的东西，比如‘myvenv’，那么相应的命令<em class="mc">将改为</em>:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7952" class="na kj it mw b gy nb nc l nd ne">source myvenv/bin/activate</span></pre><p id="8752" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">当您运行激活命令时，命令行开始显示“(venv)”，这意味着虚拟环境已经被激活。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi oz"><img src="../Images/d34acabef8b9af4f2732598d33cb159c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LpCEFL1ECxsnI0Bnw1oGjQ.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.8:在 Pycharm 上激活终端内的虚拟环境</p></figure><h2 id="88f9" class="na kj it bd kk oj ok dn ko ol om dp ks lj on oo ku ln op oq kw lr or os ky ot bi translated">步骤 13.2:在虚拟环境中安装 Tensorflow 2</h2><p id="ee6a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要在此虚拟环境中安装 Tensorflow，请在命令行窗口中运行以下 pip 命令(在 Pycharm 或您自己的终端中):</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="1558" class="na kj it mw b gy nb nc l nd ne"># choosing 'tensorflow' without specifying the version installs the # latest stable version of tensorflow (here, version 2.1.0)<br/># the command prompt should read something like:<br/># (venv) /your/particular/path$<br/># installs latest stable version of tensorflow, with GPU or CPU support</span><span id="dcb6" class="na kj it mw b gy ny nc l nd ne">pip install tensorflow</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi pa"><img src="../Images/e2cd439d7ab5f44998d25805c140b88e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1XvjyXjXHw2MXx7k_c-KiA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.9:使用 Pycharm 中的终端在新的虚拟环境中安装 Tensorflow 2.1</p></figure><p id="e588" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">在虚拟环境中完成 Tensorflow 2.1.0 的安装后，终端将返回到命令提示符“$”:</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi pb"><img src="../Images/8254474948e7f91d3124cb5361aba09b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LdzeE6ZdNcO89NX8JlsOaA.png"/></div></div><p class="nn no gj gh gi np nq bd b be z dk translated">图 13.10:在虚拟环境中安装 Tensorflow 2.1 后，终端返回到命令提示符$处</p></figure><h1 id="2889" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">步骤 14:检查 Tensorflow 和 GPU 支持的安装是否正确</h1><p id="6b62" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">要测试您的 Tensorflow 安装对 CUDA 的支持，以及 Tensorflow 是否找到了您的 GPU 设备，首先在命令行中键入“python”从终端调用 Python:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="6240" class="na kj it mw b gy nb nc l nd ne">python</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/046daab39f53571e12a59c3d1415dbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*FUE1eqvSl-34h5lBUjqAcw.png"/></div><p class="nn no gj gh gi np nq bd b be z dk translated">通过在虚拟环境的命令行中键入“python”来调用由“&gt; &gt; &gt;”表示的 python 命令提示符</p></figure><p id="f7df" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">命令提示符应该从“$”更改为“&gt; &gt;”。然后导入 Tensorflow，之后您可以在 shell 中运行构建测试:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="d192" class="na kj it mw b gy nb nc l nd ne"># import tensorflow package <br/>import tensorflow as tf</span><span id="d651" class="na kj it mw b gy ny nc l nd ne"># test that tensorflow has been built with cuda<br/>tf.test.is_built_with_cuda()</span></pre><p id="074a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这将返回输出“True”。</p><p id="6017" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">为了检查 Tensorflow 找到的 GPU，您可以使用以下命令列出这些 GPU:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="7fb1" class="na kj it mw b gy nb nc l nd ne">tf.config.list_physical_devices(‘GPU’)</span></pre><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/5428d11851198f1ef40c2654344ea220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*OTaLfYiIVcx1x93P4I1W_g.png"/></div></figure><p id="dd21" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tensorflow 应该输出类似上面示例的内容—名称和设备类型。</p><p id="10a6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">最后，您可以使用<a class="ae lw" href="https://www.tensorflow.org/install/pip" rel="noopener ugc nofollow" target="_blank"> Tensorflow 网站</a>上显示的命令来验证安装(从标准命令提示符“$”)。注意:如果您有 python 命令提示符("&gt; &gt; &gt;")，并且希望返回到标准 shell 命令提示符(" $ ")，请按 CTRL+ Z。</p><p id="9224" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">以下命令导入 Tensorflow 并执行计算，例如:</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="0c30" class="na kj it mw b gy nb nc l nd ne">python -c "import tensorflow as tf;print(tf.reduce_sum(tf.random.normal([1000, 1000])))"</span></pre><p id="5794" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这将输出关于您的 GPU 和已安装的软件包的信息，以及测试函数的输出。</p><figure class="mr ms mt mu gt ng gh gi paragraph-image"><div role="button" tabindex="0" class="nh ni di nj bf nk"><div class="gh gi pe"><img src="../Images/505f52b9d62fcd78536759beb3ea852f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDZQJXu7IJBL3Vvf-Nn6jg.png"/></div></div></figure><h1 id="9d0f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">关于 Keras 和张量流的结论和注记</h1><p id="798a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">本文列出了我用来安装新的 Nvidia 驱动程序 CUDA、cuDNN 和 TensorRT(可选)的过程，所有这些都是在我的 Ubuntu 18.04 机器上使用 Tensorflow 2 和 GPU 支持的前兆。</p><p id="ebe9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">以前我一直使用<a class="ae lw" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank">独立 Keras </a>和 Tensorflow 后端。现在有了 Tensorflow 2.0 及以上版本，keras 被包含在“tf.keras”形式中，所以不再需要单独安装 Keras(虽然我假设你仍然可以)。</p><p id="4d77" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tensorflow Keras (tf.keras)似乎有许多与独立 Keras 相同的功能，tf.keras 的指南可以在<a class="ae lw" href="https://www.tensorflow.org/guide/keras/overview" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="ddef" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">该指南声明<code class="fe pf pg ph mw b"><a class="ae lw" href="https://www.tensorflow.org/api_docs/python/tf/keras" rel="noopener ugc nofollow" target="_blank">tf.keras</a></code>可以运行任何 Keras 兼容的代码，但是请注意:</p><ul class=""><li id="513b" class="md me it lc b ld lx lg ly lj mf ln mg lr mh lv mi mj mk ml bi translated">最新 TensorFlow 版本中的<code class="fe pf pg ph mw b"><a class="ae lw" href="https://www.tensorflow.org/api_docs/python/tf/keras" rel="noopener ugc nofollow" target="_blank">tf.keras</a></code>版本可能与 PyPI 的最新<code class="fe pf pg ph mw b">keras</code>版本不同。检查<code class="fe pf pg ph mw b"><a class="ae lw" href="https://www.tensorflow.org/api_docs/python/tf/keras#__version__" rel="noopener ugc nofollow" target="_blank">tf.keras.<strong class="lc iu">version</strong></a></code>。</li><li id="81aa" class="md me it lc b ld mm lg mn lj mo ln mp lr mq lv mi mj mk ml bi translated">当<a class="ae lw" href="https://www.tensorflow.org/guide/keras/save_and_serialize" rel="noopener ugc nofollow" target="_blank">保存模型的权重</a>时，<code class="fe pf pg ph mw b"><a class="ae lw" href="https://www.tensorflow.org/api_docs/python/tf/keras" rel="noopener ugc nofollow" target="_blank">tf.keras</a></code>默认为<a class="ae lw" href="https://www.tensorflow.org/guide/checkpoint" rel="noopener ugc nofollow" target="_blank">检查点格式</a>。传递<code class="fe pf pg ph mw b">save_format='h5'</code>以使用 HDF5(或者传递一个以<code class="fe pf pg ph mw b">.h5</code>结尾的文件名)。</li></ul><p id="b613" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这篇文章也发表在<a class="ae lw" href="https://schoolforengineering.com" rel="noopener ugc nofollow" target="_blank">https://schoolforengineering.com</a>上，可以在<a class="ae lw" href="https://schoolforengineering.com/tutorial/install-tensorflow-2-1-gpu-linux-ubuntu/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>