<html>
<head>
<title>Optimizing the curve! Modelling optimal lockdown exit for COVID-19</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化曲线！模拟新冠肺炎的最佳封锁出口</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimizing-the-curve-modelling-optimal-lockdown-exit-for-covid-19-dfc81f2fb0c1?source=collection_archive---------32-----------------------#2020-06-10">https://towardsdatascience.com/optimizing-the-curve-modelling-optimal-lockdown-exit-for-covid-19-dfc81f2fb0c1?source=collection_archive---------32-----------------------#2020-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca34" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">具有最优控制的扩展SEIR模型旨在“拉平曲线”而不会“拉平经济”太多。</h2></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><p id="d627" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu"> <em class="ll">编者按:</em> </strong> <em class="ll"> </em> <a class="ae lm" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="ll">走向数据科学</em> </a> <em class="ll">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lm" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="ll">这里</em> </a> <em class="ll">。</em></p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="d0ac" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">介绍</h1><p id="e0b7" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">绝大多数新冠肺炎预测模型预测有多少人可能被感染(<em class="ll">“估计曲线】</em>)。大量模型还估计了控制措施(如封锁)对受感染曲线的影响(“使曲线变平”)。然而，很少有模型试图回答这个关键问题——如何以最佳方式引入和放松控制措施？(《优化曲线》)。因为，事实上，强有力的控制措施，比如封锁，会对社会和经济产生巨大的负面影响。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/379087e72fd4ed6d7d049c7981bb59e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMRSdEq-xYrJs8h-E0MzSw.png"/></div></div></figure><p id="3a82" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在这篇文章中，我将提供一个简化的模型，其中将包括最佳控制措施的估计。它将回答<strong class="kr iu">如何最佳地进入然后退出封锁</strong>或放松任何其他控制措施的问题。我不会深究优化背后的复杂数学，并将尽可能提供直观的例子。正如您将看到的，生成的模型将使用不到100行Python代码(不包括交互式绘图部分),并将使用众所周知的库——NumPy和SciPy来计算解决方案。</p><p id="3220" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">正如我之前提到的，很少有模型和研究将最优控制应用于新冠肺炎建模。你可以在这里找到其中的几个。它们包括许多复杂的数学。在文章中，我特意省略了它，以便用更容易理解的方式解释这些概念。因此，这里提供的模型将被简化，并应被视为主要是教育。它既不应被视为现实的预测模型，也不应作为任何决策的基础。</p><p id="0f7c" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">本文将包含以下几个部分:</p><ul class=""><li id="dda3" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated">背景:所选模型和控制方法背后的理论。</li><li id="f652" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">编码:</strong>一个关于如何用Python编码模型的<strong class="kr iu"> </strong>分步指南。</li><li id="29ce" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">用例:</strong>估计<em class="ll">应对新型冠状病毒病毒在一个假想城市传播的控制措施的6种不同情景</em>。</li><li id="2b50" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">比较:</strong>开发的模型与另一个具有更先进求解技术的模型进行比较。</li><li id="cd05" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">结论:</strong>总结与成果。</li></ul><p id="452b" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这里是模型、场景和比较的完整代码。</p><p id="5ac7" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">正如英国著名统计学家乔治·博克斯所说:</p><blockquote class="nk"><p id="4c12" class="nl nm it bd nn no np nq nr ns nt lk dk translated">“所有的模型都是错的，但有些是有用的”。</p></blockquote><p id="4ab7" class="pw-post-body-paragraph kp kq it kr b ks nu ju ku kv nv jx kx ky nw la lb lc nx le lf lg ny li lj lk im bi translated">考虑到这一点，我希望这里提供的模型可以作为所有现有观点的补充，并作为构建更高级和更现实的模型的基础。</p><p id="ea19" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们开始创建模型吧！</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nz"><img src="../Images/5f017ac9e7be16226b9ff2b6c3b07d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V0KfqgvsYURxARVIoZNbyQ.png"/></div></div></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="0ac7" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">背景—模型</h1><p id="6d96" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">选择正确的建模方法至关重要。我们希望估计受感染个体的数量以及控制措施如何影响它(包括<em class="ll">‘估计曲线’</em>和<em class="ll">‘使曲线变平’</em>部分)。只有利用<strong class="kr iu">和</strong>这两个估计值，我们才能够预测最佳控制策略。在这种情况下，最常用的方法是估计<strong class="kr iu"/><strong class="kr iu">房室流行病学模型，</strong>如<strong class="kr iu"/><strong class="kr iu"/><strong class="kr iu"/>易感-感染-去除(SIR)模型或其任何扩展。在本文中，我们不会深入探究基于SIR的模型背后的概念，因为它们已经在许多其他资料中广泛涉及(例如<a class="ae lm" rel="noopener" target="_blank" href="/infectious-disease-modelling-beyond-the-basic-sir-model-216369c584c4">这里</a>，或者<a class="ae lm" href="https://www.youtube.com/watch?v=jmfsSmHAQ2o" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="4d87" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们将使用一个<strong class="kr iu">扩展的易感-感染-移除模型</strong>。这将导致新型冠状病毒出现相当长的<em class="ll">潜伏期</em>，也将反映哪些受感染的个体<em class="ll">住院</em>并影响医疗系统的能力，以及哪些个体<em class="ll">康复</em>以及哪些<em class="ll">因病毒而死亡</em>。我们还将在模型中添加一个参数u(t ),它将反映控制措施的<em class="ll">强度(社交距离政策、锁定等)。与非药物干预相关的一切)。此外，我们的模型将有<em class="ll">变化的死亡率</em>，这将取决于医疗保健能力是否不堪重负。</em></p><p id="cd66" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">从这个意义上说，我们的模型中有6个区间:</p><ul class=""><li id="d3dc" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><strong class="kr iu">易感者:</strong>有被感染风险的个体。</li><li id="3491" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">暴露(E): </strong>已经感染，但尚未将病毒传播给他人的个体(这个额外的间隔反映了潜伏期)。</li><li id="6132" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">已感染(I): </strong>轻度感染并可将病毒传播给他人的个体。</li><li id="f069" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">住院(H): </strong>严重感染并需要医疗护理、医院床位或ICU(这种额外的隔间影响医疗保健系统的容量)的个人。</li><li id="69be" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">恢复(R): </strong>恢复并假定对病毒免疫的个体。</li><li id="ddda" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">死者(D): </strong>因病毒而去世的个体。</li></ul><p id="4bf8" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在房室模型中，个体根据时间和一些参数在房室之间转换。这些参数可以在<em class="ll">“比率-概率-人口”</em>流程图中进行描述，如<a class="ae lm" rel="noopener" target="_blank" href="/infectious-disease-modelling-beyond-the-basic-sir-model-216369c584c4">本文</a>:“比率描述过渡需要多长时间，人口是该过渡适用的一组个体，概率是个体发生过渡的概率”。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oa"><img src="../Images/76b9ad81f24ecb7f26ddb065fc170752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpX7MFcnq5ThmtnF0axYqA.png"/></div></div><p class="ob oc gj gh gi od oe bd b be z dk translated">流程图形式的模型</p></figure><p id="9a5d" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">从数学的角度来看，我们的模型是一个由6个常微分方程(ODE)组成的系统，每个方程代表给定固定的时间(t)变化时一个房室值的变化。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi of"><img src="../Images/59490a5d0d10b204b5f74dfb4b5b94f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WkDI6SuWvdx-vWUFWhZ_yg.png"/></div></div><p class="ob oc gj gh gi od oe bd b be z dk translated">颂歌形式的模型</p></figure><p id="f657" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">其中，对于流程图和ODE表示:</p><ul class=""><li id="cea8" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><strong class="kr iu"> S(t): </strong>时间t时易感人数</li><li id="9526" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">E(t):</strong>t时刻的暴露数(E)</li><li id="5749" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> I(t): </strong>在时间t感染的数量(I)</li><li id="2920" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">H(t):</strong>t时刻住院人数(H)</li><li id="14f3" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> R(t): </strong>在时间t恢复的数量(R)</li><li id="8e69" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> D(t): </strong>在时间t死亡人数(D)</li><li id="ca5e" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">人口总数。N = S + E + I + H + R + D在每个时间t。</li><li id="67cb" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">tInf (传染期):受感染个体可能将病毒传染给他人的时间段。</li><li id="851c" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"><em class="ll">β</em></strong><em class="ll">(</em>有效接触率):单位时间内个体之间导致感染的接触次数。也是病毒的基本繁殖数R0(总易感人群中一个感染个体平均感染多少个体)除以tInf。(<em class="ll"> beta </em>决定病毒传播的“速度”)。</li><li id="7bba" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> u(t) </strong>:控制措施的强度，直接降低<em class="ll">β</em>(注意:0 &lt; = u(t) &lt; = 1)。控制措施可能包括强化卫生协议、社交距离、封锁等。有<a class="ae lm" href="https://www.apple.com/covid19/mobility" rel="noopener ugc nofollow" target="_blank">苹果移动趋势</a>或者<a class="ae lm" href="https://www.google.com/covid19/mobility/" rel="noopener ugc nofollow" target="_blank">谷歌社区移动报告</a>，可以作为逼近u(t)的第一步。</li><li id="289c" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> tLat </strong>(潜伏期):个体只暴露于病毒，但不传染给他人的时间段。</li><li id="f200" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">那些影响医疗系统能力的人住院的时间。</strong></li><li id="661c" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">p mild:</strong><strong class="kr iu"/>感染时仅出现轻微症状的概率。</li><li id="832d" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">p死亡:</strong><strong class="kr iu"/>住院时死亡的概率。当医疗保健能力不堪重负，没有更多的病床或ICU可用时，该参数被认为具有相当高的值。在我们的模型中，它将是<strong class="kr iu"> H(t) </strong>(当前住院人数)和<strong class="kr iu"> Q </strong>(卫生保健系统能力)的函数。</li></ul><p id="5e6f" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们提供一个<strong class="kr iu">直观的例子</strong>来更清楚地解释这个模型是如何工作的。假设一个群体，其中有99个易感个体和1个受感染个体。这个人在时间t=1时，立即将其他人暴露于病毒(立即，因为这里的比率=1)。还有多少人——取决于<em class="ll">β</em>和种群中剩余易感个体的比例(S/N ),以及控制强度u(t)。所有暴露的个体，在潜伏期(tLat)后，也受到感染(所有，因为这里的概率= 1)，除了开始时的那个个体。反过来，他们开始将其他人暴露给病毒，导致病毒快速传播。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi og"><img src="../Images/494afec20036d710cf04923a67dc8fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j8mkecDvpNJrATdte3knXg.png"/></div></div></figure><p id="5a55" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在他们的感染期(tInf)过去后，他们中的一些人会过渡到康复期，一些人会出现更严重的症状并过渡到住院治疗(这取决于只出现轻微症状的概率——p mild)。从那里，在时间tHosp之后，他们可以以概率pFatal过渡到死亡间隔，或者以概率(1-pFatal)过渡到恢复间隔。如果在某个时间点发生医疗容量溢出，pFatal会显著增加，因为它是我们模型中的一个功能参数。</p><h1 id="2cfc" class="ln lo it bd lp lq oh ls lt lu oi lw lx jz oj ka lz kc ok kd mb kf ol kg md me bi translated">背景—控件</h1><h1 id="1c4d" class="ln lo it bd lp lq oh ls lt lu oi lw lx jz oj ka lz kc ok kd mb kf ol kg md me bi translated">什么是最优？</h1><p id="ecd8" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">我们定义了一个模型，它反映了<em class="ll">【估计曲线】</em><em class="ll">【拉平曲线】</em>部分，但它仍然缺乏最优控制。让我们假设，如果以下两个条件都满足，则控制强度u(t)在时间t是最优的:</p><ul class=""><li id="1890" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><strong class="kr iu">条件1。</strong> <strong class="kr iu">无医疗容量溢出。</strong>住院人数(H)应始终低于医疗能力(Q)。否则，如我们的模型中所定义的，pFatal参数增加，导致更多的致命病例。</li><li id="d5ea" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">条件二。控制强度u(t)最小。</strong>尽可能小，防止容量溢出。由于对经济和社会的不利影响，我们不想保持严格的控制太久。</li></ul><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi om"><img src="../Images/c161c8a78d6b46ba2b666f4bbeb58059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQndvpVb--cs1vwU3NXLnA.png"/></div></div></figure><ul class=""><li id="5b2b" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><strong class="kr iu">重要提示</strong>:疫情发生后，当人群获得足够程度的自然免疫(群体免疫)或足够数量的人群接种疫苗时，控制u(t)可能达到最小值，因此不存在第二波疫情的风险，因此不需要采取控制措施。然而，这里我们不考虑疫苗的发展，只考虑自然群体免疫，它被认为在发展后保持不变。</li></ul><p id="b013" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">因此，如果u(t)最小化<strong class="kr iu">容量溢出和控制措施</strong>，则u(t)可被认为是最优的。在数学上，如果u(t)最小化以下<strong class="kr iu">成本函数</strong> <strong class="kr iu"> C(u) </strong>，则u(t)在我们的模型中被认为是最优的:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi on"><img src="../Images/ed12c4115cadaa683fc3d3642c90b78a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bIpPVSSBuDyGJrLXOHA33A.png"/></div></div></figure><p id="af0b" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">其中:</p><ul class=""><li id="f12d" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><strong class="kr iu"> T </strong>:时间段总数</li><li id="61be" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu">H(t)</strong>:t期间住院人数(通过求解ODE系统得出)</li><li id="b8f0" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> Q(t) </strong>:医疗保健系统在t时期的能力(在我们的模型中，假设它是常数)</li></ul><p id="f0d1" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">下面的图表也说明了公式背后的想法。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oo"><img src="../Images/f6a92fbc1624a60ef6b3f7f48d5649c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0aTXp8m4jTT_gJWBfk8gWw.png"/></div></div></figure><p id="a309" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在成本函数<strong class="kr iu">的等式中，第一项</strong>占容量溢出曲线下的<em class="ll">区域，第二项<strong class="kr iu">占控制措施</strong></em>曲线下的<em class="ll">区域。通过最小化这些项的组合，我们确保定义的条件1和2都得到满足。但问题是——使用什么技术来最小化如此复杂的成本函数？</em></p><h1 id="9d6b" class="ln lo it bd lp lq oh ls lt lu oi lw lx jz oj ka lz kc ok kd mb kf ol kg md me bi translated">如何优化？</h1><p id="0b59" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">我们说过，我们需要为每个时间段<strong class="kr iu"> t </strong>选择这样的<strong class="kr iu"> u(t) </strong>，使得<strong class="kr iu"> C(u) </strong>(“我们控制的成本<strong class="kr iu"> u </strong>”)最小。当我们想要对一个2年的时间段建模时，其中T = 730天，我们需要选择730个不同u(t)的组合，这将最有效地最小化C(u)！这种类型的问题可能需要<strong class="kr iu">为大规模非线性动态优化定制的高级求解算法</strong>，这些算法本质上是复杂的，并且需要大量计算资源来找到精确的最优解。</p><p id="cb0d" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">然而，在本文中，我们将开发一种更简单的方法<strong class="kr iu"/>，它将在几秒钟内引导我们找到一个<em class="ll">非常近似的最优解</em>，消耗更少的资源并使用众所周知的Python库，如SciPy和Numpy。我们还将<strong class="kr iu">在“比较”部分将</strong>我们的解决方案与使用高级求解算法获得的更精确的解决方案进行比较。</p><p id="a169" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">因此，我们不是一次为整个<strong class="kr iu"> T </strong>找到几十个不同的<strong class="kr iu"> u(t) </strong>的正确组合，而是:</p><ol class=""><li id="977d" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk op nc nd ne bi translated">将时间段<strong class="kr iu"> T </strong>分割成相等的时间范围(<strong class="kr iu"> h </strong>)。</li><li id="e022" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk op nc nd ne bi translated">用固定的<strong class="kr iu"> u </strong>在单个层位上运行我们的模型，并测量我们的成本函数<strong class="kr iu"> C(u) </strong>的值。</li><li id="e5b1" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk op nc nd ne bi translated">基于测量—借助相对简单的最小化算法，调整我们的固定u，使<strong class="kr iu"> C(u) </strong>最小化。</li><li id="8de6" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk op nc nd ne bi translated">找到最小固定<strong class="kr iu"> u </strong>后，继续下一个层位，重复步骤2和3。同样的逻辑适用于所有的地平线。</li></ol><p id="6e02" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这种方法，当我们在模型运行期间根据它自己的测量结果调整我们的模型时，被称为简单<strong class="kr iu">模型预测控制</strong> (MPC)。在<a class="ae lm" href="https://www.youtube.com/watch?v=BTLZu-1IMcE" rel="noopener ugc nofollow" target="_blank">这里</a>的一系列视频中，可以很好地解释模型预测控制如何应用于新冠肺炎模型。</p><p id="f6dd" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们的方法也可以说明如下。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nz"><img src="../Images/4ee532eb69935156d0106d8fff4e4ea9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEGr1oDGXo-4u8ORIdnwzw.png"/></div></div></figure><p id="6f91" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在这里，我们将我们的时间段分为4个时间段。在第一个地平线t(h1)期间，我们看到，没有容量压倒的唯一<strong class="kr iu"> u </strong>是“强的”,因此应用它。在t(h2)处我们看到不再需要“强”控制<strong class="kr iu"> u </strong>，唯一同时满足条件1和条件2的<strong class="kr iu"> u、</strong>为“中”，于是我们将<strong class="kr iu"> u </strong>调整为“中”。类似地，在t(h3)处，我们看到,“弱”<strong class="kr iu"> u </strong>是唯一最优的，并将我们的<strong class="kr iu"> u </strong>调整到它。在t(h4)处，控制措施可以最终放松。</p><p id="4e4c" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这种方法相对简单，给了我们额外的灵活性。我们可以声明，我们将每周(h=7天)或每月等调整我们的<strong class="kr iu"> u </strong>。，这是一个<em class="ll">更现实的</em>控制策略。然而，这种简单性和灵活性是有代价的。为了得到一个近似的最优解，我们必须<em class="ll">仔细选择</em>我们控制干预的频率(f)和正确的控制范围(h)。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="ce02" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">编码——模型</h1><p id="9faa" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">让我们创建一个简单的Python类，它将存储模型所需的一切。我们类的<strong class="kr iu"> init </strong>方法:</p><ul class=""><li id="1e2a" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated">接受每个需要的参数，如R_0、tInf、tLat等。</li><li id="de15" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">有一个可选参数<em class="ll"> dt </em>(求解我们的ODE系统所需的步长)。例如，如果<em class="ll"> dt </em> = 0.1并且<em class="ll"> n_periods </em> =730天，我们将有730/0.1 = 7300个时间段，这在求解ODE时给了我们更好的精度。</li><li id="9251" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">有可选参数:<em class="ll"> rInf </em> —每天新感染个体的真实数据，<em class="ll"> rU </em> —控制强度的真实数据(u)。rInf数据可以允许我们将我们的模型的预测与真实数据进行比较，而rU也允许我们在已经应用了某种控制之后对最优控制进行建模。</li></ul><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="7f01" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">MSEIR类接受我们的所有参数，并执行一些需要立即执行的基本转换:</p><ul class=""><li id="8824" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated">它根据dt变换rInf和tU</li><li id="7052" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">它计算参数<em class="ll">β</em>(作为r0/tInf)</li><li id="dcd3" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">它基于n_periods和dt定义了我们的总体建模周期<strong class="kr iu"> t，</strong>。</li></ul><p id="bd0e" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">现在，让我们定义ODE系统，我们将在我们的模型中解决:</p><ol class=""><li id="808c" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk op nc nd ne bi translated">我们首先定义一个方法<strong class="kr iu"> _ovf </strong>。它将计算我们的功能参数<strong class="kr iu"> pFatal </strong>，假设该参数具有某个更高的值<strong class="kr iu"> — pOvf，</strong>，以防医疗容量溢出。</li><li id="e584" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk op nc nd ne bi translated">然后，我们在方法<strong class="kr iu"> _ode </strong>中定义我们的ODE系统。它接受cU(这是我们当前的控制措施强度u(t))和我们人口的初始条件数——易感、暴露、感染等个体的初始数量。隔间。</li></ol><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="f08a" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu"> _ode </strong>方法根据当前的给定值以及我们之前定义的所有参数和规则，计算下一个时间段我们的区间中的值。在数学方面，<strong class="kr iu"> _ode </strong>使用的技术是求解ode的简单数值欧拉法。可能有更复杂的技术，可以提供更高的精度，我们将<strong class="kr iu">在“比较”部分将</strong>我们的解决方案与它们进行比较。</p><p id="a2a4" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">从逻辑上讲，下一步是创建一个方法，该方法将为每个时间步长运行<strong class="kr iu"> _ode </strong>，以获得所有区间的预测值。这是通过方法<strong class="kr iu">求解</strong>完成的。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="65a3" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在这个方法中，我们首先用区间的初始值创建一个列表C的列表，稍后用下一个值填充它。我们还定义了<strong class="kr iu"> y </strong>和<strong class="kr iu"> Uf </strong>变量，负责识别U是固定的还是有一些关于控制措施的真实数据。此外，U根据模型中使用的步长dt进行变换。</p><p id="27ff" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">关键的解决技术在于循环的<em class="ll">。对于每个时间点t，我们选择必要的控制cU，并使用列表C中的最后值作为隔间的初始值，运行<strong class="kr iu"> _ode </strong>方法。我们将<strong class="kr iu"> _ode </strong>的结果存储在变量<strong class="kr iu"> nVal </strong>中，并将其追加到C表中，所以它们成为最后的值。在</em>循环的<em class="ll">结束后，我们得到最终解。</em></p><p id="46c5" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">该模型的完整代码如下所示。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="a06c" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">正如您所注意到的，我们当前的模型只有不到50行代码。请随意尝试！</p><h1 id="2133" class="ln lo it bd lp lq oh ls lt lu oi lw lx jz oj ka lz kc ok kd mb kf ol kg md me bi translated">编码—控制</h1><p id="b335" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">目前，该模型包括“估计曲线”和“平坦曲线”两部分。但是最优控制呢？要对它进行编码，我们需要SciPy，这是Python中科学计算的事实上的标准库。我们需要<em class="ll"> simps </em>方法来计算成本函数中的积分，以及<em class="ll"> minimize </em>方法来应用函数最小化算法。让我们将<strong class="kr iu">成本函数</strong>添加到我们的类中。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="6887" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">Method _ <strong class="kr iu"> costf，</strong>类似于求解方法，得到我们的ODE系统的解。但是它不是返回解决方案，而是基于该解决方案计算成本函数，并返回成本函数的值。它接受控制u(t)(作为x)和类似于<strong class="kr iu"> _ode </strong>方法的初始条件。这样的设计需要使用<em class="ll"> scipy.minimize </em>在上面。</p><p id="c77d" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">有了成本函数，让我们根据我们的简单模型预测控制框架修改我们的<strong class="kr iu">求解</strong>方法。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="6891" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">关键的修改在于for循环——U的优化仅在以下情况下开始:</p><ul class=""><li id="c434" class="mw mx it kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated">优化参数被设置为<em class="ll">真。</em></li><li id="cfbf" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated">在真实数据rInf中，当前时间<strong class="kr iu"> t </strong>超过<strong class="kr iu"> t </strong>(如果我们向我们的模型提供真实数据，并且想要在之后对最优控制进行建模)。</li><li id="1068" class="mw mx it kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><strong class="kr iu"> t </strong>与频率参数(freq)相匹配，因此如果我们将控制干预的频率设置为7天，则在t=7、t=14时将满足该条件，依此类推…</li></ul><p id="0da3" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">优化开始时-当前隔离专区值和优化时间范围(hor)存储在args变量中。Args和<strong class="kr iu"> _costf </strong>被提供给SciPy的<em class="ll">最小化</em>方法，该方法使用选定的最小化算法来寻找在给定控制范围(hor)期间<strong class="kr iu"> _costf </strong>在什么cU下具有最小值。我们还为cU设置了一些界限，因为我们的控制强度是一个值，总是在0和1之间。SciPy中适合我们的<strong class="kr iu">有界极小化问题</strong>的极小化算法有:<strong class="kr iu">‘L-BFGS-B’，‘TNC’，‘SLSQP’</strong>和<strong class="kr iu">‘trust-const’</strong>。在本文中，我们不会深究它们背后的数学原理，它们在这里<a class="ae lm" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize" rel="noopener ugc nofollow" target="_blank">有记录</a>。注意，对于我们的问题，<strong class="kr iu">‘SLSQP’</strong>似乎在收敛、精度和时间方面工作得更好，所以它被设置为默认值。</p><p id="46d2" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">此外，为了方便起见，我们的<strong class="kr iu"> solve </strong>方法将最终解决方案转换为Pandas DataFrame，并向其中添加一些附加数据:时间段、U和Q值、rInf数据和mInf数据，后者是模型预测的每日新感染个体的数据。它简单地计算为每个时间段易感人群的减少。</p><p id="46c0" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们的模型现在已经完全投入使用了。只是为了最终确定它，让我们添加一个产生代表性情节的方法。我们将使用一个<strong class="kr iu"> plotly </strong>库来产生可视化效果。为了方便起见，我们的<strong class="kr iu"> plot </strong>方法也将我们的时标t转换为从<em class="ll"> sdate </em>参数开始的真实日期。此外，您可以在size参数中指定绘图的大小，并在comps参数中指定要显示的隔离舱。</p><p id="7381" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这是我们的最佳控制和绘图模型的完整代码。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="a56a" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这是你可能得到的结果的例子。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="4e6d" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">第一个支线剧情，在顶部，是我们的控制措施强度u(t)，第二个支线剧情是我们的车厢值。这里，我们选择仅绘制感染、住院和死亡(I、H、D)以及医疗保健能力(Q)。最后一个子图显示了我们的模型(mInf)预测的以及输入真实数据(rInf)中陈述的每天的新感染病例，如果向模型提供了一个输入真实数据的话。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="ad42" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">使用案例</h1><p id="2e0b" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">假设有一个<em class="ll">城市X </em>，拥有<em class="ll"> 5 00万居民</em>的人口和<em class="ll">1万张病床和ICU的医疗保健能力</em>。2020年1月1日，第一个人似乎感染了具有新型冠状病毒特征的病毒(导致新冠肺炎)。所有的特征都在<a class="ae lm" href="https://arxiv.org/pdf/2004.09471.pdf" rel="noopener ugc nofollow" target="_blank">这篇</a>文章中作为一个整体:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ot"><img src="../Images/ab4b47a88617100d712d397d5b82ee3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gUbLp8AjfgM1jKMcck1Yg.png"/></div></div></figure><p id="68c2" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">不幸的是，流行病的爆发无法在一开始就被抑制，也没有疫苗。幸运的是，我们现在有了一个模型，它允许我们基于非药物干预(社交距离、面具、封锁等)来估计<em class="ll">不同的场景</em>和<em class="ll">最优控制策略</em>。).我们想为未来两年的可能结果建模。让我们用我们将在模型中使用的所有参数创建一个Python字典。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="914d" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">现在，让我们使用我们的模型，估计第一个非常简单的场景。</p><p id="78cb" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景1。【零点控制】</strong></p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="ef72" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在这种“无所事事”的情况下，<strong class="kr iu">我们没有任何控制权</strong>，因此没有与之相关的经济或社会成本。但在疫情结束时，我们有<strong class="kr iu"> 229，689人死亡</strong>，超过所有感染者的5%(死亡率为5.01%)。</p><p id="24de" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们看看，如果我们的目标是<em class="ll"/>使用恒定控制策略来“拉平曲线”，会发生什么。</p><p id="42cc" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">场景二。【恒控制】</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="ac2f" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这里，应用的控制措施是<strong class="kr iu"> ~ 0.55恒定</strong>(在最小水平以防止容量溢出)。我们看到，<strong class="kr iu">死亡人数</strong> <strong class="kr iu">大幅下降至42481</strong>(死亡率2.56%)。然而，有两个问题。首先，控制持续时间是无限的，因此<strong class="kr iu">封锁或任何其他措施可能永远不会放松</strong>。其次，这是这里唯一的场景，在最后没有获得<strong class="kr iu">群体免疫(最后易感/总种群<strong class="kr iu">&gt;</strong>1/基本繁殖数，通过<a class="ae lm" href="https://arxiv.org/pdf/2004.09471.pdf" rel="noopener ugc nofollow" target="_blank">这篇</a>文章中的公式)。因此，放松控制措施会引起新一轮的感染。</strong></p><p id="ca35" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">现在，让我们假设<strong class="kr iu">更现实的场景</strong>，在疫情爆发的前120天里，该市官员已经在<em class="ll">出台了一些控制措施</em>。让我们看看如果控制被立即移除会发生什么。</p><p id="c396" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景3:“从电流到零控制”</strong></p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="6e9a" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">所引入的控制措施起初是成功的，但随后在3月18日发生了容量溢出，不得不将它们增加到0.8个点。经过大约23天的严格控制，它开始被删除。这个场景展示了从第一个被感染的个体开始120天后，如果它下降到零会发生什么。在这里，控制在2020年4月29日结束。我们看到，在一次控制结束后不久，第二波感染发生，导致医疗能力严重过剩。最终，这一政策导致<strong class="kr iu">207112例死亡(4.72%病死率)</strong>，确实更接近‘完全零控制’情景1。</p><p id="c781" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">如果120天后官员突然透露如何最佳控制疫情会怎样？让我们考虑下一个场景。</p><p id="b435" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景4:“从当前到最佳控制”(最佳锁定出口)</strong></p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="bda4" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这里，在120天之后，在我们的模型中，控制趋向于尽可能的最优——每天发生<strong class="kr iu">最小控制干预</strong>，以便<strong class="kr iu">防止容量溢出</strong>。在这样一个封锁出口的完美案例中，与之前的场景(104，464对207，112个人)相比，死亡人数几乎减少了两倍。尽管<strong class="kr iu">总体控制比</strong>严格85%(就u项下的面积而言，889比480)，并且持续到2020年9月11日，与之前的场景相比，延长了125天。</p><p id="6246" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">就目前而言，我们考虑了两种情况，即官员们在疫情爆发的前120天采取了一些控制措施。但是如果官员们从一开始就有一个最优的控制政策呢？</p><p id="7d64" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景5:“恒定最优控制”</strong></p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="52fa" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这里从一开始就考虑完美最优控制的情况。每天审查控制力度，并引入最低要求的措施。在这种情况下，控制在2020年8月10日结束，死亡人数<strong class="kr iu">为93，526人</strong> <strong class="kr iu">，死亡率</strong>为2.56%。这里的关键点是<strong class="kr iu">致死率与持续控制的场景2 </strong>相同，但是控制的<strong class="kr iu">有限持续时间为179天</strong>，并且严格程度要低得多。此外，除了第二种情况，这种情况意味着死亡人数最少。</p><p id="a2f8" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">事实上，由于日常的精确干预，这种控制政策在实践中很难实施。如果官员们试图通过每个月左右的干预来实施最优控制政策<strong class="kr iu">会怎样？</strong></p><p id="e983" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景6:“现实最优控制”</strong></p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="8ff9" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这最后一个场景与之前的相似，但更现实的干预频率为43天。控制稍微严格一些(769比717，根据u下的面积)，并提前一周结束，在2020-08-02。<strong class="kr iu">死亡总人数为93632人</strong>，与<strong class="kr iu">相同，死亡率为2.56%</strong>。</p><p id="6c98" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">场景总结</strong></p><p id="a593" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">总共考虑了6种情况。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="08f5" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们提供一个表格，总结每个场景的关键指标。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ou"><img src="../Images/dadab3d9bd5d1d1a1ed0d671f359131e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rYPtPr8D3eSylj_Mf4txVQ.png"/></div></div></figure><p id="67a2" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">很明显，最优控制方案比其他方案有优势。通过最佳控制，与零控制(从229，689人减少到93，526人)相比，有可能<strong class="kr iu">在疫情结束时将死亡人数减少近60% </strong>。最优控制策略也具有与恒定无限控制相同的死亡率，但是它持续有限的时间，即179天，之后控制为零(T21)。此外，研究表明，每43天干预一次，而不是每1天干预一次，可以使最优控制策略<strong class="kr iu">更加实用</strong>，而且效果基本相同。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="528d" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">比较</h1><p id="8dbe" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">如前所述，对于常微分方程和大规模动态优化问题，都有更先进的求解算法。这里的文章<a class="ae lm" href="https://apmonitor.com/do/index.php/Main/COVID-19Response" rel="noopener ugc nofollow" target="_blank">就是一个很好的例子。那里的模型构建使用了Python库Gekko，它提供了一组用于大规模非线性动态优化的工具。该模型使用<strong class="kr iu">内点求解方法</strong>进行ODE和动态优化，其中显著的<strong class="kr iu"> IPOPT </strong>解算器在引擎盖下。</a></p><p id="c1ba" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们将使用该模型作为基准，但将通过添加住院和死亡区间对其进行修改，因此它将与我们当前的修改后的SEIR (MSEIR)模型具有完全相同的区间。这里是<a class="ae lm" href="https://github.com/aaasher/MSEIR" rel="noopener ugc nofollow" target="_blank">的完整代码进行比较。</a></p><p id="7815" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们对两个模型使用相同的一组参数，并比较结果。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="4540" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">下面是对比结果的图表。蓝线表示Gekko+IPOPT模型的解。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="os or l"/></div></figure><p id="9935" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">以及两种解决方案的主要结果的摘要表。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ov"><img src="../Images/477a70b0f5872452e060aa3c17a81190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMF-i9hTWTcO6uSmg1zfVw.png"/></div></div></figure><p id="5509" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">两个模型的U(t)曲线</strong>与<strong class="kr iu">相似</strong>，而Gekko+IPOPT模型产生的形状曲线更类似于<a class="ae lm" href="https://arxiv.org/pdf/2004.09471.pdf" rel="noopener ugc nofollow" target="_blank">这篇</a>文章，在这里计算出精确解。已故的最终值是两个模型之间的<strong class="kr iu">等于</strong>。此外，Gekko模型的求解时间，如其打印输出所示，等于<strong class="kr iu"> 27.409秒</strong>，而MSEIR模型需要<strong class="kr iu"> 1.182秒</strong>的挂钟时间来找到解。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="8720" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">结论</h1><p id="8c61" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">在本文中，我们估计了流行病模型，该模型包括最优控制措施，并回答了如何在考虑经济和社会成本的情况下<strong class="kr iu">“拉平曲线”</strong>以及如何以最优方式进入和退出封锁或任何其他控制措施的问题。我们考虑了一个城市的情况，在那里具有新型冠状病毒特征的病毒已经传播，并且没有预期的疫苗。</p><p id="e9c3" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们展示了最佳控制措施如何以最小的控制强度降低与疾病相关的死亡率。<strong class="kr iu">在179天的控制时间</strong>内，与“什么都不做”的情况<strong class="kr iu">相比，我们的最优控制策略产生的死亡病例减少了60%</strong>,此后，与恒定控制情况下的无限时间和无群体免疫相比，在群体中获得了群体免疫。我们还将最优控制调整为<strong class="kr iu">更实用的政策</strong>，大约每月执行一次控制干预，而不是完美最优控制场景中的每日干预。</p><p id="f61b" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我们用来估计最优控制的模型，虽然很简单，但它导致了一个<strong class="kr iu">很好的近似最优解</strong>，如比较部分所见。它的简单性也增加了好处:<em class="ll">对于这种大规模的动态优化问题，计算时间</em>惊人地快，以及<em class="ll">巨大的灵活性</em>，因为我们可以定义任何干预频率和控制范围，定制成本函数并添加变化的参数，如死亡率。</p><p id="0388" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr iu">该模型仍然充满了与确定性SIR框架和我们的简单模型预测控制方法相关的假设</strong>。我希望它能成为更先进的模型的起点，这些模型可以应用于真实的病例，并为现有流行病学模型的控制应用提供更多的信息。</p><p id="c112" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这里是模型、场景和比较的完整代码。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="8b9e" class="ln lo it bd lp lq lr ls lt lu lv lw lx jz ly ka lz kc ma kd mb kf mc kg md me bi translated">参考</h1><p id="7513" class="pw-post-body-paragraph kp kq it kr b ks mf ju ku kv mg jx kx ky mh la lb lc mi le lf lg mj li lj lk im bi translated">[1] M. Kantner，T. Koprucki，超越仅仅“使曲线变平”:用纯粹的非药物干预对流行病的最佳控制(2020年)，网址:<a class="ae lm" href="https://arxiv.org/pdf/2004.09471.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2004.09471.pdf</a></p><p id="e9d0" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">[2] APMonitor，新冠肺炎最优控制响应(2020)，网址:【https://apmonitor.com/do/index.php/Main/COVID-19Response T2】</p><p id="4bf0" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">[3] S .布伦顿，控制理论和新冠肺炎(2020)，网址:【https://www.youtube.com/watch?v=BTLZu-1IMcE T4】</p><p id="cfe2" class="pw-post-body-paragraph kp kq it kr b ks kt ju ku kv kw jx kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">[4] H. Froese，传染病建模:超越基本SIR模型(2020)，网址:<a class="ae lm" rel="noopener" target="_blank" href="/infectious-disease-modelling-beyond-the-basic-sir-model-216369c584c4">https://towardsdatascience . com/Infectious-Disease-modeling-Beyond-the-Basic-SIR-Model-216369 c584c 4</a></p></div></div>    
</body>
</html>