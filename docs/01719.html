<html>
<head>
<title>Reordering Pandas DataFrame Columns: Thumbs Down On Standard Solutions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重新排序熊猫数据框列:否定标准解决方案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reordering-pandas-dataframe-columns-thumbs-down-on-standard-solutions-1ff0bc2941d5?source=collection_archive---------6-----------------------#2020-02-17">https://towardsdatascience.com/reordering-pandas-dataframe-columns-thumbs-down-on-standard-solutions-1ff0bc2941d5?source=collection_archive---------6-----------------------#2020-02-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><figure class="it iu gq gs iv iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj is"><img src="../Images/f1201e995c2dca48d15ff77a518461a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tndjf2I6JvXtakNDqBXU2A.png"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">图片来源:“Via Design Pickle”——<a class="ae jh" href="https://adamrossnelson.medium.com/image-credit-attributions-a24efcc730ad" rel="noopener">更多关于属性</a>。</p></figure><div class=""/><div class=""><h2 id="8ed2" class="pw-subtitle-paragraph kh jj jk bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dk translated">简化更改数据帧列顺序过程的解决方案</h2></div><p id="4ea7" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">更新，2021 年 2 月，请看下面 YouTube 上的教程。</p><h1 id="9c97" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">介绍</h1><p id="ac9e" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi ms translated">成千上万的博客文章、stackoverflow.com 线程、quora.com 文章或其他资源展示了在 Pandas 数据框架中移动列(改变它们的顺序)的类似标准方法。</p><p id="175e" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">本文首先提供了示例数据。根据示例数据，文章传达了两个<em class="nb">好的</em> <em class="nb">但不完美的</em>标准解决方案。本文讨论了这些好的但不完美的标准解决方案的局限性。最后，有一个修正的解决方案，它避免了标准解决方案中固有的一些限制。</p><h1 id="1b58" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">示例数据</h1><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="79d8" class="nl lw jk nh b gz nm nn l no np">import pandas as pd</span><span id="d30a" class="nl lw jk nh b gz nq nn l no np"># Write some example data<br/>df = pd.DataFrame({'names':['Al','Myke','Lovie','Dash'], <br/>                   'Grade': [6,7,6,6],<br/>                   'Teacher':['Ogna','Hayes','Stoltz','Edens'],<br/>                   'Score':['A+','A-','B','C'],<br/>                   'Room':['Green','Red','Blue','Yellow'],<br/>                   'Hobby':['Coins','Stamps','Coins','Cards']})</span></pre><figure class="nc nd ne nf gu iw gi gj paragraph-image"><div class="gi gj nr"><img src="../Images/103aab4fe116bb03efd4239e37ec2248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*gWQMiyP809fl88eAHLhvZg.png"/></div><p class="jd je gk gi gj jf jg bd b be z dk translated">示例数据帧</p></figure><h1 id="40f8" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">标准解决方案(好)</h1><h2 id="166b" class="nl lw jk bd lx ns nt dn mb nu nv dp mf li nw nx mh lm ny nz mj lq oa ob ml oc bi translated">以新的所需顺序显式列出列</h2><p id="0bde" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi translated">对最常发布的列进行重新排序的解决方案是将 DataFrame 设置为等于其自身，但以新的所需顺序显式命名列:</p><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="d782" class="nl lw jk nh b gz nm nn l no np"># Reset DataFrame with columns in desired order<br/>df = df[['names','Score','Room','Grade','Teacher','Hobby']]</span></pre><p id="c77d" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">或者简单地评估具有以新的期望顺序明确命名的列的数据帧:</p><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="b93d" class="nl lw jk nh b gz nm nn l no np"># Evaluate the DataFrame with columns in desired order<br/>df[['names','Score','Room','Grade','Teacher','Hobby']]</span></pre><p id="0cbc" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">除非有几十或几百列，否则这种标准解决方案工作得很好。假设您有一个包含数十或数百列的数据框架，而您只希望移动一列。为了移动一列而显式列出所有列是低效的。列出所有列也是有问题的，因为对相关代码库的其他方面的更改可能会导致错误。对其他列名的添加、删除或修改会破坏标准解决方案的早期实现。</p><h2 id="78b6" class="nl lw jk bd lx ns nt dn mb nu nv dp mf li nw nx mh lm ny nz mj lq oa ob ml oc bi translated">利用简便的熊猫方法</h2><p id="f428" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi translated">的另一个标准解决方案是将<code class="fe od oe of nh b">pd.drop()</code>和<code class="fe od oe of nh b">pd.insert()</code>方法配对。此选项的主要限制是，它仅在一次将一列移动到特定位置时有效。</p><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="0a9d" class="nl lw jk nh b gz nm nn l no np">mid = df['Hobby']<br/>df.drop(labels=['Hobby'], axis=1, inplace = True)<br/>df.insert(1, 'Hobby', mid)<br/>df</span></pre><figure class="nc nd ne nf gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj og"><img src="../Images/959880261a889ee2dd50f08c0ee94e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOaowLnp-6P1YSNGw6BqGQ.png"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">爱好从索引位置 5 移动到索引位置 1。</p></figure><h1 id="2b76" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">修订的解决方案(更好)</h1><p id="fdcc" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi translated">仍然不完美，但对于许多用例来说，可能是更好的选择。</p><p id="cf19" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果您有许多列，它们彼此不相邻，并且您想要将它们全部移动到另一个特定列之后的新位置，该怎么办？也许您还想同时对列进行重新排序。以下是完成该任务的解决方案。</p><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="df57" class="nl lw jk nh b gz nm nn l no np">def movecol(df, cols_to_move=[], ref_col='', place='After'):<br/>    <br/>    cols = df.columns.tolist()</span><span id="4365" class="nl lw jk nh b gz nq nn l no np">    if place == 'After':<br/>        seg1 = cols[:list(cols).index(ref_col) + 1]<br/>        seg2 = cols_to_move<br/>    if place == 'Before':<br/>        seg1 = cols[:list(cols).index(ref_col)]<br/>        seg2 = cols_to_move + [ref_col]<br/>    <br/>    seg1 = [i for i in seg1 if i not in seg2]<br/>    seg3 = [i for i in cols if i not in seg1 + seg2]<br/>    <br/>    return(df[seg1 + seg2 + seg3])</span></pre><p id="5ac1" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">实施:</p><pre class="nc nd ne nf gu ng nh ni nj aw nk bi"><span id="8040" class="nl lw jk nh b gz nm nn l no np">df = movecol(df, <br/>             cols_to_move=['Score','Grade'], <br/>             ref_col='Room',<br/>             place='After')<br/>df</span></pre><figure class="nc nd ne nf gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj oh"><img src="../Images/1f037d113f3ba1900c1d765fd145de57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFBV73AiGihNDJrI-RgA2w.png"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">“分数”和“等级”列都颠倒了它们的顺序，移到了“房间”后面的索引位置。</p></figure><div class="it iu gq gs iv oi"><a href="https://adamrossnelson.medium.com/membership" rel="noopener follow" target="_blank"><div class="oj ab fp"><div class="ok ab ol cl cj om"><h2 class="bd jl gz z fq on fs ft oo fv fx jj bi translated">加入我的介绍链接媒体-亚当罗斯纳尔逊</h2><div class="op l"><h3 class="bd b gz z fq on fs ft oo fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oq l"><p class="bd b dl z fq on fs ft oo fv fx dk translated">adamrossnelson.medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow jb oi"/></div></div></a></div><h1 id="816c" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">结论</h1><p id="7aac" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi translated">概括地说，数据管理很难。在合并多个数据源之后，拥有一个可以快速排序和重新排序列的方法是很方便的。</p><p id="293b" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这样做是对未来审查你的工作的科学家的一种常见的礼貌。如果我们把最重要的栏目放在左边，其他人会花更少的时间寻找必要的信息来理解我们的工作。当我们知道我们将返回到我们的工作中以供将来参考时，这个额外的步骤对我们自己也是有帮助的。</p><h1 id="13c6" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">感谢阅读</h1><p id="2e3f" class="pw-post-body-paragraph kz la jk lb b lc mn kl le lf mo ko lh li mp lk ll lm mq lo lp lq mr ls lt lu in bi translated">如果你喜欢我要说的话，可以在:<a class="ae jh" href="https://twitter.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">adamrossnelson.medium.com</a>找到更多。</p><p id="e6e5" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">感谢阅读。把你的想法和主意发给我。你可以写信只是为了说声嗨。如果你真的需要告诉我是怎么错的，我期待着尽快和你聊天。推特:<a class="ae jh" href="https://twitter.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">@ adamrossnelson</a>| LinkedIn:<a class="ae jh" href="http://www.linkedin.com/in/arnelson" rel="noopener ugc nofollow" target="_blank">亚当·罗斯·纳尔逊</a> |脸书:<a class="ae jh" href="http://www.facebook.com/adamrossnelson" rel="noopener ugc nofollow" target="_blank">亚当·罗斯·纳尔逊</a>。</p><h1 id="93b9" class="lv lw jk bd lx ly lz ma mb mc md me mf kq mg kr mh kt mi ku mj kw mk kx ml mm bi translated">视频教程</h1><figure class="nc nd ne nf gu iw"><div class="bz fq l di"><div class="ox oy l"/></div><p class="jd je gk gi gj jf jg bd b be z dk translated">重新排序列，YouTube 上的教程。2021 年 2 月新增。</p></figure></div></div>    
</body>
</html>