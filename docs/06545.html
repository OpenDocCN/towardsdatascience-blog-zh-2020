<html>
<head>
<title>Generate OneDrive Direct-Download Link with C# or Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 C#或 Python 生成 OneDrive 直接下载链接</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-get-onedrive-direct-download-link-ecb52a62fee4?source=collection_archive---------17-----------------------#2020-05-24">https://towardsdatascience.com/how-to-get-onedrive-direct-download-link-ecb52a62fee4?source=collection_archive---------17-----------------------#2020-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f166" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为新冠肺炎数据集生成直接下载链接并导入熊猫数据框架的示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dd31e60dc33c9902120e4f87a70c05ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8Cj6OtGWw2xBngM2"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">插图作者:金彩云</p></figure><p id="ee42" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi lw translated"><span class="l lx ly lz bm ma mb mc md me di">在</span>许多项目中，您可能需要文件托管服务来共享大量数据集、脚本或任何带有直接下载选项的文件。你可能已经在使用最流行的托管服务，比如 Google Drive、微软 OneDrive、DropBox 和 iCloud。在这篇文章中，我将重点介绍如何从 OneDrive.com 的<strong class="lc iu">制作直接下载链接。</strong></p><h2 id="d7e9" class="mf mg it bd mh mi mj dn mk ml mm dp mn lj mo mp mq ln mr ms mt lr mu mv mw mx bi translated">为什么直接下载链接？</h2><p id="1858" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">直接下载可以让你在其他软件中灵活地使用这个文件。例如，如果您托管带有直接下载链接的 excel 或 csv 表数据集，接收者可以直接将其加载到 Python 中的 Pandas 数据框架。</p><h2 id="e44d" class="mf mg it bd mh mi mj dn mk ml mm dp mn lj mo mp mq ln mr ms mt lr mu mv mw mx bi translated">为什么选择 OneDrive？</h2><p id="eba6" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">我想我没有必要介绍那么多关于 OneDrive 的东西。它免费提供 5 GB 的存储空间。这对任何大型数据集来说都足够了。如果您有非常大的数据集要共享，请考虑数据库。你们大多数人甚至有微软 Office 365，其中包括 1 TB 的在线空间。此外，它很容易使用，分享，在线编辑。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="b624" class="mf mg it bd mh mi mj dn mk ml mm dp mn lj mo mp mq ln mr ms mt lr mu mv mw mx bi translated">我们开始吧</h2><h1 id="0f8b" class="nk mg it bd mh nl nm nn mk no np nq mn jz nr ka mq kc ns kd mt kf nt kg mw nu bi translated">共享你的 OneDrive 文件</h1><p id="9c8a" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">您只需转到 OneDrive，拖放到那里上传任何文件，单击页面顶部的“共享”按钮，然后单击复制链接。就是这样！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/577b1637cb04a47e307151bd1a8b2008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E_la-oRXF_HJ2l9OnTStJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nw">与微软 OneDrive </strong>共享 CSV 文件【全球新冠肺炎病例时间序列 <a class="ae nx" href="https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19_time_series" rel="noopener ugc nofollow" target="_blank"> <strong class="bd nw"> CSSE </strong> </a> <strong class="bd nw">】(作者)</strong></p></figure><p id="9377" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">例如，我通过 OneDrive 以 excel 表格的形式分享了来自 CSSE 的新冠肺炎时间序列数据集。当您通过您创建的链接访问该数据集时，浏览器将自动打开 Excel Online，以便您以表格格式浏览该数据集。多方便啊！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/d6c1bed04d0127b4863f6e9eceef9031.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMga6T4FMBlCVmw0PdIpuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nw">查看可分享的 CSV 文件【全球新冠肺炎病例时间序列来自</strong><a class="ae nx" href="https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19_time_series" rel="noopener ugc nofollow" target="_blank"><strong class="bd nw">CSSE</strong></a><strong class="bd nw">】来自 OneDrive 链接</strong>(作者)</p></figure><p id="d444" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">但是，不幸的是，如果您的接收者想要下载数据集，它需要几次点击或重定向。所以，如果你的目的是让你的接收者下载文件，你最好分享一个直接下载链接。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="0efb" class="nk mg it bd mh nl nz nn mk no oa nq mn jz ob ka mq kc oc kd mt kf od kg mw nu bi translated">生成 OneDrive 直接下载链接</h1><p id="9afa" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">根据<a class="ae nx" href="https://github.com/OneDrive/onedrive-api-docs/blob/master/shares/shares.md" rel="noopener ugc nofollow" target="_blank"> OneDrive API 文档</a>，您可以使用以下逻辑轻松生成 OneDrive 直接下载链接:</p><ol class=""><li id="4f67" class="oe of it lc b ld le lg lh lj og ln oh lr oi lv oj ok ol om bi translated">首先，使用 base64 编码 URL。</li><li id="6a58" class="oe of it lc b ld on lg oo lj op ln oq lr or lv oj ok ol om bi translated">通过删除值末尾的<code class="fe os ot ou ov b">=</code>字符，用<code class="fe os ot ou ov b">_</code>替换<code class="fe os ot ou ov b">/</code>，用<code class="fe os ot ou ov b">-</code>替换<code class="fe os ot ou ov b">+</code>，将 base64 编码的结果转换为<a class="ae nx" href="https://en.wikipedia.org/wiki/Base64" rel="noopener ugc nofollow" target="_blank">未填充的 base64url 格式</a>。)</li><li id="a0c5" class="oe of it lc b ld on lg oo lj op ln oq lr or lv oj ok ol om bi translated">追加<code class="fe os ot ou ov b">u!</code>作为字符串的开头。</li></ol></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="5d43" class="mf mg it bd mh mi mj dn mk ml mm dp mn lj mo mp mq ln mr ms mt lr mu mv mw mx bi translated">选项 1:用 C#生成直接下载链接</h2><p id="5760" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">为了遵循上述逻辑，OneDrive API 文档还为您提供了一个 C#示例脚本，如下所示:</p><pre class="kj kk kl km gt ow ov ox oy aw oz bi"><span id="1060" class="mf mg it ov b gy pa pb l pc pd">string sharingUrl = <strong class="ov iu">"Your OneDrive Link here";</strong><br/>string base64Value = System.Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(sharingUrl));<br/>string encodedUrl = "u!" + base64Value.TrimEnd('=').Replace('/','_').Replace('+','-');</span></pre><p id="15c4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">您可以尝试使用以下链接在 C#中在线运行该脚本:</p><div class="pe pf gp gr pg ph"><a href="https://rextester.com/QNSY6325" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">从 onedrive.com 获得直接链接，C# - rextester</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">用 C#从 onedrive.com 获得直接链接</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">rextester.com</p></div></div></div></a></div><p id="fd33" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">打开链接后，您只需将<code class="fe os ot ou ov b">sharingUrl</code>更改为您的任何一个 OneDrive 链接。等待几秒钟，然后您会在输出控制台中获得输出 direct OneDrive 下载链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/beac5d4179221582fd730c6ce1e01156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7WRHoCTQcDllKygJpjYw-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nw">从 onedrive.com 获得直接链接</strong>(作者)</p></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h2 id="1dc6" class="mf mg it bd mh mi mj dn mk ml mm dp mn lj mo mp mq ln mr ms mt lr mu mv mw mx bi translated">选项 2:用 Python 生成直接下载链接</h2><p id="79d8" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">Python 在许多数据科学项目中很受欢迎。因此，在对数据集进行数据分析之前，您可能希望直接在 Python 中生成一个直接下载链接。如果有人(或您自己)共享 OneDrive 链接，您可以使用以下 Python 脚本将其转换为可下载的链接:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pr ps l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae nx" href="https://gist.github.com/JoeThunyathep/5293f3bbdb87840b67aa027b4ee0b4d0" rel="noopener ugc nofollow" target="_blank"><strong class="ak">one drive _ DD _ generator . py</strong></a><strong class="ak"/>(作者)</p></figure><p id="793b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">例如，您可以按照下面的脚本以 excel 格式从我们的新冠肺炎数据集示例中生成直接下载链接。URL:<a class="ae nx" href="https://1drv.ms/x/s!AmLiprCs46qqhMgFb5pcJisePNNlXw?e=ZgPsGZ" rel="noopener ugc nofollow" target="_blank">https://1drv.ms/x/s!AmLiprCs46qqhMgFb5pcJisePNNlXw?e=ZgPsGZ</a>然后导入到熊猫数据框:</p><pre class="kj kk kl km gt ow ov ox oy aw oz bi"><span id="56cf" class="mf mg it ov b gy pa pb l pc pd"><strong class="ov iu">import pandas as pd </strong></span><span id="32fc" class="mf mg it ov b gy pt pb l pc pd"># Input any OneDrive URL <strong class="ov iu"><br/>onedrive_url = "</strong><a class="ae nx" href="https://1drv.ms/x/s!AmLiprCs46qqhMgFb5pcJisePNNlXw?e=ZgPsGZ" rel="noopener ugc nofollow" target="_blank"><strong class="ov iu">https://1drv.ms/x/s!AmLiprCs46qqhMgFb5pcJisePNNlXw?e=ZgPsGZ</strong></a><strong class="ov iu">"</strong></span><span id="eafd" class="mf mg it ov b gy pt pb l pc pd"># Generate Direct Download URL from above Script<br/><strong class="ov iu">direct_download_url = create_onedrive_directdownload(onedrive_url)<br/>print(direct_download_url)</strong></span><span id="bbf3" class="mf mg it ov b gy pt pb l pc pd"># Load Dataset to the Dataframe<br/><strong class="ov iu">df = pd.read_excel(direct_download_url)<br/>print(df.head())</strong></span><span id="c1f6" class="mf mg it ov b gy pt pb l pc pd"># Continue with your data analysis ...</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/80427a7d5392a671e8a2d79b74fb9a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URBfYAWv1_-p3BFDcTXZlw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nw">上面脚本的输出数据帧示例。</strong>(作者)</p></figure><h1 id="f903" class="nk mg it bd mh nl nm nn mk no np nq mn jz nr ka mq kc ns kd mt kf nt kg mw nu bi translated">结论</h1><p id="6331" class="pw-post-body-paragraph la lb it lc b ld my ju lf lg mz jx li lj na ll lm ln nb lp lq lr nc lt lu lv im bi translated">本文介绍了如何通过 OneDrive 分享你的文件，并用 C#或 Python 将其转为可直接下载的链接。请注意，您也可以使用 apply 这个逻辑并用任何其他编程语言重写它。</p><p id="ca8c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我希望你喜欢这篇文章，并发现它对你的日常工作或项目有用。如果您有任何问题或意见，请随时给我留言。</p><p id="fe8a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">关于我&amp;查看我所有的博客内容:<a class="ae nx" href="https://joets.medium.com/about-me-table-of-content-bc775e4f9dde" rel="noopener">链接</a></p><p id="ebe3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">祝<strong class="lc iu">平安</strong>和<strong class="lc iu">健康</strong>！💪</p><p id="2645" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">感谢您的阅读。📚</strong></p></div></div>    
</body>
</html>