<html>
<head>
<title>How to Easily Integrate Spreadsheets from Google Sheets, Dropbox and Your Desktop in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中轻松集成来自Google Sheets、Dropbox和你的桌面的电子表格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-easily-integrate-spreadsheets-from-google-sheets-dropbox-and-your-desktop-in-python-9f4065135449?source=collection_archive---------48-----------------------#2020-06-04">https://towardsdatascience.com/how-to-easily-integrate-spreadsheets-from-google-sheets-dropbox-and-your-desktop-in-python-9f4065135449?source=collection_archive---------48-----------------------#2020-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fb1b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">告别电子表格集成难题</h2></div><p id="edc0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">免责声明:这篇文章使用了我做的一个产品，</em> <a class="ae lc" href="http://www.apispreadsheets.com/" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> API电子表格</em> </a> <em class="lb">，我相信这确实是最简单的方法。你可以自己去看看。</em></p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/ec7eb61f3b73ee913113f29589644b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8I2qDi6nItkx2T2N.png"/></div></div></figure><p id="2601" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当你从事数据科学或分析项目时，通常到处都存储着大量的电子表格。</p><p id="b659" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你和我一样，你可能会这样做:</p><ol class=""><li id="b442" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la lu lv lw lx bi translated">下载你的谷歌工作表作为电子表格</li><li id="0cb6" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">下载你的Dropbox电子表格</li><li id="dab0" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">把它们和你的桌面文件放在同一个文件夹里</li><li id="f214" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">使用熊猫读取所有文件</li></ol><p id="06bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个不错的工作流程。但是营销部门的史蒂夫改变了谷歌表单中的一些数据。</p><p id="3b80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“不要担心”，您在重新下载表单并重新运行工作流程时回复。</p><p id="54f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，人力资源部的卡玛拉又给Dropbox添加了两个电子表格。</p><p id="0baf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“我明白了”，你一边慢慢冷静一边说。</p><p id="d446" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后你的老板告诉你把你所有的电子表格用电子邮件发给她，这样她就可以对你的数据进行三次检查。“哦，顺便说一句”，她说，“不要忘了使用我们副总裁力推的样式来更改所有电子表格的名称”</p><p id="8270" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你正式失去理智了。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi md"><img src="../Images/364b00be57394b8652d5d0ec43b5a27f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EcmgttxHsL1g-tiy"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">照片由<a class="ae lc" href="https://unsplash.com/@noahbuscher?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">诺亚·布舍尔</a>在<a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="c263" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">更简单的方法</h1><p id="391b" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">我将向您展示如何使用<a class="ae lc" href="http://apispreadsheets.com/" rel="noopener ugc nofollow" target="_blank"> API电子表格</a>和Python轻松地将所有这些来源的数据整合在一起。并保持更新和同步。这样你就能保持冷静和快乐！</p><p id="5fc2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用1个谷歌表，1个本地文件和1个Dropbox文件。每个文件将包含来自一个唯一美国州的Covid数据:TX、NJ或CA。数据将按县在每行上分解，如下所示:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/f86a6118e837014cc70c5ca6b99b5135.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/0*f_1DJZOEEKWGoZtS.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">来自NJ文件的样本数据。每个文件中的标题都是相同的</p></figure><p id="6747" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们开始吧！</p></div><div class="ab cl ng nh hu ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ij ik il im in"><h1 id="e1d4" class="mi mj iq bd mk ml nn mn mo mp no mr ms jw np jx mu jz nq ka mw kc nr kd my mz bi translated">步骤0:创建一个空的Python文件</h1><p id="02ab" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">创建一个名为<strong class="kh ir">spread sheet _ integration . py</strong>的空Python文件，并将其保存在某个地方。</p><p id="5838" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该文件的最终代码如下。我们将在这篇文章中介绍如何到达那里。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="ns nt l"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">最终文件代码</p></figure><h1 id="07aa" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">步骤1:创建一个API电子表格免费帐户</h1><p id="3c7c" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">前往<a class="ae lc" href="http://www.apispreadsheets.com" rel="noopener ugc nofollow" target="_blank">www.apispreadsheets.com</a>点击注册创建一个免费账户</p><h1 id="a55a" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">第二步:连接到你的谷歌表单</h1><p id="c253" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">点击谷歌表单上传框</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nu"><img src="../Images/7c8751faaea10133520126a1af9d721f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mgsOGPyFzkN-umHpPkr3NA.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">点击Google Sheets上传框开始连接</p></figure><p id="5b80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择您想要连接的Google表单</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/18e9df6d8368bb3099ea7ea51ac3fd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*wqzpDTHCh3Ds59aq5WOAzg.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">选择要连接的文件</p></figure><p id="e5f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从<strong class="kh ir"> Read </strong>选项卡中复制Python代码并粘贴到您的Python文件中</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nw"><img src="../Images/f186078f20884efc52f0836fc343d4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vcTBQ6Nh4lvnWbhiWfUMw.png"/></div></div></figure><p id="2b90" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的Python文件现在将包含以下代码</p><pre class="le lf lg lh gt nx ny nz oa aw ob bi"><span id="bbd6" class="oc mj iq ny b gy od oe l of og">import requests</span><span id="aba4" class="oc mj iq ny b gy oh oe l of og">r = requests.get("<a class="ae lc" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="20c8" class="oc mj iq ny b gy oh oe l of og">if r.status_code == 200:<br/>    # SUCCESS <br/>    data = r.json()<br/>else:<br/>    # ERROR<br/>    data=None</span></pre><p id="3aa3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在要改变代码中的两件事，使数据更容易处理</p><ol class=""><li id="1354" class="lp lq iq kh b ki kj kl km ko lr ks ls kw lt la lu lv lw lx bi translated">我们将从r.json()对象的数据键中访问数据</li><li id="a7a3" class="lp lq iq kh b ki ly kl lz ko ma ks mb kw mc la lu lv lw lx bi translated">我们将导入熊猫并将数据转换成熊猫数据框架</li></ol><p id="13d1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的代码现在将如下所示</p><pre class="le lf lg lh gt nx ny nz oa aw ob bi"><span id="0fe4" class="oc mj iq ny b gy od oe l of og">import requests<br/>import pandas as pd</span><span id="efaf" class="oc mj iq ny b gy oh oe l of og">r = requests.get("<a class="ae lc" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="1dd1" class="oc mj iq ny b gy oh oe l of og">if r.status_code == 200:<br/>    data = pd.DataFrame(r.json()["data"])<br/>else:<br/>    data = None</span></pre><blockquote class="oi oj ok"><p id="d872" class="kf kg lb kh b ki kj jr kk kl km ju kn ol kp kq kr om kt ku kv on kx ky kz la ij bi translated">这篇文章中的所有API链接都是公开的，所以请随意使用这些链接进行测试！</p></blockquote><h1 id="278e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">步骤3:连接到你的Dropbox文件</h1><p id="8f6b" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">点击Dropbox上传框。第一次点击会要求您进行身份验证，或者如果您的帐户已经在标签中打开，它会刷新页面。这是Dropbox身份验证的预期行为。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi oo"><img src="../Images/ee0f5631c258eda1a3bdae27eb746b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2l_tSXYHbTkF1nIwBCcQQ.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">点击Dropbox上传框开始流程</p></figure><p id="5292" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在再次点击Dropbox上传框，你会看到一个文件选择器。选择您的文件。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi op"><img src="../Images/4460a845398f9586d5887447d2edbdd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCJtKc3QT3FUTAWsK8ekNQ.png"/></div></div></figure><p id="a357" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按照与上面相同的步骤在文件中复制Python代码。</p><p id="3324" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，我们现在将更改请求和数据的名称，以便于识别</p><pre class="le lf lg lh gt nx ny nz oa aw ob bi"><span id="984f" class="oc mj iq ny b gy od oe l of og">import requests<br/>import pandas as pd</span><span id="ecba" class="oc mj iq ny b gy oh oe l of og">google_sheet_request = requests.get("<a class="ae lc" href="https://api.apispreadsheets.com/data/581/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/581/</a>")</span><span id="d4a2" class="oc mj iq ny b gy oh oe l of og">dropbox_request = requests.get("<a class="ae lc" href="https://api.apispreadsheets.com/data/582/" rel="noopener ugc nofollow" target="_blank">https://api.apispreadsheets.com/data/582/</a>")</span><span id="f220" class="oc mj iq ny b gy oh oe l of og">if google_sheet_request.status_code == 200:<br/>    google_sheet_data = pd.DataFrame(google_sheet_request.json()["data"])<br/>else:<br/>    google_sheet_data = None</span><span id="3fc1" class="oc mj iq ny b gy oh oe l of og">if dropbox_request.status_code == 200:<br/>    dropbox_data = pd.DataFrame(dropbox_request.json()["data"])<br/>else:<br/>    dropbox_data = None</span></pre><h1 id="c998" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">步骤4:从桌面上传文件</h1><p id="94cd" class="pw-post-body-paragraph kf kg iq kh b ki na jr kk kl nb ju kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">现在，我们将从您的桌面上传文件。</p><p id="e2df" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们不会再用这个过程来烦你了。只需点击<strong class="kh ir">上传或删除文件</strong>框，上传您的文件。</p><p id="fb2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按照与上面相同的步骤获取python代码，并将其插入到Python文件中。然后更改变量名，这样就有意义了。</p><p id="b7f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将引导我们找到最终的代码</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="ns nt l"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">原谅local_data上的缩进</p></figure><p id="6d0c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！这就是集成各种来源的电子表格数据有多容易。</p><p id="19e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最棒的是，如果底层的Google Sheet或Dropbox文件数据发生变化，那么你的数据会自动更新。</p><p id="5cc8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想和别人分享你的数据，你只需要给他们发送API链接。</p><p id="cdd7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">祝你整合之旅好运，如果你遇到任何麻烦或有任何问题，请随时给我在adhaar@lovespreadsheets.com留言。</p></div></div>    
</body>
</html>