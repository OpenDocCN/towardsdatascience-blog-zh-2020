<html>
<head>
<title>Breathing Life in to Power Apps with the Unsplash API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Unsplash API为应用注入活力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/breathe-some-life-in-to-power-apps-with-the-unsplash-api-450bb9473f1b?source=collection_archive---------45-----------------------#2020-06-10">https://towardsdatascience.com/breathe-some-life-in-to-power-apps-with-the-unsplash-api-450bb9473f1b?source=collection_archive---------45-----------------------#2020-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="afc7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在Microsoft Power Automate(又名Flow)中使用REST APIs向您的SharePoint列表中添加随机但非常漂亮的图片</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f4f357dfc88fe21243dd1d835297acf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KDGtO8Wm_ds8pFdg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">山顶上的新加坡樟宜机场。好照片让东西看起来更好。卡米尔·塔托尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e58b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看Power应用教程有点像看草生长。油漆干燥时。当你等着水壶烧开的时候。令人失望的是，你的“带按钮的SharePoint列表”看起来是如此乏味，这足以让任何人去喝锁定的杜松子酒和滋补品。</p><p id="fcac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要烦恼。我们可以偷别人的照片，让他们看起来很漂亮。</p><h1 id="dbac" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">电力应用程序很难看</h1><p id="1eeb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">下面是SharePoint 的经典无个性<a class="ae kv" href="https://docs.microsoft.com/en-us/powerapps/maker/canvas-apps/app-from-sharepoint" rel="noopener ugc nofollow" target="_blank">画布应用。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/b8d48c26bbd98b855719baea19594aef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2Sk6Ek8wfe9E-tzA96v0Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">评分一个为什么大家都觉得Power Apps很垃圾的例子(对不起微软)。它们只是看起来很单调。来自微软的教程<a class="ae kv" href="https://docs.microsoft.com/en-us/powerapps/maker/canvas-apps/app-from-sharepoint" rel="noopener ugc nofollow" target="_blank">来自SharePoint的画布应用</a>。</p></figure><p id="6e2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要误解我的意思，微软发布Power应用程序的速度比任何人了解它们的速度都快。他们可以做的事情并不缺乏，你可以延伸他们的长度。问题是，它们永远不会像你直接使用网络应用程序时那样好看(只要看看那些<a class="ae kv" href="https://themes.getbootstrap.com/" rel="noopener ugc nofollow" target="_blank">花哨的引导主题</a></p><p id="d391" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好吧，一个快速解决办法是添加一些图像，所以让我们开始从互联网的许多摄影师抢夺他们。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/6c4fd7fc24aa0af53b6d3ff596d9aefc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QdQijF3rPuoJRe1nCPjk0g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">游戏计划</p></figure><h1 id="f90c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">SharePoint列表图片字段</h1><p id="c45d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从微软教程中获取SharePoint列表，并添加一个“图片”类型的列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/c7e0c51ac7267dcc41f28490c0564ff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jkzg_43zgxtMzgJpfAfz4Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加图片栏。有时候，列名的灵感来之不易。</p></figure><p id="9663" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">添加或更新列表中的项目时，用户需要输入URL和可选文本字段。该字段的一个经典用例是使用它来存储您刚刚用<a class="ae kv" href="https://docs.microsoft.com/en-us/powerapps/maker/canvas-apps/controls/control-camera" rel="noopener ugc nofollow" target="_blank"> Power Apps相机控件</a>放下的冰淇淋的图像URL。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/02fcffebe2fdf1d0bc4f9fabf7ff2237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*N1tmer2GgtGwpCJtZPPRmQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">“图片”类型的SharePoint列表字段需要URL</p></figure><h1 id="73a5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">将非屏蔽URL放入列表</h1><p id="8fba" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这个想法是，我们从Unsplash获得这些带有一些搜索参数的URL。这将是很好的，如果这些是随机的(不要只是想一遍又一遍地相同的图片)，如果它自动完成。</p><p id="9f38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在微软的世界里，用Power Automate实现自动化是最容易的。计划是这样的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/9061d1f96cecbfbaf3bbe123f732c15e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0cjlPAlQ6_WS3buwC90Uw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用Power Automate的更明亮、更令人兴奋的Power应用程序的计划</p></figure><h2 id="3111" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">1 - <strong class="ak">创造权力自动化流程。</strong></h2><p id="a99e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当我们创建列表项时触发。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/e85016565777f51ba69f37aed7bc73dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6n0-eeN_4SxOwUvPOJFvFA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">当我们在枯燥的应用程序SharePoint列表中创建新项目时，就会触发Flow。</p></figure><h2 id="ba16" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">2 - <strong class="ak">获得不光彩的形象。</strong></h2><p id="3964" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用SharePoint项目的标题从Unsplash中检索照片的图像URL。</p><p id="e78b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://unsplash.com/documentation#list-photos" rel="noopener ugc nofollow" target="_blank">un splash文档</a>相当全面，可能有点让人不知所措。下面是一个使用HTTP连接器(注意这是一个高级连接器)搜索与SharePoint列表项相关的图片的示例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/4d7c4077354b9682015b1b72bccf7871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YxJlctY9VbmYi1lK_8eNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Client-ID后面的xxxxx应该替换为您的Unsplash应用程序访问密钥。为此，你需要<a class="ae kv" href="https://unsplash.com/developers" rel="noopener ugc nofollow" target="_blank">在Unsplash </a>上建立一个开发者账户，并注册一个应用程序。</p></figure><h2 id="3423" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">3 - <strong class="ak">解析Unsplash API </strong>返回的JSON。</h2><p id="8d2f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当我们更新SharePoint列表时，解析JSON允许使用响应中的字段。</p><p id="1f6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Power Automate可以通过“从样本生成”按钮为您找出JSON结构。将Unsplash响应的主体传递给该步骤的内容。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/b0d4d522cbe49272571f9d5e30c2814a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IYoORZSsb_NiWaVLCrxG1Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd nj"> Generate from sample </strong>将让Power Automate从示例响应中为您猜测模式。运行一个测试，从上面的HTTP请求中获得一个示例响应，或者使用<a class="ae kv" href="https://unsplash.com/documentation#get-a-random-photo" rel="noopener ugc nofollow" target="_blank">API文档响应</a>(但是去掉注释)</p></figure><p id="ff0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用于响应Unsplash HTTP请求的JSON模式在这里的<a class="ae kv" href="https://github.com/fredwise/unsplash_sharepoint_list/blob/master/power_automate_json_schema" rel="noopener ugc nofollow" target="_blank"> GitHub上</a>。这需要根据Power Automate自动生成的模式进行修改，以便允许字段为空(例如，Unsplash遗漏了Instagram关注者的数量)。通过为JSON模式中的每个值提供两种类型的数组(例如["string "，" null"]，而不仅仅是" string ")，每个字段都可以为空。做一个查找和替换，否则，你会在那里很长一段时间。</p><h2 id="2936" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">4 - <strong class="ak">使用SharePoint REST API请求SharePoint列表属性“ListItemEntityTypeFullName”。</strong></h2><p id="969f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">恼人的是，你不能在Power Automate中直接访问SharePoint列表“图片”字段。它们只是没有出现在<em class="nk">更新SharePoint项目</em>步骤中。</p><p id="2016" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没事的。我们可以使用SharePoint REST API来更新列表项，这里有更多的文档来解释SharePoint API是如何工作的。</p><p id="c1d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用Power Automate中的SharePoint HTTP请求步骤来访问SharePoint API，与一般的HTTP请求不同，这不是一个高级连接器。在这一步中，我们需要一个对列表的<strong class="ky ir">属性的GET请求。不要忘记解析这个返回的JSON。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/12b422c398f8d3307382d53716960a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sbTtBSADJcsVhAlyskipA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">获取SharePoint BoringAppList的ListItemEntityTypeFullName属性</p></figure><h1 id="9099" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">5 - <strong class="ak">更新SharePoint列表项目图片字段</strong></h1><p id="d220" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">SharePoint HTTP请求再次提供了帮助。这一次发送了一个POST请求，将我们之前响应中的Unsplash URL粘贴到创建/修改的项目的图片字段中。</p><p id="c9af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该请求中的标头非常重要。正文需要从SharePoint检索的ListItemEntityTypeFullName属性和从Unsplash检索的URL。这里使用了<em class="nk">小的</em>URL(400 x400 ),照片描述放在SharePoint图像的可选文本中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/7993ab0e43e9b1125c4d7e86214e8866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEZKtmb1ruvhyJ-8btM5Bg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">将请求发送到SharePoint API，该API将取消屏蔽URL放入列表项中</p></figure><p id="fa99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些副本和过去的友好位在GitHub的<a class="ae kv" href="https://github.com/fredwise/unsplash_sharepoint_list" rel="noopener ugc nofollow" target="_blank">上</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a5a3e732310e88b921192c8f242c5c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*y_lmlOlRmB4MzqckLOzqnw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">计划来了！</p></figure><h1 id="15df" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">不那么无聊的应用程序</h1><p id="f0cc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">正如你所看到的，一些图片会产生很大的不同。就我个人而言，我迫不及待地想记录我的下一个冰淇淋。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/38cced7be7995539744b68a4cfe840f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VWxFoFwid0sanv4idxc89Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从Unsplash添加随机图片带来了一点色彩，并可能赢得那些讨厌的用户。在Wise Technical，我们也制作适当的网络应用程序和数据平台，以最大限度地提高其商业效益。伸出手来！<a class="ae kv" href="https://www.wisetechltd.com/" rel="noopener ugc nofollow" target="_blank">https://www.wisetechltd.com/</a></p></figure><h2 id="623d" class="mu lt iq bd lu mv mw dn ly mx my dp mc lf mz na me lj nb nc mg ln nd ne mi nf bi translated">值得注意的琐事</h2><ul class=""><li id="15f4" class="np nq iq ky b kz mk lc ml lf nr lj ns ln nt lr nu nv nw nx bi translated">在Unsplash API上，每小时只能收到50个请求</li><li id="4b1e" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">不要将Sharepoint项目更新的POST请求中的内容类型设置为application/json(根据文档),而是将其设置为“application/JSON；odata=verbose "</li></ul></div></div>    
</body>
</html>