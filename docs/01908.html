<html>
<head>
<title>Analyzing global literacy rates data in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析巴西的全球识字率数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-global-literacy-rates-data-in-r-88062f813ad2?source=collection_archive---------29-----------------------#2020-02-22">https://towardsdatascience.com/analyzing-global-literacy-rates-data-in-r-88062f813ad2?source=collection_archive---------29-----------------------#2020-02-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="3fcb" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">数据</h1><p id="2abe" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我在<a class="ae lm" href="https://data.world/" rel="noopener ugc nofollow" target="_blank"> data.world </a>上偶然发现了一些非常有趣的数据集，其中引起我注意的是这个关于 2011 年至 2018 年全球识字率的数据集，按年龄组和性别进行了细分。如果你读过我以前的博客，那么所有的分析都将在 r 中完成。这次我不会解释我的代码，所以如果你想理解代码，最好有一些 r 的工作知识。</p><h1 id="a26e" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">设置</h1><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="16c5" class="lw jr it ls b gy lx ly l lz ma"><strong class="ls iu">library</strong>(tidyverse)<br/><strong class="ls iu">library</strong>(lubridate)<br/><strong class="ls iu">library</strong>(httr)<br/><strong class="ls iu">library</strong>(readxl)<br/><strong class="ls iu">library</strong>(extrafont)<br/><strong class="ls iu">library</strong>(hrbrthemes)<br/><strong class="ls iu">library</strong>(gghighlight)<br/><strong class="ls iu">library</strong>(ggtext)<br/><strong class="ls iu">library</strong>(ggmap)<br/><strong class="ls iu">library</strong>(scales)<br/><strong class="ls iu">loadfonts</strong>(device = "win")<br/><br/><strong class="ls iu">GET</strong>("https://query.data.world/s/ethf3e5hs6lv52vzvegp3g3qeeeloj", <strong class="ls iu">write_disk</strong>(tf &lt;- <strong class="ls iu">tempfile</strong>(fileext = ".xlsx")))</span><span id="c98a" class="lw jr it ls b gy mb ly l lz ma">literacy_data &lt;- <strong class="ls iu">read_excel</strong>(tf)</span></pre><h1 id="9591" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">分析</h1><h2 id="ab76" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">2018 年女性平均识字率最高的国家</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="57de" class="lw jr it ls b gy lx ly l lz ma">literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(Gender<strong class="ls iu">==</strong>"female") <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">filter</strong>(<strong class="ls iu">max</strong>(Year)<strong class="ls iu">==</strong>2018<strong class="ls iu">&amp;n_distinct</strong>(Year)<strong class="ls iu">&gt;=</strong>5,<br/>         <strong class="ls iu">mean</strong>(`Literacy rate`[Year<strong class="ls iu">==</strong>2018],na.rm = T)<strong class="ls iu">&gt;mean</strong>(`Literacy rate`[Year<strong class="ls iu">!=</strong>2018],na.rm = T)) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country,Year) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">summarise</strong>(Average_literacy_rate = <strong class="ls iu">mean</strong>(`Literacy rate`,na.rm = T)) <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(<strong class="ls iu">reorder</strong>(Country,Average_literacy_rate,mean),Average_literacy_rate,color=<strong class="ls iu">factor</strong>(Year)))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_point</strong>(size=9,alpha=0.4)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">coord_flip</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">gghighlight</strong>(Year<strong class="ls iu">==</strong>2018)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_percent</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_color_manual</strong>(values = <strong class="ls iu">c</strong>("2018"="firebrick"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme_minimal</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(x=NULL,y=NULL,title = "Countries that had peak average literacy rate in &lt;span style='color:firebrick'&gt;**2018**&lt;/span&gt;",<br/>       color=NULL)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme_ipsum_ps</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(plot.title = <strong class="ls iu">element_markdown</strong>(size=20,margin = <strong class="ls iu">margin</strong>(b = 10)))</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/5fbd9e16fd0d6e5c993fd0663a58b0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u6fiKfDXYeSAKrcx3mtFvg.png"/></div></div></figure><p id="f0b7" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">该图显示了与以往所有年份的平均水平相比，2018 年女性平均识字率最高的国家。南美洲的一些国家和阿根廷保持在 90%左右。其他拉美国家如巴西、墨西哥和哥伦比亚也显示出良好的增长势头。孟加拉国的女性识字率显著提高。<a class="ae lm" href="https://www.dhakatribune.com/bangladesh/education/2018/03/21/unesco-bangladesh-literacy-rate-reaches-time-high-72-76-2016" rel="noopener ugc nofollow" target="_blank">这可能是由于政府将教育支出增加了一倍，从 2008 年的 20 亿美元增加到 2016 年的 43 亿美元</a></p><h2 id="2b2d" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">各地区识字率的分布</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="49cd" class="lw jr it ls b gy lx ly l lz ma">world_avg &lt;- literacy_data <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">summarise</strong>(avg=<strong class="ls iu">mean</strong>(`Literacy rate`,na.rm = T)) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">pull</strong>(avg)<br/><br/><br/>literacy_data <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">group_by</strong>(Region) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">mutate</strong>(region_avg= <strong class="ls iu">mean</strong>(`Literacy rate`,na.rm = T)) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ungroup</strong>() <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(Region,`Literacy rate`,color=Age))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_jitter</strong>(alpha=0.7,size=3,height  = 0.2)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_hline</strong>(<strong class="ls iu">aes</strong>(yintercept=world_avg),color="grey40",size=0.9)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_segment</strong>(<strong class="ls iu">aes</strong>(x=Region,xend=Region,y=world_avg,yend=region_avg),color="black")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">coord_flip</strong>()<strong class="ls iu">+</strong><br/>  ggsci<strong class="ls iu">::scale_color_jama</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">stat_summary</strong>(fun.y = mean, geom = "point", size = 8,color="firebrick")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(<strong class="ls iu">aes</strong>(x=Region,y=region_avg,label=scales<strong class="ls iu">::percent</strong>(region_avg)),color="white",hjust=0.5,nudge_y = 0.01)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme_classic</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"),axis.title = <strong class="ls iu">element_text</strong>(size = 12),<br/>        axis.text.y = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed", size = 12),<br/>        panel.grid = <strong class="ls iu">element_blank</strong>(),<br/>        plot.title = <strong class="ls iu">element_text</strong>(size = 25,hjust = 0.5,family = "Roboto Condensed"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">annotate</strong>(geom = "text",x=7,y=1,label=<strong class="ls iu">paste0</strong>("Worldwide literacy average of\n",scales<strong class="ls iu">::percent</strong>(world_avg)),color="white")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_percent</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(x=NULL,title = "Distribution of literacy rate across regions")</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/3286ef6031b2752d3c87e29a8bf420ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xgDVjkiPjmO0tSfXBO8Nw.png"/></div></div></figure><p id="67c2" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">灰色垂直线代表全球平均识字率，红色大圆圈突出显示每个地区的平均识字率。与全球平均水平和其他地区相比，撒哈拉以南非洲、北非和西非、中亚和南亚等地区的平均识字率较低。毫不奇怪，年龄较大的人识字率普遍较低。</p><h2 id="6f4f" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">各年龄组的识字率趋势</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="cd67" class="lw jr it ls b gy lx ly l lz ma">avg_year &lt;- literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Year,Age) <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">summarise</strong>(avg=<strong class="ls iu">mean</strong>(`Literacy rate`,na.rm = T)) <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">ungroup</strong>()<br/><br/><br/>avg_year <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(Year,avg,color=Age))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_line</strong>(size=1.5)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_point</strong>(size = 2.6, <strong class="ls iu">aes</strong>(color = Age), shape = 15) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(data=avg_year <strong class="ls iu">%&gt;%</strong> <strong class="ls iu">group_by</strong>(Age) <strong class="ls iu">%&gt;%</strong> <strong class="ls iu">filter</strong>(Year<strong class="ls iu">==max</strong>(Year)),<strong class="ls iu">aes</strong>(label=Age),hjust=<strong class="ls iu">-</strong>0.5)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_color_manual</strong>(values = <strong class="ls iu">c</strong>("15-24"="#d20962","15+"="#005670","25-64"="#ce181e","65+"="#8a7967"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_percent</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(y=NULL,x=NULL,title = "Literacy rate trend across age groups")<strong class="ls iu">+</strong><br/>   <strong class="ls iu">theme</strong>(<br/>    text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"),<br/>    plot.margin = <strong class="ls iu">unit</strong>(<strong class="ls iu">rep</strong>(1.2, 4), "cm"),<br/>    plot.title = <strong class="ls iu">element_text</strong>(size = 20, <br/>                              color = "#22292F",<br/>                              face = "bold",<br/>                              margin = <strong class="ls iu">margin</strong>(b = 5)),<br/>    plot.subtitle = <strong class="ls iu">element_text</strong>(size = 15, <br/>                                 margin = <strong class="ls iu">margin</strong>(b = 35)),<br/>    plot.caption = <strong class="ls iu">element_text</strong>(size = 10,<br/>                                margin = <strong class="ls iu">margin</strong>(t = 25),<br/>                                color = "#606F7B"),<br/>    panel.background = <strong class="ls iu">element_blank</strong>(),<br/>    axis.text = <strong class="ls iu">element_text</strong>(size = 12, color = "#22292F"),<br/>    axis.text.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 5)),<br/>    axis.text.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 5)),<br/>    axis.line = <strong class="ls iu">element_line</strong>(color = "#3D4852"),<br/>    axis.title = <strong class="ls iu">element_text</strong>(size = 14),<br/>    axis.title.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 15),<br/>                                hjust = 0.5),<br/>    axis.title.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 15),<br/>                                hjust = 0.5),<br/>    panel.grid.major = <strong class="ls iu">element_line</strong>(color = "#DAE1E7"),<br/>    panel.grid.major.x = <strong class="ls iu">element_blank</strong>(),<br/>    legend.position = "none"<br/>  )</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/60f55d606524fb0353c154bbe530affb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DjQ_skHe7BYmAyt-0ixpSQ.png"/></div></div></figure><p id="6fa4" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">除了 2012 年所有年龄组的识字率急剧下降之外，这里没有什么有趣的东西可看</p><h2 id="e9b3" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">女性平均识字率高于男性平均识字率的国家</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="ef01" class="lw jr it ls b gy lx ly l lz ma">countries_female &lt;- literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(<strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>"female"],na.rm = T)<strong class="ls iu">&gt;mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>"male"]))<br/><br/><br/><br/>literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">semi_join</strong>(countries_female) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">summarise</strong>(avg_ltrcy_male = <strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>'male'],na.rm = T),<br/>            avg_ltrcy_female=<strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>'female'],na.rm = T)) <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">ungroup</strong>() <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(y=<strong class="ls iu">reorder</strong>(Country,avg_ltrcy_female),x=avg_ltrcy_male,xend=avg_ltrcy_female))<strong class="ls iu">+</strong><br/>  ggalt<strong class="ls iu">::geom_dumbbell</strong>( size=5, colour="grey",colour_x = "#005670",colour_xend = "#d20962")<strong class="ls iu">+</strong><br/>  ggrepel<strong class="ls iu">::geom_text_repel</strong>(<strong class="ls iu">aes</strong>(x=avg_ltrcy_female,label=<strong class="ls iu">percent</strong>(avg_ltrcy_female,accuracy = 1)))<strong class="ls iu">+</strong><br/>  ggrepel<strong class="ls iu">::geom_text_repel</strong>(<strong class="ls iu">aes</strong>(x=avg_ltrcy_male,label=<strong class="ls iu">percent</strong>(avg_ltrcy_male,accuracy = 1)))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(x=NULL,y=NULL,title = "Countries where female literacy rate is higher than male literacy rate")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_x_percent</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme_classic</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(<br/>    text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"),<br/>    plot.margin = <strong class="ls iu">unit</strong>(<strong class="ls iu">rep</strong>(1.2, 4), "cm"),<br/>    plot.title = <strong class="ls iu">element_text</strong>(size = 20, <br/>                              color = "#22292F",<br/>                              face = "bold",<br/>                              margin = <strong class="ls iu">margin</strong>(b = 5)),<br/>    plot.subtitle = <strong class="ls iu">element_text</strong>(size = 15, <br/>                                 margin = <strong class="ls iu">margin</strong>(b = 35)),<br/>    plot.caption = <strong class="ls iu">element_text</strong>(size = 10,<br/>                                margin = <strong class="ls iu">margin</strong>(t = 25),<br/>                                color = "#606F7B"),<br/>    panel.background = <strong class="ls iu">element_blank</strong>(),<br/>    axis.text = <strong class="ls iu">element_text</strong>(size = 12, color = "#22292F"),<br/>    axis.text.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 5)),<br/>    axis.text.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 5)),<br/>    axis.line = <strong class="ls iu">element_line</strong>(color = "#3D4852"),<br/>    axis.title = <strong class="ls iu">element_text</strong>(size = 14),<br/>    axis.title.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 15),<br/>                                hjust = 0.5),<br/>    axis.title.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 15),<br/>                                hjust = 0.5),<br/>    panel.grid.major = <strong class="ls iu">element_line</strong>(color = "#DAE1E7"),<br/>    panel.grid.major.x = <strong class="ls iu">element_blank</strong>(),<br/>    legend.position = "none")</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/acdc217e89221dffd386c4f204820e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQaubsuCVBV69k8y5Scd4w.png"/></div></div></figure><p id="0342" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">我很好奇哪些国家的女性平均识字率高于或等于男性平均识字率。这张图表上的大多数国家都是南美和非洲地区的小国，这确实令人惊讶。</p><h2 id="b70f" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">男女识字率差距最大的国家</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="ddaa" class="lw jr it ls b gy lx ly l lz ma">countries_male &lt;- literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(<strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>"female"],na.rm = T)<strong class="ls iu">&lt;mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>"male"]))<br/><br/><br/>literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">semi_join</strong>(countries_male) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">summarise</strong>(avg_ltrcy_male = <strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>'male'],na.rm = T),<br/>            avg_ltrcy_female=<strong class="ls iu">mean</strong>(`Literacy rate`[Gender<strong class="ls iu">==</strong>'female'],na.rm = T),<br/>            diff= avg_ltrcy_male<strong class="ls iu">-</strong>avg_ltrcy_female) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">top_n</strong>(20,diff)<strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(y=<strong class="ls iu">reorder</strong>(Country,avg_ltrcy_female),x=avg_ltrcy_male,xend=avg_ltrcy_female))<strong class="ls iu">+</strong><br/>  ggalt<strong class="ls iu">::geom_dumbbell</strong>( size=5, colour="grey",colour_x = "#005670",colour_xend = "#d20962")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(<strong class="ls iu">aes</strong>(x=avg_ltrcy_female,label=<strong class="ls iu">percent</strong>(avg_ltrcy_female,accuracy = 1)),vjust=<strong class="ls iu">-</strong>1)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(<strong class="ls iu">aes</strong>(x=avg_ltrcy_male,label=<strong class="ls iu">percent</strong>(avg_ltrcy_male,accuracy = 1)),vjust=<strong class="ls iu">-</strong>1)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_rect</strong>(<strong class="ls iu">aes</strong>(xmin=1,xmax=1.2,ymin=<strong class="ls iu">-</strong>Inf,ymax=Inf),fill="grey")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(<strong class="ls iu">aes</strong>(label=<strong class="ls iu">percent</strong>(diff,accuracy = 1), y=Country, x=1.1), fontface="bold", size=4)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(<strong class="ls iu">aes</strong>(x=1.1,y=20.5,label="Difference"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(x=NULL,y=NULL,title = "Top 20 countries with highest discrepency between &lt;span style='color:#005670'&gt;male&lt;/span&gt; and &lt;span style='color:#d20962'&gt;female&lt;/span&gt; literacy rates")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_discrete</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_x_percent</strong>(breaks = <strong class="ls iu">c</strong>(0.3,0.6,0.9),labels = <strong class="ls iu">c</strong>("30%","60%","90%"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme_classic</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(<br/>    text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"),<br/>    plot.margin = <strong class="ls iu">unit</strong>(<strong class="ls iu">rep</strong>(1.2, 4), "cm"),<br/>    plot.title = <strong class="ls iu">element_markdown</strong>(size = 20,margin = <strong class="ls iu">margin</strong>(b = 5)),<br/>    plot.subtitle = <strong class="ls iu">element_text</strong>(size = 15, <br/>                                 margin = <strong class="ls iu">margin</strong>(b = 35)),<br/>    plot.caption = <strong class="ls iu">element_text</strong>(size = 10,<br/>                                margin = <strong class="ls iu">margin</strong>(t = 25),<br/>                                color = "#606F7B"),<br/>    panel.background = <strong class="ls iu">element_blank</strong>(),<br/>    axis.text = <strong class="ls iu">element_text</strong>(size = 12, color = "#22292F"),<br/>    axis.text.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 5)),<br/>    axis.text.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 5)),<br/>    axis.line = <strong class="ls iu">element_line</strong>(color = "#3D4852"),<br/>    axis.title = <strong class="ls iu">element_text</strong>(size = 14),<br/>    axis.title.y = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(r = 15),<br/>                                hjust = 0.5),<br/>    axis.title.x = <strong class="ls iu">element_text</strong>(margin = <strong class="ls iu">margin</strong>(t = 15),<br/>                                hjust = 0.5),<br/>    panel.grid.major = <strong class="ls iu">element_line</strong>(color = "#DAE1E7"),<br/>    panel.grid.major.x = <strong class="ls iu">element_blank</strong>(),<br/>    legend.position = "none")</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/d85be384c6c8f7f2577825480c03bff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bhRZocn_l_wJ9d2klRVoZw.png"/></div></div></figure><p id="1b87" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">接下来，我想看看男女识字率差异最大的国家。对于审美，我只是根据两性差异的数值，可视化了前 20 名。同样，我们也可以在这里看到许多非洲国家和一些亚洲国家，比如巴基斯坦——我来自那里。非常有趣的是，在非洲有些国家，女性的平均识字率高于男性，但同时，在非洲有些国家，男性的识字率远远高于女性。</p><h2 id="dc20" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">在地图上将其可视化</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="7119" class="lw jr it ls b gy lx ly l lz ma">world &lt;- <strong class="ls iu">map_data</strong>(map = "world") <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">filter</strong>(region<strong class="ls iu">!=</strong>"Antartica")<br/><br/><br/><br/>long_lat &lt;- literacy_data <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">summarise</strong>(`Literacy rate`=<strong class="ls iu">mean</strong>(`Literacy rate`,na.rm = T)) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ungroup</strong>() <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">left_join</strong>(world,by = <strong class="ls iu">c</strong>("Country"="region")) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(<strong class="ls iu">!is.na</strong>(lat))<br/><br/><br/>p &lt;- <strong class="ls iu">ggplot</strong>() <strong class="ls iu">+</strong> <br/>  <strong class="ls iu">geom_map</strong>(data = world, map = world,<br/>           <strong class="ls iu">aes</strong>(long, lat, group = group, map_id = region),<br/>           fill = "#282828", color = "#282828") <strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_map</strong>(data = long_lat, map = world,<br/>           <strong class="ls iu">aes</strong>(fill = `Literacy rate`, map_id = Country),<br/>           color = "#282828", size = 0.5, alpha = .8) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_fill_gradient2</strong>(low = "#be0027", high = "#0a8ea0",mid = "#b4a996",midpoint = 0.6) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_continuous</strong>(breaks=<strong class="ls iu">c</strong>()) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_x_continuous</strong>(breaks=<strong class="ls iu">c</strong>()) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(x = "", y = "") <strong class="ls iu">+</strong><br/>  <strong class="ls iu">guides</strong>(<br/>    fill = <strong class="ls iu">guide_legend</strong>(title = "Literacy Rate")<br/>  ) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">coord_map</strong>("gilbert", xlim = <strong class="ls iu">c</strong>(<strong class="ls iu">-</strong>300, 300)) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(<br/>    title = "Global Literacy Rates"<br/>  ) <strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(<br/>    text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"),<br/>    plot.title = <strong class="ls iu">element_text</strong>(color = "#ffffff",<br/>                              margin = <strong class="ls iu">margin</strong>(t = 30, b = 10),<br/>                              size = 20),<br/>    plot.subtitle = <strong class="ls iu">element_text</strong>(color = "#ababab",<br/>                              margin = <strong class="ls iu">margin</strong>(b = 10),<br/>                              size = 15,<br/>                              hjust = 0.7),<br/>    plot.background  = <strong class="ls iu">element_rect</strong>(fill  = "#323232"),<br/>    panel.background = <strong class="ls iu">element_rect</strong>(fill  = "#323232", <br/>                                    color = "#323232"),<br/>    legend.position = "right",<br/>    legend.title = <strong class="ls iu">element_text</strong>(color = "#6d6d6d",<br/>                                size = 10),<br/>    legend.background = <strong class="ls iu">element_rect</strong>(fill = "#323232"),<br/>    legend.text = <strong class="ls iu">element_text</strong>(color = "#6d6d6d",<br/>                               size = 10)<br/>  )<br/><br/><br/>cowplot<strong class="ls iu">::ggdraw</strong>(p)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(plot.background = <strong class="ls iu">element_rect</strong>(fill = "#323232"))</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/7888415c56980b8bd6c725f5c9547804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qjcC10_nM467kJ3DWd1DUQ.png"/></div></div></figure><p id="69f3" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">我想尝试可视化地图上的数据，因为我从来没有这样做过。在深入研究细节之前，这有助于从全局层面了解数据</p><h2 id="d648" class="lw jr it bd js mc md dn jw me mf dp ka kz mg mh ke ld mi mj ki lh mk ml km mm bi translated">近距离观察巴基斯坦</h2><pre class="ln lo lp lq gt lr ls lt lu aw lv bi"><span id="ccfd" class="lw jr it ls b gy lx ly l lz ma">south_asia &lt;-literacy_data <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(Region<strong class="ls iu">==</strong>"Central and Southern Asia") <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Year,Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">summarise</strong>(avg_ltrcy=<strong class="ls iu">mean</strong>(`Literacy rate`)) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">ungroup</strong>() <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong> <br/>  <strong class="ls iu">filter</strong>(<strong class="ls iu">n</strong>()<strong class="ls iu">&gt;</strong>1)<br/><br/><br/>south_asia <strong class="ls iu">%&gt;%</strong><br/>  <strong class="ls iu">ggplot</strong>(<strong class="ls iu">aes</strong>(Year,avg_ltrcy))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_line</strong>(size=1.5,<strong class="ls iu">aes</strong>(color=Country))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">gghighlight</strong>(Country<strong class="ls iu">==</strong>"Pakistan",use_direct_label = F,use_group_by = F)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_color_manual</strong>(values = <strong class="ls iu">c</strong>("Pakistan"="#11862f"))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_text</strong>(data = south_asia <strong class="ls iu">%&gt;%</strong> <strong class="ls iu">group_by</strong>(Country) <strong class="ls iu">%&gt;%</strong><br/>              <strong class="ls iu">filter</strong>(Year<strong class="ls iu">==max</strong>(Year)) <strong class="ls iu">%&gt;%</strong> <strong class="ls iu">ungroup</strong>(),<strong class="ls iu">aes</strong>(label=<strong class="ls iu">paste0</strong>(Country,"-",<strong class="ls iu">percent</strong>(avg_ltrcy,accuracy = 1))),size=4,hjust=0,fontface="bold")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_x_continuous</strong>(breaks = <strong class="ls iu">seq</strong>(2010,2019,by = 1),limits = <strong class="ls iu">c</strong>(2010,2021))<strong class="ls iu">+</strong><br/>  <strong class="ls iu">annotate</strong>(geom = "text",x=2020,y=0.8,label="Between 75% and 100%",color="black",fontface="bold")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_rect</strong>(<strong class="ls iu">aes</strong>(xmin=2019,xmax=2021,ymin=0.75,ymax=1),fill="#3be8b0",alpha=0.05)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_rect</strong>(<strong class="ls iu">aes</strong>(xmin=2019,xmax=2021,ymin=0.5,ymax=0.75),fill="#56a0d3",alpha=0.05)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">annotate</strong>(geom = "text",x=2020,y=0.6,label="Between 50% and 75%",color="black",fontface="bold")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">geom_rect</strong>(<strong class="ls iu">aes</strong>(xmin=2019,xmax=2021,ymin=0,ymax=0.5),fill="#c90f23",alpha=0.05)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">annotate</strong>(geom = "text",x=2020,y=0.4,label="Less than 50%",color="black",fontface="bold")<strong class="ls iu">+</strong><br/>  <strong class="ls iu">scale_y_percent</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">labs</strong>(color=NULL,title = "Pakistan vs the rest of the region",x=NULL,y=NULL)<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(legend.position = "none")<strong class="ls iu">+</strong><br/>  bbplot<strong class="ls iu">::bbc_style</strong>()<strong class="ls iu">+</strong><br/>  <strong class="ls iu">theme</strong>(text = <strong class="ls iu">element_text</strong>(family = "Roboto Condensed"))</span></pre><figure class="ln lo lp lq gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mn"><img src="../Images/d53a6ef0dfefeacdfbe44c20c32d9728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xykYSbI6oojze29FT2GXug.png"/></div></div></figure><p id="a1cb" class="pw-post-body-paragraph ko kp it kq b kr mv kt ku kv mw kx ky kz mx lb lc ld my lf lg lh mz lj lk ll im bi translated">因为我来自巴基斯坦，我想看看我的国家与同一地区的其他国家相比如何。虽然总体趋势略有上升，但令人失望的是，巴基斯坦仅好于阿富汗，落后于其邻国，如印度、孟加拉国和伊朗。</p><h1 id="bdb4" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="0034" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这篇文章中，我试图让我的可视化更有创造性，而不是依赖于典型的条形图。我很惊讶地发现，有很多“较穷”的国家拥有很高的识字率。我希望有更多的数据可以帮助我们了解哪些因素影响一个国家的识字率，我们可以根据这些数据建立一个基于某种回归分析的模型。</p></div></div>    
</body>
</html>