# å¹¿ä¹‰çº¿æ€§æ¨¡å‹åˆ†è§£

> åŸæ–‡ï¼š<https://towardsdatascience.com/fitting-glms-by-hand-189c02af33a8?source=collection_archive---------10----------------------->

## ä½¿ç”¨æœ€å¤§ä¼¼ç„¶æ³•å’Œæ¢¯åº¦ä¸‹é™æ³•åœ¨ Python ä¸­ä»å¤´æ‹Ÿåˆ GLMs

![](img/70b9f0e46cf82a72269a9afa203db672.png)

åœ¨æ™®é€šçš„çº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬å°†ç»“æœå˜é‡è§†ä¸ºå‡ ä¸ªè¾“å…¥å˜é‡åŠ ä¸Šä¸€äº›éšæœºå™ªå£°çš„çº¿æ€§ç»„åˆï¼Œé€šå¸¸å‡è®¾ä¸ºæ­£æ€åˆ†å¸ƒã€‚è™½ç„¶è¿™ç§å»ºæ¨¡æ–¹æ³•æ˜“äºè§£é‡Šã€é«˜æ•ˆå®ç°ï¼Œå¹¶ä¸”èƒ½å¤Ÿå‡†ç¡®æ•æ‰è®¸å¤šçº¿æ€§å…³ç³»ï¼Œä½†å®ƒç¡®å®æœ‰ä¸€äº›æ˜æ˜¾çš„å±€é™æ€§ã€‚çº¿æ€§æ¨¡å‹çš„ç®€å•æ‰©å±•ï¼Œå¹¿ä¹‰çº¿æ€§æ¨¡å‹(GLM)èƒ½å¤Ÿæ”¾å®½çº¿æ€§å›å½’çš„ä¸€äº›æœ€ä¸¥æ ¼çš„å‡è®¾ã€‚è¿™äº›å‡è®¾åŒ…æ‹¬:

1.  ç»“æœå˜é‡å’Œè¾“å…¥å˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»
2.  è¯¯å·®é¡¹çš„æ­£æ€åˆ†å¸ƒ
3.  è¯¯å·®é¡¹çš„æ’å®šæ–¹å·®ã€‚

æ”¾å®½è¿™äº›å‡è®¾å…è®¸æˆ‘ä»¬å°†æ›´çµæ´»çš„æ¨¡å‹åº”ç”¨äºæ›´å¹¿æ³›çš„æ•°æ®ç±»å‹ã€‚

GLMs å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ R æˆ– Python è¿™æ ·çš„è¯­è¨€ç¼–å†™å‡ è¡Œä»£ç ï¼Œä½†æ˜¯è¦ç†è§£æ¨¡å‹æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œäº²è‡ªåŠ¨æ‰‹ç¼–å†™ä»£ç æ€»æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚æœ¬æ–‡å±•ç¤ºäº†å¦‚ä½•ä»…ä½¿ç”¨ Python çš„ Numpy åŒ…ä»å¤´å®ç° GLMsã€‚è¦äº†è§£æ›´å¤šå…³äº GLMs çš„åŸºç¡€å’Œç›´è§‰ï¼Œè¯·æŸ¥é˜…[è¿™ç¯‡æ–‡ç« ](/generalized-linear-models-9cbf848bb8ab)æˆ–[è¿™æœ¬ä¹¦](https://www.amazon.com/Generalized-Linear-Examples-Springer-Statistics/dp/1441901175)ã€‚

# GLM ç»“æ„

æ‹Ÿåˆ GLM é¦–å…ˆéœ€è¦æŒ‡å®šä¸¤ä¸ªç»„ä»¶:æˆ‘ä»¬çš„ç»“æœå˜é‡çš„éšæœºåˆ†å¸ƒå’Œåˆ†å¸ƒçš„å¹³å‡å‚æ•°ä¸å…¶â€œçº¿æ€§é¢„æµ‹å™¨â€ä¹‹é—´çš„*é“¾æ¥*å‡½æ•°ã€‚

## éšæœºæˆåˆ†

æ„å»º GLM çš„ç¬¬ä¸€æ­¥æ˜¯ç¡®å®šç»“æœå˜é‡çš„åˆ†å¸ƒã€‚å¦‚æœæ•°æ®æœ‰äºŒå…ƒå“åº”ï¼Œæˆ‘ä»¬å¯èƒ½è¦ä½¿ç”¨ä¼¯åŠªåˆ©æˆ–äºŒé¡¹å¼åˆ†å¸ƒã€‚å¦‚æœæˆ‘ä»¬æ­£åœ¨å¤„ç†è®¡æ•°æ•°æ®ï¼Œæ³Šæ¾æ¨¡å‹å¯èƒ½æ›´æœ‰ç”¨ã€‚é€šå¸¸å‡è®¾è¿™ç§åˆ†å¸ƒæ¥è‡ªäºæŒ‡æ•°åˆ†å¸ƒæ—ï¼ŒåŒ…æ‹¬äºŒé¡¹å¼ã€æ³Šæ¾ã€è´ŸäºŒé¡¹å¼ã€ä¼½ç›å’Œæ­£æ€åˆ†å¸ƒã€‚

è¿™äº›æ¨¡å‹ä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯ä»¥ç”¨å…¶å‡å€¼å‚æ•°ğœ‡ *= E(Y)* æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†äºŒé¡¹å¼æ¨¡å‹æŒ‡å®šä¸º *Y ~* Bin *(nï¼Œp)* ï¼Œä¹Ÿå¯ä»¥å†™æˆ *Y ~* Bin *(nï¼Œ* ğœ‡ */n)* ã€‚ä¸€æ—¦æˆ‘ä»¬ä¼°è®¡äº†ğœ‡ï¼Œæˆ‘ä»¬å°±å°† *Y* å»ºæ¨¡ä¸ºæ¥è‡ªğœ‡Ì‚æŒ‡æ•°åŒ–çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯¹ *Y* çš„é¢„æµ‹å€¼å°±æ˜¯ğœ‡Ì‚.

## é“¾æ¥åŠŸèƒ½

åœ¨ GLM ä¸­ï¼Œæˆ‘ä»¬å°†ğœ‡ä¼°è®¡ä¸ºâ€œçº¿æ€§é¢„æµ‹â€ğœ‚çš„éçº¿æ€§å‡½æ•°ï¼Œè€Œåè€…æœ¬èº«æ˜¯æ•°æ®çš„çº¿æ€§å‡½æ•°ã€‚è¿æ¥ğœ‡å’Œğœ‚çš„éçº¿æ€§å‡½æ•°è¢«ç§°ä¸º*é“¾æ¥*å‡½æ•°ï¼Œæˆ‘ä»¬åœ¨æ¨¡å‹æ‹Ÿåˆä¹‹å‰ç¡®å®šå®ƒã€‚é“¾æ¥å‡½æ•°è¢«å†™æˆğœ‡çš„å‡½æ•°ï¼Œä¾‹å¦‚ğœ‚ *= g(* ğœ‡).

å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹è®­ç»ƒæ•°æ®ï¼Œå…¶ä¸­æ¯ä¸ª **x** æ˜¯ä¸€ä¸ª D ç»´å‘é‡:

![](img/3ecee3003a28214b689f4803b76f2e79.png)

æˆ‘ä»¬é¦–å…ˆå°†ğœ‚å†™æˆå¯¹äºæ¯ä¸ªè§‚æµ‹å€¼ n = 1ï¼Œâ€¦ï¼Œn çš„çº¿æ€§å‡½æ•° **x** :

![](img/b5dd5d13eb98235b7ed072ee19d7bb9b.png)

ç„¶åæˆ‘ä»¬ç”¨é“¾æ¥å‡½æ•°å°†ğœ‚å’Œğœ‡è”ç³»èµ·æ¥:

![](img/9f211d8745c8b784c8bb82fac95e8d37.png)

# å®‰è£… GLM

ä¸ºäº†é€‚åˆ GLMï¼Œæˆ‘ä»¬å®é™…ä¸Šåªæ˜¯å¯»æ‰¾Î²s çš„ä¼°è®¡:ä»è¿™äº›ï¼Œæˆ‘ä»¬è·å¾—ğœ‚çš„ä¼°è®¡ï¼Œè¿™ç«‹å³å¯¼è‡´ğœ‡çš„ä¼°è®¡ï¼Œç„¶åç»™æˆ‘ä»¬ä¸€ä¸ª *Y çš„ä¼°è®¡åˆ†å¸ƒï¼*æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¼°ç®—Î²s:

1.  å°† y çš„åˆ†å¸ƒæŒ‡å®šä¸ºğœ‡.çš„å‡½æ•°
2.  æŒ‡å®šé“¾æ¥å‡½æ•°ï¼Œğœ‚ *= g(* ğœ‡).
3.  ç¡®å®šä¸€ä¸ªæŸå¤±å‡½æ•°ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨è´Ÿå¯¹æ•°ä¼¼ç„¶ã€‚æˆ‘ä»¬å¯ä»¥å°†æŸå¤±å‡½æ•°åˆ†è§£ä¸ºæ¯ä¸ªçº¿æ€§é¢„æµ‹å€¼å’Œç›¸åº”çš„çœŸå€¼ *Y* çš„å‡½æ•°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚
4.  é€šè¿‡é—­åˆè§£æˆ–æ¢¯åº¦ä¸‹é™æ³•ï¼Œæ‰¾å‡ºä½¿æŸå¤±å‡½æ•°æœ€å°çš„Î²å€¼ã€‚

![](img/4eee17299bccda3aa692fa1427c99a50.png)

# çº¿æ€§å›å½’â€”â€”GLM çš„ç‰¹ä¾‹

ä¸ºäº†åŠ å¼ºæˆ‘ä»¬å¯¹è¿™ç§ç»“æ„çš„ç†è§£ï¼Œè®©æˆ‘ä»¬é¦–å…ˆä»¥ GLM æ ¼å¼å†™å‡ºä¸€ä¸ªå…¸å‹çš„çº¿æ€§å›å½’æ¨¡å‹ã€‚ä½œä¸ºæ­¥éª¤ 1ï¼Œè®©æˆ‘ä»¬æŒ‡å®š *Y* çš„åˆ†å¸ƒã€‚å›æƒ³ä¸€ä¸‹ï¼Œå…¸å‹çš„çº¿æ€§æ¨¡å‹å‡è®¾

![](img/15c69b86378b5b1e9f61f15d1389e0a5.png)

å…¶ä¸­ **Î²** æ˜¯ç³»æ•°çš„é•¿åº¦ä¸º D çš„å‘é‡(å‡è®¾æˆ‘ä»¬å·²ç»ä¸ºæ¯ä¸ª **x** åŠ äº† 1ï¼Œå› æ­¤ **Î²** ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯æˆªè·é¡¹)ã€‚è¯·æ³¨æ„ï¼Œè¯¥åˆ†å¸ƒçš„å¹³å‡å€¼æ˜¯æ•°æ®çš„çº¿æ€§ç»„åˆï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ç­‰å¼æ ¹æ®çº¿æ€§é¢„æµ‹å€¼ç¼–å†™è¯¥æ¨¡å‹

![](img/ea8188c0ae0ad34eb2c9f0f4944e00e8.png)

ç„¶ååœ¨ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°è¿æ¥ğœ‡å’Œğœ‚.çš„å‡½æ•°åœ¨çº¿æ€§å›å½’çš„æƒ…å†µä¸‹ï¼Œå¾ˆç®€å•ã€‚ç”±äº *E(Y) =* ğœ‡ï¼Œå¹¶ä¸”æˆ‘ä»¬å»ºæ¨¡çš„ *Y* çš„å¹³å‡å€¼æ˜¯ğœ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ğœ‚ *= g(* ğœ‡) = ğœ‡ï¼

ç¬¬ä¸‰æ­¥:è®©æˆ‘ä»¬æ‰¾åˆ°è´Ÿçš„å¯¹æ•°å¯èƒ½æ€§ã€‚

![](img/b4e968f3307be269c109f08d84f1ea40.png)

æ³¨æ„ï¼Œæˆ‘ä»¬çš„æŸå¤±å‡½æ•°ä¸è¯¯å·®å¹³æ–¹å’Œæˆæ­£æ¯”ã€‚

æœ€åï¼Œå¯¹äºç¬¬ 4 æ­¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦å¯ä»¥åˆ†ææ€§åœ°æœ€å°åŒ–è¿™ä¸ªæŸå¤±å‡½æ•°ã€‚é¦–å…ˆå¯¹ **Î²** æ±‚å¯¼ï¼Œå¹¶å°†å…¶è®¾ä¸ºç­‰äº **0ã€‚**

![](img/83f123ebe67bd4c6dc272e04627747a1.png)

è¿™å°±ç»™å‡ºäº†æˆ‘ä»¬æ‰€ç†ŸçŸ¥å¹¶å–œçˆ±çš„æ¥è‡ªæ™®é€šçº¿æ€§å›å½’çš„é—­å¼è§£ã€‚

ç°åœ¨æ˜¯ç®€å•çš„ç¼–ç ã€‚è®©æˆ‘ä»¬éšæœºç”Ÿæˆä¸€äº›æ­£æ€åˆ†å¸ƒçš„ *Y* å€¼å¹¶æ‹Ÿåˆæ¨¡å‹ã€‚ä¸‹é¢çš„æ•£ç‚¹å›¾æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯¹ **Î²** çš„æ‹Ÿåˆå€¼éå¸¸æ¥è¿‘çœŸå®å€¼ã€‚

```
import numpy as np
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as snsnp.random.seed(123)## GENERATE STUFF ### Generate X
N = 1000  # number of observations
D = 10 # dimension of each observation
X = np.random.randn(N, D-1) # (minus 1 because we have to add the intercept)
intercept = np.ones(N).reshape(N, 1) 
X = np.concatenate((intercept, X), axis = 1)# Generate true beta
beta = np.random.randn(D)# Generate response as function of X and beta
y = X @ beta + np.random.randn(N)## FIT STUFF ##
beta_hat = np.linalg.inv(X.T @ X) @ X.T @ y## PREDICT STUFF ##
y_hat = X @ beta_hat## PLOT ##
fig, ax = plt.subplots()
sns.scatterplot(beta, beta_hat)
ax.set(xlabel = 'True Betas', ylabel = 'Estimated Betas', title = 'Beta vs. Beta Hats');
```

![](img/af9d87a2875c2127f9dc5c3af712f7e6.png)

# é€»è¾‘å›å½’â€”â€”äºŒå…ƒæ•°æ®çš„ GLM

åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬å°†è¾“å‡ºå»ºæ¨¡ä¸ºç‹¬ç«‹çš„ä¼¯åŠªåˆ©è¯•éªŒã€‚å³æˆ‘ä»¬å‡è®¾

![](img/8d0ea535cd3ab25f2bec393084e2e328.png)

è¿™å°±å®Œæˆäº†ç¬¬ä¸€æ­¥ã€‚å¯¹äºç¬¬ 2 æ­¥ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•å°†æˆ‘ä»¬çš„çº¿æ€§é¢„æµ‹å™¨ğœ‚ä¸æˆ‘ä»¬çš„å‚æ•°*p*è”ç³»èµ·æ¥ï¼Œå› ä¸º *p* åœ¨ 0 å’Œ 1 ä¹‹é—´ï¼Œè€Œğœ‚å¯ä»¥æ˜¯ä»»ä½•å®æ•°ï¼Œè‡ªç„¶çš„é€‰æ‹©æ˜¯å¯¹æ•°æ¦‚ç‡ã€‚å³ï¼Œ

![](img/5b4b31c678272f09c5f87e16f9fd99ce.png)

ç›¸åï¼Œæˆ‘ä»¬ä½¿ç”¨ sigmoid å‡½æ•°ä»ğœ‚å¾—åˆ° *p* (æˆ‘ç§°ä¹‹ä¸º S) *:*

![](img/63b8a25a83fef510b1e7ae75fe17356d.png)

è¿™å°±ç»“æŸäº†ç¬¬äºŒæ­¥ã€‚å¯¹äºç¬¬ 3 æ­¥ï¼Œæ‰¾å‡ºè´Ÿå¯¹æ•°ä¼¼ç„¶ã€‚

![](img/1a69209b92aee1064bd8c8ab7e180897.png)

è¿™å°±ç»™å‡ºäº†æˆ‘ä»¬çš„æŸå¤±å‡½æ•°ï¼Œå®Œæˆäº†ç¬¬ 3 æ­¥ã€‚å¯¹äºç¬¬ 4 æ­¥ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº† **Î²** çš„å€¼æ¥æœ€å°åŒ–è¿™ç§æŸå¤±ã€‚ä¸å¹¸çš„æ˜¯ï¼Œåœ¨é€»è¾‘å›å½’çš„æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å°é—­å½¢å¼çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä½¿ç”¨æ¢¯åº¦ä¸‹é™ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ‰¾åˆ°æŸå¤±å‡½æ•°ç›¸å¯¹äº **Î²** çš„å¯¼æ•°ã€‚é¦–å…ˆæ³¨æ„ *S'(x) = S(x)(1-S(x)):*

![](img/28de8cac1ffdff247bd4e62c7454bf71.png)

ç„¶åæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºæ•´ä¸ªæ¢¯åº¦:

![](img/894421e6b81a99373a724abbdc37777c.png)

ä¸ºäº†åŠ é€Ÿ Python ä¸­çš„è®¡ç®—ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒå†™æˆ

![](img/992fe8590e11b4e24efa17613439729e.png)

åœ¨å“ªé‡Œ

![](img/4694250143df6e799fceb098126073ae.png)

å’Œ

![](img/2f34b5c1360a6ceb99dadde576e7100c.png)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥æ‹Ÿåˆæ¨¡å‹ã€‚åŒæ ·ï¼Œä¸‹é¢çš„æ•£ç‚¹å›¾æ˜¾ç¤ºï¼Œæˆ‘ä»¬å¯¹ **Î²** çš„æ‹Ÿåˆå€¼éå¸¸æ¥è¿‘çœŸå®å€¼ã€‚

```
np.random.seed(123)## GENERATE Ys ### Generate response as a function of the same X and beta
# only now it's a Bernoulli r.v. 
def sigmoid(x):
    return 1/(1 + np.exp(-x))
p = sigmoid(X @ beta)
y = np.random.binomial(1, p)## FIT WITH GD ##
nruns = 10**5
learning_rate = 0.0001
beta_hat = np.random.randn(D) # initialize beta_hat estimates
p_hat = sigmoid(X @ beta_hat) # initialize p_hats
for run in range(nruns):
    # get gradient 
    a, b = y*(1-p_hat), (1-y)*p_hat 
    grad = X.T @ (b-a)
    # adjust beta hats
    beta_hat -= learning_rate*grad
    # adjust p hats
    p_hat = sigmoid(X @ beta_hat)## PLOT ##
fig, ax = plt.subplots()
sns.scatterplot(beta, beta_hat)
ax.set(xlabel = 'True Betas', ylabel = 'Estimated Betas', title = 'Beta vs. Beta Hats');
```

![](img/b6bb8726b2b9768c1be6c205b7dd22b8.png)

# æ³Šæ¾å›å½’-è®¡æ•°æ•°æ®çš„ GLM

æ³Šæ¾æ˜¯å¯¹è®¡æ•°ä¸­å‘ç”Ÿçš„æ•°æ®å»ºæ¨¡çš„ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ï¼Œä¾‹å¦‚é«˜é€Ÿå…¬è·¯ä¸Šçš„äº‹æ•…æˆ–å› é©¬è¸¢è€Œæ­»äº¡ã€‚

ç¬¬ä¸€æ­¥:å‡è®¾æˆ‘ä»¬æœ‰

![](img/ed64ef3a3bded217967c4f5a3fa18966.png)

ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬æŒ‡å®šé“¾æ¥å‡½æ•°ã€‚é“¾æ¥å‡½æ•°å¿…é¡»å°†éè´Ÿé€Ÿç‡å‚æ•°Î»è½¬æ¢ä¸ºçº¿æ€§é¢„æµ‹å€¼Î· âˆˆ â„.ä¸€ä¸ªå¸¸è§çš„åŠŸèƒ½æ˜¯

![](img/4d8cdd4d679b965218d8fd57f7581a08.png)

è¿™å½“ç„¶ä¹Ÿæœ‰è´Ÿé¢å½±å“

![](img/c1f33bedcfeb5d6e63bf31d55ca89c26.png)

ç°åœ¨è¿›è¡Œç¬¬ä¸‰æ­¥ï¼Œæ‰¾åˆ°è´Ÿçš„å¯¹æ•°å¯èƒ½æ€§ã€‚

![](img/77968b70a180b99f1f79699ccfb0d304.png)

ç¬¬å››æ­¥ï¼Œå¯¹ **Î²** è¿›è¡Œä¼˜åŒ–ã€‚

![](img/a2ed539ba2360073e77b175f231034fe.png)

ä¸å¹¸çš„æ˜¯ï¼Œæ²¡æœ‰å°é—­å½¢å¼çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å†æ¬¡è½¬å‘æ¢¯åº¦ä¸‹é™ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚å†ä¸€æ¬¡ï¼Œä¼°è®¡çš„å‚æ•°è¢«ç»˜åˆ¶æˆçœŸå®çš„å‚æ•°ï¼Œå¹¶ä¸”æ¨¡å‹å†ä¸€æ¬¡åšå¾—å¾ˆå¥½ã€‚

```
np.random.seed(123)## GENERATE Ys ### Generate response as a function of the same X and beta
# only now it's a Poisson r.v. 
beta = np.random.randn(D)/2
lam = np.exp(X @ beta)
y = np.random.poisson(lam = lam)## FIT WITH GD ##
nruns = 10**5
learning_rate = 0.00001
beta_hat = np.random.randn(D)/2 # initialize beta_hat estimates
lam_hat = np.exp(X @ beta_hat) # initialize lam_hatsfor run in range(nruns):
    # get gradient 
    c = y - lam_hat
    grad = X.T @ c
    # adjust beta hats
    beta_hat -= learning_rate*grad
    # adjust lambda hats
    lam_hat = np.exp(X @ beta_hat)## PLOT ##
fig, ax = plt.subplots()
sns.scatterplot(beta, beta_hat)
ax.set(xlabel = 'True Betas', ylabel = 'Estimated Betas', title = 'Beta vs. Beta Hats');
```

![](img/ced83158edbb2d84f1508b246948d29c.png)

åœ¨å®é™…æ„å»º GLMs æ—¶ï¼ŒPython ä¸­ R çš„`glm`å‘½ä»¤å’Œ statsmodels çš„`GLM`å‡½æ•°å¾ˆå®¹æ˜“å®ç°ï¼Œå¹¶ä¸”ç¼–ç¨‹æ•ˆç‡é«˜ã€‚ä½†æ˜¯ï¼Œç†Ÿæ‚‰ GLM çš„ç»“æ„å¯¹äºå‚æ•°è°ƒæ•´å’Œæ¨¡å‹é€‰æ‹©è‡³å…³é‡è¦ã€‚å½“è°ˆåˆ°å»ºæ¨¡æ—¶ï¼Œé€šå¸¸äº†è§£å¼•æ“ç›–ä¸‹æ˜¯ä»€ä¹ˆçš„æœ€å¥½æ–¹æ³•æ˜¯è‡ªå·±åˆ¶é€ æ±½è½¦ã€‚