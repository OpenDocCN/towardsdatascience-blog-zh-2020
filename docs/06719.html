<html>
<head>
<title>EfficientNet should be the goto pre-trained model orâ€¦</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">EfficientNetåº”è¯¥æ˜¯gotoé¢„è®­ç»ƒæ¨¡å‹æˆ–â€¦</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/efficientnet-should-be-the-goto-pre-trained-model-or-38f719cbfe60?source=collection_archive---------36-----------------------#2020-05-26">https://towardsdatascience.com/efficientnet-should-be-the-goto-pre-trained-model-or-38f719cbfe60?source=collection_archive---------36-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a423" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">æ¯”è¾ƒä¸åŒé¢„è®­ç»ƒæ¨¡å‹çš„æ—¶é—´å’Œå‡†ç¡®æ€§ï¼Œå¹¶æœ€ç»ˆåˆ›å»ºä¸€ä¸ªé›†æˆæ¥æé«˜ç»“æœã€‚</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2da3e663e8f47a04426805a3f93b5a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3gEMVXobSJ4kbW34"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä¹”æ©Â·æ³°æ£®åœ¨<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure><p id="f18c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸€å‘¨å‰æˆ‘è¿˜æ²¡æœ‰å¬è¯´è¿‡è¿™ä¸ªæœ¯è¯­ï¼Œç°åœ¨æˆ‘è®¤ä¸ºEfficientNetæ˜¯æœ€å¥½çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚åœ¨ä»–ä»¬çš„<a class="ae ky" href="https://arxiv.org/abs/1905.11946" rel="noopener ugc nofollow" target="_blank">è®ºæ–‡</a>ä¸­ï¼Œä»–ä»¬å·²ç»å±•ç¤ºäº†å®ƒçš„è‰ºæœ¯çŠ¶æ€ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ï¼Œå½“ä½ ä¸ºä¸€ä¸ªæ¨¡å‹é€‰æ‹©ä¸€ä¸ªä¸»å¹²æ—¶ï¼Œå®ƒæ˜¯å¦åº”è¯¥æ˜¯ä½ çš„é€‰æ‹©ã€‚æˆ‘å°†æŠŠå®ƒçš„æ€§èƒ½ä¸å¹¿æ³›ä½¿ç”¨çš„MobileNetã€Inceptionå’ŒXceptionè¿›è¡Œæ¯”è¾ƒï¼Œæ¯”è¾ƒçš„åŸºç¡€æ˜¯æ¯ä¸ªæ—¶æœŸè®­ç»ƒå’Œæ‰§è¡Œæ¨ç†æ‰€ç”¨çš„æ—¶é—´ï¼Œå½“ç„¶è¿˜æœ‰å‡†ç¡®æ€§ã€‚æˆ‘å†³å®šç”¨ä¸€åœº<a class="ae ky" href="https://www.kaggle.com/c/dogs-vs-cats-redux-kernels-edition" rel="noopener ugc nofollow" target="_blank">ç‹—å¯¹çŒ«</a>çš„Kaggleæ¯”èµ›æ¥åšæˆ‘çš„è£åˆ¤ï¼Œè®©ä¸€åˆ‡éƒ½è„±ç¦»æˆ‘çš„æŒæ§ã€‚åœ¨æˆ‘ä»¬å¼€å§‹æ¨¡å‹å’Œæ¯”è¾ƒä¹‹å‰ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºä»€ä¹ˆæ˜¯EfficientNetå’Œå®ƒçš„æ‰€æœ‰å…«ä¸ªæ¨¡å‹çš„æ¶æ„ï¼Œä½ å¯ä»¥å…ˆé˜…è¯»æˆ‘ä»¥å‰çš„æ–‡ç« ã€‚</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/complete-architectural-details-of-all-efficientnet-models-5fd5b736142"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">æ‰€æœ‰é«˜æ•ˆç½‘ç»œæ¨¡å‹çš„å®Œæ•´æ¶æ„ç»†èŠ‚</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">è®©æˆ‘ä»¬æ·±å…¥äº†è§£æ‰€æœ‰ä¸åŒé«˜æ•ˆç½‘ç»œæ¨¡å‹çš„ä½“ç³»ç»“æ„ç»†èŠ‚ï¼Œå¹¶æ‰¾å‡ºå®ƒä»¬çš„ä¸åŒä¹‹å¤„â€¦</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><h1 id="7102" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">ç›®å½•</h1><ol class=""><li id="3757" class="nf ng it lb b lc nh lf ni li nj lm nk lq nl lu nm nn no np bi translated">è¦æ±‚</li><li id="390a" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">åŠ è½½æ•°æ®é›†</li><li id="2f81" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">æ¨¡å‹</li><li id="441f" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu nm nn no np bi translated">ç»“æœ</li></ol><ul class=""><li id="6e93" class="nf ng it lb b lc ld lf lg li nv lm nw lq nx lu ny nn no np bi translated">è®­ç»ƒæ—¶é—´</li><li id="fc44" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu ny nn no np bi translated">æ¨ç†æ—¶é—´</li><li id="93f3" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu ny nn no np bi translated">æµ‹è¯•é›†ä¸Šçš„æ€§èƒ½</li></ul><p id="be1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.å…¨ä½“</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><h1 id="6a57" class="mn mo it bd mp mq og ms mt mu oh mw mx jz oi ka mz kc oj kd nb kf ok kg nd ne bi translated">è¦æ±‚</h1><p id="fef8" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">æ‚¨å°†éœ€è¦TensorFlow-Nightlyï¼Œå› ä¸ºEfficientNetçš„ç¨³å®šç‰ˆæœ¬å’ŒKaggleç›®å‰ä¸æ”¯æŒä¸‹è½½æ•°æ®é›†å’Œæäº¤ç»“æœã€‚æˆ‘å°†ä½¿ç”¨Google Colabï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ç¼–ç ï¼Œæ‰“å¼€ç¬”è®°æœ¬ï¼Œä¸è¦å¿˜è®°è¿æ¥åˆ°GPUã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="ccb4" class="ot mo it op b gy ou ov l ow ox">!pip install tf-nightly-gpu<br/>!pip install -q kaggle</span></pre><p id="2748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ‚¨å°†éœ€è¦ç”Ÿæˆä¸€ä¸ªKaggleçš„APIå¯†é’¥ã€‚ç¨‹åºå¦‚<a class="ae ky" href="https://adityashrm21.github.io/Setting-Up-Kaggle/" rel="noopener ugc nofollow" target="_blank">æ‰€ç¤ºï¼Œæ­¤å¤„ä¸º</a>ã€‚æ‰§è¡Œä¸‹é¢ç»™å‡ºçš„ä»£ç æ¥å®Œæˆè®¾ç½®ã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="7013" class="ot mo it op b gy ou ov l ow ox">! mkdir ~/.kaggle<br/>! cp kaggle.json ~/.kaggle/<br/>! chmod 600 ~/.kaggle/kaggle.json</span></pre><h1 id="86ce" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">åŠ è½½æ•°æ®é›†</h1><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="d006" class="ot mo it op b gy ou ov l ow ox">! kaggle competitions download -c 'dogs-vs-cats-redux-kernels-edition'<br/>! mkdir train<br/>! unzip train.zip -d train<br/>! mkdir test<br/>! unzip test.zip -d testimport ostrain_dir = os.path.join('/content/train', 'train')<br/>test_dir = os.path.join('/content/test', 'test')</span></pre><p id="cd50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå®šåˆ¶çš„æ•°æ®ç”Ÿæˆå™¨æ¥æ‰¹é‡åŠ è½½å›¾åƒï¼Œå¹¶å®šä¹‰äº†å‡ ä¸ªå›¾åƒå¢å¼ºå‡½æ•°ã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="dd7d" class="ot mo it op b gy ou ov l ow ox">def data_gen(img_names, bat ch_size):<br/>    c = 0<br/>    n = os.listdir(img_names) #List of training images<br/>    random.shuffle(n)while (True):<br/>        img = np.zeros((batch_size, 224, 224, 3)).astype('float')<br/>        labels = []for i in range(c, c+batch_size):<br/>            train_img = cv2.imread(os.path.join(train_dir, n[i]))<br/>            train_img =  cv2.resize(train_img, (224, 224))<br/>            train_img = train_img/255.if random.random() &lt; 0.25:<br/>                train_img = cv2.flip(train_img, 1)<br/>            rno = random.random()<br/>            if rno &lt; 0.1:<br/>                train_img = train_img[:196, :196, :]<br/>            elif rno &lt; 0.2:<br/>                train_img = train_img[28:, 28:, :]<br/>            elif rno &lt; 0.3:<br/>                train_img = train_img[28:, :196, :]<br/>            elif rno &lt; 0.4:<br/>                train_img = train_img[:196, 28:, :]<br/>            elif rno &lt; 0.5:<br/>                train_img = train_img[28:196, 28:196, :]<br/>            if rno &lt; 0.5:<br/>                train_img = cv2.resize(train_img, (224, 224), cv2.INTER_CUBIC)img[i-c] = train_img<br/>            if len(re.findall('dog', n[i])) == 1:<br/>                labels.append(1)<br/>            else:<br/>                labels.append(0)labels = np.array(labels)<br/>        c+=batch_size<br/>        if(c+batch_size&gt;=len(n)):<br/>            c=0<br/>            random.shuffle(n)<br/>        yield img, labelstrain_gen = data_gen(train_dir, batch_size)</span></pre><p id="75bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">å¦‚æœæ‚¨æƒ³äº†è§£å¦‚ä½•åˆ›å»ºæ›´å¤šçš„å›¾åƒå¢å¼ºåŠŸèƒ½ï¼Œè¯·å‚è€ƒæœ¬æ–‡ã€‚</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/complete-image-augmentation-in-opencv-31a6b02694f5"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">OpenCVä¸­çš„å®Œæ•´å›¾åƒå¢å¼º</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">è¿™æ˜¯ä¸€ç¯‡è¯¦å°½çš„æ–‡ç« ï¼Œé€šè¿‡ä½¿ç”¨OpenCVçš„è‡ªå®šä¹‰æ•°æ®ç”Ÿæˆå™¨ï¼Œæ¶µç›–äº†æ‰€æœ‰çš„å›¾åƒå¢å¼ºåŠŸèƒ½ã€‚</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="oy l mj mk ml mh mm ks ly"/></div></div></a></div><h1 id="cec1" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">æ¨¡å‹</h1><p id="52a0" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªéå¸¸åŸºæœ¬çš„æ¨¡å‹ï¼Œå³åŠ è½½é¢„è®­ç»ƒçš„ç½‘ç»œï¼Œå°†å…¶å±‚è®¾ç½®ä¸ºå¯è®­ç»ƒï¼Œæ·»åŠ ä¸€ä¸ªå…¨å±€å¹³å‡æ± å±‚å’Œä¸€ä¸ªå¯†é›†å±‚ã€‚æ‰€æœ‰çš„å±‚éƒ½è¢«è®¾ç½®ä¸ºå¯è®­ç»ƒçš„ï¼Œè¿™æ ·å³ä½¿æœ‰äº›å±‚åœ¨è¿™é‡Œè¢«å†»ç»“äº†ï¼Œä¹Ÿè¦èŠ±æœ€é•¿çš„æ—¶é—´æ¥è®­ç»ƒã€‚ä»–ä»¬å°†æ¥å—10ä¸ªçºªå…ƒçš„è®­ç»ƒã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="4d9d" class="ot mo it op b gy ou ov l ow ox">def create_model(base_model):<br/>    base_model.trainable = True<br/>    global_average_layer = tf.keras.layers.GlobalAveragePooling2D()(base_model.output)<br/>    prediction_layer = tf.keras.layers.Dense(1, activation='sigmoid')(global_average_layer)<br/>    model = tf.keras.models.Model(inputs=base_model.input, outputs=prediction_layer)<br/>    model.compile(optimizer=tf.keras.optimizers.Adam(lr=0.0001), loss=tf.keras.losses.BinaryCrossentropy(from_logits=True), metrics=["accuracy", "mse"])<br/>    return modeldef fit_model(model):<br/>    model.fit(train_gen, batch_size=batch_size, steps_per_epoch=25000 // batch_size, epochs=epochs)IMG_SHAPE = (224, 224, 3)<br/>model_mob = tf.keras.applications.MobileNetV2(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_inc = tf.keras.applications.InceptionV3(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_xcep = tf.keras.applications.Xception(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B0 = tf.keras.applications.EfficientNetB0(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B1 = tf.keras.applications.EfficientNetB1(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B2 = tf.keras.applications.EfficientNetB2(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B3 = tf.keras.applications.EfficientNetB3(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B4 = tf.keras.applications.EfficientNetB4(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")<br/>model_B5 = tf.keras.applications.EfficientNetB5(input_shape=IMG_SHAPE, include_top=False, weights="imagenet")fit_model(model_mob)<br/>fit_model(model_inc)<br/>fit_model(model_xcep)<br/>fit_model(model_B0)<br/>fit_model(model_B1)<br/>fit_model(model_B2)<br/>fit_model(model_B3)<br/>fit_model(model_B4)<br/>fit_model(model_B5)</span></pre><h1 id="ee27" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">ç»“æœ</h1><p id="02f8" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">å•Šç»ˆäºåˆ°äº†çœŸç›¸å¤§ç™½çš„æ—¶åˆ»äº†ã€‚ä½ ä¸€ç›´åœ¨ç­‰å¾…çš„éƒ¨åˆ†ã€‚</p><h1 id="b114" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">è®­ç»ƒæ—¶é—´</h1><p id="516a" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">è®°å½•ä¸‹è®­ç»ƒæ—¶æ¯ä¸ªæ—¶æœŸæ‰€ç”¨çš„æ—¶é—´ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="ad76" class="ot mo it op b gy ou ov l ow ox">+-----------------+-------------------------+<br/>|      Model      | Time per epoch (in sec) |<br/>+-----------------+-------------------------+<br/>| MobileNetV2     |                     250 |<br/>| InceptionV3     |                     400 |<br/>| Xception        |                     900 |<br/>| EfficientNet-B0 |                     179 |<br/>| EfficientNet-B1 |                     250 |<br/>| EfficientNet-B2 |                     257 |<br/>| EfficientNet-B3 |                     315 |<br/>| EfficientNet-B4 |                     388 |<br/>| EfficientNet-B5 |                     500 |<br/>+-----------------+-------------------------+</span></pre><p id="9e8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">(æœ€åä¸¤ä¸ªEfficientNetsåœ¨Colabä¸ŠæŠ›å‡ºå†…å­˜é”™è¯¯ï¼Œæˆ‘æ— æ³•è®­ç»ƒå®ƒä»¬ã€‚å¦‚æœä½ æƒ³åˆ›å»ºè¿™æ ·çš„è¡¨æ ¼ï¼Œä½ å¯ä»¥ä½¿ç”¨<a class="ae ky" href="https://ozh.github.io/ascii-tables/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ã€‚)EfficientNet-B0è½»æ¾å‡»è´¥æ‰€æœ‰äººï¼ŒXceptionæ˜¯æœ€æ…¢çš„ã€‚</p><h1 id="d9a8" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">æ¨ç†æ—¶é—´</h1><p id="27f3" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">ä¸ºäº†é¿å…å·®å¼‚ï¼Œæˆ‘åŠ è½½äº†ä¸€ä¸ªæµ‹è¯•å›¾åƒï¼Œå¹¶æµ‹é‡äº†é¢„æµ‹å®ƒçš„æ€»æ—¶é—´100æ¬¡ï¼Œå–å…¶å¹³å‡å€¼ã€‚ç»“æœå¦‚ä¸‹ã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="3f40" class="ot mo it op b gy ou ov l ow ox">+-----------------+-------------------------+<br/>|      Model      | Time per epoch (in sec) |<br/>+-----------------+-------------------------+<br/>| MobileNetV2     |                   0.034 |<br/>| InceptionV3     |                   0.049 |<br/>| Xception        |                   0.038 |<br/>| EfficientNet-B0 |                   0.041 |<br/>| EfficientNet-B1 |                   0.048 |<br/>| EfficientNet-B2 |                   0.049 |<br/>| EfficientNet-B3 |                   0.054 |<br/>| EfficientNet-B4 |                   0.061 |<br/>| EfficientNet-B5 |                   0.070 |<br/>+-----------------+-------------------------+</span></pre><p id="30b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç°åœ¨ï¼Œè¿™æ˜¯ä¸ªæƒŠå–œï¼æˆ‘æ›¾è§‰å¾—è®­ç»ƒæ—¶é—´ä¼šæŒ‡ç¤ºæ¨ç†æ—¶é—´ï¼Œä½†ä¸€ç‚¹ä¹Ÿä¸ã€‚MobileNetè¿™æ¬¡æ‹¿äº†è›‹ç³•ï¼Œç´§éšå…¶åçš„æ˜¯èŠ±äº†æœ€å¤šæ—¶é—´è®­ç»ƒçš„Xceptionã€‚æ•ˆç‡ç½‘æ¨¡å‹ä¸­çš„æ—¶é—´éšç€ä»£çš„å¢åŠ è€Œå¢åŠ ï¼Œè¿™æ˜¯éšç€å‚æ•°æ•°é‡çš„å¢åŠ è€Œé¢„æœŸçš„ã€‚</p><h1 id="2092" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">å‡†ç¡®(æ€§)</h1><p id="8aec" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">æˆ‘é€‰æ‹©ä¸åŒ…å«éªŒè¯é›†ï¼Œè¿™æ ·åœ¨Kaggleä¸Šæäº¤CSVæ–‡ä»¶åä¼šæœ‰æƒŠå–œã€‚ä½¿ç”¨çš„åº¦é‡æ ‡å‡†æ˜¯<a class="ae ky" href="https://www.kaggle.com/c/dogs-vs-cats-redux-kernels-edition/overview/evaluation" rel="noopener ugc nofollow" target="_blank">æµ‹äº•æŸå¤±</a>ã€‚å®ƒçš„ä»·å€¼è¶Šä½è¶Šå¥½ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/d68f3a29c0e098027748199a548b3761.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/0*6FoQdce0FfVemV8X.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="http://wiki.fast.ai/index.php/Log_Loss" rel="noopener ugc nofollow" target="_blank">æ¥æº</a></p></figure><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="84a0" class="ot mo it op b gy ou ov l ow ox">+-----------------+----------+<br/>|      Model      | Log loss |<br/>+-----------------+----------+<br/>| MobileNetV2     |    0.238 |<br/>| InceptionV3     |    0.168 |<br/>| Xception        |    0.111 |<br/>| EfficientNet-B0 |    0.205 |<br/>| EfficientNet-B1 |    0.160 |<br/>| EfficientNet-B2 |    0.122 |<br/>| EfficientNet-B3 |    0.137 |<br/>| EfficientNet-B4 |    0.126 |<br/>| EfficientNet-B5 |    0.125 |<br/>+-----------------+----------+</span></pre><p id="579c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¾‹å¤–è¡¨ç°æœ€å¥½ï¼ï¼ç´§éšå…¶åçš„æ˜¯å…¶ä»–EfficientNetæ¨¡å‹ï¼Œé™¤äº†EfficientNet-B0ï¼Œå®ƒçœŸæ­£çš„æ¯”è¾ƒå¯¹è±¡æ˜¯MobileNetV2ï¼Œå®ƒååˆ—å‰èŒ…ã€‚EfficientNet-B0å¯èƒ½æ˜¯ç§»åŠ¨æ¨¡å‹çš„æœ‰è¶£é€‰æ‹©ğŸ¤”ã€‚è¿™äº›ç»“æœè¡¨æ˜ï¼Œæ·±åº¦å­¦ä¹ ä»ç„¶åƒå½©ç¥¨ä¸€æ ·ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¡¨ç°å¾—æ›´å¥½(åœ¨å¯æ¯”æ¨¡å‹ä¸­è¡¨ç°è‰¯å¥½)ã€‚</p><h1 id="4c5b" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">å…¨ä½“</h1><p id="4edf" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li ol lk ll lm om lo lp lq on ls lt lu im bi translated">å½“æˆ‘çŸ¥é“EfficientNetæœ‰8ä¸ªæ¨¡å‹æ—¶ï¼Œæˆ‘æƒ³ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªæ•´ä½“æ¨¡å‹ï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚æˆ‘ä»¬å°†åˆ¶ä½œä¸¤ä¸ªé›†åˆæ¨¡å‹ï¼Œä¸€ä¸ªåŒ…å«MobileNetã€Inceptionå’ŒXceptionï¼Œå¦ä¸€ä¸ªåŒ…å«6ä¸ªEfficientNetæ¨¡å‹ã€‚æˆ‘ä»¬å°†åˆ›å»ºçš„é›†åˆå°†ä½¿ç”¨ANNæ¥ç»„åˆè¿™äº›æ¨¡å‹ã€‚æˆ‘å·²ç»å†™äº†ä¸€ç¯‡å…³äºå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„æ–‡ç« ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³äº†è§£å®ƒæ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œè¯·å‚è€ƒã€‚</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/destroy-image-classification-by-ensemble-of-pre-trained-models-f287513b7687"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">åŸºäºé¢„è®­ç»ƒæ¨¡å‹é›†æˆçš„ç ´åæ€§å›¾åƒåˆ†ç±»</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">é€šè¿‡åˆ¶ä½œé¢„è®­ç»ƒç½‘ç»œçš„é›†æˆå †å é›†æˆæ¨¡å‹ï¼Œå¦‚â€¦</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="pa l mj mk ml mh mm ks ly"/></div></div></a></div><p id="c7ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">åœ¨ä¸ºé›†åˆæ¨¡å‹åˆ›å»ºæ•°æ®ç”Ÿæˆå™¨è€Œä¸æ˜¯äº§ç”Ÿå››ç»´(æ‰¹é‡å¤§å°ã€å›¾åƒé«˜åº¦ã€å›¾åƒå®½åº¦ã€é€šé“)çš„NumPyæ•°ç»„æ—¶ï¼Œæˆ‘ä»¬åœ¨åˆ—è¡¨ä¸­ä¼ é€’å®ƒçš„æ¬¡æ•°ä½œä¸ºæ¨¡å‹çš„æ•°é‡ã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="4962" class="ot mo it op b gy ou ov l ow ox">img = np.zeros((batch_size, 224, 224, 3)).astype('float')<br/># looping and adding images to img<br/>img = [img]*no_of_models_in_ensemble</span></pre><p id="7151" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç°åœ¨åŠ è½½æ‰€æœ‰çš„æ¨¡å‹æ”¾å…¥é›†åˆä¸­ï¼Œå†»ç»“å®ƒä»¬çš„æƒé‡ï¼Œæ”¹å˜å±‚çš„åç§°ï¼Œè¿™æ ·æ²¡æœ‰ä¸¤å±‚æœ‰ç›¸åŒçš„åç§°ï¼Œæ·»åŠ ä¸€äº›å¯†é›†çš„å±‚æ¥åˆ›å»ºä¸€ä¸ªäººå·¥ç¥ç»ç½‘ç»œï¼Œè¿™å°±å®Œæˆäº†ã€‚</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="2a06" class="ot mo it op b gy ou ov l ow ox">def ensemble_model(models):<br/>    for i, model in enumerate(models):<br/>        for layer in model.layers:<br/>            layer.trainable = False<br/>            layer._name = 'ensemble_' + str(i+1) + '_' + layer.name<br/>    ensemble_visible = [model.input for model in models]<br/>    ensemble_outputs = [model.output for model in models]<br/>    merge = tf.keras.layers.concatenate(ensemble_outputs)<br/>    merge = tf.keras.layers.Dense(32, activation='relu')(merge)<br/>    merge = tf.keras.layers.Dense(8, activation='relu')(merge)<br/>    output = tf.keras.layers.Dense(1, activation='sigmoid')(merge)<br/>    model = tf.keras.models.Model(inputs=ensemble_visible, outputs=output)<br/>    model.compile(optimizer=tf.keras.optimizers.Adam(lr=0.001), loss=tf.keras.losses.BinaryCrossentropy(from_logits=True), metrics=["accuracy"])<br/>    return model</span></pre><p id="773c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ä¸¤ä¸ªé›†åˆæ¨¡å‹éƒ½è¢«è®­ç»ƒ10ä¸ªæ—¶æœŸï¼Œå¹¶ä¸”å®ƒä»¬çš„å¯¹æ•°æŸå¤±å€¼æ˜¯:</p><ul class=""><li id="4190" class="nf ng it lb b lc ld lf lg li nv lm nw lq nx lu ny nn no np bi translated">MobileNetã€Inceptionå’Œå¼‚å¸¸é›†åˆ:0.104</li><li id="c72b" class="nf ng it lb b lc nq lf nr li ns lm nt lq nu lu ny nn no np bi translated">æœ‰æ•ˆå‡€ç³»ç»¼:0.078</li></ul><p id="27ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ç¬¬ä¸€ä¸ªé›†åˆæ¨¡å‹ç¡®å®æœ‰æ‰€æ”¹è¿›ï¼Œä½†æ²¡æœ‰é‚£ä¹ˆå¤šã€‚ç„¶è€Œï¼Œæœ‰æ•ˆç½‘ç»œé›†åˆæœ‰äº†å¾ˆå¤§çš„æé«˜ã€‚</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="a140" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">æ¯”è¾ƒæ‰€æœ‰è¿™äº›ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¸èƒ½æŠ¹æ€å…¶ä»–æ¨¡å‹ç›¸æ¯”ï¼Œæœ‰æ•ˆçš„ç½‘ç»œå’Œæé«˜åˆ†æ•°çš„ç«äº‰é›†æˆæ˜¯ä¸€æ¡è·¯è¦èµ°ã€‚</p></div></div>    
</body>
</html>