<html>
<head>
<title>Adding Cloud-Based Deep-Learning Object Detection Capability to Home Surveillance Camera Systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为家庭监控摄像机系统添加基于云的深度学习对象检测功能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/adding-cloud-based-deep-learning-object-detection-capability-to-home-surveillance-camera-systems-df797a0dd6f?source=collection_archive---------41-----------------------#2020-06-14">https://towardsdatascience.com/adding-cloud-based-deep-learning-object-detection-capability-to-home-surveillance-camera-systems-df797a0dd6f?source=collection_archive---------41-----------------------#2020-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bdfd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从 Jupyter 到无服务器 Web 应用的实用深度学习</h2></div><p id="32d8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我最近在我的房子周围安装了一个配备了四个摄像头和一个网络录像机(NVR)的监控系统。不幸的是，几乎所有的假警报都是由移动的植物或树影或松鼠触发的。这些警报都不能被系统自带的传统图像处理功能过滤掉。</p><p id="850b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">像大多数深度学习实践者一样，我知道对象检测程序可以过滤掉这些错误警报。但它们要么需要一份昂贵的商业合同，要么需要一台连接我家庭网络的电脑。因为我想保持低成本，拥有一台电脑似乎是正确的选择。然而，这仍然是一笔相当大的初始资本投资，外加经常性的 24/7 电力成本。计算机还需要安装、维护和货架空间。它的风扇噪音或壁橱散热是另一个我不喜欢在家里处理的废话。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/9921790f747756ef7e637f6fcaf77c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*9thwZngctnP9mlIjlwt95w.png"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">大多数假警报只是由移动的树荫和植物触发的。使用传统的图像处理技术，例如调整对比度阈值或设置活动区域，无法滤除这些错误警报</p></figure><p id="53bb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过进一步研究，我发现使用无服务器 web APIs 是最好的解决方案。它不仅反应迅速，而且根据使用情况收取很少的费用。我还想自己优化深度学习算法，或者为高级深度学习应用重新配置实现。因此，我选择了运行在 AWS 上的 MXNet。这种结合允许使用 Jupyter 进行简单的深度学习代码开发，优化的库性能，丰富的预训练模型，以及强大的开放云基础设施。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="60b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是我的实现方式。明确地说，我的目标是保持低成本，同时能够使用我首选的对象检测算法。例如，我选择不上传整个视频，然后使用视频识别算法。它会在网络带宽、内存、CPU 和云中存储方面花费更多。</p><ol class=""><li id="7b79" class="lu lv iq kh b ki kj kl km ko lw ks lx kw ly la lz ma mb mc bi translated">使用系统自带的传统图像处理技术，尽可能减少误报警事件。例如，我屏蔽了花园中的动作，因此只有楼梯上的动作才能触发事件。</li><li id="cafa" class="lu lv iq kh b ki md kl me ko mf ks mg kw mh la lz ma mb mc bi translated">一旦事件被触发，就会生成一个视频并存储在 NVR 中。对于我的应用程序来说，大多数视频都在 5 到 20 秒之间。然后视频在本地被处理以生成一些照片，比如说每 10 秒一张照片。</li><li id="62a5" class="lu lv iq kh b ki md kl me ko mf ks mg kw mh la lz ma mb mc bi translated">这些照片然后被发送到 AWS 进行物体检测。可以对异议检测的结果进行编程，以触发通知事件，例如向我的手机发送文本消息或简单地将其写入日志。</li></ol><p id="7eff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为每个安全系统都是不同的，所以在本文中，我只关注如何在 AWS 中设置它。为了演示本文中的功能，我在 CloudFront 中使用了一个 web 接口来从互联网上检索任何图像。一旦接收到图像，它就触发 Lambda 函数调用对象检测代码来处理照片。然后，带有边界框的结果图像被存储在 S3。有关更多信息，请参见[1]和[2]。在 Lambda 上调试几乎是不可能的，所以在移植到 Lambda 之前，我先在 Jupyter 上编写我的对象检测代码。</p><p id="d358" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的脚本和代码都可以在 Github 上获得。阅读完本文后，您可以选择通过重用云堆栈来优化您的对象检测代码。或者，您可以根据自己的需求调整云堆栈，从而重用对象检测代码。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="2794" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你首先需要一个 AWS 账户。要实现本文中的应用程序，它完全属于免费层。登录 AWS 后，进入 CloudFormation 并使用<a class="ae mi" href="https://github.com/penli9/dl-lambda/blob/master/template.json" rel="noopener ugc nofollow" target="_blank"> template.json </a>创建一个栈。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mj"><img src="../Images/613aa10042789163530fe8ab649af10f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKt277H09eU0eHYUGq3Thg.png"/></div></div></figure><p id="235b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下一个屏幕中，给栈起一个名字(我用的是“dl-lambda”)。CloudFormation 将自动构建云基础架构。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mo"><img src="../Images/cb7c557667cc4af93d9c59d5a0e5418d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IEsUQn6ABGnclJNo2CRkEQ.png"/></div></div></figure><p id="6e29" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">成功创建堆栈后，转到 Outputs，其中的值(在本例中是 d2yf3xcp7rorxr.cloudfront.net 的<a class="ae mi" href="http://d2yf3xcp7rorxr.cloudfront.net/" rel="noopener ugc nofollow" target="_blank"/>)是访问 Lambda 函数的 URL。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mp"><img src="../Images/618ce39eda78c2f2990b8fdede643e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UH5qGHNpkjo2v0MwB4tNYw.png"/></div></div></figure><p id="7e39" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击那个，你会来到一个由存储在你的 S3 桶中的 frontend.html 指定的网站 dl-lambda-推论 app-*****。在这张图片中，我的友好的邮递员携带着一个包裹在我的 NVR 上引发了一个事件。因此，我的 NVR 1)存储视频，2)生成照片，然后 3)将照片发送到这个 Web API。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mq"><img src="../Images/3e59cfa98b1824e7ef41b1ded850fa27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_sQkXKrmcXrRbh5iSNKLfg.png"/></div></div></figure><p id="0135" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">邮差周围具有边界框的照片然后被存储在 S3 桶 D1-λ-图像-输出中。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mr"><img src="../Images/29741015171118f66eb576ad1f252e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8xjSYkiX-y4kvq6QLiD8w.png"/></div></div></figure><p id="409b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我开始之前，我已经用 Jupyter 编写了我的物体检测代码<a class="ae mi" href="https://github.com/penli9/dl-lambda/blob/master/demo/dl-lambda.ipynb" rel="noopener ugc nofollow" target="_blank"> dl-lambda.ipynb </a>。为了在本文中保持简单，我使用了来自 Model Zoo 的基于 ResNet 的预先训练好的单镜头多框检测器。然后，我将 Python 代码从 Jupyter 复制并粘贴到<a class="ae mi" href="https://github.com/penli9/dl-lambda/blob/master/demo/inference.py" rel="noopener ugc nofollow" target="_blank"> inference.py </a>中，它运行 Lambda 处理函数。请注意，为了便于移植，我已经清楚地标记了代码部分。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ms mt l"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">dl-λ. ipynb</p></figure><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ms mt l"/></div><p class="lj lk gj gh gi ll lm bd b be z dk translated">推论. py</p></figure></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="e3ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在运行代码几周后，我的 4 摄像头系统甚至在严重优化前每月花费约 2 美元。如果您的成本太高，请使用机器上的图像处理功能来减少误报警事件的数量。增加每张照片的视频时长也有助于减少 Lambda 事件的数量。请注意，您不需要大于 512x512 的图像，因为大多数算法不会使用超过 512 x512 的数据。</p><p id="c0fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是下一步的一些想法:</p><ol class=""><li id="53df" class="lu lv iq kh b ki kj kl km ko lw ks lx kw ly la lz ma mb mc bi translated">预先训练的模型可以识别数百个物体。对于家庭安全，只有人和车是特别感兴趣的。神经网络的复杂性可以显著降低，从而只关注这两个类别，以节省处理成本并缩短执行等待时间。</li><li id="c678" class="lu lv iq kh b ki md kl me ko mf ks mg kw mh la lz ma mb mc bi translated">显然可以上传视频进行复杂的深度学习视频识别。</li><li id="0f32" class="lu lv iq kh b ki md kl me ko mf ks mg kw mh la lz ma mb mc bi translated">分析结果可以存储在数据库中以保存记录。</li><li id="0604" class="lu lv iq kh b ki md kl me ko mf ks mg kw mh la lz ma mb mc bi translated">如果检测到人或车，发送短信。</li></ol></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="843d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过几个简单的步骤，您可以将现成的监控摄像机系统升级到尖端的深度学习功能，同时保持低成本。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="3358" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参考资料:</p><p id="e9aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[1] Anders Christiansen，将机器学习模型部署为无服务器 API，<a class="ae mi" href="https://aws.amazon.com/blogs/machine-learning/" rel="noopener ugc nofollow" target="_blank">将机器学习模型部署为无服务器 API</a>(2020)，AWS 机器学习博客</p><p id="68ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[2] Boris Ivanovic 和 Zoran Ivanovic，<a class="ae mi" href="https://aws.amazon.com/blogs/machine-learning/how-to-deploy-deep-learning-models-with-aws-lambda-and-tensorflow/" rel="noopener ugc nofollow" target="_blank">如何用 AWS Lambda 和 Tensorflow 部署深度学习模型</a> (2017)，AWS 机器学习博客</p></div></div>    
</body>
</html>