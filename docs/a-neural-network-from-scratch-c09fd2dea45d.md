# ä»é›¶å¼€å§‹çš„ç¥ç»ç½‘ç»œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/a-neural-network-from-scratch-c09fd2dea45d?source=collection_archive---------31----------------------->

![](img/0bd41ec18dd65d962d62eb60b276dc6a.png)

## ç”¨ç¥ç»å…ƒã€Python å’Œ Numpy é¢„æµ‹è¾¾æ–¯Â·ç»´å¾·

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºå¦‚ä½•ç”¨ Python ä»å¤´å¼€å§‹åˆ›å»ºä¸€ä¸ªç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬å°†ä½¿ç”¨çš„å”¯ä¸€å¤–éƒ¨åº“æ˜¯ Numpyï¼Œç”¨äºä¸€äº›çº¿æ€§ä»£æ•°ã€‚å› ä¸ºä»Šå¤©æ˜¯ 5 æœˆ 4 æ—¥*ï¼Œ*ä½œä¸ºå¥–åŠ±ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªæ–°åˆ›å»ºçš„ç¥ç»ç½‘ç»œæ¥æ‹Ÿåˆä¸€æ¡å¤æ‚çš„æ¶ˆæ¯ï¼Œè¿™æ¡æ¶ˆæ¯æ˜¯ä»*ç©†æ–¯å¡”æ³•*æˆªå–çš„ã€‚ä¸€æ­¥ä¸€æ­¥åœ°ç¼–å†™ç¥ç»ç½‘ç»œä»£ç å°†æœ‰åŠ©äºæ‚¨ç†è§£å†…éƒ¨å·¥ä½œæ–¹å¼ï¼Œè¿™ä¸ Torch å’Œ Tensorflow ç­‰æµè¡Œæ¡†æ¶éå¸¸ç›¸ä¼¼ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œæˆ‘è®¤ä¸ºä»é›¶å¼€å§‹æ„å»ºä¸œè¥¿æ˜¯æŒæ¡ä¸€ä¸ªä¸»é¢˜çš„æœ€å¥½æ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿå¾ˆæœ‰è¶£ï¼

> â€œå°±æ˜¯è¿™æ¡è·¯â€â€”â€”ä¸Â·è´¾æ—

è¿™ç¯‡æ–‡ç« åœ¨æˆ‘çš„ Github ä¸Šä¹Ÿå¯ä»¥ä½œä¸º[çš„ Jupyter ç¬”è®°æœ¬](https://github.com/dennisbakhuis/Tutorials/blob/master/2_Neural_Network/Artificial_Neural_Network.ipynb)è·å¾—ï¼Œæ‰€ä»¥ä½ å¯ä»¥è¾¹é˜…è¯»è¾¹ç¼–ç ã€‚

å¦‚æœä½ æ˜¯ Python å’Œ Jupyter çš„æ–°æ‰‹ï¼Œ[è¿™é‡Œæœ‰ä¸€ä¸ªå…³äºæˆ‘å¦‚ä½•ç®¡ç†æˆ‘çš„ Python ç¯å¢ƒå’ŒåŒ…çš„ç®€çŸ­è¯´æ˜](/environments-conda-pip-aaaaah-d2503877884c)ã€‚

ğŸ‘‰Pipï¼Œcondaï¼Œaaah æ˜¯æˆ‘æ¯å¤© 10 åˆ†é’Ÿ Python è¯¾ç¨‹çš„ä¸€éƒ¨åˆ†ï¼

**æˆ‘ä»¬å°†è®¨è®ºçš„ä¸»é¢˜çš„ç®€çŸ­æ¦‚è¿°:**

1.  ç¥ç»ç½‘ç»œå’Œé€»è¾‘å›å½’
2.  å¤šå±‚ç½‘ç»œçš„ä¸€èˆ¬åŒ–
3.  é€æ­¥å®æ–½
4.  å®ƒåšäº†å®ƒåº”è¯¥åšçš„äº‹æƒ…å—ï¼Ÿ
5.  ç¬¦åˆä»ç©†æ–¯å¡”æ³•æˆªè·çš„ä¿¡æ¯

# 1.ç¥ç»ç½‘ç»œå’Œé€»è¾‘å›å½’

å½“æˆ‘ä»¬éšæœºé—®ä¸€ä¸ªäººå…³äºæœºå™¨å­¦ä¹ çš„é—®é¢˜æ—¶ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šæåˆ°ç¥ç»ç½‘ç»œã€‚è¿™äº›æœ¯è¯­ä¸ä»…å‘æŒ¥äº†æˆ‘ä»¬çš„æƒ³è±¡åŠ›ï¼Œè€Œä¸”è¿™äº›æ•°å­¦ç»“æ„ä¹Ÿè¯æ˜äº†å®ƒä»¬èƒ½å¤Ÿè§£å†³å¤æ‚çš„ä»»åŠ¡ã€‚è¿™ç§ä»»åŠ¡çš„ä¾‹å­æ˜¯å¯¹è±¡æ£€æµ‹ã€éŸ³é¢‘è½¬å½•å’Œæ–‡æœ¬ç¿»è¯‘ã€‚ç¥ç»ç½‘ç»œå¯ä»¥ç›¸å¯¹è¾ƒå°ï¼Œå¦‚å›¾ 1 æ‰€ç¤ºï¼Œä½†ä»ç„¶å¾ˆå¼ºå¤§ï¼Œå¯ä»¥é¢„æµ‹å¤æ‚çš„ç³»ç»Ÿã€‚

![](img/d4503cffa3c8b834533c72b19b5c6944.png)

å›¾ 1:ä¸€ä¸ªå…¸å‹çš„ç¥ç»ç½‘ç»œï¼Œç”±ä¸€ä¸ªè¾“å…¥å±‚ã€ä¸¤ä¸ªéšè—å±‚å’Œä¸€ä¸ªè¾“å‡ºå±‚ç»„æˆã€‚

åœ¨å›¾ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªäººå·¥ç¥ç»ç½‘ç»œ(ANN)ï¼Œæˆ–ç®€ç§°ä¸ºç¥ç»ç½‘ç»œ(NN)ï¼Œå®ƒæœ‰ä¸‰å±‚ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬ä¸è®¡ç®—è¾“å…¥å±‚ï¼Œç¨åæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œå›¾ä¸­çš„è¿™ä¸€å±‚è¡¨ç¤ºæ‚¨è¾“å…¥åˆ°ç¥ç»ç½‘ç»œçš„è¾“å…¥æ•°æ®ã€‚è¿™ä¸ªç‰¹æ®Šçš„ç¥ç»ç½‘ç»œæœ‰ä¸¤ä¸ªéšè—å±‚ã€‚è™½ç„¶æˆ‘ä¸ç¡®å®šä¸ºä»€ä¹ˆå®ƒè¢«ç§°ä¸ºéšè—å±‚ï¼Œä½†æˆ‘å¯ä»¥æƒ³è±¡ä¸€ä¸ªåŸå› æ˜¯è¿™äº›å±‚å¯¹ç”¨æˆ·æ˜¯â€œéšè—â€çš„ã€‚ç”¨æˆ·é€šè¿‡è¾“å…¥å±‚è¾“å…¥æ•°æ®ï¼Œå¹¶ä»è¾“å‡ºå±‚è·å¾—ç»“æœï¼Œå› æ­¤ä¸ä¼šä¸éšè—å±‚è¿›è¡Œäº¤äº’ã€‚å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œä¸€ä¸ªç³»ç»Ÿæœ‰ä¸€ä¸ªæˆ–äºŒåä¸ªéšè—å±‚æ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚ä¸è¾“å…¥å±‚ç›¸åï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ªå®é™…çš„å±‚ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ä¸€ä¸ªå•ä¸ªç¥ç»å…ƒï¼Œå®ƒâ€œæ”¶é›†â€æ¥è‡ªå‰ä¸€ä¸ªéšè—å±‚çš„ç»“æœã€‚

åœ¨æˆ‘ä¹‹å‰çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘è¯•å›¾è§£é‡Šé€»è¾‘å›å½’(å’Œä¸€ç‚¹çº¿æ€§å›å½’)æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚é€»è¾‘å›å½’å¯ä»¥è¢«çœ‹ä½œæ˜¯æœ€å°çš„ç¥ç»ç½‘ç»œï¼Œåªæœ‰ä¸€å±‚ï¼Œç”±ä¸€ä¸ªç¥ç»å…ƒç»„æˆã€‚å¯èƒ½æœ€å¥½é¦–å…ˆç®€è¦å›é¡¾ä¸€ä¸‹å›¾ 2 æ‰€ç¤ºçš„é€»è¾‘æ¨¡å‹ã€‚

![](img/edde773fd52161bd5ff5a049cff4b415.png)

å›¾ 2:ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹çš„ä¾‹å­ã€‚è¿™ä¸ªä¾‹å­æœ‰ä¸‰ä¸ªè¾“å…¥ç‰¹å¾ä¾›ç»™å•ä¸ªç¥ç»å…ƒã€‚ç¥ç»å…ƒæœ¬èº«åˆ†ä¸ºä¸¤ä¸ªæ“ä½œï¼Œçº¿æ€§éƒ¨åˆ†å’Œéçº¿æ€§æ¿€æ´»å‡½æ•°ã€‚è¯·æ³¨æ„ï¼Œçº¿æ€§æ–¹ç¨‹ä¸­ä½¿ç”¨çš„æƒé‡æ˜¯è¾“å‡ºå›¾å±‚çš„ä¸€éƒ¨åˆ†ã€‚

å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œç¬¬ä¸€æ­¥æ˜¯å¯¹è¾“å…¥æ•°æ®è¿›è¡Œ*æŒ‰æ‘©*ï¼Œä½¿ä¸ªä½“*ç‰¹å¾* ( *ğ‘¥* 1ã€ *ğ‘¥* 2ã€ *ğ‘¥* 3)åœ¨æˆ‘ä»¬è¾“å…¥å‘é‡ *ğ‘‹* çš„è¡Œä¸­ï¼Œåˆ—æ˜¯*å®ä¾‹*(è®­ç»ƒæ ·æœ¬)ã€‚è¿™ä¸ªè¾“å…¥å‘é‡ *ğ‘‹* ç”¨äºæˆ‘ä»¬å•ä¸ªç¥ç»å…ƒçš„å‰å‘ä¼ é€’ã€‚è¿™ä¸ªç¥ç»å…ƒåˆ†ä¸ºä¸¤ä¸ªæ“ä½œã€‚å…ˆæ˜¯ä¸€ä¸ªçº¿æ€§è¿ç®—(çº¿æ€§å›å½’)ï¼Œ*z*=*ğ‘‹ğ‘Š*+*ğ‘*ï¼Œæ¥ç€æ˜¯ä¸€ä¸ªæ¿€æ´»å‡½æ•°*ğ´*=*ğ‘”*(*ğ‘§*)ã€‚åœ¨é€»è¾‘å›å½’æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ‰§è¡Œäº†äºŒå…ƒé€»è¾‘å›å½’ã€‚è¿™å…·ä½“ä½¿ç”¨äº† Sigmoid æ¿€æ´»å‡½æ•°*ğœ*(*ğ‘§*)= 1/(1+exp(*ğ‘§))*ï¼Œå› æ­¤æˆ‘ä»¬åœ¨è¿™é‡Œå°†å…¶è¡¨ç¤ºä¸º *ğœ* ( *ğ‘§* )ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ *ğ‘”* ( *ğ‘§* )æ¥è¡¨ç¤ºæ¿€æ´»å‡½æ•°æ¥æ¦‚æ‹¬è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬å¿…é¡»å®šä¹‰æˆ‘ä»¬å°†ä½¿ç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°ã€‚æ­£å¦‚æˆ‘ä»¬ä»Šå¤©å°†è¦å­¦ä¹ çš„ï¼Œæœ‰è®¸å¤šæ¿€æ´»åŠŸèƒ½å¯ä¾›é€‰æ‹©ã€‚

æ¿€æ´»å‡½æ•°ä½¿ç”¨æ¥è‡ªç¥ç»å…ƒçº¿æ€§éƒ¨åˆ†çš„ç»“æœä½œä¸ºè¾“å…¥ã€‚è¿™æ˜¯æƒé‡å‘é‡ *ğ‘Š* å’Œè¾“å…¥å‘é‡ *ğ‘‹* çš„å†…ç§¯(ä¹Ÿå«ç‚¹ç§¯)ï¼ŒåŠ ä¸Šäº†åç½®é¡¹ *ğ‘* ã€‚åå·®é¡¹ *ğ‘* å’Œæƒå‘é‡ *ğ‘Š* (ç”± *ğ‘¤* 1ã€ *ğ‘¤* 2ã€ *ğ‘¤* 3 ç»„æˆ)æ˜¯è¯¥ç³»ç»Ÿçš„å¯è®­ç»ƒå‚æ•°ã€‚æ¯ä¸ªå¯è®­ç»ƒæƒé‡( *ğ‘¤* 1ã€ *ğ‘¤* 2ã€ *ğ‘¤* 3)å¯¹åº”äºä¸€ä¸ªè¾“å…¥ç‰¹å¾( *ğ‘¥* 1ã€ *ğ‘¥* 2ã€ *ğ‘¥* 3)ï¼Œå¹¶è¡¨ç¤ºè¯¥ç‰¹å¾æ·»åŠ åˆ°é—®é¢˜ä¸­çš„â€œæƒé‡â€ã€‚åœ¨å›¾è¡¨ä¸­ï¼Œè¿™äº›æƒé‡æ˜¾ç¤ºåœ¨è¾“å‡ºå›¾å±‚çš„è™šçº¿æ¡†å†…ï¼Œè¿™æ„å‘³ç€è¿™äº›æƒé‡ä¸è¯¥å›¾å±‚ç›¸å…³è”ã€‚

æˆ‘å¸Œæœ›è¿™ä¸ªç®€çŸ­çš„å›é¡¾æ˜¯æ¸…æ¥šçš„ï¼Œå¦åˆ™ï¼Œæˆ‘å¯ä»¥æ¨è[æˆ‘ä»¥å‰çš„ Jupyter ç¬”è®°æœ¬](/environments-conda-pip-aaaaah-d2503877884c)æ¥è·å¾—æ›´å…¨é¢çš„è§£é‡Šå’Œ Numpy ä¸­çš„ä¸€æ­¥ä¸€æ­¥çš„ä¾‹å­ã€‚

è™½ç„¶é€»è¾‘å›å½’æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œä½†å®ƒåªèƒ½å°†å‚æ•°ç©ºé—´åˆ†æˆä¸€æ¡çº¿ï¼Œè‡³å°‘åœ¨æˆ‘ä»¬è¿™é‡Œç»™å‡ºçš„å½¢å¼ä¸­æ˜¯è¿™æ ·ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸¤ä¸ªç‰¹å¾ *ğ‘¥* 1 å’Œ *ğ‘¥* 2ï¼Œå®ƒä»¬å°†ç”¨äºé¢„æµ‹ *ğ‘¦* ï¼Œé€»è¾‘åˆ†ç±»å™¨åªèƒ½åœ¨ä¸¤ä¸ªå‚æ•°ä¹‹é—´æœ‰ä¸€ä¸ªçº¿æ€§è¾¹ç•Œã€‚å¦‚æœè¿™æ²¡æœ‰æ„ä¹‰ï¼Œä¹Ÿä¸è¦æ‹…å¿ƒï¼Œå› ä¸ºæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚

![](img/98220763f822a1e968586733f453a958.png)

å›¾ 3:ä¸€ä¸ªç¥ç»ç½‘ç»œå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€å †é€»è¾‘å›å½’å•å…ƒçš„ç»„åˆã€‚

ä¸ºäº†è®©ç³»ç»Ÿé¢„æµ‹æ›´å¤æ‚çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å‘ä¸€å±‚æ·»åŠ æ›´å¤šçš„ç¥ç»å…ƒï¼Œæˆ–è€…å‘æˆ‘ä»¬çš„ç½‘ç»œæ·»åŠ æ›´å¤šçš„å±‚ã€‚æ¯ä¸ªç¥ç»å…ƒéƒ½æ˜¯æŸç§é€»è¾‘å›å½’å•å…ƒï¼Œå…¶ä¸­è®¸å¤šç»“åˆèµ·æ¥å¯ä»¥é¢„æµ‹é«˜åº¦éçº¿æ€§çš„å…³ç³»(è§å›¾ 3)ã€‚æˆ‘è¯´*ç±»ä¼¼äº*ï¼Œå› ä¸ºåœ¨å¸¸è§„é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ Sigmoid æ¿€æ´»å‡½æ•°ï¼Œè€Œåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè®¸å¤šå…¶ä»–æ¿€æ´»å‡½æ•°çš„æ€§èƒ½è¦å¥½å¾—å¤šã€‚

åœ¨æˆ‘ä»¬å¼€å§‹æ¦‚æ‹¬ä¸€ä¸ªç¥ç»ç½‘ç»œå’Œæ‰€ç”¨çš„å±‚ä¹‹å‰ï¼Œè¯·è§‚å¯Ÿå›¾ 3 ä¸­ä¸åŒçš„ç¥ç»å…ƒæ˜¯å¦‚ä½•è¿æ¥çš„ã€‚æ‚¨ä¼šæ³¨æ„åˆ°æ¯ä¸ªèŠ‚ç‚¹éƒ½è¿æ¥åˆ°ä¸‹ä¸€å±‚çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚è¿™è¢«ç§°ä¸ºå¯†é›†è¿æ¥(æœ‰æ—¶æ˜¯å®Œå…¨è¿æ¥)ï¼Œè¿™æ ·çš„å±‚é€šå¸¸è¢«ç§°ä¸ºâ€œå¯†é›†å±‚â€ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å°è¯•æ¦‚æ‹¬ç½‘ç»œå¹¶ç¡®å®šæ‰€éœ€çš„ç»“æ„ã€‚

# 2.å¤šå±‚ç½‘ç»œçš„ä¸€èˆ¬åŒ–

åœ¨æˆ‘ä»¬å¼€å§‹ç¼–ç æˆ‘ä»¬çš„ç³»ç»Ÿä¹‹å‰ï¼Œè®©æˆ‘ä»¬é¦–å…ˆå°è¯•æ¦‚æ‹¬æ‰€éœ€çš„æ­¥éª¤ã€‚æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªé€šç”¨çš„ç¥ç»ç½‘ç»œç±»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ ä»»æ„æ•°é‡çš„å±‚ï¼ŒåŒ…å«ä»»æ„æ•°é‡çš„ç¥ç»å…ƒã€‚ç¨åï¼Œæˆ‘ä»¬å°†åœ¨å…·æœ‰ä¸åŒå¤æ‚æ€§çš„å„ç§é—®é¢˜ä¸Šæµ‹è¯•è¿™ç§ç»“æ„ã€‚

å½“æˆ‘ä»¬æƒ³åˆ°è¾“å…¥å±‚æ—¶ï¼Œæˆ‘ä»¬å·²ç»å‘ç°å®ƒä¸æ˜¯ç¥ç»ç½‘ç»œçš„å®é™…å±‚ï¼Œè€Œæ˜¯ä»¥æ­£ç¡®å½¢å¼é‡æ–°æ•´å½¢çš„è¾“å…¥æ•°æ®ã€‚å› æ­¤ï¼Œè¾“å…¥â€œå±‚â€ä¸æ˜¯æˆ‘ä»¬æ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚å½“ç„¶ï¼Œè¾“å…¥æ•°æ®å…·æœ‰è®¸å¤šç‰¹å¾ï¼Œå› æ­¤å®šä¹‰äº†æˆ‘ä»¬çš„ç¬¬ä¸€å±‚çš„è‡³å°‘ä¸€ä¸ªç»´åº¦ã€‚

ç¥ç»ç½‘ç»œå°†ç”±ä»»æ„æ•°é‡çš„å±‚ç»„æˆã€‚è¿™äº›ç»“æ„çš„è¡Œä¸ºæ–¹å¼ç›¸ä¼¼ï¼Œå¹¶ä¸”æ˜¯ç›¸äº’è¿ç»­çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°†æœ‰ä¸€ä¸ªå±‚ç»“æ„ï¼Œä»¥åŠæŸç§çˆ¶ç»“æ„æ¥ä¿å­˜æ‰€æœ‰çš„å±‚ã€‚å½“è¿›è¡Œæ­£å‘ä¼ é€’æ—¶ï¼Œæˆ‘ä»¬å°†éå†æ‰€æœ‰å±‚ï¼Œå¹¶å°†å‰ä¸€å±‚çš„è¾“å‡ºç”¨ä½œä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚æœ€ç»ˆå±‚çš„è¾“å‡ºï¼Œä¹Ÿç§°ä¸ºæœ€ç»ˆæ¿€æ´» *ğ´* æ˜¯ç¥ç»ç½‘ç»œçš„è¾“å‡ºã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœç¥ç»ç½‘ç»œç”¨äºé¢„æµ‹äºŒè¿›åˆ¶å€¼ï¼Œåˆ™è¾“å‡ºå¿…é¡»è½¬æ¢(æˆ–èˆå…¥)ä¸ºå®é™…é¢„æµ‹å€¼ã€‚

ä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„é¢„æµ‹ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæˆæœ¬å‡½æ•°ã€‚æˆæœ¬å‡½æ•°æ˜¯å¯¹æ¨¡å‹é¢„æµ‹æ•ˆæœçš„è¡¡é‡ï¼Œå› æ­¤éœ€è¦é¢„æµ‹å€¼å’ŒçœŸå®å€¼ã€‚åœ¨æœ€æ­£å¼çš„æ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œè¯¥å‡½æ•°è®¡ç®—å•ä¸ªç¤ºä¾‹çš„é¢„æµ‹è¯¯å·®ï¼Œå¹¶å°†æ‰€æœ‰è¿™äº›æŸå¤±åˆå¹¶åˆ°ä¸€ä¸ªæˆæœ¬å‡½æ•°ä¸­ï¼Œä»¥è·å¾—æˆ‘ä»¬è¾“å…¥åˆ°æ¨¡å‹ä¸­çš„æ•´ä¸ªæ‰¹æ¬¡çš„ä¸€ä¸ªåº¦é‡ã€‚æŸå¤±å’Œæˆæœ¬å‡½æ•°åªéœ€è¦ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸€å±‚ä¸­ï¼Œå› æ­¤ï¼Œå®ƒåº”è¯¥åœ¨çˆ¶ç»“æ„ä¸­å®ç°ã€‚

ä¸ºäº†ä¼˜åŒ–æƒé‡å¹¶æœ‰å¸Œæœ›æ”¹è¿›æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å‘åä¼ é€’æ¥è®¡ç®—æ¢¯åº¦ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¡ç®—çˆ¶ç±»ä¸­æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€‚è¿™å°†æ˜¯æœ€åä¸€å±‚çš„è¾“å…¥ï¼Œä»è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å‘åå¾ªç¯è®¡ç®—æ¢¯åº¦ *ğ‘‘ğ‘Š* å’Œ *ğ‘‘ğ‘* ï¼Œéšç€æ¯æ¬¡è¿­ä»£ï¼Œå‰ä¸€å±‚çš„è¾“å…¥å°†æ˜¯ä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚ä¸ºäº†è®¡ç®—æ¢¯åº¦ï¼Œæˆ‘ä»¬éœ€è¦æ¥è‡ªå‘å‰ä¼ é€’çš„è¾“å…¥ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªèªæ˜çš„æŠ€å·§ï¼Œåœ¨å‘å‰ä¼ é€’æœŸé—´ç¼“å­˜ *ğ‘§* å’Œ *ğ´* çš„å€¼ã€‚è¿™çœ‹èµ·æ¥æœ‰ç‚¹å“äººï¼Œä½†è¿™äº›æ­¥éª¤ä¸»è¦æ˜¯è®°è´¦ã€‚æ‰€æœ‰è¿™äº›æ­¥éª¤éƒ½å¯ä»¥åœ¨å›¾ 4 ä¸­çœ‹åˆ°ã€‚

![](img/9dfc4884e90d65f36bc0591830e1bd14.png)

å›¾ 4:æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œç»“æ„çš„æ¦‚è¿°ã€‚å®Œæ•´çš„ç»“æ„ï¼ŒåŒ…æ‹¬è¾“å‡ºå±‚ *ğ¿ğ‘œ* åœ¨æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ¡†æ¶å†…ã€‚æ­£å‘ä¼ é€’å¾ªç¯é€šè¿‡æ¯ä¸€å±‚ï¼Œå¹¶è¾“å‡ºæœ€ç»ˆæ¿€æ´»çš„ç»“æœã€‚è¿›è¡Œåå‘ä¼ é€’æ—¶ï¼Œé¦–å…ˆè®¡ç®—æˆæœ¬å‡½æ•°çš„æ¢¯åº¦ï¼Œç„¶åæˆ‘ä»¬é€šè¿‡æ‰€æœ‰å±‚åå‘è¿­ä»£ï¼Œè®¡ç®—æ¢¯åº¦ã€‚

åœ¨æˆ‘ä»¬è®¡ç®—äº†æ¯ä¸€å±‚çš„æ¢¯åº¦åï¼Œæˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªæ›´æ–°æ­¥éª¤ï¼Œå¹¶æ‰§è¡Œæ¢¯åº¦ä¸‹é™æ­¥éª¤ã€‚è¿™ä¸€æ­¥å®é™…ä¸Šä¸æˆ‘ä»¬åœ¨é€»è¾‘å›å½’æ•™ç¨‹ä¸­è®¨è®ºçš„ä¸€æ­¥ç›¸åŒï¼Œåœ¨é€»è¾‘å›å½’æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å­¦ä¹ ç‡å°†æƒé‡å‘çœŸå®ç»“æœâ€œç§»åŠ¨â€ä¸€æ­¥ã€‚ç„¶è€Œï¼Œè¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹ç¥ç»ç½‘ç»œä¸­çš„æ¯ä¸€å±‚éƒ½è¿™æ ·åšã€‚

æˆ‘ä»¬ç°åœ¨åº”è¯¥è®¤è¯†åˆ°ï¼Œç½‘ç»œä¸­çš„æ‰€æœ‰å±‚åœ¨æ ¹æœ¬ä¸Šæ˜¯ç›¸åŒçš„ã€‚å®ƒä»¬å¯ä»¥åœ¨èŠ‚ç‚¹æ•°é‡æˆ–æ¿€æ´»åŠŸèƒ½ä¸Šæœ‰æ‰€ä¸åŒï¼Œä½†ç¬¬ä¸€å±‚ *ğ¿* 1 å’Œè¾“å‡ºå±‚ *ğ¿ğ‘œ* ä¹‹é—´æ²¡æœ‰ç»“æ„ä¸Šçš„åŒºåˆ«ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå±‚ç»“æ„ä½œä¸ºç¥ç»ç½‘ç»œçš„ä¸€ä¸ªæ„å»ºæ¨¡å—ã€‚

æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œå°†åªç”±å¯†é›†å±‚ç»„æˆï¼Œå³æ‰€æœ‰ç¥ç»å…ƒéƒ½å®Œå…¨è¿æ¥åˆ°ä¸‹ä¸€å±‚ç¥ç»å…ƒçš„å±‚ï¼Œå› æ­¤æˆ‘ä»¬å°†åªåˆ¶ä½œå•å±‚ç»“æ„ã€‚åœ¨è¿™ä¸ªç»“æ„ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»è®¡ç®—å‘å‰ä¼ é€’ã€å‘åä¼ é€’å’Œæ›´æ–°æ­¥éª¤ã€‚æ¯ä¸€å±‚çš„è¾“å…¥éƒ½æ˜¯å‰ä¸€å±‚çš„è¾“å‡ºã€‚æ˜¾ç„¶ï¼Œå¯¹äºç¬¬ä¸€å±‚ï¼Œè¿™æ˜¯è¾“å…¥å‘é‡ã€‚å¯¹äºåå‘ä¼ é€’ï¼Œæˆ‘ä»¬æŒ‰ç›¸åæ–¹å‘ä¾æ¬¡é€šè¿‡ç½‘ç»œã€‚ç„¶è€Œï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è®¡ç®—å…³äºå®šä¹‰çš„æŸå¤±å‡½æ•°çš„æ¢¯åº¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åå‘ä¼ é€’æœŸé—´è¾“å…¥çœŸå®æ ‡ç­¾ *ğ‘Œ* å’Œé¢„æµ‹è¾“å‡º *ğ´* ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå±‚æœŸæœ›çš„å€¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º *ğ‘‘ğ´* ã€‚æ¯ä¸€å±‚éƒ½ä»¥å®Œå…¨ç›¸åŒçš„æ–¹å¼å¤„ç†å‘åä¼ é€’ã€‚

![](img/268292a49df36e89e29b6dd7734315d4.png)

å›¾ 5:æ˜¾ç¤ºå•å±‚å‘å‰å’Œå‘åä¼ é€’çš„å›¾è¡¨ã€‚åœ¨å‘å‰ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ç¼“å­˜ A å’Œ z çš„å€¼ï¼Œä»¥ä¾¿åœ¨å‘åä¼ é€’è¿‡ç¨‹ä¸­ä½¿ç”¨ã€‚

æ¯ä¸€å±‚çš„å‘å‰å’Œå‘åä¼ é€’å¦‚å›¾ 5 æ‰€ç¤ºã€‚è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥åœ°èµ°è¿‡æ¯ä¸€å…³ã€‚åœ¨å‰å‘ä¼ é€’ä¸­ï¼Œå®ƒæœŸæœ›å‰ä¸€å±‚çš„è¾“å‡º *ğ´ğ‘* (æˆ–è¾“å…¥å‘é‡ *ğ‘‹* )ä½œä¸ºè¾“å…¥ã€‚åœ¨çº¿æ€§æ–¹ç¨‹ä¹‹å‰ï¼Œè¾“å…¥ *ğ´ğ‘* è¢«ç¼“å­˜ç”¨äºå‘åä¼ é€’ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¡ç®—å•ä¸ªçŸ¢é‡åŒ–å†…ç§¯ä¸­çš„çº¿æ€§éƒ¨åˆ†ã€‚è¿™æ˜¯å¯¹è¯¥å±‚ä¸­çš„æ‰€æœ‰ç¥ç»å…ƒä»¥å•ä¸€æ­¥éª¤å®Œæˆçš„ã€‚åœ¨å†…ç§¯ä¹‹åï¼ŒåŠ ä¸Šåç½®é¡¹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜ç¼“å­˜äº†å‘åä¼ é€’çš„ *ğ‘§ğ‘* çš„å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è®¡ç®—æ¿€æ´»å‡½æ•°ï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™ä¸‹ä¸€å±‚(æˆ–è€…å¦‚æœè¿™æ˜¯æœ€åä¸€å±‚ï¼Œè¿™å°±æ˜¯è¾“å‡º)ã€‚

å‘åä¼ é€’åªæ˜¯åå‘çš„å‘å‰ä¼ é€’ï¼Œä½†æ˜¯æœŸæœ›å‰ä¸€ä¸ªæ¸å˜ä½œä¸ºè¾“å…¥ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¾®åˆ†ã€‚è¿™äº›éƒ½æ¯”è¾ƒå®¹æ˜“è®¡ç®—(æˆ–è€…åœ¨ç½‘ä¸Šæ‰¾)ã€‚æˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ğ´ğ‘çš„å€¼å’Œğ‘§ğ‘çš„å€¼æ¥è®¡ç®—æ¢¯åº¦ã€‚ä½œä¸ºæœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬è®¡ç®— *ğ‘‘ğ´ğ‘* ï¼Œè¿™å°†æ˜¯ä¸‹ä¸€å±‚çš„è¾“å…¥ã€‚è™½ç„¶æ•°å­¦ä¸ä¹‹å‰çš„æ•™ç¨‹ç›¸ä¼¼ï¼Œä½†ç°åœ¨æ›´åŠ ç®€åŒ–äº†ã€‚æˆ‘ä¸æƒ³è¿‡å¤šåœ°å…³æ³¨å®é™…çš„å·®å¼‚ï¼Œä½†ä¼šåœ¨ä»£ç ä¸­å¤šè§£é‡Šä¸€äº›ã€‚å¦‚æœä½ çœŸçš„æƒ³çŸ¥é“è¿™äº›å¾®åˆ†æ˜¯æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Œæˆ‘ä¼šå»ºè®®ä½ æ‹¿çº¸ç¬”è¯•ç€ç®—ä¸€ä¸‹ã€‚ä»–ä»¬å¹¶ä¸éš¾ï¼ŒWolfram Alpha å¯ä»¥å¸®åŠ©ä½ :-)ã€‚

æœ€åä¸€ç‚¹ï¼Œä½ åº”è¯¥æ„è¯†åˆ°ï¼Œåœ¨å‘åä¼ çƒä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨åšæ‰€æœ‰[é“¾å¼è§„åˆ™](https://en.wikipedia.org/wiki/Chain_rule)ä¹‹æ¯ã€‚ä¸ºäº†è®¡ç®—ç¬¬ä¸€å±‚çš„æ¢¯åº¦ï¼Œæˆ‘ä»¬å¿…é¡»å°†æ‰€æœ‰å…¶ä»–çš„å¾®åˆ†é“¾æ¥åœ¨ä¸€èµ·ã€‚å¦‚æœä¸å®Œå…¨æ¸…æ¥šæ¯ä¸ªæ­¥éª¤åœ¨åšä»€ä¹ˆï¼Œ*ä¸è¦å¤ªæ‹…å¿ƒ*ã€‚æˆ‘ä¼šè¯•ç€è§£é‡Šç¼–ç è¿‡ç¨‹ä¸­çš„æ¯ä¸€æ­¥ã€‚ç»éªŒå’Œç†è§£æ¥è‡ªå®éªŒã€‚

> â€œæˆ‘å·²ç»è¯´è¿‡äº†â€â€”â€”åº“ä¼Šå°”

# é€æ­¥å®æ–½

åœ¨æˆ‘ä»¬å¼€å§‹ç¼–ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå¯¹æˆ‘ä»¬è®¡åˆ’åšçš„äº‹æƒ…åšä¸€ä¸ªç®€çŸ­çš„æ€»ç»“ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯åˆ›å»ºä¸¤ä¸ªç»“æ„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ç±»ã€‚ä¸€ä¸ªç±»å®šä¹‰å±‚ï¼Œè€Œå¦ä¸€ä¸ªç±»å……å½“çˆ¶ç±»å¹¶ä¿å­˜å®Œæ•´ç¥ç»ç½‘ç»œçš„æ‰€æœ‰å±‚ã€‚

## å¯†é›†å±‚ç±»

*   ç»“æ„æ¥ä¿å­˜ä»»æ„æ•°é‡çš„èŠ‚ç‚¹
*   å°†å…·æœ‰å„ç§æ¿€æ´»åŠŸèƒ½
*   å°†é€šè¿‡å•å±‚æ‰§è¡Œæ­£å‘ä¼ é€’
*   åå‘ä¼ é€’çš„ç¼“å­˜å€¼
*   å°†å¯¹è¯¥å±‚æ‰§è¡Œå‘åä¼ é€’
*   å°†å¯¹å›¾å±‚æ‰§è¡Œæ›´æ–°æ­¥éª¤

## ç¥ç»ç½‘ç»œç±»

*   ç»“æ„æ¥ä¿å­˜ä»»æ„æ•°é‡çš„å±‚
*   å°†åœ¨æ‰€æœ‰å±‚ä¸­é¡ºåºæ‰§è¡Œå‘å‰ä¼ é€’
*   å°†è®¡ç®—å„ç§æŸå¤±å‡½æ•°çš„æˆæœ¬
*   å°†æ‰§è¡Œåå‘ä¼ é€’å¹¶è®¡ç®—æ‰€æœ‰æ¢¯åº¦
*   å°†å¯¹æ‰€æœ‰å›¾å±‚è¿›è¡Œæ›´æ–°(æ¢¯åº¦ä¸‹é™æ­¥éª¤)

## **è®©æˆ‘ä»¬å¼€å§‹å§ï¼**

æˆ‘ä»¬å°†ä½¿ç”¨ Numpy çš„çº¿æ€§ä»£æ•°ä¾‹ç¨‹ï¼Œå› æ­¤éœ€è¦å¯¼å…¥å®ƒã€‚æ­¤å¤–ï¼Œå®šä¹‰æœ‰æ„ä¹‰çš„é”™è¯¯æ˜¯ä¸€ç§å¥½çš„åšæ³•ï¼Œå› æ­¤æˆ‘ä»¬å°†å®šä¹‰å‡ ä¸ªå¼‚å¸¸ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ Python çš„æ—¥å¿—æ¨¡å—ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ã€‚

## è‡´å¯†å±‚:

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºåä¸º DenseLayer çš„æ–°ç±»ã€‚è¯¥ç±»é‡‡ç”¨ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªå¿…éœ€å‚æ•°å’Œä¸¤ä¸ªå¯é€‰å‚æ•°çš„æ„é€ å‡½æ•°:

*   inputDimensionï¼Œå³è¾“å…¥å‘é‡çš„ç‰¹å¾æ•°ï¼Œæˆ–å‰ä¸€å±‚çš„å•å…ƒæ•°ã€‚
*   å•ä½ï¼Œå³è¯¥å±‚ç¥ç»å…ƒçš„æ•°é‡ã€‚
*   æ¿€æ´»:åœ¨è¿™é‡Œä½ å¯ä»¥æŒ‡å‡ºå±‚åº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ¿€æ´»ã€‚å®šä¹‰äº†â€œsigmoidâ€ã€â€œreluâ€ã€â€œtanhâ€å’Œâ€œâ€ã€‚ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºæ²¡æœ‰æ¿€æ´»ï¼Œæ„å‘³ç€æˆ‘ä»¬åªæœ‰ä¸€ä¸ªå›å½’ã€‚
*   randomMultiplier æ˜¯éšæœºæƒé‡ç›¸ä¹˜çš„å€¼ã€‚é€šå¸¸ï¼Œ0.01 å°±å¯ä»¥äº†ï¼Œä½†æœ‰æ—¶è°ƒæ•´è¿™ä¸ªæ•°å­—ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

ç”±äºå¯èƒ½æœ‰ä¸åŒçš„æ¿€æ´»å‡½æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸æƒ³æ£€æŸ¥æˆ‘ä»¬ä½¿ç”¨äº† if è¯­å¥çš„å“ªä¸ªæ¿€æ´»ï¼Œæˆ‘ä»¬åœ¨ init è¯­å¥ä¸­å¼•ç”¨æ‰€ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ã€‚

åœ¨ initialize æ–¹æ³•ä¸­ï¼Œæƒé‡è¢«åˆå§‹åŒ–ã€‚æ³¨æ„ï¼Œç¥ç»å…ƒçš„æ•°é‡ *nh* (å•ä½)åœ¨è¡Œä¸­ï¼Œè¾“å…¥ç‰¹å¾çš„æ•°é‡ nx æ˜¯åˆ—ã€‚è¿™æ˜¯ä½¿æˆ‘ä»¬çš„ç‚¹ç§¯ç¨åå·¥ä½œæ‰€å¿…éœ€çš„ã€‚

æœ€è¿‘å­¦åˆ°çš„å¦ä¸€ä»¶äº‹æ˜¯ Python ä¸­â€˜selfâ€™çš„ç”¨æ³•ã€‚è™½ç„¶æˆ‘è®¤ä¸ºæˆ‘ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œä½†æˆ‘å¹¶ä¸å®Œå…¨ç†è§£å…¶åæœã€‚ç±»çš„å®šä¹‰ä¸æ¯ä¸ªå®ä¾‹çš„å€¼æ˜¯åˆ†å¼€çš„ã€‚è¿™äº›å€¼å­˜å‚¨åœ¨è‡ªèº«å¯¹è±¡ä¸­ï¼Œå³å®ä¾‹æœ¬èº«çš„å¯¹è±¡ä¸­ã€‚åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œé€šå¸¸åœ¨ç±»æœ¬èº«ä¸­å®šä¹‰ç±»å‹ã€‚ç„¶è€Œï¼Œåœ¨ Python ä¸­ï¼Œæ‚¨å¿…é¡»åœ¨ init-method ä¸­å®šä¹‰å®ƒä»¬ã€‚å¦‚æœä¸è¿™æ ·åšï¼Œè¯¥å˜é‡å°†åœ¨æ‰€æœ‰å®ä¾‹ä¸­å…±äº«ï¼Œæ‚¨å¯èƒ½ä¼šå¾—åˆ°å¥‡æ€ªçš„ç»“æœã€‚æˆ‘åˆšåˆšå‘ç°è¿™ç¯‡[åšæ–‡](/python-pitfall-mutable-default-arguments-9385e8265422)ï¼Œå…¶ä¸­å”Â·å…‹ç½—æ–¯æœ‰ä¸€ä¸ªéå¸¸æ¸…æ™°çš„è§£é‡Šã€‚æœ‰å…´è¶£æ¨èé˜…è¯»ï¼

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰æ‰€æœ‰ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ã€‚æˆ‘ä»¬åœ¨å‰é¢çš„æ•™ç¨‹ä¸­å·²ç»çŸ¥é“äº† Sigmoidï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜åŒ…æ‹¬ Tanh å’Œ Reluï¼Œå®ƒä»¬ä¹Ÿæ˜¯éå¸¸å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°ã€‚

åŒæ›²æ­£åˆ‡å‡½æ•°æ˜¯ä¸€ä¸ªç±»ä¼¼äº Sigmoid çš„å‡½æ•°ï¼Œä½†æ˜¯å®ƒå°†æ‰€æœ‰å®æ•°å€¼æ˜ å°„åˆ°-1 å’Œ+1 ä¹‹é—´çš„å€¼ã€‚åœ¨ Relu å‡½æ•°ç™»ä¸Šèˆå°ä¹‹å‰ï¼Œå®ƒå·²ç»éå¸¸æµè¡Œäº†ã€‚

Reluï¼Œä»£è¡¨æ•´æµçº¿æ€§å•ä½ï¼Œå¯èƒ½æ˜¯ç›®å‰æœ€æµè¡Œçš„æ¿€æ´»å‡½æ•°ã€‚å®ƒçš„è®¡ç®—é€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä¸”é€šå¸¸æ¯”åŒæ›²æ­£åˆ‡å‡½æ•°çš„ç»“æœæ›´å¥½ã€‚å› æ­¤ï¼Œå¦‚æœä½ ä¸ç¡®å®šï¼ŒRelu å‡½æ•°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚Relu å‡½æ•°å°†æ‰€æœ‰å°äº 0 çš„å€¼æ˜ å°„ä¸ºé›¶ï¼Œå¹¶å°†æ‰€æœ‰å¤§äº 0 çš„å€¼æ˜ å°„ä¸ºå€¼æœ¬èº«ã€‚

æˆ‘ä»¬å°†ä»‹ç»çš„æœ€åä¸€ä¸ªæ¿€æ´»å‡½æ•°ç§°ä¸ºçº¿æ€§å‡½æ•°ã€‚è¿™å’Œæ²¡æœ‰æ¿€æ´»åŠŸèƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚ä»€ä¹ˆè¿›æ¥ï¼Œä»€ä¹ˆå‡ºæ¥ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥æµ‹è¯•æˆ‘ä»¬ä¹‹å‰çš„çº¿æ€§å›å½’ç»ƒä¹ ã€‚

å‘åä¼ é€’éœ€è¦æ‰€æœ‰è¿™äº›å‡½æ•°çš„å¾®åˆ†ï¼Œè¿™äº›å¾®åˆ†å¸¦æœ‰ Grad åç¼€ã€‚è¯·éšæ„æ£€æŸ¥è¿™äº›å·®é€Ÿå™¨æ˜¯å¦æ­£ç¡®ã€‚è¯·æ³¨æ„ï¼Œæ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œå®ƒä¸æ˜¯å‡½æ•°å¾®åˆ†æœ¬èº«çš„ä¸€éƒ¨åˆ†ï¼Œä½†éœ€è¦åº”ç”¨[é“¾è§„åˆ™](https://en.wikipedia.org/wiki/Differentiation_rules#The_chain_rule)ã€‚æˆ‘ä»¬å°†è¾“å…¥çš„å·®åˆ†ä¹˜ä»¥è®¡ç®—å‡ºçš„å·®åˆ†ã€‚è¿™ä¸ªæ­¥éª¤åœ¨æ•´ä¸ªåå‘ä¼ æ’­ä¸­è¿ç»­è¿è¡Œã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰æ­£å‘ä¼ æ’­æ­¥éª¤ï¼Œè¿™å¯¹äºé€»è¾‘å›å½’ç‰ˆæœ¬æ¥è¯´åº”è¯¥éå¸¸ç†Ÿæ‚‰:

æˆ‘ä»¬é¦–å…ˆè®¡ç®—çº¿æ€§éƒ¨åˆ†ã€‚å­˜å‚¨ Z å’Œ A çš„å€¼ï¼Œä¾›ä»¥ååœ¨åå‘ä¼ æ’­ä¸­ä½¿ç”¨ï¼Œç„¶ååº”ç”¨æ¿€æ´»å‡½æ•°ã€‚

åå‘ä¼ æ’­åº”è¯¥çœ‹èµ·æ¥ä¹Ÿå¾ˆç†Ÿæ‚‰ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬å·²ç»å°†æ¿€æ´»å‡½æ•°çš„å¾®åˆ†éƒ¨åˆ†æ‹†åˆ†ä¸ºå‡½æ•°æœ¬èº«ã€‚æ­¤å¤–ï¼Œè¯¥å‡½æ•°æœŸæœ› *dA* ä½œä¸ºè¾“å…¥ï¼Œè¿™æ˜¯å¤šå±‚çš„æ›´ä¸€èˆ¬åŒ–çš„å½¢å¼ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„å•å±‚ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€æ­¥ä¸­åˆå¹¶äº†æŸå¤±å‡½æ•°çš„å¾®åˆ†ã€‚è¿™ä¸€æ­¥ç°åœ¨åŒ…å«åœ¨æˆ‘ä»¬çš„çˆ¶ç±»ä¸­ï¼Œè€Œä¸æ˜¯æ¯ä¸ªå±‚ä¸­ï¼Œå› ä¸ºå®ƒåªåœ¨æœ€åä¸€å±‚ä¹‹å‰éœ€è¦ã€‚

æ¢¯åº¦å­˜å‚¨åœ¨æ¯ä¸ªå›¾å±‚ä¸­ï¼Œä»¥åå¯ç”±æ‰§è¡Œæ¢¯åº¦ä¸‹é™æ­¥éª¤çš„æ›´æ–°å‡½æ•°ä½¿ç”¨ã€‚åå‘ä¼ é€’å°†æ¯ä¸€å±‚é“¾æ¥åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å°†åœ¨åé¢å¤„ç†çˆ¶ç±»æ—¶çœ‹åˆ°ã€‚å‰©ä¸‹å”¯ä¸€éœ€è¦çš„å‡½æ•°æ˜¯ update å‡½æ•°ï¼Œå®ƒæ‰§è¡Œæ¢¯åº¦ä¸‹é™æ­¥éª¤ã€‚æ²¡ä»€ä¹ˆäº†ä¸èµ·çš„ï¼Œä½†å®ƒæœŸæœ›ä¸€ä¸ªå­¦ä¹ ç‡ã€‚

è™½ç„¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†è¿™äº› next å‡½æ•°æœ‰åŠ©äºæ‰“å°æ¨¡å‹å¹¶è¿”å›è¾“å‡ºèŠ‚ç‚¹çš„æ•°é‡ï¼Œè¿™äº›èŠ‚ç‚¹ç”¨ä½œä¸‹ä¸€å±‚çš„è¾“å…¥ç»´åº¦ã€‚

## ç¥ç»ç½‘ç»œç±»:

å¥½å§ï¼Œæå®šä¸€ä¸ªï¼Œè¿˜æœ‰ä¸€ä¸ªã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç±»æ¥åˆå¹¶è¿™äº›å±‚ã€‚å®ƒè¿˜å°†ä¿å­˜æŸå¤±å‡½æ•°ï¼Œå¹¶ä¸”å¿…é¡»è®¡ç®—æŸå¤±çš„æ¢¯åº¦ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬è¿˜å°†æ·»åŠ ä¸€ä¸ªåŒ…è£…å™¨æ¥æ·»åŠ å±‚ï¼Œå¹¶æ·»åŠ ä¸€ç§æ–¹æ³•æ¥æ¼‚äº®åœ°æ‰“å°æˆ‘ä»¬çš„æ¨¡å‹ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å†æ¬¡ä»æ„é€ å‡½æ•°å¼€å§‹ï¼Œå®ƒæœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œè¦ä½¿ç”¨çš„æŸå¤±å‡½æ•°å’Œç”¨äºæ–°å±‚çš„ randomMultiplierã€‚æŸå¤±å‡½æ•°å†æ¬¡åœ¨å‡½æ•°å¼•ç”¨ä¸­åˆ›å»ºï¼Œå¹¶ä½¿ç”¨åŒ…è£…å‡½æ•°è°ƒç”¨ã€‚æ¨¡å‹åˆå§‹åŒ–æ—¶æ²¡æœ‰å±‚(ç©º)ã€‚

ä¸‹ä¸€ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªå¸®åŠ©å™¨å‡½æ•°ï¼Œç”¨äºå‘æ¨¡å‹æ·»åŠ å±‚ã€‚æ‚¨éœ€è¦ç»™å‡ºè¾“å…¥ç»´åº¦ï¼Œå³ç¬¬ä¸€å±‚çš„è¾“å…¥è¦ç´ çš„æ•°é‡ã€‚å¯¹äºç¬¬äºŒå±‚å’Œæ›´æ·±çš„å±‚ï¼Œå®ƒå°†æŸ¥æ‰¾å‰ä¸€å±‚å¹¶å°†å…¶ç”¨ä½œè¾“å…¥ç»´åº¦ã€‚

ä½ å¿…é¡»æŒ‡å®šå±‚(å•å…ƒ)ä¸­ç¥ç»å…ƒçš„æ•°é‡ä»¥åŠä½¿ç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°ã€‚å¦‚æœä½ ä¸æŒ‡å®šæ¿€æ´»å‡½æ•°ï¼Œå®ƒå°†ä¸ä¼šä½¿ç”¨æ¿€æ´»å‡½æ•°ï¼Œä½ å°†å¾—åˆ°ä¸€ä¸ªçº¿æ€§ç³»ç»Ÿã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰æŸå¤±å‡½æ•°åŠå…¶å¾®åˆ†ã€‚è¯·éšæ„æ£€æŸ¥å·®é€Ÿå™¨æ˜¯å¦æ­£ç¡®ã€‚æˆæœ¬æ–¹æ³•æ˜¯ä¸€ä¸ªåŒ…è£…å™¨ï¼Œç”¨äºåœ¨è®­ç»ƒå¾ªç¯ä¸­è°ƒç”¨é€‚å½“çš„æˆæœ¬å‡½æ•°ï¼Œæˆ‘ä»¬å°†åœ¨åé¢å®šä¹‰ã€‚

å‰è¿›ã€åé€€å’Œæ›´æ–°æ–¹æ³•éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ‰€æœ‰å±‚ä¸Šå¾ªç¯ã€‚åªæœ‰åå‘é€šé“å¿…é¡»é¦–å…ˆè®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œç„¶åå°†å…¶ç”¨ä½œç¬¬ä¸€å±‚(ä»å³ä¾§å¼€å§‹)çš„è¾“å…¥ã€‚

åä¸¤ç§æ–¹æ³•éå¸¸ç®€å•ï¼Œç”¨äºæ¼‚äº®çš„æ‰“å°ï¼Œä¸€ç§ç”¨äºæ‰“å°å¯è®­ç»ƒå‚æ•°ã€‚æ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚

å¥½äº†ï¼Œè¯¾ç¨‹ç»“æŸäº†ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹è¿™äº›ç±»è¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶å®ƒçœ‹èµ·æ¥éå¸¸æœ‰åºï¼Œä½†å…¶ä¸­ä¸€ä¸ªå·®é€Ÿå™¨çš„å°é”™è¯¯ä¼šä½¿æˆ‘ä»¬çš„æ•´ä¸ªç³»ç»Ÿå˜å¾—æ¯«æ— ç”¨å¤„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­åˆ†æ­¥è¿›è¡Œæµ‹è¯•ã€‚æœŸå¾…æ—‹è½¬ï¼

å¦‚æœæƒ³ä¸€æ¬¡å¤åˆ¶æ‰€æœ‰çš„ç±»ï¼Œå¯ä»¥ä» [my Github](https://github.com/dennisbakhuis/Tutorials/tree/master/2_Neural_Network) ä¸‹è½½ã€‚

# 4.å®ƒåšäº†å®ƒåº”è¯¥åšçš„äº‹æƒ…å—ï¼Ÿ

æ²¡æœ‰ä»€ä¹ˆæ¯”ç©ºç­‰æ›´çƒ¦äººçš„äº†ã€‚å› æ­¤ï¼Œé‡è¦çš„æ˜¯é¦–å…ˆæµ‹è¯•å®¹æ˜“çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯èŠ±å‡ ä¸ªå°æ—¶è®­ç»ƒï¼Œçœ‹çœ‹ä½ åœ¨æŸå¤±å‡½æ•°ä¸­çŠ¯äº†ä¸€ä¸ªé”™è¯¯ã€‚è®©æˆ‘ä»¬é‡å¤ä¸Šæ¬¡å®éªŒä¸­åšè¿‡çš„å®éªŒã€‚

## çº¿æ€§å›å½’:25 å†æ¥ä¸€é

æˆ‘ä»¬ç”¨å‡ ä¸ªè¾“å…¥å€¼ *ğ‘‹* åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨è¶…çº§å¤æ‚çš„å…¬å¼ *ğ‘¦* =2 *ğ‘¥* +1 æä¾› *ğ‘Œ* ã€‚åœ¨ Numpy ä¸­æ˜¯è¿™æ ·çš„:

ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ„å»ºæˆ‘ä»¬çš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å°†å°è¯•æ‰¾åˆ°æˆ‘ä»¬çš„å›°éš¾å…¬å¼å¹¶åŒ¹é… 25 çš„çœŸå®å€¼ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å¯åŠ¨æˆ‘ä»¬çš„æ–°ç±»ï¼Œå¹¶å°†æŸå¤±è®¾ç½®ä¸ºå‡æ–¹è¯¯å·®ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªå•å±‚ï¼Œåªæœ‰ä¸€ä¸ªç¥ç»å…ƒï¼Œæ²¡æœ‰æ¿€æ´»åŠŸèƒ½ã€‚è®©æˆ‘ä»¬ä¹Ÿè¯•è¯•æˆ‘ä»¬æ¼‚äº®çš„å°åˆ·:-)

ç°åœ¨æˆ‘ä»¬å°†å†æ¬¡éœ€è¦æˆ‘ä»¬çš„è®­ç»ƒå¾ªç¯ã€‚ä¸Šæ¬¡çš„é€»è¾‘å›å½’æ¨¡å‹çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰:

æˆæœ¬å¦‚é¢„æœŸçš„é‚£æ ·ä¸‹é™ï¼Œå¹¶ä¸”ç”±äºé•¿æ—¶é—´çš„è®­ç»ƒï¼Œè¯¥å€¼æ¥è¿‘æœºå™¨ç²¾åº¦ã€‚å½“æˆ‘ä»¬åœ¨ forward æ–¹æ³•ä¸­è¾“å…¥ 12 æ—¶ï¼Œæˆ‘ä»¬ä¼šå†æ¬¡æ‰¾åˆ° 25 å—ï¼Ÿ

```
array([[25.00000019]])
```

å½“ç„¶ï¼Œæˆ‘ä»¬æœ‰ï¼

## é€»è¾‘å›å½’:æ³°å¦å°¼å…‹å·æ•°æ®é›†çš„åˆä¸€æ¬¡å°è¯•

åæ¶ˆæ¯ï¼Œæ³°å¦å°¼å…‹å·åˆæ²‰äº†ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªäºŒå…ƒé€»è¾‘åˆ†ç±»å™¨ã€‚æ²¡æœ‰è¿‡å¤šè¯„è®ºï¼Œæˆ‘ä»¬å¯¼å…¥æ•°æ®(æ¥æº: [Kaggle æ³°å¦å°¼å…‹å·æ¯”èµ›/ç”± Azeem Bootwala](https://www.kaggle.com/azeembootwala/titanic) é¢„å¤„ç†):

æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæœ‰ 14 ä¸ªè¾“å…¥ç‰¹å¾çš„æ¨¡å‹ï¼Œå½“ç„¶è¿˜æœ‰ sigmoid æ¿€æ´»å‡½æ•°ã€‚æŸå¤±å‡½æ•°å°†æ˜¯äº¤å‰ç†µï¼Œè¿™æ˜¯é»˜è®¤çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æŒ‡å®šå®ƒã€‚

åœ¨åˆ›å»ºè®­ç»ƒå¾ªç¯ä¹‹å‰ï¼Œæˆ‘ä»¬åƒä¸Šæ¬¡ä¸€æ ·å®šä¹‰ä¸€ä¸ªç²¾åº¦å‡½æ•°æ¥å¿«é€Ÿè®¡ç®—ç²¾åº¦ã€‚ä¸Šæ¬¡æˆ‘ä»¬æœ‰å¤§çº¦ 80%çš„å‡†ç¡®ç‡ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¿è¡Œè®­ç»ƒå¾ªç¯ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½åŒ¹é…å‰é¢çš„ç»“æœã€‚

```
cost: 0.6912384614194468 	accuracy: 58.7%
cost: 0.5140056920509907 	accuracy: 75.9%
cost: 0.4824062497934128 	accuracy: 79.5%
cost: 0.4697113881273363 	accuracy: 79.5%
cost: 0.46275860969195476 	accuracy: 79.8%
cost: 0.45807429458700816 	accuracy: 79.8%
cost: 0.4544915367177524 	accuracy: 79.8%
cost: 0.4515471545581365 	accuracy: 80.8%
```

å¦‚ä½ æ‰€è§ï¼Œä¸€ç‚¹ä¹Ÿä¸å·®ã€‚

## æ›´å¤šçš„ç¥ç»å…ƒå’Œå±‚:å¤æ‚çš„èŠ±æœµ

é…·çš„ä¸œè¥¿ä»æ›´å¤æ‚çš„åŠŸèƒ½å¼€å§‹ã€‚æ¥è‡ªå´æ©è¾¾çš„[æ·±åº¦å­¦ä¹ è¯¾ç¨‹](https://www.coursera.org/learn/neural-networks-deep-learning?specialization=deep-learning)å±•ç¤ºäº†ä¸€ç§ä½¿ç”¨å¤šèŠ‚ç‚¹æ¨¡å‹é¢„æµ‹[ç«ç‘°å‡½æ•°](https://en.wikipedia.org/wiki/Rose_(mathematics))çš„æ–¹æ³•ã€‚è®©æˆ‘ä»¬ä¹Ÿè¯•è¯•å§ï¼

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥æ•°æ®ã€‚ç”Ÿæˆæ•°æ®çš„ä»£ç åœ¨ [Github](https://github.com/dennisbakhuis/Tutorials/tree/master/2_Neural_Network) ä¸Šçš„ Jupyter ç¬”è®°æœ¬é‡Œã€‚

![](img/4b4e75a2214c6cf7342753f0aba311b2.png)

å›¾ 7:è¾“å…¥æ•°æ®çš„å¯è§†åŒ–ã€‚

æ•°å­¦æ–¹ç¨‹å¼åˆ›é€ äº†ç¾ä¸½çš„èŠ±çŠ¶ç»“æ„ï¼Œå¦‚å›¾ 7 æ‰€ç¤ºã€‚æˆ‘ä»¬å·²ç»å°† 7 ä¸ªèŠ±ç“£ä¸­çš„ 3 ä¸ªç€è‰²ä¸ºä¸åŒçš„å€¼ï¼Œç°åœ¨å°†ä½¿ç”¨æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œæ¥é¢„æµ‹ xï¼Œy åæ ‡ä¸Šçš„å€¼åº”è¯¥æ˜¯ 0 è¿˜æ˜¯ 1(é¢œè‰²)ã€‚

ä½†åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆå±•ç¤ºä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬è¯•å›¾ç”¨ä¸€ä¸ªè¿‡äºç®€å•çš„æ¨¡å‹æ¥é¢„æµ‹æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œæ¯”å¦‚é€»è¾‘å›å½’ï¼Œå®ƒåªèƒ½æœ‰ä¸€ä¸ªçº¿æ€§è¾¹ç•Œã€‚åœ¨ä¸‹ä¸€ä¸ªä»£ç ç‰‡æ®µä¸­ï¼Œæˆ‘åŒ…å«äº†æ¨¡å‹åˆ›å»ºã€è®­ç»ƒå¾ªç¯å’Œå¯è§†åŒ–ç»“æœçš„å¸®åŠ©å‡½æ•°ã€‚

ç»“æœæ˜¾ç¤ºåœ¨å›¾ 8 çš„å·¦ä¾§ã€‚è‚¯å®šä¸æ˜¯å¾ˆåˆé€‚ï¼Œè€Œä¸”æ˜æ˜¾æ˜¯ä¸€æ¡çº¿ã€‚ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªæœ‰å››ä¸ªå•å…ƒçš„å±‚åˆ°æ¨¡å‹ä¸­ï¼Œæœ€åä¸€å±‚æ˜¯ç›¸åŒçš„ Sigmoid å±‚ã€‚æˆ‘ä»¬ä¿ç•™çš„è¿™ä¸ªæ¨¡å‹çš„æ¿€æ´»å‡½æ•°ä¸ Andrew çš„ç›¸ä¼¼ï¼Œå®ƒæœ‰ä¸€ä¸ª Tanh æ¿€æ´»å‡½æ•°ã€‚

![](img/53bcfb0ae2cd728097863ebb0f6d904c.png)

å›¾ 8:åŒä¸€èŠ±å½¢å‡½æ•°çš„ä¸¤ç§æ‹Ÿåˆã€‚åœ¨å›¾ 8a ä¸­ï¼Œé€»è¾‘å›å½’æ¨¡å‹åªèƒ½æ‹Ÿåˆä¸€æ¡çº¿ï¼Œè€Œå›¾ 8b ä¸­çš„ä¸¤å±‚æ¨¡å‹å¯ä»¥æ‹ŸåˆèŠ±çš„å¤æ‚å½¢çŠ¶ã€‚

è¿™çœŸçš„è®©æˆ‘å¾ˆæƒŠè®¶ã€‚å†å¤šä¸€å±‚ï¼Œæˆ‘ä»¬å°±æœ‰èƒ½åŠ›å­¦ä¹ è¿™ä¸ªæ›´å¤æ‚çš„åŠŸèƒ½ã€‚éå¸¸æ£’çš„ä¸œè¥¿ï¼

# 5.ç¬¦åˆä»ç©†æ–¯å¡”æ³•æˆªè·çš„ä¿¡æ¯

å› ä¸ºä»Šå¤©æ˜¯ 5 æœˆ 4 æ—¥(ä¸ä½ åŒåœ¨)ï¼Œæˆ‘ä»¬æˆªè·äº†ä¸€ä»½æ¥è‡ªç©†æ–¯å¡”æ³•çš„ç§˜å¯†ç”µæŠ¥ï¼Œè¿™ä¸å¯èƒ½æ˜¯å·§åˆã€‚æœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬ç”¨è¿™äº›æ•°æ®è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ï¼Œè¿™æ ·æˆ‘ä»¬çš„ ai (read: model)å°±å¯ä»¥å®Œå…¨ç†è§£è¿™ç§ä¼ è¾“çš„æœ¬è´¨ã€‚

ç¬¬ä¸€æ­¥æ˜¯å¯¼å…¥æ•°æ®ï¼Œå³ 2d ä¼ è¾“æ•°æ®ã€‚æˆ‘è¿˜åˆ›å»ºäº†ä¸€äº›è¾…åŠ©å‡½æ•°æ¥åˆ›å»ºæ¨¡å‹ï¼Œä¸€ä¸ªè®­ç»ƒå¾ªç¯ï¼Œä»¥åŠä¸€ä¸ªå¯è§†åŒ–å’Œåˆ†æä¼ è¾“çš„å‡½æ•°ã€‚

å½“ä½ åˆ›å»ºæ›´å¤§çš„æ¨¡å‹ï¼Œå°¤å…¶æ˜¯æ›´å¤æ‚çš„æ¨¡å‹æ—¶ï¼Œä½ ä¼šå‘ç°è¶…å‚æ•°çš„æ•°é‡ä¼šå¤§å¤§å¢åŠ ã€‚æœ‰å…³äºå¦‚ä½•é€‰æ‹©å®ƒä»¬çš„æŒ‡å¯¼æ–¹é’ˆï¼Œä½†æ²¡æœ‰é‡‘ç§‘ç‰å¾‹ï¼Œå› æ­¤ï¼Œä½ ç»å¸¸è¦å°è¯•å¾ˆå¤šã€‚

æˆ‘åšäº†ä¸€ä¸ªå‚æ•°æ‰«æï¼Œå…¶ä¸­æˆ‘è‡ªåŠ¨æœç´¢ä»¥æ‰¾åˆ°æœ€ä½³çš„å±‚æ•°ã€å•å…ƒæ•°å’Œè¿­ä»£æ•°ã€‚æˆ‘åšå¾—å¾ˆç²—ç³™ï¼ŒèŠ±äº† 15 ä¸ªå°æ—¶è¿è¡Œäº†è¿‘ 100 ä¸ªæ¨¡å‹ã€‚å‚æ•°æœç´¢åŒ…å«åœ¨ Jupyter ç¬”è®°æœ¬çš„é™„å½•éƒ¨åˆ†ã€‚ä»¥ä¸‹å‚æ•°ç»™å‡ºäº†å¾ˆå¥½çš„ç»“æœï¼ŒæŸè€—ä½äº 0.09ã€‚æŸå¤±å€¼æœ¬èº«æ²¡æœ‰æ„ä¹‰ï¼Œå®ƒåªæ˜¯é¢„æµ‹å€¼ä¸çœŸå®å€¼åŒ¹é…ç¨‹åº¦çš„åº¦é‡ï¼Œåº”è¯¥æœ€å°åŒ–ã€‚ä½ å¯ä»¥è‡ªå·±å°è¯•è¿™äº›è®¾ç½®ã€‚å¦‚æœå‘ç°æ›´å¥½çš„å‚æ•°ï¼Œè¯·åˆ†äº«ç»™æˆ‘:-)ã€‚

```
[
  1 -> Dense layer (nx=2, nh=27, activation=relu)
  2 -> Dense layer (nx=27, nh=31, activation=relu)
  3 -> Dense layer (nx=31, nh=31, activation=relu)
  4 -> Dense layer (nx=31, nh=1, activation=sigmoid)
]
There are 1973 trainable parameters in the model.
```

æˆ‘ä»¬çš„æ¨¡å‹æœ‰å››ä¸ªè¿ç»­çš„å±‚ã€‚å‰ä¸‰ä¸ªæœ‰è®¸å¤šå•å…ƒå’Œ Relu æ¿€æ´»åŠŸèƒ½ã€‚æœ€åä¸€å±‚æ˜¯ç®€å•çš„é€»è¾‘å±‚ã€‚æˆ‘ä»¬çš„å®ç°æ²¡æœ‰ pyTorch æˆ– Tensorflow ä¸­æä¾›çš„æ‰€æœ‰åŠŸèƒ½(å¯ä»¥éšæ„æ·»åŠ )ã€‚ä¸€ä»¶å¾ˆæ£’çš„äº‹æƒ…æ˜¯åœ¨è®­ç»ƒæ—¶è°ƒæ•´å­¦ä¹ é€Ÿåº¦ã€‚é¦–å…ˆä»¥è¾ƒå¤§çš„å­¦ä¹ é€Ÿç‡å¼€å§‹ï¼Œå½“ä½ æ¥è¿‘æ”¶æ•›ç‚¹æ—¶é™ä½å­¦ä¹ é€Ÿç‡ã€‚ä¸‹é¢çš„æ–¹æ³•å°±æ˜¯æ¨¡æ‹Ÿè¿™ä¸€ç‚¹ã€‚

```
1000 -> cost: 0.42574001278351997
2000 -> cost: 0.310616390460577
2000 -> cost: 0.21932529403735668
2000 -> cost: 0.15604826952436227
4000 -> cost: 0.11089920071653515
5000 -> cost: 0.09616265347246447
8000 -> cost: 0.09046567290400138
4000 -> cost: 0.08879263912657591
```

ç»è¿‡ 28000 æ¬¡è¿­ä»£åï¼Œæˆ‘ä»¬è¾¾åˆ°äº†ä¸€ä¸ªè¶³ä»¥åˆ†ææ•°æ®çš„æ”¶æ•›çŠ¶æ€ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ testModel å‡½æ•°ã€‚ä½¿ç”¨ *h* å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥[å¢å¼ºæˆ‘ä»¬æ¶ˆæ¯çš„åˆ†è¾¨ç‡](https://www.youtube.com/watch?v=Vxq9yj2pVWk)ã€‚å„ç§â€œå¢å¼ºâ€çš„ç»“æœå¦‚å›¾ 9 æ‰€ç¤ºã€‚

![](img/be324d651128f104d64f9d4ae741a239.png)

å›¾ 9:ç°åœ¨æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå¯æ€•çš„äº‹å®:è¿™æ¡ä¿¡æ¯æ˜¯å…³äºè¥¿æ–¯å°Šä¸»æœ¬äººçš„ï¼

å“¦ï¼Œå¤©å“ªï¼Œæ˜¯é»‘é­”ç‹æœ¬äººï¼å•Šå•Šï¼å½“ç„¶ï¼Œæ²¡æœ‰æé«˜åˆ†è¾¨ç‡è¿™æ ·çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åªæ˜¯ç”¨æ›´å¤§çš„ç½‘æ ¼æ¥å¡«å……ç¥ç»ç½‘ç»œã€‚ç»“æœè¿˜æ˜¯è›®ç‰›é€¼çš„ï¼Œæˆ‘å¿…é¡»è¯´æˆ‘è‡ªå·±:-)ã€‚

ä¸‹ä¸€ä¸ªå¾ˆé…·çš„å°è¯•æ˜¯ä½¿ç”¨ RGB å›¾åƒä½œä¸ºè¾“å…¥ã€‚ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦è°ƒæ•´è¾“å…¥å›¾åƒçš„å½¢çŠ¶ï¼Œä½¿ RGB é€šé“å‚ç›´å †å ã€‚å¯¹äºæˆ‘ä»¬å½“å‰çš„è¾“å…¥å›¾åƒï¼Œè¿™æ„å‘³ç€ä¸‰å€é•¿çš„è¾“å…¥å‘é‡(ä¸‰ä¸ªé€šé“)ã€‚åˆ›å»ºå’Œæ“ä½œè¾“å…¥æ•°æ®çš„ç¨‹åºå¯åœ¨ [Jupyter ç¬”è®°æœ¬](https://github.com/dennisbakhuis/Tutorials/tree/master/2_Neural_Network)ä¸­æ‰¾åˆ°ã€‚è¾“å…¥å›¾åƒçš„å‰ªè´´ç”»æºæ˜¯ä»[niceclipart.com](http://niceclipart.com/6378/star-wars-darth-vader.html)ä¸‹è½½çš„ã€‚

# å›´æ•

æˆ‘å¸Œæœ›ä½ ä»¬ç©å¾—å¼€å¿ƒï¼Œå†™è‡ªå·±çš„ç¥ç»ç½‘ç»œã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œä»å¤´å¼€å§‹å†™è¿™äº›ä¸œè¥¿æ˜¯äº†è§£å®ƒå®é™…ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„æœ€å¥½æ–¹æ³•ã€‚æˆ‘å¸Œæœ›ä½ èƒ½çœ‹åˆ°è¿™äº›ç³»ç»Ÿå¹¶ä¸ç¥å¥‡ï¼Œåªæ˜¯ç®€å•çš„çŸ©é˜µä¹˜æ³•ï¼Œä¸å¹¸çš„æ˜¯å®ƒä»¬éå¸¸å¤šã€‚æœ€å›°éš¾çš„éƒ¨åˆ†å½“ç„¶æ˜¯åå‘ä¼ æ’­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¢¯åº¦ã€‚æˆ‘ä»¬ç®€å•çš„ç¥ç»ç½‘ç»œæ˜¯ç›¸å½“å¯è¡Œçš„ï¼Œä½†å¢åŠ æ›´å¤šçš„å±‚å’Œä¸åŒç±»å‹çš„å±‚ï¼Œä¼šä½¿å®ƒå˜å¾—æœ‰ç‚¹éº»çƒ¦ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæœ¬è´¨è¿˜æ˜¯å’Œæˆ‘ä»¬ä»Šå¤©æ‰€åšçš„éå¸¸ç›¸ä¼¼ã€‚

æˆ‘çš„å»ºè®®æ˜¯å°è¯•ä¸€ä¸‹è¿™äº›ç»“æ„ï¼Œé‡å†™å®ƒä»¬çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…æ›´å¥½ï¼Œä»å¤´å¼€å§‹å†™ä½ è‡ªå·±çš„ï¼

> è¿™æ˜¯ä¸€æ¡è·¯

å¦‚æœæ‚¨æœ‰ä»»ä½•æ„è§ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼åœ¨ [LinkedIn](https://linkedin.com/in/dennisbakhuis) ä¸Šéšæ„è”ç³»ã€‚