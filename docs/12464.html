<html>
<head>
<title>Predicting Covid-19 Infection Using Fuzzy Logic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用模糊逻辑预测新冠肺炎感染</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-covid-19-infection-based-on-fuzzy-logic-e434910d8809?source=collection_archive---------28-----------------------#2020-08-27">https://towardsdatascience.com/predicting-covid-19-infection-based-on-fuzzy-logic-e434910d8809?source=collection_archive---------28-----------------------#2020-08-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9745" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何利用模糊时间序列预测冠状病毒感染病例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b15241b3d9f3a04feb8bc4b8ec9f9777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bI0i55z675XMusLqoPE8mA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·利博特在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="2638" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="57a5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用时间序列预测方法是分析疫情感染率的常用方法。这将有助于我们创建更好的决策支持系统。我在这里所写的，是我在伊斯法罕科技大学 J-Asgari 教授的模糊系统课程中学到的一部分。所以我们先从时间序列的定义说起。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/825f1d9a48074e523db9e58e2096ea5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4vARciKk004dO1lQZEXFg.png"/></div></div></figure><p id="b709" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">时间序列是在连续的、在大多数情况下是等距的时间周期/时间点对一个个体或集体现象的数量特征进行的一组有规律的时序观察[ <a class="ae ky" href="https://stats.oecd.org/glossary/detail.asp?ID=2708#:~:text=A%20time%20series%20is%20a,%2C%20periods%20%2F%20points%20of%20time." rel="noopener ugc nofollow" target="_blank">更确切地说是</a> ]。时间序列数据有两种主要的预测方法:</p><p id="10ec" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">1-统计工具:阿玛 SARIMA 萨里玛[ <a class="ae ky" rel="noopener" target="_blank" href="/forecasting-covid-19-tweeting-volume-using-prophet-and-sarima-model-25206ea5b23b">更多</a> ] <br/> 2-基于神经网络的智能工具，如 RNN 和 LSTM [ <a class="ae ky" href="https://adventuresinmachinelearning.com/recurrent-neural-networks-lstm-tutorial-tensorflow/" rel="noopener ugc nofollow" target="_blank">更多</a></p><h1 id="5225" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据探索</h1><p id="5d61" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们已经查看了从<a class="ae ky" href="https://data.europa.eu/euodp/en/data/dataset/covid-19-coronavirus-data/resource/55e8f966-d5c8-438e-85bc-c7a5a26f4863" rel="noopener ugc nofollow" target="_blank">这里</a>下载的欧洲数据。此外，所有数据文件、源代码和笔记本都已上传到这个<a class="ae ky" href="https://colab.research.google.com/drive/1moAz_6JgyL9M1SY7v-4ORr-p6n-RQis0?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab 笔记本</a>上。让我们快速浏览一下数据集:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7594" class="my la it mu b gy mz na l nb nc">import pandas as pd<br/>import warnings<br/>import matplotlib.pylab as plt<br/>%pylab inline</span><span id="929b" class="my la it mu b gy nd na l nb nc">df = pd.read_excel('COVID-19.xlsx')<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/580699e4c85764d4ae1f57ca9b60ffc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrTo-PV8nj8pdvleBvFX5A.png"/></div></div></figure><p id="2e35" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">如上所示，我们必须按“continentExp”和“countriesAndTerritories”汇总数据:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="471a" class="my la it mu b gy mz na l nb nc">#Aggregate by continentExp<br/>continentExp = pd.pivot_table(df, values='cases', index=['dateRep'],columns=['continentExp'], aggfunc=np.sum, fill_value=0)</span><span id="dc25" class="my la it mu b gy nd na l nb nc">#Aggregate by countriesAndTerritories<br/>countriesAndTerritories = pd.pivot_table(df, values='cases', index=['dateRep'],columns=['countriesAndTerritories'], aggfunc=np.sum, fill_value=0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b351d5b24ba26d83f732c25294fa8222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*zvu2W5GoETbDCIW_5ez7EA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按 continentExp 汇总</p></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d3a8" class="my la it mu b gy mz na l nb nc">continentExp["Europe"].plot(figsize=(15,5), color=["green"], title='Europe')</span><span id="e474" class="my la it mu b gy nd na l nb nc">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/680585b441358db89857b0f70b54c1cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_quaHjFbVhBfRtUssoemVg.png"/></div></div></figure><h1 id="b477" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模糊时间序列预测</h1><p id="60b3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1965 年，扎德提出了模糊集的概念，作为检验未知隶属度的工具。许多模糊研究试图将这种方法作为理论框架，并广泛应用于自然科学和社会科学的研究领域，取得了良好的研究成果。模糊时间序列也是从模糊集概念中衍生出来的一种分析方法。由扎德提出的模糊集有许多表现形式，如模糊集、模糊决策分析和模糊时间序列。<a class="ae ky" href="https://www.intechopen.com/books/time-series-analysis-data-methods-and-applications/fuzzy-forecast-based-on-fuzzy-time-series" rel="noopener ugc nofollow" target="_blank">【1</a>。</p><h2 id="7114" class="my la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">pyFTS 库是什么？</h2><p id="b81d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个软件包是为学生，研究人员，数据科学家，或谁想要利用模糊时间序列方法。这些方法提供了简单，易于使用，计算成本低，人类可读的模型，适用于统计外行专家。<a class="ae ky" href="https://github.com/PYFTS/pyFTS" rel="noopener ugc nofollow" target="_blank"> Github </a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/a58df0a453ad2edf893177d3aa733479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PtUwhPnf8vC12F9sX5mFA.png"/></div></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8ba6" class="my la it mu b gy mz na l nb nc">#install pyFTS<br/>!pip install pyFTS</span><span id="bad2" class="my la it mu b gy nd na l nb nc">Collecting pyFTS   Downloading <a class="ae ky" href="https://files.pythonhosted.org/packages/41/3a/c5ef1879b33fdf07dc5678e8484d9ea637924afd6c66f14d65001cb1cddf/pyFTS-1.6-py3-none-any.whl" rel="noopener ugc nofollow" target="_blank">https://files.pythonhosted.org/packages/41/3a/c5ef1879b33fdf07dc5678e8484d9ea637924afd6c66f14d65001cb1cddf/pyFTS-1.6-py3-none-any.whl</a> (175kB)      |████████████████████████████████| 184kB 3.3MB/s  Installing collected packages: pyFTS Successfully installed pyFTS-1.6</span></pre><h2 id="d5f8" class="my la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">定义语言变量</h2><p id="57ba" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于语言变量，我们指的是其值为自然或人工语言中的单词或句子的变量。例如，年龄是一个语言变量，如果它的值是语言的而不是数字的，即年轻、不年轻、非常年轻、非常年轻、老、不太老和不太年轻[ <a class="ae ky" href="https://www.sciencedirect.com/science/article/pii/0020025575900365#:~:text=By%20a%20linguistic%20variable%20we,a%20natural%20or%20artificial%20language.&amp;text=It%20is%20shown%20that%20probabilities,very%20likely%2C%20unlikely%2C%20etc." rel="noopener ugc nofollow" target="_blank"> 2 </a> ]。</p><p id="4a36" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们定义了 10 个变量“A0 — A9”，其中 A0 的感染度最低，A9 的感染度最高。然后进行模糊化，即通过最大化方法将每条记录集合成一个模糊集。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ddfc" class="my la it mu b gy mz na l nb nc">from pyFTS.partitioners import Grid</span><span id="6140" class="my la it mu b gy nd na l nb nc">data = data.values</span><span id="eb48" class="my la it mu b gy nd na l nb nc">fs = Grid.GridPartitioner(data=data,npart=15)</span><span id="4bcb" class="my la it mu b gy nd na l nb nc">fig, ax = plt.subplots(nrows=1, ncols=1, figsize=[15,5])</span><span id="92bc" class="my la it mu b gy nd na l nb nc">fs.plot(ax)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e24269b3c89bbd69b0d3d0345115b1ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*95Glykv_s1Gj07TzStPB1w.png"/></div></div></figure><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="853f" class="my la it mu b gy mz na l nb nc">fuzzyfied = fs.fuzzyfy(data, method='maximum', mode='sets')</span><span id="51a6" class="my la it mu b gy nd na l nb nc">pd.DataFrame(fuzzyfied).assign(values = list(data)).tail()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/5272cc0c6c7229a6008861912889768c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0AD9YCG9lcCv0hKvsZSIiw.png"/></div></div></figure><h2 id="9b3d" class="my la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">时间模式</h2><p id="a1e0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这部分描述了考虑先例→结果逻辑已经生成的规则，例如，在 A0 先例之后，我们移动到 A0 和下一个时间步(t+1) A1。所以这里我们有:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="7433" class="my la it mu b gy mz na l nb nc">from pyFTS.common import FLR</span><span id="d3b5" class="my la it mu b gy nd na l nb nc">patterns = FLR.generate_non_recurrent_flrs(fuzzyfied)</span><span id="750e" class="my la it mu b gy nd na l nb nc">print([str(k) for k in patterns])</span><span id="e733" class="my la it mu b gy nd na l nb nc">output: 'A0 -&gt; A0', 'A0 -&gt; A1', 'A1 -&gt; A1', 'A1 -&gt; A2', 'A2 -&gt; A2', 'A2 -&gt; A3', 'A3 -&gt; A3' ... ,'</span></pre><h2 id="9bed" class="my la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">规则生成</h2><p id="5a77" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在生成模糊规则时，需要解决类之间的重叠。有两种解决重叠的方法:一种是在不考虑重叠的情况下生成模糊规则，然后通过调整模糊规则来解决重叠；另一种是在生成模糊规则的同时解决重叠。我们把前者的静态模糊规则生成和后者的动态模糊规则生成[ <a class="ae ky" href="https://link.springer.com/chapter/10.1007/978-1-4471-0285-4_5" rel="noopener ugc nofollow" target="_blank">更称为</a> ]。</p><p id="21e9" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">根据我们上面讨论的模式，可以生成时间步长移动的规则。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2bdf" class="my la it mu b gy mz na l nb nc">from pyFTS.models import chen</span><span id="6835" class="my la it mu b gy nd na l nb nc">model = chen.ConventionalFTS(partitioner=fs)</span><span id="61c2" class="my la it mu b gy nd na l nb nc">model.fit(data)</span><span id="bbdc" class="my la it mu b gy nd na l nb nc">print(model)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/72eda8003f879e28198df119d557b813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhznICoZH5dnMidvqO69uQ.png"/></div></div></figure><p id="f4b4" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">上述规则显示了每个语言变量的先例和后果，并生成规则。也就是说，在 A0 中发生的任何数据都有 A0 和 A1 的结果，这意味着在 A0 之后没有 A2 的数据。</p><h2 id="5063" class="my la it bd lb nh ni dn lf nj nk dp lj ma nl nm ll me nn no ln mi np nq lp nr bi translated">模糊化和建模</h2><p id="b092" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">模糊化就是将模糊域中的连续量分成几个层次，根据需要，每一个层次都可以看作一个模糊变量，并对应一个模糊子集或一个隶属函数[ <a class="ae ky" href="https://www.sciencedirect.com/topics/engineering/fuzzification" rel="noopener ugc nofollow" target="_blank"> more </a> ]。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f923" class="my la it mu b gy mz na l nb nc">fuzzyfied = fs.fuzzyfy(18876, method='maximum', mode='sets')</span><span id="a0da" class="my la it mu b gy nd na l nb nc">fig, ax = plt.subplots(nrows=1, ncols=1, figsize=[15,5])</span><span id="cb40" class="my la it mu b gy nd na l nb nc">forecasts = model.predict(data)</span><span id="8151" class="my la it mu b gy nd na l nb nc">forecasts.insert(0,None)</span><span id="19af" class="my la it mu b gy nd na l nb nc">orig, = plot(data, label="Original data")</span><span id="f74d" class="my la it mu b gy nd na l nb nc">pred, = plot(forecasts, label="fuzzified forecast")</span><span id="fe13" class="my la it mu b gy nd na l nb nc">legend(handles=[orig, pred])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/8a57c842f99b2f47c863b7d625b4394a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggFJFc80O-pVnQb7txOsBw.png"/></div></div></figure><h1 id="5661" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="8f78" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/forecasting-covid-19-tweeting-volume-using-prophet-and-sarima-model-25206ea5b23b"> ARIMA 时间序列</a>预测中的方法可以预测平均误差。利用模糊时间序列中的公式，我们可以求出平均误差。模糊时间序列的误差值小于 ARIMA 时间序列的误差值。因此可以得出结论，模糊时间序列比其他时间序列模型有更好的结果。</p><h1 id="145f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">参考</h1><p id="67a8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><a class="ae ky" href="https://stats.oecd.org/glossary/detail.asp?ID=2708#:~:text=A%20time%20series%20is%20a,,%20periods%20/%20points%20of%20time." rel="noopener ugc nofollow" target="_blank">经合组织</a></p><p id="9737" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><a class="ae ky" href="https://link.springer.com/chapter/10.1007/978-1-4471-0285-4_5" rel="noopener ugc nofollow" target="_blank">静态模糊规则生成</a></p><p id="9719" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/forecasting-covid-19-tweeting-volume-using-prophet-and-sarima-model-25206ea5b23b">使用 Prophet 和 SARIMA 模型预测新冠肺炎的推文量</a></p><p id="5a63" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><a class="ae ky" href="https://www.sciencedirect.com/topics/engineering/fuzzification" rel="noopener ugc nofollow" target="_blank">科学指导</a></p><p id="456b" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/a-short-tutorial-on-fuzzy-time-series-dcc6d4eb1b15">模糊时间序列的简短教程</a></p></div></div>    
</body>
</html>