<html>
<head>
<title>Using K-Means to detect changes in a retail store</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 K-Means 检测零售店中的变化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-k-means-to-detect-changes-in-a-retail-store-96af1476dd9f?source=collection_archive---------31-----------------------#2020-05-15">https://towardsdatascience.com/using-k-means-to-detect-changes-in-a-retail-store-96af1476dd9f?source=collection_archive---------31-----------------------#2020-05-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c167ad12124c1839aa2650f5c42e1c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*l0qtcDYgfenycwLQ"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">迈克·彼得鲁奇在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="6825" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">识别消费者行为变化的无监督技术</h1><p id="df7d" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi lz translated"><span class="l ma mb mc bm md me mf mg mh di"> U </span>当识别特定时期之间的变化时，受监督的机器学习算法会非常有用。</p><p id="a9ea" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">我将为批发商看一家零售商店。作为一家商店，你可能会期望或可能会瞄准你的客户群中的一些规律性。考虑到这一点，我将解释如何识别在一定时期内购买行为发生变化的客户。这种类型的分析可用于不同的领域。例如，它可以用来瞄准那些购买量较少的客户。在这种情况下，商店可以通过向他们提供折扣来留住他们。</p><p id="4877" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">我就不为了岗位而去走一遍整个数据科学的流程了。为了简明扼要，我将跳过这些步骤。如果你想了解更多关于解决业务问题的数据科学过程，看看这篇关于<a class="ae kc" rel="noopener" target="_blank" href="/once-again-crisp-dm-methodology-13f02557b632"> CRISP-DM 方法论</a>的帖子。</p><h2 id="2b57" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">数据</h2><p id="74e0" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">它是一个管状数据集，包含英国零售商店中不同客户的交易。这里是公开的<a class="ae kc" href="http://archive.ics.uci.edu/ml/datasets/Online+Retail" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9c48" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">它包含材料采购的发票。来自 38 个国家 4372 个不同客户的 541909 张不同发票。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/64fc52f633bb5c50a37bf9a4d05cdd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lnNLMGIXRZ4nDTHwwEYY0Q.png"/></div></div></figure><p id="7169" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">交易时间从 2011 年 12 月到 2012 年 12 月不等。</p><h2 id="9fde" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">问题</h2><p id="b6f2" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">乍一看，该数据集没有给出任何有关客户购买行为发生变化的提示。缺乏标签使得不可能应用监督技术，因为没有任何东西明确他们是哪种类型的顾客。这在一个层面上增加了问题的难度，其中有许多细微差别和未决问题。</p><p id="0ecb" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">在所有的机器学习问题中，对问题有很好的理解对于给出量身定制的解决方案至关重要。根据业务问题的不同，会有许多不同的方法。</p><h2 id="454e" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">考虑</h2><p id="567d" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们将根据客户的行为对他们进行分组。为此，我们将使用两个变量，即每月采购频率和货币价值。</p><p id="8743" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">在 13 个月的购买活动中，我会比较两个时期的活动。第一个创建行为的基线，第二个评估它。对于前者，我们将使用 8 个月，对于后者，我们将使用 5 个月。它将分别占 60%和 40%的时间。</p><p id="6bfe" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">谈到技术细节，K-Means 是在数据中寻找相似性的好算法。将数据分成 5 组将足够大，但不会大到对微小的变化敏感。</p><p id="7370" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">由于商店的目标是增加购买频率或消费金额，因此可以用以下名称对这些群体进行分类:</p><ul class=""><li id="50b3" class="ne nf iq ld b le mi li mj lm ng lq nh lu ni ly nj nk nl nm bi translated">休眠——很少访问，很少花钱。他们可能需要大的刺激来重新激活它们。</li><li id="f00e" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">潜在客户——与最后一组相似，区别在于使他们成为更好的客户的刺激较小。</li><li id="7fca" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">中—普通用户。</li><li id="ce85" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">不定期——他们很少去，但去的时候往往会花很多钱。</li><li id="aa9a" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">忠诚——他们经常光顾商店，但不会花很多钱。</li></ul><p id="30d2" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">根据公司的战略，名称和组号可能会有所不同。数据科学和利益相关者之间的良好沟通和理解对于将业务需求正确转化为模型非常重要。</p><p id="4a55" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated"><strong class="ld ir">K-Means 快速介绍</strong></p><p id="2651" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">这是最著名和最常用的无监督算法。它允许对数据进行分组或分类，这是您自己从未想到过的。此外，K-Means 属于硬聚类算法组，其原因是因为一旦分类完成，数据点就属于一个且仅属于一个组。另一方面，软聚类算法同时将数据分配给不同的组。</p><p id="689a" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">K-Means 的工作方式是，给定聚类的数量，它将根据到数据点的距离自动调整所有组的中心，直到算法收敛。一面之词，有不同类型的距离！K-Means 使用欧几里得距离(它是两个数据点之间的几何距离)。</p><p id="0bf2" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">使用 K-Means 的主要问题是算法不能自动计算最佳的聚类数。所以集群的数量取决于要解决的业务问题和屏幕后面的用户。然而，一些技术可以帮助用户估计最适合的聚类数。这被称为肘方法，但它不包括在这篇文章中。</p><h2 id="617d" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">K-Means 如何有助于检测变化？</h2><p id="8acc" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在执行一些数据预处理操作后，这就是数据的样子。</p><pre class="na nb nc nd gt ns nt nu nv aw nw bi"><span id="14ef" class="mn ke iq nt b gy nx ny l nz oa">tx.describe()</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/f5d490b5f148d03bcfcabd93c0906a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*ciqADeEKFPhLSIuqMgyfeQ.png"/></div></figure><p id="daf0" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">值得注意的是，两个变量(频率和货币值)都有一些异常值:</p><ul class=""><li id="20a0" class="ne nf iq ld b le mi li mj lm ng lq nh lu ni ly nj nk nl nm bi translated">在价格上，中位数是 136 英镑，平均数是 390 英镑(与 1887 年的标准偏差相当大)。接下来，我将不包括花费超过 20，000 英镑的客户。</li><li id="0429" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">关于每月的总发票，中位数是每月 1 次访问，平均数是 0.8 次访问(标准偏差为 1.2)。在此之后，每月访问次数超过 15 次的客户将不会包括在分析中。</li></ul><p id="552d" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">请注意，根据分析的性质，选择要移除的异常值可能会有所不同。</p><h2 id="f18a" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">分割数据集</h2><p id="608d" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，是时候在基线期(8 个月)和评估期(5 个月)之间划分数据集了。这是两个时期的样子:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/ba86d3333d496ec4a09d30f35fd7b273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xM0_ShveiwRbTpWw66zklw.jpeg"/></div></div></figure><p id="5789" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">除了非常相似之外，我们从他们身上没有什么可以得到的。让我们开始分组吧。</p><h2 id="3a3f" class="mn ke iq bd kf mo mp dn kj mq mr dp kn lm ms mt kr lq mu mv kv lu mw mx kz my bi translated">k-表示动手！</h2><p id="996e" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如前所述，K-Means 使用欧几里得距离工作，这使得它在变量的尺度不同时很敏感。这是两个变量的情况。我将应用 0 到 1 之间的范围。</p><pre class="na nb nc nd gt ns nt nu nv aw nw bi"><span id="a907" class="mn ke iq nt b gy nx ny l nz oa">from sklearn.preprocessing import MinMaxScaler<br/>scaler = MinMaxScaler(feature_range = (0, 1))</span><span id="85cd" class="mn ke iq nt b gy od ny l nz oa">baseline_norm = pd.DataFrame(scaler.<strong class="nt ir">fit_transform(baseline)</strong>, <br/> index = baseline.index, columns = [‘PriceInvoices’,’TotalInvoices’])</span><span id="3d99" class="mn ke iq nt b gy od ny l nz oa">evaluation = pd.DataFrame(<strong class="nt ir">scaler.transform(evaluation)</strong>, <br/>                          index = evaluation.index, columns = ['PriceInvoices','TotalInvoices'])</span></pre><p id="f28f" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">现在我们准备应用 K-Means 并看到一些结果:</p><pre class="na nb nc nd gt ns nt nu nv aw nw bi"><span id="15a6" class="mn ke iq nt b gy nx ny l nz oa">from sklearn.cluster import KMeans</span><span id="28c2" class="mn ke iq nt b gy od ny l nz oa"><strong class="nt ir">kmeans = KMeans(n_clusters = 5, init = ‘k-means++’, random_state = 1)</strong><br/>y_kmeans_train = kmeans.<strong class="nt ir">fit_predict(baseline_norm)</strong></span></pre><p id="622e" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">关于 K-均值函数参数的几个解释？</p><ul class=""><li id="596b" class="ne nf iq ld b le mi li mj lm ng lq nh lu ni ly nj nk nl nm bi translated">如前所述，簇的数量被设置为 5。</li><li id="9ef9" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">我们使用的初始化方法是 k-means++，它灵活地选择聚类中心，从而加快收敛速度。</li><li id="5047" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">随机状态用于使算法具有确定性，换句话说，总是返回相同的结果。</li></ul><p id="281b" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">下面是应用 K-Means 后两个周期的样子。注意，首先，我用基线数据集运行算法，以创建组。以便以后查看评估数据集中每个数据点的最接近组。</p><pre class="na nb nc nd gt ns nt nu nv aw nw bi"><span id="20e6" class="mn ke iq nt b gy nx ny l nz oa">y_kmeans_test = kmeans.<strong class="nt ir">predict</strong>(evaluation.values)</span></pre><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/64621c36bbb8dcb780722388f098a68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZYgIAmmWtj88H97chRFag.jpeg"/></div></div></figure><p id="7c45" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">在计算了从一个群集移动到另一个群集的客户端数量后，有 785 个不同的客户端。这是评估数据集中 40%的客户端。但是，检查集群变化的差异，我们可以看到许多客户端的变化非常小。这是因为许多客户端从一个集群的边缘移动到另一个集群的边缘。我们可以在下一个直方图中看到距离的分布。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f74e1682ba6d79726a55af0aaba90e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*AE8B6nw8IyYJ1sNJnPZSCQ.jpeg"/></div></figure><p id="8c22" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">为了减少标记的客户端数量，我们可以设置一个阈值，并挑选所有高于该级别的客户端。在我们的例子中，我选择了 0.25，所以它们在图表中是可见的。</p><p id="cf8a" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">最后，这些变化看起来是这样的。黄线是客户端的移动，而 X 标记是第一个位置，dop 是它们结束的位置。</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/f38805565e2fd27247ed6543b0e6a2e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xMRDT376bzGg-lX_W_S7A.jpeg"/></div></div></figure><h1 id="45f1" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论:</h1><p id="332f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们已经看到了如何使用机器学习技术来为零售店中的购买行为建模，我们使用 K-Means 实现了这一点。获得的结果可以用于不同的目的，我在这里解释的一个将适合营销目的。它有助于识别转向活动较少的群体的客户(例如，忠诚于中等)。然而，它可以外推到另一种分析。</p><p id="e146" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated"><strong class="ld ir">缺点和改进<br/> </strong>该分析有一些缺点:</p><ul class=""><li id="5452" class="ne nf iq ld b le mi li mj lm ng lq nh lu ni ly nj nk nl nm bi translated">分析完成后，客户端可能已经丢失，并且很难重新激活它们。解决这个问题的一个方法是为他们最后一次交易的时间添加一个新的变量，即最近时间。例如，RFM 分析将解决这个问题，将交易的新近性作为一个新的变量添加到分类中。</li><li id="ae49" class="ne nf iq ld b le nn li no lm np lq nq lu nr ly nj nk nl nm bi translated">大量的客户都放弃了。软聚类技术，如高斯混合模型(GMMs)将作为 K-均值的替代方法来缓解这一问题。GMMs 将给出数据点属于每个聚类的概率。例如，一个聚类边缘的数据点将有接近两个聚类的 50%-50%的概率。</li></ul><p id="080c" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">为了提高模型捕捉变化的性能，K-Means 可以处理尽可能多的变量，并且 K-Means 将按照相同的标准进行分组。然而，增加更多的变量会使可视化更加困难。</p><p id="cd80" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated"><strong class="ld ir">继续学习</strong></p><p id="2807" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">正如我上面刚刚写的几行，你可以探索 RFM 分析，这是一个在业界广泛使用的伟大分析。</p><p id="ccb0" class="pw-post-body-paragraph lb lc iq ld b le mi lg lh li mj lk ll lm mk lo lp lq ml ls lt lu mm lw lx ly ij bi translated">您可能想尝试其他非监督技术，如层次聚类或高斯混合模型。它们解决了 K-Means 的主要问题，但是请记住，即使它们解决了 K-Means 的一些问题，它们也有自己的缺点！正如所说，“天下没有免费的午餐”！</p></div></div>    
</body>
</html>