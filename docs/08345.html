<html>
<head>
<title>Build and deploy machine learning web app using PyCaret and Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PyCaret 和 Streamlit 构建和部署机器学习 web 应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104?source=collection_archive---------12-----------------------#2020-06-18">https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104?source=collection_archive---------12-----------------------#2020-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d1a8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在 Heroku PaaS 上部署机器学习应用程序的初学者指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/075103c74e9d6d0a740b51398f8e77e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HuGxT33q9tj7FQikC3EB_Q.png"/></div></div></figure><h1 id="4167" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">概述</h1><p id="343a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在我们关于在云中部署机器学习管道的<a class="ae mf" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507">上一篇文章</a>中，我们演示了如何在 PyCaret 中开发机器学习管道，用 Docker 封装 Flask 应用程序，以及使用 AWS Fargate 部署无服务器。如果你以前没有听说过 PyCaret，你可以阅读这个<a class="ae mf" rel="noopener" target="_blank" href="/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46">公告</a>来了解更多。</p><p id="146f" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在本教程中，我们将使用 PyCaret 训练一个机器学习管道，并使用<a class="ae mf" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>开源框架创建一个 web 应用。这个 web 应用程序将是一个简单的界面，供业务用户使用训练有素的机器学习管道在新的数据集上生成预测。</p><p id="c139" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">本教程结束时，您将能够构建一个功能完整的 web 应用程序，使用经过训练的机器学习模型来生成在线预测(逐个)和批量预测(通过上传 csv 文件)。最终的应用程序如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/79841e3a8d9a0f79faebc7287e5babe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-scVDUhBbOIWievCj0DYjw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated"><a class="ae mf" href="https://pycaret-streamlit.herokuapp.com" rel="noopener ugc nofollow" target="_blank">https://pycaret-streamlit.herokuapp.com</a></p></figure><h1 id="e8b4" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉您将在本教程中学到什么</h1><ul class=""><li id="de89" class="mq mr iq ll b lm ln lp lq ls ms lw mt ma mu me mv mw mx my bi translated">什么是部署，我们为什么要部署机器学习模型？</li><li id="c30f" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated">开发一个机器学习管道，用 PyCaret 训练模型。</li><li id="b68e" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated">使用 Streamlit 开源框架构建一个简单的 web 应用。</li><li id="0784" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated">在“Heroku”上部署一个 web 应用程序，并查看运行中的模型。</li></ul><p id="c952" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">本教程将涵盖整个工作流程，从训练机器学习模型和开发 Python 中的管道开始，使用 streamlit 开发简单的 web 应用程序，并在 Heroku 云平台上部署应用程序。</p><p id="5673" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">过去，我们讨论过使用 docker 的容器化以及在 Azure、GCP 和 AWS 等云平台上的部署。如果你有兴趣了解更多，你可以阅读下面的故事:</p><ul class=""><li id="c9d0" class="mq mr iq ll b lm mg lp mh ls ne lw nf ma ng me mv mw mx my bi translated"><a class="ae mf" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507">在 AWS Fargate 上部署机器学习管道</a></li><li id="6911" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated"><a class="ae mf" rel="noopener" target="_blank" href="/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b">在 Google Kubernetes 引擎上部署机器学习管道</a></li><li id="fcd1" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated"><a class="ae mf" rel="noopener" target="_blank" href="/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01">在 AWS Web 服务上部署机器学习管道</a></li><li id="7ffd" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated"><a class="ae mf" rel="noopener" target="_blank" href="/build-and-deploy-your-first-machine-learning-web-app-e020db344a99">在 Heroku PaaS 上构建和部署您的第一个机器学习 web 应用</a></li></ul><h1 id="650d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">💻本教程的工具箱</h1><h1 id="822c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">PyCaret</h1><p id="2a64" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">PyCaret 是 Python 中的一个开源、低代码机器学习库，用于训练和部署机器学习管道和模型到生产中。PyCaret 可以使用 pip 轻松安装。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="8763" class="nm ks iq ni b gy nn no l np nq">pip install <strong class="ni ir">pycaret</strong></span></pre><h1 id="1d17" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">细流</h1><p id="01ab" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mf" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>是一个开源的 Python 库，可以轻松地为机器学习和数据科学构建漂亮的定制 web 应用。使用 pip 可以轻松安装 Streamlit。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="71c1" class="nm ks iq ni b gy nn no l np nq">pip install <strong class="ni ir">streamlit</strong></span></pre><h1 id="b0fe" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">开源代码库</h1><p id="8700" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mf" href="https://www.github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>是一个基于云的服务，用于托管、管理和控制代码。假设你在一个大型团队中工作，团队中有很多人(有时有数百人)在做改变。PyCaret 本身就是一个开源项目的例子，在这个项目中，数百名社区开发人员不断地贡献源代码。如果你以前没有用过 GitHub，你可以<a class="ae mf" href="https://github.com/join" rel="noopener ugc nofollow" target="_blank">注册</a>免费账号。</p><h1 id="ce9c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">赫罗库</h1><p id="3b8a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><a class="ae mf" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>是一个平台即服务(PaaS ),支持基于托管容器系统部署 web 应用，具有集成的数据服务和强大的生态系统。简而言之，这将允许您将应用程序从本地机器带到云中，这样任何人都可以使用 Web URL 访问它。在本教程中，我们选择了 Heroku 进行部署，因为当您注册新帐户时，它会提供免费资源。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/df4bcdde5afdaba697af27550b466926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XTizEjPOR4UKJphNsjbhBw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">机器学习工作流程(从培训到 PaaS 部署)</p></figure><h1 id="ad43" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">✔️Let's 开始吧…..</h1><h1 id="ec8b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">为什么要部署机器学习模型？</h1><p id="5174" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">机器学习模型的部署是将模型投入生产的过程，以便 web 应用程序、企业软件和 API 可以使用经过训练的模型，并使用新的数据点生成预测。</p><p id="f157" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">通常构建机器学习模型，以便它们可以用于预测结果(二进制值，即用于分类<a class="ae mf" href="https://www.pycaret.org/classification" rel="noopener ugc nofollow" target="_blank">的 1 或 0</a>，用于回归<a class="ae mf" href="https://www.pycaret.org/regression" rel="noopener ugc nofollow" target="_blank">的连续值</a>，用于聚类<a class="ae mf" href="https://www.pycaret.org/clustering" rel="noopener ugc nofollow" target="_blank">的标签</a>等)。预测新数据点有两种主要方法:</p><h1 id="bddb" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉<strong class="ak">在线预测</strong></h1><p id="8d0e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在线预测场景适用于您希望为每个数据点逐个生成预测的情况。例如，您可以使用预测来立即决定某个特定交易是否可能是欺诈性的。</p><h1 id="ad1e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉<strong class="ak">批量预测</strong></h1><p id="1730" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当您想要一次为一组观测值生成预测时，批量预测非常有用。例如，如果您想决定将哪些客户作为产品广告活动的目标，您将获得所有客户的预测分数，对这些分数进行排序以确定哪些客户最有可能购买，然后将最有可能购买的前 5%客户作为目标。</p><blockquote class="ns"><p id="9e61" class="nt nu iq bd nv nw nx ny nz oa ob me dk translated">在本教程中，我们将建立一个应用程序，可以做到这两个；通过上传包含新数据点的 csv 文件进行在线预测和批量预测。</p></blockquote><h1 id="b404" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw oc jx ld jz od ka lf kc oe kd lh li bi translated">设置业务环境</h1><p id="5460" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">一家保险公司希望通过使用住院时的人口统计和基本患者健康风险指标来更好地预测患者费用，从而改善其现金流预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/0d35a8d2ddf1693e80660f604ba756ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qM1HiWZ_uigwdcZ0_ZL6yA.png"/></div></div></figure><p id="fc1b" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><em class="og"> ( </em> <a class="ae mf" href="https://www.kaggle.com/mirichoi0218/insurance#insurance.csv" rel="noopener ugc nofollow" target="_blank"> <em class="og">)数据来源</em> </a> <em class="og"> ) </em></p><h1 id="a53e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">目标</h1><p id="bb1a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">使用训练有素的机器学习模型和管道，构建支持在线(逐个)以及批量预测的 web 应用程序。</p><h1 id="9d39" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">任务</h1><ul class=""><li id="f614" class="mq mr iq ll b lm ln lp lq ls ms lw mt ma mu me mv mw mx my bi translated">使用 PyCaret 训练、验证和开发机器学习管道。</li><li id="8648" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated">构建一个前端 web 应用程序，具有两个功能:(一)在线预测和(二)批量预测。</li><li id="39a1" class="mq mr iq ll b lm mz lp na ls nb lw nc ma nd me mv mw mx my bi translated">在 Heroku 上部署 web 应用程序。一旦部署，它将成为公开可用的，并可以通过网址访问。</li></ul><h1 id="3d5d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉任务 1 —模型训练和验证</h1><p id="a826" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">培训和模型验证是在集成开发环境(IDE)或笔记本电脑中进行的，可以在本地机器上进行，也可以在云上进行。如果您以前没有使用过 PyCaret，<a class="ae mf" rel="noopener" target="_blank" href="/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46">单击此处</a>了解更多关于 PyCaret 的信息，或者在我们的<a class="ae mf" href="https://www.pycaret.org/" rel="noopener ugc nofollow" target="_blank">网站</a>上查看<a class="ae mf" href="https://www.pycaret.org/tutorial" rel="noopener ugc nofollow" target="_blank">入门教程</a>。</p><p id="7d29" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在本教程中，我们进行了两个实验。第一个实验是使用 PyCaret 中的默认预处理设置进行的。第二个实验有一些额外的预处理任务，如<strong class="ll ir">缩放和归一化、自动特征工程和宁滨连续数据到区间</strong>。参见第二个实验的设置代码:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="17f3" class="nm ks iq ni b gy nn no l np nq"><strong class="ni ir"># Experiment No. 2</strong></span><span id="14fb" class="nm ks iq ni b gy oh no l np nq">from <strong class="ni ir">pycaret.regression</strong> import <strong class="ni ir">*</strong></span><span id="d7fe" class="nm ks iq ni b gy oh no l np nq">r2 = <strong class="ni ir">setup</strong>(data, target = 'charges', session_id = 123,<br/>           normalize = True,<br/>           polynomial_features = True, trigonometry_features = True,<br/>           feature_interaction=True, <br/>           bin_numeric_features= ['age', 'bmi'])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/576adbbb6043bab32612ed897bed69e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TeqcOM-jBpkdeQu84c4Onw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">两个实验的信息网格比较</p></figure><p id="7c35" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">神奇的事情只发生在几行代码中。请注意，在<strong class="ll ir">实验 2 </strong>中，转换后的数据集有 62 个用于训练的特征，这些特征仅来自原始数据集中的 6 个特征。所有的新特性都是 PyCaret 中的转换和自动特性工程的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/1f307638b2bcd2bf363251d406b5a72d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ju5RFYKGkAVEOvVjeoM5nQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">转换后数据集中的列</p></figure><p id="342f" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">PyCaret 中模型定型的示例代码:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="7bf5" class="nm ks iq ni b gy nn no l np nq"># Model Training and Validation <br/>lr = <strong class="ni ir">create_model</strong>('lr')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/debb9c17202bd18daaa7764cadbc89b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TX-IzWHBekZBRSQi2T_JTQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">线性回归模型的 10 倍交叉验证</p></figure><p id="b74b" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">注意转换和自动特征工程的影响。R2 不费吹灰之力就增加了 10%。我们可以比较两个实验的线性回归模型的<strong class="ll ir">残差图</strong>，并观察转换和特征工程对模型的<strong class="ll ir">异方差</strong>的影响。</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="98e2" class="nm ks iq ni b gy nn no l np nq"># plot residuals of trained model<strong class="ni ir"><br/>plot_model</strong>(lr, plot = 'residuals')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/35ceeddb5dd2f45d5d8bb0f95b0710e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxVMcK4hNvBvEj1tyqxfWQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">线性回归模型的残差图</p></figure><p id="9046" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">机器学习是一个迭代的过程。迭代的次数和其中使用的技术取决于任务的关键程度，以及预测错误时的影响。在医院的 ICU 中实时预测患者结果的机器学习模型的严重性和影响远远超过为预测客户流失而建立的模型。</p><p id="9d9e" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在本教程中，我们只执行了两次迭代，第二次实验中的线性回归模型将用于部署。然而，在这个阶段，模型仍然只是笔记本/ IDE 中的一个对象。要将其保存为可以传输到其他应用程序并由其他应用程序使用的文件，请执行以下代码:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="6928" class="nm ks iq ni b gy nn no l np nq"># save transformation pipeline and model <br/><strong class="ni ir">save_model</strong>(lr, model_name = 'deployment_28042020')</span></pre><p id="3cb9" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">当您在 PyCaret 中保存一个模型时，基于在<strong class="ll ir"> setup() </strong>函数中定义的配置的整个转换管道被创建。所有的相互依赖都是自动编排的。查看存储在“deployment_28042020”变量中的管道和模型:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/524e5330b5b9b3c4a67fd19db109609a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NWoHVWJzO7i7gIvrlBnIiQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">使用 PyCaret 创建的管道</p></figure><p id="e846" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们已经完成了培训和模型选择。最终的机器学习管道和线性回归模型现在保存为 pickle 文件(deployment_28042020.pkl ),该文件将在 web 应用程序中用于生成对新数据点的预测。</p><h1 id="1685" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉任务 2 —构建 Web 应用程序</h1><p id="413b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">现在我们的机器学习管道和模型已经准备好了，我们将开始构建一个前端 web 应用程序，它可以在新的数据点上生成预测。该应用程序将通过 csv 文件上传支持“在线”以及“批量”预测。让我们将应用程序代码分成三个主要部分:</p><h1 id="e1e6" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">标题/布局</strong></h1><p id="90ab" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">该部分导入库，加载训练模型，并创建一个基本布局，顶部有一个徽标，一个 jpg 图像，边栏上有一个下拉菜单，用于在“在线”和“批量”预测之间切换。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/a0a3fb317ae6bc377163799607f0afb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAnCZ1N_BNoPW7FoA-NXrA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">app.py —代码片段第 1 部分</p></figure><h1 id="47cd" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">在线预测</strong></h1><p id="d8ed" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本节介绍应用程序的第一个功能，即在线(逐个)预测。我们使用 streamlit 小部件，如<em class="og">数字输入、文本输入、下拉菜单和复选框</em>来收集用于训练模型的数据点，如年龄、性别、身体质量指数、儿童、吸烟者、地区。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/4cf119b32a91f815e163a73f613006a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFeq1wINsUUnvLJfuL-GOA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">app.py —代码片段第 2 部分</p></figure><h1 id="2e4e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">批量预测</strong></h1><p id="7eea" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这部分处理第二个功能，即批量预测。我们已经使用 streamlit 的<strong class="ll ir"> file_uploader </strong>小部件上传了一个 csv 文件，然后从 PyCaret 调用原生的<strong class="ll ir"> predict_model() </strong>函数来生成使用 streamlit 的 write()函数显示的预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/aec59199125171120d49ba7ca4b1ded9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-g2iLy_gV7hom71PM3CEA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">app.py —代码片段第 3 部分</p></figure><p id="ea82" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果您还记得上面的任务 1，我们最终确定了一个线性回归模型，该模型使用 6 个原始特征提取了 62 个特征。然而，我们的 web 应用程序的前端有一个输入表单，只收集六个特征，即年龄、性别、bmi、儿童、吸烟者、地区。</p><p id="572b" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们如何将新数据点的 6 个特征转换成用于训练模型的 62 个特征？我们不需要担心这一部分，因为 PyCaret 通过编排转换管道自动处理这一部分。当您在使用 PyCaret 定型的模型上调用 predict 函数时，在从定型模型生成预测之前，会自动(按顺序)应用所有转换。</p><p id="b60c" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在 Heroku 上发布应用程序之前的最后一步是在本地测试 web 应用程序。打开 Anaconda 提示符，导航到您的项目文件夹并执行以下代码:</p><pre class="kg kh ki kj gt nh ni nj nk aw nl bi"><span id="edb5" class="nm ks iq ni b gy nn no l np nq"><strong class="ni ir">streamlit </strong>run app.py</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/2131b6f88763abdd4ac8ddc94bd76d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GxVKpxijk0tlqk-bO5Q3JQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">简化应用测试—在线预测</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/3c0879590415f6775c42f550140759d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5tit2pMf5qiQqU_wjQMVg.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">简化应用测试—批量预测</p></figure><h1 id="8100" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">👉任务 3 —在 Heroku 上部署 Web 应用程序</h1><p id="60c8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">既然模型已经训练好了，机器学习管道已经准备好了，应用程序也已经在我们的本地机器上测试过了，我们就可以开始在 Heroku 上部署了。有几种方法可以将你的应用程序源代码上传到 Heroku 上。最简单的方法是将 GitHub 库链接到您的 Heroku 帐户。</p><p id="5335" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果你愿意跟随，你可以从 GitHub 中派生出这个<a class="ae mf" href="https://www.github.com/pycaret/pycaret-deployment-streamlit" rel="noopener ugc nofollow" target="_blank">库</a>。如果你不知道怎么叉一个回购，请<a class="ae mf" href="https://help.github.com/en/github/getting-started-with-github/fork-a-repo" rel="noopener ugc nofollow" target="_blank">看这个</a>官方 GitHub 教程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/759d097ff4ad165a8f0050e47690e2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxxUdaHpWu8qqRxakPzG3g.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated"><a class="ae mf" href="https://www.github.com/pycaret/pycaret-deployment-streamlit" rel="noopener ugc nofollow" target="_blank">https://www.github.com/pycaret/pycaret-deployment-streamlit</a></p></figure><p id="a22e" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">到目前为止，您已经熟悉了存储库中的所有文件，除了三个文件:“requirements.txt”、“setup.sh”和“Procfile”。让我们看看这些是什么:</p><h1 id="a70b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">requirements.txt</h1><p id="fb50" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> requirements.txt </strong>文件是一个文本文件，包含执行应用程序所需的 python 包的名称。如果这些软件包没有安装在应用程序运行的环境中，它将会失败。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/0410611607df05ff3ba2db94cbd0fca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BB7NOG_3GI4ue1J_TdtgYQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">requirements.txt</p></figure><h1 id="2836" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">setup.sh</h1><p id="c58f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">setup.sh 是为 bash 编写的脚本。它包含用 Bash 语言编写的指令，类似 requirements.txt，<em class="og"> </em>它用于为我们的 streamlit 应用程序在云上运行创建必要的环境。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/321f3fe0535ce322201094406fe5fdc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Con6kr4kh0Ss_puX7l32_w.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">setup.sh</p></figure><h1 id="ea83" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak"> Procfile </strong></h1><p id="84cb" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Procfile 只是一行代码，它向 web 服务器提供启动指令，指示当应用程序被触发时应该执行哪个文件。在本例中，“Procfile”用于执行<strong class="ll ir"> setup.sh </strong>，这将为 streamlit 应用程序创建必要的环境，第二部分“streamlit run app.py”用于执行应用程序(这类似于您在本地计算机上执行 streamlit 应用程序的方式)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/a00226ff3f380a174813ffcff5b304a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b11lGrtlyNHpRcBmY1z4Bg.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">Procfile</p></figure><p id="f859" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">一旦所有文件都上传到 GitHub 存储库，我们现在就可以开始在 Heroku 上部署了。请遵循以下步骤:</p><p id="6c38" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">第一步——在 heroku.com 上注册，点击“创建新应用”</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/1239699d2651477b50ac2135ea2017ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5tVQzeF-9HZgajee_-2PZg.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">Heroku 仪表板</p></figure><p id="e9bf" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">步骤 2 —输入应用名称和地区</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/0581f98cfdde2c484960bebcb3a43185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFTEWk8izcuZQFQer96zOQ.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">Heroku —创建新应用程序</p></figure><p id="cff4" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">步骤 3 —连接到您的 GitHub 库</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/c150e6bf3ca3fd796a325a2d088ba125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wh45-7ZwbcM04OeV6nFgpw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">Heroku —连接到 GitHub</p></figure><p id="22e8" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">步骤 4 —部署分支</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/359158e027827ff1acbe78b38d44133f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMrL-8R0-ZWm4WrDObERcw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">Heroku —部署分支</p></figure><p id="2a30" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">第 5 步—等待 10 分钟，然后爆炸</strong></p><p id="ec23" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">App 发布到网址:<a class="ae mf" href="https://pycaret-streamlit.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://pycaret-streamlit.herokuapp.com/</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/79841e3a8d9a0f79faebc7287e5babe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-scVDUhBbOIWievCj0DYjw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated"><a class="ae mf" href="https://pycaret-streamlit.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://pycaret-streamlit.herokuapp.com/</a></p></figure></div><div class="ab cl oz pa hu pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="ij ik il im in"><h1 id="2c9a" class="kr ks iq bd kt ku pg kw kx ky ph la lb jw pi jx ld jz pj ka lf kc pk kd lh li bi translated">PyCaret 2.0.0 来了！</h1><p id="8034" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们收到了来自社区的大力支持和反馈。我们正在积极改进 PyCaret，并准备我们的下一个版本。<strong class="ll ir"> PyCaret 2.0.0 会更大更好</strong>。如果您想分享您的反馈并帮助我们进一步改进，您可以<a class="ae mf" href="https://www.pycaret.org/feedback" rel="noopener ugc nofollow" target="_blank">在网站上填写此表格</a>，或者在我们的<a class="ae mf" href="https://www.github.com/pycaret/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或<a class="ae mf" href="https://www.linkedin.com/company/pycaret/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>页面上发表评论。</p><p id="e263" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">关注我们的<a class="ae mf" href="https://www.linkedin.com/company/pycaret/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>，订阅我们的<a class="ae mf" href="https://www.youtube.com/channel/UCxA1YTYJ9BEeo50lxyI_B3g" rel="noopener ugc nofollow" target="_blank"> YouTube </a>频道，了解更多关于 PyCaret 的信息。</p><h1 id="f178" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">想了解某个特定模块？</h1><p id="8740" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">从第一个版本 1.0.0 开始，PyCaret 有以下模块可供使用。点击下面的链接，查看 Python 中的文档和工作示例。</p><p id="1a60" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><a class="ae mf" href="https://www.pycaret.org/classification" rel="noopener ugc nofollow" target="_blank">分类</a><br/>T3】回归<br/>T5】T6】聚类 <br/> <a class="ae mf" href="https://www.pycaret.org/anomaly-detection" rel="noopener ugc nofollow" target="_blank">异常检测<br/> </a> <a class="ae mf" href="https://www.pycaret.org/nlp" rel="noopener ugc nofollow" target="_blank">自然语言处理</a> <br/> <a class="ae mf" href="https://www.pycaret.org/association-rules" rel="noopener ugc nofollow" target="_blank">关联规则挖掘</a></p><h1 id="719f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">另请参见:</h1><p id="07b6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">笔记本中的 PyCaret 入门教程:</p><p id="a534" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><a class="ae mf" href="https://www.pycaret.org/clu101" rel="noopener ugc nofollow" target="_blank">聚类</a> <br/> <a class="ae mf" href="https://www.pycaret.org/anom101" rel="noopener ugc nofollow" target="_blank">异常检测</a> <br/> <a class="ae mf" href="https://www.pycaret.org/nlp101" rel="noopener ugc nofollow" target="_blank">自然语言处理</a> <br/> <a class="ae mf" href="https://www.pycaret.org/arul101" rel="noopener ugc nofollow" target="_blank">关联规则挖掘</a> <br/> <a class="ae mf" href="https://www.pycaret.org/reg101" rel="noopener ugc nofollow" target="_blank">回归</a> <br/> <a class="ae mf" href="https://www.pycaret.org/clf101" rel="noopener ugc nofollow" target="_blank">分类</a></p><h1 id="0180" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">你愿意投稿吗？</h1><p id="d98b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">PyCaret 是一个开源项目。欢迎每个人都来投稿。如果您愿意投稿，请随时关注<a class="ae mf" href="https://github.com/pycaret/pycaret/issues" rel="noopener ugc nofollow" target="_blank">未决问题</a>。dev-1.0.1 分支上的单元测试接受拉请求。</p><p id="0a97" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">如果你喜欢 PyCaret，请给我们 GitHub 回购的⭐️。</p><p id="a0d0" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">中:<a class="ae mf" href="https://medium.com/@moez_62905/machine-learning-in-power-bi-using-pycaret-34307f09394a" rel="noopener">https://medium.com/@moez_62905/</a></p><p id="a9f2" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">领英:<a class="ae mf" href="https://www.linkedin.com/in/profile-moez/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/profile-moez/</a></p><p id="ebd7" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">推特:【https://twitter.com/moezpycaretorg1 T42】T43</p></div></div>    
</body>
</html>