<html>
<head>
<title>Streaming Data Analytics with Data Warehouses</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用数据仓库进行流数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/streaming-data-analytics-with-data-warehouses-583422140311?source=collection_archive---------21-----------------------#2020-03-06">https://towardsdatascience.com/streaming-data-analytics-with-data-warehouses-583422140311?source=collection_archive---------21-----------------------#2020-03-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="142c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Amazon Kinesis Data Firehose、Amazon Redshift和Amazon QuickSight来分析流数据</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">音频介绍</p></figure><p id="923d" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">数据库非常适合存储和组织需要大量面向事务的查询处理的数据，同时保持数据的完整性。相反，数据仓库是为对来自一个或多个不同来源的大量数据执行数据分析而设计的。在我们这个快节奏、高度互联的世界中，这些来源通常采用web应用程序日志、电子商务交易、社交媒体源、在线游戏活动、金融交易交易和物联网传感器读数等连续流的形式。必须近乎实时地分析流数据，但通常首先需要清理、转换和浓缩。</p><p id="cd9d" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在下面的帖子中，我们将演示如何使用Amazon Kinesis Data Firehose、Amazon Redshift和Amazon QuickSight来分析流数据。我们将模拟时间序列数据，从一组物联网传感器流向Kinesis数据消防软管。Kinesis Data Firehose将把物联网数据写入亚马逊S3数据湖，然后近乎实时地复制到Redshift。在Amazon Redshift中，我们将使用Redshift数据仓库中包含的数据来增强流式传感器数据，这些数据已经被收集并反规格化为星型模式。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lp"><img src="../Images/30f20ce4b3c287771d8aab239a012f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_expUOmcFLsyJSYAZD41A.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">邮政示范建筑</p></figure><p id="752f" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在Redshift中，我们可以分析数据，提出一些问题，例如，在给定的时间段内，每个传感器位置的最低、最高、平均和中值温度是多少。最后，我们将使用Amazon Quicksight，使用丰富的交互式图表和图形来可视化红移数据，包括显示地理空间传感器数据。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lw"><img src="../Images/4916af15a6daa212459e2e53de12b7ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UknDeq9X-DEjoj7Y.png"/></div></div></figure><h1 id="7ac3" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">特色技术</h1><p id="ab46" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">本文将讨论以下AWS服务。</p><h2 id="6943" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">亚马逊Kinesis数据消防软管</h2><p id="d32a" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">根据亚马逊的说法，<a class="ae ng" href="https://aws.amazon.com/kinesis/data-firehose/" rel="noopener ugc nofollow" target="_blank">亚马逊Kinesis Data Firehose </a>可以捕获、转换和加载<a class="ae ng" href="https://aws.amazon.com/streaming-data/" rel="noopener ugc nofollow" target="_blank">流数据</a>到数据湖、数据存储和分析工具中。直接Kinesis数据消防软管集成包括亚马逊S3、亚马逊红移、亚马逊弹性搜索服务和Splunk。Kinesis Data Firehose利用现有的<a class="ae ng" href="https://en.wikipedia.org/wiki/Business_intelligence" rel="noopener ugc nofollow" target="_blank">商业智能</a> (BI)工具和仪表盘实现近实时分析。</p><h2 id="b7bd" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">亚马逊红移</h2><p id="89a2" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">根据亚马逊的说法，<a class="ae ng" href="https://aws.amazon.com/redshift/" rel="noopener ugc nofollow" target="_blank">亚马逊红移</a>是最流行和最快的云<a class="ae ng" href="https://aws.amazon.com/data-warehouse/" rel="noopener ugc nofollow" target="_blank">数据仓库</a>。借助Redshift，用户可以使用标准SQL在您的数据仓库和数据湖中查询数Pb的结构化和半结构化数据。Redshift允许用户在数据湖中查询和导出数据。Redshift可以联合查询来自Redshift的实时数据，也可以跨一个或多个关系数据库进行查询。</p><h2 id="53d5" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">亚马逊红移光谱</h2><p id="4cfd" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">据亚马逊介绍，<a class="ae ng" href="https://docs.aws.amazon.com/redshift/latest/dg/c-using-spectrum.html" rel="noopener ugc nofollow" target="_blank">亚马逊红移光谱</a>可以高效地从亚马逊S3的文件中查询和检索结构化和半结构化数据，而无需将数据加载到亚马逊红移表中。红移光谱表是通过定义数据文件的结构并将它们注册为外部数据目录中的表来创建的。外部数据目录可以是<a class="ae ng" href="https://aws.amazon.com/glue/" rel="noopener ugc nofollow" target="_blank"> AWS Glue </a>或<a class="ae ng" href="https://hive.apache.org/index.html" rel="noopener ugc nofollow" target="_blank"> Apache Hive </a> metastore。虽然红移光谱是将数据复制到红移中进行分析的替代方法，但在本文中我们不会使用红移光谱。</p><h2 id="ddf8" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">亚马逊QuickSight</h2><p id="59af" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">据亚马逊称，<a class="ae ng" href="https://aws.amazon.com/quicksight/" rel="noopener ugc nofollow" target="_blank"> Amazon QuickSight </a>是一种完全托管的商业智能服务，可以轻松地向组织中的每个人提供见解。QuickSight允许用户轻松创建和发布丰富的交互式仪表盘，其中包括<a class="ae ng" href="https://aws.amazon.com/quicksight/features-ml/" rel="noopener ugc nofollow" target="_blank">Amazon quick sight ML Insights</a>。然后，可以从任何设备访问仪表板，并将其嵌入到应用程序、门户和网站中。</p><h1 id="b825" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">什么是数据仓库？</h1><p id="3e4f" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">据亚马逊称，<a class="ae ng" href="https://aws.amazon.com/data-warehouse/" rel="noopener ugc nofollow" target="_blank">数据仓库</a>是一个中央信息库，可以对其进行分析以做出更明智的决策。数据从事务系统、关系数据库和其他来源流入数据仓库，通常是有规律的。业务分析师、数据科学家和决策者通过商业智能工具、SQL客户端和其他分析应用程序访问数据。</p><h1 id="8acc" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">示范</h1><h2 id="2c63" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">源代码</h2><p id="6cd4" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">这篇文章的所有源代码都可以在<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。使用以下命令git克隆项目的本地副本。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="cf06" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">云的形成</h2><p id="63d9" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">使用项目中包含的两个AWS CloudFormation模板来构建两个CloudFormation堆栈。请查看这两个模板并了解资源成本，然后继续。第一个CloudFormation模板<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo/blob/master/cloudformation/redshift.yml" rel="noopener ugc nofollow" target="_blank"> redshift.yml </a>，提供了一个新的亚马逊VPC以及相关的网络和安全资源、一个单节点红移集群和两个S3桶。第二个CloudFormation模板<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo/blob/master/cloudformation/kinesis-firehose.yml" rel="noopener ugc nofollow" target="_blank"> kinesis-firehose.yml </a>，提供了一个Amazon Kinesis数据firehose交付流、相关的IAM策略和角色，以及一个Amazon CloudWatch日志组和两个日志流。</p><p id="6623" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">更改<code class="fe ni nj nk nl b">REDSHIFT_PASSWORD</code>值以确保您的安全。或者，更改<code class="fe ni nj nk nl b">REDSHIFT_USERNAME</code>值。在创建第二个堆栈之前，请确保第一个堆栈成功完成。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="63d3" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">查看AWS资源</h2><p id="3b0b" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">要确认所有AWS资源都已正确创建，请使用AWS管理控制台。</p><h2 id="e92b" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">Kinesis数据消防软管</h2><p id="fa31" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">在Amazon Kinesis仪表板中，您应该会看到新的Amazon Kinesis Data Firehose交付流，redshift-delivery-stream。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/69c8bdf3082fe4c20338052fc5a5affc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yQckj9KrgKwKba0l.png"/></div></div></figure><p id="72f5" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">新的Amazon Kinesis Firehose交付流的Details选项卡应该类似于下图。请注意IAM角色FirehoseDeliveryRole，它是由CloudFormation创建并与交付流相关联的。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/32f534cd297a26e0fc8b8d585aa6cb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iKzFz7NYbrW2NMjV.png"/></div></div></figure><p id="dc5c" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们不对传入的消息执行任何转换。注意新的S3桶，它是由云形成产生并与气流联系在一起的。存储桶名称是随机生成的。这个桶是传入消息将被写入的地方。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/5d3408205f0c0efb6610ff3345dc987a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hIYTgo_XYPAnSN61.png"/></div></div></figure><p id="27ba" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">请注意1 MB和60秒的缓冲条件。每当传入消息的缓冲区大于1 MB或时间超过60秒时，消息就会使用GZIP压缩以JSON格式写入S3。这些是最小的缓冲条件，也是我们所能得到的最接近红移的实时流。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/701fd8aae5d06e02067a4a7622529e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2Nz3vTNuo9sZaap-.png"/></div></div></figure><p id="2dd2" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">请注意<code class="fe ni nj nk nl b">COPY</code>命令，该命令用于将消息从S3复制到Amazon Redshift中的<code class="fe ni nj nk nl b">message</code>表。Kinesis使用由CloudFormation创建的IAM角色ClusterPermissionsRole作为凭证。我们使用一个清单将数据从S3复制到红移。据Amazon称，<a class="ae ng" href="https://docs.aws.amazon.com/redshift/latest/dg/loading-data-files-using-manifest.html" rel="noopener ugc nofollow" target="_blank">清单</a>确保<code class="fe ni nj nk nl b">COPY</code>命令加载所有必需的文件，并且只加载数据加载所需的文件。清单由Kinesis消防软管交付流自动生成和管理。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/e9844f72c5c138ed4bf00716c8d43a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NhxkuxFE2jDVn25r.png"/></div></div></figure><h2 id="8b04" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">红移星团</h2><p id="87da" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">在Amazon红移控制台中，您应该看到一个新的单节点红移集群，由一个红移<a class="ae ng" href="https://aws.amazon.com/redshift/pricing/" rel="noopener ugc nofollow" target="_blank"> dc2.large </a>密集计算节点类型组成。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/d1db1490c538c55b766a303ec556c5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hy989uaV7VCe21Wt.png"/></div></div></figure><p id="7d32" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">请注意CloudFormation创建的新VPC、子网和VPC安全组。此外，观察到红移星团可以在新VPC之外公开访问。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/228c0666e5642c0193a44afbb0c44927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vgLL-gGdlj_8mAG6.png"/></div></div></figure><h2 id="c081" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">红移入口规则</h2><p id="a95c" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">单节点红移群集被分配到美国东部(N. Virginia) us-east-1 AWS地区的AWS可用性区域。该群集与VPC安全组相关联。该安全组包含三个入站规则，都适用于红移端口5439。与三个入站规则相关联的IP地址提供对以下内容的访问:1)美国东部-1中亚马逊QuickSight的<code class="fe ni nj nk nl b">/27</code> CIDR块，美国东部-1中亚马逊Kinesis Firehose的<code class="fe ni nj nk nl b">/27</code> CIDR块，以及对您而言，具有您当前IP地址的<code class="fe ni nj nk nl b">/32</code> CIDR块。如果您的IP地址发生变化或者您不再使用美国东部-1地区，您将需要更改这些IP地址中的一个或全部。Kinesis Firehose IP地址列表在这里是<a class="ae ng" href="https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-rs" rel="noopener ugc nofollow" target="_blank"/>。QuickSight IP地址列表在这里是<a class="ae ng" href="https://docs.aws.amazon.com/quicksight/latest/user/regions.html" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/6e4a3429bed517edd94eaeebf7d006e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MlexokWVN88jqw94.png"/></div></div></figure><p id="0b19" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果您无法从本地SQL客户端连接到Redshift，最常见的情况是，您的IP地址已经更改，并且在安全组的入站规则中不正确。</p><h2 id="0f00" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">红移SQL客户端</h2><p id="eac2" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">您可以选择使用红移查询编辑器与红移进行交互，或者使用第三方SQL客户端以获得更大的灵活性。要访问红移查询编辑器，请使用在<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo/blob/master/cloudformation/redshift.yml" rel="noopener ugc nofollow" target="_blank">Redshift . yml</a>cloud formation模板中指定的用户凭据。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/e8c086a1b45ff79c504b25f5df090bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Lase9oxmTIr4-wcJ.png"/></div></div></figure><p id="ac22" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">红移控制台和红移查询编辑器中有许多有用的功能。然而，在我看来，红移查询编辑器的一个显著限制是不能同时执行多个SQL语句。而大多数SQL客户端允许同时执行多个SQL查询。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/e81a7cc4ae8b99e50570de71b2a2819c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HQsF-WTB5mCRZ-b9.png"/></div></div></figure><p id="acaf" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我更喜欢使用JetBrains py charm IDE。PyCharm具有与Redshift的现成集成。使用PyCharm，我可以编辑项目的Python、SQL、AWS CLI shell和CloudFormation代码，所有这些都可以在PyCharm中完成。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/56dc786d34109e12ee7ff760976ecfb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qWe9BH9MmJYPKF-9.png"/></div></div></figure><p id="43ea" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果您使用任何常见的SQL客户端，您将需要设置一个JDBC (Java数据库连接)或ODBC(开放式数据库连接)<a class="ae ng" href="https://docs.aws.amazon.com/redshift/latest/mgmt/configure-jdbc-connection.html" rel="noopener ugc nofollow" target="_blank">连接到Redshift </a>。ODBC和JDBC连接字符串可以在红移星团的Properties选项卡或CloudFormation堆栈的Outputs选项卡中找到。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/daf774b99b21c0149372a69f1ef47b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6FRILNaMslRBDCH3.png"/></div></div></figure><p id="2dfa" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">您还需要之前执行的<code class="fe ni nj nk nl b">aws cloudformation create-stack</code> AWS CLI命令中包含的Redshift数据库用户名和密码。下面，我们看到PyCharm的项目数据源窗口包含一个红移<code class="fe ni nj nk nl b">dev</code>数据库的新数据源。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/0ecfe49fb30552035fe95db192b8db8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/0*qFdbL0Ow3IbjG4X2.png"/></div></figure><h2 id="2fed" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">数据库模式和表</h2><p id="11a1" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">CloudFormation在创建红移星团的同时，也创建了一个新的数据库，<code class="fe ni nj nk nl b">dev</code>。使用红移查询编辑器或您选择的SQL客户机，执行以下一系列SQL命令来创建一个新的数据库模式<code class="fe ni nj nk nl b">sensor</code>和<code class="fe ni nj nk nl b">sensor</code>模式中的六个表。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="ae74" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">星形模式</h2><p id="77ff" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">这些表表示从一个或多个关系数据库源获取的非规范化数据。这些表格形成了一个<a class="ae ng" href="https://en.wikipedia.org/wiki/Star_schema" rel="noopener ugc nofollow" target="_blank">星形模式</a>。星型模式被广泛用于开发数据仓库。星型模式由一个或多个引用任意数量的<a class="ae ng" href="https://en.wikipedia.org/wiki/Dimension_(data_warehouse)" rel="noopener ugc nofollow" target="_blank">维度表</a>的<a class="ae ng" href="https://en.wikipedia.org/wiki/Fact_table" rel="noopener ugc nofollow" target="_blank">事实表</a>组成。<code class="fe ni nj nk nl b">location</code>、<code class="fe ni nj nk nl b">manufacturer</code>、<code class="fe ni nj nk nl b">sensor</code>和<code class="fe ni nj nk nl b">history</code>表是尺寸表。<code class="fe ni nj nk nl b">sensors</code>表是一个事实表。</p><p id="0eef" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在下图中，外键关系是虚拟的，而不是物理的。该图是使用PyCharm的模式可视化工具创建的。注意模式的星形。<code class="fe ni nj nk nl b">message</code>表是流式物联网数据最终将被写入的地方。<code class="fe ni nj nk nl b">message</code>表通过公共的<code class="fe ni nj nk nl b">guid</code>字段与<code class="fe ni nj nk nl b">sensors</code>事实表相关联。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi no"><img src="../Images/7c79e176376269d882f9519783f6bc95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f2dVk6oZzl4dthIC.png"/></div></div></figure><h2 id="f24e" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">S3的样本数据</h2><p id="9c46" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">接下来，将项目中包含的样本数据复制到用CloudFormation创建的S3数据桶中。每个CSV格式的数据文件对应于我们之前创建的一个表。由于bucket名称是半随机的，我们可以使用AWS CLI和<a class="ae ng" href="https://stedolan.github.io/jq/" rel="noopener ugc nofollow" target="_blank"> jq </a>来获取bucket名称，然后使用它来执行复制命令。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="6164" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">AWS CLI的输出应该如下所示。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi np"><img src="../Images/ad9c97862f84d11b37df05e75569f847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_PmbegZFldg1cX4b.png"/></div></div></figure><h2 id="ce86" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">样本数据红移</h2><p id="57b9" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">关系数据库，如亚马逊RDS，是为在线交易处理(OLTP)而设计的，而亚马逊Redshift是为在线分析处理(OLAP)和商业智能应用而设计的。为了将数据写入红移，我们通常使用<code class="fe ni nj nk nl b">COPY</code>命令，而不是频繁的单独的<code class="fe ni nj nk nl b">INSERT</code>语句，就像OLTP一样，这会非常慢。据亚马逊称，Redshift <code class="fe ni nj nk nl b">COPY</code>命令利用亚马逊Redshift大规模并行处理(MPP)架构，从亚马逊S3上的文件、DynamoDB表或一个或多个远程主机的文本输出中并行读取和加载数据。</p><p id="e5f9" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在下面的一系列SQL语句中，用您的S3数据存储桶名称替换五处的占位符<code class="fe ni nj nk nl b">your_bucket_name</code>。存储桶名称将以前缀<code class="fe ni nj nk nl b">redshift-stack-databucket</code>开头。可以在CloudFormation堆栈<code class="fe ni nj nk nl b">redshift-stack</code>的Outputs选项卡中找到bucket名称。接下来，用ClusterPermissionsRole的ARN (Amazon资源名称)替换占位符<code class="fe ni nj nk nl b">cluster_permissions_role_arn</code>。ARN的格式如下，<code class="fe ni nj nk nl b">arn:aws:iam::your-account-id:role/ClusterPermissionsRole</code>。ARN可以在云生成堆栈<code class="fe ni nj nk nl b">redshift-stack</code>的输出选项卡中找到。</p><p id="f0be" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用Redshift查询编辑器或您选择的SQL客户端，执行SQL语句将样本数据从S3复制到Redshift <code class="fe ni nj nk nl b">dev</code>数据库中的每个相应表中。<code class="fe ni nj nk nl b">TRUNCATE</code>命令保证表格中没有以前的样本数据。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="d0d7" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">数据库视图</h2><p id="bfb2" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">接下来，创建四个<a class="ae ng" href="https://docs.aws.amazon.com/redshift/latest/dg/r_CREATE_VIEW.html" rel="noopener ugc nofollow" target="_blank">红移数据库视图</a>。这些视图可能用于分析Redshift中的数据，以及稍后在Amazon QuickSight中的数据。</p><ol class=""><li id="663e" class="nq nr it kv b kw kx kz la lc ns lg nt lk nu lo nv nw nx ny bi translated"><strong class="kv iu"> sensor_msg_detail </strong>:使用SQL连接中的<code class="fe ni nj nk nl b">sensors</code>事实表和所有五个维度表，返回聚合的传感器详细信息。</li><li id="19f9" class="nq nr it kv b kw nz kz oa lc ob lg oc lk od lo nv nw nx ny bi translated"><strong class="kv iu"> sensor_msg_count </strong>:返回每个传感器红移收到的消息数。</li><li id="151e" class="nq nr it kv b kw nz kz oa lc ob lg oc lk od lo nv nw nx ny bi translated"><strong class="kv iu"> sensor_avg_temp </strong>:根据从每个传感器收到的所有信息，返回每个传感器的平均温度。</li><li id="7d2c" class="nq nr it kv b kw nz kz oa lc ob lg oc lk od lo nv nw nx ny bi translated"><strong class="kv iu">sensor _ avg _ temp _ current</strong>:视图与前一视图相同，但仅限于最近30分钟。</li></ol><p id="339b" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用红移查询编辑器或您选择的SQL客户端，执行以下一系列SQL语句。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="3d02" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">此时，在Redshift中的<code class="fe ni nj nk nl b">dev</code>数据库的<code class="fe ni nj nk nl b">sensor</code>模式中，您应该总共有六个表和四个视图。</p><h2 id="8ca1" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">测试系统</h2><p id="5e97" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">有了所有必需的AWS资源和创建的红移数据库对象以及红移数据库中的样本数据，我们就可以测试系统了。包含的Python脚本<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo/blob/master/scripts/kinesis_put_test_msg.py" rel="noopener ugc nofollow" target="_blank">kine sis _ put _ test _ msg . py</a>将生成一条测试消息，并将其发送到Kinesis Data Firehose。如果一切正常，这条消息应该会从Kinesis Data Firehose传送到S3，然后复制到Redshift，并出现在<code class="fe ni nj nk nl b">message</code>表中。</p><p id="ff43" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">安装所需的Python包，然后执行Python脚本。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="49e9" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">运行下面的SQL查询，确认记录在数据库<code class="fe ni nj nk nl b">dev</code>的<code class="fe ni nj nk nl b">message</code>表中。至少需要一分钟消息才会出现在红移中。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="a6e4" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">一旦确认消息出现在<code class="fe ni nj nk nl b">message</code>表中，通过截断该表删除记录。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="dd26" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">流式数据</h2><p id="4728" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">假设测试消息有效，我们可以继续模拟流式物联网传感器数据。包含的Python脚本，<a class="ae ng" href="https://github.com/garystafford/kinesis-redshift-streaming-demo/blob/master/scripts/kinesis_put_streaming_data.py" rel="noopener ugc nofollow" target="_blank">kinesis _ put _ streaming _ data . py</a>，创建六个并发线程，代表六个温度传感器。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="9b83" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">模拟数据使用一种算法，该算法遵循振荡的<a class="ae ng" href="https://en.wikipedia.org/wiki/Sine_wave" rel="noopener ugc nofollow" target="_blank">正弦波</a>或正弦曲线，代表上升和下降的温度。在脚本中，我已经将每个线程配置为以任意偏移量开始，以给模拟数据添加一些随机性。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lw"><img src="../Images/d972810d8871324310ad38c9cfcf72d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*baJql81VsWDK2TtA.png"/></div></div></figure><p id="e7a4" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">可以调整脚本中的变量，以缩短或延长传输模拟数据所需的时间。默认情况下，六个线程中的每一个都会为每个传感器创建400条消息，增量为一分钟。包括每个进行线程的偏移开始，脚本的总运行时间约为7.5小时，以生成2，400个模拟物联网传感器温度读数并推送到Kinesis数据消防软管。确保您能够保证在脚本的整个运行时间内保持与互联网和AWS的连接。我通常从一个小的Amazon EC2实例中在后台运行这个脚本。</p><p id="59fc" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">要使用Python脚本，请执行以下两个命令之一。使用第一个命令将在前台运行脚本。使用第二个命令将在后台运行脚本。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="c69b" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">查看<code class="fe ni nj nk nl b">output.log</code>文件，您应该看到在每个线程上生成的消息被发送到Kinesis Data Firehose。每条消息都包含传感器的GUID、时间戳和温度读数。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/ec99647f042fd4c45e7678fd6e6eb4ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e4E-rTpdOvNjnb-zePay9g.png"/></div></div></figure><p id="733b" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这些信息被发送到Kinesis Data Firehose，后者再将信息写入S3。这些消息是使用GZIP压缩以JSON格式编写的。下面，我们看到一个S3 GZIP压缩JSON文件的例子。JSON文件按年、月、日和小时进行分区。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/863701e6f454be1f7838139699cc6f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZF-irUoS2XhBhaXH.png"/></div></div></figure><h2 id="c49c" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">确认数据流向红移</h2><p id="0f9a" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">从Amazon Kinesis Firehose控制台的Metrics选项卡，您应该可以看到传入的消息流向S3和Redshift。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/00a9501ba527794a028fbc1ae6885a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AVUPZUhq4W_YVXuN.png"/></div></div></figure><p id="e167" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">执行下面的SQL查询应该会显示越来越多的消息。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h2 id="cc63" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">有多接近实时？</h2><p id="12f2" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">之前，我们看到了亚马逊Kinesis Data Firehose交付流是如何配置为以1 MB或60秒的速率缓冲数据的。每当传入消息的缓冲区大于1 MB或时间超过60秒时，消息就会被写入S3。<code class="fe ni nj nk nl b">message</code>表中的每条记录都有两个时间戳。第一个时间戳ts是记录温度读数的时间。第二个时间戳是使用<code class="fe ni nj nk nl b">COPY</code>命令将消息写入Redshift时创建的。我们可以在Redshift中使用以下SQL查询来计算两个时间戳之间的差值(以秒为单位)。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="32ed" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用红移查询的结果，我们可以在Amazon QuickSight中可视化结果。在我自己的测试中，我们看到在大约7.5小时内，对于2，400条消息，最小延迟是1秒，最大延迟是64秒。因此，在这种情况下，接近实时的时间大约为一分钟或更短，平均延迟大约为30秒。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ca"><img src="../Images/b94c2d54264a1aaab27747675d573d94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PUsjhNgXxbn2Fi9e.png"/></div></div></figure><h2 id="2926" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">用红移分析数据</h2><p id="15f4" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">我建议至少等待30分钟，让大量消息复制到Redshift中。随着数据流进入Redshift，执行我们之前创建的每个数据库视图。在Redshift中，您应该看到流消息数据与现有的静态数据相结合。随着数据继续流入Redshift，视图将根据当前的<code class="fe ni nj nk nl b">message</code>表内容显示不同的结果。</p><p id="1db3" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在这里，我们看到了<code class="fe ni nj nk nl b">sensor_msg_detail</code>视图的前十个结果。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><p id="b46d" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">接下来，我们看看<code class="fe ni nj nk nl b">sensor_avg_temp</code>视图的结果。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h1 id="f2b6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">亚马逊QuickSight</h1><p id="8262" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">在最近的一篇文章中，<a class="ae ng" href="http://programmaticponderings.com/2020/01/14/getting-started-with-data-analysis-on-aws-using-aws-glue-amazon-athena-and-quicksight-part-2/" rel="noopener ugc nofollow" target="_blank">开始使用AWS Glue、Amazon Athena和QuickSight在AWS上进行数据分析:第2部分</a>，我详细介绍了Amazon QuickSight的入门。在这篇文章中，我假设你熟悉QuickSight。</p><p id="60b0" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">亚马逊<a class="ae ng" href="https://aws.amazon.com/about-aws/whats-new/2019/11/amazon-quicksight-adds-api-support-for-data-dashboard-spice-and-permissions/" rel="noopener ugc nofollow" target="_blank">最近增加了</a>全套<code class="fe ni nj nk nl b">aws quicksight</code>API，用于与QuickSight交互。不过，在演示的这一部分，我们将直接在亚马逊QuickSight控制台中工作，而不是在AWS CLI、AWS CDK或CloudFormation中工作。</p><h2 id="f87f" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">红移数据集</h2><p id="8bd3" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">为了可视化来自Amazon Redshift的数据，我们首先在QuickSight中创建数据集。QuickSight支持<a class="ae ng" href="https://docs.aws.amazon.com/quicksight/latest/user/supported-data-sources.html" rel="noopener ugc nofollow" target="_blank">大量数据源</a>用于创建数据集。我们将使用红移数据源。如果您还记得，我们为QuickSight添加了一个入站规则，允许我们连接到us-east-1中的红移星团。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/b907b36ae0287cd906f5763ec92bb103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1RJa11jqRXBtZrC0.png"/></div></div></figure><p id="59a0" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们将选择<code class="fe ni nj nk nl b">sensor</code>模式，这是本演示的表和视图所在的位置。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/e23fa748d81efbc90fa2168598998c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tbEZ1VoICK7ozO40.png"/></div></div></figure><p id="62d8" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们可以在Redshift <code class="fe ni nj nk nl b">dev</code>数据库中选择任何想要用于可视化的表或视图。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/275e338a41f7469103648692d53d086b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tK5oe30UUzavLB7X.png"/></div></div></figure><p id="3375" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下面，我们将看到两个新数据集的示例，显示在QuickSight数据准备控制台中。请注意QuickSight如何自动识别字段类型，包括日期、纬度和经度。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/8fb7188eab8101e0b9a9a64dad6f0e4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1W5brbQNEeKDwzoo.png"/></div></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/6d6f982fb0eda3dd4957e1000380dbe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hqAO88O9R8fnT-5S.png"/></div></div></figure><h2 id="69ec" class="mu ly it bd lz mv mw dn md mx my dp mh lc mz na mj lg nb nc ml lk nd ne mn nf bi translated">形象化</h2><p id="523e" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">使用数据集，QuickSight允许我们创建大量丰富的可视化效果。下面，我们看到来自六个温度传感器的模拟时间序列数据。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/18c80cd06788d3bd0578fbaf7e8ec323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LCfl_P3zRrJRyr3_.png"/></div></div></figure><p id="8673" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">接下来，我们看一个QuickSight显示地理空间数据能力的例子。该图显示了每个传感器的位置以及该传感器记录的平均温度。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nm"><img src="../Images/b33a2dfadede64e646f53da0ca8adf29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rIRU4FM40WwMXviM.png"/></div></div></figure><h1 id="d45a" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">清理</h1><p id="0c5f" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">要删除为此帖子创建的资源，请使用以下一系列AWS CLI命令。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="nh ko l"/></div></figure><h1 id="444f" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">结论</h1><p id="d93a" class="pw-post-body-paragraph kt ku it kv b kw mp ju ky kz mq jx lb lc mr le lf lg ms li lj lk mt lm ln lo im bi translated">在这篇简短的帖子中，我们了解了如何使用Amazon Kinesis Data Firehose在Amazon Redshift中近乎实时地分析流数据。此外，我们还探索了如何在Amazon QuickSight中可视化这些分析的结果。对于依赖数据仓库进行数据分析但也有流数据源的客户来说，使用Amazon Kinesis Data Firehose或Amazon Redshift Spectrum是一个很好的选择。</p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="d24a" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="om">本博客代表我自己的观点，不代表我的雇主亚马逊网络服务公司的观点。</em></p></div></div>    
</body>
</html>