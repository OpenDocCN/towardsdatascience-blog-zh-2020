<html>
<head>
<title>Bayesian logistic regression with PyMC3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ PyMC3 çš„è´å¶æ–¯é€»è¾‘å›å½’</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/bayesian-logistic-regression-with-pymc3-8e17c576f31a?source=collection_archive---------11-----------------------#2020-09-02">https://towardsdatascience.com/bayesian-logistic-regression-with-pymc3-8e17c576f31a?source=collection_archive---------11-----------------------#2020-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2c08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™æ˜¯ä¸€ç³»åˆ—æ–‡ç« ä¸­çš„å¦ä¸€ç¯‡(å‚è§<a class="ae kl" rel="noopener" target="_blank" href="/introduction-to-pymc3-a-python-package-for-probabilistic-programming-5299278b428">æ­¤å¤„</a>å’Œ<a class="ae kl" rel="noopener" target="_blank" href="/a-b-testing-with-probabilistic-programming-and-pymc3-part-i-7ae52d45bc41">æ­¤å¤„</a>çš„å…¶ä»–ç›¸å…³æ–‡ç« ),ä¸€èˆ¬æ¥è¯´æ˜¯å…³äºæ¦‚ç‡ç¼–ç¨‹çš„ï¼Œç‰¹åˆ«æ˜¯å…³äº PyMC3 çš„ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è§£é‡Šäº† PyMC3 å¦‚ä½•å¸®åŠ©ç»Ÿè®¡æ¨æ–­ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyMC3 è§£å†³ä¸€ä¸ªç«¯åˆ°ç«¯çš„åˆ†ç±»é—®é¢˜ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ PyMC3 é€šè¿‡ä»¥ä¸‹å…¬å…±æ•°æ®é›†è¿›è¡Œè´å¶æ–¯é€»è¾‘å›å½’:</p><p id="f423" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://archive.ics.uci.edu/ml/datasets/Occupancy+Detection+" rel="noopener ugc nofollow" target="_blank">https://archive . ics . UCI . edu/ml/datasets/Occupancy+Detection+</a></p><p id="f677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯¥æ•°æ®é›†åŒ…å«å‡ ä¸ªå˜é‡ï¼Œå¦‚å…‰çº¿ã€æ¸©åº¦ã€æ¹¿åº¦å’ŒäºŒæ°§åŒ–ç¢³æ°´å¹³ã€‚ç›®æ ‡æ˜¯ä»è¿™äº›å˜é‡ä¸­æ£€æµ‹æˆ¿é—´çš„å ç”¨æƒ…å†µã€‚</p><p id="a9d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½å‡ ä¸ªç›¸å…³çš„åŒ…ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="87f1" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">import</strong> <strong class="kr ir">arviz</strong> <strong class="kr ir">as</strong> <strong class="kr ir">az</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">matplotlib.pyplot</strong> <strong class="kr ir">as</strong> <strong class="kr ir">plt</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">numpy</strong> <strong class="kr ir">as</strong> <strong class="kr ir">np</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">pandas</strong> <strong class="kr ir">as</strong> <strong class="kr ir">pd</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">pymc3</strong> <strong class="kr ir">as</strong> <strong class="kr ir">pm</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">seaborn</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">theano.tensor</strong> <strong class="kr ir">as</strong> <strong class="kr ir">tt</strong><br/><strong class="kr ir">import</strong> <strong class="kr ir">warnings</strong><br/><strong class="kr ir">from</strong> <strong class="kr ir">IPython.core.pylabtools</strong> <strong class="kr ir">import</strong> figsize<br/><strong class="kr ir">import</strong> <strong class="kr ir">seaborn</strong> <strong class="kr ir">as</strong> <strong class="kr ir">sns</strong><br/><strong class="kr ir">from</strong> <strong class="kr ir">sklearn.metrics</strong> <strong class="kr ir">import</strong> (roc_curve, roc_auc_score, confusion_matrix, accuracy_score, f1_score, <br/>                             precision_recall_curve) <br/><strong class="kr ir">from</strong> <strong class="kr ir">sklearn.metrics</strong> <strong class="kr ir">import</strong> confusion_matrix</span></pre><p id="049e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åŠ è½½æ•°æ®é›†ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="306d" class="kv kw iq kr b gy kx ky l kz la">df=pd.read_csv('datatest.txt')<br/>df.sample(5)</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/3e98499797e822e815035d94b8fad5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*gqYLqoI0v0BAZ4vNup1hIg.jpeg"/></div></figure><p id="a496" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬å°†æ—¥æœŸå˜é‡è½¬æ¢ä¸ºæ—¥æœŸæ—¶é—´å¯¹è±¡ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="8e3a" class="kv kw iq kr b gy kx ky l kz la">df['date']=pd.to_datetime(df['date'])</span></pre><h1 id="3a55" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">ç¬¬ 1 éƒ¨åˆ†:æ¢ç´¢æ€§æ•°æ®åˆ†æ</h1><p id="c5b6" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ•°æ®é›†çš„æ¦‚å†µã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="49fc" class="kv kw iq kr b gy kx ky l kz la">df.describe()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/9c21610929784d77c61e22bfe84f74f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KkKaL_ppiQp4jlTeBSsJw.jpeg"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">æ•°æ®é›†æ¦‚è¿°</p></figure><p id="da3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªæ•°æ®é›†ä¸­æœ‰ 2655 ä¸ªæ ·æœ¬ã€‚æ­¤å¤–ï¼Œæ²¡æœ‰ä¸¢å¤±å€¼ã€‚è®©æˆ‘ä»¬ä¹Ÿçœ‹çœ‹è¿™ä¸ªæ•°æ®é›†çš„æ—¶é—´æ¡†æ¶ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6f5a" class="kv kw iq kr b gy kx ky l kz la">df['date'].describe()</span><span id="5bc1" class="kv kw iq kr b gy mq ky l kz la">count                    2665<br/>unique                   2665<br/>top       2015-02-03 07:25:59<br/>freq                        1<br/>first     2015-02-02 14:19:00<br/>last      2015-02-04 10:43:00<br/>Name: date, dtype: object</span></pre><p id="a25c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥æˆ‘ä»¬çš„æ•°æ®åªåœ¨ä¸‰å¤©å†…å°±æ”¶é›†å¥½äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ¢è®¨æˆ‘ä»¬çš„å˜é‡åŠå…¶å…³ç³»ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”»å‡ºæ¸©åº¦å˜é‡ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6e73" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 4)<br/>plt.hist(df['Temperature'], bins=40, density=<strong class="kr ir">True</strong>, label='Temperature')<br/>plt.xlabel('Temperature')<br/>plt.title('Distribution of temperature')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mr"><img src="../Images/7aebc6451c756f67b40e3cba78bc00bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKYymKLbDovYXEU_NDAoSw.png"/></div></div></figure><p id="d13b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯¥å›¾æ˜¾ç¤ºæ¸©åº¦å…·æœ‰é‡å°¾åˆ†å¸ƒã€‚æ¹¿åº¦å˜é‡å‘¢ï¼Ÿ</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="577f" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 4)<br/>plt.hist(df['Humidity'], bins=50, density=<strong class="kr ir">True</strong>, label='Humidity')<br/>plt.xlabel('Humidity')<br/>plt.title('Distribution of Humidity')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ms"><img src="../Images/d6e30c6aafc52fba9812e9bd02cef3fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nt9LhGzdLVv8ouMmAECA0g.png"/></div></div></figure><p id="a45c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰è¶£çš„æ˜¯ï¼Œåœ¨ 22.5 å’Œ 25 é™„è¿‘æœ‰ä¸¤ä¸ªå³°å€¼ã€‚æˆ‘ä»¬è¿˜å¯¹ä¸åŒæ—¥å­é‡Œçš„å…‰ç…§å˜åŒ–æ„Ÿå…´è¶£ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="fa33" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 4)<br/>sns.boxplot(x=df['date'].dt.day,y=df['Light'], orient='v')<br/>plt.xlabel('Day')<br/>plt.title('Boxplot for Light during different days')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mt"><img src="../Images/a8a3f4711a410d9b655fd327d7350186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_cUXmGrXfDGeLRr9_1SHIw.jpeg"/></div></div></figure><p id="4272" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çœ‹åˆ°å…‰çš„åˆ†å¸ƒåœ¨è¿™ä¸‰å¤©ä¸­å‡ ä¹æ˜¯ç›¸åŒçš„ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹äºŒæ°§åŒ–ç¢³æ°´å¹³ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="bc97" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 4)<br/>sns.boxplot(x=df['date'].dt.day,y=df['CO2'], orient='v')<br/>plt.xlabel('Day')<br/>plt.title('Boxplot for CO2 level during different days')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mu"><img src="../Images/5582b739e1f3e227f8d84beb12b00cc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHMbHT8D3y446vjD_2Ulqg.jpeg"/></div></div></figure><p id="93a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™äº›åˆ†å¸ƒæ˜æ˜¾ä¸åŒã€‚2015 å¹´ 2 æœˆ 4 æ—¥æœ‰å¾ˆå¤šå¼‚å¸¸å€¼ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶æ¹¿åº¦æ¯”å˜é‡ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="2c98" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 4)<br/>sns.boxplot(x=df['date'].dt.day,y=df['HumidityRatio'], orient='v')<br/>plt.xlabel('Day')<br/>plt.title('Boxplot for Humidity Ratio level during different days')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mv"><img src="../Images/9a8f94e82fdd512f4aa262b9fc670027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQ9_r-Dsxu2e2rLm02RY-g.jpeg"/></div></div></figure><p id="dcab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™çœ‹èµ·æ¥éå¸¸ç±»ä¼¼äºäºŒæ°§åŒ–ç¢³æ°´å¹³çš„ç®±çº¿å›¾ã€‚ä¹Ÿè®¸ï¼ŒäºŒæ°§åŒ–ç¢³æ°´å¹³å’Œæ¹¿åº¦ä¹‹é—´æœ‰å¾ˆå¼ºçš„ç›¸å…³æ€§ã€‚æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸¤ä¸ªå˜é‡çš„æ•£ç‚¹å›¾æ¥éªŒè¯ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="1247" class="kv kw iq kr b gy kx ky l kz la">ax=sns.scatterplot(df['CO2'], df['HumidityRatio'], style=df['date'].dt.day)</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/45cb38a80311d9c5a39aad4f1af53a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYBe1DJXIpqvr-34JD9u-Q.jpeg"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">äºŒæ°§åŒ–ç¢³æ°´å¹³å’Œæ¹¿åº¦æ¯”çš„æ•£ç‚¹å›¾</p></figure><p id="8283" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">äº‹å®ä¸Šï¼ŒäºŒæ°§åŒ–ç¢³æ°´å¹³å’Œæ¹¿åº¦æ¯”ä¹‹é—´æœ‰å¾ˆå¼ºçš„çº¿æ€§å…³ç³»ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚è¿™å¯ä»¥é€šè¿‡ seaborn çš„ pair plot å‡½æ•°æ¥å®Œæˆã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="165b" class="kv kw iq kr b gy kx ky l kz la">ax=seaborn.pairplot(df)</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mx"><img src="../Images/0c2eb0f33a82f87aa4fc78f0b93ceb2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7twc2ZF4N_zTI64VVjpvA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">æ•°æ®é›†ä¸­æ‰€æœ‰è¦ç´ çš„é…å¯¹å›¾</p></figure><p id="cee5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ç›´è§‚åœ°æ˜¾ç¤ºäº†åœ¨ä»¥ä¸‹å¯¹ä¹‹é—´å­˜åœ¨å¼ºçº¿æ€§å…³ç³»:CO2 å’Œæ¸©åº¦ã€CO2 å’Œæ¹¿åº¦ã€æ¹¿åº¦å’Œæ¹¿åº¦æ¯”ã€æ¹¿åº¦æ¯”å’Œ CO2ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥é€šè¿‡ç»˜åˆ¶çƒ­å›¾æ¥é‡åŒ–è¿™äº›å…³ç³»ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="59ca" class="kv kw iq kr b gy kx ky l kz la">corr=df.iloc[:, 1:-1].corr()<br/><em class="my"># Generate a mask for the upper triangle</em><br/>mask = np.triu(np.ones_like(corr, dtype=np.bool))<br/><em class="my"># Set up the matplotlib figure</em><br/>f, ax = plt.subplots(figsize=(11, 9))</span><span id="3248" class="kv kw iq kr b gy mq ky l kz la"><em class="my"># Draw the heatmap with the mask and correct aspect ratio</em><br/>ax=sns.heatmap(corr, mask=mask,<br/>            square=<strong class="kr ir">True</strong>, linewidths=.5, cbar_kws={"shrink": .5})</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/7235973628dd8a65e5931d47a2eb4766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Uo9Hr6eVO4pNjwtZ8WM47A.png"/></div></figure><p id="3243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¸…æ¥šåœ°è¡¨æ˜ï¼Œä¸¤å¯¹æ¹¿åº¦-æ¹¿åº¦æ¯”å’Œæ¹¿åº¦æ¯”-CO2 è¡¨ç°å‡ºæœ€å¼ºçš„çº¿æ€§å…³ç³»ã€‚</p><h1 id="f91b" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">åŸºäº PyMC3 çš„è´å¶æ–¯é€»è¾‘æ¨¡å‹</h1><p id="2d84" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">æˆ‘ä»¬å°†å»ºç«‹å‡ ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œæ ¹æ®å…¶ä»–å˜é‡å¯¹å…¥ä½æƒ…å†µè¿›è¡Œåˆ†ç±»ã€‚</p><p id="a773" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªäºŒå…ƒå†³ç­–é—®é¢˜ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å˜é‡å‡è®¾éµå¾ªä¼¯åŠªåˆ©éšæœºå˜é‡ï¼Œp ç”±ä¸‹å¼ç»™å‡º:</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f17e07fc06bcca0f4ae479e1a6abb573.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*f7v_HMgB07xfg_IMzoBW0A.jpeg"/></div></figure><p id="a763" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å…¶ä¸­ï¼Œvar æ˜¯æˆ‘ä»¬åœ¨æ¨¡å‹ä¸­ä½¿ç”¨çš„æ‰€æœ‰å˜é‡çš„é›†åˆï¼Œlogit æ˜¯é€»è¾‘å‡½æ•°ã€‚</p><p id="6cb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†å»ºç«‹è´å¶æ–¯é€»è¾‘å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬é¦–å…ˆè¦å¯¹æ¯ä¸ªå‚æ•°è¿›è¡Œå…ˆéªŒåˆ†å¸ƒã€‚è¿™äº›å…ˆéªŒçš„é€‰æ‹©å°†å½±å“ç»“æœ(å°½ç®¡æœ‰æ›´å¤šçš„æ•°æ®ï¼Œå®ƒä»¬å¯èƒ½ä¼šâ€œæ”¶æ•›â€åˆ°ç›¸åŒçš„åˆ†å¸ƒã€‚)</p><p id="94ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸€æ—¦æˆ‘ä»¬çš„å…ˆéªŒè¢«æŒ‡å®šï¼ŒPyMC3 å°†ä½¿ç”¨<a class="ae kl" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" rel="noopener ugc nofollow" target="_blank">é©¬å°”å¯å¤«é“¾è’™ç‰¹å¡ç½—</a>æ¨¡æ‹ŸåŠå…¶æ¨å¹¿åœ¨æ•°å€¼ä¸Šè¿‘ä¼¼åéªŒåˆ†å¸ƒã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›åéªŒæ ·æœ¬è¿›è¡Œæ¨æ–­ã€‚</p><h1 id="5e9f" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">å…ˆéªŒåˆ†å¸ƒå‡åŒ€çš„ç¬¬ä¸€ä¸ªæ¨¡å‹</h1><p id="b536" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">ç”±äºæˆ‘ä»¬æ²¡æœ‰å…³äºè¿™äº›å‚æ•°çš„å…ˆéªŒçŸ¥è¯†ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å®ƒä»¬å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å‡è®¾æ‰€æœ‰çš„Î²_var æœä»ä¸€ä¸ªä¸Šä¸‹ç•Œéƒ½å¾ˆå¤§çš„å‡åŒ€åˆ†å¸ƒã€‚ä¸ºäº†æ•æ‰ä¸€å¼ å¤§ç½‘ï¼Œæˆ‘ä»¬å¯¹å‡åŒ€åˆ†å¸ƒä½¿ç”¨å¤§çš„ä¸Šä¸‹ç•Œã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="f913" class="kv kw iq kr b gy kx ky l kz la"><br/>lower=-10**6<br/>higher=10**6<br/><strong class="kr ir">with</strong> pm.Model() <strong class="kr ir">as</strong> first_model:<br/>    <em class="my">#priors on parameters</em><br/>    beta_0=pm.Uniform('beta_0', lower=lower, upper= higher)<br/>    beta_temp=pm.Uniform('beta_temp', lower, higher)<br/>    beta_humid=pm.Uniform('beta_humid', lower, higher)<br/>    beta_light=pm.Uniform('beta_light', lower, higher)<br/>    beta_co2=pm.Uniform('beta_co2', lower, higher)<br/>    beta_humid_ratio=pm.Uniform('beta_humid_ration', lower, higher)<br/>    <br/>    <em class="my">#the probability of belonging to class 1</em><br/>    p = pm.Deterministic('p', pm.math.sigmoid(beta_0+beta_temp*df['Temperature']+<br/>                               beta_humid*df['Humidity']+<br/>                               beta_light*df['Light']+<br/>                               beta_co2*df['CO2']+<br/>                               beta_humid_ratio*df['HumidityRatio']))<br/><strong class="kr ir">with</strong> first_model:<br/>    <em class="my">#fit the data </em><br/>    observed=pm.Bernoulli("occupancy", p, observed=df['Occupancy'])<br/>    start=pm.find_MAP()<br/>    step=pm.Metropolis()<br/>    <br/>    <em class="my">#samples from posterior distribution </em><br/>    trace=pm.sample(25000, step=step, start=start)<br/>    burned_trace=trace[15000:]</span></pre><p id="2fcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ¥è¿è¡Œã€‚ä¸€æ—¦å®Œæˆï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»˜åˆ¶æ ·æœ¬ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a647" class="kv kw iq kr b gy kx ky l kz la">pm.traceplot(burned_trace)<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/025beb20de668328117cba73f1a99a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1Urt318OJvXz2jTcVdPDw.png"/></div></div></figure><p id="ffc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¾—å‡ºç»“è®ºï¼Œæˆ‘ä»¬çš„ç®—æ³•ç¡®å®æ”¶æ•›ã€‚æˆ‘ä»¬å¯ä»¥è®¡ç®—è¿™äº›åéªŒåˆ†å¸ƒçš„å¹³å‡å€¼ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="0be5" class="kv kw iq kr b gy kx ky l kz la">coeffs=['beta_0', 'beta_temp', 'beta_humid', 'beta_light', 'beta_co2', 'beta_humid_ration']<br/>d=dict()<br/><strong class="kr ir">for</strong> item <strong class="kr ir">in</strong> coeffs:<br/>    d[item]=[burned_trace[item].mean()]<br/>    <br/>result_coeffs=pd.DataFrame.from_dict(d)    <br/>result_coeffs<br/><em class="my">#coeff_result=pd.DataFrame(d)    </em><br/><em class="my">#coeff_result</em></span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/e924e2c86d856be3b13dee0ff44afaa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*IzHdV-7OkajOt1v4W9eTyA.jpeg"/></div></figure><p id="1388" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸é¢‘ç‡ç»Ÿè®¡ç›¸æ¯”ï¼Œè´å¶æ–¯ç»Ÿè®¡çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯æˆ‘ä»¬æ‹¥æœ‰çš„ä¸ä»…ä»…æ˜¯å¹³å‡å€¼ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—è¿™äº›å‚æ•°çš„ 95% <a class="ae kl" href="https://www.sciencedirect.com/topics/mathematics/highest-density-interval#:~:text=Second%20Edition)%2C%202015-,4.3.,highest%20density%20interval%2C%20abbreviated%20HDI.&amp;text=Moreover%2C%20the%20probability%20density%20of,any%20x%20outside%20those%20limits." rel="noopener ugc nofollow" target="_blank">é«˜å¯†åº¦åŒºé—´</a>ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="62ea" class="kv kw iq kr b gy kx ky l kz la">pm.stats.hpd(burned_trace['beta_0'])<br/>coeffs=['beta_0', 'beta_temp', 'beta_humid', 'beta_light', 'beta_co2', 'beta_humid_ration']<br/>interval=dict()</span><span id="aae7" class="kv kw iq kr b gy mq ky l kz la"><strong class="kr ir">for</strong> item <strong class="kr ir">in</strong> coeffs:<br/>    interval[item]=pm.stats.hpd(burned_trace[item]) <em class="my">#compute 95% high density interval</em><br/>    <br/>result_coeffs=pd.DataFrame.from_dict(interval).rename(index={0: 'lower', 1: 'upper'})<br/>result_coeffs</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nd"><img src="../Images/7d6b0d620eeb0e6c153184b852b4b11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIBwiZPMlJNEt-lG1OLmcQ.jpeg"/></div></div></figure><p id="a674" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ³¨æ„ï¼Œæ¹¿åº¦æ¯”çš„ç³»æ•°æ˜æ˜¾å¤§äºå…¶ä»–ç³»æ•°ã€‚è¿™å¹¶ä¸ä¸€å®šæ„å‘³ç€è¿™ä¸ªå˜é‡æ›´é‡è¦ã€‚å¦‚æœæˆ‘ä»¬ä»”ç»†è§‚å¯Ÿæ•°æ®ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªå˜é‡å–çš„å€¼éå¸¸å°ã€‚</p><p id="09fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æ¢ç´¢ä¸åŒå‚æ•°ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹Î²_ CO2 å’ŒÎ²_ wet _ ratio ç³»æ•°ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="7a15" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5, 12.5)<br/>seaborn.jointplot(burned_trace['beta_co2'], burned_trace['beta_humid_ration'], kind="hex") <em class="my">#color="#4CB391")</em><br/>plt.xlabel("beta_co2")<br/>plt.ylabel("beta_humid_ratio");</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/58656050c6d45e8b243099497596f57e.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*klDJjjqYwPNo-Zy_HG3I6g.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">CO2 å’Œæ¹¿åº¦æ¯”ç³»æ•°çš„æ•£ç‚¹å›¾</p></figure><p id="42e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ›²çº¿å›¾æ˜¾ç¤ºè¿™ä¸¤ä¸ªç³»æ•°è´Ÿç›¸å…³ã€‚æ³¨æ„ï¼ŒCO2 æ°´å¹³å’Œæ¹¿åº¦æ¯”æ˜¯æ­£ç›¸å…³çš„ã€‚</p><p id="2ddb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å›æƒ³ä¸€ä¸‹ï¼Œåœ¨ç»å…¸çš„é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡<a class="ae kl" href="https://en.wikipedia.org/wiki/Maximum_a_posteriori_estimation" rel="noopener ugc nofollow" target="_blank">æœ€å¤§åéªŒä¼°è®¡</a> (MAP è§£)æ¥å¯»æ‰¾æœ€ä½³å‚æ•°ã€‚æ¢å¥è¯è¯´ï¼Œæœ€ä½³æ‹Ÿåˆå‚æ•°ç”±ä¸‹å¼ç»™å‡º</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nf"><img src="../Images/e31ff5a2dab7e67974461fda5b2d60bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Wsi9HojELWE_E2NmvDbxg.jpeg"/></div></div></figure><p id="78c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å…¶ä¸­ï¼Œğ‘(ğœƒ|ğ·)p(Î¸|D æ˜¯ç»™å®šæ•°æ®æ—¶Î¸çš„åéªŒåˆ†å¸ƒï¼Œp(D|Î¸)æ˜¯ä¼¼ç„¶å‡½æ•°ï¼Œp(Î¸)æ˜¯Î¸çš„å…ˆéªŒåˆ†å¸ƒã€‚</p><p id="aea7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¯·æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªæ¨¡å‹ä¸­ä½¿ç”¨å‡åŒ€åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸæˆ‘ä»¬çš„ MAP è§£å†³æ–¹æ¡ˆåº”è¯¥ä¸ MLE è§£å†³æ–¹æ¡ˆ(<a class="ae kl" href="https://en.wikipedia.org/wiki/Maximum_likelihood_estimation" rel="noopener ugc nofollow" target="_blank">æœ€å¤§ä¼¼ç„¶ä¼°è®¡</a>)ä¸€è‡´ï¼Œåè€…å¯¹åº”äº frequentist logistic å›å½’ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Scikit-Learn åº“æ¥æµ‹è¯•è¿™ä¸ªè¯­å¥ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ MAP è®¡ç®—ç³»æ•°ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="83c4" class="kv kw iq kr b gy kx ky l kz la">coeffs=['beta_0', 'beta_temp', 'beta_humid', 'beta_light', 'beta_co2', 'beta_humid_ration']<br/>d=dict()<br/><strong class="kr ir">for</strong> item <strong class="kr ir">in</strong> coeffs:<br/>    d[item]=[float(start[item])]<br/>    <br/>map_coeffs=pd.DataFrame.from_dict(d)    <br/>map_coeffs</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ng"><img src="../Images/401553c9a92c7662a7825f56ff5d3fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ld2heI3QP5_z3IPrYlBdcw.jpeg"/></div></div></figure><p id="3f0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨ç»å…¸çš„é€»è¾‘å›å½’è®¡ç®—Î²ç³»æ•°ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="aca1" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">from</strong> <strong class="kr ir">sklearn.linear_model</strong> <strong class="kr ir">import</strong> LogisticRegression</span><span id="a460" class="kv kw iq kr b gy mq ky l kz la">X=df.iloc[:, 1: -1]<br/>y=df['Occupancy']<br/>logit=LogisticRegression()<br/>logit_model=logit.fit(X,y)<br/>pd.DataFrame(logit_model.coef_, columns=X.columns)</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nh"><img src="../Images/929f6a2ea765cd1ae7cc5f5ce17d95c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*sDSWGnAyUIyzExCXgY6GqQ.jpeg"/></div></div></figure><p id="b647" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ˜¯å•Šï¼ä¸¤ç§æ–¹æ³•çš„ç³»æ•°å‡ ä¹ç›¸åŒã€‚</p><p id="308c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¨è®ºäº†æˆ‘ä»¬çš„æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ï¼Œå¹¶ä¸ç»å…¸çš„é€»è¾‘å›å½’è¿›è¡Œäº†æ¯”è¾ƒã€‚æˆ‘ä»¬ç”¨ç»å…¸æ–¹æ³•è®°å½•é¢„æµ‹ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="4074" class="kv kw iq kr b gy kx ky l kz la">logit_prediction=logit_model.predict(X)</span></pre><p id="2506" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ºäº†ä½¿ç”¨è´å¶æ–¯é€»è¾‘æ¨¡å‹è¿›è¡Œé¢„æµ‹ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹æ ·æœ¬å€¼è¿›è¡Œå¹³å‡æ¥è®¡ç®—ğ‘¦_scoreã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6bfc" class="kv kw iq kr b gy kx ky l kz la"><em class="my">#compute the average probability of predicting 1. </em><br/>y_score = np.mean(burned_trace['p'], axis=0)</span><span id="65c7" class="kv kw iq kr b gy mq ky l kz la"><em class="my">#histogram of the distribution</em><br/>figsize(12.5,4)<br/>plt.hist(y_score, bins=40, density=<strong class="kr ir">True</strong>)<br/>plt.xlabel('Probability')<br/>plt.ylabel('Frequency')<br/>plt.title('Distribution of $y_score$')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ni"><img src="../Images/00abac1d42e5fa940c2ef04cddfe1d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1SeBWK1i0MPYxnUEhXiByw.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">y åˆ†æ•°çš„åˆ†å¸ƒ</p></figure><p id="73f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æœ‰è¶£çš„æ˜¯ï¼Œp çš„å¤§éƒ¨åˆ†é›†ä¸­åœ¨ 0 å’Œ 1 é™„è¿‘ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ y_score è¿›è¡Œé¢„æµ‹ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="044e" class="kv kw iq kr b gy kx ky l kz la">first_model_prediction=[1 <strong class="kr ir">if</strong> x &gt;0.5 <strong class="kr ir">else</strong> 0 <strong class="kr ir">for</strong> x <strong class="kr ir">in</strong> y_score]</span></pre><p id="812d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬é€šè¿‡è®¡ç®—æ··æ·†çŸ©é˜µæ¥è¯„ä¼°æˆ‘ä»¬çš„æ¨¡å‹çš„æ€§èƒ½ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="52ac" class="kv kw iq kr b gy kx ky l kz la">first_model_confussion_matrix =confusion_matrix(df['Occupancy'], first_model_prediction)<br/>first_model_confussion_matrix</span><span id="dd05" class="kv kw iq kr b gy mq ky l kz la">array([[1639,   54],<br/>       [   3,  969]])</span></pre><p id="2b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™å¾ˆå¥½ã€‚æˆ‘ä»¬ç”šè‡³è¿˜å¯ä»¥é€šè¿‡å…¶ä»–æŒ‡æ ‡æ¥é‡åŒ–æ€§èƒ½ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="11cd" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">import</strong> <strong class="kr ir">sklearn</strong><br/><strong class="kr ir">from</strong> <strong class="kr ir">sklearn.metrics</strong> <strong class="kr ir">import</strong> classification_report</span><span id="234c" class="kv kw iq kr b gy mq ky l kz la">print(sklearn.metrics.classification_report(y, first_model_prediction))</span><span id="c3c6" class="kv kw iq kr b gy mq ky l kz la">precision    recall  f1-score   support</span><span id="341e" class="kv kw iq kr b gy mq ky l kz la">           0       1.00      0.97      0.98      1693<br/>           1       0.95      1.00      0.97       972</span><span id="52b3" class="kv kw iq kr b gy mq ky l kz la">    accuracy                           0.98      2665<br/>   macro avg       0.97      0.98      0.98      2665<br/>weighted avg       0.98      0.98      0.98      2665</span></pre><p id="bd33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¡ç®—æ›²çº¿ä¸‹çš„é¢ç§¯ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="b555" class="kv kw iq kr b gy kx ky l kz la">pred_scores = dict(y_true=df['Occupancy'],y_score=y_score)<br/>roc_auc_score(**pred_scores)</span><span id="0928" class="kv kw iq kr b gy mq ky l kz la">0.99358530283253</span></pre><p id="0a41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è¡¨ç°å¾—ç›¸å½“å¥½ã€‚æˆ‘ä»¬æ¥å’Œç»å…¸çš„ logistic å›å½’æ¯”è¾ƒä¸€ä¸‹ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="938b" class="kv kw iq kr b gy kx ky l kz la">print(sklearn.metrics.classification_report(y, logit_prediction))</span><span id="2d37" class="kv kw iq kr b gy mq ky l kz la">precision    recall  f1-score   support</span><span id="1b6a" class="kv kw iq kr b gy mq ky l kz la">           0       1.00      0.97      0.98      1693<br/>           1       0.95      1.00      0.97       972</span><span id="2347" class="kv kw iq kr b gy mq ky l kz la">    accuracy                           0.98      2665<br/>   macro avg       0.97      0.98      0.98      2665<br/>weighted avg       0.98      0.98      0.98      2665</span></pre><p id="c821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä»–ä»¬æ˜¯ä¸€æ ·çš„ï¼ç„¶è€Œï¼Œä½¿ç”¨è´å¶æ–¯æ¨¡å‹ï¼Œæˆ‘ä»¬è·å¾—äº†æ›´å¤šçš„ä¿¡æ¯ï¼Œå› æ­¤æˆ‘ä»¬å¯¹è‡ªå·±çš„ä¼°è®¡æ›´æœ‰ä¿¡å¿ƒã€‚</p><h1 id="f45f" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">å…ˆéªŒåˆ†å¸ƒä¸ºæ­£æ€åˆ†å¸ƒçš„ä¸åŒæ¨¡å‹ã€‚</h1><p id="c607" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä¸€ç»„ä¸åŒçš„å…ˆéªŒçŸ¥è¯†æ¥è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾ç³»æ•°éµå¾ªæ­£æ€åˆ†å¸ƒã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="92cd" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">with</strong> pm.Model() <strong class="kr ir">as</strong> second_model: <br/>    #priors with normal distribution</span><span id="a0fb" class="kv kw iq kr b gy mq ky l kz la">    beta_0=pm.Normal('beta_0', mu=0, sd=10**4)<br/>    beta_temp=pm.Normal('beta_temp', mu=0, sd=10**4)<br/>    beta_humid=pm.Normal('beta_humid', mu=0, sd=10**4)<br/>    beta_light=pm.Normal('beta_light', mu=0, sd=10**4)<br/>    beta_co2=pm.Normal('beta_co2', mu=0, sd=10**4)<br/>    beta_humid_ratio=pm.Normal('beta_humid_ration', mu=0, sd=10**4)</span><span id="d02f" class="kv kw iq kr b gy mq ky l kz la">    #probability of belonging to class 1</span><span id="af8e" class="kv kw iq kr b gy mq ky l kz la">    p = pm.Deterministic('p', pm.math.sigmoid(beta_0+beta_temp*df['Temperature']+<br/>                               beta_humid*df['Humidity']+<br/>                               beta_light*df['Light']+<br/>                               beta_co2*df['CO2']+<br/>                               beta_humid_ratio*df['HumidityRatio']))</span><span id="346d" class="kv kw iq kr b gy mq ky l kz la">#fit observed data into the model</span><span id="dd17" class="kv kw iq kr b gy mq ky l kz la"><strong class="kr ir">with</strong> second_model:<br/>    observed=pm.Bernoulli("occupancy", p, observed=df['Occupancy'])<br/>    start=pm.find_MAP()<br/>    step=pm.Metropolis()<br/>    second_trace=pm.sample(25000, step=step, start=start)<br/>    second_burned_trace=second_trace[15000:]<br/>pm.traceplot(second_burned_trace)<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/d8c124f5f86e4e8bfb394a8896ffda3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBiX44ebTfgcUAcR_ACTKw.png"/></div></div></figure><p id="67c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å†æ¬¡çœ‹åˆ°ç®—æ³•ç¡®å®æ”¶æ•›äº†ã€‚è®©æˆ‘ä»¬è®¡ç®— MAP è§£çš„Î²ç³»æ•°ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="f485" class="kv kw iq kr b gy kx ky l kz la">coeffs=['beta_0', 'beta_temp', 'beta_humid', 'beta_light', 'beta_co2', 'beta_humid_ration']<br/>d=dict()<br/><strong class="kr ir">for</strong> item <strong class="kr ir">in</strong> coeffs:<br/>    d[item]=[float(start[item])]<br/>    <br/>second_map_coeffs=pd.DataFrame.from_dict(d)    <br/>second_map_coeffs</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nj"><img src="../Images/b79bcb3f76ff470ad8f2308bf4971e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XjkRsY65sJvyGIZxZ6wABQ.jpeg"/></div></div></figure><p id="4821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®ƒä»¬ä¸æˆ‘ä»¬åœ¨ç¬¬ä¸€ä¸ªæ¨¡å‹ä¸­å¾—åˆ°çš„éå¸¸æ¥è¿‘ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è´å¶æ–¯æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹çš„åéªŒåˆ†å¸ƒã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆªè·å˜é‡ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="3ef1" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.hist(burned_trace['beta_0']-second_burned_trace['beta_0'], bins=40, density=<strong class="kr ir">True</strong>)<br/>plt.title('Distribution of the difference between beta_0')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ms"><img src="../Images/ffb15ab92144455feee376e564c44575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfkKNxJbqk1M-gPHH2kYvw.png"/></div></div></figure><p id="dd59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è™½ç„¶ MAP è§£å¯¹Î²_0 ç»™å‡ºäº†ç›¸åŒçš„ä¼°è®¡ï¼Œä½†æˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªåéªŒæ¦‚ç‡ç›¸å½“ä¸åŒã€‚è®©æˆ‘ä»¬ä¹Ÿæ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´Î²_temp çš„åéªŒåˆ†å¸ƒã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="866c" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.hist(burned_trace['beta_temp'], label='First model', bins=40, density=<strong class="kr ir">True</strong>)<br/>plt.hist(second_burned_trace['beta_temp'], bins=40, label='Second model', density=<strong class="kr ir">True</strong>)<br/>plt.title('Distribution of of beta_temp')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mr"><img src="../Images/02e44df7a107fe79ab0f27e11efc3791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kL0vw4YBgVVfWqQlL9kZew.png"/></div></div></figure><p id="96ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å®é™…ä¸Šå·®åˆ«å¾ˆå°ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è®¡ç®—ç¬¬äºŒä¸ªæ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="7e71" class="kv kw iq kr b gy kx ky l kz la">second_y_score = np.mean(second_burned_trace['p'], axis=0)<br/>second_model_prediction=[1 <strong class="kr ir">if</strong> x &gt;0.5 <strong class="kr ir">else</strong> 0 <strong class="kr ir">for</strong> x <strong class="kr ir">in</strong> second_y_score]<br/>second_model_confussion_matrix =confusion_matrix(df['Occupancy'], second_model_prediction)<br/>second_model_confussion_matrix</span><span id="6fe5" class="kv kw iq kr b gy mq ky l kz la">array([[1639,   54],<br/>       [   3,  969]])</span></pre><p id="0d2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸æˆ‘ä»¬ä»ç¬¬ä¸€ä¸ªæ¨¡å‹ä¸­å¾—åˆ°çš„ç»“æœç›¸åŒã€‚æˆ‘ä»¬å¯ä»¥æ£€æŸ¥ä¸€ä¸‹ y_score å’Œ second_y_score å‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="b48e" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.hist(y_score-second_y_score, bins=40)<br/>plt.title('Distribution of the difference between y_score and second_y_score')<br/>plt.ylabel('Frequency')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nk"><img src="../Images/ed9a0d4dd155f35d7f6dddf39a14b0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JStfEfdPTySzXvXonciAVQ.png"/></div></div></figure><h1 id="4336" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">å†…ç½®å¹¿ä¹‰çº¿æ€§æ¨¡å‹(GLM)çš„æ¨¡å‹ã€‚</h1><p id="5d4e" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®é™…æ“ä½œçš„æ–¹æ³•æ¥æ„å»ºæˆ‘ä»¬çš„æ¨¡å‹ã€‚è¿™å¾ˆå®¹æ˜“ï¼Œå› ä¸ºæˆ‘ä»¬åªæœ‰å‡ ä¸ªå˜é‡ã€‚å½“å˜é‡æ•°é‡å¾ˆå¤§çš„æ—¶å€™ï¼Œå°±ä¸ä¼šå¾ˆå®ç”¨äº†ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPyMC3 æœ‰ä¸€ä¸ªå†…ç½®çš„å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œä¸€åˆ‡éƒ½å°†è‡ªåŠ¨åŒ–ã€‚è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªå†…ç½®æ¨¡å‹æ¥æ‹Ÿåˆæˆ‘ä»¬çš„æ•°æ®ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="471f" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">with</strong> pm.Model() <strong class="kr ir">as</strong> third_model:<br/>    pm.glm.GLM.from_formula('Occupancy ~ Temperature + Humidity + Light + CO2 + HumidityRatio',<br/>                            df,<br/>                            family=pm.glm.families.Binomial())<br/>    third_trace = pm.sample(25000, tune=10000, init='adapt_diag')</span><span id="004f" class="kv kw iq kr b gy mq ky l kz la">pm.traceplot(third_trace)<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/d2e3ed3f6ef08366283891f8ca4e302e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zq4gmJbc46fXgNXD5umu4A.png"/></div></div></figure><p id="5a4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ä¸ä»¥å‰çš„æ¨¡å‹ä¸åŒï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„å‚æ•°çš„åéªŒåˆ†å¸ƒæ˜¯å•å³°çš„ã€‚</p><p id="26f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬æ€»ç»“ä¸€ä¸‹è¿™äº›åéªŒåˆ†å¸ƒã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="8985" class="kv kw iq kr b gy kx ky l kz la">pm.summary(third_trace)</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nl"><img src="../Images/1ee0cffdcfb115706c6c096f028ca0d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YdB3aW8Xa5ML71gw19mzIA.jpeg"/></div></div></figure><p id="c446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">é™¤äº†æŸ¥çœ‹æ±‡æ€»çš„ç»Ÿè®¡æ•°æ®ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æŸ¥çœ‹åœ°å›¾è§£å†³æ–¹æ¡ˆã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="fe62" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">with</strong> third_model:<br/>    map_solution=pm.find_MAP()<br/>d=dict()<br/><strong class="kr ir">for</strong> item <strong class="kr ir">in</strong> map_solution.keys():<br/>    d[item]=[float(map_solution[item])]<br/>    <br/>third_map_coeffs=pd.DataFrame.from_dict(d)    <br/>third_map_coeffs</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nm"><img src="../Images/9f26faa10df21140233f133962793fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*po-AVu3ULBkUjpQ_09Vfpg.jpeg"/></div></div></figure><p id="821a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬çœ‹åˆ°ï¼Œç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æ¨¡å‹çš„åœ°å›¾è§£å†³æ–¹æ¡ˆä¹‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚é¢„æµ‹å‘¢ï¼Ÿ</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="34e5" class="kv kw iq kr b gy kx ky l kz la"><strong class="kr ir">with</strong> third_model:<br/>    ppc = pm.sample_posterior_predictive(third_trace, samples=15000)</span><span id="c5a8" class="kv kw iq kr b gy mq ky l kz la"><em class="my">#compute y_score </em><br/><strong class="kr ir">with</strong> third_model:<br/>    third_y_score = np.mean(ppc['y'], axis=0)<br/><em class="my">#convert y_score into binary decisions    </em><br/>third_model_prediction=[1 <strong class="kr ir">if</strong> x &gt;0.5 <strong class="kr ir">else</strong> 0 <strong class="kr ir">for</strong> x <strong class="kr ir">in</strong> third_y_score]</span><span id="aab1" class="kv kw iq kr b gy mq ky l kz la"><em class="my">#compute confussion matrix </em><br/>third_model_confussion_matrix =confusion_matrix(df['Occupancy'], third_model_prediction)<br/>third_model_confussion_matrix</span><span id="9744" class="kv kw iq kr b gy mq ky l kz la">array([[1639,   54],<br/>       [   3,  969]])</span></pre><p id="a69b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ä¸ªæ··æ·†çŸ©é˜µä¸å‰ä¸¤ä¸ªæ¨¡å‹ä¸­çš„ç›¸åŒã€‚ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªæ¨¡å‹çš„ y åˆ†æ•°åˆ†å¸ƒå¦‚ä½•ï¼Ÿ</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="95a6" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.hist(third_y_score-second_y_score, bins=40)<br/>plt.title('Distribution of the difference between y_score and second_y_score')<br/>plt.ylabel('Frequency')<br/>plt.show(</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nk"><img src="../Images/87c0842bec07e798a82fb3f2c517b6bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U9VCQJyUQh6FntHoGNnM9Q.png"/></div></div></figure><p id="2dd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è¿™ç§åˆ†å¸ƒé›†ä¸­åœ¨ 0 å·¦å³ã€‚æ¢å¥è¯è¯´ï¼Œy_scores åœ¨ä¸åŒæ¨¡å‹é—´çš„åˆ†å¸ƒå‡ ä¹ç›¸åŒã€‚ç³»æ•°å‘¢ï¼Œæ¯”å¦‚æ¸©åº¦ç³»æ•°ï¼Ÿ</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="0f3e" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.hist(third_trace['Temperature'][-40000:]-second_burned_trace['beta_temp'], bins=40, density=<strong class="kr ir">True</strong>)<br/>plt.title('Difference between the temperature coefficients for the second and the third model')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nn"><img src="../Images/f3e9f2303816185031728d221715d0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QnU5F0lUbXSN7eGDOVPGxw.png"/></div></div></figure><p id="a738" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">å·®å€¼è¿‘ä¼¼éµå¾ªå…·æœ‰å°å¹³å‡å€¼çš„æ­£æ€åˆ†å¸ƒã€‚</p><p id="39c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">è®©æˆ‘ä»¬ä¹Ÿæ£€æŸ¥ä¸€ä¸‹æ¹¿åº¦ç³»æ•°ä¹‹é—´çš„å·®å¼‚ã€‚</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="4de5" class="kv kw iq kr b gy kx ky l kz la">figsize(12.5,4)<br/>plt.boxplot(third_trace['Humidity'][-40000:]-second_burned_trace['beta_humid'])<br/>plt.title('Difference between the humidity coefficients for the second and the third model')<br/>plt.show()</span></pre><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi no"><img src="../Images/40cd0f34c46c3553b04878c0038cb5b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E-xonSPJnI4oMbKYdQBYAQ.png"/></div></div></figure><p id="f4be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">åŒæ ·ï¼Œè¿™ç§å·®å¼‚å¾ˆå°ã€‚</p><h1 id="06c2" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">3.ç»“è®º</h1><p id="4ac6" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">æˆ‘ä»¬çœ‹åˆ°ï¼Œå³ä½¿æˆ‘ä»¬çš„æ¨¡å‹ä½¿ç”¨ä¸åŒçš„å…ˆéªŒï¼Œé¢„æµ‹æ€§èƒ½æ˜¯ç›¸ä¼¼çš„ã€‚è¿™è¯å®äº†æˆ‘ä»¬çš„ä¿¡å¿µï¼Œéšç€æˆ‘ä»¬çš„æ•°æ®é›†å˜å¤§ï¼Œå®ƒä»¬åº”è¯¥æ”¶æ•›åˆ°åŒä¸€ä¸ªè§£å†³æ–¹æ¡ˆã€‚</p><p id="66d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„é¡¹ç›®å°†å¸®åŠ© PyMC3 çš„åˆå­¦è€…å­¦ä¹ å®ƒçš„è¯­æ³•ã€‚æˆ‘ä»¬å‘ç° PyMC3 çš„ä»£ç ç›¸å½“ç›´è§‚ï¼Œæˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„ä»£ç æ¸…æ¥šåœ°è¯æ˜äº†è¿™ä¸€ç‚¹ã€‚</p><h1 id="99c0" class="lf kw iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">4.å‚è€ƒæ–‡çŒ®ã€‚</h1><p id="1577" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">[1]<a class="ae kl" href="https://docs.pymc.io/notebooks/GLM-logistic.html" rel="noopener ugc nofollow" target="_blank">https://docs.pymc.io/notebooks/GLM-logistic.html</a>å®˜æ–¹ PyMC3 æ–‡æ¡£</p><p id="88d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">[2]<a class="ae kl" href="https://goldinlocks.github.io/Bayesian-logistic-regression-with-pymc3/" rel="noopener ugc nofollow" target="_blank">https://Goldin locks . github . io/Bayesian-logistic-regression-with-pymc 3/</a></p></div></div>    
</body>
</html>