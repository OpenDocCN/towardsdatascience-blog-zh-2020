# ä¸ç”¨ç¦»å¼€ç†ŠçŒ«å°±èƒ½æŠ“å– HTML è¡¨æ ¼

> åŸæ–‡ï¼š<https://towardsdatascience.com/read-html-54a942305c0f?source=collection_archive---------43----------------------->

## å¦‚ä½•ä»åŸºäºè¡¨æ ¼çš„ç½‘ç«™ä¸­å¿«é€Ÿè·å–æ‰€éœ€æ•°æ®

ç½‘ç»œæœé›†é€šå¸¸æ˜¯ä¸€ä»¶ç—›è‹¦çš„äº‹ã€‚ç ”ç©¶ã€æŸ¥æ‰¾å’Œå®‰è£…æ‚¨éœ€è¦çš„åº“å¯èƒ½éå¸¸è€—æ—¶ã€‚åœ¨ HTML ä¸­æ‰¾åˆ°æ‚¨éœ€è¦çš„å†…å®¹éœ€è¦æ—¶é—´ã€‚è®©æ‰€æœ‰ä¸œè¥¿éƒ½å·¥ä½œèµ·æ¥å¯èƒ½å¾ˆéš¾ã€‚ğŸ™

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨ Python pandas åº“ç”¨å•è¡Œä»£ç æ¥æŠ“å– HTML è¡¨æ ¼ï¼å®ƒå¹¶ä¸æ˜¯åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½æœ‰æ•ˆï¼Œä½†æ˜¯å½“ä½ åœ¨ç½‘ç«™ä¸Šæœ‰ HTML è¡¨æ ¼æ—¶ï¼Œå®ƒä¼šè®©ä½ çš„ç”Ÿæ´»å˜å¾—æ›´å®¹æ˜“ã€‚ğŸ˜€

æ‚¨å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å®ƒä»ç½‘ç«™ä¸Šè·å–å…³äºè¶³çƒå’Œä¸¾é‡çš„æ•°æ®ã€‚âš½ï¸ ğŸ‹

![](img/308b6acfe003dbc5bc455e3113cdbfa6.png)

èµ„æ–™æ¥æº:pixabay.com

æˆ‘ä»¬å°†ä½¿ç”¨`[pd.read_html()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_html.html)`æ¥æŠ“å–è¡¨æ ¼æ•°æ®ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼Œå¾ˆå¤šäººä¸çŸ¥é“`pd.read_html()`ï¼Œå°½ç®¡[å·²ç»åœ¨](https://pandas.pydata.org/docs/whatsnew/v0.12.0.html?highlight=read_html)å‡ºç°äº† 7 å¹´å¤šã€‚

æœ¬æ–‡åŸè½½äº [Deepnote](https://beta.deepnote.com/article/scrape-html-tables-without-leaving-pandas) ã€‚ä½ å¯ä»¥åœ¨é‚£é‡Œè¿è¡Œäº¤äº’å¼ç¬”è®°æœ¬ã€‚ğŸ‘

# è®¾ç½®

è¦è·å¾—å¿…éœ€çš„è½¯ä»¶åŒ…åŠå…¶ä¾èµ–é¡¹çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯·å–æ¶ˆæ³¨é‡Šå¹¶è¿è¡Œä»¥ä¸‹ä»£ç ä¸€æ¬¡ã€‚ç„¶åé‡å¯ä½ çš„ç¬”è®°æœ¬å†…æ ¸ã€‚

```
# !pip install pandas lxml beautifulsoup4 html5lib matplotlib -U
```

ä¸€èˆ¬ç†ŠçŒ«ä¼šå°è¯•ç”¨ lxml è§£æ HTMLï¼Œå› ä¸ºå®ƒé€Ÿåº¦å¿«ã€‚å¦‚æœå¤±è´¥ï¼Œå®ƒå°†ä½¿ç”¨ BeautifulSoup4 å’Œ html5libã€‚ä½ å¯ä»¥åœ¨ç†ŠçŒ«[æ–‡æ¡£](https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#html-table-parsing-gotchas)ä¸­é˜…è¯»æ›´å¤šå…³äºè§£æå™¨çš„å†…å®¹ã€‚

è®©æˆ‘ä»¬å¯¼å…¥åŒ…å¹¶æ£€æŸ¥ç‰ˆæœ¬ã€‚æˆ‘æ€»æ˜¯å–œæ¬¢æ£€æŸ¥ Python å’Œå¯†é’¥åº“çš„ç‰ˆæœ¬ï¼Œä»¥å¸®åŠ©è¯Šæ–­å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚ğŸ˜‰

```
import sys
import pandas as pd

print(f"Python version {sys.version}")
print(f"pandas version: {pd.__version__}")> Python version 3.7.3 (default, Jun 11 2019, 01:11:15) 
> [GCC 6.3.0 20170516]
> pandas version: 1.0.5
```

å¦‚æœä½ çš„ Python ç‰ˆæœ¬ä½äº 3.6ï¼Œå»ºè®®ä½ æ›´æ–°ä¸€ä¸‹ã€‚å¦‚æœä½ çš„ç‰ˆæœ¬ä½äº 1.0.5ï¼Œç†ŠçŒ«ä¹Ÿä¸€æ ·ã€‚è¦äº†è§£æ›´å¤šå…³äºç†ŠçŒ« 1.0 çš„æ›´æ–°ï¼Œè¯·çœ‹æˆ‘çš„æŒ‡å—[è¿™é‡Œ](/whats-new-in-pandas-1-0-ffa99bd43a58)ã€‚

## ç¤ºä¾‹ 1:è¶³çƒâš½ï¸

è®©æˆ‘ä»¬æ”¶é›†ä¸€äº›å…³äºç¾å›½å¥³å­å›½å®¶é˜Ÿçš„è¶³çƒç»Ÿè®¡æ•°æ®â€”â€”è¿™æ˜¯ä¸–ç•Œä¸Šå¤§å¤šæ•°åœ°æ–¹çš„è¶³çƒã€‚âš½ï¸

è®©æˆ‘ä»¬ä½¿ç”¨ç¾å›½è¶³çƒç½‘ç«™:[https://www.ussoccer.com/uswnt-stats](https://www.ussoccer.com/uswnt-stats)ã€‚

![](img/cd797766f9e1216148a226d2bba3abec.png)

åœ¨ Chrome ä¸­ï¼Œè¿›å…¥ç½‘ç«™ï¼Œå³å‡»æ•°æ®ï¼Œé€‰æ‹©*æ£€æŸ¥*ã€‚

![](img/76d2efd109ff41f40d8c168ad5338a66.png)

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°è¾¹æ å‡ºç°ã€‚è¿™å‘æ‚¨å±•ç¤ºäº†é¡µé¢èƒŒåçš„ HTMLï¼Œä»¥åŠå…¶ä»–å†…å®¹ã€‚å¯»æ‰¾ HTML æ ‡ç­¾ã€ã€æˆ–

| ã€‚è¿™äº›éƒ½è¡¨æ˜ä½ æ‰¾åˆ°äº†ä¸€å¼ æ¡Œå­ã€‚å¦‚æœä½ æƒ³äº†è§£ HTML è¡¨æ ¼çš„åŸºç¡€çŸ¥è¯†ï¼Œè¯·å‚è§[w3schools.com](https://www.w3schools.com/html/html_tables.asp)ã€‚ |

æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ pandas å‡½æ•°è¦æ±‚æˆ‘ä»¬æ‰¾åˆ° HTML è¡¨ã€‚æ‰€ä»¥ä½ åˆšåˆšæŒ–åˆ°äº†é‡‘å­ï¼ğŸ‰

è®©æˆ‘ä»¬ä»ç½‘é¡µä¸ŠæŠ“å–æ•°æ®ã€‚è¦å°†æ¯ä¸ªè¡¨æ”¾å…¥æ•°æ®å¸§ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¿è¡Œä»¥ä¸‹ä»£ç ã€‚

```
list_of_dfs = pd.read_html('https://www.ussoccer.com/uswnt-stats')
```

ç°åœ¨æ•°æ®å¸§åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚

```
type(list_of_dfs)> list
```

è®©æˆ‘ä»¬çœ‹çœ‹åˆ—è¡¨ä¸­æœ‰å¤šå°‘æ•°æ®å¸§ã€‚

```
len(list_of_dfs)> 2
```

å¥½çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç¬¬ä¸€ä¸ªæ•°æ®æ¡†ã€‚ğŸ‘€

```
list_of_dfs[0]
```

![](img/1eef327e317030b96d067e5a8f8ef01d.png)

çœ‹èµ·æ¥åƒæ˜¯ä¸€å †çƒå‘˜çš„æ•°æ®ã€‚å¾ˆå¥½ï¼Œè¿™ç¬¦åˆæˆ‘ä»¬åœ¨ç½‘ç«™ä¸Šçœ‹åˆ°çš„é¢„æœŸã€‚

è®©æˆ‘ä»¬çœ‹çœ‹ç¬¬äºŒä¸ªè¡¨æ ¼é‡Œæœ‰ä»€ä¹ˆã€‚

```
list_of_dfs[1]
```

![](img/503eb9b614466e5f7132c2c3dad98645.png)

çœ‹èµ·æ¥é‡Œé¢æœ‰å®ˆé—¨å‘˜çš„æ•°æ®ã€‚

åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å°†ç¬¬ä¸€è¡Œä½œä¸ºåˆ—æ ‡é¢˜ï¼Œå°†ç¬¬ä¸€åˆ—ä½œä¸ºç´¢å¼•æ¥è¯»å–ï¼Œæ•ˆæœä¼šæ›´å¥½ã€‚

å½“æ‚¨ä½¿ç”¨`pd.read_html()`è¯»å–è¡¨æ ¼æ—¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è®¸å¤šä¸ä½¿ç”¨`pd.read_csv()`ç›¸åŒçš„å‚æ•°ã€‚è¿™æ˜¯å¤§å¤šæ•°äººæ›´ç†Ÿæ‚‰çš„ç†ŠçŒ«æ–¹æ³•ã€‚ğŸ‘

è®©æˆ‘ä»¬é€šè¿‡å†æ¬¡è·å–æ•°æ®ï¼Œå°†è¡¨åˆ—æ”¾åœ¨æˆ‘ä»¬æƒ³è¦çš„ä½ç½®ã€‚è¿™æ¬¡æˆ‘ä»¬ä¼šé€šè¿‡`header=0, index_col=0`ã€‚

```
list_of_dfs_nicer = pd.read_html('https://www.ussoccer.com/uswnt-stats', header=0, index_col=0)
list_of_dfs_nicer[0].head(2)
```

![](img/429c0c819a469a4e2a39422d270829b1.png)

å¥½å¤šäº†ã€‚ğŸ˜€

è¦åœ¨ Jupyter ç¬”è®°æœ¬æˆ– IDE ä¸­æŸ¥çœ‹æ›´å¤šå¯èƒ½çš„å‚æ•°ï¼Œè¯·åœ¨å‡½æ•°ä¸­æŒ‰ä½`Shift` + `Tab`ã€‚æˆ–è€…ç›´æ¥å»çœ‹[æ–‡æ¡£](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_html.html)ã€‚

æˆ‘ä»¬ç»§ç»­æ‹å§ã€‚ğŸ§»

æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªæ•°æ®å¸§ä¿å­˜ä¸ºå®ƒè‡ªå·±çš„å˜é‡ã€‚è®©æˆ‘ä»¬æŠŠæ‰€æœ‰ä¸æ˜¯å®ˆé—¨å‘˜çš„äººæ”¾åœ¨`runners_df`é‡Œï¼ŒæŠŠå®ˆé—¨å‘˜æ”¾åœ¨`goalies_df`é‡Œã€‚æ ¹æ®äº’è”ç½‘å’Œæˆ‘ç»å¸¸è¸¢è¶³çƒçš„å¥³å„¿çš„è¯´æ³•ï¼Œè¶³çƒé˜Ÿä¸­æ‰€æœ‰çš„éå®ˆé—¨å‘˜éƒ½æ²¡æœ‰ä¸€ä¸ªåå­—ã€‚æˆ‘ç§°ä»–ä»¬ä¸ºè·‘æ­¥è€…ï¼Œå› ä¸ºä»–ä»¬ç»å¸¸è¿™æ ·åšã€‚ğŸ™‚å¦‚æœæˆ‘é—æ¼äº†ä»€ä¹ˆï¼Œè¯·çº æ­£æˆ‘ã€‚

```
runners_df = list_of_dfs_nicer[0]
goalies_df = list_of_dfs_nicer[1]
```

æˆ‘ä»¬å¸Œæœ›æ’é™¤ *runners_df* ä¸­çš„æœ€åä¸‰è¡Œå’Œ *goalies_df* ä¸­çš„æœ€åä¸¤è¡Œã€‚ç”¨`.iloc[]`åˆ‡ç‰‡å§ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºåˆ‡ç‰‡æ•°æ®å¸§å’Œå¦‚ä½•ä½¿ç”¨ç†ŠçŒ«çš„çŸ¥è¯†ï¼Œæˆ‘è°¦æ­åœ°å»ºè®®ä½ çœ‹çœ‹æˆ‘çš„[ä»¤äººéš¾å¿˜çš„ç†ŠçŒ«ä¹¦](https://memorablepandas.com)ã€‚

```
runners_df = runners_df.iloc[:-3]
runners_df.tail(2)
```

![](img/684c63514bf4ecd6a9c96a12271fe030.png)

```
goalies_df = goalies_df.iloc[:-2]
goalies_df
```

![](img/f72b27d4353fa165e2c1c82d56b59f59.png)

è®©æˆ‘ä»¬å¿«é€Ÿåšä¸€ä¸ªå¯è§†åŒ–çš„å±•ç¤ºï¼Œå±•ç¤ºä»Šå¹´æ¯ä¸ªè¿›çƒçš„çƒå‘˜çš„è¿›çƒæƒ…å†µã€‚

```
goal_scorers_df = runners_df[runners_df['G']>0]
goal_scorers_df['G'].sort_values().plot(kind='barh', title='2020 USWNT Goals');
```

![](img/dc021c31fbf8e222306a8a978c6fb977.png)

çœ‹èµ·æ¥å…‹é‡Œæ–¯è’‚å®‰Â·æ™®é›·æ–¯å’Œæ—èµ›Â·éœå…°åœ¨çŸ­æš‚çš„ 2020 èµ›å­£ä¸­é¢†å…ˆå¾—åˆ†ã€‚ğŸ…

å¥½å§ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾ˆå¤šæœ‰è¶£çš„æ•°æ®æ¸…ç†å’Œå¯è§†åŒ–ï¼Œä½†ä»Šå¤©çš„é‡ç‚¹æ˜¯æŠ“å–å’Œè¯»å– HTML è¡¨ã€‚è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚

## ä¾‹å­ 2:ä¸¾é‡ğŸ‹ğŸ¼â€â™€ï¸

[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/List_of_weight_training_exercises)æœ‰ä¸€ä¸ªæœ‰è¶£çš„å›¾è¡¨ï¼Œæ˜¾ç¤ºä¸åŒçš„ä¸¾é‡ç»ƒä¹ é”»ç‚¼äº†å“ªäº›è‚Œè‚‰ç¾¤ã€‚

![](img/5330d789588b2bce6446b0122fb4a92f.png)

æ£€æŸ¥åï¼Œæˆ‘ä»¬çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ª HTML è¡¨ã€‚è®©æˆ‘ä»¬æŠ“ä½å®ƒã€‚ğŸš€

```
weightlifting_df_list = pd.read_html('https://en.wikipedia.org/wiki/List_of_weight_training_exercises', index_col=0)
len(weightlifting_df_list)2weightlifting_df_list[0]
```

![](img/4bdcc7783b54c30bd520811c1cb7b7b1.png)

è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼ğŸ‘

![](img/b89fdb115367bc121e145570eefed763.png)

èµ„æ–™æ¥æº:pixabay.com

è®©æˆ‘ä»¬å°†ç¬¬ä¸€ä¸ªæ•°æ®å¸§èµ‹ç»™ä¸€ä¸ªå˜é‡ã€‚

```
exercises_df = weightlifting_df_list[0]
```

ç°åœ¨ä½ å¯ä»¥å¯¹æ•°æ®æ¡†åšä»»ä½•ä½ æƒ³åšçš„äº‹æƒ…ã€‚ä¹Ÿè®¸ä½ æƒ³è¿‡æ»¤å®ƒï¼Œåªæ˜¾ç¤ºé”»ç‚¼ä½ çš„è…¿ç­‹ã€‚

```
hammies = exercises_df[(exercises_df['Ham-strings']=='Yes') | (exercises_df['Ham-strings']=='Some')]
hammies
```

![](img/9ba58ef86588efbd5255efb0adf10e85.png)

è®©æˆ‘ä»¬æ ¹æ®å¤§é‡é”»ç‚¼è…¿ç­‹çš„ç»ƒä¹ å¯¹è¡¨æ ¼è¿›è¡Œæ’åºã€‚

```
hammies.sort_values(by='Ham-strings', ascending=False)
```

![](img/ccd871b3b9392073eab7fff886238208.png)

çœ‹èµ·æ¥ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ›´å¼ºå£®çš„è…¿ç­‹ï¼Œæˆ‘ä»¬åº”è¯¥åšä¸€äº›å¼“æ­¥ã€ç¡¬æ‹‰å’Œè…¿éƒ¨å¼¯æ›²ã€‚æˆ‘æƒ³æ˜¯æ—¶å€™é”»ç‚¼äº†ï¼ğŸ‹ï¸â€

## åŒ…è£…

æ‚¨å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨`pd.read_html()`å°†æ•°æ®ä» HTML è¡¨ç§»åŠ¨åˆ°ç†ŠçŒ«æ•°æ®å¸§åˆ—è¡¨ä¸­ã€‚`pd.read_html()`å¹¶ä¸æ˜¯æ¯ä¸€ä¸ªç½‘ç»œæŠ“å–åŠªåŠ›çš„æ­£ç¡®å·¥å…·ï¼Œä½†å½“å®ƒæ˜¯ä¸€ä¸ªé€‰æ‹©æ—¶ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„é€‰æ‹©ã€‚ğŸ‘

æˆ‘å¸Œæœ›è¿™ç¯‡å…³äº`pd.read_html()`ç½‘ç»œæŠ“å–çš„ä»‹ç»å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚å¦‚æœä½ æœ‰ï¼Œè¯·åœ¨ä½ æœ€å–œæ¬¢çš„ç¤¾äº¤åª’ä½“ä¸Šåˆ†äº«ï¼Œè¿™æ ·å…¶ä»–äººä¹Ÿå¯ä»¥æ‰¾åˆ°å®ƒã€‚ğŸ˜€

å¦‚æœä½ æœ‰é—®é¢˜æˆ–æ„è§ï¼Œè¯·åœ¨ [Twitter](https://twitter.com/discdiver) æˆ– [LinkedIn](https://www.linkedin.com/in/-jeffhale/) ä¸æˆ‘åˆ†äº«ã€‚

![](img/8d8ceb3d2a0c75de38dc02e3afa0ac52.png)

èµ„æ–™æ¥æº:pixabay.com

åˆ®çš„å¼€å¿ƒï¼ğŸš€