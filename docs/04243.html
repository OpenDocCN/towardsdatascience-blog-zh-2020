<html>
<head>
<title>Predicting the Stock Market with Machine Learning. Findings.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习预测股市。调查结果。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf?source=collection_archive---------32-----------------------#2020-04-17">https://towardsdatascience.com/predicting-the-stock-market-with-machine-learning-findings-135f0b3a26cf?source=collection_archive---------32-----------------------#2020-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ee6b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">亨尼投资</h2><div class=""/><div class=""><h2 id="b303" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用机器学习识别高收入成长股</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/4f18083208c89d489299d8f5d0064230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*08O400D91BKu7BZo7C23tg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://stock.adobe.com/ca/search?filters%5Bcontent_type%3Aphoto%5D=1&amp;filters%5Bcontent_type%3Aillustration%5D=1&amp;filters%5Bcontent_type%3Azip_vector%5D=1&amp;filters%5Bcontent_type%3Avideo%5D=1&amp;filters%5Bcontent_type%3Atemplate%5D=1&amp;filters%5Bcontent_type%3A3d%5D=1&amp;filters%5Bcontent_type%3Aimage%5D=1&amp;k=performance&amp;order=relevance&amp;safe_search=1&amp;search_page=1&amp;search_type=usertyped&amp;acp=&amp;aco=performance&amp;limit=100&amp;get_facets=0&amp;asset_id=305061159&amp;continue_checkout=1" rel="noopener ugc nofollow" target="_blank">图片</a>由<a class="ae lh" href="https://stock.adobe.com/ca/contributor/207328848/teerapon?load_type=author&amp;prev_url=detail" rel="noopener ugc nofollow" target="_blank"> teerapon </a>拍摄</p></figure><p id="dfdd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我展示了我在 2014 年至 2019 年间预测<strong class="lk jd"> S &amp; P500 </strong>家公司的<strong class="lk jd">明年收入</strong>的主要发现。虽然这不是必需的，但我鼓励读者看到我在这里分享的观察结果:</p><ul class=""><li id="7eb0" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-introduction-310cd6069ffa?source=friends_link&amp;sk=d4479bf5481f19b2b0b7ac9fe87366af" rel="noopener">用机器学习预测股市。引言。</a></li><li id="ec47" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://medium.com/vhinny-investing/predicting-the-stock-market-with-machine-learning-benchmarking-44181286389?source=friends_link&amp;sk=a5e00eb9c7a7ae1b59e0903b2a942532" rel="noopener">用机器学习预测股市。标杆管理。</a></li><li id="101b" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&amp;sk=ceb5326ca92e917eceecb02beea7efbd">用机器学习预测股市。司机。</a></li></ul><p id="bd16" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们开始吧！</p><h1 id="6850" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated"><strong class="ak">知道模型在做什么</strong></h1><p id="261a" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">设计一个优秀的机器学习模型，关键是要准确知道它在做什么。当使用类似于<strong class="lk jd">回归</strong>的东西时，达成这种理解可能很容易，而当使用<strong class="lk jd">深度学习神经网络时，则非常困难。</strong>尽管如此，负责人应该始终致力于<strong class="lk jd">了解</strong>模特是如何<strong class="lk jd">思考</strong>的。没有它，模型的预测一文不值。</p><h1 id="edfa" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">我的模型在做什么</h1><p id="ba5e" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">在<a class="ae lh" rel="noopener" target="_blank" href="/predicting-the-stock-market-with-machine-learning-drivers-295d85d406e7?source=friends_link&amp;sk=ceb5326ca92e917eceecb02beea7efbd">的前一篇文章</a>中，我已经将原始模型中使用的功能从 100 个减少到 9 个，而没有牺牲模型的性能。其余的特征是:</p><ul class=""><li id="3258" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">资本回报率</li><li id="5fda" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">稀释后每股收益</li><li id="8bf7" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">有形资产收益率</li><li id="f2c9" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">收益比股息</li><li id="48f0" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">每股收益增长</li><li id="747a" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">现金</li><li id="7b5e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">营业利润</li><li id="9fcb" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">自由现金流对收益</li><li id="6b0e" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">非营业费用</li></ul><p id="f85a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我使用了<strong class="lk jd">随机森林</strong>特征重要性来决定哪些特征应该保留，哪些特征应该丢弃。虽然<strong class="lk jd">特征重要性</strong>帮助我理解了每个变量在预测分数时的<strong class="lk jd">权重</strong>，但它没有告诉我每个特征究竟如何影响分数。运营利润应该是<strong class="lk jd">高还是</strong>低？我们期待高股息还是低股息？<strong class="lk jd">应该有多少</strong>现金？</p><h1 id="d57d" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">寻找方向</h1><p id="f3dd" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">在基于树的算法中，将<strong class="lk jd">方向</strong>贡献给特征重要性的一种方法利用了<strong class="lk jd"> SHAP 值</strong>。如果你不熟悉这项技术，请看这里的<a class="ae lh" rel="noopener" target="_blank" href="/explain-your-model-with-the-shap-values-bc36aac4de3d">。</a></p><p id="f1be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我的模型的 SHAP 值如下所示。请注意，我已经从上述功能中删除了非运营费用，因为它没有为模型性能增加实际价值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi np"><img src="../Images/b0d4b05cf6134e21bd136bd3cb808a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFOR33O2K3FPQyCFakkE2Q.png"/></div></div></figure><p id="b549" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该图上的 X 轴测量每个特征对预测分数的<strong class="lk jd">影响</strong>。Y 轴显示了用于生成预测分数的所有<strong class="lk jd">特征</strong>。颜色条显示该特征的<strong class="lk jd">值</strong>是高还是低<strong class="lk jd">。例如，高股息收益鼓励模型作出积极的预测(红色，积极的 SHAP 值)。然而，有形资产的高回报鼓励模型做出负面预测(红色，负 SHAP)。</strong></p><p id="bd75" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个图揭示了对于一个聪明的投资者来说可能不直观的关系。它说，第二年<strong class="lk jd">收入</strong>翻一番的公司应该有<strong class="lk jd">低</strong>资本回报率、<strong class="lk jd">低</strong>有形资产回报率和<strong class="lk jd">低</strong>营业利润率——所有这些都是糟糕经营业绩的指标。</p><h1 id="1e3c" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">更进一步</h1><p id="0918" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">SHAP 值分析允许我在<strong class="lk jd">个体</strong> <strong class="lk jd">样本水平</strong>上查看每个特征如何影响预测。让我们来看看我的模型做出的<strong class="lk jd">前 2 位</strong>正确预测。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nq"><img src="../Images/e1fc5ef2121929f524f4a70400100dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bkj7Hearj17yu63hF2m8nw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">前 2 个积极预测</p></figure><p id="fcd7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该模型预测 2013 年星巴克(SBUX)的收入将翻一番。我们来详细看一下。所有 8 个预测值都是红色的，<strong class="lk jd">对预测值做出了积极的贡献</strong>，将预测值一直推高到 0.96。</p><p id="7c67" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如<strong class="lk jd">“寻找方向”</strong>部分所预期的那样，我们的<strong class="lk jd">资本回报率</strong> (0.001)可疑地低，而<strong class="lk jd">自由现金流对收益</strong> (520)和<strong class="lk jd">股息对收益</strong>比率(76)可疑地高。</p><p id="d17c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这些比率不在正常范围内，需要进一步调查。该公司有足够的现金支付通常的股息，但收入却不多。让我们通过 Vhinny 的历史比率和数据来看看这与全球情况是如何吻合的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nr"><img src="../Images/60051cbb23343c24b8995f57caf59ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHYWeekgJwfzJh8G8LPsWA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://www.vhinny.com/display/SBUX" rel="noopener ugc nofollow" target="_blank">https://www.vhinny.com/display/SBUX</a></p></figure><p id="df70" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">事实上，2013 年报告的净收入为 830 万美元，与 2012 年的 14 亿美元和 2014 年的 21 亿美元相比大幅下降。更进一步，你会发现星巴克那年记下了 28 亿美元的诉讼费用。虽然 28 亿美元是一个沉重的打击，但星巴克的盈利潜力并没有受到影响。高的自由现金流对收益比率表明企业仍然赚钱，并继续正常运营。果然，第二年净收入恢复正常，证明我的<strong class="lk jd">模型的预测</strong>是正确的。</p><h1 id="9bb8" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">是什么导致了负面预测</h1><p id="0667" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">了解了模型如何做出自信的<strong class="lk jd">正面预测</strong>，让我们看看它如何做出自信的<strong class="lk jd">负面预测</strong>。以下是<strong class="lk jd">前 2 位</strong>负面预测的 SHAP 值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/1591363180b0f44da134041b97b0a0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMV74dA3GIBGirWgo6s1HQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">前两大负面预测</p></figure><p id="c046" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于这两个示例，所有 8 个预测值都在<strong class="lk jd">蓝色</strong>中，对预测得分产生负面影响。事实上，这两个例子的<strong class="lk jd">预测分数</strong>是<strong class="lk jd">0.00</strong>——低得不能再低了。</p><p id="a735" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看看家得宝(Home Depot)，我们可以看到良好的有形资产回报率(T44)和资本回报率(T46)，自由现金流与收益之比(1.41)在 1.41 左右，这属于正常范围。特洛伊的海伦(乐和)也有类似的情况。</p><p id="ba32" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这三项指标将 HD 和乐和定义为产生高回报的盈利公司。投资者通常喜欢这种类型的公司，因为它们的业务表现强劲。为什么我的模型认为一个好的企业不会在第二年收入翻倍？</p><p id="9d9e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然优秀的公司年收入翻倍并非不可能，但数据表明，一般来说，具有强大业务特征的公司会逐渐自信地成长。实际上，T2 需要两倍的人在世界各地为家得宝建造房屋，T4 需要两倍的收入。800 亿美元的年销售额，在正常情况下不太可能发生。为了让模型预测收入大幅增长的可能性，需要在数据的<strong class="lk jd">异常区</strong>中有一些东西，这就是我们在自信的正面例子中看到的。</p><h1 id="11aa" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">结论</h1><p id="0b93" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">在这篇文章中，我描述了我建立的预测<strong class="lk jd">明年收入的模型</strong>如何做出决策。研究结果表明，在正常经营条件下，好的企业不太可能在第二年实现收入翻番。与此同时，由于“一次性”事件而失去收入的企业可能会重新站立起来，继续正常运营。该模型能够通过分析公司在给定年度的收入情况下赚了多少现金来识别这些公司。</p><p id="01b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果读者和我一样，希望在数据中找到信号并认同股市，我鼓励读者把我的结果当作想法，进行自己的研究。如果读者对这项特别的研究感兴趣，那么推进我的发现的一个好地方就是看看公司规模如何影响企业在遭受打击后恢复正常的概率。</p><p id="bdd3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本文<strong class="lk jd">总结了</strong>这一系列利用基础财务数据预测<strong class="lk jd">下一年收益的</strong>。我希望读者发现我在这里分享的见解是有价值的，并在他们自己的选股过程中加以利用。</p><p id="5742" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我将继续研究 2020 年的股市崩盘。下期见！</p><h1 id="8912" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">我们连线吧！</h1><p id="46e5" class="pw-post-body-paragraph li lj it lk b ll nk kd ln lo nl kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">我很高兴和与我志同道合的人联系，这是对财务独立的追求。如果你也在寻求经济独立，或者你想合作，交流想法，请随时联系我们！以下是我管理的一些资源:</p><ul class=""><li id="ba46" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated"><a class="ae lh" href="http://www.vhinny.com/" rel="noopener ugc nofollow" target="_blank">www.vhinny.com</a>—投资研究平台，为您自己的分析提供金融数据</li><li id="d96a" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated"><a class="ae lh" href="https://www.linkedin.com/company/vhinny" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/company/vhinny</a>——加入我们 LinkedIn 上的社区，在那里我和其他贡献者分享与投资相关的内容</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="453b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">干杯！</p></div></div>    
</body>
</html>