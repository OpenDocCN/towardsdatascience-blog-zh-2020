<html>
<head>
<title>Python Text Analysis With the Schrutepy Package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Schrutepy 包进行 Python 文本分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-text-analysis-with-the-schrutepy-package-234bc70f3916?source=collection_archive---------13-----------------------#2020-01-18">https://towardsdatascience.com/python-text-analysis-with-the-schrutepy-package-234bc70f3916?source=collection_archive---------13-----------------------#2020-01-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a414" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这个新的 python 包让文本分析变得有趣</h2></div><p id="884e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">By: <strong class="kk iu"> <em class="le">布拉德·林德布拉德</em></strong><br/><a class="ae lf" href="https://www.linkedin.com/in/bradlindblad/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae lf" href="https://github.com/bradlindblad/" rel="noopener ugc nofollow" target="_blank">Github</a>|<a class="ae lf" href="https://technistema.com/" rel="noopener ugc nofollow" target="_blank">博客</a> | <a class="ae lf" href="https://twitter.com/brad_lindblad" rel="noopener ugc nofollow" target="_blank">推特</a></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/da9c9fdc15b4bd9eb9d1be750392ea09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7p-8biq0D2CLXJiJ.png"/></div></div></figure><p id="fd49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">随着<a class="ae lf" href="https://bradlindblad.github.io/schrute/index.html" rel="noopener ugc nofollow" target="_blank"> {schrute} R 包</a>的成功，许多请求都是针对移植到 Python 的同一个数据集。<strong class="kk iu"> schrute </strong>和<strong class="kk iu"> schrutepy </strong>包只有一个目的:从<a class="ae lf" href="https://www.imdb.com/title/tt0386676/" rel="noopener ugc nofollow" target="_blank">Office</a>加载整个脚本，这样你就可以用这个有趣的数据集执行自然语言处理、文本分析或其他什么。</p><h1 id="d3b7" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">快速启动</h1><p id="084f" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">使用 pip 安装软件包:</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="b1c9" class="mu lt it mq b gy mv mw l mx my">pip install schrutepy</span></pre><p id="e54a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后将数据集导入数据框架:</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="bcef" class="mu lt it mq b gy mv mw l mx my">from schrutepy import schrutepy </span><span id="b7e3" class="mu lt it mq b gy mz mw l mx my">df = schrutepy.load_schrute()</span></pre><p id="3f87" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样。现在你准备好了。</p><h1 id="c896" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">长示例</h1><p id="72dc" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">现在，我们将快速学习一些常见的基本文本分析功能。</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="208a" class="mu lt it mq b gy mv mw l mx my"><strong class="mq iu">from</strong> schrutepy <strong class="mq iu">import</strong> schrutepy<br/><strong class="mq iu">from</strong> wordcloud <strong class="mq iu">import</strong> WordCloud, STOPWORDS, ImageColorGenerator<br/><strong class="mq iu">import</strong> matplotlib.pyplot <strong class="mq iu">as</strong> plt<br/><strong class="mq iu">from</strong> matplotlib.pyplot <strong class="mq iu">import</strong> figure<br/><strong class="mq iu">import</strong> nltk<br/><strong class="mq iu">from</strong> nltk.corpus <strong class="mq iu">import</strong> stopwords<br/><strong class="mq iu">from</strong> PIL <strong class="mq iu">import</strong> Image<br/><strong class="mq iu">import</strong> numpy <strong class="mq iu">as</strong> np<br/><strong class="mq iu">import</strong> collections<br/><strong class="mq iu">import</strong> pandas <strong class="mq iu">as</strong> pd</span></pre><p id="a979" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用 load_schrute 函数加载整个脚本</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="9276" class="mu lt it mq b gy mv mw l mx my">df = schrutepy.load_schrute()</span></pre><p id="9786" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有些唱片没有对白</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="ece7" class="mu lt it mq b gy mv mw l mx my">df = df.dropna()</span></pre><p id="8489" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为整个系列中的所有文本创建一个单词云</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="78da" class="mu lt it mq b gy mv mw l mx my">text = " ".join(review for review in df.text)</span><span id="467c" class="mu lt it mq b gy mz mw l mx my">print ("There are {} words in the combination of all review.".format(len(text)))</span><span id="f3c4" class="mu lt it mq b gy mz mw l mx my">#There are 3001517 words in the combination of all review.</span><span id="0e2d" class="mu lt it mq b gy mz mw l mx my"># Create stopword list:<br/>nltk.download(<strong class="mq iu">'stopwords'</strong>)<br/>stopWords = <strong class="mq iu">set</strong>(stopwords.words(<strong class="mq iu">'english'</strong>))<br/><br/># Generate a word cloud image<br/>wordcloud = WordCloud(stopwords=stopWords, background_color=<strong class="mq iu">"white"</strong>).generate(text)<br/><br/># Display the generated image:<br/># the matplotlib way:<br/>plt.figure(figsize=[<strong class="mq iu">30</strong>,<strong class="mq iu">15</strong>])<br/>plt.imshow(wordcloud, interpolation=<strong class="mq iu">'bilinear'</strong>)<br/>plt.axis(<strong class="mq iu">"off"</strong>)<br/>plt.show()</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi na"><img src="../Images/5cd4515f4a8b08dacc2598a76270b341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JI2cBaNMl8QAAh80.png"/></div></div></figure><p id="f66e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们对一些角色做同样的事情。函数会有所帮助。</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="c984" class="mu lt it mq b gy mv mw l mx my"><strong class="mq iu">def</strong> plotDunder(character, df):<br/>    mydf = df[df.character == character]<br/>    text1 = <strong class="mq iu">" "</strong>.join(review <strong class="mq iu">for</strong> review in mydf.text)<br/>    # Generate a word cloud image<br/>    wordcloud = WordCloud(stopwords=stopWords, background_color=<strong class="mq iu">"white"</strong>).generate(text1)<br/><br/>    # Display the generated image:<br/>    # the matplotlib way:<br/>    plt.figure(figsize=[<strong class="mq iu">15</strong>,<strong class="mq iu">7</strong>])<br/>    plt.imshow(wordcloud, interpolation=<strong class="mq iu">'bilinear'</strong>)<br/>    plt.title(character)<br/>    plt.axis(<strong class="mq iu">"off"</strong>)<br/>    plt.show()</span><span id="1bf4" class="mu lt it mq b gy mz mw l mx my">fav = [<strong class="mq iu">"Michael"</strong>, <strong class="mq iu">"David Wallace"</strong>, <strong class="mq iu">"Dwight"</strong>, <strong class="mq iu">"Jim"</strong>, <strong class="mq iu">"Pam"</strong>, <strong class="mq iu">"Oscar"</strong>, <strong class="mq iu">"Phyllis"</strong>, <strong class="mq iu">"Creed"</strong>, <strong class="mq iu">"Ryan"</strong>,]</span><span id="cca8" class="mu lt it mq b gy mz mw l mx my">for i in fav: <br/>  plotDunder(i, df)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/f39b254a60dae28f37db92524011873f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NRnEUFbm_O-L5b8m.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/2edc6c6c8c00a1f744927663af91f99e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4X3ki1AD8KClsHys.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/13c781f03c32058e6f01c03f87e285a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5eyKf1TUmM0XIWIf.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/f21ac3436c1ecbd73ef6c4c5c5de3e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SWMkwyTKuNkAT11U.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/7f9b7a7a43b8b3fd3d7c3dd9d9cbe316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Pbz43dnFUMyRSROQ.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/be3245dcb941ec50395515b62767c8dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YNlPKmQoL1waeNp_.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/c507458dadc8e131ab32f4453ef378e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rJz9Lg2zwcFL8nXL.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/8d4118a9b7bf99d32b9048b42404b0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ez-SFmFtxRh-GcoC.png"/></div></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nb"><img src="../Images/aa3c3d048479df42794683be3161823d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WbYTworeZQ9B2vha.png"/></div></div></figure><p id="293d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们做一个德怀特大头的形状</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="9bde" class="mu lt it mq b gy mv mw l mx my">dwight_mask = np.array(Image.open("schrutepy.png"))</span><span id="be72" class="mu lt it mq b gy mz mw l mx my"># Create a word cloud image<br/>wc = WordCloud(background_color=<strong class="mq iu">"white"</strong>, max_words=<strong class="mq iu">1000</strong>, mask=dwight_mask,<br/>               stopwords=stopWords, contour_width=<strong class="mq iu">1</strong>, contour_color=<strong class="mq iu">'grey'</strong>)<br/><br/># Generate a wordcloud<br/>wc.generate(text)<br/><br/><br/># show<br/>plt.figure(figsize=[<strong class="mq iu">30</strong>,<strong class="mq iu">15</strong>])<br/>plt.imshow(wc, interpolation=<strong class="mq iu">'bilinear'</strong>)<br/>plt.axis(<strong class="mq iu">"off"</strong>)<br/>plt.show()<br/><br/><br/>wc.to_file(<strong class="mq iu">"final_schrute.png"</strong>)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi nc"><img src="../Images/4aad1ab807e20eb6a531366f9af9e679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7MpFShgW1B3zp7L0.png"/></div></div></figure><p id="3221" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们找出并画出我最喜欢的角色最常用的单词</p><pre class="lh li lj lk gt mp mq mr ms aw mt bi"><span id="912a" class="mu lt it mq b gy mv mw l mx my"><strong class="mq iu">def</strong> commonWord(character, df):<br/>    mydf = df[df.character == character]<br/>    text = <strong class="mq iu">" "</strong>.join(review <strong class="mq iu">for</strong> review in mydf.text)<br/>    wordcount = {}<br/>    # To eliminate duplicates, remember to split by punctuation, and use case demiliters.<br/>    <strong class="mq iu">for</strong> word in text.lower().split():<br/>        word = word.replace(<strong class="mq iu">"."</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">","</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">":"</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">"\""</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">"!"</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">"â€œ"</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">"â€˜"</strong>,<strong class="mq iu">""</strong>)<br/>        word = word.replace(<strong class="mq iu">"*"</strong>,<strong class="mq iu">""</strong>)<br/>        <strong class="mq iu">if</strong> word not in stopWords:<br/>            <strong class="mq iu">if</strong> word not in wordcount:<br/>                wordcount[word] = <strong class="mq iu">1</strong><br/>            <strong class="mq iu">else</strong>:<br/>                wordcount[word] += <strong class="mq iu">1</strong><br/><br/>    # Print most common word<br/>    n_print = <strong class="mq iu">int</strong>(<strong class="mq iu">10</strong>)<br/>#     print("\nOK. The {} most common words are as follows\n".format(n_print))<br/>    word_counter = collections.Counter(wordcount)<br/>    <strong class="mq iu">for</strong> word, count in word_counter.most_common(n_print):<br/>        <strong class="mq iu">pass</strong><br/>    # Close the file<br/>    # Draw a bar chart<br/>    lst = word_counter.most_common(n_print)<br/>    df = pd.DataFrame(lst, columns = [<strong class="mq iu">'Word'</strong>, <strong class="mq iu">'Count'</strong>])<br/>    df.plot.bar(x=<strong class="mq iu">'Word'</strong>,y=<strong class="mq iu">'Count'</strong>, title=character)</span><span id="0be2" class="mu lt it mq b gy mz mw l mx my">for i in fav: <br/>  commonWord(i, df)</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/77f3d951e602197903bad1459a931466.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/0*WzaonBEqhMOc_sjP.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e4c4438b951be98638b1dea70d7667f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*R9LYMygCo1wpM0Qa.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/4da8f0ba9796dbb8dc9c2b87258b8b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*qNBP-fHL05tJTMhH.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/4d475b57db6fa441c082c2908cf66417.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*GU2CBkIa3NPKAyo_.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/1946d2c706d761b8b705f725e59fc81f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*9fW1I8F-YzJiiPWw.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/15699d5bf0eed5c7233c53d29c2f0118.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*pC-sn64eSirUMsNE.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c48e0040b893db9772947e7d87ee9a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*qZChWeDdrcHvbt74.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/73c4bf080073e2cc762ead3196e1e81e.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*okUP72AZNk_Ix8R0.png"/></div></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/9711ad34e4f90a844d2de12f7de8be75.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/0*51XGZiPyLfgn0Nmg.png"/></div></figure><p id="1245" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这个包，就在<a class="ae lf" href="https://github.com/bradlindblad/schrutepy" rel="noopener ugc nofollow" target="_blank"> Github </a>上开始吧，这样更多的人可以从中得到乐趣。</p><p id="0cef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">想要更多这样的内容？</em> </strong> <a class="ae lf" href="https://technistema.com/contact/" rel="noopener ugc nofollow" target="_blank">订阅此处</a></p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="c8f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">原载于 2020 年 1 月 18 日 https://technistema.com</em><a class="ae lf" href="https://technistema.com/posts/python-text-analysis-with-the-schrutepy-package/" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a><em class="le">。</em></p></div></div>    
</body>
</html>