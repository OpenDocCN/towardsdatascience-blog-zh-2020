<html>
<head>
<title>Harry Potter and the Deep Learning Experiment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">哈利·波特与深度学习实验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/harry-potter-and-the-deep-learning-experiment-7b312d4b03c0?source=collection_archive---------44-----------------------#2020-05-07">https://towardsdatascience.com/harry-potter-and-the-deep-learning-experiment-7b312d4b03c0?source=collection_archive---------44-----------------------#2020-05-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/0d1eeab879d1f793bd85c8621cf1fc3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IgniSoXgNXbUE4hG84osMg.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">对于每个字符，模型查找嵌入，以嵌入作为输入运行GRU一个时间步长，并应用密集层来生成预测下一个字符的对数似然的逻辑。</p></figure><p id="8466" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">三年前(那时教RNNs生成文本很酷)，我有了用哈利波特的书训练张量流模型的想法。这个项目在我的清单上，它在追逐我。</p><p id="2062" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个周末我终于做到了，还做了一个简单的<a class="ae la" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>应用程序供你玩模型:<a class="ae la" href="https://share.streamlit.io/santiviquez/harry-potter-rnn/app.py" rel="noopener ugc nofollow" target="_blank">https://share . Streamlit . io/santiviquez/Harry-Potter-rnn/app . py</a></p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/bf8a75e0a384f3b03d0a91d64899f86f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*fxTibSTncH5Fup8blqtAoQ.gif"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">简化应用程序。代号:<a class="ae la" href="https://github.com/santiviquez/harry-potter-rnn" rel="noopener ugc nofollow" target="_blank">https://github.com/santiviquez/harry-potter-rnn</a></p></figure><h1 id="35ca" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">一些生成的文本</h1><p id="57b5" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated"><em class="mj">哈利坐在了哈利读书时去看的楼梯旁边。</em></p><p id="5508" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">“很抱歉，你的血腥，男爵先生，斯内普的课就在你的脸颊上，波特，否则我不会比达力更糟糕。达力去过几次图书馆；他吞下了许多刚刚结束的新问题。</p><p id="fa86" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我来吧！不要害怕！别进入我们的第一周。再见。”</p><p id="9c25" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">弗雷德和乔治·韦斯莱第一次试图阻止格兰芬多，这件事一直像弗农姨父一样困扰着他。他很难信守诺言。他默默地递过来。他一定不想告诉哈利？”</p><p id="706f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">哈利听到了小铜币的声音，猫头鹰猛扑过来，把报纸掉在海格的身上，海格扑在报纸上，在他半信半疑伏地魔会回来的时候，设法通过了考试。</p><p id="7b14" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="mj">“什么是巫师决斗？”哈利和罗恩说。</em></p><p id="8776" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你所看到的，大多数句子都没有意义，但它们都是由计算机生成的，这是令人印象深刻的部分。</p><h1 id="88b2" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">这不就是把文字重新编排一下吗？</h1><p id="ed56" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">没有。让我们看一个学习过程的例子来理解为什么。</p><p id="eb19" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这些是模型生成的一些文本。</p><p id="118a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">时期1: </strong>在第一时期(在整个数据集上的完全训练)，我们看到看起来只是随机的字母和字符。</p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="1765" class="mp lh iq ml b gy mq mr l ms mt">sngns yiiy I rad yit se ke sery Ro, "udGct touveid. samtd ccift, the. fpe gincy lindos ys Towe feeng beunat <br/>)X h so-int rines Hufons nsmtheis anmin f oideyhend wrratt hit le therf arerre he fo ke thomecAg voutud unfed fow suk rond thet <br/>macughilg wares thirstof hy youMl hed folh,</span></pre><p id="2fc0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe mu mv mw ml b">akfdjaf</code></p><p id="f725" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi">```</p><p id="fe74" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">sdjkfaksfkla</p><p id="695f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">“kajdsfkjasfka”</p><p id="68db" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe mu mv mw ml b">fkgksjdfkjsfkjsdfsd</code></p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="ca65" class="mp lh iq ml b gy mq mr l ms mt">sngns yiiy I rad yit se ke sery Ro, "udGct touveid. samtd ccift, the. fpe gincy lindos ys Towe feeng beunat <br/>)X h so-int rines Hufons nsmtheis anmin f oideyhend wrratt hit le therf arerre he fo ke thomecAg voutud unfed fow suk rond thet <br/>macughilg wares thirstof hy youMl hed folh,</span></pre><p id="8a8c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">` ` akjshfkjlahfkjhd</p><p id="63e7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">akjshfdjkadsf `'</p><p id="b1f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">纪元二:</strong>和以前差不多。</p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="a0d9" class="mp lh iq ml b gy mq mr l ms mt">"Mald sined ro fastrong orryfe frourd hot'dilg trimt wa thin ware ne bamly oue ntho feringseps thag catkirgen tu hime baicf sait yoveece way yonerbyedene nomt thaney an'thing ve fuba carpouflit  Serofy," saided one whizciof Harr wiole, I it the pie pevainigrofle pors</span></pre><p id="3bcd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这里，我们看到了一些进步。它正在学习如何创建段落，它还学习了如何正确拼写罗恩，而且它几乎做到了赫敏。另一个有趣的事实是，它知道每个段落都需要以句号结尾。</p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="f692" class="mp lh iq ml b gy mq mr l ms mt">daven lack a grivert He mad eets plaiced. The inares, ruther Inard in brigt tuffing a to kinares<strong class="ml ir">.</strong>" <br/><br/>"Haw do get brousl purny to seize whis with hem looking by. We's if ge<strong class="ml ir">. </strong><br/><br/>"Haryy, you, wande -- recatbladred got <strong class="ml ir">Herwione</strong>, and Harry ando, him some wich nover Durn <strong class="ml ir">Ron</strong>. Ho said abeary own exard to ke to nextsen, mowned megrmings<strong class="ml ir">.</strong></span></pre><p id="8d4e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Epoch 10: </strong>它<strong class="ke ir">T5】学会了拼斯内普、哈利、达力和赫敏！</strong></p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="ae6d" class="mp lh iq ml b gy mq mr l ms mt">Harry fast roy winged and same forward that <strong class="ml ir">Snape</strong> heard fat looked at all. Small not about is but he didn't makber, wh they furged him. <br/><br/>"It's going to lim, I'll never thought that Curse for dong tone ach ins other, could poney. <strong class="ml ir">Harry</strong> flocked <strong class="ml ir">Dudley</strong> this if he soll that <strong class="ml ir">Hermione</strong> had be before wouldn't meville. 'veryto his rrom -- and he stop its head. I've reed Lonnem. Snape was gonew like Harry's gettid himmered in elor without hair.</span></pre><p id="b66b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注意，在第二段中，它学会了如何正确使用引号(正字法)。</p><pre class="lc ld le lf gt mk ml mm mn aw mo bi"><span id="ad41" class="mp lh iq ml b gy mq mr l ms mt">Neville had been hand stretching to watch as Harry sped straight at Snape -- she didn't even noticed in tim again. After burning all the letters, he was made difficult by Fathers s had been waiting noise and the sheets a hote there, with right dewild!"</span><span id="b035" class="mp lh iq ml b gy mx mr l ms mt"><strong class="ml ir">"</strong>But what's only shop.<strong class="ml ir">"</strong></span><span id="1202" class="mp lh iq ml b gy mx mr l ms mt">Harry nodded, but stopped quickly, because it made different time was protected wherever he went.</span></pre><p id="f187" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以它基本上试图复制J.K .罗琳的写作风格和基调。</p><h1 id="f013" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">这是如何工作的</h1><p id="e4f1" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">理解这是如何工作的最好资源之一是安德烈·卡帕西2015年的博客文章<a class="ae la" href="https://karpathy.github.io/2015/05/21/rnn-effectiveness/" rel="noopener ugc nofollow" target="_blank">。我将冒昧地使用他的一个例子。</a></p><p id="c565" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">假设我们的整个词汇由四个字母组成:<strong class="ke ir"> h </strong>、<strong class="ke ir"> e </strong>、<strong class="ke ir"> l </strong>、<strong class="ke ir"> o </strong>。<strong class="ke ir"> </strong>我们把文本分成长度=4的块，我们想在序列“hello”上训练我们的RNN。</p><p id="d7f7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这种情况下，我们的输入序列是“hell ”,目标序列是“ello”。因此，给定最初只有一个单独的“h”的上下文，模型将猜测下一个单词可能是“e ”,然后给定前两个字母是“h”和“e”的上下文，模型将猜测第三个字母是“l ”,依此类推。</p><p id="611e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">前面所有字母之间的关系有助于预测下一个字母。RNN记住每个序列的所有这些关系。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/c39647b2af5f38842497233ee6c2501f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMalbwl6uj3nlqxixZYFvA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae la" href="https://karpathy.github.io/2015/05/21/rnn-effectiveness/" rel="noopener ugc nofollow" target="_blank">https://karpathy.github.io/2015/05/21/rnn-effectiveness/</a></p></figure><p id="7e90" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要了解更多关于RNNs的信息，我真心推荐Karpathy的博客文章，如果你想建立自己的教程，这个<a class="ae la" href="https://www.tensorflow.org/tutorials/text/text_generation" rel="noopener ugc nofollow" target="_blank"> TensorFlow 2教程</a>是一个很好的资源。</p><p id="6996" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">【1】:<a class="ae la" href="https://www.tensorflow.org/tutorials/text/text_generation" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/tutorials/text/text_generation</a></p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="b088" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我想告诉你，我推出了一个数据科学问答游戏，通常会在面试中出现问题和答案。想了解更多关于这个<a class="ae la" href="https://twitter.com/santiviquez" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir">在twitter上关注我</strong> </a>。</p></div></div>    
</body>
</html>