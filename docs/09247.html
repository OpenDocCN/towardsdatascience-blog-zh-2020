<html>
<head>
<title>Ensemble Methods: Comparing Scikit Learn’s Voting Classifier to The Stacking Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集成方法:比较 Scikit Learn 的投票分类器和堆叠分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ensemble-methods-comparing-scikit-learns-voting-classifier-to-the-stacking-classifier-f5ab1ed1a29d?source=collection_archive---------29-----------------------#2020-07-02">https://towardsdatascience.com/ensemble-methods-comparing-scikit-learns-voting-classifier-to-the-stacking-classifier-f5ab1ed1a29d?source=collection_archive---------29-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ded" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">使用 Titanic 数据集比较 scikit 学习投票分类器和堆叠分类器。</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/0181ad352bcb0445097fc3a65d91137c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kCX8L-1usUlPqax6W4kdUA.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@perrygrone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">佩里·格罗内</a>在<a class="ae kz" href="https://unsplash.com/s/photos/working-together?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3b6b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">他们说，两个脑袋比一个要好。有时在许多机器学习项目中，我们希望使用集成方法来利用协同的力量。投票和堆叠分类器为我们带来了结合 2 个或更多机器学习模型以获得更高预测性能的好处。</p><p id="4a70" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">投票分类器</strong></p><p id="d97f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">投票分类器的工作方式类似于选举系统，其中基于一组机器学习模型成员的投票系统对新数据点进行预测。根据 scikit_learn 的文档，可以在硬投票和软投票类型之间进行选择。</p><p id="4ea8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">硬投票类型应用于多数规则投票的预测类标签。这使用了“多数决定投票”的思想，即做出有利于拥有半数以上投票的人的决定。</p><p id="afca" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">软</strong>表决基于组成集合的各个估计器的预测概率之和的 argmax 来预测类别标签。在良好校准/拟合的分类器的集成的情况下，经常推荐软投票。</p><p id="8d96" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">例如:如果<em class="lw">模型 1 </em>预测<strong class="lc iu"> <em class="lw"> A </em> </strong>，而<em class="lw">模型 2 </em>预测<strong class="lc iu"> <em class="lw"> B </em> </strong>，而<em class="lw">模型 3 </em>预测<strong class="lc iu"> <em class="lw"> A </em> </strong>。<em class="lw">投票分类器</em>(with<strong class="lc iu"><em class="lw">voting =‘hard’</em></strong>)返回<strong class="lc iu"> <em class="lw"> A </em> </strong>。在平局的情况下，投票分类器将基于升序选择类别。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/fb5d918fca829b7be1c2a7d8fa9353e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJiyfD8zB7XXxB1oTFX5wg.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kz" href="https://unsplash.com/s/photos/stacking-stones?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5b3e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">堆垛分级机</strong></p><p id="ee0f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">堆叠包括在同一数据集上组合来自多个机器学习模型的预测。我们首先在我们的数据集上指定/建立一些称为基础估计器的机器学习模型，来自这些基础学习器的结果然后作为我们的堆叠分类器的输入。堆叠分类器能够了解我们的基本估计值何时可信或不可信。叠加允许我们通过将每个估计量的输出作为最终估计量的输入来利用每个估计量的强度。</p><p id="1d07" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在使用堆叠分类器时，可以选择在基础学习者级别或在最终估计器上应用交叉验证。使用 scikit learn stacking 分类器，基础学习器适用于全 X，而最终估计器使用基础学习器的交叉验证预测来训练。</p><p id="6985" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">多层堆叠也是可能的，其中在构建最终估计器之前构建基础学习器的层。</p><p id="2243" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">值得注意的是，在考虑集合方法来改进我们的预测之前，建议:</p><ol class=""><li id="6dcb" class="ly lz it lc b ld le lg lh lj ma ln mb lr mc lv md me mf mg bi translated">在可能的情况下，获取更多的数据。我们输入到模型中的数据越多，模型需要学习的学习示例就越多。</li><li id="e7aa" class="ly lz it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">特征工程。</li><li id="8fd7" class="ly lz it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">我们模型的超参数调整。</li></ol><p id="5313" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">方式和方法</strong></p><p id="897f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这个例子中，我们考虑了“泰坦尼克号:机器从灾难中学习”。我们分割训练数据集，以便能够对我们的模型进行自己的评估。数据集也可以在这里找到:【https://www.kaggle.com/c/titanic/data】T2。然后，我们构建一个逻辑回归、最近邻和随机森林算法。</p><p id="2dcc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们使用上述 3 种算法作为 scikit learn 的投票和堆叠分类器的估计器，并比较它们预测的 f1 分数。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="4651" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="lw">注意:堆叠分类器仅在 0.22 版本的 Scikit-Learn 中可用，而投票分类器从 0.17 版本开始可用。</em></p><p id="783b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">观察结果</strong></p><p id="6a4d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu"> <em class="lw">本例中投票和堆叠分类器的 f1_score 相同。</em>T11】</strong></p><ol class=""><li id="b356" class="ly lz it lc b ld le lg lh lj ma ln mb lr mc lv md me mf mg bi translated">在投票分类器和堆叠分类器中，重要的是要确保基本估计量能够很好地给出准确的预测。正如人们所说的，<em class="lw">‘垃圾进，垃圾出’</em>，如果估计器放入垃圾，那么任何一种集成方法都会产生垃圾。</li><li id="d80c" class="ly lz it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">重要的是要注意，堆叠分类器在基础模型(或估计器)上建立模型，从而增加对数据集的拟合。这也增加了堆积分类器过度装配的趋势，尤其是在多层堆积的情况下。</li><li id="cb42" class="ly lz it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">投票分类器的性能很大程度上取决于基本模型的结果。因此，为了更好地预测，建议使用合适的估计量作为软投票类型的基础模型。</li><li id="8f4d" class="ly lz it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">有时候，集合方法并不是真的需要。😉</li></ol><p id="890f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">结论</strong></p><p id="0ab5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">很难确定投票或堆叠分类器哪个更好。明智的做法是了解它们中每一个的用途/工作原理。这种理解将有助于决定在什么时候应用它们是最好的。</p><p id="1473" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我希望这篇文章对你有帮助。这里是我的<a class="ae kz" href="https://twitter.com/samsonafo" rel="noopener ugc nofollow" target="_blank"> Twitter </a>句柄和<a class="ae kz" href="https://www.linkedin.com/in/samson-afolabi/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>页面。链接到 github repo <a class="ae kz" href="https://github.com/samsonafo/ensemble_methods" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="e7a0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你喜欢这篇文章，你可以考虑给我买☕️.咖啡</p><p id="4b57" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Vielen Dank😊</p></div></div>    
</body>
</html>