# 我的数据科学项目端到端流程

> 原文：<https://towardsdatascience.com/my-end-to-end-process-for-data-science-projects-a12d62fbb40a?source=collection_archive---------44----------------------->

## 我从数据到产品的途径

![](img/25b5aeeb75c124da661a520ccfb78ebe.png)

照片由 [Nghia Le](https://unsplash.com/@lephunghia?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

我为什么要写这个故事？原因很简单，不是每个数据科学项目都是成功的。当然，你可以谷歌一下这个话题，你会找到成千上万的理由。对我来说，没有成功的项目是改进我的过程和技能的最大机会。在这个故事中，我将通过提供我在一个数据科学项目中的当前(并且仍在改进)流程来简要总结我的学习。我不怀疑这个过程不适用于每个人，因为“数据科学项目”没有单一的定义。我的目的是通过总结一个项目的不同步骤来分享我的经验。这并不能保证成功，但至少，作为一名数据科学家，这个过程将尝试解决您可以预防的所有陷阱。我的角色是创建消费数据和提供洞察力的管道(参见我在[之前的故事](/functional-programing-in-data-science-projects-c909c11138bb)中对管道的定义)。这是我正在使用的过程。

# 确定解决方案的范围

第一步是确定解决方案的范围。有时很难在期望和定价之间找到平衡。我的建议是，通过审视真正的需求来推动任何决策。这将允许把“最好有”放在一边，优先考虑“强制功能”。

## 从“为什么”开始(裁判:西蒙·西内克)

要草拟项目的范围，第一步是与客户一起工作，并理解难点和他的动机。在这个故事中，我将使用术语*客户*来表示为项目付款的人。实际上，客户可能是你公司的董事/副总裁/首席技术官。客户是决定投资这个项目的人。**必须了解为什么**这个人对这个项目感兴趣。最大化生产？过程的缩放？避免他工厂的失败？任何事情…痛点是什么？这对于下一步非常重要。一个好办法是询问客户目前如何处理他的痛点。如果已经有衡量当前流程效率的指标。

## 谁会用？

很多时候，我有机会在甚至不知道谁将使用该解决方案的情况下起草一个范围。这是不对的！如果使用了该解决方案，项目就是成功的。我曾经在一些项目中，用户甚至没有被清楚地识别出来。这是创造永远不会被使用的东西的最好方法。一家公司的首席执行官说:“人工智能既时髦又酷，我们应该用它做点什么”。快跑！

我们举个例子。一位主管/副总裁希望使用人工智能来优化工厂的库存管理。太好了！然后我开始谈论解决方案，但未来的用户甚至不在房间里。我们开始着手这个项目，并决定该算法将在每天早上提供一封电子邮件，其中包含需求预测，以帮助库存经理做出最佳决策。我努力工作，我成功地完成了这项任务。我们甚至开发基础设施来支持算法。一切都搞定了，CEO 也开心了！你猜怎么着？这个预测甚至不是经理最关心的。他很难实时弄清楚工厂里哪里有什么产品。太糟糕了，一个简单的交互式仪表板就可以完成这项工作。没有这些信息，预测是没有用的。这个项目失败了。

在另一种情况下，经理需要每周而不是每天的预测，或者预测需要实时可用而不是每天…所有这些情况都会发生。我的最佳建议是**在对话中尽可能早地引入未来用户，因为他是定义需求的最佳人选**。

## 什么？

此时，我想要的是一个清晰的成功标准。

客户:“我需要算法来预测我的装配线何时会出现故障”。

我:“好的”，*我看着接线员，*“你需要提前多长时间预测？”(在这里，我试图定义问题的粒度。)

接线员:“我需要提前 2 天的预测，早上 7 点前需要这些信息”。

我:“很好，但你必须明白，算法可能会产生错误警报，也会错过一些故障。你觉得这样舒服吗？目前情况如何？如果不需要一台机器，请维护团队来修理这台机器会造成多大的成本损失？一天之内你能检查多少台机器？”

我需要所有这些答案来创建一个成功的标准。

…

我:“你现在怎么解决这个问题？”。

操作员:“我们有 1000 台机器，每天至少有一台会出故障。我们无法全部检查，因此，我们优先检查长期未检查的那一个”。

最后一个信息非常重要，因为它告诉我酒吧在哪里。如果我模拟当前的策略，我可以评估我的解决方案有多好。

所有这些信息都有助于我用成功标准来定义一个衡量标准。在这种情况下，我宁愿使用命中率这样的指标。前 N 个最有可能的预测故障中的真阳性数。n 是维护团队一天内可以处理的干预次数。我很少向客户传达 F-Measure 或 AUC 之类的指标，因为他不能用这个指标来决定解决方案是否成功。在对话结束时，我们发现命中率为 2 对于要使用的解决方案来说是足够有价值的。此外，由于我收集的信息，我可以对客户目前浪费的资金以及客户通过成功的解决方案可以节省的资金进行定价。然后，当我向客户展示进度时，我可以将我的指标转换成美元。

一个重要的考虑是，我的解决方案将被集成到现有的系统中。这个系统的存在是有原因的，人们正在使用它。人工智能解决方案将改变这个系统。必须预见到这种中断，否则项目的最后阶段(当人们使用解决方案时)可能会导致意想不到的额外成本。这种干扰可能非常重要，以至于客户最终可能会改变主意，拒绝承担发布解决方案的风险(这发生在我身上)。我的建议是在解决方案的初始范围确定期间，在对话中引入这种潜在的中断。

在讨论结束时，我会询问一些数据片段，一些关于我们收集数据的方式的信息，等等。我会进行数据分析(1-2 天)以检查是否有大的危险信号。数据工程师也将参与对话以起草架构。

现在，我有了范围，我可以进入下一步，即制定解决方案。

# 概念证明(POC)阶段

这个阶段的目标是证明项目是可行的，并且能够带来价值。为了在这一阶段优化流程，您必须考虑需要哪些约束。

![](img/4d9edc9c73b2c2af9d8a33d56d1eff11.png)

约束三角形

基本上，在 POC 阶段，我无法同时限制时间、资源和准确性。时间是指我能在这个项目上花费的时间。资源是分配给该项目的人数。准确性是指模型的准确性。理论上，你只能约束其中两个。实际上，资源或多或少总是受到限制的。也许一些公司可以在一个项目上分配“无限”数量的资源。我从来没有遇到过这样的情况。如果你放松准确性，它就相当于“黑客马拉松模式”或“尖峰”。当你想在短时间内研究一个想法时，这是很有用的。最现实的选择是放松时间。一些客户很难在这种模式下工作，因为他们需要遵守最后期限，并且他们可能会觉得 POC 永远不会结束。但是，诀窍是以有效的方式向客户传达进展。出于这个原因，我使用敏捷方法。这种范式是为软件开发而发明的，但我将其应用于数据科学项目的环境中。如果你不熟悉措辞，我邀请你读一些关于敏捷的文章。

## 冲刺 1:

我通常在 2 或 3 周的冲刺阶段工作，这取决于客户。第一次冲刺的目标是建立一个基线。当第一个端到端管道(从数据到指标)传递一个数字时，基线被声明。在最初的冲刺中，我选择最简单的路径。这是唯一重要的事情。尽快得到一个数字。例如，如果一些变量缺少值，最简单的方法是从数据集中删除这些变量。或者，如果我必须选择一个模型，最简单的是线性回归或逻辑回归，因为没有参数化。没有 creasy 预处理，只有简单的步骤。避免任何可能意味着微调或校准的步骤。没有 PCA，没有标准化，什么都没有。基本上，在这个 sprint 中，我设置了 CI/CD、git 存储库，编写了一个解析器，并创建了最简单的管道版本，以一个度量数字结束。我唯一需要注意的是评估策略。如果在 66%训练 33%测试程序和交叉验证程序之间切换，则很难比较两条管道的性能。评估策略需要尽可能接近管道的使用方式。在上面的例子中，我将为训练集使用一个增长窗口，为测试集使用一个滑动窗口。

## 冲刺 2:

第二个冲刺是将基线产品化。在数据工程师和 DevOps 的帮助下，我们建立了支持管道的架构。有些人更喜欢等到管道达到范围中定义的准确性水平。对我来说，我会尽我所能尽早地让其他团队明白，以便尽快产生一个 MVP。对于我的短跑，我使用标准周期。每天召开一次全体会议，检查是否有阻碍者。我们在 sprint 的开始做计划，在最后做演示。我们也不时做回顾。在冲刺的最后，我们检查新版本的管道是否提供了比基线更好的结果。如果是，它对应于下一个 sprint 的新基线。我在 sprints 中跟踪这些信息，并将其包含在演示中。

![](img/aa123d234dfb494b0fa25b723a664051.png)

短跑中的指标跟踪

在演示过程中，我向客户展示了上面的图。他可以决定 1)继续另一个 sprint，2)宣布我们达到了目标，或者 3)放弃项目，因为当前的解决方案与预期相差太远，并且需要花费大量的时间来完成。这种早期停止对每个人都有好处。对于客户来说，他没有在一个可能过于昂贵的项目上浪费金钱，也没有将团队重新分配到另一个成功概率更高的项目上。演示也是验证新假设的机会。

在每次迭代中，我都会增加管道的复杂性。例如，我收集外部数据来扩充数据集，我改进预处理，添加更多功能，使用不同的算法，等等。这里的危险是过度设计管道。例如，我不会试图在第二次迭代时起草一个新的深度学习架构，或者我不会添加疯狂的复杂功能来确定一两个不会严重影响指标的离群值。为了确定对管道影响最大的改变，我经常查看误差最大的实例，试图找到解释，并得出新的清洁策略和/或新功能。我根据工作量对这些改动进行排序，从最简单的开始。

**关于 CI/CD 和笔记本的注意事项:**

度量的测量必须是可重复的。因此，我忽略了任何不是由 CI/CD 管道产生的数据点。如果结果是在 Jupyter 笔记本上获得的，我必须说服自己，它可以在另一台机器上重现。笔记本对于数据分析来说很酷，但是它们需要很强的纪律性来确保结果的可重复性。我知道我做不出这样的事。因此，我只相信 CI/CD 中的数字。我曾经遇到过这样一种情况，我向客户声称我们达到了预期，但最终却无法重现结果。这对每个人来说都是非常令人沮丧和昂贵的…我希望你永远不必生活在这种情况下。

# 产品化

我强烈推荐你看一下“[机器学习系统中隐藏的技术债务](https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf)”这篇文章。机器学习代码是整个解决方案的一小部分。清楚地了解产品化所需的额外步骤非常重要。产品化需要数据工程师和 DevOps 的支持。

但愿 POC 已经完成，我们达到了成功标准。很好！！现在需要把管道产品化。有两种主要的方法:

1.  **放手**。概念验证的结果转化为规格。一组软件开发人员接手，重写整个代码，并将管道产品化。
2.  **推戳**。我的代码“按原样”重用，在数据工程师和开发人员的帮助下，我们围绕它构建了一个基础架构。

这两种方法各有利弊。放手的方法将确保解决方案更加稳定。因为数据科学家并不总是经验丰富的开发人员(这里没有冒犯的意思)，代码的产品化通常掌握在其他人的手中。在大公司里这是常有的事。一个细节，在这种情况下，代码的所有权不再属于数据科学家。所以修复 bug 是由软件开发团队来完成的。

第二种方法是让数据科学家将他的代码打包到一个库中，然后它将在另一个系统中使用。例如，在云中的 lambda 函数中。这种方法更快，因为我们避免了重写代码。代码被“清洗”了，债务也还清了。如果你遵循我在[之前的故事](/functional-programing-in-data-science-projects-c909c11138bb)中的建议，这一步可以高效完成。最后，代码的所有者仍然是数据科学家，我负责修复 bug。这种方式通常在小公司和初创公司中使用，在这些公司中，每个项目只能有有限的几个人参与。

我更喜欢使用第二种选择。我将在下一节更详细地解释我的理由。简而言之，当使用第一种方法时，如果我想发布解决方案的改进或添加一些功能，我将不得不处理我的代码库，重写规范，等待开发团队更新解决方案，等等。这可能需要几个月的时间。快速周期意味着最大限度地减少干涉。

# 维护和改善管道

好了，现在我的流水线在生产了。但是，创建一个流程来获取操作员的反馈以持续改进解决方案非常重要。例如，操作员每天都在使用该产品，但他对算法提出了一些改进。例如，他不去预测失败是否会发生，而是希望得到一个分数或者失败的概率。为了从预测中得到一个分数，需要在管道中做一个小的改变。只是返回概率而不是预测类。我试图做的是，一旦管道的第一个版本可用，就建立一个反馈流程(sprint 2–3)。这个反馈循环也可以帮助我在冲刺阶段进行调整，但是当产品发布时，这种持续的改进仍然存在。为了与用户进行良好的互动，我希望改进能尽快发布。出于这个原因，我避免了放手策略，自己去做改进，更快地获得反馈。反馈回路对于捕捉操作员做出的决策也很重要。当决策与管道的预测不匹配时，这意味着我们可以通过纳入运营商做出决策的“原因”来改进管道。随着时间的推移，运营商的角色会发生变化，变得越来越简单。一个结果是能够扩展他的能力。最终，预测性管道可能会变成规范性管道。然后，操作员不再解释预测，而是直接采取行动。这引出了我的最后一点:

# 公司重组

重要的是要明白，在一家公司引入人工智能解决方案，将会扰乱员工通常的工作方式。有时，员工的角色变化和额外的技能可能是需要的。例如，如果你引入一个聊天机器人来帮助客户支持团队，这个团队可能会减少或重新分配到其他任务。该解决方案还可能导致客户公司的一些业务重新定位。我看到一些公司因为新的解决方案而改变了他们的策略，从销售产品到销售服务。这通常是客户没有预料到的。有时，它会导致项目暂停一段时间。在我看来，该公司会受到算法的严重影响，以至于在他们的系统中重组和集成解决方案需要更多的投资。他们最终决定不使用它。我试图在过程的早期引入这个主题，以确保客户能够预见到这种情况。

我希望你在我描述的这种或那种情况下认识到了自己。如果你同意，或者不同意，请在下面发表评论。

我的 Linkedin: [这里](https://www.linkedin.com/in/nathanaelweill/)