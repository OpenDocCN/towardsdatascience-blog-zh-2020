<html>
<head>
<title>Tracing the Oil Spill</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">追踪石油泄漏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rolling-in-the-deep-589f3460960f?source=collection_archive---------20-----------------------#2020-03-03">https://towardsdatascience.com/rolling-in-the-deep-589f3460960f?source=collection_archive---------20-----------------------#2020-03-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0901" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我从漏油到应用人工智能预测设备故障的旅程</h2></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="53ce" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">一)动机</h1><p id="18e0" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在求职过程中，我发现我所在地区的许多公司都在寻找具有石油和天然气知识的数据科学家。我的背景大部分是关于数学的，所以我决定沿着石油管道去冒险。</p><p id="d5ab" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我注意到的一件事是，石油和天然气是一个庞大的行业，基础设施陈旧。2014 年，Inside Energy 报告称，美国 45%的原油管道已经超过 50 年。有些管道甚至在 20 世纪 20 年代以前就铺设好了，而<strong class="lj iu"> </strong>至今仍在运行。这种古老、老化的基础设施可能会导致灾难，如漏油，从而影响公司收入、环境和周围地区的人们。</p><p id="2efb" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">那么，所有这些石油泄漏的罪魁祸首是什么呢？让我们潜入油中！</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="8527" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">二)2010-2017 年石油管道事故</h1><p id="b2e9" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><a class="ae mi" href="https://www.kaggle.com/usdot/pipeline-accidents" rel="noopener ugc nofollow" target="_blank">数据</a>包括从 2010 年到 2017 年向管道和危险材料安全管理局报告的每个石油管道泄漏或溢出的记录。在 7 年多的时间里，发生了 2795 次泄漏。有 46 个特征描述每个事件。其中值得注意的有:<em class="mj">事故日期和时间、操作者姓名、事故原因、危险液体类型、损失数量、伤亡人数以及相关成本</em></p><p id="2abf" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">数据丰富，描述性强。我选择了一些有趣的特性，并从这里开始</p><h2 id="7dc8" class="mk kq it bd kr ml mm dn kv mn mo dp kz lq mp mq lb lu mr ms ld ly mt mu lf mv bi translated">1)事件是如何按年、月和一天中的小时分布的？</h2><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi mw"><img src="../Images/c885e10c143b23dfbdfbdc123af1d6c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CV4SFfPv4Rbe9yoaZeQoxQ.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">每年的病例数。资料来源:Huy Bui</p></figure><p id="977e" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">观察 2017 年有未完成的数据。最高峰是 2015 年的 462 例</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nm"><img src="../Images/02078a7996a3262d87dbf794f69db0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXwR8clsxu1IatuFumqnrQ.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">按日期的小时数列出的案例数</p></figure><p id="cd95" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">这里没有调整时区，但是我可以有把握地假设大多数情况发生在营业时间。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nm"><img src="../Images/cfc773fbb3a137542001d22dccdb6aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VnVvfOx5eBx8f9Y8zyIGKA.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">每月病例数。资料来源:Huy Bui</p></figure><p id="0a44" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">有趣的是，12 月份只有几起案件(212 起)。但在 1 月份，它急剧增加(275)。我想知道，由于运营从旧的一年过渡到新的一年，这里是否有一种趋势，或者，这可能只是一月份发生的一系列随机泄漏？</p><h2 id="5dc2" class="mk kq it bd kr ml mm dn kv mn mo dp kz lq mp mq lb lu mr ms ld ly mt mu lf mv bi translated">2)这些事故发生在哪里？</h2><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nn"><img src="../Images/c130c23bc1343da20879f606cadf22c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WN7VSNaxC4B8AQsdA9BsA.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">2010-2017 年所有事故的位置。资料来源:Huy Bui</p></figure><p id="3ac7" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">根据我由<code class="fe no np nq nr b">plotly</code>创建的地理图，在我看来泄漏发生在管道沿线。德克萨斯州是所有州中事故最多的州(1004 起)。这并不奇怪，因为德克萨斯州是美国最大的国内石油生产商。我以为德州会损失最多的钱，但事实并非如此…</p><h2 id="c151" class="mk kq it bd kr ml mm dn kv mn mo dp kz lq mp mq lb lu mr ms ld ly mt mu lf mv bi translated">3)每个状态的净损失是多少？</h2><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ns"><img src="../Images/458185bdce7038c11f88182c221c6a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RBYGur1e9PAbYy-iAnGekg.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">各州净损失(2010–2017)。资料来源:Huy Bui</p></figure><p id="742b" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">让我们来看看赔钱最多的三个州:</p><p id="9c91" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated"><strong class="lj iu">第三名</strong> <strong class="lj iu">得克萨斯</strong>发生 1004 起事故，损失 135580 桶，净亏损 18475 万桶</p><p id="cc0f" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated"><strong class="lj iu">第二名加州</strong>，事故 153 起，损失 3390 桶，净亏损 192 桶。密耳</p><p id="c548" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">而<strong class="lj iu">冠军</strong>是…密歇根州 29 起事故，5355 桶损失，834 百万桶</p><p id="c423" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我的假设是完全错误的，事故数量<strong class="lj iu">与净损失</strong>并不相关。此外，桶损失的数字没有考虑到钱去了哪里。</p><p id="4f62" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">拼图中缺失的部分是<strong class="lj iu">其他特征，</strong>我天真地认为它们不重要。我应该考虑的其他特征是:</p><ul class=""><li id="11d4" class="nt nu it lj b lk md ln me lq nv lu nw ly nx mc ny nz oa ob bi translated">管道关闭</li><li id="6307" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">财产损失成本</li><li id="478a" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">商品成本损失</li><li id="a3c5" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">应急响应成本</li><li id="c11b" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">环境补救费用</li></ul><h2 id="73d4" class="mk kq it bd kr ml mm dn kv mn mo dp kz lq mp mq lb lu mr ms ld ly mt mu lf mv bi translated">4)那么……密歇根到底发生了什么？</h2><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oh"><img src="../Images/3e84146c07bd2b194a49056a87b6a707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ibbbf2oMPhVqgHaMuZHM5g.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">密歇根净亏损时间序列(百万美元)。资料来源:Huy Bui</p></figure><p id="ca36" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">你看到的 2010 年的高峰占了密歇根州总净亏损的 95%,占了 7 年间美国总净亏损的 36%!稍加研究表明，这一事件就是 7 月 25 日的<strong class="lj iu">卡拉马祖河漏油事件</strong>。当<strong class="lj iu">安桥</strong>(6B 线)运营的一条管道爆裂并流入<strong class="lj iu">塔尔马奇溪</strong>时，长达 18 个小时无人察觉。工作人员误解了异常压力数据，认为这是由管道中的气泡引起的。因此，他们重新启动了输油管两次，使得漏油速度大大加快。</p><p id="6815" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">密歇根十大事件列表将让你更好地了解卡拉马祖河漏油事件对该州造成了多大的损害。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oi"><img src="../Images/f9d2f819461ab85a4198aaf1f0a76cd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVGdv_FDBylXkzyBB2aD3A.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">密歇根十大事故(按净损失排名)。资料来源:Huy Bui</p></figure><h2 id="9870" class="mk kq it bd kr ml mm dn kv mn mo dp kz lq mp mq lb lu mr ms ld ly mt mu lf mv bi translated">5)漏油的罪魁祸首是什么？</h2><p id="a134" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj iu">设备故障</strong>是这个问题的简答。当涉及到解释具有许多参数的数据时，人的能力是非常有限的。手动读取数据会导致忽略异常情况，并对业务造成严重损害。事实上，材料/焊接/设备故障占所有原因损失的 53%。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi oj"><img src="../Images/2cf4c6c6cd0212238dd4eba4fa990d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvDCZI3LXKXPIF44svTHiA.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">原因类别和不同特征之间的关联。资料来源:Huy Bui</p></figure><p id="1303" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">幸运的是，随着机器学习的增长，许多大型石油公司已经开始将人工智能应用到他们的基础设施中，以帮助防止设备故障，并使他们的业务受益。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="0035" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">III)预测性设备故障</h1><p id="2312" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">回到 2019 年 10 月，我参加了德克萨斯 A&amp;M 大学主办的数据马拉松。挑战之一是使用由康菲石油公司赞助的传感器<a class="ae mi" href="https://www.kaggle.com/c/equipfails/data" rel="noopener ugc nofollow" target="_blank"> <strong class="lj iu">数据</strong> </a>预测井下设备故障。我没有做这个挑战，但是我对这个问题很感兴趣，并且仍然记得它。之前的分析给了我足够的动力，让我回头再看一遍这个数据集。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ok"><img src="../Images/fcb89eef7781d49e122abc6c5e9932f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SE62jFI2VHIXHTuAHivt5g.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">传感器数据的样本。资料来源:Huy Bui</p></figure><p id="5041" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">训练集由 60000 个观察值和 170 个传感器值组成。这些传感器分为两种类型:</p><ul class=""><li id="46c9" class="nt nu it lj b lk md ln me lq nv lu nw ly nx mc ny nz oa ob bi translated"><code class="fe no np nq nr b">measure:</code>传感器的单次测量。</li><li id="1ce3" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated"><code class="fe no np nq nr b">histogram bin:</code>一组 10 个柱，它们是传感器的不同柱，显示它们随时间的分布。</li></ul><p id="63b7" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">工作是对观察结果是<strong class="lj iu">故障</strong>还是<strong class="lj iu">非故障</strong>进行分类。下面的直方图显示了列车组分布:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ol"><img src="../Images/c9eb54f7df6709074e01dbe37a2da04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_V6mSKmDRAfN0GpKNfkKNQ.png"/></div></div><p class="ni nj gj gh gi nk nl bd b be z dk translated">列车组中“故障”和“未故障”的分布。资料来源:Huy Bui</p></figure><p id="aef9" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">数据包含许多空值。我必须创建一个函数，接受不同的阈值，逐个处理丢失的值，并超调这个函数以获得最佳结果。我用<code class="fe no np nq nr b">xgboost</code>来做预测，用<code class="fe no np nq nr b">f1-score</code>作为度量。</p><p id="1d7f" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我将我的模型应用于测试集上的 16001 个不同的观察值。提交预测后，我在第一次尝试中获得了 0.99383。</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi om"><img src="../Images/13964df8d7bb257864830561764199a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pM2vCzqu-hzI7a6hgSbirw.png"/></div></div></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="625f" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">四)结论</h1><p id="3a77" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果石油工业投资研究人工智能，他们会更快地发现有缺陷的设备，更有效地防止灾难，并节省大量资金。具体来说，Kalamazoo 河漏油事件本来可以用机器学习来避免。</p><p id="7153" class="pw-post-body-paragraph lh li it lj b lk md ju lm ln me jx lp lq mf ls lt lu mg lw lx ly mh ma mb mc im bi translated">我希望你喜欢阅读我的文章，并跟随我踏上这一旅程。感谢任何反馈。如果你想看看数据，玩玩<code class="fe no np nq nr b">plotly</code>交互图，判断一下我的技术知识，这里是<a class="ae mi" href="https://github.com/williamhuybui/Oil-Gas-Leakage-Analysis-and-Equipment-Failure-Detection" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div></div>    
</body>
</html>