<html>
<head>
<title>Introduction to Hydra.cc: A Powerful Framework to Configure your Data Science Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hydra.cc 简介:配置数据科学项目的强大框架</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-hydra-cc-a-powerful-framework-to-configure-your-data-science-projects-ed65713a53c6?source=collection_archive---------31-----------------------#2020-08-31">https://towardsdatascience.com/introduction-to-hydra-cc-a-powerful-framework-to-configure-your-data-science-projects-ed65713a53c6?source=collection_archive---------31-----------------------#2020-08-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ff7d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">尝试不同的参数和模型，而无需花费数小时来修改代码！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/13a8b6ade824408d688a9eb42e37dd1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cKL0kBiSGJ7FOHpO"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@justusmenke?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">贾斯特斯·门克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="019f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">动机</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="2722" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">玩不同的特征工程方法和机器学习模型很有趣，但在获得好的结果之前，你很可能需要调整你的特征工程方法和调整你的机器学习模型。</p><p id="996d" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">例如，在下面的速配数据中，考虑到它们不是重要的特征，你可能想去掉<code class="fe mp mq mr ms b">iid, id, idg, wave, career</code>。但是在对数据做了更多的研究之后，你意识到<code class="fe mp mq mr ms b">career</code>将是预测两个人是否会有下一次约会的一个重要特征。所以你决定不放弃<code class="fe mp mq mr ms b">career</code>专栏。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt ls l"/></div></figure><p id="1616" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">如果您正在进行硬编码，这意味着将数据<strong class="lv iu">直接嵌入到脚本的源代码</strong>中，如下所示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="dddc" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">并且您的文件很长，您可能需要一段时间来<strong class="lv iu">找到指定</strong>删除哪些列的代码。如果从一个只包含数据信息的简单文本中修复列，而不使用像这样的其他 python 代码，这不是很好吗？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="d5f8" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">这时你需要一个配置文件。</p><h1 id="8cb3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是配置文件？</h1><p id="0f02" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">配置文件包含定义运行程序的设置的纯文本参数。一个好的做法是<strong class="lv iu">避免在 python 脚本中硬编码</strong>，而<strong class="lv iu">在配置文件中保留与数据</strong>相关的所有信息，比如删除哪些列、分类变量<strong class="lv iu">。</strong></p><p id="27a8" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">这种做法不仅节省了您在脚本中搜索特定变量的时间，而且使您的脚本更具可重复性。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="2d87" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">例如，我可以对完全不同的数据重用这段代码，因为代码中没有指定列名。为了让代码为新数据工作，我需要做的就是修改我的配置文件中的列名！</p><p id="d030" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">配置文件的通用语言是 YAML。YAML 是所有编程语言的人性化数据序列化标准。语法易于阅读，几乎与 Python 相似。在这里找到更多关于 YAML 语法的信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><h1 id="b049" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Hydra.cc 简介</h1><p id="c1d1" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">我希望上面的简短解释能帮助你理解配置文件的重要性。但是我们如何访问配置文件中的参数呢？</p><p id="42f1" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">有一些工具可以读取配置文件，比如<a class="ae ky" href="https://pyyaml.org/wiki/PyYAMLDocumentation" rel="noopener ugc nofollow" target="_blank"> PyYaml </a>，但是我最喜欢的是<a class="ae ky" href="https://hydra.cc/" rel="noopener ugc nofollow" target="_blank"> Hydra.cc </a>。为什么？因为它允许我:</p><ul class=""><li id="377b" class="na nb it lv b lw lx lz ma mc nc mg nd mk ne mo nf ng nh ni bi translated">无缝更改我在终端中的默认参数</li><li id="0385" class="na nb it lv b lw nj lz nk mc nl mg nm mk nn mo nf ng nh ni bi translated">在不同的配置组之间切换</li><li id="9cf7" class="na nb it lv b lw nj lz nk mc nl mg nm mk nn mo nf ng nh ni bi translated">自动记录结果</li></ul><p id="f858" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">让我们了解如何开始使用 hydra.cc，并探索使用这一强大工具的好处。</p><h2 id="a62e" class="no la it bd lb np nq dn lf nr ns dp lj mc nt nu ll mg nv nw ln mk nx ny lp nz bi translated">开始</h2><p id="be70" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">安装<a class="ae ky" href="https://hydra.cc/" rel="noopener ugc nofollow" target="_blank"> Hydra.cc </a></p><pre class="kj kk kl km gt oa ms ob oc aw od bi"><span id="3ab6" class="no la it ms b gy oe of l og oh">pip install hydra-core --upgrade</span></pre><p id="25ee" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">让我们从一个具体的例子开始:</p><p id="73ea" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">例如，如果您有如下所示的配置文件，其中包含关于数据路径、编码、管道类型和目标列的所有特定信息</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="c479" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">您需要做的就是将装饰器<code class="fe mp mq mr ms b">@hydra.main(config_path='path/to/config.yaml')</code>添加到将使用配置文件的函数中。确保在函数中添加<code class="fe mp mq mr ms b">config</code>来访问配置文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="bd16" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">现在，您可以使用配置文件中的任何参数了！如果你想知道目标的名字，</p><pre class="kj kk kl km gt oa ms ob oc aw od bi"><span id="9650" class="no la it ms b gy oe of l og oh">target: match</span></pre><p id="de6a" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">你所需要做的就是调用<code class="fe mp mq mr ms b">config.target</code>来得到字符串‘匹配’！</p><p id="b8ed" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">请注意，您不需要将单词“match”用引号括起来。如果它是一个单词，YAML 文件会将其视为一个字符串。</p><h2 id="4c56" class="no la it bd lb np nq dn lf nr ns dp lj mc nt nu ll mg nv nw ln mk nx ny lp nz bi translated">简单命令行应用程序</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lr ls l"/></div></figure><p id="7efb" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">Hydra.cc 允许您在终端中覆盖配置文件中的默认参数。例如，如果您想要将机器学习模型从决策树切换到逻辑回归</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><p id="737d" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">您不需要重写配置文件。您可以在运行文件时在终端中键入变量的替代参数</p><pre class="kj kk kl km gt oa ms ob oc aw od bi"><span id="cda2" class="no la it ms b gy oe of l og oh">python file.py model=logisticregression</span></pre><p id="4242" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">并且模型会切换到 logistic 回归！</p><p id="7631" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">更好的是，如果您的配置文件很复杂，Hydra.cc 还允许您通过制表符结束来更容易地访问文件中的参数！你可以在这里找到关于标签完成<a class="ae ky" href="https://hydra.cc/docs/tutorial/tab_completion" rel="noopener ugc nofollow" target="_blank">的细节。</a></p><h2 id="aa7d" class="no la it bd lb np nq dn lf nr ns dp lj mc nt nu ll mg nv nw ln mk nx ny lp nz bi translated">在不同的配置组之间切换</h2><p id="6b8c" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">为了保持配置文件的简短和结构化，您可能希望为不同的模型创建不同的文件以及它们的参数，如下所示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/712f69ba0a9d032b3275cf370bea14c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*hM5LTMCLaDIQtHdAHFWqXw.png"/></div></figure><p id="e045" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">您可以在命令行上指定要定型的模型的配置文件</p><pre class="kj kk kl km gt oa ms ob oc aw od bi"><span id="7760" class="no la it ms b gy oe of l og oh">python file.py model=logistic</span></pre><p id="51a1" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">现在，您可以在不同的模型之间切换，并轻松访问它们的超参数！</p><h2 id="7f41" class="no la it bd lb np nq dn lf nr ns dp lj mc nt nu ll mg nv nw ln mk nx ny lp nz bi translated">自动记录</h2><p id="2624" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">如果你想记录跑步的结果，记录是很重要的。但是由于设置成本，许多人不使用 Python 日志记录。Hydra.cc 根据一天的情况，自动创建所有结果并保存在“输出”文件夹中</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/ff262854ea7420cdf69d3ed2fad2a265.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*Bzv9pMxVmT43Q1Xioltk-Q.png"/></div></figure><p id="1d60" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">每个日文件夹都是根据小时和分钟来组织的。您将看到与您的运行相关的所有日志，以及用于该运行的配置文件！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/0baffc6447f5b8d46b1fc1f630ad8938.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*2AED8-z7FyIieZllGmOa6Q.png"/></div></figure><p id="f82d" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">如果您碰巧更改了您的配置文件，并且不记得您用来生成某个输出的配置文件是什么样子的，您可以查看当天的文件夹来找出答案！</p><p id="4f5c" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">在这里找到更多关于伐木<a class="ae ky" href="https://hydra.cc/docs/tutorial/logging" rel="noopener ugc nofollow" target="_blank">的信息</a>。</p><p id="2c88" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">因为在运行 hydra decorator 包装的函数时，您位于输出目录中，所以如果您想要访问父目录中的其他文件，请确保使用<code class="fe mp mq mr ms b">utils.to_absolute_path('path/to/file')</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu ls l"/></div></figure><pre class="kj kk kl km gt oa ms ob oc aw od bi"><span id="2bba" class="no la it ms b gy oe of l og oh">Current working directory  : /Users/khuyentran/dev/hydra/outputs/2019-10-23/10-53-03</span><span id="9031" class="no la it ms b gy ol of l og oh">Original working directory : /Users/khuyentran/dev/hydra</span><span id="4687" class="no la it ms b gy ol of l og oh">to_absolute_path('foo')    : /Users/khuyentran/dev/hydra/foo</span><span id="9a8a" class="no la it ms b gy ol of l og oh">to_absolute_path('/foo')   : /foo</span></pre><h1 id="3e2d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="0c9d" class="pw-post-body-paragraph lt lu it lv b lw mv ju ly lz mw jx mb mc mx me mf mg my mi mj mk mz mm mn mo im bi translated">恭喜你！您已经了解了配置文件的重要性以及如何无缝配置您的数据科学项目。我发现，当我将所有与数据相关的信息都放在一个单独的文件中时，会更有条理。我还发现，当我所需要做的就是调用<code class="fe mp mq mr ms b">python file.py variable=new_value.</code>时，试验不同的参数会更容易。我希望通过在数据科学实践中结合配置文件和 Hydra.cc，您也能获得同样的好处。</p><p id="2489" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">下面是使用 hydra.cc 和 config 文件的<a class="ae ky" href="https://github.com/khuyentran1401/Speed-Dating" rel="noopener ugc nofollow" target="_blank">示例项目</a>。</p><p id="5df6" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以在 LinkedIn 和 Twitter 上与我联系。</p><p id="2b7b" class="pw-post-body-paragraph lt lu it lv b lw lx ju ly lz ma jx mb mc md me mf mg mh mi mj mk ml mm mn mo im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在 Medium 上关注我，了解我的最新数据科学文章，例如</p><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/5-reasons-why-you-should-switch-from-jupyter-notebook-to-scripts-cb3535ba9c95"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">你应该从 Jupyter 笔记本转向脚本的 5 个理由</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">使用脚本帮助我认识到 Jupyter 笔记本的缺点</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ks op"/></div></div></a></div><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/how-to-create-fake-data-with-faker-a835e5b7a9d9"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">如何用 Faker 创建假数据</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">您可以收集数据或创建自己的数据</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd ks op"/></div></div></a></div><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/how-to-monitor-and-log-your-machine-learning-experiment-remotely-with-hyperdash-aa7106b15509"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">如何使用 HyperDash 远程监控和记录您的机器学习实验</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">培训需要很长时间才能完成，但你需要去洗手间休息一下…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pf l pa pb pc oy pd ks op"/></div></div></a></div><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/how-to-leverage-visual-studio-code-for-your-data-science-projects-7078b70a72f0"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">如何在数据科学项目中利用 Visual Studio 代码</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">直到发现一种新的有效方法，我们才意识到我们是多么低效</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="pg l pa pb pc oy pd ks op"/></div></div></a></div><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/how-to-share-your-python-objects-across-different-environments-in-one-line-of-code-f30a25e5f50e"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">如何在一行代码中跨不同环境共享 Python 对象</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">为建立与他人分享你的发现的环境而感到沮丧？以下是如何让它变得更简单</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="ph l pa pb pc oy pd ks op"/></div></div></a></div></div></div>    
</body>
</html>