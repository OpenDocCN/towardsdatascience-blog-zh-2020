<html>
<head>
<title>You Should Start Using FastAPI Now</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">您应该现在就开始使用FastAPI</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/you-should-start-using-fastapi-now-7efb280fec02?source=collection_archive---------2-----------------------#2020-05-29">https://towardsdatascience.com/you-should-start-using-fastapi-now-7efb280fec02?source=collection_archive---------2-----------------------#2020-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/1d9f63a1d0109ab759d37530a55a8b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*du7p50wS_fIsaC_lR18qsg.png"/></div></div></figure><div class=""/><div class=""><h2 id="5d50" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">如果您还没有尝试过FastAPI，现在是时候了</h2></div><p id="ee30" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">得益于Flask、Django、Falcon等优秀的框架，Python一直是开发轻量级web应用程序的热门选择。由于Python是机器学习的头号语言，所以它特别方便将模型打包并作为服务公开。</p><p id="55fe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">多年来，Flask一直是这项工作的首选工具，但是如果你还没有听说的话，现在有了一个新的挑战者。<a class="ae lp" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>是Python的一个相对较新的web框架，从它的前辈那里获得灵感，完善它们并修复它们的许多缺陷。它建立在Starlette之上，为桌面带来了大量令人敬畏的功能。</p><p id="6e8e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">最近，它获得了巨大的吸引力，在过去的8个月里，我每天都与它一起工作，我可以自信地说，炒作是合理的。如果你还没有尝试过，我想给你五个尝试的理由。</p><h1 id="f85e" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">简单而出色的界面</h1><p id="dd17" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">所有的web框架都需要在功能和给开发者自由之间取得平衡。姜戈很强大，但非常固执己见。另一方面，Flask级别很低，足以提供很大的自由度，但是还有很多事情留给用户去做。FastAPI更像是一个瓶子，但它设法达到了更健康的平衡。</p><p id="a0f0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了给你一个例子，让我们看看如何在FastAPI中定义端点。</p><figure class="mn mo mp mq gt iv"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="1e43" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了定义模式，它使用Pydantic，这是另一个很棒的Python库，用于数据验证。这在这里很容易做到，但是后台发生了很多事情。验证输入的责任委托给了FastAPI。如果请求不正确，例如<code class="fe mt mu mv mw b">email</code>字段包含一个int，将返回一个适当的错误代码，而不是应用程序因可怕的内部服务器错误(500)而崩溃。而且几乎是免费的。</p><p id="d6fa" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这个简单的示例应用程序可以与uvicorn一起提供:</p><pre class="mn mo mp mq gt mx mw my mz aw na bi"><span id="a1af" class="nb lr je mw b gy nc nd l ne nf">uvicorn main:app</span></pre><p id="570e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">现在，应用程序可以接受请求了。在这种情况下，请求应该是这样的</p><pre class="mn mo mp mq gt mx mw my mz aw na bi"><span id="9288" class="nb lr je mw b gy nc nd l ne nf">curl -X POST "<a class="ae lp" href="http://localhost:8000/login" rel="noopener ugc nofollow" target="_blank">http://localhost:8000/login</a>" -H  "accept: application/json" -H  "Content-Type: application/json" -d "{\"email\":\"string\",\"password\":\"string\"}"</span></pre><p id="b522" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">锦上添花的是，它使用交互式Swagger UI根据OpenAPI自动生成文档。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/17e29b0805996593cfda9a7e8d9060bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bm7fcJsMcVbR6XJ8EiU7WQ.png"/></div></div><p class="nh ni gj gh gi nj nk bd b be z dk translated">FastAPI应用程序的Swagger UI</p></figure><h1 id="efad" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">异步ˌ非同步(asynchronous)</h1><p id="20bf" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">与Node.js或Go中的框架相比，Python WSGI web框架的最大缺点之一是无法异步处理请求。自从引入ASGI以来，这不再是一个问题，FastAPI正在充分利用这一点。您所要做的只是用关键字<code class="fe mt mu mv mw b">async</code>声明端点，就像这样:</p><figure class="mn mo mp mq gt iv"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h1 id="21c8" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">依赖注入</h1><p id="2b8b" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">FastAPI有一个非常酷的方法来管理依赖关系。尽管开发人员没有被强制这样做，但是强烈建议使用内置的注入系统来处理端点中的依赖关系。</p><p id="4330" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">举个例子，让我们写一个端点，用户可以在这里对某些文章发表评论。</p><figure class="mn mo mp mq gt iv"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="1a14" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">当端点被调用时，FastAPI会在运行时自动评估<code class="fe mt mu mv mw b">get_database</code>函数，因此您可以根据需要使用返回值。这(至少)有两个很好的理由。</p><ol class=""><li id="f70e" class="nl nm je kv b kw kx kz la lc nn lg no lk np lo nq nr ns nt bi translated">您可以通过修改<code class="fe mt mu mv mw b">app.dependency_overrides</code>字典来全局覆盖依赖关系。这可以使测试变得轻而易举，因为您可以很容易地模仿对象。</li><li id="7f19" class="nl nm je kv b kw nu kz nv lc nw lg nx lk ny lo nq nr ns nt bi translated">依赖关系(在我们的例子中是<code class="fe mt mu mv mw b">get_database</code>)可以执行更复杂的检查，允许您将它们从业务逻辑中分离出来。这大大简化了事情。例如，<a class="ae lp" href="https://fastapi.tiangolo.com/tutorial/security/first-steps/" rel="noopener ugc nofollow" target="_blank">用户认证可以通过这个</a>轻松实现。</li></ol><h1 id="4d72" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">易于与数据库集成</h1><p id="9cb8" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">SQL、MongoDB、Redis或您选择的任何东西，FastAPI都不会强迫您围绕它们构建应用程序。如果您曾经尝试过使用Django处理MongoDB，您就会知道这有多痛苦。有了FastAPI，您不需要做额外的工作，将数据库添加到您的堆栈中是尽可能简单的。(或者更准确地说，要完成的工作量将由您选择的数据库决定，而不是由web框架增加的复杂性决定。)</p><p id="d87c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但说真的，看看这美景。</p><figure class="mn mo mp mq gt iv"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="941d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">瞧啊。我能看见你在打字</p><pre class="mn mo mp mq gt mx mw my mz aw na bi"><span id="f455" class="nb lr je mw b gy nc nd l ne nf">pip install fastapi</span></pre><p id="f1df" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">已经传到你的终端了。</p><h1 id="ba35" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">GraphQL支持</h1><p id="30ec" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">当您处理一个复杂的数据模型时，REST可能是一个严重的障碍。当前端的微小变化需要更新端点的模式时，这绝对不是好玩的。GraphQL在这些情况下大放异彩。尽管GraphQL支持并不是Python web框架中唯一的，但Graphene和FastAPI可以无缝地协同工作。不需要为Django安装任何类似<code class="fe mt mu mv mw b">graphene_django</code>的扩展，它本身就可以工作。</p><h1 id="f663" class="lq lr je bd ls lt lu lv lw lx ly lz ma kk mb kl mc kn md ko me kq mf kr mg mh bi translated">+1:优秀的文档</h1><p id="a926" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">当然，如果没有同样优秀的文档，一个优秀的框架不可能真正闪耀光芒。Django，Flask和所有其他人在这方面都很出色，但FastAPI与他们不相上下。当然，由于它年轻得多，目前还没有关于它的书籍，但这只是时间问题。</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="4ba9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果你想看看FastAPI的实际应用，我正好有一个完美的指南给你！我写了一个详细的教程，你可以用Docker，Docker Compose和GitHub Actions来部署你的机器学习模型！</p><div class="is it gp gr iu og"><a rel="noopener follow" target="_blank" href="/how-to-properly-ship-and-deploy-your-machine-learning-model-8a8664b763c4"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd jf gy z fp ol fr fs om fu fw jd bi translated">如何正确地发布和部署您的机器学习模型</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">FastAPI、Docker和GitHub操作实用指南</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ja og"/></div></div></a></div><p id="c29f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">总而言之，无论你是在寻找一个快速轻量级的框架来服务于你的深度学习模型还是更复杂的东西，FastAPI都能提供。如果您还没有尝试过，我强烈建议您尝试一下。我很确定你会坚持下去。</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="5621" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><a class="ae lp" href="https://www.tivadardanka.com/blog" rel="noopener ugc nofollow" target="_blank"> <strong class="kv jf"> <em class="ov">如果你喜欢把机器学习概念拆开，理解是什么让它们运转，我们有很多共同点。看看我的博客，我经常在那里发表这样的技术文章！</em> </strong> </a></p></div></div>    
</body>
</html>