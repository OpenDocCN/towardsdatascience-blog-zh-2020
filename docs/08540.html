<html>
<head>
<title>Challenges Deploying Machine Learning Models to Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将机器学习模型部署到生产中的挑战</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/challenges-deploying-machine-learning-models-to-production-ded3f9009cb3?source=collection_archive---------18-----------------------#2020-06-21">https://towardsdatascience.com/challenges-deploying-machine-learning-models-to-production-ded3f9009cb3?source=collection_archive---------18-----------------------#2020-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0d7f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">MLOps:用于机器学习的 DevOps</h2></div><h1 id="b1dd" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">目录</h1><blockquote class="la lb lc"><p id="79d5" class="ld le lf lg b lh li ju lj lk ll jx lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><a class="ae ma" href="#6e2c" rel="noopener ugc nofollow">传统软件开发 vs 机器学习</a> <br/> <a class="ae ma" href="#d906" rel="noopener ugc nofollow">机器学习工作流程</a> <br/> <a class="ae ma" href="#2987" rel="noopener ugc nofollow">阶段#1:数据管理</a> <strong class="lg iu"> <br/> </strong> - <a class="ae ma" href="#c5cf" rel="noopener ugc nofollow">大数据量</a> <br/> - <a class="ae ma" href="#fad7" rel="noopener ugc nofollow">高质量</a> <br/> - <a class="ae ma" href="#309d" rel="noopener ugc nofollow">数据版本化</a>-<br/>-<a class="ae ma" href="#cdc6" rel="noopener ugc nofollow">位置</a>-<a class="ae ma" href="#5858" rel="noopener ugc nofollow">安全性&amp;合规性</a> <br/> <a class="ae ma" href="#6687" rel="noopener ugc nofollow">阶段#2:实验 <br/> - </a><a class="ae ma" href="#ba72" rel="noopener ugc nofollow">训练时间&amp;故障排除</a> <br/> - <a class="ae ma" href="#d0df" rel="noopener ugc nofollow">模型精度评估</a> <br/> - <a class="ae ma" href="#3289" rel="noopener ugc nofollow">再训练</a> <br/> - <a class="ae ma" href="#7858" rel="noopener ugc nofollow">基础设施要求</a> <br/> <a class="ae ma" href="#7d48" rel="noopener ugc nofollow">阶段#3:生产部署</a> <br/> - <a class="ae ma" href="#a392" rel="noopener ugc nofollow">离线/在线预测</a>-<a class="ae ma" href="#1ed4" rel="noopener ugc nofollow">模型退化</a> <br/> <a class="ae ma" href="#8156" rel="noopener ugc nofollow">结论</a></p></blockquote><p id="343a" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">机器学习(ML) </strong>世界的一个众所周知的事实是，将 ML 模型部署到生产中比开发它需要更长的时间。根据著名论文“<a class="ae ma" href="https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf" rel="noopener ugc nofollow" target="_blank">机器学习系统中隐藏的技术债务</a>”:</p><blockquote class="me"><p id="71b7" class="mf mg it bd mh mi mj mk ml mm mn lz dk translated">“只有一小部分真实世界的 ML 系统由 ML 代码组成，如中间的小黑框所示(见下图)。所需的周边基础设施庞大而复杂。”</p></blockquote><figure class="mp mq mr ms mt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mo"><img src="../Images/f2c0b164761bce99a6d7e3d844f600de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GZCWEWpAO2OZLVxy"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">图表#1: <strong class="bd nf">摘自论文</strong> <a class="ae ma" href="https://papers.nips.cc/paper/5656-hidden-technical-debt-in-machine-learning-systems.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="bd nf">机器学习系统中隐藏的技术债务</strong> </a></p></figure><h1 id="6e2c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">传统软件开发与机器学习</h1><p id="92f1" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">如果你把传统的软件开发和机器学习放在一起考虑，你可以在下面的图 2 中清楚地看到后者的分歧。即使是这样，传统软件开发的大多数原则和实践都可以应用于机器学习，但是有一些独特的 ML 特定挑战需要以不同的方式处理。在本文中，我们将讨论那些使 ML 模型难以部署到生产中的独特挑战。</p><figure class="nm nn no np gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nl"><img src="../Images/155023d51021056464693b1ecb77ac42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3ul-6LyIXLD2TkZS5KDYmw.gif"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">图表#2: <strong class="bd nf">传统软件开发</strong> vs <strong class="bd nf">机器学习</strong></p></figure><h1 id="d906" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">机器学习工作流</h1><p id="40a0" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">典型的 ML 工作流程包括数据管理、实验和生产部署，如下图所示。</p><figure class="nm nn no np gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nl"><img src="../Images/787e1a38938791c5d4191e5200fa447f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*f5F0TjZEhmY8YkyO15Rnhw.gif"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">图 3: <strong class="bd nf">机器学习工作流程</strong></p></figure><p id="71ed" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated">我们将了解下面的每个阶段，以及团队在每个阶段面临的特定挑战。</p><h1 id="2987" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">阶段#1:数据管理</h1><p id="5373" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">训练数据是决定模型性能的基本因素之一。这一阶段通常包括数据采集和准备。使用 ML 数据时，您需要注意以下挑战:</p><p id="c5cf" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">大数据量:</strong>模型在训练过程中通常需要大数据集，以提高其对实时数据进行预测的准确性。数据集可能高达数百千兆字节，甚至更大。这带来了一些独特的挑战，如移动数据不容易，数据传输通常成本高昂且耗时。</p><p id="fad7" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">高质量数据:</strong>如果数据质量不好，拥有一个大的数据集是没有用的。找到高质量的正确数据对于模型的准确性非常重要。从正确的来源获取数据并进行足够的验证以确保高质量有助于解决问题。确保你的模型没有基于种族、性别、年龄、收入群体等方面的偏见。也很关键。为此，你需要确保你的数据有<strong class="lg iu">模型偏差和</strong>公平性验证。</p><p id="309d" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">数据集跟踪:</strong>复制模型的训练方式对数据科学家很有帮助。为此，需要对每次训练运行中使用的数据集进行版本控制和跟踪。这也让数据科学家能够灵活地回到数据集的先前版本并对其进行分析。</p><p id="cdc6" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">位置:</strong>根据使用情况，这些数据集位于不同的位置，如上所述，它们可能会更大。由于这些原因，在更接近数据位置的地方运行训练和某些情况下的预测可能是有意义的，而不是跨位置传输大型数据集。</p><p id="158e" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated">注意:<em class="lf">确保这是值得努力的。如果你能在不增加复杂性的情况下进行管理，并集中运行，我会推荐你这样做。</em></p><p id="5858" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">安全性&amp;合规性:</strong>在某些情况下，所使用的数据可能是敏感的，或者需要满足某些合规性标准(如 HIPAA、PCI 或 GDPR)。当你支持 ML 系统时，你需要记住这一点。</p><h1 id="6687" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">第二阶段:实验</h1><p id="34b0" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">这一阶段包括模型开发，数据科学家将大量时间用于研究各种架构，以了解哪些架构符合他们的需求。例如，对于语义分割，这里有各种可用的<a class="ae ma" rel="noopener" target="_blank" href="/semantic-segmentation-popular-architectures-dff0a75f39d0">架构</a>。数据科学家编写代码来使用前一阶段的数据，并使用这些数据来训练模型，然后进行评估，以查看它是否符合他们所寻求的准确性标准。请参见下面您将在此阶段面临的一些挑战。</p><p id="2e89" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">持续的研究和实验工作流程:</strong>他们花时间收集/生成数据，进行实验，尝试各种架构，看看什么适合他们的用例。他们还尝试<a class="ae ma" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization" rel="noopener ugc nofollow" target="_blank">超参数优化</a>和用各种数据集进行训练，看看什么能给出更准确的结果。</p><p id="fb2f" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated">由于其研究和实验性质，需要支持的工作流不同于传统的软件开发。</p><p id="2a10" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">跟踪实验:</strong>该工作流程的一个关键方面是允许数据科学家跟踪实验，并了解各次运行之间发生了什么变化。他们应该能够轻松地跟踪不同实验之间的数据集、架构、代码和超参数变化。</p><p id="6ab4" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">代码质量:</strong>由于研究和实验阶段的原因，许多编写的代码通常质量不高，不能用于生产。数据科学家花费大量时间使用像 Jupyter Notebook 这样的工具，并在那里直接进行修改以进行测试。您需要记住这一点，并在将 ML 模型部署到生产之前处理它。</p><p id="ba72" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">训练时间&amp;故障排除:</strong>训练一个模型通常需要几个小时甚至几天的运行时间，并且需要特殊的基础设施(参见下面的挑战 4)。例如，根据他们的<a class="ae ma" href="https://www.tesla.com/autopilotAI" rel="noopener ugc nofollow" target="_blank">网站</a>，一个完整的特斯拉自动驾驶神经网络需要 70，000 个 GPU 小时来训练。由于培训通常需要大量时间，您需要能够在培训过程中使用<strong class="lg iu">监控、日志记录、警报和验证</strong>等方面来支持简单的故障排除。如果培训过程出错，提供简单的方法来解决问题，并继续/重新开始培训非常重要。</p><p id="d0df" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">模型精度评估:</strong>训练完成后，需要对模型精度进行评估，看是否满足生产中预测所需的标准。如上面的图 3 所示，您通过训练/数据管理步骤不断提高准确度，直到达到可接受的数字。</p><p id="3289" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">再培训:</strong>当您遇到<a class="ae ma" href="https://docs.microsoft.com/en-us/azure/machine-learning/how-to-monitor-data-drift#what-is-data-drift" rel="noopener ugc nofollow" target="_blank">数据漂移</a>，生产中的错误，或者需求变更时，您可能需要对模型进行再培训。需要有一种方法来支持再培训模型。</p><p id="7858" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">基础架构需求:</strong> ML 工作负载有某些特殊的基础架构需求，如<a class="ae ma" href="https://en.wikipedia.org/wiki/Graphics_processing_unit" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">GPU</strong></a><strong class="lg iu">&amp;高密度内核</strong>。数千个处理核心在一个 GPU 中同时运行，这使得训练和预测的运行速度比仅使用 CPU 要快得多。由于这些基础设施需求(尤其是 GPU)成本<strong class="lg iu">高昂</strong>，并且大多是周期性突发培训所需，因此支持弹性和自动化扩展以及供应/取消供应基础设施(尤其是在使用云时)是一个好主意。</p><p id="2166" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated">如今，像<a class="ae ma" href="https://en.wikipedia.org/wiki/Nvidia_Jetson" rel="noopener ugc nofollow" target="_blank"> Nvidia Jetson 系列</a>这样的边缘设备(物联网、移动设备等)越来越多地被使用，部署到这些设备是另一个挑战，因为这些设备大多使用<a class="ae ma" href="https://stackoverflow.com/questions/14794460/how-does-the-arm-architecture-differ-from-x86" rel="noopener ugc nofollow" target="_blank"> ARM 架构，而不是资源有限的 x86 </a>。需要在这些设备上测试模型的准确性和性能。</p><p id="0fe6" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated">由于缺乏对 ARM 架构的某些依赖项及其最新版本的支持，围绕构建包/模型的良好实践会有所帮助。</p><h1 id="7d48" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">阶段#3:生产部署</h1><p id="c4c4" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">在模型经过训练并达到一定的准确性后，它将被部署到生产中，开始根据实时数据进行预测。以下是此阶段需要注意的一些挑战。</p><p id="a392" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">离线/在线预测:</strong>根据模型及其在生产中使用实时数据的方式，您可能需要支持离线(批量)预测或在线(实时)预测。您需要一个合适的框架来为基于类型(批处理或实时)的模型提供服务。如果是批处理预测，请确保您可以适当地实时调度批处理作业，您需要担心处理时间，因为结果通常需要同步返回。</p><p id="1ed4" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu">模型退化:</strong>由于数据漂移、环境变化等各种因素，模型在生产中退化(即预测变得不准确)。久而久之。让团队能够随时获得解决问题所需的信息是很重要的，这样他们才能采取行动。</p><h1 id="8156" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="cf8b" class="pw-post-body-paragraph ld le it lg b lh ng ju lj lk nh jx lm mb ni lp lq mc nj lt lu md nk lx ly lz im bi translated">DevOps 原则和实践包括所有三个方面(人员、流程和技术),已被有效地用于缓解传统软件的挑战。这些相同的 DevOps 原则和实践以及一些机器学习特定实践可以用于成功部署和操作 ML 系统。这些人工智能原则和实践也被称为机器学习的<strong class="lg iu"> MLOps </strong>或<strong class="lg iu">devo PS</strong>。我将撰写后续文章，探讨那些有助于克服本文中提到的挑战的原则和实践。</p><p id="c7f7" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><strong class="lg iu"> <em class="lf">鸣谢:</em> </strong> <em class="lf"> Priyanka Rao 和 Bobby Wagner 阅读了本文的草稿版本，并提供了反馈来改进它。</em></p><p id="a3b7" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm mb lo lp lq mc ls lt lu md lw lx ly lz im bi translated"><em class="lf">同时发布在</em> <a class="ae ma" href="https://shahadarsh.com/2020/06/19/challenges-deploying-machine-learning-models-to-production/" rel="noopener ugc nofollow" target="_blank"> <em class="lf">我的网站</em> </a> <em class="lf">。</em></p></div></div>    
</body>
</html>