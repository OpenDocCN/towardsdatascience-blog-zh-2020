<html>
<head>
<title>Understand your Computer System using Logs 📃</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用日志了解您的计算机系统📃</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understand-your-computer-system-using-logs-98139d0b5de1?source=collection_archive---------35-----------------------#2020-07-04">https://towardsdatascience.com/understand-your-computer-system-using-logs-98139d0b5de1?source=collection_archive---------35-----------------------#2020-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="e646" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq"> System.out.println("到此为止的作品")；</em></p></blockquote><p id="8b65" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">作为一个程序员，你可能已经写了上面的代码段来弄清楚你的代码是怎么回事(这里是 Java)。通常，当我们试图调试代码时，我们会使用这种技巧。我们这样做是为了理解代码、执行流程并识别代码中的错误。记录和理解计算机系统执行的系统方法是系统日志。系统日志不仅仅用于调试。它们用于更具挑战性的计算机系统相关用例。其中包括系统监控、工作流建模、性能调查和异常检测。让我们看看如何使用系统日志来了解我们的计算机系统，以及当它被用作大数据时有多强大。</p><h1 id="8f34" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">什么是日志数据？</h1><p id="14ef" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">计算机系统生成由系统运行时信息组成的系统日志。通常，日志文件包含一系列日志行，代表系统中发生的不同事件。系统日志是使用描述系统当前运行时信息的单独代码段写入文件的输出。以下是阿帕奇<a class="ae lv" href="http://www.slf4j.org/" rel="noopener ugc nofollow" target="_blank"> SLF4J </a>登录 Java 的方式。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="00f9" class="mf kt iq mb b gy mg mh l mi mj">LOGGER.info(“Participated to a new round of number” + roundNumber + “with rank as “ + nodeRank);</span></pre><p id="d7e2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">下面给出了可能的原始日志行，它将通过执行上述代码段写入日志文件。</p><pre class="lw lx ly lz gt ma mb mc md aw me bi"><span id="88bf" class="mf kt iq mb b gy mg mh l mi mj">2019–11–18 20:18:29,467 [INFO] distributedConsensus.LeaderCandidate Participated to a new round of number 13 with rank as 263</span></pre><p id="a195" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">一个日志文件可能包含成百上千个类似于上面例子的日志，描述你的计算机系统的故事。这些日志行可以是<em class="js">错误</em>消息、<em class="js">警告、调试</em>级别消息或一般<em class="js">信息</em>消息或其他类型的日志消息。为了使日志记录变得简单和一致，在 Java 编程中使用了像<a class="ae lv" href="http://www.slf4j.org/" rel="noopener ugc nofollow" target="_blank"> SLF4J </a>、<a class="ae lv" href="http://logback.qos.ch/" rel="noopener ugc nofollow" target="_blank">日志回溯</a>这样的日志记录框架。<a class="ae lv" href="https://www.npmjs.com/package/log4js" rel="noopener ugc nofollow" target="_blank"> Log4js </a>和<a class="ae lv" href="https://www.npmjs.com/package/winston" rel="noopener ugc nofollow" target="_blank"> Winston </a>是 Node.Js 中常用的日志记录工具，这些日志记录框架为您提供了一套 API 来实现简单、一致和健壮的日志记录体验。可以将它们配置为在日志消息中嵌入附加信息，如日期、时间、详细级别和当前运行的进程(如示例所示)，而无需在日志消息中明确指定。</p><figure class="lw lx ly lz gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mk"><img src="../Images/e8bf99bd86b756646797bd4d13be8b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMlAHULEyH9W21N64kmAYg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">日志文件中的原始日志行(取自<a class="ae lv" href="https://github.com/logpai/loghub" rel="noopener ugc nofollow" target="_blank"> loghub </a>中的 Hadoop 数据集)</p></figure><h1 id="7df8" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">原木线上的鸟瞰图</h1><p id="6869" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">生成的日志行可能包含不同的标题字段(取决于所使用的日志框架、配置和程序员希望与日志一起存储的信息)以及用自然语言编写的日志消息，该日志消息包含程序员希望记录的系统事件的详细信息。</p><p id="eae6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在上面的例子中，<code class="fe mw mx my mb b">2019–11–18 20:18:29,467 [INFO] distributedConsensus.LeaderCandidate</code>可以被识别为由空格分隔的标题字段的集合。这些字段被嵌入到日志行中，因为程序员已经配置了日志框架来这样做。<code class="fe mw mx my mb b">Participated to a new round of number 13 with rank as 263</code> <strong class="jt ir"> </strong>是自然语言日志消息，包含程序员想要记录的系统事件信息。这部分的内容完全取决于程序员记录的系统事件和他们使用的(英语)语言。要获得日志数据的真正优势，重要的是日志数据中提到的信息能够被人类容易地理解。</p><h1 id="773c" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">了解日志数据</h1><p id="1112" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">日志数据可以被视为大数据的半结构化形式之一，因为原始日志行由结构化的标题和非结构化的日志消息组成。尽管我们有大量的日志数据来描述我们系统的整个故事，但是通过阅读日志来理解日志数据是非常困难的。这主要是因为日志消息部分是由人类使用(主要)英语编写的。识别日志行的标题字段并不困难，因为日志行的这一部分具有由日志框架定义的结构。在上面的例子中，我们很容易理解，<code class="fe mw mx my mb b">2019–11–18 </code>是日期，<code class="fe mw mx my mb b">20:18:29,467</code>是时间戳，<code class="fe mw mx my mb b">[INFO]</code>是详细级别，<code class="fe mw mx my mb b">distributedConsensus.LeaderCandidate</code>是执行该事件的进程或组件。</p><p id="8004" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">理解日志数据真正困难的部分是理解自然语言日志消息，其中包含关于所记录的系统事件的最重要信息。因此，主要关注自然语言日志消息的结构化。通过观察上面生成日志行的代码段，我们可以理解程序员记录了一个与“参与一轮”相关的事件。我们还可以看到，事件可能在不同的情况下发生，因此，代码中指定的参数值(roundNumber，nodeRank)可能会因日志行的不同而不同。这是因为它们是特定事件的动态决定信息。</p><figure class="lw lx ly lz gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mz"><img src="../Images/6f7edef1baa018aed31e9275a1be3bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6iE_aqZj8zW1jKgFCsJY_g.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">同一事件的一组日志消息</p></figure><p id="f3ed" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在日志分析研究领域中，<code class="fe mw mx my mb b">Participated to a new round of number ..... with rank as .....</code>部分被识别为日志消息的<strong class="jt ir">恒定部分</strong>或<strong class="jt ir">固定部分</strong>，因为它可以在“参与一轮”类型事件的任何日志消息事件中找到。日志消息的这个<strong class="jt ir">常量部分</strong>完全取决于记录系统事件的程序员所使用的文字和语言。日志消息的这个常量部分的实际用途是，它是“参与一轮”类型事件的所有日志消息的一般代表。也就是说，根据日志代码语句中给变量(<em class="js"> roundNumber </em>和<em class="js"> nodeRank </em>的值)的不同，同一事件的日志消息会有所不同。因此，出现在日志代码中该变量位置的值(上例中的 13 和 263、34 和 134 …)被标识为<strong class="jt ir">可变部分</strong>或<strong class="jt ir">可变部分</strong>。大多数情况下，这些可变部分由数值组成，但并非所有情况都是如此。日志消息的<strong class="jt ir">可变部分</strong>携带系统的动态运行时信息，因此是非常有价值的信息源。</p><p id="1b2d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果我们能够将日志文件中的日志消息的<strong class="jt ir">常量部分</strong>与<strong class="jt ir">变量部分</strong>分开会怎么样？如果可能的话，我们可以生成一个结构良好、比原始日志文件更容易理解的日志报告。这种结构化日志报告可以表示为一个表，该表具有描述日志行的标识符字段的不同列和表示每个日志行实例的行。</p><figure class="lw lx ly lz gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi na"><img src="../Images/4ff2b9e6dbad2e9070819bbc3f621704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omlP-G5CKkgZki6f7T702A.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">更易于理解的结构化日志报告</p></figure><p id="a3ee" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">这种日志报告比原始日志文件更容易理解。这就是为什么许多技术和方法被建议从日志文件生成结构化日志报告。当前日志分析系统中使用的一些技术是频繁模式挖掘方法、日志数据聚类、捕捉日志行中模式的基于启发的方法等。关于日志结构方法的更多细节将在以后的文章中描述。</p><p id="17b8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">快乐阅读…！</p></div></div>    
</body>
</html>