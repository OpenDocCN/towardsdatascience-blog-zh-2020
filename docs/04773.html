<html>
<head>
<title>Identifying Sellers of Illicit Narcotics on Soundcloud.com Using Latent Dirichlet Allocation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用潜在狄利克雷分配识别Soundcloud.com非法毒品卖家</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/identifying-sellers-of-illicit-narcotics-on-soundcloud-com-using-latent-dirichlet-allocation-cae0a66deb67?source=collection_archive---------66-----------------------#2020-04-26">https://towardsdatascience.com/identifying-sellers-of-illicit-narcotics-on-soundcloud-com-using-latent-dirichlet-allocation-cae0a66deb67?source=collection_archive---------66-----------------------#2020-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="961b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于PyCaret的Soundcloud.com评论主题建模</h2></div><h1 id="aa36" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="70ab" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">之前，我开发了一个<a class="ae lw" rel="noopener" target="_blank" href="/identifying-sellers-of-illicit-narcotics-on-soundcloud-com-3ca0bece4307">框架</a>，用于识别Soundcloud.com上非法毒品广告的卖家。这个框架通过一个简单的关键词搜索来搜集评论，并识别出为药物做广告的评论。虽然这个框架由于注释的相似结构做得很好，但我想通过使用潜在的Dirichlet分配来尝试改进这个框架。</p><p id="9b14" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">潜在狄利克雷分配(LDA)是用于学习文本的抽象主题的自然语言处理(NLP)模型，也称为主题建模。LDA会将文档按主题分类，允许我们对评论进行分类，并找到宣传毒品销售的评论。</p><h1 id="3792" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">数据</h1><p id="f1d8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">该模型中使用的数据是以前收集的，用于Tableau中的分析。当时Soundcloud上排名前三的歌都是刮出来的:Playboi Carti的@MEH，Baby Jesus的Find My Way，Lil Mosey的Blueberry Faygo。该数据集有17048条评论，其特征为<em class="mc">评论</em>和<em class="mc">药物</em>。特征<em class="mc">评论</em>是刮掉的评论的文本，特征<em class="mc">是药物</em>包含用于广告毒品销售的帖子的1和用于其他帖子的0。关于数据收集的更多信息可参见<a class="ae lw" rel="noopener" target="_blank" href="/visualizing-sellers-of-illicit-narcotics-on-soundcloud-com-5b3bb9331b4b">此处</a>。</p><h1 id="63da" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">模型实现</h1><p id="616e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了开发LDA模型，使用了一个名为PyCaret的python库。PyCaret有很多机器学习算法的模块，但是使用的是NLP模块。更多关于PyCaret的信息可以在<a class="ae lw" rel="noopener" target="_blank" href="/announcing-pycaret-an-open-source-low-code-machine-learning-library-in-python-4a1f1aad8d46">这里</a>找到。</p><p id="1fbd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">首先，PyCaret nlp模块和Pandas被导入。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="58a1" class="mm kj it mi b gy mn mo l mp mq">from pycaret.nlp import *<br/>import pandas as pd</span></pre><p id="3dd6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后将数据集读入熊猫数据帧。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="458b" class="mm kj it mi b gy mn mo l mp mq">data = pd.read_csv('ldaData.csv')</span></pre><p id="c87f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">读入数据后，运行PyCaret设置函数。这个函数初始化PyCaret环境。会话id 123用于轻松再现环境。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="71e8" class="mm kj it mi b gy mn mo l mp mq">dataSetup = setup(data = data, target = 'comment', session_id = 123)</span></pre><p id="e2f4" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">制作LDA模型时，必须传递主题数。由于该模型的目标是将销售毒品的广告准确分类到一个主题中，PyCaret的模型调整与<em class="mc"> isDrugs </em>功能结合使用，以确定最佳主题数量。最佳主题数为32个，准确率为98.9%。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="3192" class="mm kj it mi b gy mn mo l mp mq">tuned_classification = tune_model(model = 'lda', supervised_target = 'isDrugs')</span></pre><p id="a7fe" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后使用32个主题创建了LDA模型。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="6438" class="mm kj it mi b gy mn mo l mp mq">lda = create_model('lda', num_topics = 32)</span></pre><p id="19ba" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后将模型分配给数据。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="7898" class="mm kj it mi b gy mn mo l mp mq">lda_results = assign_model(lda)</span></pre><p id="0205" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">宣传毒品销售的评论被归类为话题30。一些不相关的评论被分类到主题30中，但是这些评论通常可以通过过滤来过滤掉，其中特征<em class="mc"> Perc_Dominant_Topic </em>大于18% <em class="mc">。</em>我们可以看到这个话题中使用熊猫的一些评论。Snapchat或Instagram用户名已被审查。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="841a" class="mm kj it mi b gy mn mo l mp mq">lda_results.loc[(lda_results['Dominant_Topic'] == 'Topic 30') &amp; (lda_results['Perc_Dominant_Topic'] &gt; 0.18)]</span></pre><figure class="md me mf mg gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mr"><img src="../Images/ddca33a32e16f50f4d51399f14d80cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aX2pXz2Zu7rWxSqKX-tjjQ.png"/></div></div></figure><p id="643d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后为主题30绘制频率图。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="85f7" class="mm kj it mi b gy mn mo l mp mq">plot_model(lda, plot = 'frequency', topic_num = 'Topic 30')</span></pre><figure class="md me mf mg gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mz"><img src="../Images/ab69398db91b8fc39871d00ce62a5e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-Btey9fS2TWvpqTBkEKrg.png"/></div></div></figure><p id="0ca7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">话题30也可以被可视化为单词云。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="badc" class="mm kj it mi b gy mn mo l mp mq">plot_model(lda, plot = 'wordcloud', topic_num = 'Topic 30')</span></pre><figure class="md me mf mg gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi na"><img src="../Images/d5635be36f86d15bdf6407bba018db36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXx83mJ8EOoE_EdMmOx7MA.png"/></div></div></figure><h1 id="139c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">讨论</h1><p id="2cb2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">LDA似乎是一个很有前途的工具，可以用来识别Soundcloud上非法毒品广告的卖家。虽然该模型的性能相当不错，但额外的模型调整可以提高性能。这种模式也可以实现到原始框架中(可以在这里看到<a class="ae lw" rel="noopener" target="_blank" href="/identifying-sellers-of-illicit-narcotics-on-soundcloud-com-3ca0bece4307"/>)，并添加一个图形用户界面供执法部门使用。</p></div></div>    
</body>
</html>