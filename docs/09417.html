<html>
<head>
<title>Indian Dance Form Classification Using Monk AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用和尚艾进行印度舞蹈形态分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/indian-dance-form-classification-using-monk-ai-ec688b4236e9?source=collection_archive---------42-----------------------#2020-07-05">https://towardsdatascience.com/indian-dance-form-classification-using-monk-ai-ec688b4236e9?source=collection_archive---------42-----------------------#2020-07-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="845f" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这是由 HackerEarth 组织的深度学习竞赛，我在 5800 多名参与者中排名低于 70，数据增强在其中发挥了重要作用。</p></blockquote><h2 id="c17a" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">介绍</h2><p id="d00a" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">有如此多的印度古典舞形式，从图像中提取和理解动态人体姿态是一项具有挑战性的计算机视觉任务。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/dfee7385a3a617a342c0e6e0f121f128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*SIvOJLiQQjJEKEtL8bzxXQ.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">数据集的图像</p></figure><p id="d738" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">在这篇博文中，我将展示我用什么方法对图片进行分类，以及它把我带到了排行榜的哪个位置。</p><p id="2617" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">数据从<a class="ae mc" href="https://www.hackerearth.com/challenges/competitive/hackerearth-deep-learning-challenge-identify-dance-form/" rel="noopener ugc nofollow" target="_blank">黑客地球竞赛</a>页面下载，数据集由 364 幅图像组成，分属于 8 类，即<em class="js">曼尼普尔、巴拉塔纳蒂扬、奥迪西、卡塔卡里、卡萨克、萨特里亚、库奇普迪、</em>和<em class="js">莫希尼亚特坦</em>，每类约有 45 幅图像。</p><h2 id="8a5b" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">安装和下载数据</h2><p id="1ff0" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">让我们从设置 Monk 及其依赖项开始:</p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="b9f2" class="kp kq iq me b gy mi mj l mk ml">!git clone <a class="ae mc" href="https://github.com/Tessellate-Imaging/monk_v1.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Tessellate-Imaging/monk_v1.git</a><br/>!cd monk_v1/installation/Misc &amp;&amp; pip install -r requirements_kaggle.txt</span></pre><p id="7cad" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">因为我在 Kaggle 上运行这个笔记本，所以我使用了边栏中的“+ Add data”选项并上传了数据。数据将在中提供../输入。</p><h2 id="0e66" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">创造一个实验</h2><p id="4016" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">我已经创建了一个实验，对于这个任务，我使用了<strong class="jt ir"> mxnet 胶子后端。</strong></p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="e3e5" class="kp kq iq me b gy mi mj l mk ml">import os<br/>import sys<br/>sys.path.append("/kaggle/working/monk_v1/monk/");<br/>from gluon_prototype import prototype<br/>gtf = prototype(verbose=1);<br/>gtf.Prototype("Dance_Form", "Using-resnet152_v1");</span></pre><h1 id="2c10" class="mm kq iq bd kr mn mo mp ku mq mr ms kx mt mu mv lb mw mx my lf mz na nb lj nc bi translated">第一种方法</h1><h2 id="b772" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">模型选择和培训</h2><p id="eba1" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">在第一种方法中，我使用不同的模型进行训练，<strong class="jt ir"> resnet152_v1 </strong>给出了很好的结果，因此使用该模型进行训练。</p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="61b3" class="kp kq iq me b gy mi mj l mk ml">gtf.Default(dataset_path="../input/final3/folder/", <br/>            model_name="resnet152_v1", <br/>            freeze_base_network=False,<br/>            num_epochs=10);</span><span id="8bac" class="kp kq iq me b gy nd mj l mk ml">gtf.Train();</span></pre><p id="428f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">经过 10 个历元的训练，我得到了 80%的验证准确率。</p><h2 id="fa28" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">预言；预测；预告</h2><p id="f53a" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">通过这个模型，我预测了测试数据集中的类。</p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="dab7" class="kp kq iq me b gy mi mj l mk ml">list_test=os.listdir("../input/data-test/test/");<br/>from tqdm.notebook import tqdm<br/>combined = [];<br/>for i in tqdm(range(len(list_test))):<br/>    img_name = "../input/data-test/test/" + list_test[i];<br/>    predictions = gtf.Infer(img_name=img_name);<br/>    id_ = list_test[i]<br/>    label = predictions["predicted_class"];    <br/>    combined.append([id_, label]);</span><span id="063d" class="kp kq iq me b gy nd mj l mk ml">a = pd.DataFrame(combined, columns = ['Image', 'target']);<br/>a.to_csv("submission.csv", index=False);</span></pre><p id="4945" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">提交 submission.csv 文件后，我在排行榜上的排名低于 250，而在比赛中，大约有 5800+参与者。</p><p id="0bb5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">直到现在，我还没有使用任何数据增强技术，结果也不错。</p><p id="9c98" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">现在，在我的第二种方法中，让我们看看数据扩充对结果的影响。</p><h1 id="0e64" class="mm kq iq bd kr mn mo mp ku mq mr ms kx mt mu mv lb mw mx my lf mz na nb lj nc bi translated">第二种方法</h1><p id="3676" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated"><strong class="jt ir">数据扩充:- </strong>数据扩充是增加数据数量和多样性的过程。我们不是在收集新数据，而是在转换已经存在的数据。深度学习神经网络的效率也随着可用数据量的增加而增加。</p><p id="dbf3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">由于可用的数据非常少，所以我使用了数据扩充技术来转换数据。</p><p id="d1ec" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">对于数据扩充，我使用了 imgaug 库。</p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="7b46" class="kp kq iq me b gy mi mj l mk ml">from imgaug import augmenters as iaa<br/>import imgaug as ia<br/>import imageio</span><span id="c273" class="kp kq iq me b gy nd mj l mk ml">seq=iaa.Sequential([<br/>        iaa.Scale((224, 224)),<br/>        iaa.Sometimes(0.25, iaa.GaussianBlur(sigma=(0, 3.0))),<br/>        iaa.Fliplr(0.5),<br/>        iaa.Sharpen(alpha=(0, 1.0), lightness=(0.75, 1.5)),<br/>        iaa.Affine(rotate=(-20, 20), mode='symmetric'),<br/>        iaa.Sometimes(0.25,<br/>                      iaa.OneOf([iaa.Dropout(p=(0, 0.1)),<br/>                                 iaa.CoarseDropout(0.1,                                                                 size_percent=0.5)])),<br/>        iaa.AddToHueAndSaturation(value=(-10, 10), per_channel=True)<br/>    ])</span></pre><p id="5792" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">这是数据集中图像数量的两倍。数据增广后，我用同样的 resnet152_v1 模型进行训练。</p><pre class="lr ls lt lu gt md me mf mg aw mh bi"><span id="20cc" class="kp kq iq me b gy mi mj l mk ml">gtf.Default(dataset_path="../input/final3/folder/", <br/>            model_name="resnet152_v1", <br/>            freeze_base_network=False,<br/>            num_epochs=10);</span><span id="d847" class="kp kq iq me b gy nd mj l mk ml">gtf.Train();</span></pre><p id="7ef8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">经过 10 个历元的训练，我得到了 94%的验证准确率。</p><p id="5e10" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">使用这个模型，我预测了测试数据集中的类，并提交了 submission.csv 文件。这次我的排名在 70 以下，比上次好很多。</p><h2 id="a632" class="kp kq iq bd kr ks kt dn ku kv kw dp kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">结论</h2><p id="9745" class="pw-post-body-paragraph jq jr iq jt b ju ll jw jx jy lm ka kb ky ln ke kf lc lo ki kj lg lp km kn ko ij bi translated">因此，从这场比赛中，我们可以看到数据增强如何有助于提高模型的性能。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="3197" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated">本文中的所有代码都位于这个 Github 链接上:</p><p id="092c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb ky kd ke kf lc kh ki kj lg kl km kn ko ij bi translated"><a class="ae mc" href="https://github.com/shubham7169/MonkAI/blob/master/Dance_Form_Classification.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Shu bham 7169/MonkAI/blob/master/Dance _ Form _ class ification . ipynb</a></p></div></div>    
</body>
</html>