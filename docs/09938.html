<html>
<head>
<title>Doing Your Statistics Homework With Python: Analyzing Categorical Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 做统计作业:分析分类数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/doing-your-statistics-homework-with-python-part-1-b0d1f939e11?source=collection_archive---------73-----------------------#2020-07-13">https://towardsdatascience.com/doing-your-statistics-homework-with-python-part-1-b0d1f939e11?source=collection_archive---------73-----------------------#2020-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e457" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">同时提高你的统计和编程水平。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/e459d240adfdde60775939c9cbbba201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*oQoEO6WQJJmf4ChFwcmjAg.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">在<a class="ae kr" href="https://unsplash.com/s/photos/roller-coaster?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kr" href="https://unsplash.com/@augustinewong?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">黄圣贤</a>拍摄的照片</p></figure><p id="db61" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在我教学的最后一年，我同时教授三门 AP 系统课程——AP 统计学和 AP 计算机科学原理在那一年对我来说都是新的，但我在前一年已经教了 AP 计算机科学 A。我冒了一次险，花时间学习如何用 Python 做统计，试图在我的两个预科生之间建立一个重叠。最终，我得到了回报:我找到了新的激情，现在正在从事数据科学方面的职业。</p><p id="5c24" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这篇博客是致力于使用 Python 从头开始解决基本的 AP 风格的统计问题的一系列独立文章中的第一篇。我会尽量少用专门的库。重要的是要记住，只有部分统计管道可以(或者应该)自动化，计算特定值只是解决问题的一个步骤——解释和应用结果才是最终目标。许多学生倾向于沉迷于数字运算，以至于看不到更大的图景。通过用代码自动化计算，我们可以专注于那些计算实际上告诉我们什么。</p><p id="2e87" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">请记住，这篇文章不是对 Python 的介绍，也不是对统计学的介绍。相反，它是一个融合两者的介绍，以增强您对两者的理解。它可以被学生、老师或自学者使用。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="e2ed" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">分析单个分类变量</h1><p id="e049" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">这里有一个涉及分类变量的 AP 统计问题的例子:</p><h2 id="d414" class="ms lw iq bd lx mt mu dn mb mv mw dp mf lb mx my mh lf mz na mj lj nb nc ml nd bi translated">例题:分析分类变量的分布</h2><p id="1f1f" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">这是在<a class="ae kr" href="https://rcdb.com/census.htm" rel="noopener ugc nofollow" target="_blank">过山车数据库</a>中找到的过山车的全球分布</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/a3b5c60727d675f16710e398958c7832.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/0*E2YIYoXdBh30srGd"/></div></figure><ol class=""><li id="4661" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">根据这张表，世界上总共有多少过山车？</li><li id="97df" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">(a)创建这些数据的相对频率表。用百分比给出你的答案，四舍五入到小数点后一位。你的百分比加起来是 100 吗？为什么或为什么不？</li><li id="765f" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">北美或南美有百分之多少的过山车？</li><li id="edb4" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">构建这些数据的条形图和饼图。不要忘记包括标签和描述性的标题！</li></ol><p id="c5f5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们将单独解决这些问题。我们的方法将是创建一组函数，我们可以用它们来解决这种类型的问题，而不仅仅是这个问题。我们的目标不是解决这个单独的问题，而是理解看起来像这样的问题一般是如何解决的。</p><p id="4080" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">首先，我们需要某种对象将我们的数据与我们的级别联系起来。我们可以用两个<code class="fe nu nv nw nx b">list</code>对象来完成这个任务(这绝对没有错)，但是我将利用我最喜欢的 Python 对象之一:一个<code class="fe nu nv nw nx b">dict</code>。出于各种原因，字典是很好的，许多库比如<code class="fe nu nv nw nx b">pandas</code>允许你在构造更复杂的对象比如<code class="fe nu nv nw nx b">DataFrame</code>时传递字典。</p><p id="486d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是我们将要使用的字典:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="5419" class="ms lw iq nx b gy oc od l oe of">coasters = {'Africa':90, 'Asia':2649, 'Australia':27, 'Europe':1329, 'North America':905, 'South America':175}</span></pre><p id="20eb" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">特别是，我喜欢如何将<code class="fe nu nv nw nx b">value</code>(频率)与<code class="fe nu nv nw nx b">key</code>(大陆)直接联系起来。请记住，随着我们的进展，我们的实现将使用<code class="fe nu nv nw nx b">dict</code>的方法和属性，因此如果您不熟悉这种类型的对象，您可能希望在继续之前<a class="ae kr" href="https://www.w3schools.com/python/python_dictionaries.asp" rel="noopener ugc nofollow" target="_blank">查看一下</a> <code class="fe nu nv nw nx b"><a class="ae kr" href="https://www.w3schools.com/python/python_dictionaries.asp" rel="noopener ugc nofollow" target="_blank">dict</a></code> <a class="ae kr" href="https://www.w3schools.com/python/python_dictionaries.asp" rel="noopener ugc nofollow" target="_blank">类型</a>。</p><p id="f80c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在这一点上，值得检查并反复检查我的字典中的值是否正确——如果它们是正确的，这是我们唯一需要做的一次。(相比之下，你在计算器中输入一长串数字，却发现漏掉了其中一个数字。)</p><p id="e5b7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">类似于表是如何分成左列(洲名)和右列(过山车数量)的，我们的字典很自然地把洲分成<code class="fe nu nv nw nx b">keys</code>，频率分成<code class="fe nu nv nw nx b">values</code>，表中的每一个“行”都是自己的键值对。</p><p id="1bf5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">进入我们的第一个问题！</p><h2 id="9011" class="ms lw iq bd lx mt mu dn mb mv mw dp mf lb mx my mh lf mz na mj lj nb nc ml nd bi translated">1.世界上总共有多少过山车？</h2><p id="02a1" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">要手动解决这个问题，我们可以查看我们的表格，将右侧列中的所有数字相加:</p><p id="43e1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe nu nv nw nx b">90 + 2649 + 27 + 1329 + 905 + 175 = 5175</code></p><p id="9f12" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">不幸的是，这种方法不能推广到其他问题。如果给我另一个计数表，我将不得不拿出我的 TI-84 Plus(以真正的 AP 统计方式)并从头开始输入所有的数字，希望我不会出现任何打字错误或意外错过某个数字。对于这么小的数据集，这可能不是问题，但随着类别数量的增加，我用胖手指拨弄数字键盘的可能性也会增加。</p><p id="8201" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">相反，我们可以在 Python 中编写一个函数，该函数将接受我们的 dictionary 对象(表示上表)，并返回右列中计数的总和(由字典中的<code class="fe nu nv nw nx b">values</code>表示):</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="7dd5" class="ms lw iq nx b gy oc od l oe of">def total_values(dictionary):<br/>    return sum(dictionary.values())</span></pre><p id="b186" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">现在我们可以处理任何类别在左列(我们的<code class="fe nu nv nw nx b">keys</code>)而计数在右列(我们的<code class="fe nu nv nw nx b">values</code>)的<em class="nt">表。</em></p><p id="17f2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">让我们看看当我们将<code class="fe nu nv nw nx b">coasters</code>字典传递给 total_values 函数时会得到什么:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="e551" class="ms lw iq nx b gy oc od l oe of">print('There are', total_values(coasters), 'rollercoasters in the world.')</span></pre><p id="5830" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">输出:<code class="fe nu nv nw nx b">There are 5175 rollercoasters in the world.</code></p><h2 id="4905" class="ms lw iq bd lx mt mu dn mb mv mw dp mf lb mx my mh lf mz na mj lj nb nc ml nd bi translated">2.(a)创建这些数据的相对频率表。用百分比给出你的频率。</h2><p id="c7de" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">为了解决这个问题，我们需要做以下事情:</p><ol class=""><li id="8f07" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated">计算世界上过山车的总数(幸运的是，这是问题 1)。</li><li id="6c0b" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">将每个类别中的值除以世界上过山车的总数。</li><li id="4f1d" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">将每个值乘以 100。</li><li id="5a3f" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated">将输出格式化成一个漂亮的表格。</li></ol><p id="5239" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们已经写了一个函数来处理#1，它返回我们将在#2 中使用的值。对于#3，我想保持函数的灵活性，所以我给自己一个选项来打开和关闭百分比。我还希望能够指定精度，因为问题明确地告诉我要舍入到特定的小数位数。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="3f38" class="ms lw iq nx b gy oc od l oe of">def relative_frequencies(dictionary, percents=False, precision=1):<br/>    total = total_values(dictionary)<br/>    rel_freq = {}</span><span id="101d" class="ms lw iq nx b gy og od l oe of">    for key, value in dictionary.items():<br/>        rel_freq[key] = value / total</span><span id="a9ec" class="ms lw iq nx b gy og od l oe of">    if percents:<br/>        rel_freq[key] = round(rel_freq[key] * 100, precision)</span><span id="09aa" class="ms lw iq nx b gy og od l oe of">    return rel_freq</span></pre><p id="eb3b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">首先，我们依靠我们写的函数找到<code class="fe nu nv nw nx b">values</code>的<code class="fe nu nv nw nx b">total</code>。接下来，我们创建一个新的字典<code class="fe nu nv nw nx b">rel_freq</code>来保存相对频率。对于每个键-值对，我们将向<code class="fe nu nv nw nx b">rel_freq</code>添加相同的键，但是原始的<code class="fe nu nv nw nx b">value</code>除以<code class="fe nu nv nw nx b">total</code>。如果<code class="fe nu nv nw nx b">percent</code>已被指定为<code class="fe nu nv nw nx b">True</code>，我们将这些比例转换为给定<code class="fe nu nv nw nx b">precision</code>(或默认为 1)的百分比。将这种方法与必须在计算器上反复手动除法进行比较。</p><p id="6186" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">接下来，我们有一个函数将打印我们的相对频率表。花大量时间编写这个函数相当于通过用尺子和彩笔仔细画一个表来拖延你的统计作业所需要的繁重的智力劳动。显然，这是我今天所能做的最好的投资。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="2fa4" class="ms lw iq nx b gy oc od l oe of">def display_dictionary(dictionary, title='Table Title', left_header='Category', right_header='Values'):<br/>    max_len = max(max(len(value) for value in dictionary.keys()),  <br/>                  len(left_header))<br/>    spaces = {key:(max_len — len(key)) for key, value in dictionary.items()}<br/>    header = left_header + ' '*(2 + max_len — len(left_header)) + '| '+ right_header<br/>    bar = '-' * max(len(title), len(header))<br/>    <br/>    print(title + '\n' + bar + '\n' + header + '\n' + bar)<br/>    <br/>    for key, value in dictionary.items():<br/>        print(key, ' '*(spaces[key]), '|', value)</span></pre><p id="4e4e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">对于问题 2 的(b)部分(查看百分比之和是否等于 100)，我们可以再次重用我们的<code class="fe nu nv nw nx b">total_values</code>函数。</p><h2 id="d1cb" class="ms lw iq bd lx mt mu dn mb mv mw dp mf lb mx my mh lf mz na mj lj nb nc ml nd bi translated">3.北美或南美有百分之多少的过山车？</h2><p id="8a6b" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">为了完成这项任务，我们将创建一个函数，对列表中对应于类别的值进行求和。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="2f3f" class="ms lw iq nx b gy oc od l oe of">def sum_from_list(dictionary, categories):<br/>    return sum(dictionary[cat] for cat in categories)</span></pre><p id="6b05" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">尽管默认情况下这个函数并不完全符合我们的要求(它只是对值求和，并不返回百分比)，但是我们可以通过仔细考虑如何与它交互来回答我们的问题:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="7db1" class="ms lw iq nx b gy oc od l oe of">sum_from_list(relative_frequencies(coasters, percents=True, precision=2), ['North America', 'South America'])</span></pre><h2 id="6120" class="ms lw iq bd lx mt mu dn mb mv mw dp mf lb mx my mh lf mz na mj lj nb nc ml nd bi translated">4.使用你在第 2 部分中找到的相对频率，构建一个条形图和一个饼图。不要忘记包括标签和描述性的标题！</h2><p id="07e8" class="pw-post-body-paragraph ks kt iq ku b kv mn jr kx ky mo ju la lb mp ld le lf mq lh li lj mr ll lm ln ij bi translated">现在，使用 Python 比手工做这些真正的优势是:漂亮的图表。学习如何用 Python 制作图表实际上是引导我发现<code class="fe nu nv nw nx b">matplotlib</code>并打开数据科学大门的原因，所以这个函数在我心中占有特殊的位置。</p><p id="6dd6" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们将在一个<code class="fe nu nv nw nx b">Axes</code>(1 行，2 列)排列的<code class="fe nu nv nw nx b">Figure</code>上绘制这两个图。左边的<code class="fe nu nv nw nx b">Axes</code>是条形图，右边的<code class="fe nu nv nw nx b">Axes</code>是饼图。深入研究每一行代码是一个值得自己发表许多博客文章的主题，所以我只展示代码，没有太多评论。特别是，我编写了这个函数来接受任何<code class="fe nu nv nw nx b">dictionary</code>(假设包含频率)、图表的<code class="fe nu nv nw nx b">title</code>、分类变量的名称、y 轴的标签以及频率是否应该转换为相对频率。</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="6454" class="ms lw iq nx b gy oc od l oe of">def display_bar_and_pie(dictionary, title, categorical_name, ylabel='Frequency', relative_frequency=False, percent=False):<br/>    if relative_frequency:<br/>        rel_freqs = relative_frequencies(dictionary)<br/>        categories = list(rel_freqs.keys())<br/>        values = list(rel_freqs.values())<br/>        ylabel = 'Relative Frequency'</span><span id="db8d" class="ms lw iq nx b gy og od l oe of">        if percent:<br/>            ylabel += '(%)'<br/>            values = [val * 100 for val in values]</span><span id="2b3c" class="ms lw iq nx b gy og od l oe of">    else:<br/>        categories = list(dictionary.keys())<br/>        values = list(dictionary.values())</span><span id="d906" class="ms lw iq nx b gy og od l oe of">    # create two subplots<br/>    fig, (ax_bar, ax_pie) = plt.subplots(nrows=1, ncols=2, figsize=(15, 5))</span><span id="7e5d" class="ms lw iq nx b gy og od l oe of">    # create the bar chart<br/>    ax_bar = sns.barplot(x=categories, y=values, ax=ax_bar)<br/>    ax_bar.set_xlabel('Continent')<br/>    ax_bar.set_xticklabels(categories, rotation=45)<br/>    ax_bar.set_ylabel(ylabel)<br/>   <br/>    # create the pie chart<br/>    ax_pie.pie(values, labels=categories, autopct='%1.1f')<br/>    ax_pie.axis('equal')<br/>    plt.suptitle(title, size=24)<br/>    plt.show()</span></pre><p id="3235" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">我们做到了！现在我们准备彻底上交这个问题:</p><pre class="kg kh ki kj gt ny nx nz oa aw ob bi"><span id="c400" class="ms lw iq nx b gy oc od l oe of">print('1. There are', total_values(coasters), 'rollercoasters in the world.\n')</span><span id="670d" class="ms lw iq nx b gy og od l oe of">print('\n2. a.')<br/>display_dictionary(dictionary=relative_frequencies(coasters, percents=True, precision=2), title=’Relative Frequencies of Rollercoasters by Continent’, left_header=’Continent’, right_header=’Percent of Rollercoasters’)</span><span id="c2fd" class="ms lw iq nx b gy og od l oe of">print('\n2. b. The total of the percents is {}%. If this does not equal 100, it is due to rounding errors.\n'.format(<br/>    total_percents(relative_frequencies(coasters, percents=True, precision=2))))</span><span id="71ea" class="ms lw iq nx b gy og od l oe of">print('\n3. {:.1f}% of rollercoasters are in North America or South America.\n'.format( sum_from_list(relative_frequencies(coasters, percents=True, precision=2), ['North America', ‘South America’])))</span><span id="a416" class="ms lw iq nx b gy og od l oe of">print('\n4. Below are a bar chart and pie chart of the relative frequencies.')</span><span id="c278" class="ms lw iq nx b gy og od l oe of">display_bar_and_pie(coasters, 'Rollercoasters of the World', 'Continent', relative_frequency=True, percent=True)</span></pre><p id="582b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">虽然编写这段代码可能比简单地手工处理数字要花更多的时间，但是我们现在有代码可以为我们解决这种类型的问题。笔记本里有一个奖金问题，可以在我的 github 上找到<a class="ae kr" href="https://github.com/danhales/stats-hw-with-python-categorical-variables" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6dbf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">享受你的数字运算！</p></div></div>    
</body>
</html>