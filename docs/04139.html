<html>
<head>
<title>Doing Data Science with Python’s Built-in Statistics Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的内置统计库进行数据科学研究</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/doing-data-science-with-pythons-built-in-statistics-library-72cfb2663074?source=collection_archive---------43-----------------------#2020-04-15">https://towardsdatascience.com/doing-data-science-with-pythons-built-in-statistics-library-72cfb2663074?source=collection_archive---------43-----------------------#2020-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bac4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">python内置统计库之旅</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f172ab8150573f45e6fdfa6085def8e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ngwCZvORFfbWDWKRKv_Dg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">手动计算组中值</p></figure><p id="64d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让代码在本地运行，然后看着它在生产中失败，这是我们都能体会到的。尤其是当生产环境不完全在我们的控制之下时(例如:AWS Lambdas，Elastic Beanstalk…)。</p><p id="7e98" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">出于这个原因，我相信除非必要，否则不要引入依赖。如果一个标准的库可以实现一个结果，就没有必要引入一些花哨的东西。</p><p id="a5ad" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然大多数数据科学家都热衷于Scipy，但Python在其标准库中包含了许多统计函数。问题是这是否足够。</p><p id="8d2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们浏览一下Python的标准统计库。我们将导入一个数据集来使用，然后遍历<code class="fe lu lv lw lx b">statistics</code>中的函数。</p></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="e216" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">设置</h1><p id="3e0d" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">导入统计库本身。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="670e" class="ng mg it lx b gy nh ni l nj nk">import statistics</span></pre><p id="79ae" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后导入我们将要使用的数据集，并将其放入数据帧中。数据帧与<code class="fe lu lv lw lx b">statistics</code>无关，但让我们更容易看到。</p><p id="d8b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">导入sklearn的葡萄酒数据集。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="a844" class="ng mg it lx b gy nh ni l nj nk">import pandas as pd</span><span id="8b15" class="ng mg it lx b gy nl ni l nj nk">from sklearn.datasets import load_wine<br/>dataset = load_wine()</span><span id="90ab" class="ng mg it lx b gy nl ni l nj nk">df = pd.DataFrame(dataset['data'], columns=dataset['feature_names'])<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/a7adc3628cacf53bfb83b1ebc46a4e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8oVFMCQB9X_Mum5YBXx8OA.png"/></div></div></figure></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="b621" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">功能</h1><h2 id="099a" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">平均</h2><p id="4a31" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">算术平均值。一个集合中值的总和，除以该集合中值的个数。虽然它是最广为人知的，但它只是一套价值观中心的一个衡量标准。</p><p id="7d8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果数据不平衡，也可能会产生很大的误导。例如，让我们比较“苹果酸”在数据集中的分布及其平均值。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="3226" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.mean(df.malic_acid),2<br/>)<br/>#=&gt; 2.34</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/511d300a9e942972bdaedffa421d815d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0EFKs--C0UsYBMIWKk3qXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.hist('苹果酸')</p></figure><p id="5e92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意平均值是如何被高端的一些异常值向上倾斜的。</p><h2 id="3fe2" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">调和平均值</h2><p id="e77b" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">思考调和平均值的一种快捷方式是将其视为保守平均值，为较低的输入值赋予额外的权重。</p><p id="3486" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在评估机器学习模型时，我们一直使用调和平均值。f1分数是精确度和召回率的调和平均值。</p><p id="ab8f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在精度为0.65、召回率为0.8的模型评估场景中，我们可以使用<code class="fe lu lv lw lx b">harmonic_mean</code>来计算f1分数。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="2d8e" class="ng mg it lx b gy nh ni l nj nk">precision = 0.65<br/>recall = 0.8</span><span id="bd91" class="ng mg it lx b gy nl ni l nj nk">round(<br/>    statistics.harmonic_mean([precision, recall]),2<br/>)<br/>#=&gt; 0.72</span></pre><p id="e6f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也就是说，如果我们一开始没有使用sklearn，我们就必须编写自己的函数来计算精度和召回。</p><h2 id="2063" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">中位数</h2><p id="e858" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">中位数是一组有序数据的中间值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/eb504418e0d42e254fd653927b0b04d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kO_jyFqSsIY9XRsjKRndA.png"/></div></div></figure><p id="0c75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">中位数很有趣，因为它不会因为一个集合中的几个大值或小值而向上倾斜。由于这个原因，我一直认为除了算术平均值之外，看一下也是很重要的。</p><p id="7349" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Median返回具有奇数个值的集合的中间数，如果该集合具有偶数个值，则取两个中间值的平均值。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="7bac" class="ng mg it lx b gy nh ni l nj nk">li = [-3,-1,0,1,2,5,100]<br/>statistics.median(li)<br/>#=&gt; 1</span><span id="34ec" class="ng mg it lx b gy nl ni l nj nk">li2 = [-3,-1,0,1,2,5,100,101]<br/>statistics.median(li2)<br/>#=&gt; 1.5</span></pre><p id="55a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再来看看“苹果酸”,这样我们就能看出平均值和中间值的区别。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="46ef" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.median(df.malic_acid), 2<br/>)<br/>#=&gt; 1.87</span></pre><p id="250f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为参考，平均值为2.34。</p><h2 id="e264" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">中值下限</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/3fcf59ce2b79ccdf0cf7d890a3452b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjYTHaOZL3UqqE6Ld0D-bg.png"/></div></div></figure><p id="58d9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几乎与中位数完全相同，但如果集合中的值为奇数，则采用中间较低的数字。</p><h2 id="7868" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">中值高</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/9c57f653d380718868ed187828c6337d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSI8dunKKlGJ4TtbXQcCvQ.png"/></div></div></figure><p id="d674" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果集合有奇数个值，则取中间较高的数。</p><h2 id="33db" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">中位数分组</h2><p id="dcf3" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">查找连续类的中值，其中每个类的宽度等于间隔的大小(默认情况下为<code class="fe lu lv lw lx b">interval=1</code>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f172ab8150573f45e6fdfa6085def8e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ngwCZvORFfbWDWKRKv_Dg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">下面的例子用手来说明。</p></figure><p id="efd2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在上面举例说明了一个对应于我们在下面使用的函数的数据。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="4d7f" class="ng mg it lx b gy nh ni l nj nk">statistics.median_grouped([1, 3, 3, 5, 7], interval=1)<br/>#=&gt; 3.25</span></pre><p id="a9a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，使用该函数比我们自己计算要容易得多。</p><h2 id="332a" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">方式</h2><p id="d84b" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">返回集合中最频繁出现的数据点。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="6b09" class="ng mg it lx b gy nh ni l nj nk">li = ['cat', 'dog', 'dog', 'fish']<br/>statistics.mode(li)<br/>#=&gt; 'dog'</span></pre><h2 id="fc3a" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">总体标准差</h2><p id="07a7" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">对总体中数据分布的度量。</p><p id="84a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果数据分布很广，该值将很大，如果数据围绕一个点分组，该值将很小。它是以方差的平方根来计算的。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="b57e" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.pstdev(df.alcohol),2<br/>)<br/>#=&gt; 0.81</span></pre><p id="aca6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">0.81告诉我们数据高度集中。如果我们把它形象化成柱状图，看到酒精浓度完全在11到15之间，那就更明显了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/2e722eaf88437f6050f6e15b9bbdb578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Esf_AtXiETrKt8ijV2m6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">df.hist('酒精')</p></figure><h2 id="4441" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">总体方差</h2><p id="b103" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">数据传播的另一个衡量标准。</p><p id="c084" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是请注意，报告数据的标准偏差稍微更常见，因为它与平均值更密切相关。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="cf9c" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.pvariance(df.alcohol),2<br/>)<br/>#=&gt; 0.66</span></pre><h2 id="c3e7" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">样品标准偏差</h2><p id="677e" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">除了我们使用<code class="fe lu lv lw lx b">n-1</code>而不是<code class="fe lu lv lw lx b">N</code>作为分母之外，它的计算几乎与总体标准差完全相同。可汗学院有一个很棒的视频介绍我们为什么要这么做，这里是<a class="ae od" href="https://www.khanacademy.org/math/ap-statistics/summarizing-quantitative-data-ap/more-standard-deviation/v/review-and-intuition-why-we-divide-by-n-1-for-the-unbiased-sample-variance" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="2343" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在计算样本而不是总体的标准差时使用这个。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="8975" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.stdev(df.alcohol[:10]),2<br/>)<br/>#=&gt; 0.58</span></pre><h2 id="dc8a" class="ng mg it bd mh nn no dn ml np nq dp mp lh nr ns mr ll nt nu mt lp nv nw mv nx bi translated">采样离散</h2><p id="8d11" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们计算样本而不是总体的方差。<code class="fe lu lv lw lx b">n-1</code> vs <code class="fe lu lv lw lx b">N</code>在这里同样适用。</p><pre class="kj kk kl km gt nc lx nd ne aw nf bi"><span id="4b9d" class="ng mg it lx b gy nh ni l nj nk">round(<br/>    statistics.variance(df.alcohol[:10]),2<br/>)<br/>#=&gt; 0.33</span></pre></div><div class="ab cl ly lz hx ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="im in io ip iq"><h1 id="a4c6" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">结论</h1><p id="e122" class="pw-post-body-paragraph ky kz it la b lb mx ju ld le my jx lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们在<code class="fe lu lv lw lx b">statistics</code>中有一些有用的函数，但是很明显<code class="fe lu lv lw lx b">numpy</code>和<code class="fe lu lv lw lx b">pandas</code>把它打得落花流水。也就是说，理解Python开箱即用的能力并没有坏处。</p><p id="0e1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不是每个计算统计数据的人都在做数据科学，对于一个应用程序来说，均值和标准差可能已经足够了。</p><p id="1167" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也就是说，Python 3.8增加了一些我没有在这里介绍的新功能，所以谁知道他们将来会增加什么。</p></div></div>    
</body>
</html>