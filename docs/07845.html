<html>
<head>
<title>Formula 1 Race Predictor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一级方程式赛车预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/formula-1-race-predictor-5d4bfae887da?source=collection_archive---------6-----------------------#2020-06-11">https://towardsdatascience.com/formula-1-race-predictor-5d4bfae887da?source=collection_archive---------6-----------------------#2020-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bb70" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">预测下一届F1大奖赛冠军的机器学习方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/794c82a687a716b51ff2eaa85a6fd759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdEafnxcpRUuWi5aAOIteA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/s/photos/formula-one-pit-stop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>提供</p></figure><p id="a534" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我还是个孩子的时候，我大部分时间都和我的祖父母在一起。我的祖父是一个超级F1迷，所以每当大奖赛开始时，我们都会一起坐在沙发上，对着电视欢呼尖叫，直到比赛结束。</p><p id="0e49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">多年后，我仍然对这项令人难以置信的运动充满热情，所以我认为预测某个车手赢得大奖赛的可能性并将其与博彩公司的赔率进行比较会很有趣。该项目将分为三个部分:</p><ul class=""><li id="2b5f" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">数据收集</li><li id="0f75" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">数据分析</li><li id="d5a3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">ML建模</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="8dc6" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated"><strong class="ak"> 1。数据收集</strong></h1><p id="03e1" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在第一部分中，我将解释我是如何收集所有的数据以及数据背后的决策过程。</p><h2 id="07a9" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated"><strong class="ak">数据帧_1:比赛</strong></h2><p id="a1b9" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">对于我的数据挖掘，我找到了两个很好的来源:Ergast F1数据库和官方的一级方程式网站；它们基本上有相同的数据，但我使用了两者以获得更高的准确性和完整性。</p><p id="4cc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的第一个dataframe包含了从1950年到2019年所有锦标赛和比赛的信息，包括它们的位置和维基百科页面的链接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/2baee8f3605ca41ba63d5bd5d9e24f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fr2Zp-YnP9vgz_OkY12O8g.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="6892" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated"><strong class="ak">数据帧_2:结果</strong></h2><p id="9ac6" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">对于我的第二个数据帧，我遍历了每一年和每一轮的比赛文件，以查询<a class="ae kv" href="https://ergast.com/mrd/" rel="noopener ugc nofollow" target="_blank"> Ergast API </a>并获得关于所有车手成绩的信息。我包括了一些特征，如每位车手的发车位置和完赛位置，他们的车队，以及其他不太相关的变量，如出生日期、国籍和完赛状态，我将在后面探讨这些特征，以检查车手的年龄和他们的表现之间是否存在相关性，在他们的祖国比赛是否会有任何心理影响，或者一些车手是否比其他人更容易发生车祸。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/e2a20df268be7bac6cad6a7e0d76ee2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qn5QpqLAy1z5ZEm5ekrgTA.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="1b7d" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated"><strong class="ak">数据帧_3:驾驶员排名</strong></h2><p id="79bc" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在锦标赛中，积分是根据车手和车队完成比赛的位置来决定的。只有前10名车手获得积分，获胜者将获得25分。<a class="ae kv" href="https://ergast.com/mrd/" rel="noopener ugc nofollow" target="_blank"> Ergast API </a>提供冠军赛中每个车手和车队的积分、获胜次数和名次。因为积分是在比赛后授予的，所以我必须创建一个查找函数来转移同一锦标赛中以前比赛的积分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/1ded71dbc7812b321d32bd827b0e763e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cKgBbKPzM2imRL7zC-jEkw.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="5431" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">DataFrame_4:构造函数排名</h2><p id="6e17" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">车队总冠军是在1958年首次颁发的，所以没有那一年之前的数据。数据挖掘过程与车手积分榜相同，最终在比赛前应用相同的查找功能来获取数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/c346a9beb4191f93e4bfd2887716535a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_XYoKPU_xJ1fg-wxspOlA.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="6b98" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">DataFrame_5:合格</h2><p id="5404" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">获得合格时间数据是最棘手的部分，主要是因为<a class="ae kv" href="https://ergast.com/mrd/" rel="noopener ugc nofollow" target="_blank"> Ergast </a>数据存储库中的数据有一些漏洞，也因为合格规则在这些年里变化很大。自2006年以来，排位赛在周六下午举行，采用三阶段“淘汰赛”制度，赛车试图创造自己的最快圈速。过去，资格认证只包括一次或两次会议，导致我的数据框中缺少数据。我决定只考虑每位车手的最佳排位赛时间，不管那一年举行了多少场排位赛。最佳排位赛时间反映在发车位置上，所以我稍后会计算第一辆符合条件的赛车和其他赛车之间的累计时间差异，希望这可以让我知道一辆赛车比其他赛车快多少。</p><p id="f010" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于<a class="ae kv" href="https://ergast.com/mrd/" rel="noopener ugc nofollow" target="_blank"> Ergast API </a>有一些缺失的数据，我不得不使用BeautifulSoup抓取官方<a class="ae kv" href="https://www.formula1.com/" rel="noopener ugc nofollow" target="_blank"> F1网站</a>并为每条赛道添加在发车区页面中找到的表格。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/db90fcc2324cc61cfb5635d71203a138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJ6qcyulgYDcis3jCkSumw.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="36cc" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">DataFrame_6:天气</h2><p id="a421" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">f1中的天气对轮胎的选择、车手的表现以及车队的整体策略都有着重要的影响。我决定遍历races_df中附加的每个比赛的维基百科链接，并抓取天气预报。由于wikipedia页面没有一致的html结构，我需要查看一些不同的表，即使在这一点上，我仍然有许多丢失的值。但是，我注意到我可以在不同语言的相应页面中找到剩余的信息。然后，我使用selenium点击每个链接的意大利语页面，并添加缺失的天气数据。最终，我创建了一本字典来对天气预报进行分类，并绘制出我的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/224f9ba48a7da97993d7d772af3c8a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUE6-J7hRe1ZlSMbicJErg.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="ec54" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">2.数据分析</h1><p id="9310" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">第一届世界车手锦标赛于1950年在英国银石赛道举行，只有7场比赛。几年来，每个赛季的大奖赛次数各不相同，最近几个赛季平均有19场比赛。比赛的地点也随着时间的推移而变化，这取决于赛道的适用性和其他财务原因。目前，只有意大利和英国大奖赛是自1950年以来唯一没有错过一个赛季的赛事。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/dc804e83954cbe8c935e50bf1a4fe2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeUiKKvjclX0xTbDG78X2Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">历年来最受欢迎的电路</p></figure><p id="0281" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">渐渐地，越来越多的非欧洲赛道被添加到F1锦标赛的合适主办城市名单中。这张地图显示了自赛季开始以来举行的所有大奖赛的地点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/c951eeabdff982976c528f1047fade58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E30F4oLNwQuT6s3w16pvjw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自1950年以来的大奖赛地点</p></figure><h2 id="66f7" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">杆位有多重要？</h2><p id="6b25" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在资格赛阶段，车手们试图在赛道上创造自己的最快时间，发车位置由车手的最佳单圈成绩决定，最快的是杆位。在杆位起步在超车更加困难的赛道上是至关重要的，除此之外，还有一个优势是可以在前方几米的正常赛道上起步，这条赛道通常更干净，抓地力更强。下图显示了在一些最受欢迎的赛道上以杆位起跑和赢得比赛之间的关系。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/10d32ef349f8764e35ed8741f3ab879b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hxGVurr7v3u28_xcbJOu2g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">P1-Q1相关</p></figure><h2 id="c87c" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">赛车在你的祖国有什么影响？</h2><p id="01b9" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在你的祖国比赛的优势可以归因于支持者对车手的心理影响，以及在熟悉的情况下在家附近驾驶。条形图显示了这些年来登上领奖台的一些车手的国籍，以及他们在所有赛道比赛中获胜的百分比。尽管没有显示出明显的差异，但我们可以注意到，甚至心理因素也在赢得比赛的可能性中发挥了作用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/a1be3238fe475fd356c3cca979b4c176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRgkKgzABcx2INOTII20rg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按国籍划分的获奖者</p></figure><h2 id="3084" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">最危险的电路</h2><p id="bba7" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">近年来，一些电路布局已经过重新设计，以满足更严格的安全要求。目前，大多数赛道都是专门为比赛建造的，以避免长而快的直道或危险的弯道。然而，一些比赛仍然在街道赛道上举行，如摩纳哥大奖赛，尽管不符合最新的严格措施，但仍主要因其名气和历史而被使用。下面的树形图按照事故或碰撞的数量显示了一些最受欢迎的赛道。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/23d18780bfd0c10b853a4802d1b2a126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nw-ONcKxO919SewH6QYJA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">事故最多的危险线路</p></figure><h2 id="72b0" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">哪些车队出现了更多的汽车故障？</h2><p id="8a52" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">条形图显示了在过去几个赛季中参加比赛的车队在这些年中经历了最多的汽车问题，包括发动机故障、刹车、悬挂或传动系统问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/6d57137b36e734406bb2843e07b9a863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qtgFGosdaRhAvPMiaO2nqw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">团队见证的汽车问题比率</p></figure><h2 id="1ffb" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">谁更容易撞车？</h2><p id="9197" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">一级方程式赛车的最高时速可达375公里(233英里/小时)，因此撞车事故最终会终止车手的比赛。下面的图表显示了过去两个赛季中参加比赛的一些车手的撞车率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/043a570389d34ace09e87f9080c54c5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kAbbrpIig879kId2rqLmA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2018年至2019年驾驶员的车祸率</p></figure><h2 id="be7a" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">从快40岁的人到青少年明星</h2><p id="4ab1" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在世界锦标赛的最初几年，大多数领先的车手都在40多岁:尼诺·法里纳在43岁时赢得了第一个世界冠军，而Luigi Fagioli在1952年创造了F1历史上年龄最大的冠军纪录，当时他53岁，在未来几年里不太可能被超越。然而，他们被新一代取代只是时间问题。从20世纪60年代到1993年，平均年龄约为32岁，而在最近几个赛季，只有少数车手年龄超过30岁。</p><p id="d033" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的散点图显示了第一个赛季获胜车手的年龄，显示了一条向下倾斜的趋势线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/bc803b81ba90fdf4b60376948d626205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2II35QVaOV3Q44boGIBtA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">获胜车手的年龄</p></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="346f" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">3.机器学习建模</h1><p id="24ee" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">这最后一节将讨论以下主题:我用来评估最佳模型的<strong class="ky ir">指标</strong>，合并数据的<strong class="ky ir">过程</strong>，以及最终使用神经网络的<strong class="ky ir">机器学习建模</strong>。</p><h2 id="972e" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">成功指标</h2><ul class=""><li id="fe8a" class="ls lt iq ky b kz nf lc ng lf om lj on ln oo lr lx ly lz ma bi translated"><strong class="ky ir">精准评分</strong>—2019赛季正确预测赢家的百分比</li><li id="3e2d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">赔率对比</strong> —我的模型能战胜赔率吗？</li></ul><h2 id="f0e5" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">数据准备</h2><p id="6cf5" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">收集完所有数据后，我最终得到了六个不同的数据帧，我必须使用公共键将它们合并在一起。我的最终数据框架包括从1983年到2019年的比赛、结果、天气、车手和车队排名以及排位赛时间的信息。</p><p id="a4c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还计算了车手的年龄和排位赛时间的累计差异，这样我就可以知道每场比赛中第一辆赛车比其他赛车快多少。最后，我将赛道、国籍和车队变量虚拟化，去掉那些不太重要的变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="5596" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">回归还是分类问题？</h2><p id="039e" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">由于我想预测2019年每场比赛的第一名，所以我可以将目标变量视为回归或分类。</p><p id="ae19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当评估一个<strong class="ky ir">回归</strong>的精度分数时，我将我的预测结果按升序排序，并将最低值映射为比赛的获胜者。最终，我计算实际值和预测值(映射1和0)之间的精度分数，并在2019年的每场比赛中重复，直到我获得该赛季正确预测的比赛的百分比。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="86d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是2019年任何一场比赛的评分函数中的prediction_df的样子。实际领奖台映射为0和1(获胜者)，排序后的预测结果也是如此。在这种情况下，模型错误地预测Bottas是比赛的获胜者，因此模型的得分等于0。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/9fb9bce588e398450736f487fc0fb153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*if0FOaqbxwWbhyDaLnAxjg.png"/></div></div></figure><p id="8cab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在<strong class="ky ir">分类</strong>问题中，目标在建模之前被映射为0和1(赢家),因此，当我查看预测值时，根据预测的概率，我可能有多个赢家或根本没有赢家。因为我的算法不够智能，无法理解每场比赛我只需要一个获胜者，所以我创建了一个不同的分类得分函数，对每位车手赢得比赛的概率进行排名。我将概率从最高到最低排序，并将概率最高的车手作为比赛的获胜者。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="9788" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，即使马克斯·维斯塔潘只有0.35的获胜概率，因为这是那场比赛中获胜的最高概率，该函数也会正确地将他映射为获胜者。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/b531424824568e44a45a03e4986f84d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7PWUPcIvQuoZN06BwUGKsw.png"/></div></div></figure><h2 id="4c30" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">ML建模</h2><p id="4c4f" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">由于我的自定义评分功能需要在评估之前对模型进行拟合，所以我必须对不同的模型进行手动网格搜索，最终将分数和参数添加到字典中。</p><p id="bf0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我尝试使用逻辑和线性回归、随机森林、支持向量机和神经网络来解决回归和分类问题。</p><p id="e5cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">训练-测试分割:训练集包含从1983年到2018年(含)的所有比赛。测试集由2019赛季的所有21场比赛组成。</p><p id="a1b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">回归</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="c159" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分类</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h2 id="42e4" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">调查的结果</h2><p id="cfe7" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在花了几天时间运行所有的网格搜索后，神经网络和SVM的分类似乎返回了最高分，正确预测了2019年62%的比赛的获胜者，这对应于13/21的比赛。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/4b407d066f435e309e87da92c85d4444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FsgaOtCtAZf-9J6PYluj-w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ML模型比较</p></figure><p id="7e04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我还使用2018年和2017年两季作为测试集，以检查模型是否仍然表现良好。神经网络在这两年都比SVM分类器返回了更高的分数，所以我决定选择具有以下参数的神经网络分类器。</p><ul class=""><li id="7c44" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">hidden _ layer _ size =(75，25，50，10)</li><li id="4d68" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">激活=身份</li><li id="47b7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">求解器= lbfgs</li><li id="334f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">阿尔法= 0.01623776739188721</li></ul><p id="1058" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑到<strong class="ky ir">特征重要性</strong>根据线性回归，在预测获胜者时，网格位置似乎起着最重要的作用，还有其他特征，如比赛前的车队或积分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/eaf2e87af8716b8953963b92b6c19c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*heBVVDxnq5zZf2oKW71_Dw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据线性回归的特征重要性</p></figure><p id="de14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看过去几年的结果，我注意到算法总是错误地预测一些赛道的获胜者，可能是因为发生了更多的事故或超载。最难预测的赛道是阿尔伯特公园、巴库、斯帕、蒙扎和霍根海姆环。</p><h2 id="047a" class="nk mo iq bd mp nl nm dn mt nn no dp mx lf np nq mz lj nr ns nb ln nt nu nd nv bi translated">算法能战胜几率吗？</h2><p id="fb66" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">在将所有我预测的获胜者聚集在一起后，我决定查看由<a class="ae kv" href="https://sport.sky.it/" rel="noopener ugc nofollow" target="_blank"> SkySport </a>发布的2019赛季比赛的赔率，并发现如果我在这些比赛上下注，我会赢得的奖励。</p><p id="0de9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下表显示了根据<a class="ae kv" href="https://sport.sky.it/" rel="noopener ugc nofollow" target="_blank"> SkySport </a>在“赔率最大”下最有可能赢得比赛的车手，而“车手预测”是由神经网络预测的获胜者。红色的驱动程序名称表示错误的预测，因此与“实际”驱动程序列不同。以绿色突出显示的行表明算法预测的驱动因素结果是正确的，与赔率预测相反；然而，红色的突出显示表明，我可能应该在赔率最大的赔率上下赌注。最后两列显示了赔率奖励和利润，如果我一直在每场比赛中投资100€，最终利润为4，255.00€。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/1a6266dc74eedd6a3b08846541c24298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h6H_JTuSzzRBB4melStYIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">赔率比较</p></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="864c" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">结束想法</h1><p id="0546" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">我希望你喜欢我的帖子！欢迎在下面评论我可能错过的任何东西。所有代码都可以在我的GitHub中找到:</p><div class="ot ou gp gr ov ow"><a href="https://github.com/veronicanigro/Formula_1" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd ir gy z fp pb fr fs pc fu fw ip bi translated">veronicanigro/Formula_1</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">在GitHub上创建一个帐户，为veronicanigro/Formula_1开发做出贡献。</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">github.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk kp ow"/></div></div></a></div><p id="b0bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">领英:【https://www.linkedin.com/in/veronica-nigro/ T2】</p></div></div>    
</body>
</html>