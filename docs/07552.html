<html>
<head>
<title>Web Scraping Job Postings from Indeed.com using Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Selenium 从 Indeed.com 收集招聘信息</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/web-scraping-job-postings-from-indeed-com-using-selenium-5ae58d155daf?source=collection_archive---------21-----------------------#2020-06-07">https://towardsdatascience.com/web-scraping-job-postings-from-indeed-com-using-selenium-5ae58d155daf?source=collection_archive---------21-----------------------#2020-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="80c3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 NLP 和神经网络的工作工资预测项目的第一部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab3b8c3de3eb45e1115a76468d3d90c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0NPCl98LpehYKOX96zx1BQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戴安娜·奥雷在<a class="ae ky" href="https://unsplash.com/s/photos/web-scraping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b74e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望在我的数据科学之旅的早期就知道如何进行网络搜集！这是一个非常方便的工具，打开了很多酷项目的大门。对于刚接触编码的人来说，这听起来可能有点难以接受。但是相信我，这比你想象的更容易，更直观！</p><p id="229a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章是我最近完成的一个更大项目的第一部分<strong class="lb iu">，该项目旨在预测数据相关领域(数据科学、商业智能、分析等)的工作薪水。)通过文本分类和深度学习。为了构建模型，我需要收集大量的职位发布以及与职位发布相关的工资。</strong></p><p id="babc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我决定从 Indeed.com 那里刮乔布斯。我正在使用的 API 叫做<a class="ae ky" href="https://selenium-python.readthedocs.io/installation.html" rel="noopener ugc nofollow" target="_blank"> Selenium </a>。Selenium 广泛用于 web 自动化，它实际上非常容易安装和使用。您可以像这样安装 selenium:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="043a" class="ma mb it lw b gy mc md l me mf">pip install selenium</span></pre><p id="afdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Selenium 需要一个驱动程序来连接 web 浏览器。你可以在这里找到 Chrome，Edge，Firefox 或者 Safari 的驱动<a class="ae ky" href="https://selenium-python.readthedocs.io/installation.html" rel="noopener ugc nofollow" target="_blank"/>。下载后，确保驱动程序与您的浏览器应用程序在同一路径。</p><h2 id="03a3" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">进口硒</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e179" class="ma mb it lw b gy mc md l me mf">from selenium.webdriver.common.by import By<br/>from selenium import webdriver<br/>from selenium.webdriver.common.keys import Keys</span><span id="4004" class="ma mb it lw b gy mx md l me mf">from selenium.webdriver.support.ui import WebDriverWait<br/>from selenium.webdriver.support import expected_conditions as EC</span><span id="4b18" class="ma mb it lw b gy mx md l me mf">#specify driver path<br/>DRIVER_PATH = '/Users/bonniema/Desktop/chromedriver'<br/>driver = webdriver.Chrome(executable_path = DRIVER_PATH)</span></pre><h2 id="7d3a" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">浏览页面</h2><p id="22ae" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated"><em class="nd"> driver.get </em>方法将导航到 URL 给出的页面。执行此操作后，您将看到一个网页打开，表明 web 浏览器正在被控制。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="19f6" class="ma mb it lw b gy mc md l me mf">driver.get('<a class="ae ky" href="https://indeed.com'" rel="noopener ugc nofollow" target="_blank">https://indeed.com'</a>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/e7bc26008097a50774a25037d99ce601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtR-jfc34a6Mc2la6C_7rQ.png"/></div></div></figure><p id="ae61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是找工作。使用 Selenium 的一个好处是可以通过<strong class="lb iu"> <em class="nd"> id、名称或者 xpath </em> </strong>来识别一个项目或者按钮。在这种情况下，我想单击“查找工作”按钮。如果你检查页面，你可以看到 HTML 的“寻找工作”按钮。正如下图中突出显示的，我们可以看出按钮元素在一个&lt;按钮&gt;标签中，该标签在一个分隔线&lt; div &gt;下，该分隔线在 id="whatWhereFormId "的表单下。虽然您可以有不同的方法来标识按钮，但我将使用该表单 ID 来标识按钮。最好使用一个足够唯一的项目或属性(比如类),但是不要随时间而改变。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/6b2508b40783978756ac081cb0e3c4f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4hLc8icbyJ6GzllYyx9_A.png"/></div></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fee2" class="ma mb it lw b gy mc md l me mf">initial_search_button = driver.find_element_by_xpath<br/>(‘//*[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>=”whatWhereFormId”]/div[3]/button’)</span><span id="5c61" class="ma mb it lw b gy mx md l me mf">initial_search_button.click()</span></pre><h2 id="cc3c" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">关闭弹出窗口</h2><p id="5dbe" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">单击“搜索”按钮后，会显示一个弹出窗口。我们可以用</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/ccaf23ec1f92684dcd5504c223237670.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*1cJKdGphEhRd3qQp1JZr8Q.png"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="bd06" class="ma mb it lw b gy mc md l me mf">close_popup = driver.find_element_by_id("popover-close-link")<br/>close_popup.click()</span></pre><h2 id="6cee" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">执行高级搜索</h2><p id="182b" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在稍微摆弄了一下页面之后，我知道我想要执行高级工作搜索，在这里我可以指定搜索术语并设置每页显示的工作数量。查看 HTML 结构，看起来“高级工作搜索”被包装在一个<a>标签中。一种方法是使用“contains”通过文本定位 xpath。</a></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="03fd" class="ma mb it lw b gy mc md l me mf">advanced_search = driver.find_element_by_xpath("//a[contains(text(),'Advanced Job Search')]")</span><span id="1f8b" class="ma mb it lw b gy mx md l me mf">advanced_search.click()</span></pre><p id="9e46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种方法是右键单击该路径，检查是否可以直接复制 XPath。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/d40792a21efa7fe2b25a156ee682173f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_k2zvOAyCWmCdFWtfyi6w.png"/></div></div></figure><p id="44a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">似乎这个 XPath 不够通用，不能在这里使用。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1f70" class="ma mb it lw b gy mc md l me mf">//*[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="jobsearch"]/table/tbody/tr/td[4]/div/a</span></pre><h2 id="c634" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">输入搜索值</h2><p id="2f1d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">接下来，我们需要向搜索表单发送值。下面这段代码发送位置关键字，设置显示限制，并按日期对结果进行排序</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0eaf" class="ma mb it lw b gy mc md l me mf">#search data science <br/>search_job = driver.find_element_by_xpath('//input[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="as_and"]')<br/>search_job.send_keys(['data science'])</span><span id="b3e3" class="ma mb it lw b gy mx md l me mf">#set display limit of 30 results per page<br/>display_limit = driver.find_element_by_xpath('//select[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="limit"]//option[<a class="ae ky" href="http://twitter.com/value" rel="noopener ugc nofollow" target="_blank">@value</a>="30"]')<br/>display_limit.click()</span><span id="fadb" class="ma mb it lw b gy mx md l me mf">#sort by date<br/>sort_option = driver.find_element_by_xpath('//select[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="sort"]//option[<a class="ae ky" href="http://twitter.com/value" rel="noopener ugc nofollow" target="_blank">@value</a>="date"]')<br/>sort_option.click()</span><span id="f1ed" class="ma mb it lw b gy mx md l me mf">search_button = driver.find_element_by_xpath('//*[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="fj"]')<br/>search_button.click()</span></pre><h2 id="0076" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">找到工作卡，立刻获得所有信息</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c782840375d3a1b6b7e89f49ad5eb1e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*Whvd0vbv7L3B6xbPrh9nBQ.png"/></div></figure><p id="8ddb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的目标是从一个工作卡中获取职位、公司名称、城市和公司评级、工资(如果有的话)以及工作 url，然后迭代该页面上的所有工作卡。然后到下一页去刮更多的数据。</p><p id="eaa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面这段代码使用 for 循环遍历每页中的工作卡，并将相关信息保存在一个列表中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e80d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在繁重的提升部分已经完成了！</p><h2 id="7938" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">从个人网址获取职位描述</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="03a1" class="ma mb it lw b gy mc md l me mf">descriptions=[]<br/>for link in links:<br/>    <br/>    driver.get(link)<br/>    jd = driver.find_element_by_xpath('//div[<a class="ae ky" href="http://twitter.com/id" rel="noopener ugc nofollow" target="_blank">@id</a>="jobDescriptionText"]').text<br/>    descriptions.append(jd)</span></pre><p id="2e4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把它们放在一个数据框里！</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0ff1" class="ma mb it lw b gy mc md l me mf">df_da=pd.DataFrame()<br/>df_da['Title']=titles<br/>df_da['Company']=companies<br/>df_da['Location']="Palo Alto, CA"<br/>df_da['Link']=links<br/>df_da['Review']=reviews<br/>df_da['Salary']=salaries<br/>df_da['Description']=descriptions</span></pre></div></div>    
</body>
</html>