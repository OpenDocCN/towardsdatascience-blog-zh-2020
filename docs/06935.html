<html>
<head>
<title>Descending: A Shakedown of Linear Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">降序:Python中线性回归的一种尝试</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/descending-a-shakedown-of-linear-regression-with-in-python-a9aec054c860?source=collection_archive---------86-----------------------#2020-05-28">https://towardsdatascience.com/descending-a-shakedown-of-linear-regression-with-in-python-a9aec054c860?source=collection_archive---------86-----------------------#2020-05-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="26f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">线性回归快速指南以及如何使用梯度下降在Python中实现它。</h2></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/30fe90a694598f08f66b7666c0df2e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWKTDXElpzLDMMnFLdn4Zw.jpeg"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">克里斯·利维拉尼在<a class="ae lf" href="https://unsplash.com/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7269" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><em class="mc">这个项目的所有示例代码都可以在</em> <a class="ae lf" href="https://github.com/RobotGyal/linear-regression-example" rel="noopener ugc nofollow" target="_blank"> <em class="mc">这里</em> </a>找到</p><p id="2587" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在几乎每个人一生中的某个时刻，都有那么一刻，他们希望自己能预知未来。无论是通过使用臭名昭著的水晶球，还是通过在德洛里安跳跃到未来，未来仍然是一个不可能知道或预测的概念。</p><p id="ae25" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">除非你从事数据科学。</p><p id="fc37" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用原始数据并利用计算机科学和统计学创建模型的众多好处之一是，数据科学家可以根据现有数据和可观察到的趋势预测结果。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><p id="fad3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">线性回归是一种技术，试图“通过将一个线性方程T10与观测数据T11拟合来模拟两个变量之间的关系”——耶鲁大学</p><p id="66d4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个线性方程给了我们一组数据点的最佳拟合线。使用这条线，既可以用肉眼看到，也可以作为其他预测模型的起点，我们能够以一定的准确度预测未来/增加的数据点。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi md"><img src="../Images/c109311f8326c14c03062b6dea56334f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4BXGOHGffti82TUF2FjZQ.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">随机散点图— Aleia Knight</p></figure><p id="831e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">取1.0-10.0之间的这组随机点，并将其绘制在散点图上。</p><p id="9a62" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有了这一组点，几乎立刻就能看出一个趋势。</p><p id="b385" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正线性。</p><p id="8fd9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">但是准确地知道直线的值，它的斜率和它的截距并不是仅仅通过查看原始图就可以得到的值。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi md"><img src="../Images/b9cf821f0ff4cf8bd7ba55223392367e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00a_Ld7ImBG7KvV_Kt5DUg.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">最适合的系列——Aleia Knight</p></figure><p id="ca2d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">应用线性回归，我们可以看到最佳拟合的实际线。从这里，我们可以向前延伸线，并能够大致看到超过10.0和小于1.0的数据点可以预测到哪里。</p><p id="8adf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">足够简单，但数据很少会如此干净、简洁或直接。</p><p id="8465" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果我们使用像<a class="ae lf" href="https://www.kaggle.com/geomack/spotifyclassification" rel="noopener ugc nofollow" target="_blank"> Spotify歌曲属性数据集</a>这样的数据，并从中绘制一些数据，会怎么样..</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi md"><img src="../Images/a99f72e9c1189c1c236d228d598dbf1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22tec7t5xBD5o6A9jk2ThQ.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">Spotify数据:能量与可跳舞性——Aleia Knight</p></figure><p id="4758" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有许多模型和方法可以找出最适合无法直观解释的数据的线。</p><p id="bc8f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将使用线性回归的两种主要方法来寻找最佳拟合线。</p><ol class=""><li id="6253" class="me mf it li b lj lk lm ln lp mg lt mh lx mi mb mj mk ml mm bi translated">均方误差</li><li id="729d" class="me mf it li b lj mn lm mo lp mp lt mq lx mr mb mj mk ml mm bi translated">梯度下降</li></ol></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="10d9" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">设置</h1><p id="7488" class="pw-post-body-paragraph lg lh it li b lj nk ju ll lm nl jx lo lp nm lr ls lt nn lv lw lx no lz ma mb im bi translated">总是从加载必要的导入并创建数据和变量开始</p><pre class="kq kr ks kt gt np nq nr ns aw nt bi"><span id="ac24" class="nu mt it nq b gy nv nw l nx ny">import pandas as pd     #For data handling<br/>import matplotlib.pyplot as plt    #For data visualization<br/>import numpy as np       #For calculations</span><span id="4dab" class="nu mt it nq b gy nz nw l nx ny">data = pd.read_csv('data.csv')  #Spotify data<br/>x = data['danceability']<br/>y = data['energy']</span></pre></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><p id="4e09" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><em class="mc">展望未来，统计和微积分中有许多复杂的数学公式和技术。访问</em> <a class="ae lf" href="https://mathinsight.org/partial_derivative_introduction" rel="noopener ugc nofollow" target="_blank"> <em class="mc">偏导数简介</em> </a> <em class="mc">和</em><strong class="li iu"><em class="mc"/></strong><a class="ae lf" href="https://ml-cheatsheet.readthedocs.io/en/latest/linear_regression.html" rel="noopener ugc nofollow" target="_blank"><strong class="li iu">线性回归</strong> </a> <strong class="li iu"> n </strong> <em class="mc">快速复习概念和公式。</em></p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="81f9" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated"><strong class="ak"> <em class="oa">使用渐变下降</em> </strong></h1><p id="2c72" class="pw-post-body-paragraph lg lh it li b lj nk ju ll lm nl jx lo lp nm lr ls lt nn lv lw lx no lz ma mb im bi translated">这种技术可以被认为是一种优化的方法，通过寻找与理想值的最小误差来找到最佳拟合线。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e38a7d9b4c6d9e2012c512ad46541b03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/1*tFYX3He2l_79iTQki3aGmw.gif"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">giphy.com</p></figure><p id="75a8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个过程的第一步是找到我们的最佳斜率和截距。也就是后来所知的“权重”，只要我们的x和y数据保持不变，这些值在这些计算中将保持不变。</p><p id="217f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了计算斜率和截距，我们需要以下公式来计算权重的均方误差，<strong class="li iu"> w1 </strong>和<strong class="li iu"> w0。</strong></p><div class="kq kr ks kt gt ab cb"><figure class="oc ku od oe of og oh paragraph-image"><img src="../Images/09478d171305df10db735dff9e0db649.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*39VmsWdGsvrqFpZCIjMjAA.png"/></figure><figure class="oc ku oi oe of og oh paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><img src="../Images/269c7c13887231ff63775054a5611876.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*vj4nsRZ6XYQCj2ClCMdVDA.png"/></div><p class="lb lc gj gh gi ld le bd b be z dk oj di ok ol translated">公式— Aleia Knight</p></figure></div><p id="1d3a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">左侧图像显示了数学符号到相关变量的转换。右侧是用于计算<strong class="li iu"><em class="mc">【w1(斜率)</em> </strong>和<strong class="li iu"> <em class="mc"> w0(截距)</em> </strong>的公式。这个过程如果手工完成，需要深入的微积分知识，特别是解多变量方程，求偏导数。</p><blockquote class="om on oo"><p id="3a97" class="lg lh mc li b lj lk ju ll lm ln jx lo op lq lr ls oq lu lv lw or ly lz ma mb im bi translated"><strong class="li iu">查找资源:</strong></p><p id="3d95" class="lg lh mc li b lj lk ju ll lm ln jx lo op lq lr ls oq lu lv lw or ly lz ma mb im bi translated"><a class="ae lf" href="https://www.youtube.com/watch?v=qDe4RsEhmJc" rel="noopener ugc nofollow" target="_blank">求解多变量方程</a></p><p id="b61a" class="lg lh mc li b lj lk ju ll lm ln jx lo op lq lr ls oq lu lv lw or ly lz ma mb im bi translated"><a class="ae lf" href="https://www.youtube.com/watch?v=JAf_aSIJryg" rel="noopener ugc nofollow" target="_blank">寻找偏导数</a></p></blockquote><p id="0a41" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一旦我们找到w1和w0的值，我们就可以使用这些公式来求解<strong class="li iu"> w1 </strong>和<strong class="li iu"> w0 </strong>的实际值。</p><p id="8155" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是一个漫长的过程，但是有了numpy库，我们能够简化这个过程。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="034d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这将打印出语句(对于特定的示例)。</p><pre class="kq kr ks kt gt np nq nr ns aw nt bi"><span id="a32f" class="nu mt it nq b gy nv nw l nx ny">Slope is / Weight 1 : 0.05034768176424329<br/>Intercept / Weight 2 is: 0.6504410345649969 <br/><br/>(0.05034768176424329, 0.6504410345649969)</span></pre><blockquote class="ou"><p id="ba68" class="ov ow it bd ox oy oz pa pb pc pd mb dk translated">坚持这两个价值观！</p></blockquote><figure class="pe pf pg ph pi ku"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="aea7" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">理解<code class="fe pj pk pl nq b">y_pred=w1*x+w0</code>的一个更简单的方法是把它想成更熟悉的形式<code class="fe pj pk pl nq b">y=mx+b</code>。<code class="fe pj pk pl nq b">y_pred</code>是基于我们之前找到的<strong class="li iu"> w1 </strong>和<strong class="li iu"> w0 </strong>的预测线。</p><p id="04b9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">绘制这条线，我们看到:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi md"><img src="../Images/9290d6b948f8c7557c9d5a31020ed621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_XSJ7OEZsCW1ORQiP4nPCA.png"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">Spotify数据:能量与可跳舞性——梯度下降——Aleia Knight</p></figure><p id="7d46" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">直觉上，这似乎有点奇怪，但当我们看聚类(另一种分析风格)时，这确实是有意义的，并且我们的数据似乎确实有较低的正趋势。</p><p id="43cc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们可以用均方差来分析这条线的有效性。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="c537" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">均方误差</h1><p id="9473" class="pw-post-body-paragraph lg lh it li b lj nk ju ll lm nl jx lo lp nm lr ls lt nn lv lw lx no lz ma mb im bi translated">这个概念很简单，因为我们看到的是实际点和预测点之间的差异。</p><pre class="kq kr ks kt gt np nq nr ns aw nt bi"><span id="0db4" class="nu mt it nq b gy nv nw l nx ny">actual = 1<br/>predicted = 3<br/>error = 2</span></pre><p id="19a8" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是在所有数据点上完成的(求和)，除以点的数量(平均值)，并找到平方(平方)以消除任何负数。值0是不可能的，但是越接近零越好。这反映在代码中。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="cc61" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><code class="fe pj pk pl nq b">MSE via my calculations is: 0.04412711932424555</code></p><p id="4c4b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">非常接近零，这太棒了！这告诉我们，误差值非常低，所以我们的线是相当准确的。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="os ot l"/></div><p class="lb lc gj gh gi ld le bd b be z dk translated">giphy.com</p></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><p id="98d1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这种算法和许多其他算法一样，可以用于计算机科学、数据科学和技术涉及的任何领域。</p><p id="269d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正是通过使用这些能力，我们能够更快、更有效地处理数据，并利用它来帮助我们走向未来。</p></div></div>    
</body>
</html>