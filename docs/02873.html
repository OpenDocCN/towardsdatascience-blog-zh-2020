<html>
<head>
<title>Feature Engineering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征工程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/feature-engineering-3a380ad1aa36?source=collection_archive---------25-----------------------#2020-03-19">https://towardsdatascience.com/feature-engineering-3a380ad1aa36?source=collection_archive---------25-----------------------#2020-03-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a000d5bd347342e4d581d340ab2e9523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0JXJ30JwE82XQGpB"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">亚历克斯·康德拉蒂耶夫在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="cf16" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">了解数据科学工作流程中最重要的步骤</h2></div><h1 id="a46d" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">介绍</h1><p id="41d4" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">特征工程是一套应用于数据科学的技术，旨在确保模型能够正确使用数据。它是科学和艺术的结合，可以说是数据科学工作流程中最重要的步骤，因为它是带来最大价值的步骤之一。</p><p id="986e" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">掌握它需要大量的学习和实践:您不仅应该理解特征变换背后的数学原理以便操作它们，而且还需要知道在每种情况下应用哪种类型的变换。我们现在将介绍适用于不同类型数据的主要转换，以及如何进行这些转换及其结果。</p><h1 id="023a" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">数字数据</h1><h2 id="c97d" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated"><strong class="ak">二值化</strong></h2><p id="f0bf" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这意味着将一个数字变量转换成二进制变量:例如，假设我们使用天气数据来预测销售，我们有关于降雨量(以毫米为单位)的信息。与其将此信息用作连续变量，不如采用一个二元变量，其中 0 =无雨，1 =任何降雨量。这样，你失去了信息，因为你不再知道降雨量，但在某些情况下，这些信息可能是不相关的。</p><h2 id="5937" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">扔掉</h2><p id="b21c" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在前面的例子中，我们没有使用二元变量，而是将原始变量转换为分类变量，其中 0 =无雨，1 =小雨，2 =大雨，3 =暴雨。垃圾箱的数量和大小可能会有所不同，您可能需要尝试几次才能找到“正确的”垃圾箱。查看变量分布(直方图)有助于找到合理的分界点(如四分位数)。</p><h2 id="ae16" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">对数变换</h2><p id="8965" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">想象一个带有直方图的变量，如下图所示(实际数字无关)。</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nd"><img src="../Images/3a0073f9288bccfe3ef852c8e540567a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nchKX5lYcZ-4LPztKVWgA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">X 的直方图</p></figure><p id="160a" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">正如我们所看到的，这个变量高度集中在一个尾部(重尾分布)，这可能会给一些模型增加一些偏差和误差。为了解决这个问题，我们可以应用一个 log 转换，也就是说，我们可以使用一个新的变量:log(X ),而不是在模型中使用变量 X。我们的新变量 log_X 的分布更加“良好”:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/b21586095781bf45af20e4bb489af841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVgM3vljejkNzKhWqdtGIA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">对数直方图(X)</p></figure><p id="df11" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">对于大多数模型来说，这种分布通常会产生更好的结果(想想线性回归——当我们的观察值不全部集中在 0 附近时，拟合直线更容易)。</p><h2 id="b186" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">电力转换</h2><p id="846e" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">幂变换本质上是对你的特征 X 应用一个幂函数，比如平方或平方根。这有助于模型考虑要素和目标变量之间的非线性交互。</p><h2 id="53a7" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">缩放比例</h2><p id="dcf1" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当您使用为变量分配不同系数的模型，并且希望稍后解释这些系数时，缩放特别有用。如果你的变量不在同一个范围内，就很难比较它们之间的系数。</p><p id="45fc" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">最流行的缩放方法叫做<em class="nj">标准化</em>。特性标准化创建了一个新变量，其平均值为 0(将变量的分布移至 0 附近)，方差为 1(缩放变量的方差)。方法是使用下面的公式，其中 std_dev(x)表示 x 的标准偏差:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/dd7fc868a6db885b6a2ae11032971933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iG0ljxBbng-GunFKLPdMg@2x.png"/></div></div></figure><p id="e3d1" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">然后，您的变量将采用负值和正值，分布在 0 附近。</p><p id="d322" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果不希望变量为负值，可以使用另一种流行的缩放方法<em class="nj">最小-最大缩放</em>，其公式为:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/ffbd9310bce60280077ccc53e7920508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQBg9NiyvGhxizfM7gAfyw@2x.png"/></div></div></figure><p id="9565" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这一次，您的新变量将介于 0 和 1 之间，从而更容易解释它的新值和您的模型生成的任何系数。</p><h1 id="4da3" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">文本数据</h1><h2 id="5ab3" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">清洁</h2><p id="98bc" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">文本数据包含许多干扰，在我们尝试更高级的转换之前，应该先处理这些干扰。您应该处理大写/小写字母，通常是将所有字母都变成小写，但在处理含义可能不同的情况时要小心(“企鹅”和“企鹅”的意思完全相同，而“房子”可能表示电视节目而不是实际的房子)。</p><p id="225e" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">文本数据的另一个清理步骤是去掉停用词，这些词本身没有太多意义，比如“是”、“是”、“在”、“for”等。有许多不同语言的停用词公共列表，可以直接从 Python 和 r 的库中访问。</p><p id="ecfe" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">最后，还有清理多余的空间，修复打错的单词，等等。</p><h2 id="9dbd" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">堵塞物</h2><p id="848e" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">一般来说，词干就是把一个词转化成它的词根。例如，单词“runs”、“runner”、“ran”、“run”都会变成“run”。有时它是一个有用的特性，但有时它也可以改变单词的含义(“新”和“新闻”不是一个意思)，所以在应用这种转换之前，请考虑您的具体情况。</p><h2 id="e20e" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">词汇袋</h2><p id="c567" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">处理文本数据比处理数字要困难得多，所以大多数处理文本的方法都是基于将文本转换成数字。最基本的方法之一是将文本视为“单词包”，这意味着我们计算每个单词在文本中出现的次数，将这些计数转化为向量，并使用这些向量来比较不同的文本。这种方法的问题是显而易见的:单词可以有不同的含义，这取决于它们出现的顺序，或者它们前面的单词。例如，考虑下面两个句子:“一个人吃了一个汉堡”和“一个汉堡吃了一个人”。两者都有完全相同的字数，并且会以相同的方式表示，尽管它们的意思明显不同。为了解决这个问题，一个常见的解决方案是创建 n-grams 包，这意味着，我们不是计算单词，而是计算一起出现的单词集(通常最多 2 或 3 个单词)。因此，在我们的例子中，我们将计算“一个人”、“一个吃了的人”、“一个汉堡包”、“一个人吃了的人”等的出现次数。</p><h2 id="a80b" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">TF-IDF</h2><p id="c439" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">TF-IDF 代表<em class="nj">词频—逆文档频率</em>，这是一种考虑单词在一个文本中相对于其他文本出现的方式。假设我们正在分析特朗普的推文，我们想知道他使用最多的词是什么。如果我们只看简单的字数统计，我们会得到相当无聊的结果:像“和”和“我”这样的词会出现，因为它们很常见。问题是:它们在任何地方都很常见，而不是因为特朗普特别经常写它们，这就是 TF-IDF 可以帮助我们的地方。它可以用不同的方法计算，但一个简单的方法是:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/9559dcb3cde55c63387221eb0ef0b871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3Nh4uR3a-abtLp4ceaSxQ@2x.png"/></div></div></figure><p id="fb30" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">通过这种方式，我们对不常用的词给予更多的权重，帮助我们看到与其他人相比特朗普使用得更多的词。这一次，我们可能会得到像“美国”、“国会”和“伟大”这样的词。</p><h1 id="c8d1" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">分类变量</h1><h2 id="ab2f" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">一键编码</h2><p id="c471" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">同样，我们的目标是把一个非数字变量变成一个数字变量。一键编码创建了<em class="nj"> n </em>个新变量，其中<em class="nj"> n </em>是原始变量中唯一类别的数量。例如，如果我们有一个<em class="nj">性别</em>变量，我们将只有两个类别:“男人”和“女人”。然后，我们将用两个新变量替换<em class="nj">性别</em>变量:<em class="nj">男人</em>和<em class="nj">女人</em>，如果观察值属于各自的性别，则这两个变量的值为 1:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nn"><img src="../Images/680842a7f67ccdb6bc02dc256dd3ae22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7jOTK_78SrkG_ccYwNFnA@2x.png"/></div></div></figure><h2 id="4d72" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">虚拟编码</h2><p id="cff6" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">你有没有注意到上面的一个变量是多余的？我们可以只保留其中一个而不丢失任何信息。如果去掉<em class="nj">女人</em>一栏，还是可以知道这个人的性别(如果不是女人，那就是男人)。虚拟编码正是这样做的:</p><figure class="ne nf ng nh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/57ea092b5f6c1543b7df9c74b5ba8a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9l3F--RU2XNVLBPFMf2Vcw@2x.png"/></div></div></figure><h1 id="5f40" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">降维</h1><h2 id="67c0" class="mr kz jj bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">主成分分析</h2><p id="0833" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">PCA 本身就是一门学科。如果你想更好地了解细节，请查看这篇文章。</p><p id="0935" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">总的来说，PCA 是一种在保持尽可能多的信息的同时降低维度的方法。它采用原始特征(也可称为尺寸)，并基于原始尺寸的投影创建新特征。你从 30 个维度开始，最终可以得到 2、3、4 或 18 个维度，它们被称为主成分。您将在减少维度和保持信息和方差之间进行权衡。保持至少 80%的原始方差是一个常见的基准，但它确实取决于您的应用程序。</p><h1 id="15a2" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">结论</h1><p id="2412" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">特征工程是一套在建模前准备数据的技术。在保留相关信息、将数据保持在可处理的大小以保持合理的计算时间和可解释性之间有许多权衡。确保您理解所用技术背后的数学原理，以了解它们是否适用于您的具体情况，并为这一步留出足够的时间，因为这是进行数据科学时最重要的步骤之一。最后，确保您在步骤之间迭代:在您完成第一个模型之后，在运行另一个模型之前，回到这一步，看看是否有可以改进的地方。</p></div></div>    
</body>
</html>