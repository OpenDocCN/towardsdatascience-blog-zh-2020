<html>
<head>
<title>Quickly extract all links from a web page using the browser console</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用浏览器控制台快速提取网页中的所有链接</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quickly-extract-all-links-from-a-web-page-using-javascript-and-the-browser-console-49bb6f48127b?source=collection_archive---------0-----------------------#2020-03-09">https://towardsdatascience.com/quickly-extract-all-links-from-a-web-page-using-javascript-and-the-browser-console-49bb6f48127b?source=collection_archive---------0-----------------------#2020-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ff9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用几行 JavaScript 提取网页上的所有超链接，不需要编码环境</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5ced9327713da36adfcec33ec2622059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cMMcAry5Ond867vNj6fk5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用控制台从网页中提取链接</p></figure><p id="e838" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从网站和文档中提取和清理数据是我的工作，我非常喜欢学习如何使用 Python 和 r 从多个网页甚至多个网站中系统地提取数据。但有时一个项目只需要少量数据，仅来自网站上的一个页面。</p><p id="fdbf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以前，当出现这种情况时，我仍然会启动 Python IDE 或 RStudio，编写并执行一个脚本来提取这些信息。这是用大锤砸坚果。常规的旧 JavaScript 足够强大，可以从单个网页中提取信息，并且有问题的 JavaScript 可以在浏览器的开发人员控制台中运行。</p><p id="f1f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，我从一个网页中提取所有链接，因为这是我经常在网页上执行的任务。然而，这段代码同样适用于提取 HTML 文档中的任何其他文本元素类型，只需做一些小的修改。当这段代码运行时，它会在浏览器中打开一个新的选项卡，并输出一个包含每个超链接的文本和链接本身的表格，因此每个链接所指向的内容有一些上下文。</p><h2 id="d41d" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated"><strong class="ak">你将需要这个项目:</strong></h2><ul class=""><li id="706a" class="mn mo it la b lb mp le mq lh mr ll ms lp mt lt mu mv mw mx bi translated">几乎所有过去 10 年生产的浏览器。</li><li id="71e4" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">我将在页面的下方提供一些代码。</li><li id="772a" class="mn mo it la b lb my le mz lh na ll nb lp nc lt mu mv mw mx bi translated">就是这样！</li></ul><h2 id="49f2" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">代码及其工作原理</h2><p id="f874" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">打开你的浏览器(是的，如果你不怕惩罚的话，这在 Internet Explorer 中也能工作)并导航到你想要提取链接的页面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/f426217ea1026cdf88782507feb697ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBp6XOa1-Xo9-ULUhDTEag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2017 年议会的特别委员会质询</p></figure><p id="b78a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我用 2017 年议会页面的<a class="ae nh" href="https://www.parliament.uk/business/committees/inquiries-a-z/?y=2017&amp;mode=0&amp;house=commons" rel="noopener ugc nofollow" target="_blank">特别委员会询问列表作为例子——这是一个有大量链接的页面，作为一个分组，可能对很多人都有用。</a></p><p id="5923" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们只需要打开开发人员控制台并运行代码。要打开开发人员控制台，您可以按 F12 或者右键单击页面并选择“检查”或“检查元素”，这取决于您选择的浏览器。这将打开控制台，您可以在其中键入或复制并粘贴代码片段。</p><p id="0090" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是您需要放入控制台的代码片段:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="b7a4" class="lu lv it nj b gy nn no l np nq">var x = document.querySelectorAll("a");<br/>var myarray = []<br/>for (var i=0; i&lt;x.length; i++){<br/>var nametext = x[i].textContent;<br/>var cleantext = nametext.replace(/\s+/g, ' ').trim();<br/>var cleanlink = x[i].href;<br/>myarray.push([cleantext,cleanlink]);<br/>};<br/>function make_table() {<br/>    var table = '&lt;table&gt;&lt;thead&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Links&lt;/th&gt;&lt;/thead&gt;&lt;tbody&gt;';<br/>   for (var i=0; i&lt;myarray.length; i++) {<br/>            table += '&lt;tr&gt;&lt;td&gt;'+ myarray[i][0] + '&lt;/td&gt;&lt;td&gt;'+myarray[i][1]+'&lt;/td&gt;&lt;/tr&gt;';<br/>    };<br/> <br/>    var w = window.open("");<br/>w.document.write(table); <br/>}<br/>make_table()</span></pre><p id="e4ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后只需按下回车键(或 IE 中的运行按钮。但是说真的，你为什么用 IE？！).这将在您的浏览器中打开一个新的选项卡，其中包含您选择的网页中的所有链接文本和超链接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/83d38679541f8af08a50e7cfc8f111b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_AuSwuEEF5eFtT-1op-tA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码运行后表格的显示方式。</p></figure><p id="ebdb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，可以将该表复制并粘贴到电子表格或文档中，以便您随意使用。</p><h2 id="c10f" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">代码在做什么？</h2><p id="93ca" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">下面是代码的分解和每个方面的作用。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="a66c" class="lu lv it nj b gy nn no l np nq">var x = document.querySelectorAll("a");<br/>var myarray = []</span></pre><p id="ca7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，我们找到页面上的所有“a”元素(a 元素是链接),并将它们赋给变量 x。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="e332" class="lu lv it nj b gy nn no l np nq">for (var i=0; i&lt;x.length; i++){<br/>var nametext = x[i].textContent;<br/>var cleantext = nametext.replace(/\s+/g, ' ').trim();<br/>var cleanlink = x[i].href;<br/>myarray.push([cleantext,cleanlink]);<br/>};</span></pre><p id="9dfb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们遍历 x 中的所有“a”元素，对于每个元素，我们试图找到元素和链接的文本内容。</p><p id="f214" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于文本内容，我们用单个空格替换空白并修剪文本，因为可能有大量空白会使我们的表格不可读。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="a029" class="lu lv it nj b gy nn no l np nq">function make_table() {<br/>    var table = '&lt;table&gt;&lt;thead&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Links&lt;/th&gt;&lt;/thead&gt;&lt;tbody&gt;';<br/>   for (var i=0; i&lt;myarray.length; i++) {<br/>            table += '&lt;tr&gt;&lt;td&gt;'+ myarray[i][0] + '&lt;/td&gt;&lt;td&gt;'+myarray[i][1]+'&lt;/td&gt;&lt;/tr&gt;';<br/>    };<br/> <br/>    var w = window.open("");<br/>w.document.write(table); <br/>}<br/>make_table()</span></pre><p id="0a8e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们使用函数“make_table()”制作表格。这将创建一个变量 table，它以 HTML 表格和表格标题开始。然后，我们使用 for 循环来添加包含链接文本和超链接的表格行。</p><p id="d382" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们使用“window.open()”打开一个新窗口，并使用“document.write()”将 HTML 表写入该窗口。</p><h2 id="9a20" class="lu lv it bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">但是……？</h2><p id="83ee" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">当前的代码有一个缺点——它需要一个页面上的所有链接。这意味着菜单中的所有链接，任何带你到当前页面不同点的跳转链接，联系人，条款和条件，页面底部的网站地图链接等等…</p><p id="ed26" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以更具体地在网页的某个区域中查找所有“a”元素。对于上面的委员会查询页面，我们只需更改第一行代码，让查询选择器查看页面的特定区域——可能只是页面中央的 a-z 列表。</p><p id="bd5e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，右键单击您想要获取链接的页面区域，然后单击“检查”。然后，您应该能够看到该页面元素的名称。在本例中，元素是一个“div ”,带有类“a-to-z-listing”。我们可以简单地更改第一行，在具有“a-to-z-listing”类的元素中查找所有“a”元素:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="175f" class="lu lv it nj b gy nn no l np nq">var x = document.querySelectorAll(".a-to-z-listing a");</span></pre><p id="44d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我的大部分 web 抓取活动中，我仍然会使用 Python 和 R，但是有一种快速简单的方法来从 web 页面中提取信息而不需要打开任何其他应用程序是很有帮助的。</p><p id="3a48" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你会用这个代码做什么？有没有更优雅的方法来构造这段代码？请在下面的回复中让我知道。</p></div></div>    
</body>
</html>