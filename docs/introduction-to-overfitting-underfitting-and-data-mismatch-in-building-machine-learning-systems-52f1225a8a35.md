# 介绍构建机器学习系统中的数据失配、过拟合和欠拟合

> 原文：<https://towardsdatascience.com/introduction-to-overfitting-underfitting-and-data-mismatch-in-building-machine-learning-systems-52f1225a8a35?source=collection_archive---------28----------------------->

![](img/f38edb1eeefde644cf4faab960b558ca.png)

https://unsplash.com/@ikukevk 凯文·Ku 的照片

在文章[“最重要的机器学习方法的初级读本”](https://medium.com/swlh/a-primer-on-the-most-important-machine-learning-methods-7b08daa79ae0)中，我概述了该领域常用的不同机器学习方法。这里考虑三个主要方面:

*   **人工监督:**详细阐述了监督、非监督、半监督和强化学习是如何工作的，特别是在预定义结果的形状方面。
*   **在线学习与批量学习:**讨论增量学习“即时”和基于静态数据集训练模型之间的区别。
*   **基于实例的学习与基于模型的学习:**强调了阐明与先前值的显式比较与开发模型用于概括的逻辑的学习方法的差异。

当构建机器学习系统时，需要执行几个步骤来产生一个健壮的解决方案，该解决方案不仅可以做出准确的预测，还可以对潜在的问题给出正确的答案。一个典型的**机器学习工作流程**包含以下步骤:

*   问题定义
*   数据收集
*   探索性数据分析
*   特征工程
*   训练/测试分割
*   模型选择和培训
*   交互效度分析
*   模型精度评估
*   超参数调整/模型改进
*   模型部署
*   模型再训练

这种工作流程会带来一些挑战。特别是在从 *EDA* 到*模型改进*的步骤中，需要回答一些**关键问题**:

*   数据是否足够？
*   模型需要多少数据？
*   数据代表真实世界吗？
*   哪些功能适合？
*   数据记录是否完整？
*   哪种机器学习方法合适？
*   模型应该有多复杂？
*   这个模型能做出准确的预测吗？

针对这些问题，主要任务是数据的选择和增强以及模型的选择、训练和改进。这些挑战可以分为两组:与数据相关的挑战和与模型相关的挑战。

虽然这两组之间存在依赖关系，但本文讨论了主要的**数据和模型挑战**，并解释了如何识别和解决它们，最终目标是提高机器学习系统的性能。

# **1)数据挑战**

数据科学家花费 80%的工作来寻找、清理和组织数据，这表明输入数据对于机器学习模型产生有意义的结果是多么重要。

## **数据量**

与人类学习程序相比，人类学习程序通常在很少的训练样本下就能很好地工作，当前的机器学习算法需要大量数据才能很好地执行。一般规则是“问题和应用的方法越复杂，就需要越多的数据作为训练的输入”。当机器学习系统缺乏大量数据时，过度拟合可能会发生(在*模型挑战*下解释)，因为算法会拾取模式，而这些模式实际上只不过是噪声。由于缺乏数据，真实的模式可能无法被发现。

## **代表数据**

与训练数据相关的一个关键方面是，它需要代表生产数据，即在部署机器学习解决方案的真实世界应用中出现的数据。如果生产数据完全不同，结果很可能是无用的。这适用于基本上所有类型的模型，无论它们是基于监督的还是非监督的学习、批量或在线学习以及基于实例或模型的学习。

在实践中，收集代表真实世界的数据集是一项挑战。像**采样噪声**(=数据中的随机性)这样的问题会有很大的影响，尤其是对纯粹随机形成的、不具有代表性的小样本而言。如果数据收集很容易，并且训练数据集足够大，那么**采样偏差**仍然可能发生。这是由于使用不准确的采样方法造成的。

## **数据质量**

“垃圾输入-垃圾输出”是一个经常使用的谚语，但对于机器学习解决方案的数据质量来说仍然是正确的。当在真实世界的产品和服务的上下文中操作训练数据时，训练数据的质量会极大地影响模型结果的质量。经过大量修改的艰苦工作产生了高质量的数据:

*   **误差校正:**通过对数据采集过程的充分了解，可以理解并手动修复误差。
*   **异常值去除:**可以从数据集中去除严重偏离的值，即由于不良数据采集方法导致的值。
*   **噪声平衡:**可以添加更多的数据来考虑噪声并使其变得不相关。
*   **缺失数据插补:**不完整的数据记录可以通过填充剩余系列值的中间值进行插补，或者在时间序列分析中，填充周围值的平均值。

如果数据无法修复，则应完全删除数据记录或要素以保护模型的准确性，因为缺失值通常会产生不利影响。如果模型加载了低质量的训练数据，那么它几乎不可能在检测目标模式方面表现良好。

## **相关特征**

对相关特征的分析超越了数据的原始形态，更多的是深入其含义。这是在机器学习工作流程的特征工程阶段解决的。

为了实现对特定机器学习问题的最佳可能预测，模型必须在最相关的特征上进行训练。应该排除不相关的特征，因为它们无助于做出准确的预测，而是扭曲了过程。

作为特征工程的一部分，两个主要步骤有助于构建适当的特征集合:

*   **特征选择:**分析特征并选择最有用的特征以进行准确预测，即通过查看相关矩阵。
*   **特征提取:**揭示特征之间的相互关系，并通过组合或增强现有特征来开发新特征(即在降维过程中使用)。

## **机器可读性**

除了上述挑战，数据的机器可读性也是最大化机器学习模型准确性的关键。对于不同的特征数据类型，包括数字、分类和序号、日期和时间以及文本和图像数据，机器可读性有特定的标准。随着在机器学习流水线中的特征工程步骤期间执行特征预处理，数据格式被调整以确保机器可读性。

一些特征预处理方法是特定于数据类型的，一些是独立的。以下列表概述了需要熟悉的重要方法:

*   **特征缩放或标准化:**重新缩放(如最小-最大缩放)在最小值为 0、最大值为 1 的范围内分配数值。标准化(例如 Z 值标准化)会围绕平均值 0 和方差 1 重新排列要素的值。特征缩放主要针对非树模型优化结果。
*   **异常值剔除:**尽管异常值剔除是在数据质量下讨论的错误数据采集的结果，但在本节中也被视为机器可读性的一种改进措施。离群值会大大降低机器学习模型准确处理其余数据的能力。
*   **等级转换/整数编码:**通过等级转换，一系列有序数据点内的分类值可以转换为具有机器可读整数数据类型的数值等级。
*   **Log 变换:** Log 变换用于提高机器学习模型对高度可变数据的性能。取每个数据值的对数，使分布更接近钟形，并消除偏斜。如果分布大致呈对数正态分布，则可以应用对数变换。
*   **One-hot-encoding:** 为分类特征的每个出现值创建一个新变量，该变量可以取值 0 和 1。当一个特征是分类的和整数的，但同时值没有被排序时，一次热编码用于避免较差的性能或意外的结果。

# **2)模型挑战**

机器学习模型必须经过测试和优化，以确保其产生的预测质量良好。投入生产的不成熟的模型可能会导致结果不充分以及产品或服务的用户不满意。

提高模型质量的一种方法是**将数据**分成不同的子组，以基于每个步骤中使用的不同数据来构建测试管道。常见的方法是将用于模型开发的数据分为训练集和测试集。典型的比例是 80/20，80%是训练集，20%是测试集。分割取决于总数据集的大小。当数据集非常大时，将测试集份额降低到 20%以下就足够了。包含生产数据后，**分割过程产生三个数据集**:

*   培训用数据
*   测试数据
*   生产数据

一旦模型建立在训练集上，就可以测量训练误差，这是模型在训练集本身上达到的精度——这也称为**偏差**。当模型在训练数据上表现不佳时，这通常是由拟合不足引起的。在这种情况下，模型的复杂性太低，以至于无法捕获手边数据集中的逻辑。

当模型在初始训练后应用于测试数据时，可以评估泛化误差(=模型未见过的新案例的误差率)。这是通过将测试集的模型预测与测试集的预测标签的真实值进行比较来执行的。当模型在训练数据上表现良好但在测试数据上表现不佳时，这可以被描述为**方差**，并且通常是由过度拟合引起的。

第三种模式，即数据不匹配，已经在*数据挑战*部分中定义，这通常是将测试模型应用于现实世界中的生产数据时出现错误的原因。

## **过拟合**

过度拟合是高泛化误差的常见原因。这意味着模型在训练数据中有过度解释的模式，并且调整得太好。

由于数据经常是基于大量的机会和噪声收集的，所以模型不适合收集每一个小模式。当这样做时，它无法区分哪部分数据是要检测的真实模式的一部分，哪部分只是噪声。过度拟合通常发生在模型太复杂、数据集太嘈杂或太小的时候。可以通过以下措施解决:

**降低机器学习模型的复杂度**…

*   通过选择**更简单的模型类型**(=低次多项式模型代替复杂的深度神经网络)或**不同的模型架构**(即其他神经网络类型)
*   通过**减少模型的参数**(低次多项式或线性模型代替高次多项式模型)
*   通过**应用 L2 或 L1 正则化或剔除来约束模型**
*   通过**将提前停止**添加到模型中，以便在目标错误率(即从生产目标/KPI 中扣除的比率)时停止学习

**改变/微调输入模型的数据**

*   通过**减少**特征**数量**或选择更多相关特征进行训练
*   通过简单地**收集更多的数据**，只要它是可用的并且计算能力不是问题
*   通过**降低噪声**(=修复/平衡误差并消除异常值)

## **欠配合**

拟合不足指的是模型对于它所训练的数据集来说过于简单，因此产生的结果很差。可以解决的杠杆类似于过度装配，但通常是以相反的方式拉动。

**增加机器学习模型的复杂度**…

*   通过**选择更复杂的模型类型**(=多项式模型而不是线性模型，一个神经网络有更多的层/神经元)或**不同的模型架构**(例如其他 ANN 类型)
*   通过**减少先前可能已经应用的约束**(例如，L2 和 L1 正则化、丢弃)

**改变/微调输入模型的数据**

*   通过**选择基于误差分析**更相关**的特征**
*   通过**增加特征**使其基于特征工程方法更加相关(即特征也可以被规则化)

# **总结**

在机器学习工作流中，采取几个步骤来训练由学习算法驱动的模型，以最终对未来做出预测。这包括从问题陈述和数据收集到最终的模型建立和改进的步骤。作为最终产品，该模型应该能够推广到新的情况，并在实际应用程序的生产环境中做出有益的预测。

机器学习模型的结果受许多因素的影响。两个主要群体是**数据和模型挑战**。在**数据挑战**的背景下，需要关注的关键问题是:

*   数据量
*   典型资料
*   数据质量
*   特征相关性
*   机器可读性

与**车型**制造流程相关的两个关键**挑战**是:

*   过度拟合
*   欠拟合

虽然这些因素经常被认为是重要的，但这个列表并不详尽，除了本文之外，还应该考虑其他途径。《Scikit-Learn、Keras 和 TensorFlow 的机器学习实践:构建智能系统的概念、工具和技术》一书[是一个很好的来源，该书对讨论的内容和实践练习提供了更多的深度。](https://www.amazon.de/gp/product/1492032646/ref=as_li_tl?ie=UTF8&camp=1638&creative=6742&creativeASIN=1492032646&linkCode=as2&tag=felixfrohboes-21&linkId=e8d9415d67caf9daede156b645b2e5ed)