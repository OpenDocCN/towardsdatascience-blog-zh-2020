<html>
<head>
<title>Lyric-based song recommendation with Doc2Vec embeddings and Spotify’s API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于歌词的歌曲推荐，带有 Doc2Vec 嵌入和 Spotify 的 API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2?source=collection_archive---------29-----------------------#2020-07-19">https://towardsdatascience.com/lyric-based-song-recommendation-with-doc2vec-embeddings-and-spotifys-api-5a61c39f1ce2?source=collection_archive---------29-----------------------#2020-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5f36" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用深度学习和自然语言处理理解歌词。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cde7354d8d6d7f8f9faa30753f088f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_wdfh05sYVBqhbe1a2LQ5w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">近 3000 首歌曲嵌入的二维表示，由艺术家着色。</p></figure><h1 id="d217" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">单词嵌入和歌曲嵌入</h1><p id="3a5d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">单词嵌入对于自然语言处理来说是一个非常有用的工具。它们通常作为神经网络的参数被学习，并允许我们将单词映射到数字。更具体地说，它们允许我们将单词映射到高维向量。既然词向量用数字来表示信息，我们就可以利用它们之间的关系来理解它们所表示的词之间的关系。</p><p id="a86c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果我们可以嵌入单个单词，那么我们就可以嵌入句子、段落，甚至整个文档。事实证明，如果你能找到一种方法使它适合一个模型的架构，你可以为任何东西创建嵌入。</p><p id="f8f1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">通过基于歌词训练歌曲嵌入，我们可以测量空间中点之间的关系，以理解歌曲之间的关系。</p><h1 id="9b64" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">用例:歌曲推荐</h1><p id="b553" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">如果我们已经训练了歌曲嵌入，那么我们将有一个对应于每首歌曲的 N 维向量。我们可以计算出从一首歌到其他每首歌的距离。那么，“最接近”的歌曲就是会被推荐的歌曲。</p><p id="b1fc" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我们需要做的只是获取一些歌词，训练嵌入，然后构建一个可以测量距离并提供推荐的应用程序。</p><h1 id="3c78" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">数据</h1><p id="b3ee" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我用的是 musiXmatch 数据集，这是百万首歌曲数据集的官方歌词集。我选择这个数据集是因为它包含 237，662 首歌曲，是可供研究的最大的干净歌词集。</p><p id="ee5f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">由于版权问题阻止了完整的原创歌词的分发，数据以单词包的形式出现。这意味着我们不能按照单词出现的顺序来获取它们。取而代之的是，我们得到一个单词列表以及它们在每首歌中出现的次数。</p><p id="e00f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">单词袋格式可能会导致一些信息丢失，但这是一个很好的起点。Kaggle 上也有一些数据集包含了完整的歌词，也可以使用。</p><h1 id="c494" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">建模</h1><p id="3901" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我们建模的目标是学习数据集中歌曲的高维嵌入。这可以通过<em class="mo">分布式单词包段落向量(PV-DBOW) </em>模型来完成，该模型以如下方式工作。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/bbf24441612181a95a172648a2ee8662.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*ZtIdCh9ARGieQ98jOmXqeQ.png"/></div></figure><p id="ffbe" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">在我们的例子中，<em class="mo">段</em>实际上是一首歌。在训练的每次迭代中，对文本窗口进行采样以创建段落矩阵。然后，从该文本窗口中随机抽取一个单词。我们尝试使用段落矩阵作为输入来预测单词，并对模型权重进行更新。这些权重包括构成段落向量的权重。</p><p id="9a09" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果我们有原始歌词，我们可以使用分布式内存段落向量(PV-DM)。这个模型可能会通过考虑单词出现的顺序来改善我们的结果。关于段落向量的更多信息可以在<a class="ae mq" href="https://arxiv.org/pdf/1405.4053v2.pdf" rel="noopener ugc nofollow" target="_blank">本文</a>中找到。</p><p id="2e63" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><a class="ae mq" href="https://radimrehurek.com/gensim/models/doc2vec.html" rel="noopener ugc nofollow" target="_blank"> Gensim </a>是我们将使用的工具。它是一个 python 库，使得实现上述 PV-DBOW 模型变得很容易。该笔记本包含用于训练和可视化 musiXmatch 数据集歌词嵌入的代码。</p><h1 id="1b45" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">t-SNE 和可视化</h1><p id="7dcb" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mq" rel="noopener" target="_blank" href="/an-introduction-to-t-sne-with-python-example-5a3a293108d1">t-分布式随机邻居嵌入(t-SNE) </a>是一种降维技术，对于可视化高维数据特别有用。它基于高维空间中的点的邻域来估计概率分布，并试图在低维空间中重建该分布。</p><p id="99b2" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">t-SNE 的一个好处是它倾向于保持当地的关系。因此，我们可以在低维中绘制点，以了解高维空间中的关系。</p><p id="306c" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">当应用于 musiXmatch 数据集时，它看起来像这样。每个点代表一首歌，由艺术家上色。轴上的值本身没有意义，但它们有助于创建歌曲之间距离的概念。</p><p id="e12d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">艺术家之间的关系可以保证模型按预期工作。总的来说，我们应该期待看到相似艺术家的歌曲比不同流派艺术家的歌曲更接近。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/6ca0b9cbdfe43cac03d5a7e46aab039f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vs2h3cc8h-NRBkCxEw5qWA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">三位艺术家的歌词嵌入</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/71ba045a4dba3258c1682e82d944e59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OZ8VqCbAfaTcuF9R5ghAmg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">十位艺术家的歌词嵌入</p></figure><h1 id="a410" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">构建应用程序</h1><p id="b68b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mq" href="https://palletsprojects.com/p/flask/" rel="noopener ugc nofollow" target="_blank"> Flask </a>是一个用于构建 web 应用的 python 库。使用 Flask，我构建了一个应用程序，允许用户在 musiXmatch 数据集中搜索音乐，并与 Spotify 的 API 进行交互。幸运的是，我找到了一个很好的资源，而且不用重新发明轮子:<a class="ae mq" href="https://github.com/mari-linhares/spotify-flask" rel="noopener ugc nofollow" target="_blank"> Spotify-Flask </a>作者<a class="ae mq" href="https://github.com/mari-linhares" rel="noopener ugc nofollow" target="_blank"> mari-linhares </a>。</p><ul class=""><li id="2a61" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated">您可以通过此链接访问该应用:<a class="ae mq" href="http://52.10.28.182:8081/" rel="noopener ugc nofollow" target="_blank">http://52.10.28.182:8081/</a></li></ul><p id="dad4" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">登录 Spotify 的认证流程并授予权限后，用户可以导航到一个页面，提示他们输入歌曲标题、艺术家和要返回的歌曲数量。如果可能的话，用户的顶级艺术家会被推荐给他们以获得灵感。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/42472f1cbd8d1ab7732a6959f32083c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKB4w6OTfXvtcD_ahmemGg.png"/></div></div></figure><p id="4828" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">一旦选择了初始歌曲，通过测量嵌入之间的<a class="ae mq" href="https://en.wikipedia.org/wiki/Cosine_similarity" rel="noopener ugc nofollow" target="_blank">余弦相似度</a>来找到相似的歌曲。相似的歌曲与 Spotify 的目录交叉引用，可用的歌曲将返回给用户。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/013ac875ea87eadcb7847497dcc35210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CpH9w6Lv84J7Wx_z4jTtOA.png"/></div></div></figure><p id="71f1" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">如果用户喜欢返回的歌曲，他们可以将它们保存到 Spotify 播放列表中。如果没有，他们可以再试一次。</p><h1 id="3cbb" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">未来的工作</h1><p id="4db2" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">歌曲推荐只是歌词嵌入的众多应用之一。歌词向量可以用来揭示艺术家和他们的音乐之间的新关系。</p><p id="239e" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">另一方面，基于歌词的歌曲嵌入可能只是更大的推荐引擎的一小部分。当前的应用程序在搜索类似的歌曲时只使用歌词，但是当除了歌曲的内容之外还考虑歌曲的发音时，肯定会获得更好的推荐。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="fa29" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated">我将很高兴收到以上任何反馈。欢迎发表评论，或通过 areevesman@gmail.com 的<a class="ae mq" href="https://www.linkedin.com/in/adamreevesman/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>/电子邮件联系。</p><h1 id="721f" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">资源</h1><p id="6e83" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">该项目的相关资源包括如下。</p><p id="6935" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">链接到应用程序</strong></p><ul class=""><li id="81ff" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="http://52.10.28.182:8081/" rel="noopener ugc nofollow" target="_blank">http://52.10.28.182:8081/</a></li></ul><p id="94eb" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">代码</strong></p><ul class=""><li id="66a4" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="https://github.com/areevesman/lyric-embeddings/blob/master/train_example.ipynb" rel="noopener ugc nofollow" target="_blank">我用于培训和可视化嵌入的笔记本</a></li></ul><p id="71e8" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">数据</strong></p><ul class=""><li id="bb3f" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="http://millionsongdataset.com/musixmatch/" rel="noopener ugc nofollow" target="_blank"> musiXmatch 数据集</a></li></ul><p id="b93d" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir"> Gensim 和段落向量</strong></p><ul class=""><li id="7b0f" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="https://arxiv.org/pdf/1405.4053v2.pdf" rel="noopener ugc nofollow" target="_blank"> Quoc Le 和 Tomas Mikolov:“句子和文档的分布式表示”</a></li><li id="1d12" class="ms mt iq lp b lq nk lt nl lw nm ma nn me no mi mx my mz na bi translated"><a class="ae mq" href="https://radimrehurek.com/gensim/models/doc2vec.html" rel="noopener ugc nofollow" target="_blank"> Gensim doc2vec 文档</a></li></ul><p id="fefa" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">关于 t-SNE 的更多信息</strong></p><ul class=""><li id="798c" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="https://mlexplained.com/2018/09/14/paper-dissected-visualizing-data-using-t-sne-explained/#:~:text=It%20uses%20the%20local%20relationships,points%20in%20high%2Ddimensional%20space" rel="noopener ugc nofollow" target="_blank">论文解析:“使用 t-SNE 可视化数据”解释</a></li><li id="47e0" class="ms mt iq lp b lq nk lt nl lw nm ma nn me no mi mx my mz na bi translated"><a class="ae mq" rel="noopener" target="_blank" href="/an-introduction-to-t-sne-with-python-example-5a3a293108d1">用 Python 例子介绍 t-SNE</a></li></ul><p id="ad2f" class="pw-post-body-paragraph ln lo iq lp b lq mj jr ls lt mk ju lv lw ml ly lz ma mm mc md me mn mg mh mi ij bi translated"><strong class="lp ir">网络应用</strong></p><ul class=""><li id="989c" class="ms mt iq lp b lq mj lt mk lw mu ma mv me mw mi mx my mz na bi translated"><a class="ae mq" href="https://palletsprojects.com/p/flask/" rel="noopener ugc nofollow" target="_blank"> Flask 的网站</a></li><li id="d550" class="ms mt iq lp b lq nk lt nl lw nm ma nn me no mi mx my mz na bi translated"><a class="ae mq" href="https://developer.spotify.com/documentation/web-api/" rel="noopener ugc nofollow" target="_blank"> Spotify API 文档</a></li><li id="0278" class="ms mt iq lp b lq nk lt nl lw nm ma nn me no mi mx my mz na bi translated"><a class="ae mq" href="https://github.com/mari-linhares/spotify-flask" rel="noopener ugc nofollow" target="_blank"> Spotify-Flask </a></li></ul></div></div>    
</body>
</html>