<html>
<head>
<title>Applying Darwinian Evolution to feature selection with Kydavra GeneticAlgorithmSelector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Kydavra 遗传算法选择器将达尔文进化应用于特征选择</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/applying-darwinian-evolution-to-feature-selection-with-kydavra-geneticalgorithmselector-378662fd1f5b?source=collection_archive---------63-----------------------#2020-08-17">https://towardsdatascience.com/applying-darwinian-evolution-to-feature-selection-with-kydavra-geneticalgorithmselector-378662fd1f5b?source=collection_archive---------63-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/392eab7c3d033e519cc5968c65b5aa26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CdOd_w9hK7yhgnOu_C8OPg.png"/></div></div></figure><p id="cf98" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi kz translated">在与功能选择相关的问题上，aths 几乎总能给出很好的答案。然而，有时古老的暴力算法可以给游戏带来更好更实用的答案。</p><p id="5b30" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">遗传算法是一系列受生物进化启发的算法，基本上使用循环——交叉、变异、尝试，根据评分标准开发最佳状态组合。所以，让我们来看看代码。</p><h2 id="f0fb" class="li lj it bd lk ll lm dn ln lo lp dp lq km lr ls lt kq lu lv lw ku lx ly lz ma bi translated">使用 Kydavra 库中的 GeneticAlgorithmSelector。</h2><p id="f007" class="pw-post-body-paragraph kb kc it kd b ke mb kg kh ki mc kk kl km md ko kp kq me ks kt ku mf kw kx ky im bi translated">要安装 kydavra，只需在终端中写入以下命令:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="6e1a" class="li lj it ml b gy mp mq l mr ms">pip install kydavra</span></pre><p id="a1b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，您可以导入选择器并将其应用于数据集，如下所示:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="a750" class="li lj it ml b gy mp mq l mr ms">from kydavra import GeneticAlgorithmSelector</span><span id="497a" class="li lj it ml b gy mt mq l mr ms">selector = GeneticAlgorithmSelector()</span><span id="c8af" class="li lj it ml b gy mt mq l mr ms">new_columns = selector.select(model, df, ‘target’)</span></pre><p id="b321" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就像所有的 Kydavra 选择器一样。现在让我们在心脏病数据集上尝试一下。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e522" class="li lj it ml b gy mp mq l mr ms">import pandas as pd</span><span id="a3af" class="li lj it ml b gy mt mq l mr ms">df = pd.read_csv(‘cleaned.csv’)</span></pre><p id="a6bf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我强烈建议您在应用选择器之前对数据集进行洗牌，因为它使用了度量标准(目前 cross_val_score 还没有在这个选择器中实现)。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="3338" class="li lj it ml b gy mp mq l mr ms">df = df.sample(frac=1).reset_index(drop=True)</span></pre><p id="a9e8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们可以应用我们的选择器。提到它有一些参数:</p><ul class=""><li id="b397" class="mu mv it kd b ke kf ki kj km mw kq mx ku my ky mz na nb nc bi translated"><strong class="kd iu"> nb_children </strong> (int，default = 4)算法将为下一代选择的最佳子代的数量。</li><li id="70ce" class="mu mv it kd b ke nd ki ne km nf kq ng ku nh ky mz na nb nc bi translated"><strong class="kd iu"> nb_generation </strong> (int，default = 200)将要创建的代数，技术上讲就是迭代次数。</li><li id="b372" class="mu mv it kd b ke nd ki ne km nf kq ng ku nh ky mz na nb nc bi translated"><strong class="kd iu">scoring _ metric</strong>(sk learn scoring metric，default = accuracy_score)用于选择最佳特征组合的度量分数。</li><li id="0859" class="mu mv it kd b ke nd ki ne km nf kq ng ku nh ky mz na nb nc bi translated"><strong class="kd iu"> max </strong> (boolean，default=True)如果设置为 True，算法将选择得分最高的组合，如果设置为 False，将选择得分最低的组合。</li></ul><p id="607a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是现在，我们将使用除 scoring_metric 之外的基本设置，因为我们有一个疾病诊断的问题，所以最好使用 Precision 而不是 accuracy。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="b43d" class="li lj it ml b gy mp mq l mr ms">from kydavra import GeneticAlgorithmSelector</span><span id="0785" class="li lj it ml b gy mt mq l mr ms">from sklearn.metrics import precision_score</span><span id="f81d" class="li lj it ml b gy mt mq l mr ms">from sklearn.ensemble import RandomForestClassifier</span><span id="8c7b" class="li lj it ml b gy mt mq l mr ms">selector = GeneticAlgorithmSelector(scoring_metric=precision_score)</span><span id="a2c4" class="li lj it ml b gy mt mq l mr ms">model = RandomForestClassifier()</span></pre><p id="b90f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以现在让我们找到最好的特性。GAS(genetical gorithm selector 的简称)在选择特征、数据框本身以及目标列的名称的过程中需要一个 sklearn 模型进行训练:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="9615" class="li lj it ml b gy mp mq l mr ms">selected_cols = selector.select(model, df, 'target')</span></pre><p id="f870" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们来评估结果。在特征选择之前，随机森林的精度分数是-0.805。气体选择以下特性:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="8279" class="li lj it ml b gy mp mq l mr ms">['age', 'sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'thal']</span></pre><p id="655e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这给出了下面的精度分数——0.823。这是一个好结果，要知道在大多数情况下，很难提高评分标准。</p><figure class="mg mh mi mj gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/20f73cb96e2fa41d8d3ff82eaee5bd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*UEuA3iIXXDXC-QuXwD_MhA.gif"/></div></figure><p id="d896" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">如果你想了解更多关于遗传算法的知识，在文章的底部有一些有用的链接。如果您尝试了 Kydavra，并有一些问题或反馈，请通过媒体与我联系，或者请填写此<a class="ae nj" href="https://vpapaluta.typeform.com/to/g1EXxlSf" rel="noopener ugc nofollow" target="_blank">表格</a>。</p><p id="bb62" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由西格蒙德用❤制成</p><p id="156e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有用的链接:</p><ul class=""><li id="b981" class="mu mv it kd b ke kf ki kj km mw kq mx ku my ky mz na nb nc bi translated"><a class="ae nj" rel="noopener" target="_blank" href="/the-most-important-part-in-artifical-intesystems-development-243f04f73fcd">https://towards data science . com/the-most-important-part-in-artificial-intesystems-development-243 f 04 f 73 fcd</a></li></ul></div></div>    
</body>
</html>