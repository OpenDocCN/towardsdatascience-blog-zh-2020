<html>
<head>
<title>Diamond price prediction based on their cut, colour, clarity, price with PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyTorch根据切割、颜色、净度和价格预测钻石价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/diamond-price-prediction-based-on-their-cut-colour-clarity-price-with-pytorch-1e0353d2503b?source=collection_archive---------21-----------------------#2020-06-15">https://towardsdatascience.com/diamond-price-prediction-based-on-their-cut-colour-clarity-price-with-pytorch-1e0353d2503b?source=collection_archive---------21-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f34b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">PyTorch中构建简单线性回归模型的指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c6cec7cbfd0596b1eb035c5d76b4ea21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VcjjBv0QmFQ1J_PLmoIfCQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Opensourceforu.com</p></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="7bfb" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">你有没有问过自己，钻石是怎么定价的？这篇文章讨论了基于切割、颜色、净度和其他属性的钻石价格预测，还介绍了使用PyTorch建立一个简单的线性回归模型。</p><p id="5b45" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我的PyTorch之旅从<a class="ae mb" href="https://jovian.ml/forum/c/pytorch-zero-to-gans/18" rel="noopener ugc nofollow" target="_blank">“使用PyTorch进行深度学习:零到Gans”</a>课程开始，现在我们已经进入了该课程的第二周，到目前为止，我们已经在PyTorch中讲述了线性&amp;逻辑回归的基础知识和实现。PyTorch的基本功能请参考这篇<a class="ae mb" href="https://medium.com/@vinneelaero/introduction-to-basic-pytorch-tensor-functions-51cb5b58713" rel="noopener">文章</a>。</p><h1 id="a84c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">线性回归简介:</h1><p id="4f14" class="pw-post-body-paragraph lf lg it lh b li mu ju lk ll mv jx ln lo mw lq lr ls mx lu lv lw my ly lz ma im bi translated">线性回归是机器学习中最简单的算法之一。根据统计，术语<strong class="lh iu">回归</strong>被定义为输出变量和输入变量之间关系的度量，因此，线性回归假设自变量(输入)和因变量(输出)之间存在线性关系。</p><p id="e340" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">更一般地，线性模型通过简单地计算输入要素的加权和以及偏差(也称为截距)项来进行预测。<a class="ae mb" href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/" rel="noopener ugc nofollow" target="_blank">(来源)</a>如下式所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/a65e307ada45529522d1ef22922c746d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bV88gfhLSLCc1izXcRePag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:中央统计局。Brown.edu</p></figure><p id="ad08" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我考虑了经典的钻石数据集，它包含了近54，000颗钻石的价格和其他属性，该数据集托管在<a class="ae mb" href="https://www.kaggle.com/shivam2503/diamonds" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上。数据集包含53940行和10个变量。在开始构建模型之前，让我们来看看变量&amp;的定义。</p><ul class=""><li id="0dbb" class="nc nd it lh b li lj ll lm lo ne ls nf lw ng ma nh ni nj nk bi translated"><strong class="lh iu">价格</strong>以美元为单位</li><li id="b1ca" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">克拉</strong>钻石的重量</li><li id="4a1e" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">切割</strong>切割质量(一般、良好、非常好、优质、理想)</li><li id="924f" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">颜色</strong>钻石颜色，从J(最差)到D(最好)</li><li id="c535" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">净度</strong>衡量钻石净度的指标(I1(最差)、SI2、SI1、VS2、VS1、VVS2、VVS1、IF(最佳))</li><li id="795d" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu"> x </strong>长度单位为毫米</li><li id="904b" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu"> y </strong>宽度单位为毫米</li><li id="8211" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu"> z </strong>深度以米为单位</li><li id="23c5" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">深度</strong>:钻石的高度</li><li id="8c8d" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><strong class="lh iu">表</strong>:钻石台面的宽度，以其平均直径的百分比表示</li></ul><h1 id="d711" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">让我们根据以下步骤开始构建线性回归模型</h1><ol class=""><li id="6f8e" class="nc nd it lh b li mu ll mv lo nq ls nr lw ns ma nt ni nj nk bi translated">导入所需的包</li><li id="b97c" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">加载数据集</li><li id="15a3" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">执行探索性数据分析(EDA)</li><li id="9ebb" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">为训练准备数据集</li><li id="adb4" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">创建线性回归模型</li><li id="734d" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">训练模型以适应数据</li><li id="7fae" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated">使用训练好的模型进行预测</li></ol><h1 id="89b0" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤1:导入所需的包</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="584b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤2:加载数据集</h1><p id="7ff9" class="pw-post-body-paragraph lf lg it lh b li mu ju lk ll mv jx ln lo mw lq lr ls mx lu lv lw my ly lz ma im bi translated">为了加载数据集，我们将使用<code class="fe nu nv nw nx b">pd.read_csv()</code>函数，它会将数据集转换为数据帧，并使用<code class="fe nu nv nw nx b">pd.head()</code>函数查看数据集的前5行</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="6bb6" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">删除不必要的列“未命名:0”</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="95ae" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">数据集有53940行和10个变量</p><h1 id="64ab" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤3:探索性数据分析(EDA)</h1><p id="71ed" class="pw-post-body-paragraph lf lg it lh b li mu ju lk ll mv jx ln lo mw lq lr ls mx lu lv lw my ly lz ma im bi translated">看看数据集的简明摘要</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="73db" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">数据集中没有空数据，也可以使用<code class="fe nu nv nw nx b">data.isnull().any</code>进行检查。给定的数据集有6个数值列和3个非数值(分类)列</p><p id="6f97" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">使用<code class="fe nu nv nw nx b">pd.describe()</code>获取数据集的描述性统计数据</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="9293" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">观察到x(长度)、y(宽度)和z(深度)的最小值为零，并且使钻石的长度\宽度\深度为零没有任何意义。</p><p id="ccc2" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们放弃这几行</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="49f4" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">观察到x、y和z的最小值是非零值</p><p id="ce23" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">用<code class="fe nu nv nw nx b">hist()</code>法绘制数值属性的分布</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="563d" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们看看数据集的配对图。配对图允许我们看到变量的分布以及两个变量之间的关系</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="abcf" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">观察到x、y和z变量相对于因变量(目标)价格具有良好的相关性，让我们通过使用<code class="fe nu nv nw nx b">.corr()</code> &amp;来量化这种相关性，并使用<code class="fe nu nv nw nx b">sns.heatmap()</code>方法将其可视化</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="722d" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们可以得出结论，克拉，x，y &amp; z特征与w.r.t价格变量有很强的相关性，而深度与w.r.t价格变量的相关性很弱。因此，我们可以从模型的最终输入特征列表中删除深度特征。</p><p id="4c08" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们通过使用箱线图来了解目标(价格)变量的分类特征</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="00f1" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我使用箱线图来比较给定分类变量类别之间的数据分布、集中趋势(中值)和可变性，这些图也有助于识别异常值。</p><p id="d357" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">到目前为止，我已经做了非常初步的数据探索，以了解这些特征及其与目标变量的关系。本文的主要目标是在PyTorch中实现线性回归，所以让我们停止数据探索，直接进入本文的核心部分。</p><p id="ddbd" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在继续构建模型之前，最好将分类数据转换为数值数据，有两种方法可以转换为数值形式1。标签编码器或整数编码2。一键编码</p><p id="9d27" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">一般来说，一键编码做得很好，更多细节请参考此<a class="ae mb" href="https://jovian.ml/outlink?url=https%3A%2F%2Fmachinelearningmastery.com%2Fwhy-one-hot-encode-data-in-machine-learning%2F" rel="noopener ugc nofollow" target="_blank">链接</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="8bdf" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤4:为训练准备数据集</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="38c7" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们需要将熊猫数据框架中的数据转换成PyTorch张量用于训练。为此，第一步是将它转换成NumPy数组</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="bf69" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">现在，我们需要为训练和验证创建PyTorch数据集和数据加载器。第一步是通过使用<code class="fe nu nv nw nx b">torch.tensor</code>函数将输入的&amp;目标数组转换成张量来创建<code class="fe nu nv nw nx b">TensorDataset</code></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="dc3d" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">现在，我们将把数据集分为训练和验证数据集。训练集将用于训练模型，而验证集用于评估模型&amp;它还用于调整超参数(学习率、时期、批量等..)以便更好地概括训练模型。</p><p id="5851" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们将使用<code class="fe nu nv nw nx b">random_split</code>函数将数据集分割成所需百分比的训练&amp;验证</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="e501" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们来看一组数据，以验证到目前为止一切正常。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="3456" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">xb和yb的形状表明到目前为止一切都运行良好</p><h1 id="2009" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤5:创建线性回归模型</h1><p id="f4a1" class="pw-post-body-paragraph lf lg it lh b li mu ju lk ll mv jx ln lo mw lq lr ls mx lu lv lw my ly lz ma im bi translated">我们将通过扩展PyTorch的<code class="fe nu nv nw nx b">nn.Module</code>类来创建线性回归模型</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="d985" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在<code class="fe nu nv nw nx b">__init__</code>构造函数方法中，我们使用<code class="fe nu nv nw nx b">nn.Linear</code>函数实例化权重和偏差。在forward方法中，当我们将一批输入传递给模型时会调用这个方法，它会将输入传递给<code class="fe nu nv nw nx b">self.linear</code>。定义的神经网络将如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/284e11b2072d4d2ee7eba120fc859976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*pn0B4bzQ16DAr9-34Q9HpQ.png"/></div></figure><p id="1698" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们已经定义了模型并实例化了权重和偏差。现在，让我们定义成本函数。</p><p id="e860" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">线性回归的常用成本函数(J)是均方误差(MSE)。该函数计算预测值和目标值之间的差值，并对其求平方。成本函数衡量评估模型性能的好坏。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="b23b" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><code class="fe nu nv nw nx b">training_step</code> &amp; <code class="fe nu nv nw nx b">validation_step</code>该方法分别计算每个训练&amp;验证批次的预测&amp; MSE损失。该方法返回每个历元的平均验证损失。请参考此<a class="ae mb" href="https://jovian.ml/forum/t/lecture-2-working-with-images-logistic-regression/1542/333" rel="noopener ugc nofollow" target="_blank">链接</a>以了解历元&amp;迭代之间的差异。</p><p id="8c17" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们通过调用<code class="fe nu nv nw nx b">DiamondPriceModel()</code>类创建一个模型对象</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="c6f9" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤6:训练模型以适应数据</h1><ul class=""><li id="0999" class="nc nd it lh b li mu ll mv lo nq ls nr lw ns ma nh ni nj nk bi translated">线性回归的主要目标是最小化成本函数。</li><li id="027d" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nh ni nj nk bi translated"><a class="ae mb" href="https://jovian.ml/outlink?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DIHZwWFHWa-wis" rel="noopener ugc nofollow" target="_blank">梯度下降</a>是一种帮助最小化成本函数的优化算法，其主要目的是找出全局最小值。这里，梯度表示函数的变化率，它指向函数最大增长的方向。为了最小化成本函数，我们需要执行成本函数(J)相对于其参数(权重(w) &amp;偏差(b))的梯度。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/ee9111798be5960033417bf7eb940f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrFZV7pKPcc5dzLaWvngtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae mb" href="http://rasbt.github.io/" rel="noopener ugc nofollow" target="_blank">http://rasbt.github.io/</a></p></figure><p id="acef" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><strong class="lh iu">注意</strong>:学习率α是一种控制权重更新量的方法。如果我们选择一个小的学习率，我们的模型训练可能需要很长时间。但是如果选择大的学习率，可能会超调，我们的训练永远不会收敛。具体的学习率取决于我们的数据和我们使用的模型类型，但通常最好在[1e 8，1e 1]范围内探索。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="046d" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><code class="fe nu nv nw nx b">evaluate</code>函数，调用<code class="fe nu nv nw nx b">validation_step</code> &amp; <code class="fe nu nv nw nx b">validation_epoch_end</code>方法，返回每个历元后的平均验证损失。</p><p id="b990" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><code class="fe nu nv nw nx b">fit</code>函数通过在<a class="ae mb" href="https://jovian.ml/outlink?url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DW9iWNJNFzQI" rel="noopener ugc nofollow" target="_blank">随机梯度下降</a>(梯度下降的一种变体)优化的帮助下更新每一步的参数来执行模型训练。它记录每个时期的确认损失，并返回训练过程的历史。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8b3e" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">最初的验证损失非常高，这是人们从随机初始化的模型中可能期望的。目标是使用足够的历元和合适的学习速率来最小化这种损失。这是一个反复试验的过程，以产生最适合我们的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="f4af" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">运行该模型800个时期，验证损失已经减少到1276336.0000。现在，让我们用验证数据来测试模型。</p><h1 id="85f1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">步骤7:根据验证数据测试模型</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="93e1" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><code class="fe nu nv nw nx b">predict_single</code>函数返回给定输入张量的预测钻石价格值。</p><p id="35a4" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">测试# 1</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="05bb" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">测试# 2</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="0d89" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">通过在当前模型中引入隐藏层可以提高模型性能，并且可以进一步将优化器改进为<a class="ae mb" href="https://jovian.ml/outlink?url=https%3A%2F%2Farxiv.org%2Fabs%2F1412.6980" rel="noopener ugc nofollow" target="_blank"> Adam优化器。</a></p><p id="aa00" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><strong class="lh iu">代码库:</strong>你可以在我的<a class="ae mb" href="https://github.com/vineel369/DeepLearning-with-PyTorch/blob/master/01_Linear%20Regression/Linear_Regression_with_Pytorch_Diamond_Price_prediction_final.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>找到笔记本。</p><p id="80b2" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">嗯！！我们刚刚使用PyTorch完成了第一个机器学习算法。感谢阅读！！并尝试使用自己的数据集。</p><p id="7c9c" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">快乐学习！编码快乐！</p><h1 id="5483" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">参考资料:</h1><ol class=""><li id="3d78" class="nc nd it lh b li mu ll mv lo nq ls nr lw ns ma nt ni nj nk bi translated">https://www.youtube.com/watch?v=4ZZrP68yXCI&amp;feature = youtu . be</li><li id="e7c5" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated"><a class="ae mb" href="https://github.com/madewithml/basics/blob/master/notebooks/07_Linear_Regression/07_PT_Linear_Regression.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/madewithml/basics/blob/master/notebooks/07 _ Linear _ Regression/07 _ PT _ Linear _ Regression . ipynb</a></li><li id="1720" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated"><a class="ae mb" href="https://cs.brown.edu/courses/csci1951-a/assignments/stats_handout.html" rel="noopener ugc nofollow" target="_blank">https://cs . brown . edu/courses/csci 1951-a/assignments/stats _讲义. html </a></li><li id="21a8" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated"><a class="ae mb" href="https://jovian.ml/forum/c/pytorch-zero-to-gans/18" rel="noopener ugc nofollow" target="_blank">https://jovian.ml/forum/c/pytorch-zero-to-gans/18</a></li><li id="5587" class="nc nd it lh b li nl ll nm lo nn ls no lw np ma nt ni nj nk bi translated"><a class="ae mb" href="https://www.kaggle.com/shivam2503/diamonds" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/shivam2503/diamonds</a></li></ol></div></div>    
</body>
</html>