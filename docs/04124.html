<html>
<head>
<title>Searching and Replacing Text</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">搜索和替换文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/searching-and-replacing-text-db983d19a184?source=collection_archive---------28-----------------------#2020-04-15">https://towardsdatascience.com/searching-and-replacing-text-db983d19a184?source=collection_archive---------28-----------------------#2020-04-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="885b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python 中的文本操作</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1d48ba43db56167078d441e90c08eef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PSsnoIRF8T2b5ySLGlyycg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/close-up-photography-of-eyeglasses-at-golden-hour-690887/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="7b1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文本操作包括诸如分离字符串、搜索、替换和解析等操作。虽然这些任务中有许多可以使用 python 中的内置字符串方法来完成，但更复杂的操作需要正则表达式。在这篇文章中，我们将讨论如何使用 python 中的正则表达式模块来搜索和替换文本。</p><p id="96a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="6738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们考虑下面的字符串文字:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="471e" class="ma mb it lw b gy mc md l me mf">text1 = "python is amazing. I love python, it is the best language. python is the most readable language."</span></pre><p id="ee22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设，出于某种疯狂的原因，我们想用“c++”替换“python”。我们可以使用“str.replace()”方法:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a5f9" class="ma mb it lw b gy mc md l me mf">text1 = text1.replace('python', 'C++')</span></pre><p id="cee5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印结果:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="373b" class="ma mb it lw b gy mc md l me mf">print(text1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/531bbd16a1b2a22e8cf0b737c9b3319d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qIl33KTuKace9f9fsAFVlQ.png"/></div></div></figure><p id="f7f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于更复杂的模式，我们可以使用“re”模块中的“re.sub()”方法。让我们导入正则表达式模块“re”:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c9ef" class="ma mb it lw b gy mc md l me mf">import re</span></pre><p id="d025" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想将以下字符串中的日期格式从“12/01/2017”更改为“2017–12–01”:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ce37" class="ma mb it lw b gy mc md l me mf">text2 = "The stable release of python 3.8 was on 02/24/2020. The stable release of C++17 was on 12/01/2017."</span></pre><p id="f006" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用' re.sub()'方法来重新格式化这些日期:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e7ee" class="ma mb it lw b gy mc md l me mf">text2 = re.sub(r'(\d+)/(\d+)/(\d+)', r'\3-\1-\2', text2)<br/>print(text2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/0ecff305f534b8a953e8fc71ffb05d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*in7Dvls4Xetf55HpKNHRiw.png"/></div></div></figure><p id="2843" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">替换方法中的第一个参数“r'(\d+)/(\d+)/(\d+)'”是要匹配的模式。“\d+”表达式对应于 0–9 范围内的数字字符。第二个参数“r'\3-\1-\2 '”是替换模式。替换模式中的数字指的是模式中的捕获组号。在这种情况下，组 1 是月，组 2 是日，组 3 是年。我们可以使用“group()”、“match()”和“compile()”方法直接看到这一点:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f13a" class="ma mb it lw b gy mc md l me mf">date_pattern = re.compile(r'(\d+)/(\d+)/(\d+)')<br/>date_pattern.match(“12/01/2017”)<br/>print(date_pattern.group(1))<br/>print(date_pattern.group(2))<br/>print(date_pattern.group(3))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/57518e8e0cd9327e9dd94d47370ef258.png" data-original-src="https://miro.medium.com/v2/resize:fit:136/format:webp/1*HFbXO_ljLuVXRaPqvfrHpg.png"/></div></figure><p id="aef2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">编译替换模式还会提高重复替换的性能。让我们编译匹配模式:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9f69" class="ma mb it lw b gy mc md l me mf">date_pattern = re.compile(r'(\d+)/(\d+)/(\d+)')</span></pre><p id="09cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后使用替换模式调用替换方法:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a10e" class="ma mb it lw b gy mc md l me mf">date_pattern = date_pattern.sub(r'\3-\1-\2', text2)</span></pre><p id="04ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以为更复杂的替换指定一个替换回调函数。例如，如果我们要将“2017 年 12 月 1 日”重新格式化为“2017 年 12 月 1 日”:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7679" class="ma mb it lw b gy mc md l me mf">from calendar import month_abbr<br/>def format_date(date_input):<br/>    month_name = month_abbr[int(m.group(1))]<br/>    return '{} {} {}'.format(date_input.group(2), month_name, date_input.group(3))</span><span id="5c21" class="ma mb it lw b gy mj md l me mf">print(date_pattern.sub(format_date, text2))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/d95f259e41a57e16dfca56ff1329f2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzPsehRh7UKZejpWxyDrZg.png"/></div></div></figure><p id="5ee7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个要考虑的有趣问题是如何以不区分大小写的方式搜索和替换文本。如果我们考虑前面的例子:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c0e9" class="ma mb it lw b gy mc md l me mf">text3 = "Python is amazing. I love python, it is the best language. Python is the most readable language."</span></pre><p id="bdf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，这篇课文中第一句和第二句的第一个单词是大写的。在这种情况下，替换方法将以区分大小写的方式替换文本:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4e9e" class="ma mb it lw b gy mc md l me mf">print(text3.replace('python', 'C++'))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/f19339a1a3d143f1e38e8ddc5429efe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7gBvFqqnrwUsuZ6NMO4U6A.png"/></div></div></figure><p id="f239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到只有小写的“python”被替换了。我们可以使用' re.sub()'通过传递' flags = re 以不区分大小写的方式替换文本。子方法的“IGNORECASE ”:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a263" class="ma mb it lw b gy mc md l me mf">print(re.sub('python', 'C++', text3, flags =re.IGNORECASE))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/53f17e4c5070e327648e4416d18481f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhAnA2Bqh8cPL7bMLTiFKA.png"/></div></div></figure><p id="d202" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到我们得到了想要的结果。我就讲到这里，但是我鼓励你自己去研究代码。</p><h1 id="4123" class="mn mb it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="ae0a" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何使用 python 中的正则表达式模块来搜索和替换文本。我们展示了如何使用替换方法重新格式化字符串中的日期，并以不区分大小写的方式替换文本。如果你想学习更多关于 python 中正则表达式的知识，我推荐 Python 指南 的<a class="ae ky" href="https://d.cxcore.net/Python/Python_Cookbook_3rd_Edition.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="nj">中的“第二章:字符串和文本”。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/regular_expressions/search_and_replace.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。我希望你觉得这篇文章有用/有趣。感谢您的阅读！</em></a></p></div></div>    
</body>
</html>