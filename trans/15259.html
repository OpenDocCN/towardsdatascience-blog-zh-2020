<html>
<head>
<title>The 9 must know functions to handle any pandas dataframe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">9必须知道处理任何熊猫数据帧的函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-9-must-know-functions-to-handle-any-pandas-dataframe-d1d5727e7269?source=collection_archive---------19-----------------------#2020-10-20">https://towardsdatascience.com/the-9-must-know-functions-to-handle-any-pandas-dataframe-d1d5727e7269?source=collection_archive---------19-----------------------#2020-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ddc3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个包含熊猫最常用的所有函数和调用的备忘单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4d55325e8bc0284b32bc7e777998e639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5SXxMpklXrY-WDA4qUUlBg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">伊莲娜·洛希娜在<a class="ae ky" href="https://unsplash.com/s/photos/panda?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="4b53" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">在这篇文章中你会发现:</strong></h2><ul class=""><li id="9543" class="lv lw it lx b ly lz ma mb li mc lm md lq me mf mg mh mi mj bi translated">五个功能<strong class="lx iu">了解你的数据集</strong></li><li id="5661" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated"><strong class="lx iu">按值过滤</strong>您的数据框架</li><li id="de45" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated">有了<strong class="lx iu">日期时间</strong>类型</li><li id="4caf" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated"><strong class="lx iu">合并</strong>多个数据集</li><li id="726b" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated">手柄<strong class="lx iu">列</strong></li><li id="e6c8" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated"><strong class="lx iu">分组</strong> <strong class="lx iu">乘</strong>值</li><li id="7730" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated"><strong class="lx iu">应用</strong>功能</li><li id="c7d7" class="lv lw it lx b ly mk ma ml li mm lm mn lq mo mf mg mh mi mj bi translated">使用<strong class="lx iu">λ</strong>方法</li></ul></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="2a4e" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">如果您还不是会员，请在此获得您的中级会员资格<a class="ae ky" href="https://medium.com/@alejandra.vlerick/membership" rel="noopener"/>！</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="b2e0" class="nl la it bd lb nm nn no le np nq nr lh jz ns ka ll kc nt kd lp kf nu kg lt nv bi translated">1.了解您的数据集</h1><p id="c0ed" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">加载数据集后要做的第一件事是仔细查看数据框中的信息。为此，以下函数正好满足您的需求。</p><p id="2248" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated"><strong class="lx iu"> <em class="nz"> Head() </em> </strong>打印数据集的前5行，包括列标题和每一行的内容。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="cbfc" class="kz la it ob b gy of og l oh oi">df.head()</span></pre><p id="e63f" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated"><strong class="lx iu"> <em class="nz"> Info() </em> </strong>打印列标题和存储在每列中的数据类型。当您试图了解哪些值需要更改类型以便对它们应用函数时，此函数非常有用。存储为字符串的整数在转换为整数之前不会相加。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="e9b5" class="kz la it ob b gy of og l oh oi">df.info()</span></pre><p id="a16c" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated"><strong class="lx iu"> <em class="nz"> Shape() </em> </strong>以格式('行' x '列')给出数据帧的大小。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="9870" class="kz la it ob b gy of og l oh oi">df.shape</span></pre><p id="bcdf" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated"><strong class="lx iu"> <em class="nz"> Describe() </em> </strong>给出数据集中所有数值的平均值、中值、标准差和百分位数。我建议在确保所有数值都存储为整数或浮点数之后，使用describe。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="bc2a" class="kz la it ob b gy of og l oh oi">df.describe()</span></pre><p id="1384" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated"><strong class="lx iu"> <em class="nz">【唯一()</em> </strong>允许你查看每一列中的唯一值。当您有分类数据并且想要了解类别时，这尤其有用。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="dab9" class="kz la it ob b gy of og l oh oi">df['columnName'].unique()</span></pre><p id="2249" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">为给定的列查找数据集中重复次数最多的值。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="f56d" class="kz la it ob b gy of og l oh oi">df.column.value_counts().head(<strong class="ob iu">20</strong>)</span></pre><h1 id="5b06" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">2.按值过滤</h1><p id="da9a" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">过滤是处理任何熊猫数据帧时需要的一项基本技能。为了将列中的值与筛选器进行比较，使用了运算符。</p><p id="7dae" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">可以对数值进行过滤，也可以对定性或分类值进行过滤。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="6fca" class="kz la it ob b gy of og l oh oi">df = df[df.value &gt; 0 ]<br/>df = df[df.column != 'value']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/ec2f19537b3fd8f184fa21d0e24e624d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/0*4Ukey4--KPzVR9NQ"/></div></figure><p id="7997" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">通过使用按位运算符，可以应用各种过滤器。在下面的示例中，OR和and运算符用于创建两个新的数据帧，它们是原始数据帧的过滤版本。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="15ff" class="kz la it ob b gy of og l oh oi">df1 = df[(df.Party == ‘Conservative’) | (df.Party == ‘Labour’)]<br/>df2 = df[(df.Party == ‘Conservative’) &amp; (df.City == ‘London’)]</span></pre><h1 id="7788" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">3.日期时间</h1><p id="b62c" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">datetime数据类型允许您重新格式化pandas数据帧中的列，以便能够处理日期、按最早/最近的日期排序或者甚至按周/月分组。这可以通过pandas中的<strong class="lx iu"> <em class="nz">到_datetime() </em> </strong>函数轻松完成。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="0102" class="kz la it ob b gy of og l oh oi">df[‘date’]=pd.to_datetime(df[‘date’], infer_datetime_format=True)</span></pre><p id="d214" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">如果我们想得到一个更详细的视图，就把日期分成几个部分。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="46f0" class="kz la it ob b gy of og l oh oi">df['month'] = df['date'].dt.month</span></pre><h1 id="e17e" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">4.合并数据集</h1><p id="5f47" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">两个数据帧的连接或合并可以在列或索引上完成。如果在列上连接列，数据帧索引<em class="nz">将被忽略</em>，并将为合并后的数据集创建一个新的索引。<em class="nz"> </em>否则，如果在索引上连接两个数据帧，该索引将作为合并发生的公共列。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="e464" class="kz la it ob b gy of og l oh oi">merged = pd.merge(df<strong class="ob iu">, </strong>df2<strong class="ob iu">, </strong>on='episode'<strong class="ob iu">, </strong>how='inner')<br/>merged = pd.merge(df<strong class="ob iu">, </strong>df2<strong class="ob iu">, </strong>on='episode'<strong class="ob iu">, </strong>how='outer')</span></pre><p id="2fb0" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">一个<strong class="lx iu">内部</strong>合并，将只保留共享公共索引或列值的每个数据集中的值。<strong class="lx iu">外部</strong>合并将连接整个数据集，并为合并时在其他数据集中找不到的列和行返回空值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/328184a7516ff30d6bb87f732da122cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVc6oHYcSz0_FuIbLWwm1w.png"/></div></div></figure><h1 id="c67d" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">5.处理您的列</h1><p id="cc2d" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">可以使用<em class="nz">列</em>参数打印列名，也可以使用。前面提到的info()函数。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="1c61" class="kz la it ob b gy of og l oh oi">print(df.columns)<br/>df.info()</span></pre><p id="72f2" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">重命名列可以通过一种快速简单的方式来完成。这在使用“合并”功能后特别有用，新列通常被标记为<em class="nz"> column_x </em>和<em class="nz"> column_y </em>。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="fd63" class="kz la it ob b gy of og l oh oi">df.rename(columns={"oldName1": "newName1", "oldName2": "NewName2"})</span></pre><p id="b95d" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">删除列也是一个必须知道的功能。参数<em class="nz"> inplace = True </em>经常被遗忘，没有它你将看不到你的数据帧的任何变化。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="8b57" class="kz la it ob b gy of og l oh oi">df.drop(columns=[‘column1’, ‘column2’], inplace = True)</span></pre><h1 id="79e2" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">6.按值分组</h1><p id="b7fd" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">这个pandas函数将根据传递的列名创建行之间的层次结构。第一个示例将根据国籍对行进行分组，并对每个国籍进行计数。结果将是一个包含两列的data frame:Nationality和count。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="160b" class="kz la it ob b gy of og l oh oi">df1 = df.groupby(["nationality"]).count().reset_index()</span></pre><p id="2872" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">当不想丢失存储在其他列中的信息时，第二个例子特别有用。这里，产生的数据帧将有三列:姓名、国籍和每个国籍的姓名计数。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="149b" class="kz la it ob b gy of og l oh oi">df1 = df.groupby(["name", "nationality"]).count().reset_index()</span></pre><p id="713e" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">当可视化数据帧中的不同分组时，这可能特别有用。下面的<a class="ae ky" rel="noopener" target="_blank" href="/step-by-step-bar-charts-using-plotly-express-bb13a1264a8b">文章</a>将带你了解如何使用该功能绘制条形图。</p><h1 id="c63f" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">7.对所有行应用函数</h1><p id="75a6" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">到目前为止，这是每天使用熊猫数据帧的最强大的应用之一。apply()函数，顾名思义，允许我们对数据帧的每一行应用一个函数。apply()方法将df数据帧中的一行一行地传递给string_to_float()函数。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="6b7a" class="kz la it ob b gy of og l oh oi">def string_to_float(row)<br/>    row['value'] = float(row[value'])<br/>    return row(['value'])</span><span id="c9f6" class="kz la it ob b gy oq og l oh oi">df['price'] = df.apply(string_to_float, axis = 1)</span></pre><p id="13ca" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">行['value']只是传递给函数的df数据帧的行。我可以通过指定它们的名称来访问这一行中的任何列。</p><h1 id="5dcf" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">8.λ函数</h1><p id="4a14" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">lambda函数是一个不绑定到标识符的匿名函数。一般结构如下:</p><blockquote class="or os ot"><p id="2e36" class="mw mx nz lx b ly my ju mz ma na jx nb ou nc nd ne ov nf ng nh ow ni nj nk mf im bi translated">λ<em class="it">自变量</em> : <em class="it">表达式</em></p></blockquote><p id="d2e7" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">对参数执行表达式，并返回结果。</p><p id="6cd7" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">一个非常基本的lambda函数应用在非熊猫环境中的例子。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="5930" class="kz la it ob b gy of og l oh oi">x = lambda a : a + 10<br/>print(x(5))</span></pre><p id="c6ab" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">如果您想将lambda函数应用于整个数据集，语法如下。</p><pre class="kj kk kl km gt oa ob oc od aw oe bi"><span id="3298" class="kz la it ob b gy of og l oh oi">df['value'] = df['value'].apply(lambda x: float(x) if != "Not Available" else none)</span></pre><p id="0686" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">当值为“可用”时，此示例更改列的数据类型。</p><h1 id="a86a" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">什么时候使用适当的函数，什么时候使用lambda函数？</h1><p id="295e" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">这是我留给你的事情…取决于你想执行多少任务，一个合适的函数可能更容易构建。而使用lambda函数可以实现快速而简单的更改。</p><h1 id="fd1e" class="nl la it bd lb nm oj no le np ok nr lh jz ol ka ll kc om kd lp kf on kg lt nv bi translated">非常感谢你的阅读！</h1><p id="09b0" class="pw-post-body-paragraph mw mx it lx b ly lz ju mz ma mb jx nb li nw nd ne lm nx ng nh lq ny nj nk mf im bi translated">更多类似的文章，请点击这里在Medium <a class="ae ky" href="https://towardsdatascience.com/medium.com/@alejandra.vlerick" rel="noopener" target="_blank">上找到我！</a></p><p id="8c5e" class="pw-post-body-paragraph mw mx it lx b ly my ju mz ma na jx nb li nc nd ne lm nf ng nh lq ni nj nk mf im bi translated">如果您有任何关于如何改进的<strong class="lx iu">问题</strong>、<strong class="lx iu">建议</strong>或<strong class="lx iu">想法</strong>，请在下面留下评论或通过LinkedIn <a class="ae ky" href="https://www.linkedin.com/in/alejandra-g-283595b8" rel="noopener ugc nofollow" target="_blank">这里</a>取得联系。</p></div></div>    
</body>
</html>