<html>
<head>
<title>3 Ways to Extract Features from Dates with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从日期中提取要素的3种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-ways-to-extract-features-from-dates-927bd89cd5b9?source=collection_archive---------25-----------------------#2020-11-15">https://towardsdatascience.com/3-ways-to-extract-features-from-dates-927bd89cd5b9?source=collection_archive---------25-----------------------#2020-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bfb5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在一行代码中从时间序列数据集中获取更多要素</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/733ebd1234ddd38da10099edd94da24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WGtJhp5xxB5bOcjp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@maddibazzocco?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马迪·巴佐科</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="1684" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">动机</h1><p id="452f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">处理时间序列时，数据集的值可能会受到节假日、一周中的哪一天以及一个月中有多少天的影响。有没有一种方法可以用一行代码从日期特性中提取这些特性？</p><p id="00a5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是啊！在本文中，我将向您展示如何使用两个不同的Python库从date列中提取上述三个特性。</p><h1 id="031b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">导入和处理数据</h1><p id="262d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将使用<a class="ae ky" href="https://machinelearningmastery.com/time-series-datasets-for-machine-learning/" rel="noopener ugc nofollow" target="_blank">每日女性出生数据集</a>。这个数据集描述了1959年加州每天女性出生的数量。</p><p id="d275" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用以下方式下载数据:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8407" class="mx la it mt b gy my mz l na nb">!wget <a class="ae ky" href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-total-female-births.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/jbrownlee/Datasets/master/daily-total-female-births.csv</a></span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="568b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Datapane随机分配时间，因此您可以忽略表中的时间。现在我们将数据可视化</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="085a" class="mx la it mt b gy my mz l na nb">df.set_index('Date').plot()</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><h1 id="c156" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">提取工作日</h1><p id="48a2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">一周中不同的日子可能会影响出生的数量。因此，我们将添加工作日作为我们数据的一个特征</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><h1 id="0cfb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">提取假期</h1><p id="846d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">节假日也会影响生育数量。父母可能会避免在新年或圣诞节等节日带孩子。在这篇博客中，圣诞节被认为是出生婴儿最少的一天。</p><p id="75d8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">基于日期提取假日的最简单方法是使用名为<a class="ae ky" href="https://pypi.org/project/holidays/" rel="noopener ugc nofollow" target="_blank"> holidays </a>的Python库。安装假日使用</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="cafa" class="mx la it mt b gy my mz l na nb">pip install holidays</span></pre><p id="4009" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">假日图书馆提供许多国家的假日。我们还可以指定要从国家的哪个州或省提取假期。</p><p id="f195" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由于我们的数据描述了加州每天女性分娩的数量，因此我们将找到加州的假期。在得到一个假期字典后，我们简单地使用<code class="fe nf ng nh mt b">holiday_dict.get(date)</code>来得到那个日期的假期。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="cda1" class="mx la it mt b gy my mz l na nb">Timestamp('1959-01-01 00:00:00')</span><span id="a614" class="mx la it mt b gy ni mz l na nb">"New Year's Day"</span></pre><p id="f496" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们也可以在所有可用的假期达到顶峰</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6ba8" class="mx la it mt b gy my mz l na nb">datetime.date(1959, 1, 1): "New Year's Day",<br/>datetime.date(1959, 2, 22): "Washington's Birthday",<br/>datetime.date(1959, 5, 30): 'Memorial Day',<br/>datetime.date(1959, 7, 4): 'Independence Day',<br/>datetime.date(1959, 7, 3): 'Independence Day (Observed)',<br/>datetime.date(1959, 9, 7): 'Labor Day',<br/>datetime.date(1959, 10, 12): 'Columbus Day',<br/>datetime.date(1959, 11, 11): 'Veterans Day',<br/>datetime.date(1959, 11, 26): 'Thanksgiving',<br/>datetime.date(1959, 12, 25): 'Christmas Day'}</span></pre><p id="a513" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">尝试调用字典中没有的日期</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b6c9" class="mx la it mt b gy my mz l na nb">None</span></pre><p id="548a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果您发现字典中缺少一些日期，您还可以创建<a class="ae ky" href="https://pypi.org/project/holidays/" rel="noopener ugc nofollow" target="_blank">自定义假日对象。</a></p><p id="65cf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们使用这个库为数据集创建一个假日要素。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="0479" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">厉害！现在我们有了一个具有假日特征的数据集。为了比较节假日和正常工作日的出生人数，我们将数据按节假日分组，并取同一天所有出生人数的中位数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="6c2b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">可视化我们的数据</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="ea7f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">元旦出生人数最少。与正常日期的出生人数相比，其他节日的出生人数似乎相当高。</p><p id="1b8d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然而，这个数据仅仅是一年内的，所以不足以让我们确定假期对出生人数的实际影响。如果我们有一个3年或4年的数据集，我们可能会发现在其他节假日出生的人数比正常日期少。</p><h1 id="4c3f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">提取一个月中的天数</h1><p id="2d90" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">父母也可能避免在2月29日生孩子，因为这是每四年一次的日子。</p><p id="3a75" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们想比较不同月份之间的出生人数，一个月中的日期数也可能会影响出生人数。因此，在分析我们的时间序列数据集时，将一个月中的日期数量考虑在内可能很重要。</p><p id="1a03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">提取特定月份和年份的天数的一个非常快速的方法是使用<code class="fe nf ng nh mt b">calendar.monthrange.</code>这是一个内置的Python库，所以我们不需要安装这个库来使用它。</p><p id="fcae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe nf ng nh mt b">monthrange()</code>方法用于获取指定年份和月份中每月第一天的工作日和一个月中的天数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="0acf" class="mx la it mt b gy my mz l na nb">Weekday of first day of the month: 5<br/>Number of days in month: 29</span></pre><p id="263a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">自从我们知道2020年2月有29天以来，这个库似乎工作得很好。我们将使用它为我们的数据集创建一个<code class="fe nf ng nh mt b">days_in_a_month</code>列</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="a8f3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">厉害！现在我们可以比较每月平均出生人数和每月天数</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="307d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">9月份平均出生人数有一个高峰。可能是因为9月份的天数比其他月份多？你可能已经知道答案了，但是让我们用一个月中的天数柱状图来确认一下</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nd l"/></div></figure><p id="8095" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不完全是。九月只有30天。一月、三月、五月等月份的天数更多。</p><p id="cf9b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">即使我们在这里看不到直接的相关性，但一个月中的天数和其他特征的组合可以给我们一些与出生人数的相关性。</p><h1 id="ffc7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="2ba6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">恭喜你！您已经学习了如何使用日期为时间序列数据集创建更多要素。我希望这些想法能帮助你想出创造性的方法来处理时间序列数据集。</p><p id="58ff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">本文的源代码可以在这里找到。</p><div class="nj nk gp gr nl nm"><a href="https://github.com/khuyentran1401/Data-science/blob/master/time_series/extract_features/extract_features_from_dates.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">khuyentran 1401/数据科学</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">Permalink GitHub是5000多万开发人员的家园，他们一起工作来托管和审查代码、管理项目以及…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">github.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ks nm"/></div></div></a></div><p id="68d3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以在LinkedIn和推特上和我联系。</p><p id="d708" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/3-python-tricks-to-read-create-and-run-multiple-files-automatically-5221ebaad2ba"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">自动读取、创建和运行多个文件的3个Python技巧</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">用Python和Bash For Loop自动化枯燥的东西</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="ob l nx ny nz nv oa ks nm"/></div></div></a></div><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/top-6-python-libraries-for-visualization-which-one-to-use-fe43381cd658"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">可视化的6大Python库:使用哪一个？</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">对使用哪种可视化工具感到困惑？我为你分析了每个图书馆的利弊</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="oc l nx ny nz nv oa ks nm"/></div></div></a></div><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/i-scraped-more-than-1k-top-machine-learning-github-profiles-and-this-is-what-i-found-1ab4fb0c0474"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">我收集了超过1k的顶级机器学习Github配置文件，这就是我的发现</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">从Github上的顶级机器学习档案中获得见解</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="od l nx ny nz nv oa ks nm"/></div></div></a></div><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/supercharge-your-python-string-with-textblob-2d9c08a8da05"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">使用TextBlob增强您的Python字符串</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">在一行代码中获得更多关于文本的见解！</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="oe l nx ny nz nv oa ks nm"/></div></div></a></div></div></div>    
</body>
</html>