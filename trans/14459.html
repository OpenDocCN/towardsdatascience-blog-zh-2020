<html>
<head>
<title>The Implementation of Concave Function to Interpolate Stocks Data Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python实现股票数据内插的凹函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/curve-function-to-interpolate-stocks-data-cd01523ed0a0?source=collection_archive---------38-----------------------#2020-10-05">https://towardsdatascience.com/curve-function-to-interpolate-stocks-data-cd01523ed0a0?source=collection_archive---------38-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2b682110dc2e065a7819eb8212f0c221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wdKeov4nPMwo5Z0d"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@firmbee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">威廉·艾文</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="f9dc" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">动手教程</a></h2><div class=""/><div class=""><h2 id="9e10" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">雅加达综合指数的案例研究(JCI)</h2></div><h2 id="2baf" class="lh li jj bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb jp bi translated">目录(仅适用于web)</h2><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="9135" class="lh li jj mh b gy ml mm l mn mo">1 <a class="ae jg" href="#5838" rel="noopener ugc nofollow">Overview</a><br/>2 <a class="ae jg" href="#587f" rel="noopener ugc nofollow">Let’s Practice with Python</a><br/>3 <a class="ae jg" href="#5ffa" rel="noopener ugc nofollow">Conclusion</a><br/>4 <a class="ae jg" href="#f360" rel="noopener ugc nofollow">References</a></span></pre></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h2 id="5838" class="lh li jj bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb jp bi translated">概观</h2><p id="e0c8" class="pw-post-body-paragraph mw mx jj my b mz na kt nb nc nd kw ne lq nf ng nh lu ni nj nk ly nl nm nn no im bi np translated">股票投资者必须考虑的一个特征是不稳定性。因此，投资者必须制定一个聪明的策略来获得投资的资本收益，例如，财务预测。分析师必须从财务数据中找出模式和见解。例如，我们需要创建雅加达综合指数(JCI)的数据分析。这些数据很容易在雅虎上下载。金融。但是，我们分析的一个考虑因素是数据的缺失值。</p><p id="9072" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">一般证券交易所周一到周五上班，除非是节假日。为了进行插值，Mittal和Goel (2012)提出了凹函数。如果给定日期的JCI值为<em class="od"> X </em>，下一个可用值为<em class="od"> Y </em>，中间缺少<em class="od"> n </em>天，则<em class="od"> X1 </em>的第一个缺失值可以使用<code class="fe oe of og mh b"><strong class="my jt">(<em class="od">X+Y</em>)/2</strong></code>来近似，并对其他缺失值重复。</p><h2 id="587f" class="lh li jj bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb jp bi translated">让我们用Python来练习一下</h2><p id="46cd" class="pw-post-body-paragraph mw mx jj my b mz na kt nb nc nd kw ne lq nf ng nh lu ni nj nk ly nl nm nn no im bi translated">在我们开始曲线功能之前，首先我们必须从Yahoo！金融。你可以很容易地选择任何股票，但对于本教程，我将使用2019年的JCI数据。负责人向我的<a class="ae jg" href="https://github.com/audhiaprilliant/Natural-Language-based-Financial-Forecasting" rel="noopener ugc nofollow" target="_blank"> <strong class="my jt"> GitHub的</strong> </a>回购了数据。</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="ca8f" class="ok li jj mh b be ol om l on mo"># Import libraries<br/>import pandas as pd   # Dataframe manipulation<br/>import numpy as np    # Mathematics operation<br/>import datetime       # Date and time<br/># Load the data<br/>ihsg_data = pd.read_csv('Datasets/^JKSE.csv')<br/>print('Dimension of JCI data:\n{}'.format(ihsg_data.shape[0]),<br/>      'rows and {}'.format(ihsg_data.shape[1]),'columns')<br/>ihsg_data.head()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/d1420ee4d9655b3a89191b43f8c5f647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*cTZHEN5n7eYSnXeNs5v7og.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">JCI的原始资料(图片由作者提供)</p></figure><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="610c" class="ok li jj mh b be ol om l on mo"># Get the metadata of columns<br/>ihsg_data.info()<br/># Check missing value<br/>ihsg_data.isna().sum()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/5f86bf3c77856201e7f5f7106cda8b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*QF5eI_xw0kzlj_7xr_9FFQ.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">JCI数据中的元数据和缺失值信息(图片由作者提供)</p></figure><p id="6343" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">导入数据后，我们创建将应用于数据的函数。这些功能如下:</p><ul class=""><li id="a19f" class="oq or jj my b mz ny nc nz lq os lu ot ly ou no ov ow ox oy bi translated"><code class="fe oe of og mh b"><strong class="my jt">imput_date</strong></code>:输入我们数据中未列出的日期</li><li id="2790" class="oq or jj my b mz oz nc pa lq pb lu pc ly pd no ov ow ox oy bi translated"><code class="fe oe of og mh b"><strong class="my jt">return_stocks</strong></code>:计算股票回报率</li><li id="81ba" class="oq or jj my b mz oz nc pa lq pb lu pc ly pd no ov ow ox oy bi translated"><code class="fe oe of og mh b"><strong class="my jt">curve_function</strong></code>:使用曲线功能对缺失值进行插值</li></ul><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="pe pf l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">插值股票数据的凹函数</p></figure><p id="df75" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">让我们运行<code class="fe oe of og mh b"><strong class="my jt">return_stocks</strong></code>的第一个函数。输出是带有新的return列的数据集。我们对熊猫使用的<code class="fe oe of og mh b"><strong class="my jt">pipe</strong></code>方法如下:</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="6b88" class="ok li jj mh b be ol om l on mo"># Calculate the return of stocks<br/>ihsg_data_clean = ihsg_data.pipe(return_stocks,col='Adj Close', date='Date')<br/>print('Dimension of financial news:\n{}'.format(ihsg_data_clean.shape[0]),<br/>      'rows and {}'.format(ihsg_data_clean.shape[1]),'columns')<br/>ihsg_data_clean.head()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/0fb2bf591fe5a367421b3402eac01bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*-c4rnjBEuWZ0LqkH_lwR7g.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">应用<code class="fe oe of og mh b"><strong class="bd ph">return_stocks</strong></code>功能后的JCI数据(图片由作者提供)</p></figure><p id="9491" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">在运行了<code class="fe oe of og mh b"><strong class="my jt">return_stocks</strong></code>函数之后，我们得到了数据中列出的所有日期的返回结果，但是问题是如果我们的日期为空，我们如何在返回结果中插入缺失值。所以，在实现<code class="fe oe of og mh b"><strong class="my jt">curve_function</strong></code>之前，我们需要以区间形式提供日期。很简单，运行<code class="fe oe of og mh b"><strong class="my jt">imput_date</strong></code>的功能即可。代码和结果如下。</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="7c5d" class="ok li jj mh b be ol om l on mo"># Input the missing data on date column<br/>ihsg_data_clean = ihsg_data_clean.pipe(imput_date,col='Date')<br/>print('Dimension of financial news:\n{}'.format(ihsg_data_clean.shape[0]),<br/>      'rows and {}'.format(ihsg_data_clean.shape[1]),'columns')<br/>ihsg_data_clean.head()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pi"><img src="../Images/1293322a6f728ac54d3e5e2d4f3cff6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*PFMqEa1tNOzT13oHDurYGA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">应用<code class="fe oe of og mh b"><strong class="bd ph">imput_date</strong></code>功能后的JCI数据(图片由作者提供)</p></figure><p id="3379" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">那好吧。<code class="fe oe of og mh b"><strong class="my jt">Date</strong></code>列上缺失的数据已经由<code class="fe oe of og mh b"><strong class="my jt">imput_date</strong></code>函数填充。结果很棒。现在，我们必须确定这些日期是否是自由日。理论上，交易活动是从周一到周五，这是我们的原始数据，只提供交易日的信息。<code class="fe oe of og mh b"><strong class="my jt">curve_function</strong></code>使用来自这里的信息，所以我们必须提供它。</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="5668" class="ok li jj mh b be ol om l on mo"># Create dummy variable for deterimining free day or not<br/>free = []<br/>for i in range(ihsg_data_clean.shape[0]):<br/>    if pd.isna(ihsg_data_clean.iloc[i]['Volume']):<br/>        free.append(0)<br/>    else:<br/>        free.append(1)</span></pre><p id="1f4a" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">在确定了某个具体日期是否是自由日之后，我们只需轻松运行<code class="fe oe of og mh b"><strong class="my jt">curve_function</strong></code>的主函数即可。</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="eb27" class="ok li jj mh b be ol om l on mo"># Interpolate the return by curve function<br/>ihsg_data_curve = ihsg_data_clean.pipe(curve_function)<br/>print('Dimension of financial news:\n{}'.format(ihsg_data_curve.shape[0]),<br/>      'rows and {}'.format(ihsg_data_curve.shape[1]),'columns')<br/>ihsg_data_curve.head()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/7cb79735044ad552a33937f8619ff414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*eCqygu77wflZvKwVqCDU0g.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">应用<code class="fe oe of og mh b"><strong class="bd ph">curve_function</strong></code>功能后的JCI数据(图片由作者提供)</p></figure><p id="59e8" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">最后一步是将自由日的列与上表合并。当我们用这些数据进行分析时，它是有用的。关于原始数据的信息仍然存在，我们可以使用<code class="fe oe of og mh b"><strong class="my jt">Free</strong></code>列对其进行过滤。</p><pre class="mc md me mf gt mg mh oh bn oi oj bi"><span id="48cc" class="ok li jj mh b be ol om l on mo"># Concatenate previous-interpolated data with dummy<br/>ihsg_data = pd.concat([ihsg_data_curve,pd.Series(free,name='Free')],axis=1)<br/>ihsg_data.head()</span></pre><figure class="mc md me mf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pk"><img src="../Images/bb7f09e92b49cd5b7b1148df491f7292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0LxPxXWCKYqwDGYw00wUw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">最终数据还是JCI(图片由作者提供)</p></figure></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><figure class="mc md me mf gt iv"><div class="bz fp l di"><div class="pe pf l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">用于实现凹面功能的笔记本</p></figure><h2 id="5ffa" class="lh li jj bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb jp bi translated">结论</h2><p id="b45b" class="pw-post-body-paragraph mw mx jj my b mz na kt nb nc nd kw ne lq nf ng nh lu ni nj nk ly nl nm nn no im bi translated">凹函数是在股票——金融数据中进行数据分析或机器学习之前，第一个也是至关重要的数据预处理。每日股票数据的模式被假定为平稳线性。使用凹函数，分析师可以捕获一年中365天的股票数据可用性，但可以根据需要进行定制。</p><p id="9a69" class="pw-post-body-paragraph mw mx jj my b mz ny kt nb nc nz kw ne lq oa ng nh lu ob nj nk ly oc nm nn no im bi translated">请前往我的<a class="ae jg" href="https://github.com/audhiaprilliant/Natural-Language-based-Financial-Forecasting" rel="noopener ugc nofollow" target="_blank"> <strong class="my jt"> GitHub repo </strong> </a>查看完成的代码。</p><h2 id="f360" class="lh li jj bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb jp bi translated">参考</h2><p id="96ee" class="pw-post-body-paragraph mw mx jj my b mz na kt nb nc nd kw ne lq nf ng nh lu ni nj nk ly nl nm nn no im bi translated">[1] A .米塔尔，a .戈埃尔。<a class="ae jg" href="http://cs229.stanford.edu/proj2011/GoelMittal-StockMarketPredictionUsingTwitterSentimentAnalysis.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="od">利用Twitter情绪分析进行股票预测</em> </a> (2012年)<a class="ae jg" href="http://cs229.stanford.edu/proj2011/GoelMittal-StockMarketPredictionUsingTwitterSentimentAnalysis.pdf" rel="noopener ugc nofollow" target="_blank">http://cs 229 . Stanford . edu/proj 2011/goelmittalstockkmarkedpredictionusingtwittersentimentanalysis . pdf</a>。</p></div></div>    
</body>
</html>