<html>
<head>
<title>Using ResNets to Detect Anomalies in Industrial IoT Textile Production</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ResNets检测工业物联网纺织品生产中的异常</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-resnets-to-detect-anomalies-in-industrial-iot-textile-production-42da77d49ad2?source=collection_archive---------41-----------------------#2020-11-06">https://towardsdatascience.com/using-resnets-to-detect-anomalies-in-industrial-iot-textile-production-42da77d49ad2?source=collection_archive---------41-----------------------#2020-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c84a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用于图像分类的机器学习模型通常使用<a class="ae kl" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积神经网络</a>(CNN)从图像中提取特征，同时采用<a class="ae kl" href="https://computersciencewiki.org/index.php/Max-pooling_/_Pooling" rel="noopener ugc nofollow" target="_blank">最大池</a>层来降低维度。目标是从图像区域中提取越来越高级的特征，最终进行某种预测，例如图像分类。</p><p id="19d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了提高精度，简单地向网络添加更多的层是很有诱惑力的。然而，研究表明，添加太多的层会增加训练时间，甚至导致精度下降。</p><p id="b087" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇博客中，我们将深入探讨为什么深度神经网络会出现这种情况，如何解决这个问题，并以一个工业物联网用例为例，看看如何在感知实验室中构建一个更有效的模型。</p><p id="83d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">消失的渐变问题</strong></p><p id="4799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">影像分类模型通常使用一系列相互反馈的层来实现其目标，其中额外的层可以提高最终分类的准确性。然而，添加太多的层会导致反向传播期间的<em class="km">消失梯度</em>问题，其中损失函数的越来越小的梯度导致对权重的更新变得越来越小，直到它们趋向于零。这反过来会导致上面提到的培训问题。</p><p id="259b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">拯救残余网络</strong></p><p id="b8a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">克服这个问题的一种流行方法是合并残差块，它们共同形成一个<em class="km">残差网络</em> ( <em class="km"> ResNet) </em>。残差块通过引入早期层跳过未来层的架构模式解决了这个问题。这些“跳过连接”通常通过一个<em class="km">加法</em>操作来实现，由此，在一些卷积层之后，来自网络中较早的特征被添加到新计算的特征，如下所示:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/d1bce35cebd67a69142b349c96de417a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gBe6tXwiv79jldR4"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图1:残差块的概述。形象由</em> <a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="ld">感知力</em> </a> <em class="ld">灵感</em> <a class="ae kl" href="https://adventuresinmachinelearning.com/introduction-resnet-tensorflow-2/" rel="noopener ugc nofollow" target="_blank"> <em class="ld">来源</em> </a> <em class="ld">。</em></p></figure><p id="79ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">跳跃连接为梯度在反向传播期间的流动提供了额外的、更短的路径，并且经验表明这使得更深的计算机视觉网络能够更快地训练。</p><p id="08f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">残差块的工作方式如下:</p><ul class=""><li id="a22d" class="le lf iq jp b jq jr ju jv jy lg kc lh kg li kk lj lk ll lm bi translated">输入张量X流向ResNet块，并沿两条路径向下流动。</li><li id="d5b1" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">x通过卷积层(如图1 <em class="km">权重层</em>所示)沿主路径向下流动，就像在普通CNN中一样，这通常被称为<em class="km">卷积块</em>。结果输出近似于函数F(x)。</li><li id="2d1d" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">X还流经跳过连接，也称为<em class="km">身份</em> <em class="km">块</em>，因为它只是转发X，同时保留其维度。</li><li id="ada5" class="le lf iq jp b jq ln ju lo jy lp kc lq kg lr kk lj lk ll lm bi translated">F(x)和X然后被加在一起，然后被发送到激活函数(在这个例子中是<a class="ae kl" href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" rel="noopener ugc nofollow" target="_blank"> ReLU </a>)。</li></ul><p id="8f73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如下面图2 中的<em class="km">所示，残差块通常被“链接”在一起以形成ResNets。来自最终残差块的输出与来自最终跳过连接的输出一起被组合，然后被传递到其他类型的层(例如，平均池和<a class="ae kl" href="https://en.wikipedia.org/wiki/Convolutional_neural_network#Fully_connected" rel="noopener ugc nofollow" target="_blank">完全连接层</a>)用于分类:</em></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9ddcf89fb46dceb8667a8b8bb96bbf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/0*1BE111lEL0FO7g_i"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图2:50层ResNet模型示例。形象由</em> <a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="ld">感知力</em> </a> <em class="ld">灵感</em> <a class="ae kl" href="https://adventuresinmachinelearning.com/introduction-resnet-tensorflow-2/" rel="noopener ugc nofollow" target="_blank"> <em class="ld">来源</em> </a> <em class="ld">。</em></p></figure><p id="e689" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在用于图像分类的典型CNN中，较早的层通常学习较低级别的抽象(例如，线、角等。)，而后续层学习更高级别的抽象(例如，形状组等)。).通过使用跳过连接，我们允许梯度通过网络，而不需要通过激活函数。这有助于网络将信息传递给网络中的后续层，使它们能够学习复杂的特征，而没有梯度消失的风险。</p><p id="2530" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图3描绘了ResNet块对图像分类模型的应用:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lt"><img src="../Images/648695a90a3de3a5a5075ccddd05bce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QlRFr0d70gowObg8"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图3:由使用卷积和批量归一化计算的两层组成的ResNet块的示例。在此示例中，在通过RelU生成标识块(x)的激活之前，通过skip连接将ResNet块的输出添加到标识块(x)。当输入与输出激活具有相同的维度时，可以使用这种架构。图片由</em> <a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="ld">感知</em> </a> <em class="ld">灵感</em> <a class="ae kl" href="https://adventuresinmachinelearning.com/introduction-resnet-tensorflow-2/" rel="noopener ugc nofollow" target="_blank"> <em class="ld">来源</em> </a> <em class="ld">。</em></p></figure><p id="1e2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，在某些情况下，可以用<em class="km">卷积</em>块代替<em class="km">恒等</em>块，例如当输入和输出尺寸不同时:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lt"><img src="../Images/094c2b5b3aa61bf37b222d1b0853c3d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TT4YfeMoqiSRDR79"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图4:ResNet块的例子，其中输入和输出具有不同的维度。在这种情况下，在生成卷积块(x)的激活之前，ResNet块的输出通过skip连接被添加到卷积块(x)。形象由</em> <a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="ld">感知器</em> </a> <em class="ld">灵感</em> <a class="ae kl" href="https://adventuresinmachinelearning.com/introduction-resnet-tensorflow-2/" rel="noopener ugc nofollow" target="_blank"> <em class="ld">来源</em> </a> <em class="ld">。</em></p></figure><p id="ee3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于残差块，梯度现在可以在通过两条路径的反向传播期间流回网络:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lt"><img src="../Images/d68efba176e695a7ca37ee58fa069d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pt_JAtHPpblMKfxU"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图5:示出了梯度在反向传播期间可以流经的两个路径的图。形象由</em> <a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"> <em class="ld">感知力</em> </a> <em class="ld">灵感</em> <a class="ae kl" href="https://adventuresinmachinelearning.com/introduction-resnet-tensorflow-2/" rel="noopener ugc nofollow" target="_blank"> <em class="ld">来源</em> </a> <em class="ld">。</em></p></figure><p id="00fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当梯度流回穿过<em class="km">梯度路径-2 </em>时，残差块中的权重层(在图5中表示为F(x ))被更新，并且新的梯度值被计算。随着梯度继续流过较早的残差块，它将继续减小(即，趋向于0)。但是，梯度也会流回跳过连接，从而完全避开残差块中的权重层，因此将保留其值。这允许保持完整的渐变值传播回早期层，允许它们学习激活，从而避免渐变消失的问题。</p><p id="f273" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">将ResNets应用于工业物联网应用</strong></p><p id="0413" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图像分类技术对于计算机视觉问题特别有用，例如在工业物联网(例如，制造业)中遇到的那些问题。</p><p id="a679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了说明这一点，我们在GitHub上整合了一个<a class="ae kl" href="https://github.com/PerceptiLabs/Textile-Classification" rel="noopener ugc nofollow" target="_blank">纺织品分类项目</a>。该项目以72000幅纺织纤维的特写图像作为输入，每幅图像包含六种可能的制造分类之一(例如，颜色问题、织物切割等)。)，以及每个图像的相应分类:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lu"><img src="../Images/ed4cf2b4e0b70fe831973d8a31119adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mG1cdrmxTwGoEVWm"/></div></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图6:具有各种类型制造分类的纺织织物图像示例。其中五个代表异常，而“良好”分类意味着在图像中没有发现问题。图像由</em><a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"><em class="ld"/></a><em class="ld">感知。</em></p></figure><p id="266f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">项目中的示例PerceptiLabs模型包含三个ResNet块，每个ResNet块对图像进行卷积以提取特征，并包含直接按原样转发每个块的输入(即，作为标识块)的跳过连接。使用配置为应用<em class="km">加法</em>操作的<em class="km">合并</em>组件，将其添加到块的输出:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/2cfd709453f1e5e9766d8098b31fe032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/0*NourACNCBBVnWlgU.png"/></div><p class="kz la gj gh gi lb lc bd b be z dk translated"><em class="ld">图7:感知实验室中的纺织品图像分类模型概述。图像由</em><a class="ae kl" href="http://www.PerceptiLabs.com" rel="noopener ugc nofollow" target="_blank"><em class="ld"/></a><em class="ld">感知。</em></p></figure><p id="927f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该项目展示了这种模型如何用于工业物联网的质量控制。例如，相机可以在制造过程中随机拍摄织物的特写照片，然后将它们呈现给模型以进行异常检测。</p><p id="c3d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最重要的是，这个项目展示了在PerceptiLabs中构建ResNet块是多么容易。</p><p id="627e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong></p><p id="302b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">具有大量层的神经网络容易遭受<em class="km">消失梯度</em>问题，由此在反向传播期间梯度趋向于零。由于梯度值如此之小，网络中位于较早位置的层可能很少更新或根本不更新其激活，从而导致训练速度变慢、停止，甚至失去其准确性。</p><blockquote class="lw lx ly"><p id="3dbc" class="jn jo km jp b jq jr js jt ju jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj kk ij bi translated">ResNet块是这个问题的一个很好的解决方案，因为它们允许你使用大量的层，最重要的是，它们很容易在PerceptiLabs中构建。</p></blockquote><p id="abd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，要想知道这有多简单，请务必查看我们在GitHub上的<a class="ae kl" href="https://github.com/PerceptiLabs/Textile-Classification" rel="noopener ugc nofollow" target="_blank">纺织品分类项目</a>。一如既往，我们希望您能参与我们的<a class="ae kl" href="https://www.perceptilabs.com/community" rel="noopener ugc nofollow" target="_blank">社区频道的讨论。</a></p></div></div>    
</body>
</html>