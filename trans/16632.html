<html>
<head>
<title>Increasing the amount and diversity of data using scikit-image in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的scikit-image增加数据的数量和多样性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/increasing-the-amount-and-diversity-of-data-part-1-2025caf9d53c?source=collection_archive---------33-----------------------#2020-11-16">https://towardsdatascience.com/increasing-the-amount-and-diversity-of-data-part-1-2025caf9d53c?source=collection_archive---------33-----------------------#2020-11-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="dc6f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/making-sense-of-big-data" rel="noopener" target="_blank">理解大数据</a></h2><div class=""/><div class=""><h2 id="540a" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Python中的图像数据扩充库系列</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0b3655bc76b8b3233470c5af51adf298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4R-AYCdToooPrprTcb9wtw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://pixabay.com/users/realworkhard-23566/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=110850" rel="noopener ugc nofollow" target="_blank">拉尔夫·昆泽</a>从<a class="ae lh" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=110850" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>拍摄</p></figure><p id="a961" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">深度学习技术在计算机视觉任务中取得了巨大成功，即图像识别、图像分割、对象检测等。这种深度学习技术严重依赖大数据来避免过度拟合。那么在数据有限的情况下，你会怎么做呢？你去做数据扩充。<a class="ae lh" href="https://link.springer.com/content/pdf/10.1186%2Fs40537-019-0197-0.pdf" rel="noopener ugc nofollow" target="_blank">数据增强技术增强了训练数据集的规模和质量，因此可以使用它们建立更好的深度学习模型</a>。在本文中，我们将研究一些标准的图像增强技术和一些帮助实现这些增强的流行库。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="0b04" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">增强技术的类型</h1><p id="9a13" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">基于何时在流水线中执行，扩充可以被宽泛地分类为离线扩充和在线扩充。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ni"><img src="../Images/d2518005909d8200f299f70006c30ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7IQNlHmwU0TSW5q0RRiZg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">增强类型|按作者分类的图片</p></figure><h2 id="b36a" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">常用的增强技术。</h2><p id="8718" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">在进入增强库之前，让我们先看看一些图像增强技术:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/656584c175e33060057f259ce9270eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoyBHsn2MWQjdnu_dJuCNg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">常用的增强技术|作者图片</p></figure><ul class=""><li id="34c6" class="nv nw it lk b ll lm lo lp lr nx lv ny lz nz md oa ob oc od bi translated"><strong class="lk jd">翻转</strong>表示水平或垂直翻转图像。</li><li id="bc58" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><strong class="lk jd">旋转</strong>是将图像顺时针或逆时针旋转给定角度。</li><li id="6039" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><strong class="lk jd">裁剪</strong>涉及<strong class="lk jd"> </strong>随机采样<strong class="lk jd"> </strong>一段图像。</li><li id="4c26" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><strong class="lk jd">改变亮度</strong>包括增加或降低图像的亮度。</li><li id="9c03" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><strong class="lk jd">缩放— </strong>图像可以向外或向内缩放。向外缩放时，图像尺寸会增大，而向内缩放时，图像尺寸会减小。</li><li id="82ae" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><strong class="lk jd">添加噪声</strong>是指在现有图像上添加<a class="ae lh" href="https://en.wikipedia.org/wiki/Gaussian_noise#:~:text=Gaussian%20noise%2C%20named%20after%20Carl,take%20on%20are%20Gaussian%2Ddistributed." rel="noopener ugc nofollow" target="_blank">高斯噪声</a>。</li></ul></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="3591" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">探索数据集:作为数组的图像</h1><p id="d324" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">与人类不同，计算机将图像视为数据点。图像只不过是包含数据点像素的标准Numpy数组。图像的像素越多，分辨率就越高。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/81baeaa9502dda62a57c02d97ba4ad84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6SCBKxu2qO1MFDY16FIaA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片来源:<a class="ae lh" href="https://setosa.io/ev/image-kernels/" rel="noopener ugc nofollow" target="_blank">https://setosa.io/ev/image-kernels/</a></p></figure><p id="6bd0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">记住这一事实，让我们来探索一下本文中我们将要处理的数据集。该数据集属于2020年3月由Kaggle主办的<a class="ae lh" href="https://www.kaggle.com/c/plant-pathology-2020-fgvc7" rel="noopener ugc nofollow" target="_blank">植物病理学2020 — FGVC7 </a>，由人工捕捉的3651张高质量的<a class="ae lh" href="https://arxiv.org/abs/2004.11958" rel="noopener ugc nofollow" target="_blank">多种苹果叶部病害</a>的真实症状图像组成。</p><blockquote class="ok ol om"><p id="7eb4" class="li lj on lk b ll lm kd ln lo lp kg lq oo ls lt lu op lw lx ly oq ma mb mc md im bi translated">给定一张苹果叶子的照片，你能准确评估它的健康状况吗？这场比赛将挑战你区分健康的叶子，感染了苹果锈病的叶子，有苹果黑星病的叶子，以及有不止一种疾病的叶子。</p></blockquote><p id="5557" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我们将只使用来自训练数据集的图像。</p><h2 id="3707" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">导入必要的库和数据集</h2><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="15e5" class="nj mm it os b gy ow ox l oy oz">import numpy as np<br/>import pandas as pd<br/>from skimage.io import imshow, imread, imsave<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="142c" class="nj mm it os b gy pa ox l oy oz"><br/># Defining data path<br/>Image_Data_Path = "./plant-pathology-2020-fgvc7/images/"</span><span id="3e22" class="nj mm it os b gy pa ox l oy oz">train_data = pd.read_csv("./plant-pathology-2020-fgvc7/train.csv")<br/></span><span id="51b0" class="nj mm it os b gy pa ox l oy oz"># Loading the training images <br/>def load_image(image_id):<br/>    file_path = image_id + ".jpg"<br/>    image = imread(Image_Data_Path + file_path)<br/>    return image</span><span id="dfe2" class="nj mm it os b gy pa ox l oy oz">train_images = train_data["image_id"][:50].apply(load_image)</span></pre><p id="e26c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上传数据集后，让我们看看训练集中的一些图像</p><h1 id="0ae2" class="ml mm it bd mn mo pb mq mr ms pc mu mv ki pd kj mx kl pe km mz ko pf kp nb nc bi translated">看看训练集中的一些图像</h1><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="a040" class="nj mm it os b gy ow ox l oy oz"># plotting multiple images using subplots<br/>fig,ax = plt.subplots(nrows=2,ncols=3,figsize=(30,16))<br/>for col in range(3):<br/>    for row in range(2):<br/>        ax[row,col].imshow(train_images.loc[train_images.index[row*3+col]])<br/>        #ax[row,col].set_title(image_titles[i])    <br/>        ax[row,col].set_xticks([])<br/>        ax[row,col].set_yticks([])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/9b7010908ad13136072dec1e4d86159b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTLbX3C81Lsjtt11lor19Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">看看训练集中的一些图片|作者图片</p></figure><p id="88e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以认为像素是以二维网格形式排列的微小信息块，像素的深度是指其中存在的颜色信息。让我们看看数据集中的任意图像。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="35d4" class="nj mm it os b gy ow ox l oy oz">image = train_images[15]<br/>imshow(image)<br/>print(image.shape)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/2df940e469c5d2edd5defea8ed94ac70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pAerv60dbmir_JPfaBFJ-w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">树叶图片|作者图片</p></figure><p id="b97b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">彩色图像</strong>表现为红色、蓝色和绿色的组合，所有其他颜色可以通过将这些原色以正确的比例混合来实现。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="9af7" class="nj mm it os b gy ow ox l oy oz"><em class="on"># red filter [R,G,B]</em><br/>red_filter = [1,0,0]<br/><em class="on"># blue filter</em><br/>blue_filter = [0,0,1]<br/><em class="on"># green filter</em><br/>green_filter = [0,1,0]<br/><br/><br/><em class="on"># matplotlib code to display</em><br/>fig,ax = plt.subplots(nrows=1,ncols=3,figsize=(30,16))<br/>ax[0].imshow(image*red_filter)<br/>ax[0].set_title("Red Filter",fontweight="bold", size=30)<br/>ax[1].imshow(image*blue_filter)<br/>ax[1].set_title("BLue Filter",fontweight="bold", size=30)<br/>ax[2].imshow(image*green_filter)<br/>ax[2].set_title("Green Filter",fontweight="bold", size=30);</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/b241fa0c3e8c23d15ee75a4305ae4c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1QNUvhwAHFM9IO-LUGzdA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">彩色图片|作者图片</p></figure><p id="239d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一幅<strong class="lk jd">灰度图像</strong>由每像素8位组成。这意味着它可以有256种不同的色调，其中0像素代表黑色，而255代表白色。例如，下图显示了以数组形式表示的灰度图像。灰度图像只有一个通道，其中通道代表一个维度。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="0a15" class="nj mm it os b gy ow ox l oy oz"><em class="on"># import color sub-module</em><br/>from skimage import color<br/><br/><em class="on"># converting image to grayscale</em><br/>grayscale_image = color.rgb2gray(image)<br/>grayscale_image.shape<br/>imshow(grayscale_image)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/44e2825615118fb3061231b0ada06738.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*OrqxyRADOvX1n1caQ5QIMQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">灰度图像|作者图片</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="8d81" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">流行的图像增强包</h1><p id="3cac" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">有很多图像增强包。然而，在这个系列中，我们将涉及一些流行的，如:</p><ul class=""><li id="0f4c" class="nv nw it lk b ll lm lo lp lr nx lv ny lz nz md oa ob oc od bi translated"><strong class="lk jd">撇帐</strong></li><li id="dbd7" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated">OpenCV</li><li id="f5b3" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated">伊姆高格</li><li id="7eaa" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated">白蛋白</li><li id="d981" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated">Keras(ImageDataGenerator类)</li></ul><p id="ac4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将使用上述五个库，通过代码示例来演示基本的增强技术。每个图书馆都相当庞大，值得拥有自己的一篇文章。因此，我将从众所周知的scikit-image库开始，为每个库写一篇文章。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="ef1e" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">使用scikit图像的数据增强</h1><p id="26de" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated"><a class="ae lh" href="https://scikit-image.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd"> Scikit-Image </strong> </a>或skimage是一个开源的Python包，可以处理numpy数组。它是图像处理算法的集合。代码由合作者团队维护，完全由社区驱动，同时保持代码的质量并促进基于研究的教育。</p><h2 id="530f" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">装置</h2><p id="13b1" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">scikit-image可以按如下方式安装:</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="a6df" class="nj mm it os b gy ow ox l oy oz">pip install scikit-image</span><span id="117d" class="nj mm it os b gy pa ox l oy oz">or </span><span id="80a8" class="nj mm it os b gy pa ox l oy oz">conda install -c conda-forge scikit-image</span></pre><h2 id="7014" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">导入库和必要的模块</h2><p id="e4d5" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">让我们加载我们将用于各种图像处理操作的必要模块。skimage库由各种模块组成，包含旋转、缩放、调整大小等功能，用于图像操作。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="efce" class="nj mm it os b gy ow ox l oy oz">from skimage.io import imshow, imread, imsave<br/>from skimage.transform import rotate,rescale, resize, <br/>from skimage import color,data<br/>from skimage.exposure import adjust_gamma<br/>from skimage.util import random_noise</span></pre><h2 id="db44" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">图像翻转</h2><p id="b829" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">翻转可以是水平的，也可以是垂直的。用于翻转图像的函数是<code class="fe pk pl pm os b"><a class="ae lh" href="https://numpy.org/doc/stable/reference/generated/numpy.flip.html" rel="noopener ugc nofollow" target="_blank">numpy.flip()</a></code>。这个函数有两种变体。当<code class="fe pk pl pm os b">fliplr()</code>函数用于向左或向右翻转任何数组时，<code class="fe pk pl pm os b">flipud()</code>函数用于向上/向下翻转数组。这意味着<code class="fe pk pl pm os b">fliplr()</code>反转矩阵中像素列的顺序，而<code class="fe pk pl pm os b">flipu()</code>反转矩阵中像素行的顺序。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="bcb4" class="nj mm it os b gy ow ox l oy oz"><em class="on">#Horizontally flipped</em><br/>hflipped_image= np.fliplr(image) <em class="on">#fliplr reverses the order of columns of pixels in matrix</em><br/><br/><em class="on">#Vertically flipped</em><br/>vflipped_image= np.flipud(image) <em class="on">#flipud reverses the order of rows of pixels in matrix</em><br/><br/>fig,ax = plt.subplots(nrows=1,ncols=3,figsize=(30,16))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=30)<br/>ax[1].imshow(hflipped_image)<br/>ax[1].set_title("Horizontally flipped", size=30)<br/>ax[2].imshow(vflipped_image)<br/>ax[2].set_title("Vertically flipped", size=30);</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/f5dee63d8582af691be19e17304273a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wyqopdJIc67eYRRE14Kyg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">翻转图片|作者图片</p></figure><h2 id="5159" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">图像旋转</h2><p id="38d6" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">同样，我们可以顺时针方向或逆时针方向旋转图像。旋转是通过<code class="fe pk pl pm os b">transform.rotate();</code>功能实现的，该功能可将图像围绕其中心旋转一定角度。用户可以指定任何旋转角度的选择。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="9db5" class="nj mm it os b gy ow ox l oy oz"># clockwise rotation<br/>rot_clockwise_image = rotate(image, angle=45) </span><span id="14bc" class="nj mm it os b gy pa ox l oy oz"># Anticlockwise rotation<br/>rot_anticlockwise_image = rotate(image, angle=-45)</span><span id="2787" class="nj mm it os b gy pa ox l oy oz">fig,ax = plt.subplots(nrows=1,ncols=3,figsize=(30,16))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=30)<br/>ax[1].imshow(rot_clockwise_image)<br/>ax[1].set_title("+45 degree Rotation", size=30)<br/>ax[2].imshow(rot_anticlockwise_image)<br/>ax[2].set_title("-45 degree rotation", size=30);</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi po"><img src="../Images/07b1115957da197dc0ac8fb72bc2eb40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FIHIiQd-2du7_57HLpRntQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">旋转图像|作者图像</p></figure><h2 id="9cad" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">图像裁剪</h2><p id="667c" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">对于裁剪图像，可以定义一个效用函数-<code class="fe pk pl pm os b">randRange()</code>；以生成期望范围内的随机浮点值。然后，您可以将这些生成的范围值传递到另一个名为<code class="fe pk pl pm os b">randomCrop(), </code>的函数中，该函数将图像作为输入，并根据所需的边界边距在中心进行裁剪</p><p id="524f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="on"> P.S:以下代码改编自</em> <a class="ae lh" href="https://www.kaggle.com/safavieh/image-augmentation-using-skimage" rel="noopener ugc nofollow" target="_blank"> <em class="on">本</em> </a> <em class="on"> Kaggle内核。</em></p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="2df4" class="nj mm it os b gy ow ox l oy oz"># source: <a class="ae lh" href="https://www.kaggle.com/safavieh/image-augmentation-using-skimage" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/safavieh/image-augmentation-using-skimage</a><br/>import random<br/>import pylab as pl <br/>def randRange(a, b):<br/>    '''<br/>    a utility function to generate random float values in desired    range<br/>    '''<br/>    return pl.rand() * (b - a) + a</span><span id="a41a" class="nj mm it os b gy pa ox l oy oz">def randomCrop(im):<br/>    '''<br/>    croping the image in the center from a random margin from the borders<br/>    '''<br/>    margin = 1/3.5<br/>    start = [int(randRange(0, im.shape[0] * margin)),<br/>             int(randRange(0, im.shape[1] * margin))]<br/>    end = [int(randRange(im.shape[0] * (1-margin), im.shape[0])), <br/>           int(randRange(im.shape[1] * (1-margin), im.shape[1]))]<br/>    cropped_image = (im[start[0]:end[0], start[1]:end[1]])<br/>    return cropped_image</span><span id="7454" class="nj mm it os b gy pa ox l oy oz"><br/>fig,ax = plt.subplots(nrows=1,ncols=2,figsize=(20,12))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=20)<br/>ax[1].imshow(randomCrop(image))<br/>ax[1].set_title("Cropped", size=20)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/3c96f93a607f66a58e1430aacd8dd8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-KFAqa-5hZhFIkPc_Lm3Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">裁剪图像|作者提供的图像</p></figure><h2 id="99f9" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">亮度操作</h2><p id="a932" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated"><code class="fe pk pl pm os b">exposure</code>模块用于亮度操作。函数<code class="fe pk pl pm os b">adjust_gamma</code>对输入图像执行<strong class="lk jd">伽马校正</strong>。gamma值越高，生成的图像越暗。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="ad22" class="nj mm it os b gy ow ox l oy oz">image_bright = adjust_gamma(image, gamma=0.5,gain=1)<br/>image_dark = adjust_gamma(image, gamma=2,gain=1)</span><span id="ca13" class="nj mm it os b gy pa ox l oy oz">fig,ax = plt.subplots(nrows=1,ncols=3,figsize=(20,12))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=20)<br/>ax[1].imshow(image_bright)<br/>ax[1].set_title("Brightened Image", size=20)<br/>ax[2].imshow(image_dark)<br/>ax[2].set_title("Darkened Image", size=20)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pq"><img src="../Images/fdf6635ded2a79f7368ba75d7c555e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xvbim-Jtb4scSA6EIyHG-Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图像中的亮度处理|作者提供的图像</p></figure><h2 id="4d3e" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">图像大小调整和缩放</h2><p id="97bd" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated"><code class="fe pk pl pm os b">transform.resize()</code>函数转换给定的图像以匹配特定的尺寸。这个函数可以插值放大或缩小图像。请确保在缩小图像时启用抗锯齿功能，以避免出现锯齿现象。<a class="ae lh" href="https://helpx.adobe.com/photoshop/key-concepts/aliasing-anti-aliasing.html#:~:text=Anti%2Daliasing%20is%20the%20smoothing,make%20the%20edges%20appear%20smoother." rel="noopener ugc nofollow" target="_blank"> <strong class="lk jd">反</strong> - <strong class="lk jd">走样</strong> </a>是数字图像中锯齿状边缘的平滑。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="83a0" class="nj mm it os b gy ow ox l oy oz">image_resized = resize(image, (image.shape[0] // 2, image.shape[1] // 2),anti_aliasing=True)<br/></span><span id="5ddf" class="nj mm it os b gy pa ox l oy oz">fig, ax = plt.subplots(nrows=1, ncols=2,figsize=(30,16))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=20)<br/>ax[1].imshow(image_resized)<br/>ax[1].set_title("Resized image",size=20)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pr"><img src="../Images/1ad8b8e9878d43fc43ce352324e46b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3x_2QgQBZAwiiVTMIN2XQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">已调整大小的图片|作者图片</p></figure><p id="13ff" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了允许指定输出图像形状而不是比例因子外，<code class="fe pk pl pm os b">resize()</code>功能也用于相同的目的。</p><h2 id="3203" class="nj mm it bd mn nk nl dn mr nm nn dp mv lr no np mx lv nq nr mz lz ns nt nb iz bi translated">添加噪声</h2><p id="32aa" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated"><code class="fe pk pl pm os b">random_noise()</code>是来自<a class="ae lh" href="https://scikit-image.org/docs/dev/api/skimage.util.html#random-noise" rel="noopener ugc nofollow" target="_blank"> skimage的util模块</a>的一个函数。它用于将各种类型的随机噪声添加到图像中。噪声是一种缺陷，它被添加到图像中以引入某种可变性。</p><pre class="ks kt ku kv gt or os ot ou aw ov bi"><span id="3ee3" class="nj mm it os b gy ow ox l oy oz">noisy_image= random_noise(image)</span><span id="6c45" class="nj mm it os b gy pa ox l oy oz">fig, ax = plt.subplots(nrows=1, ncols=2,figsize=(30,16))<br/>ax[0].imshow(image)<br/>ax[0].set_title("Original Image", size=20)<br/>ax[1].imshow(noisy_image)<br/>ax[1].set_title("Image after adding noise",size=20)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ps"><img src="../Images/96d8dd1c32c574cce2a6ccddaccb4a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SnxIsTZYsjNifMwNE1wOXQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图像中的噪声添加|作者提供的图像</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="a607" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">结论和后续步骤</h1><p id="8722" class="pw-post-body-paragraph li lj it lk b ll nd kd ln lo ne kg lq lr nf lt lu lv ng lx ly lz nh mb mc md im bi translated">数据扩充已被证明是提高分类任务准确性的有前途的方法。这在数据可用性有限的情况下尤其重要。Python以scikit-image的形式提供了一个健壮的库，其中包含许多图像增强算法。它是免费的，不受限制的，背后有一个活跃的社区。查看文档以了解关于该库及其用例的更多信息。在接下来的几篇文章中，我们将讨论其他常用的增强库。敬请期待！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="6427" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">感谢</h1><ul class=""><li id="5bc4" class="nv nw it lk b ll nd lo ne lr pt lv pu lz pv md oa ob oc od bi translated">图标的名词项目:翻转图标标记；塞巴斯蒂安·贝拉卡扎尔·拉雷奥轮替；Setyo Ari Wibowo的作物；视觉世界的亮度控制；图像由ibrandify阿瑟·史林的《噪声抖动》。</li><li id="df11" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated">数据集参考:<a class="ae lh" href="https://arxiv.org/abs/2004.11958" rel="noopener ugc nofollow" target="_blank">植物病理学2020挑战数据集对苹果叶部疾病进行分类</a></li><li id="7235" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><a class="ae lh" href="https://nanonets.com/blog/data-augmentation-how-to-use-deep-learning-when-you-have-limited-data-part-2/" rel="noopener ugc nofollow" target="_blank">数据扩充|如何在数据有限的情况下使用深度学习—第二部分</a></li><li id="f7d1" class="nv nw it lk b ll oe lo of lr og lv oh lz oi md oa ob oc od bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/data-augmentation-for-deep-learning-4fe21d1a4eb9">深度学习的数据增强</a></li></ul></div></div>    
</body>
</html>