<html>
<head>
<title>AWS Glue 101: All you need to know with a full walk-through</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Glue 101:您需要了解的全部内容</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/aws-glue-101-all-you-need-to-know-with-a-real-world-example-f34af17b782f?source=collection_archive---------0-----------------------#2020-11-03">https://towardsdatascience.com/aws-glue-101-all-you-need-to-know-with-a-real-world-example-f34af17b782f?source=collection_archive---------0-----------------------#2020-11-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a517" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">什么是胶水？解释了完整的ETL管道</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/75ea7b2fd60f8f97dccd55a5a4b38635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQ9u7DF3-bzqT6EhgIw2AQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@erika-pugliese-1021047?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">埃里卡·普列塞</a>从<a class="ae kv" href="https://www.pexels.com/photo/glue-gun-beside-green-leaves-and-flower-on-white-surface-1999263/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><p id="8b33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有没有想过大型科技公司是如何设计他们的生产ETL管道的？有兴趣了解如何无缝抓取数据的TB、ZB并高效解析到数据库或其他存储，以便于数据科学家和数据分析师使用吗？</p><p id="7f53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本帖中，我将详细解释(<em class="ls">用图形表示！</em>)使用AWS服务(Glue、S3、红移)的ETL过程的设计与实现。任何没有AWS Glue或AWS堆栈经验或接触过AWS Glue或AWS堆栈(甚至没有深入的开发经验)的人都应该很容易理解。对于那些对使用AWS Glue感兴趣的人来说，这篇文章可以作为一个很好的入门指南。</p><p id="d1c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开始本演练之前，让我们简要回答三(3)个常见问题:</p><blockquote class="lt lu lv"><p id="e5ae" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">AWS胶水到底是什么？</p><p id="56cf" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">使用胶水有什么特点和优势？</p><p id="fc31" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">真实世界的场景是什么？</p></blockquote></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="0fe5" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">什么是AWS胶水？</h1><p id="e01f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">那么什么是胶水呢？AWS Glue只是一个无服务器的ETL工具。ETL指的是大多数数据分析/机器学习过程中通常需要的三(3)个过程:提取、转换、加载。<em class="ls">从源中提取</em>数据，<em class="ls">将</em>数据转换成适合应用程序的方式，然后<em class="ls">将数据加载</em>回数据仓库。AWS帮助我们创造奇迹。AWS控制台UI为我们提供了将整个任务执行到底的简单方法。不需要额外的代码脚本。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="b739" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">AWS胶水的成分</h1><ul class=""><li id="41e7" class="nd ne iq ky b kz my lc mz lf nf lj ng ln nh lr ni nj nk nl bi translated"><strong class="ky ir">数据目录:</strong>数据目录保存元数据和数据的结构。</li><li id="5648" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">数据库:</strong>用于创建或访问源和目标的数据库。</li><li id="3e2a" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">表:</strong>在数据库中创建一个或多个表，供源和目标使用。</li><li id="52a0" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">爬虫和分类器:</strong>爬虫用于使用内置或定制的分类器从源中检索数据。它创建/使用在数据目录中预定义的元数据表。</li><li id="9cd9" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">作业:</strong>作业是执行ETL任务的业务逻辑。在内部，Apache Spark用python或scala语言编写了这个业务逻辑。</li><li id="d41d" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">触发器:</strong>触发器按需或在特定时间启动ETL作业执行。</li><li id="7f67" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><strong class="ky ir">开发端点:</strong>它创建了一个可以测试、开发和调试ETL作业脚本的开发环境。</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="3114" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">为什么要用AWS胶水？</h1><p id="0d59" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">胶水对我们有什么好处？以下是在你自己的工作场所或组织中使用它的一些优势</p><ul class=""><li id="9083" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">AWS使用爬虫扫描所有可用的数据</li><li id="84a9" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">最终处理的数据可以存储在许多不同的地方(亚马逊RDS、亚马逊红移、亚马逊S3等)</li><li id="a69e" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">是云服务。内部基础设施不需要资金。</li><li id="8243" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">这是一个划算的选择，因为它是一个无服务器的ETL服务</li><li id="dc87" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">它很快。它马上给你Python/Scala ETL代码。</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="dbba" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">AWS胶水的生产用例</h1><p id="a757" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">这里有一个使用AWS胶水的实际例子。</p><p id="8c4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个游戏软件每天会产生几MB或几GB的用户游戏数据。从软件中收集用户生成数据的服务器每6小时将数据推送到AWS S3一次(JDBC连接使用亚马逊S3、亚马逊RDS、亚马逊红移或任何外部数据库连接数据源和目标)。</p><p id="8ad2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们公司希望根据用户资料预测该剧的时长。为了执行这项任务，数据工程团队应该确保获得所有的原始数据，并以正确的方式对其进行预处理。Glue提供了Python SDK，我们可以在其中创建一个新的Glue Job Python脚本来简化ETL。代码运行在Spark(一个分布式系统，可以使过程更快)之上，它是在AWS Glue中自动配置的。由于spark，数据将被分成小块，并在多台机器上同时并行处理。</p><p id="7db7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">提取— </strong>该脚本将把S3存储桶中的所有使用数据读取到一个数据帧中(您可以把它想象成Pandas中的一个数据帧)</p><p id="f28a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">转换— </strong>假设原始数据平均每秒包含10个不同的日志。分析团队希望以特定的逻辑每1分钟汇总一次数据。</p><p id="7344" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">加载— </strong>将处理后的数据写回到另一个S3存储桶，供分析团队使用。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="f547" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">项目演练</h1><p id="5939" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">对于项目的范围，我们将使用来自电信流失数据集的样本CSV文件(数据包含20个不同的列。数据集的目标是二元分类，并且目标是基于每个人的信息来预测每个人是否会继续订阅电信。我在这个演示中使用的数据和数据集的描述可以通过<a class="ae kv" href="https://www.kaggle.com/blastchar/telco-customer-churn" rel="noopener ugc nofollow" target="_blank">点击这个Kaggle链接</a>下载。</p><h1 id="a15d" class="mg mh iq bd mi mj nu ml mm mn nv mp mq jw nw jx ms jz nx ka mu kc ny kd mw mx bi translated">1.创建一个IAM角色来访问AWS Glue + EC2 + CloudWatch + S3</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/b160ec0a34bd316268ed4a609972ebfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TG04dWGWgtOOaqmr6557dQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="7a71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您需要一个适当的角色来访问您将在此过程中使用的不同服务。IAM角色类似于IAM用户，因为它是一个AWS身份，权限策略决定该身份在AWS中可以做什么和不可以做什么。当您获得一个角色时，它为您的角色会话提供临时安全凭证。你可以在这里找到更多关于我的角色的信息</p><ul class=""><li id="d477" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">打开<a class="ae kv" href="https://console.aws.amazon.com/iam" rel="noopener ugc nofollow" target="_blank">亚马逊IAM控制台</a></li><li id="1c4d" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">点击<em class="ls">角色</em> → <em class="ls">创建角色</em>。</li><li id="0a5a" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">从“<em class="ls">选择将使用此角色的服务”</em>中选择粘合服务</li><li id="8552" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">从“<em class="ls">选择您的用例</em>部分选择胶水</li><li id="6456" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">从<em class="ls">附加权限策略</em>部分选择“<em class="ls">AWSGlueServiceRole”</em>。</li><li id="11c7" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">点击<em class="ls">下一步:标签</em>。将<em class="ls">添加标签</em>部分留空。创建角色。</li><li id="f14c" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">您的角色现在可以完全访问AWS Glue和其他服务</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="03a7" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">2.上传源文件到亚马逊S3</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/1d2caf9e81e4ae2f2d622bfd639dd968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UexaV2-5J2EPQ7RpyGPoAQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="7a25" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">在<em class="ls">亚马逊S3 </em>控制台上，点击<em class="ls">创建一个可以存储文件和文件夹的存储桶</em>。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/2d1f6c5d1925aa9d5082ae6c5cbf174d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzbTUBzAI_OGmxq0VtKx6g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="f2f4" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">输入一个<em class="ls">桶名</em>，选择一个<em class="ls">区域</em>，点击<em class="ls">下一个</em></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/19bbc03e69b899f7406647f22c714f89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hA2GMOfNkF8CeE-o_AocYA.png"/></div></div></figure><ul class=""><li id="73d9" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">剩余的配置设置现在可以保持为空。点击下一个的<em class="ls">来创建你的S3桶。</em></li><li id="609a" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">在您的存储桶中创建一个新文件夹，并上传源文件</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/93a1f021e6a02b4fc21955fb1f5fc813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kVn8Pe3uy7CoY7Hlu-M8w.png"/></div></div></figure><ul class=""><li id="9b55" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">(可选)在将数据加载到bucket之前，您可以尝试使用python中的几个库将数据的大小压缩成不同的格式(例如Parquet)</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="e20d" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">3.启动AWS胶水数据库</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/661fa123fb693b06ab562a287d80e6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlSitFyntJDiyZfw8Bn3Sg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="d800" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了将数据添加到粘合数据目录中，这有助于保存元数据和数据结构，我们需要将粘合数据库定义为逻辑容器。</p><p id="fb19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们需要初始化胶水数据库</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="9e8f" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">4.<strong class="ak">创建并运行胶水爬虫</strong></h1><p id="7248" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">由于我们已经准备好了胶水数据库，我们需要将我们的数据输入到模型中。因此，我们正在尝试这样做:我们将创建爬行器，基本上扫描指定S3桶中的所有可用数据。爬虫<a class="ae kv" href="https://docs.aws.amazon.com/glue/latest/dg/add-classifier.html#classifier-built-in" rel="noopener ugc nofollow" target="_blank">自动识别最常见的分类器</a>，包括CSV、JSON和Parquet。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/1c7ae6cafbf708cd075149fbef3d0a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSFD5XXH6uw79LPYoyqMNw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="a889" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">在<em class="ls"> AWS胶水</em>控制台的左窗格中，点击<em class="ls">爬虫- &gt;添加爬虫</em></li><li id="81b9" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">点击蓝色的<strong class="ky ir">添加爬虫</strong>按钮。</li><li id="77a2" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">将爬虫命名为<strong class="ky ir">、</strong>并保留不变，用于<strong class="ky ir">“指定爬虫类型”</strong></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/1ca79c857d7d84b798c246b98f925dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3apMxW8FE8VEUU3Ftgs3Cg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="0bff" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">在<strong class="ky ir">数据存储中，</strong>选择S3并选择您创建的存储桶。向下钻取选择<em class="ls">读取</em>文件夹</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/55ef064e3cc912a91d2fa951e92dc502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Fbg07TkhrKPclGm82UmUQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="9562" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">在<strong class="ky ir">我的角色中，</strong>选择您在上面创建的角色</li><li id="c8cd" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">现在将频率设置为“按需运行”。您可以随时根据自己的兴趣更改爬虫计划。</li><li id="bcf1" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">在<strong class="ky ir">输出中，</strong>指定您在上面创建的胶水数据库(<em class="ls"> sampledb </em>)</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/ff3edf7fc3df71a71ae9744dbf26189c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LfIGkLMxqWtbJrkKMHqQ-A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="b622" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">然后，生成一个胶水爬行器，它读取指定S3桶中的所有文件</li><li id="37c6" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">点击复选框，点击<em class="ls">运行爬虫</em>运行爬虫</li><li id="dc6c" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">完成后，您应该会看到它的状态为“停止”。并且指定了“上次运行时间”和“添加的表”。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/8507aef431fd589f6c1052867c83394e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cX5ttdiivGwWVDHMXWD8Bg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="4a72" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">然后，左侧窗格中的<em class="ls">数据库</em> → <em class="ls">表</em>让您验证这些表是否是由爬虫自动创建的。</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="119e" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated"><strong class="ak"> 5。定义涂胶作业</strong></h1><p id="8649" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">有了最终的表，我们知道创建粘合作业，它可以按计划、按触发或按需运行。创建Glue jobs的有趣之处在于，它实际上可以是一个几乎完全基于GUI的活动，只需点击几下按钮就可以自动生成必要的python代码。但是，我将做一些编辑，以便综合多个源文件并执行就地数据质量验证。默认情况下，Glue使用DynamicFrame对象来包含关系数据表，并且它们可以很容易地来回转换为PySpark数据帧以进行自定义转换。</p><blockquote class="lt lu lv"><p id="4e39" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">请注意，在这一步，如果来自爬行器的数据变大，您可以选择启动另一个数据库(即AWS RedShift)来保存最终数据表。对于项目范围，我们跳过这一步，将处理后的数据表直接放回另一个S3存储桶</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/c0cb60275e56b4d805f8b6eb8dd6a5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vzq7gKnhOJq7FjFMzTe9sQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="8874" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">在左侧窗格中，点击<em class="ls">工作</em>，然后点击<em class="ls">添加工作</em></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/ab548f3e13ecb9ac542cf43d8efa4c2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kkJTFsMjD0hBeJlFNPV-Vw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="6345" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">给<em class="ls">起个名字</em>，然后选择之前为AWS Glue创建的<em class="ls"> IAM角色</em></li><li id="5806" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">选择<em class="ls">类型</em>的<em class="ls"> Spark </em>选择<em class="ls"> Spark 2.4，<em class="ls">胶版</em>的Python 3 </em></li><li id="b106" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">您可以在<em class="ls">安全配置、脚本库和作业参数</em>的<em class="ls">最大容量</em>字段中编辑DPU(数据处理单元)值的数量(可选)。</li><li id="288d" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">剩余的配置是可选的</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/aab8a617df7f919d05fdb23714982fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGieEOjimfiyox-9CKcjwg.png"/></div></div></figure><ul class=""><li id="6ad0" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">从<em class="ls">选择数据源</em>部分选择一个<em class="ls">数据源表</em>。您只能选择一个数据源。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/587906e0e6d360d4894b371821c3c597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZVTIl8nowlBWVpoLh9Gtw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="cc97" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">给AWS红移增加一个JDBC连接。我们需要选择一个位置来存储最终处理后的数据。如果您有数据库，可以选择现有的数据库。或者你可以写回S3集群。对于本教程，我们将继续使用默认映射。业务逻辑也可以在以后对此进行修改。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/627f7f436cb4dfa0331ce1e6686f3c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sq8utMuMpMYasECI5bq1-w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="5baf" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">通过选择最近创建的作业名称打开Python脚本。点击<em class="ls">动作- &gt;编辑脚本</em>。</li><li id="f40f" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">左窗格显示了ETL过程的可视化表示。右侧窗格显示脚本代码，在它的正下方，您可以看到正在运行的作业的日志。</li><li id="5159" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">通过单击运行作业保存并执行作业。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/78f6ec2ddd92072b20317b0db3958d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBFW4jI2gEPbHyWl-1nijw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><ul class=""><li id="3e9f" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated">我们在运行脚本后获得历史记录，并在S3中填充最终数据(或者，如果我们将红移作为最终数据存储，则为SQL准备好数据)</li></ul><h1 id="67b6" class="mg mh iq bd mi mj nu ml mm mn nv mp mq jw nw jx ms jz nx ka mu kc ny kd mw mx bi translated">结论</h1><p id="2d66" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">总而言之，我们已经构建了一个完整的ETL过程:我们创建了一个S3桶，将我们的原始数据上传到桶中，启动glue数据库，添加一个crawler来浏览上述S3桶中的数据，创建一个GlueJobs，它可以按计划、按触发或按需运行，最后将数据更新回S3桶。</p><p id="5a49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以做的额外工作是根据业务需求修改GlueJob阶段提供的Python脚本。<br/>(即改进预处理以缩放数值变量)</p><p id="ebc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总的来说，上面的结构将让您开始在任何业务生产环境中设置ETL管道。</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="264b" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">额外资源</h1><p id="d4f5" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated"><em class="ls">有关学习其他数据科学主题的更多详细信息，下面的Github存储库也会有所帮助。它包含易于遵循的代码，让你开始解释。</em></p><ul class=""><li id="31d7" class="nd ne iq ky b kz la lc ld lf nr lj ns ln nt lr ni nj nk nl bi translated"><a class="ae kv" href="https://github.com/hyunjoonbok/amazon-sagemaker" rel="noopener ugc nofollow" target="_blank">生产中的AWS sage maker</a><br/>展示如何使用Amazon SageMaker及其ML/DL算法解决业务问题的端到端示例。</li><li id="c75c" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><a class="ae kv" href="https://github.com/hyunjoonbok/PySpark" rel="noopener ugc nofollow" target="_blank"> PySpark </a> <br/>函数和实用程序，带有真实世界的数据示例。可以用来构建一个完整的数据建模的ETL过程</li><li id="0336" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><a class="ae kv" href="https://github.com/hyunjoonbok/Recommendation_System-PyTorch" rel="noopener ugc nofollow" target="_blank">推荐系统</a><br/>py torch中推荐系统的生产级实现。克隆repo并通过运行“main.py”开始训练</li><li id="37f1" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated"><a class="ae kv" href="https://github.com/hyunjoonbok/natural-language-processing" rel="noopener ugc nofollow" target="_blank">自然语言处理(NLP)</a><br/>Python中几种自然语言处理方法的完整实现示例。按照学习的复杂程度排序</li></ul></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><h1 id="5113" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">关于作者</h1><p id="399d" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">贤俊是一名拥有统计学学位的数据极客。他喜欢分享数据科学/分析知识。在LinkedIn 上给他发消息联系。</p><p id="de29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">参考:<br/></em>【1】杰西·弗雷德里克森，<a class="ae kv" rel="noopener" target="_blank" href="/aws-glue-and-you-e2e4322f0805">https://towardsdatascience . com/AWS-Glue-and-you-e2e 4322 f 0805</a><br/>【2】Synerzip，<a class="ae kv" href="https://www.synerzip.com/blog/a-practical-guide-to-aws-glue/" rel="noopener ugc nofollow" target="_blank">https://www . Synerzip . com/blog/A-Practical-Guide-to-AWS-Glue/</a>《AWS胶水实用指南》<br/>【3】肖恩·奈特，<a class="ae kv" rel="noopener" target="_blank" href="/aws-glue-amazons-new-etl-tool-8c4a813d751a">https://towards</a></p></div></div>    
</body>
</html>