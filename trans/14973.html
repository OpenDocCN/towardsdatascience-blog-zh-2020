<html>
<head>
<title>Step-by-Step Guide — Building a Prediction Model in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分步指南-用Python构建预测模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/step-by-step-guide-building-a-prediction-model-in-python-ac441e8b9e8b?source=collection_archive---------1-----------------------#2020-10-15">https://towardsdatascience.com/step-by-step-guide-building-a-prediction-model-in-python-ac441e8b9e8b?source=collection_archive---------1-----------------------#2020-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="155f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用长短期记忆预测模型的动手练习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e26ae40726d5a61f207fb8c6ea5bd3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cP-z6n0_Nxt1C8-AmRPttw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/s/photos/stock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@austindistel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</p></figure><blockquote class="kz la lb"><p id="b76a" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">来自《走向数据科学》编辑的提示:</strong>虽然我们允许独立作者根据我们的<a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5">规则和指导方针</a>发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的<a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4">读者术语</a>。</p></blockquote></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="6591" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi mj translated">在这篇文章中，我将向你展示如何构建一个可以预测特定股票价格的程序。这是一个在金融领域使用机器学习的伟大工程。如果我们想要一台机器为我们做预测，我们肯定应该用一些数据好好训练它。首先，对于刚接触python的人，我将向您介绍一下。然后，我们将开始研究我们的预测模型。正如副标题中提到的，我们将使用苹果股票数据。如果你想知道是否可以免费获得这些数据，答案是肯定的。股票数据可以在纳斯达克官方网站上找到。纳斯达克(全美证券交易商自动报价协会)是一个电子股票交易所，拥有3300多家上市公司。</p><p id="167c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">苹果股票数据可以从<a class="ae ky" href="https://www.nasdaq.com/market-activity/stocks/aapl/historical" rel="noopener ugc nofollow" target="_blank">这里</a>下载。在这个网站上，你还可以找到不同公司的股票数据，并使用不同的数据集练习你的技能。我迫不及待地想看到我们的预测准确性结果，让我们开始吧！</p><h2 id="94f3" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">目录:</h2><ul class=""><li id="ca47" class="nl nm it lf b lg nn lj no mg np mh nq mi nr ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le"> Python </em> </strong></li><li id="963d" class="nl nm it lf b lg nw lj nx mg ny mh nz mi oa ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le">图书馆</em> </strong></li><li id="4a0f" class="nl nm it lf b lg nw lj nx mg ny mh nz mi oa ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le">了解苹果股票数据</em> </strong></li><li id="4457" class="nl nm it lf b lg nw lj nx mg ny mh nz mi oa ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le">数据操作</em> </strong></li><li id="1606" class="nl nm it lf b lg nw lj nx mg ny mh nz mi oa ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le">数据可视化</em> </strong></li><li id="2c75" class="nl nm it lf b lg nw lj nx mg ny mh nz mi oa ly ns nt nu nv bi translated"><strong class="lf iu"> <em class="le"> LSTM预测模型</em> </strong></li></ul></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="c45a" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">计算机编程语言</h1><p id="9955" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">Python是一种通用编程语言，在分析数据方面越来越受欢迎。Python还能让您快速工作，更有效地集成系统。世界各地的公司都在利用Python从他们的数据中收集知识。Python官方页面如果你想<a class="ae ky" href="https://www.python.org/about/" rel="noopener ugc nofollow" target="_blank">了解更多</a>。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><div class="kj kk kl km gt op"><a rel="noopener follow" target="_blank" href="/python-for-finance-the-complete-beginners-guide-764276d74cef"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">面向金融的Python完全初学者指南</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">使用亚马逊股票数据的简单实践</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ks op"/></div></div></a></div></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="e9bd" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">图书馆</h1><p id="6b93" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">首先，我们必须安装一些库，这样我们的程序才能工作。下面是我们将要安装的库的列表:pandas、numpy、keras和tensorflow。必须安装Tensorflow，keras才能工作。</p><blockquote class="kz la lb"><p id="5a72" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">Keras是为人类设计的API，不是为机器设计的。Keras遵循减少认知负荷的最佳实践:它提供一致而简单的API，最大限度地减少常见用例所需的用户操作数量，并提供清晰可操作的错误消息。它还有大量的文档和开发人员指南。</p><p id="5ba6" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">参考:<a class="ae ky" href="https://keras.io" rel="noopener ugc nofollow" target="_blank"> https://keras.io </a></p></blockquote><p id="679b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">我们可以使用Pip库管理器安装这些库:</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="a049" class="ms mt it pf b gy pj pk l pl pm">pip install pandas numpy keras tensorflow</span></pre><p id="044d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">安装完成后，让我们将它们导入到代码编辑器中。Python中已经包含了Matplotlib，这就是为什么我们不用安装就可以导入它。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="ce97" class="ms mt it pf b gy pj pk l pl pm">import pandas as pd<br/>import numpy as np</span><span id="c969" class="ms mt it pf b gy pn pk l pl pm">import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>from matplotlib.pylab import rcParams<br/>rcParams['figure.figsize']=20,10</span><span id="760b" class="ms mt it pf b gy pn pk l pl pm">from keras.models import Sequential<br/>from keras.layers import LSTM,Dropout,Dense</span><span id="0290" class="ms mt it pf b gy pn pk l pl pm">from sklearn.preprocessing import MinMaxScaler</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="0aee" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">了解苹果股票数据</h1><p id="8f55" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">其次，我们将开始将数据加载到一个数据帧中，在我们开始操作它之前查看它是一个好的做法。这有助于我们理解我们有正确的数据，并获得一些关于它的见解。</p><p id="f62a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">如前所述，在本练习中，我们将使用Apple的历史数据。我认为苹果会是一个很好的搭配。和我一起完成这个项目后，你会学到一些技巧，让你有能力使用不同的数据集来练习。</p><p id="df8a" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">我们将使用的数据框架包含过去一年(2019年9月16日-2020年9月15日)苹果股票的收盘价。</p><h2 id="ffd6" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">读出数据</h2><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="0c52" class="ms mt it pf b gy pj pk l pl pm">import pandas as pd</span><span id="4cd4" class="ms mt it pf b gy pn pk l pl pm">df = pd.read_csv('aapl_stock_1yr.csv')</span></pre><h2 id="43d7" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">头部方法</h2><p id="7421" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">为了对数据有所了解，我们要做的第一件事是使用head方法。当您在dataframe上调用head方法时，它会显示dataframe的前五行。运行这个方法后，我们还可以看到我们的数据是按日期索引排序的。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="e12f" class="ms mt it pf b gy pj pk l pl pm">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/b57c95aca5061363fc459be9f831da71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCWw6UXQCYDQAMiESOdAHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="a7f9" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">尾部法</h2><p id="c5a3" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">另一个有用的方法我们称之为尾部方法。它显示数据帧的最后五行。假设您想查看最后七行，您可以在括号之间输入整数7。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="ede8" class="ms mt it pf b gy pj pk l pl pm">df.tail(7)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/ed5a2a60221bb6b5642c0c31fee1c50e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrTsx5hmyYOjp1CgIeTwjA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="e65f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">现在我们对数据有了一个概念。让我们进入下一步，即数据操作，并为预测做好准备。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="bcb5" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">数据操作</h1><h2 id="bc43" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">子集化</h2><p id="d385" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">正如您在前面的截图中看到的，我们的数据框架有6列。我们需要全部吗？当然不是。对于我们的预测项目，我们只需要“日期”和“结束/最后”列。那么让我们去掉其他的柱子吧。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="914c" class="ms mt it pf b gy pj pk l pl pm">df = df[['Date', 'Close']]</span><span id="e245" class="ms mt it pf b gy pn pk l pl pm">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/5a357ab8d4155931a9b02d9cb7838785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoJFWZLz8FDEffZAfXzgbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="2211" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">数据类型</h2><p id="8d24" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">现在，让我们检查列的数据类型。因为收盘价值中有一个“$”符号，所以它可能不是float数据类型。当训练数据时，字符串数据类型不能用于我们的模型，所以我们必须将其转换为浮点或整数类型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/3038aaf9c5dad3eecb7507974162d55a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*APwyyCol13b6Cxz7Yqc9eg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2527" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">在我们将它转换为float之前，让我们去掉“$”符号。否则，转换方法会给我们一个错误。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="76ec" class="ms mt it pf b gy pj pk l pl pm">df = df.replace({'\$':''}, regex = True)</span></pre><p id="f6bd" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">太好了！现在，我们可以将“收盘价”数据类型转换为float。我们还将把“日期”数据转换成日期时间类型。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="9b3a" class="ms mt it pf b gy pj pk l pl pm">df = df.astype({"Close": float})</span><span id="c878" class="ms mt it pf b gy pn pk l pl pm">df["Date"] = pd.to_datetime(df.Date, format="%m/%d/%Y")</span><span id="7238" class="ms mt it pf b gy pn pk l pl pm">df.dtypes</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/26c8c848023f0bc4536594523428de9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nm7y1QQmJhBZ1jJIGiv_3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="e77e" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">索引栏</h2><p id="d619" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">这将是一小步。我们将数据帧的索引值定义为日期列。这将有助于数据可视化步骤。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="d58d" class="ms mt it pf b gy pj pk l pl pm">df.index = df['Date']</span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="e787" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">数据可视化</h1><p id="44dd" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">我将与你分享一个简单的折线图，只是为了让你对过去一年的股价变化有一个概念。我们还将在最后使用可视化方法来比较我们的预测和现实。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="0ca9" class="ms mt it pf b gy pj pk l pl pm">plt.plot(df["Close"],label='Close Price history')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/c94b885d2de331861eba79ed2872635e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WyS5AjN5S43VMBswn1b8fg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="6903" class="ob mt it bd mu oc od oe mx of og oh na jz oi ka nd kc oj kd ng kf ok kg nj ol bi translated">LSTM预测模型</h1><p id="d4ad" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">在这一步中，我们将完成大部分编程工作。首先，我们需要对数据做一些基本的调整。当我们的数据准备好了，我们将使用它来训练我们的模型。作为神经网络模型，我们将使用LSTM(长短期记忆)模型。当基于时间序列数据集进行预测时，LSTM模型非常有效。</p><h2 id="6914" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">数据准备</h2><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="a009" class="ms mt it pf b gy pj pk l pl pm">df = df.sort_index(ascending=True,axis=0)</span><span id="9ff8" class="ms mt it pf b gy pn pk l pl pm">data = pd.DataFrame(index=range(0,len(df)),columns=['Date','Close'])</span><span id="b99a" class="ms mt it pf b gy pn pk l pl pm">for i in range(0,len(data)):<br/>    data["Date"][i]=df['Date'][i]<br/>    data["Close"][i]=df["Close"][i]</span><span id="1e0e" class="ms mt it pf b gy pn pk l pl pm">data.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/85f3fd4cf63abb84c13a61b29b9c4c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3aEelrgeAzBMhOtxL7XDcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h2 id="317b" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">最小-最大缩放器</h2><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="38fa" class="ms mt it pf b gy pj pk l pl pm">scaler=MinMaxScaler(feature_range=(0,1))</span><span id="66d6" class="ms mt it pf b gy pn pk l pl pm">data.index=data.Date<br/>data.drop(“Date”,axis=1,inplace=True)</span><span id="fdc1" class="ms mt it pf b gy pn pk l pl pm">final_data = data.values<br/>train_data=final_data[0:200,:]<br/>valid_data=final_data[200:,:]</span><span id="33e1" class="ms mt it pf b gy pn pk l pl pm">scaler=MinMaxScaler(feature_range=(0,1))</span><span id="2ab6" class="ms mt it pf b gy pn pk l pl pm">scaled_data=scaler.fit_transform(final_data)<br/>x_train_data,y_train_data=[],[]<br/>for i in range(60,len(train_data)):<br/>    x_train_data.append(scaled_data[i-60:i,0])<br/>    y_train_data.append(scaled_data[i,0])</span></pre><h2 id="5f55" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">LSTM模型</h2><p id="58bc" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">在这一步，我们定义了长短期记忆模型。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="611f" class="ms mt it pf b gy pj pk l pl pm">lstm_model=Sequential()<br/>lstm_model.add(LSTM(units=50,return_sequences=True,input_shape=(np.shape(x_train_data)[1],1)))<br/>lstm_model.add(LSTM(units=50))<br/>lstm_model.add(Dense(1))</span><span id="f6d9" class="ms mt it pf b gy pn pk l pl pm">model_data=data[len(data)-len(valid_data)-60:].values<br/>model_data=model_data.reshape(-1,1)<br/>model_data=scaler.transform(model_data)</span></pre><h2 id="6abb" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">训练和测试数据</h2><p id="cd04" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">该步骤包括列车数据和测试数据的准备。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="d6a8" class="ms mt it pf b gy pj pk l pl pm">lstm_model.compile(loss=’mean_squared_error’,optimizer=’adam’)<br/>lstm_model.fit(x_train_data,y_train_data,epochs=1,batch_size=1,verbose=2)</span><span id="036e" class="ms mt it pf b gy pn pk l pl pm">X_test=[]<br/>for i in range(60,model_data.shape[0]):<br/>    X_test.append(model_data[i-60:i,0])<br/>X_test=np.array(X_test)<br/>X_test=np.reshape(X_test,(X_test.shape[0],X_test.shape[1],1))</span></pre><h2 id="a864" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">预测函数</h2><p id="44ac" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">在这一步中，我们使用在上一步中定义的测试数据来运行模型。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="2617" class="ms mt it pf b gy pj pk l pl pm">predicted_stock_price=lstm_model.predict(X_test)<br/>predicted_stock_price=scaler.inverse_transform(predicted_stock_price)</span></pre><h2 id="da7b" class="ms mt it bd mu mv mw dn mx my mz dp na mg nb nc nd mh ne nf ng mi nh ni nj nk bi translated">预测结果</h2><p id="f6d4" class="pw-post-body-paragraph lc ld it lf b lg nn ju li lj no jx ll mg om lo lp mh on ls lt mi oo lw lx ly im bi translated">差不多了，让我们检查一下模型的准确性。我们有大约250行，所以我用80%作为训练数据，20%作为测试数据。</p><pre class="kj kk kl km gt pe pf pg ph aw pi bi"><span id="9e30" class="ms mt it pf b gy pj pk l pl pm">train_data=data[:200]<br/>valid_data=data[200:]<br/>valid_data['Predictions']=predicted_stock_price<br/>plt.plot(train_data["Close"])<br/>plt.plot(valid_data[['Close',"Predictions"]])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pv"><img src="../Images/2f9896e2676ae86f82c7c4e2d4299c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zorMMluoHZIXo5znANPfUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">准确性可视化(红色:实际，绿色:预测)[图片由作者提供]</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><div class="kj kk kl km gt op"><a href="https://lifexplorer.medium.com/subscribe" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">每当贝希克居文出版时收到电子邮件。</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">每当贝希克居文出版时收到电子邮件。通过注册，您将创建一个中型帐户，如果您还没有…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">lifexplorer.medium.com</p></div></div><div class="oy l"><div class="pw l pa pb pc oy pd ks op"/></div></div></a></div><p id="62e7" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">恭喜你。！您已经创建了一个Python程序来预测一家公司的股票收盘价。现在，你对如何在金融中使用机器学习有了一些想法，你应该在不同的股票上尝试一下。希望你喜欢读我的文章。从事像这样的动手编程项目是提高编码技能的最好方式。</p><p id="1078" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mg ln lo lp mh lr ls lt mi lv lw lx ly im bi translated">我很高兴你今天学到了新东西。如果您在执行代码时有任何问题，请随时<a class="ae ky" href="https://sonsuzdesign.blog/" rel="noopener ugc nofollow" target="_blank">联系我</a>。😊</p><blockquote class="kz la lb"><p id="e7fe" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我是贝希克·居文，我喜欢分享关于编程、教育和生活的故事。<a class="ae ky" href="https://lifexplorer.medium.com/membership" rel="noopener">订阅</a>我的内容，保持灵感。泰，</p></blockquote></div></div>    
</body>
</html>