<html>
<head>
<title>End to End Adaptation of ResNet in Google Colab — Part 2: Hardware &amp; Dataset Setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google Colab中ResNet的端到端适配—第2部分:硬件和数据集设置</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-2-hardware-dataset-setup-f23dd4e0004d?source=collection_archive---------69-----------------------#2020-10-12">https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-2-hardware-dataset-setup-f23dd4e0004d?source=collection_archive---------69-----------------------#2020-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="2bfc" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">端到端Resnet</h2><div class=""/><div class=""><h2 id="1323" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">CPU、GPU、数据集设置</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/e15eff2a5640c76c2b468e5bc688d4ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gX1mA9Aeww6LaYJgVEQyYA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来源:Unsplash.com</p></figure><p id="9dc9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我希望你们都有机会预览本系列的<a class="ae le" rel="noopener" target="_blank" href="/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6">第1部分</a>，它不需要任何python知识，只需要一个Google和Kaggle帐户(后者只是为了验证你自己，所以你可以下载数据集。)</p><p id="6868" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">作为快速概述，我们能够在ResNet-18架构上训练狗与猫数据集(总共25，000张图像)。一旦完成训练，你就可以上传你最喜欢的猫或狗的照片，并观察输出结果。</p><p id="e759" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我将把这个系列分成5个部分:</p><ol class=""><li id="b4d3" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">介绍</li><li id="38ab" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">硬件和数据集设置</li><li id="2193" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">图像预处理</li><li id="5c4b" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">建筑培训</li><li id="5c05" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">真实世界测试</li></ol><h1 id="146b" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">旁白</h1><p id="a2f6" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">一旦你完成了训练，当你输入一张猫头鹰的照片时会发生什么？</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/b33d15fa9b072855ab509875822eb39d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*KCmBLfiiAVn4O9teHCFzWA.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来源:Unsplash.com<a class="ae le" href="https://unsplash.com/@sonderquest" rel="noopener ugc nofollow" target="_blank"/></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="fe1d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输出是‘狗’！虽然只有78.41%的把握。(如果最后一个单元格有问题，只需使用左侧的箭头重新运行它。)</p><p id="9109" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我已经插入了所有东西，从物品到我朋友的照片(他们看起来有点像猫)，结果到处都是。有时，概率在90%以上。</p><p id="a239" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果还不清楚的话，我要强调这一点——<strong class="lh ja">你必须知道使用</strong>训练网络的基础数据，否则你的预测将是不可靠的，并且取决于你使用它的目的，是危险的。你对这些数据了解得越多，你对输出的理解就越丰富。</p><p id="e599" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">不要用“人工智能”这个时髦词，但如果我要描述我们所建立的东西，我会称之为<a class="ae le" href="https://en.wikipedia.org/wiki/Weak_AI" rel="noopener ugc nofollow" target="_blank">“狭义人工智能”</a>。这不是<a class="ae le" href="https://en.wikipedia.org/wiki/Artificial_general_intelligence" rel="noopener ugc nofollow" target="_blank">人工通用智能(AGI) </a>。在这里我们只能辨别狗和猫。</p><h1 id="e378" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">库导入</h1><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="f84b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些是运行整个程序所需的库。‘torch’是PyTorch(类似于机器学习库Tensorflow)。“torchvision”包含最流行的模型和数据集以及图像转换(稍后讨论)。“matplotlib”让我们可以创建图像的图形和表格。</p><p id="55e1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">当您看到“从ABC进口XYZ”时，我们尽量不输入ABC。XYZ每次都可以用XYZ。例如:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="0eee" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以只使用“listdir”命令，而不是键入“os.listdir”。这是一个简单的例子，但是浓缩类似下面这样的代码有助于简化我们的代码:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="3ce8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你会看到在库导入单元格的末尾是:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="a4ad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">想想那个“！”将命令传递到命令行，而不是python内核，这样你就可以安装你需要的库，比如‘ka ggle’(让我们下载数据集)。</p><h1 id="b403" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">CPU、内存和GPU</h1><p id="2cc8" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">我提到过Google Colab中的高端CPU和GPU。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="3f74" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将向命令行传递一个命令，以获取有关CPU的信息，而“grep”(全局正则表达式打印)搜索纯文本数据。如果你跑了！你会得到一个很长的输出列表，但我们只是想知道有多少个cpu，型号和GHz。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="db44" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">与上面类似，‘啊！' cat /proc/meminfo '给出了一个很长的输出列表，但是我们只想知道总RAM(因此grep MemTotal)</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="5f12" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">CUDA(计算统一设备架构)是由Nvidia设计的，旨在让我们这样的程序员访问支持CUDA的GPU来加速我们的数学运算(在这种情况下，是图像分析)。有很多帖子在不同的细节层次上讨论了这是如何工作的。</p><p id="926e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">注意我们通过' torch.cuda.is_available()'使用pytorch库，它输出一个布尔值(True vs False)。如果为真，我们还可以使用pytorch库来获取设备的名称。</p><p id="899c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这个设备名称会根据Google Colab提供的内容不时更改(有时你根本无法获得GPU，因为你已经用完了当天的配额)。今天早上是特斯拉P100。有时我会得到一个超快的特斯拉T4(免费的！).</p><h1 id="b614" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">获取数据集</h1><p id="8f45" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">卡格尔号。在此步骤中，您下载的“JSON”文件将通过以下方式导入:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="dca2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果您参考库导入部分，您会看到这一行:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="551d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">“files.upload()”允许您上传kaggle.JSON。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8553" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">上面的命令都传递给机器命令行，而不是python内核。创建一个名为“kaggle”的目录，并将您上传的kaggle.json文件复制到新创建的目录中。</p><p id="bc45" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">“chmod 600”允许用户读写kaggle.json文件。这很重要，因为kaggle库使用JSON文件来验证您下载名为“dogs-vs-cats”的数据集。</p><p id="c09b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，解压缩(悄悄地，用-q ),但也覆盖(-o)以防你已经下载并解压缩了它。</p><p id="6c01" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">请在下面留下任何问题，我会尽力回答。</p><h1 id="afbe" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">参考</h1><p id="de47" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">[1] <a class="ae le" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html" rel="noopener ugc nofollow" target="_blank">深度学习与Pytorch </a>，2020年10月访问</p><p id="df56" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><a class="ae le" href="https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html" rel="noopener ugc nofollow" target="_blank">【2】神经网络与Pytorch。【2020年10月接入</a></p><p id="9e61" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[3] <a class="ae le" href="https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html" rel="noopener ugc nofollow" target="_blank">为计算机视觉转移学习。【2020年10月接入</a></p><p id="b7e0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[4] <a class="ae le" href="https://github.com/Kaggle/kaggle-api" rel="noopener ugc nofollow" target="_blank"> Kaggle API。【2020年10月访问</a></p></div></div>    
</body>
</html>