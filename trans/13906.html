<html>
<head>
<title>A beginner’s guide to joining data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">连接数据的初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-joining-data-935c8e579fb7?source=collection_archive---------28-----------------------#2020-09-24">https://towardsdatascience.com/a-beginners-guide-to-joining-data-935c8e579fb7?source=collection_archive---------28-----------------------#2020-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e3276d3d78db1be68b92455070ce364e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7IUZeyov3_iElh_6"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由来自<a class="ae jg" href="https://www.pexels.com/photo/man-standing-infront-of-white-board-1181345/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae jg" href="https://www.pexels.com/@divinetechygirl?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">克里斯蒂娜·莫里洛</a>拍摄</p></figure><div class=""/><div class=""><h2 id="3ac5" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">左连接、内连接、外连接</h2></div><p id="7ae3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">连接数据是数据分析的基本技能之一。不幸的是，当您刚刚开始时，或者当您正在从excel过渡到SQL或Python时，这也可能有点令人困惑。</p><p id="047a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将直观地解释连接数据意味着什么以及如何有效地进行连接。</p><h1 id="760a" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">加入数据是什么意思？</h1><p id="f33b" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">理解连接的最好方法是通过一个简单的例子来完成。</p><p id="de4a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设你为一家在网站上销售t恤的公司工作。</p><p id="f7ad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你有一个数据集告诉你关于你的网站<strong class="la jk">用户</strong>的细节。为简单起见，假设该表只包含唯一的客户端ID、客户端名称和来源国家:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mr"><img src="../Images/0bf27ba76a1ae72040c945e1b2abd822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6S1XvvSuW6YXqVIUK67xAQ.png"/></div></div></figure><p id="81c8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您还有另一个数据集，它告诉您这些网站用户的所有购买行为:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/ccba813784b5c2556c8fcb1aa8a7e171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVXj8XgL_yYOsouMxPuJnA.png"/></div></div></figure><p id="5a98" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你的老板走进房间，要求你告诉她哪个国家的网站销售额最高。</p><p id="8599" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要回答她的问题，你需要把告诉你客户在哪里的数据和告诉你他们买了什么的数据放在一起。换句话说，对于每一笔交易，您都需要弄清楚客户端位于何处。</p><p id="4730" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使这成为可能的是，这两个数据集之间有一些共性。在这种情况下，它是客户端ID。</p><p id="7892" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“连接”就是基于一个公共数据点组合数据。恰当地说，这个公共数据点被称为“连接键”</p><p id="321a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本例，我们可以使用下面的SQL查询将用户数据连接到购买数据，该查询使用“client ID”作为连接键:</p><pre class="ms mt mu mv gt mx my mz na aw nb bi"><span id="7ee1" class="nc lv jj my b gy nd ne l nf ng">select purchases.client_id, purchases.sale, users.country <br/>from purchases<br/>left join users<br/>on purchases.client_id = users.client_id;</span></pre><p id="d232" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">瞧:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/83c81633852de8073c7b62bf08dae91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3s6YQwPKl4NKvFsxkB5jg.png"/></div></div></figure><p id="1ab0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以看到墨西哥的销售额最高。(注意:如果我们有多行，我们会希望使用“groupby”和“sum”函数。但是由于我们在上面的例子中没有太多的数据，我们可以很容易地当场回答这个问题，并把那些话题留到另一天。)</p><h1 id="9f2a" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">为什么我们需要连接数据？</h1><p id="06c3" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">如果您是数据分析的新手，您可能会感到疑惑，为什么我们首先需要连接数据？为什么数据不能只存在一个表中？</p><p id="25ce" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这主要有两个原因。首先，数据通常从不同的来源获得。获取用户数据和事务数据的过程可能是分开的。</p><p id="9daf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您是excel的超级用户，想想您不得不执行vlookup来连接两个数据源的所有时间。本质上，这是一个连接。</p><p id="f2a1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第二个原因与速度有关。通常，一个表中的数据越多，从表中检索所需内容的时间就越长。</p><h1 id="96c1" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">不同类型连接的简单说明</h1><p id="3309" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">很好，现在我们对什么是联接以及为什么需要联接有了直觉。接下来，我们需要了解不同类型的连接。</p><p id="a149" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个人们经常犯错的领域，所以让我们试着把这部分讲清楚。</p><p id="e304" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要多种类型的连接有一个原因。如果你能记住原因，那么你就能记住类型。</p><p id="d74d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">原因如下:</strong>当你的连接键<strong class="la jk">中的值</strong>不存在于你正在连接的<strong class="la jk">和</strong>两个数据集时，计算机需要知道返回什么。</p><p id="f8be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们看一个基于之前数据集的例子。</p><p id="e938" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“8367”的客户端id在用户表中:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/c893cedc75316514ad25dd8b95e5136c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MY5QqjA0RCWP__eMjNIOfQ.png"/></div></div></figure><p id="857b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是它不在事务表中:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/ccba813784b5c2556c8fcb1aa8a7e171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gVXj8XgL_yYOsouMxPuJnA.png"/></div></div></figure><p id="8f8b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，join的“类型”只是告诉计算机在这种情况下做什么。</p><p id="ea89" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为该查询的自豪作者，您可以控制希望计算机返回的内容。</p><h2 id="db02" class="nc lv jj bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">左连接</h2><p id="4c69" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">一个“左连接”告诉计算机:“给我左表中的所有东西，即使它不在右表中。”</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/4df0625d194cbf9c2b225cb19f459e95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHovgvnNmPEJwA_BPGUjww.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">左边的表是查询中第一个出现的表</p></figure><p id="e17b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还记得前面的例子吗？我们使用了一个左连接，只从左表中获得了client _ ids:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/83c81633852de8073c7b62bf08dae91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3s6YQwPKl4NKvFsxkB5jg.png"/></div></div></figure><h2 id="f8a1" class="nc lv jj bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">完全外部连接</h2><p id="9cc1" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">“完全外部连接”告诉计算机，“给我两个表中的所有记录。”</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/13f75f1264ecc805c6781fc4739f8ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZICo6IKO8v5-XOVsOJs0g.png"/></div></div></figure><p id="c0c6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们从两个表中获取客户id，包括1902和8367(仅在users表中)以及1000(仅在purchases表中)。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/d4969702f0939a0ee962c3a7ff5ccab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txZRBz8CWQVfxN7qd2heTA.png"/></div></div></figure><p id="1309" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，上表中的一些单元格有“null”(即。缺少)值。这是有意义的，因为这些数据实际上并不存在于原始表中。</p><p id="fe54" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们知道客户id 1000购买了10美元，但是不知道这个客户来自哪里。如果它在原始数据中丢失，那么它将在连接后丢失。</p><h2 id="841f" class="nc lv jj bd lw nj nk dn ma nl nm dp me lh nn no mg ll np nq mi lp nr ns mk nt bi translated">内部连接</h2><p id="9422" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">最后，一个“内部连接”告诉计算机——“只给我那些连接键在两个表中都存在的记录。”</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/20bf115d9269499c2ebe8b8763d4bfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IanZ0uVbOld1iNp7sUYwgA.png"/></div></div></figure><p id="d555" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上述查询返回:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/3a5963aca3d4087ae870894e9ac177d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_28Id9detkh4PBreGEi6ew.png"/></div></div></figure><p id="a887" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，结果集中缺少所有非重叠的客户端id—1902、8367和1000。</p><h1 id="012b" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">需要注意的事项</h1><p id="bc00" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">了解有关连接数据的更多信息时，需要考虑以下几点:</p><ol class=""><li id="7a2e" class="nz oa jj la b lb lc le lf lh ob ll oc lp od lt oe of og oh bi translated">右连接:一个“右连接”告诉计算机“给我右表中的所有东西，即使它不在左表中”。我从来没用过右连接。为什么？因为任何时候你想做一个右连接，你可以颠倒表的顺序，然后做一个左连接。少了一件需要记住的事。</li><li id="b5f2" class="nz oa jj la b lb oi le oj lh ok ll ol lp om lt oe of og oh bi translated"><strong class="la jk">多键连接</strong>:可以连接多个列值。(即。table1.id1 = table2.id1和table1.id2 = table2.id2的左连接)</li><li id="3061" class="nz oa jj la b lb oi le oj lh ok ll ol lp om lt oe of og oh bi translated"><strong class="la jk"> Duplicates: </strong>始终注意连接前后表中记录的数量。初学者的一个常见错误是执行一个创建不需要的副本的连接。如果您遇到这种情况，您将不得不批判性地思考如何重写连接以得到您真正想要的。</li></ol><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="on oo l"/></div></figure></div></div>    
</body>
</html>