<html>
<head>
<title>Import HTML tables into Google Sheets effortlessly.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将HTML表格轻松导入Google Sheets。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/import-html-tables-into-google-sheets-effortlessly-f471eae58ac9?source=collection_archive---------1-----------------------#2020-10-07">https://towardsdatascience.com/import-html-tables-into-google-sheets-effortlessly-f471eae58ac9?source=collection_archive---------1-----------------------#2020-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5620" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用Google Sheets中的<code class="fe ki kj kk kl b">IMPORTHTML</code>功能，从网站导入表格和列表。</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/e513085ed936af9bcdbb933be815b598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PsPH0KSLBYtAI0_VfYh3A.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">由<a class="ae lc" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae lc" href="https://unsplash.com/s/photos/spreadsheet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的原始照片</p></figure><blockquote class="ld"><p id="2371" class="le lf it bd lg lh li lj lk ll lm ln dk translated">"从互联网上获取信息就像从消防水管里喝水一样."— <a class="ae lc" href="https://www.computerhope.com/people/mitchell_kapor.htm" rel="noopener ugc nofollow" target="_blank"> <em class="lo">米切尔·卡普尔</em> </a></p></blockquote><p id="f88f" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx ly lz ma mb mc md me mf mg mh mi mj ln im bi translated">互联网上充斥着大量数据。然而，以正确的格式获取数据才是真正的大事。将数据转换成适合分析的格式需要一定的清理和过滤。上周，我在维基百科上偶然发现了一些非常好的表格数据集。和往常一样，我把数据复制粘贴到excel表格上。在大多数情况下，它工作得很好，但是典型的复制-粘贴方法很少失败:</p><ul class=""><li id="9244" class="mk ml it lr b ls mm lv mn ly mo mc mp mg mq ln mr ms mt mu bi translated">当表格通常很长并且遍布整个网页时</li><li id="e423" class="mk ml it lr b ls mv lv mw ly mx mc my mg mz ln mr ms mt mu bi translated">当数据不是静态的，也就是说，它定期更新。因此，每次原始数据集发生变化时，我都必须再次获取数据集。</li></ul><p id="0c7c" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">对于这种情况，简单的复制粘贴是不够的。抓取是另一个选择，但是我在寻找一个快速简单并且不需要太多代码的东西。就在那时，我在Google Sheets中发现了一个叫做<code class="fe ki kj kk kl b"><strong class="lr iu">IMPORTHTML</strong>, </code>的便利功能，它非常适合从HTML页面的表格或列表中导入数据。在本文中，我将描述将表格(和列表)提取到google sheets的端到端过程。</p><blockquote class="nd ne nf"><p id="0557" class="lp lq ng lr b ls mm ju lu lv mn jx lx nh na ma mb ni nb me mf nj nc mi mj ln im bi translated">在提取或导入尚未由您管理的数据之前，请确保您拥有必要的权限。此外，这种方法只有在数据公开的情况下才有效，这意味着不应该有授权等要求。</p></blockquote></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="2943" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi nr translated">这篇文章是寻找好数据集的完整系列文章的一部分。以下是该系列中包含的所有文章:</p><p id="8cf4" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第1部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/getting-datasets-for-data-analysis-tasks-advanced-google-search-b1c01f9cc324">为数据分析任务获取数据集—高级谷歌搜索</a></p><p id="2a7f" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第二部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/useful-sites-for-finding-datasets-for-data-analysis-tasks-1edb8f26c34d">为数据分析任务寻找数据集的有用站点</a></p><p id="74da" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第3部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/creating-custom-image-datasets-for-deep-learning-projects-6e5db76158d4">为深度学习项目创建定制图像数据集</a></p><p id="5fdb" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第4部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/import-html-tables-into-google-sheets-effortlessly-f471eae58ac9">毫不费力地将HTML表格导入Google Sheets</a></p><p id="b44d" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第5部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/extracting-tabular-data-from-pdfs-made-easy-with-camelot-80c13967cc88">使用Camelot，从pdf中提取表格数据变得很容易。</a></p><p id="7bd6" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第六部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/extracting-information-from-xml-files-into-a-pandas-dataframe-11f32883ce45">从XML文件中提取信息到熊猫数据框架</a></p><p id="005f" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated"><strong class="lr iu">第7部分</strong> : <a class="ae lc" rel="noopener" target="_blank" href="/5-real-world-datasets-for-exploratory-data-analysis-21b7cc5afe7e"> 5个真实世界数据集，用于磨练您的探索性数据分析技能</a></p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="72b9" class="oa ob it bd oc od oe of og oh oi oj ok jz ol ka om kc on kd oo kf op kg oq or bi translated">句法</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi os"><img src="../Images/e619db4d4f249a7ba85205dcf1318229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pzJnRCQyuXLpN-9BvyiWg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="f713" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">在使用函数之前，我们先快速了解一下<code class="fe ki kj kk kl b">IMPORTHTML</code>函数的语法。<code class="fe ki kj kk kl b">IMPORTHTML</code>函数接受三个不同的参数，编写如下:</p><pre class="kn ko kp kq gt ot kl ou ov aw ow bi"><span id="15c9" class="ox ob it kl b gy oy oz l pa pb">IMPORTHTML(<strong class="kl iu">URL</strong>, query, index)</span></pre><h2 id="dae6" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">因素</h2><ul class=""><li id="5c75" class="mk ml it lr b ls pn lv po ly pp mc pq mg pr ln mr ms mt mu bi translated"><strong class="lr iu"> URL </strong>:指表格所在页面的URL。不要忘记添加协议(例如<a class="ae lc" rel="noopener ugc nofollow" target="_blank" href="/)."> http://) </a>，并确保URL在引号内。</li><li id="313b" class="mk ml it lr b ls mv lv mw ly mx mc my mg mz ln mr ms mt mu bi translated"><strong class="lr iu">查询</strong>:查询可以是表格，也可以是项目列表。例如，如果您想要导入一个表，请在引号中提到<strong class="lr iu">表</strong>，否则请提到一个<strong class="lr iu">列表</strong>。</li><li id="9861" class="mk ml it lr b ls mv lv mw ly mx mc my mg mz ln mr ms mt mu bi translated"><strong class="lr iu">索引:</strong>指表格在网页上的位置，从1开始。</li></ul></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="559b" class="oa ob it bd oc od oe of og oh oi oj ok jz ol ka om kc on kd oo kf op kg oq or bi translated">用法:导入表格</h1><p id="240e" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">现在让我们看看如何快速无缝地将维基百科文章中引用的HTML表格导入到Google sheet中。页面标题为:<a class="ae lc" href="https://en.wikipedia.org/wiki/List_of_Netflix_original_films" rel="noopener ugc nofollow" target="_blank"> <strong class="lr iu">网飞原创电影列表</strong> </a> <strong class="lr iu"> </strong>，包含美国全球点播互联网流媒体提供商<a class="ae lc" href="https://en.wikipedia.org/wiki/Netflix" rel="noopener ugc nofollow" target="_blank"/><strong class="lr iu"/>发行的各类电影和节目信息。</p><h2 id="5107" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">第一步:复制网址</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pv"><img src="../Images/56895853dfd9978afa67f16adeb6d74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQZE__EjQzjrprtSuOuPOg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图片来源:<a class="ae lc" href="https://en.wikipedia.org/wiki/List_of_Netflix_original_films" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><h2 id="42f8" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">第2步:选择要导入的表</h2><p id="bdd1" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">假设我们想要导入所有的故事片，这是页面上的第一个表。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pw"><img src="../Images/0305de545fe9187c9d9492bce0e852a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ElkITHNn75SG9mmpBMvaw.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图片来源:<a class="ae lc" href="https://en.wikipedia.org/wiki/List_of_Netflix_original_films" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><h2 id="6622" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">第三步:在谷歌表单中添加公式</h2><p id="ecad" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">创建一个新的Google工作表，或者在现有的工作表中创建一个新的标签。在指定URL、查询和索引号的单元格中输入以下公式。</p><pre class="kn ko kp kq gt ot kl ou ov aw ow bi"><span id="fc46" class="ox ob it kl b gy oy oz l pa pb"><em class="ng">=IMPORTHTML("https://en.wikipedia.org/wiki/List_of_Netflix_original_films_(2012%E2%80%932019)","table",1)</em></span></pre><p id="78ea" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">瞧啊。整个表格被提取并填充到电子表格中。以下是你在谷歌表单中看到的内容:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi px"><img src="../Images/dd90c1edd55686095c98db0662d11438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4cn55T7vbdyJXE242zkutg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="be38" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">让我们结合以上三个步骤，看看下面的端到端演示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi py"><img src="../Images/7008fead112cfe056644624407588b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*L2-gH16m0WZ3FUZ4ft8Nig.gif"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="eed0" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">您可以用同样的方式导入列表。唯一的变化是用函数参数中的列表替换单词table。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="9621" class="oa ob it bd oc od oe of og oh oi oj ok jz ol ka om kc on kd oo kf op kg oq or bi translated">定制输出:使用查询功能</h1><p id="5d0f" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">您可以做很多事情来定制导入的数据。这可以通过结合使用<code class="fe ki kj kk kl b"><a class="ae lc" href="https://support.google.com/docs/answer/3093343?hl=en-GB" rel="noopener ugc nofollow" target="_blank"><strong class="lr iu">Query</strong> </a></code>函数和<code class="fe ki kj kk kl b">IMPORTHTML.</code>函数来实现。<code class="fe ki kj kk kl b"><strong class="lr iu">Query</strong></code>函数跨数据运行谷歌可视化API查询。让我们来看看实现这一点的一些方法:</p><h2 id="036f" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">限制导入列的数量</h2><p id="a193" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">假设您不想导入所有的列，而是选择几列。您可以传递所需列的索引。例如，如果我们只需要前三列，我们的函数如下:</p><pre class="kn ko kp kq gt ot kl ou ov aw ow bi"><span id="762e" class="ox ob it kl b gy oy oz l pa pb">=query(IMPORTHTML("https://en.wikipedia.org/wiki/List_of_Netflix_original_films","table",1),"Select Col1,Col2,Col3")</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pz"><img src="../Images/f10f96d5b017d5da020ef097478f948e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Doi6InzyD2u4OP6uhuDKAQ.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="b79d" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">看看我们是如何用<code class="fe ki kj kk kl b">query</code>函数包围<code class="fe ki kj kk kl b">IMPORTHTML</code>函数并指定列索引的。</p><h2 id="489c" class="ox ob it bd oc pc pd dn og pe pf dp ok ly pg ph om mc pi pj oo mg pk pl oq pm bi translated">基于列筛选数据</h2><p id="28d3" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">另一种情况是当我们想要一些特定的数据时，即只关于喜剧类型的数据。这可以很容易地做到，如下所示:</p><pre class="kn ko kp kq gt ot kl ou ov aw ow bi"><span id="3507" class="ox ob it kl b gy oy oz l pa pb">=query(IMPORTHTML("https://en.wikipedia.org/wiki/List_of_Netflix_original_films","table",1),"Select * where Col2='Comedy'")</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi qa"><img src="../Images/f58c0b2834e8ea5a647706f5176a2c1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktWxAc51Ju2Lb7JQNmBqgw.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">作者图片</p></figure><p id="4327" class="pw-post-body-paragraph lp lq it lr b ls mm ju lu lv mn jx lx ly na ma mb mc nb me mf mg nc mi mj ln im bi translated">查看<code class="fe ki kj kk kl b">QUERY</code>功能的官方文档，了解使用它的其他方法。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="93b5" class="oa ob it bd oc od oe of og oh oi oj ok jz ol ka om kc on kd oo kf op kg oq or bi translated">结论</h1><p id="c4ed" class="pw-post-body-paragraph lp lq it lr b ls pn ju lu lv po jx lx ly ps ma mb mc pt me mf mg pu mi mj ln im bi translated">在本文中，我们看到了<code class="fe ki kj kk kl b">IMPORTHTML</code>函数的强大功能，以及如何使用它将来自网站、博客和其他HTML源的表格和列表直接导入google电子表格。从那里，您可以对数据集执行几个分析任务，并从中获取有意义的信息。您还可以提取数据并与他人共享，这样他们也可以利用这些数据。</p></div></div>    
</body>
</html>