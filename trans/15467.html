<html>
<head>
<title>Natural Language Processing for Loan Risk</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贷款风险的自然语言处理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/loan-risk-nlp-d98021613ff3?source=collection_archive---------22-----------------------#2020-10-24">https://towardsdatascience.com/loan-risk-nlp-d98021613ff3?source=collection_archive---------22-----------------------#2020-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2c33" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">向Keras模型添加空间单词向量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/263dd60538ce25fc4b426097071520ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4GFj11cnF1oNwoceJ1NLQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@aaronburden" rel="noopener ugc nofollow" target="_blank">亚伦·伯顿</a>在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><ol class=""><li id="cd3a" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated"><a class="ae kv" href="#bae0" rel="noopener ugc nofollow"> <strong class="ky ir">故事至此</strong> </a></li><li id="1c9c" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#6f29" rel="noopener ugc nofollow"> <strong class="ky ir">探索性数据分析</strong> </a></li><li id="597d" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#f826" rel="noopener ugc nofollow"> <strong class="ky ir">输入缺失值</strong> </a></li><li id="d073" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#d61a" rel="noopener ugc nofollow"> <strong class="ky ir">优化数据类型</strong> </a></li><li id="502f" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#5c1c" rel="noopener ugc nofollow"> <strong class="ky ir">创建文档向量</strong> </a></li><li id="852c" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#bb56" rel="noopener ugc nofollow"> <strong class="ky ir">建筑管道</strong> </a></li><li id="4bfb" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#83b3" rel="noopener ugc nofollow"> <strong class="ky ir">评估模型</strong> </a></li><li id="abb2" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj lk ll lm ln bi translated"><a class="ae kv" href="#149e" rel="noopener ugc nofollow"> <strong class="ky ir">下一步</strong> </a></li></ol><h1 id="bae0" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">故事到此为止</h1><p id="2d3f" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">几个月前，我<a class="ae kv" rel="noopener" target="_blank" href="/loan-risk-neural-network-30c8f65f052e">建立了一个神经网络回归模型</a>来预测贷款风险，用来自<a class="ae kv" href="https://www.lendingclub.com/" rel="noopener ugc nofollow" target="_blank"> LendingClub </a>的<a class="ae kv" href="https://www.kaggle.com/wordsforthewise/lending-club" rel="noopener ugc nofollow" target="_blank">公共数据集</a>对其进行训练。然后我用<a class="ae kv" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a>构建了一个<a class="ae kv" href="https://tywmick.pythonanywhere.com/" rel="noopener ugc nofollow" target="_blank">公共API </a>来服务模型的预测。</p><p id="4ce9" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">然后上个月，我决定测试我的模型，发现我的模型可以比LendingClub 更好地挑选A级贷款！</p><p id="a1fc" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">但我还没说完。既然我已经学习了自然语言处理的基础知识(我强烈推荐<a class="ae kv" href="https://www.kaggle.com/learn/natural-language-processing" rel="noopener ugc nofollow" target="_blank"> Kaggle关于这个主题的课程</a>，我将看看我是否可以使用数据集中的两个自由形式的文本字段:<code class="fe nd ne nf ng b">title</code>和<code class="fe nd ne nf ng b">desc</code>(描述)来增加一点预测能力。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="df47" class="nn lu iq ng b gy no np l nq nr">This dataset includes 1,110,171 loans.</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="bdd3" class="nn lu iq ng b gy no np l nq nr">5 rows × 69 columns</span></pre><p id="71ef" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">这篇文章和之前的文章一样，改编自一个Jupyter笔记本，所以如果你想继续的话，可以随意把我的笔记本放到<a class="ae kv" href="https://www.kaggle.com/tywmick/natural-language-processing-for-loan-risk" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>或<a class="ae kv" href="https://github.com/tywmick/loan-risk-neural-network/blob/master/models/loan-risk-nlp.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上。</p><h1 id="6f29" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">探索性数据分析</h1><p id="0bc8" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">在我的第一篇帖子中彻底清理了数据后，没有太多的探索性数据分析要做，但是在我继续之前，我确实有几个关于字段的问题要回答。</p><ul class=""><li id="192d" class="kw kx iq ky b kz la lb lc ld le lf lg lh li lj nt ll lm ln bi translated">每个字段使用多少贷款？</li><li id="c3c2" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj nt ll lm ln bi translated">贷款申请中是否一直包含这些字段？</li><li id="2eb2" class="kw kx iq ky b kz lo lb lp ld lq lf lr lh ls lj nt ll lm ln bi translated">每个字段的典型长度是多少(字数)？</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f0d5" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">如果最常见的<code class="fe nd ne nf ng b">desc</code>值是空的(或者可能只是空白)，也许我需要在继续之前将所有空的或者只有空白的值转换成<code class="fe nd ne nf ng b">NaN</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="9584" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">谢天谢地，这并没有减少太多的价值，但这个“借款人在[日期]添加”的交易现在让我担心。我过会儿会处理那个。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="8fdf" class="nn lu iq ng b gy no np l nq nr">`title` is used in 98% of loans in the dataset.<br/>`desc` is used in 6% of loans in the dataset.<br/>The title "Debt consolidation" is used in 51% of loans.</span></pre><p id="abff" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">这些字段可能没有我之前想的那么有用。尽管整个数据集中使用了35，860种独特的图书，但其中51%只使用了“债务合并”。可能另外49%里标题更有描述性？</p><p id="27d3" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">而<code class="fe nd ne nf ng b">desc</code>字段仅用于6%的贷款。</p><p id="21b2" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">现在检查并查看这些字段是何时引入的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="9f0b" class="nn lu iq ng b gy no np l nq nr">Total date range:<br/>min   2012-08-01<br/>max   2018-12-01<br/>Name: issue_d, dtype: datetime64[ns]</span><span id="dfbc" class="nn lu iq ng b gy nu np l nq nr">`title` date range:<br/>min   2012-08-01<br/>max   2018-12-01<br/>Name: issue_d, dtype: datetime64[ns]</span><span id="42ef" class="nn lu iq ng b gy nu np l nq nr">`desc` date range:<br/>min   2012-08-01<br/>max   2016-07-01<br/>Name: issue_d, dtype: datetime64[ns]</span></pre><p id="bb74" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">这两个字段都不是最近才引入的，但是它们可能在数据库的最后两年已经停止使用<code class="fe nd ne nf ng b">desc</code>字段了。</p><p id="b9b4" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">现在，我将进一步了解这些字段中的值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="874d" class="nn lu iq ng b gy no np l nq nr">Debt consolidation                       573992<br/>Credit card refinancing                  214423<br/>Home improvement                          64028<br/>Other                                     56166<br/>Major purchase                            20734<br/>Medical expenses                          11454<br/>Debt Consolidation                        10638<br/>Business                                  10142<br/>Car financing                              9660<br/>Moving and relocation                      6806<br/>Vacation                                   6707<br/>Home buying                                5097<br/>Consolidation                              4069<br/>debt consolidation                         3310<br/>Credit Card Consolidation                  1607<br/>consolidation                              1538<br/>Debt Consolidation Loan                    1265<br/>Consolidation Loan                         1260<br/>Personal Loan                              1040<br/>Credit Card Refinance                      1020<br/>Home Improvement                           1016<br/>Credit Card Payoff                          991<br/>Consolidate                                 947<br/>Green loan                                  626<br/>Loan                                        621<br/>                                          ...<br/>House Buying Consolidation                    1<br/>Credit Card Deby                              1<br/>Crdit cards                                   1<br/>"CCC"                                         1<br/>Loan to Moving &amp; Relocation Expense           1<br/>BILL PAYMENT                                  1<br/>creit card pay off                            1<br/>Auto Repair &amp; Debt Consolidation              1<br/>BMW 2004                                      1<br/>Moving Expenses - STL to PHX                  1<br/> Pay off Bills                                1<br/>Room addition                                 1<br/>Optimistic                                    1<br/>Consolid_loan2                                1<br/>ASSISTANCE NEEDED                             1<br/>My bail out                                   1<br/>myfirstloan                                    1<br/>second home                                   1<br/>Just consolidating credit cards               1<br/>Financially Sound Loan                        1<br/>refinance loans and home improvements          1<br/>credit cart refincition                        1<br/>Managable Repayment Plan                      1<br/>ccdebit                                       1<br/>Project Pay Off Debt                          1<br/>Name: title, Length: 35863, dtype: int64</span></pre><p id="5420" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">有意思。在另外49%的地区，似乎有很多不同的贷款名称。它们中的许多似乎直接对应于<code class="fe nd ne nf ng b">purpose</code>分类字段，但我认为没有多到使这个字段无用。</p><p id="7e3b" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">附注:在阅读本专栏时，我发现有人输入了<a class="ae kv" href="https://en.wikipedia.org/wiki/Konami_Code" rel="noopener ugc nofollow" target="_blank"> Konami代码</a>作为他们贷款申请的标题，他们被包含在这个数据集中意味着代码显然为他们工作——他们得到了贷款。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="5d62" class="nn lu iq ng b gy no np l nq nr">Borrower added on 03/17/14 &gt; Debt consolidation&lt;br&gt;                                                                                                                                                                                                                                        9<br/>  Borrower added on 01/15/14 &gt; Debt consolidation&lt;br&gt;                                                                                                                                                                                                                                        7<br/>  Borrower added on 02/19/14 &gt; Debt consolidation&lt;br&gt;                                                                                                                                                                                                                                        7<br/>  Borrower added on 03/10/14 &gt; Debt consolidation&lt;br&gt;                                                                                                                                                                                                                                        7<br/>  Borrower added on 01/29/14 &gt; Debt consolidation&lt;br&gt;                                                                                                                                                                                                                                        7<br/>                                                                                                                                                                                                                                                                                            ..<br/>  Borrower added on 01/14/13 &gt; Credit Card consolidation&lt;br&gt;                                                                                                                                                                                                                                 1<br/>  Borrower added on 03/14/14 &gt; Debts consolidation and cash for minor improvements on condominium&lt;br&gt;                                                                                                                                                                                        1<br/>  Borrower added on 03/02/14 &gt; I lost a house and need to pay taxes nd have credit card debt thatI already pay $350 a month on and it goes nowhere.&lt;br&gt;                                                                                                                                      1<br/>  Borrower added on 04/09/13 &gt; I want to put in a conscious effort in eliminating my debt by converting high interest cards to a fixed payment that can be effectively managed by me.&lt;br&gt;                                                                                                    1<br/>  Borrower added on 09/18/12 &gt; Want to become debt free, because of several circumstances and going back to school I got into debt. I want to pay for what I have purchased without it having an effect on my credit. That is why I want to consolidate my debt and become debt free!&lt;br&gt;    1<br/>Name: desc, Length: 70925, dtype: int64</span></pre><p id="4c49" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">所有这些描述都是以“借款人于[日期]添加”开头吗？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="6f4f" class="nn lu iq ng b gy no np l nq nr">71,858 loan descriptions begin with that pattern. (85 do not.)</span></pre><p id="f636" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">现在我需要检查其他85个。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="0093" class="nn lu iq ng b gy no np l nq nr">Debt Consolidation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 2<br/>I would like to pay off 3 different credit cards, at 12%, 17% and 22% (after initial 0% period is up).  It would be great to have everything under one loan, making it easier to pay off.  Also, once I've paid off or down the loan, I can start looking into buying a house.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     1<br/>loan will be used for paying off credit card.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1<br/>This loan will be used to consolidate high interest credit card debt.    Over the course of this past year my wife and I had our first child, purchase a home and received a large bonus from work.  With the new home and the child on the way I chose to spread my tax withholdings on the bonus to all checks received in 2008 this caused my monthly income to fall by $1500.  This in combination with an unexpected additional down payment for our home of $17,000 with only a weeks notice we were force to dip into our Credit Cards for the past several months.    Starting January 1, 2009 I will be able to readjust my tax withholding and start to pay off the Credit Card debt we have racked up.  This loan will help lower the interest rate during the repayment period and give one central place for payment.  My wife and I have not missed a payment or been late for the past 5 years.  My fico score is 670 mainly due to several low limit credit cards near their max.  I manage the international devision of a software company and my wife is a kindergarten teacher, combined we make 140K a year.    Thank you for your consideration and I look forward to working with you.      1<br/>to pay off different credit cards to consolidate my debt, so I can have just one monthly payment.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  1<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ..<br/>Hello, I would like to consolidate my debt into a lower more convenient payment. I have a very stable career of more than 20 years with the same company. My community is in a part of the country that made it through the last few years basically unscathed and has a very promising future.&lt;br&gt;Thank You&lt;br&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   1<br/>consolidate my debt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1<br/>I am looking to pay off my credit card debts.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1<br/>This loan is to help me payoff my credit card debt. I've done what I can to negotiate lower rates, but the interest is killing me and my monthly payments are basically just taking care of interest. Paying them off will give me the fresh start I need on my way to financial independence. Thank you.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1<br/>I have been in business for a year and want to eliminate some personal debt and use the remainder of the loan to take care of business expenses. Also lessening the number of trade lines I have open puts me in a better position to pursue business loans since it will  be based on my personal credit. A detailed report can be created to show where exactly the funds will go and this can be provided at any time during the course of the loan.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            1<br/>Name: desc, Length: 84, dtype: int64</span></pre><p id="5806" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">看起来借款人可以在不同的时间点向描述中添加信息。我应该检查一下，看看这些日期是否在贷款的实际发放日期之后。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="c37f" class="nn lu iq ng b gy no np l nq nr">2014-01-01 00:00:00 –   Borrower added on 01/08/14 &gt; I am tired of making monthly payments and getting nowhere.  With your help, except for my mortgage, I intend to be completely debt free by 12/31/2016.&lt;br&gt;<br/>2014-01-01 00:00:00 –   Borrower added on 01/08/14 &gt; We have been engaged for  2 1/2yrs and wanted to bring out blended family together as one. We are set to get married on 03/22/14 and we are paying for it on our own. We saved the majority of the budget unfortunately there were a few unexpected cost that we still need help with.&lt;br&gt;<br/>2014-01-01 00:00:00 –   Borrower added on 01/06/14 &gt; I am getting married 04/05/2014 and I want to have a cushion for expenses just in case.&lt;br&gt;<br/>2014-01-01 00:00:00 – BR called in to push payment date to 09/19/14 because of not having the exact amount of funds in their bank account.  Payment was processing. Was able to cancel. It is within grace period.<br/>2014-01-01 00:00:00 –   Borrower added on 01/01/14 &gt; This loan is to consolidate my credit cards debt. I made one year this past  11/28/2013 at my current job. I considered to have job security because I'm a good employee. I make all may credit cards payments on time.&lt;br&gt;<br/>2013-05-01 00:00:00 –   Borrower added on 04/27/13 &gt; My father passed away 05/12/2012 and I had to pay for the funeral.  My mother could not afford it.  He was not ill so I could not have planned it.  I paid with what I had in my savings and the rest I had to pay with my credit cards.  I would like to pay off the CC &amp;amp; pay one monthly payment.&lt;br&gt;&lt;br&gt;  Borrower added on 04/27/13 &gt; My paerents own the house so I do not pay rent.    The utilities, insurance and taxes, etc my mother pays.  She can afford that.  I help when needed.&lt;br&gt;<br/>2013-02-01 00:00:00 –   Borrower added on 02/10/13 &gt; I am getting married in a week (02/17/2013) and have made some large purchases across my credit cards.  I would like to consolidate all of my debt with this low rate loan.&lt;br&gt;&lt;br&gt; Borrower added on 02/10/13 &gt; I will be getting married in a week (02/17/13) and have had to make some large purchases on my CC. I am financially sound otherwise with low debt obligations.&lt;br&gt;<br/>2012-12-01 00:00:00 –   Borrower added on 12/10/12 &gt; Approximately 1 year ago I had a highefficency furnace /AC installed.  The installing Co. used GECRB to get me a loan.  If I payoff the loan within one year, I pay no interest.  The interest rate if not payed by 12/23/2012 is 26.99%.  A 6.62% rate sounds a lot better.&lt;br&gt;<br/>2012-11-01 00:00:00 –   Borrower added on 11/19/12 &gt; Looking to finish off consolidating the rest of my bills and lower my payments on my exsisting loan. Thanks!!!&lt;br&gt;&lt;br&gt;  Borrower added on 11/20/12 &gt; Thanks again for everyone who has invested thus far. With this loan it will give me the ability to have only one payment monthly besides utilities and I will be almost debt free by my wedding date of 12/13/14!! Thanks again everyone!&lt;br&gt;<br/>2012-10-01 00:00:00 –   Borrower added on 10/22/12 &gt; Need money by 10/26/2012 to purchase property on discounted APR.&lt;br&gt;</span></pre><p id="9f56" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">很好，所有在贷款发放月之后的日期都出现了，因为借款人在谈论未来的事件。</p><p id="81d5" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">现在，为了清理这些<code class="fe nd ne nf ng b">desc</code>值，我将删除<code class="fe nd ne nf ng b">Borrower added on [date] &gt;</code>和<code class="fe nd ne nf ng b">&lt;br&gt;</code>，因为它们不会给描述内容增加价值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="f826" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">输入缺失值</h1><p id="85b8" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">由于这一组中只有2%的贷款缺少一个标题，并且由于大多数标题只是简单地复制了贷款的<code class="fe nd ne nf ng b">purpose</code>，我将根据贷款的目的来估算缺少的标题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="0539" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">由于只有6%的贷款使用了描述，我将用一个空字符串来估算缺失的描述。不过，我打算等一会儿再把它作为管道步骤包括进来。</p><h1 id="d61a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">优化数据类型</h1><p id="2502" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">我真的很想直接进入有趣的部分，将这些文本字段转换成文档向量，但是我头几次尝试这样做时遇到了一个问题。向这个1，110，171行的数据帧中手动添加两组300维的向量导致其在内存中的大小飙升，耗尽了Kaggle给我的16GB。</p><p id="0dbd" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">我第一次尝试解决这个问题是优化我的数据类型，这本身仍然不能解决问题，但不管怎样，这是值得采取的一步。</p><p id="b39f" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">删除不再需要的<code class="fe nd ne nf ng b">issue_d</code>列后，数据集包含五种类型的数据:浮点型、整数型、序数型、(无序)分类型和文本型。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="d6b6" class="nn lu iq ng b gy no np l nq nr">Reduced DataFrame size in memory by 69%.</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="5c1c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">创建文档向量</h1><p id="0b06" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated"><em class="ns">现在</em>有趣的部分。将我的<a class="ae kv" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"> spaCy </a>文档向量函数包装在scikit-learn <code class="fe nd ne nf ng b"><a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.FunctionTransformer.html" rel="noopener ugc nofollow" target="_blank">FunctionTransformer</a></code>中被证明是将这个过程保持在内存限制内的秘密。Scikit-learn必须比我使用的任何手动过程都更好地优化(如图)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="bb56" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">建设管道</h1><p id="89a2" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">首先，变压器。我将使用scikit-learn的<code class="fe nd ne nf ng b"><a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html" rel="noopener ugc nofollow" target="_blank">ColumnTransformer</a></code>对不同类型的数据应用不同的转换。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="6fdc" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">这个模型本身将与我之前的<a class="ae kv" href="https://www.kaggle.com/tywmick/building-a-neural-network-to-predict-loan-risk#Building-the-neural-networks" rel="noopener ugc nofollow" target="_blank">模型</a>相同，但是我将使用Keras回调和一个<a class="ae kv" href="https://github.com/tqdm/tqdm" rel="noopener ugc nofollow" target="_blank"> tqdm </a>进度条来使训练日志更加简洁。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="83b3" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">评估模型</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="fb58" class="nn lu iq ng b gy no np l nq nr">/opt/conda/lib/python3.7/site-packages/pandas/core/strings.py:2001: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.<br/>  return func(self, *args, **kwargs)<br/></span><span id="f8d4" class="nn lu iq ng b gy nu np l nq nr">[Pipeline] ....... (step 1 of 3) Processing nlp_imputer, total=   0.4s<br/>[Pipeline] .... (step 2 of 3) Processing nlp_vectorizer, total= 1.2min<br/>[Pipeline] ........ (step 3 of 3) Processing nlp_scaler, total=   8.6s<br/>[ColumnTransformer] ...... (1 of 7) Processing nlp_cols, total= 1.3min<br/>[ColumnTransformer] .... (2 of 7) Processing emp_length, total=   0.2s<br/>[ColumnTransformer] .......... (3 of 7) Processing term, total=   0.3s<br/>[ColumnTransformer]  (4 of 7) Processing home_ownership, total=   0.3s<br/>[ColumnTransformer] ....... (5 of 7) Processing purpose, total=   0.3s<br/>[ColumnTransformer]  (6 of 7) Processing application_type, total=   0.3s<br/>[ColumnTransformer] ..... (7 of 7) Processing remainder, total=   1.3s<br/></span><span id="3bca" class="nn lu iq ng b gy nu np l nq nr">Training model: 100%|██████████| 100/100 [23:41&lt;00:00, 14.22s/epoch]<br/></span><span id="fdd9" class="nn lu iq ng b gy nu np l nq nr">Final metrics: loss: 0.02365 - val_loss: 0.02360</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/4b965b6a7c2e370758a172f44a36edd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/0*yEXqOChqiL_9ndVp.png"/></div></figure><p id="26f0" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">嗯，它没有过度拟合，但这个模型的表现有点<em class="ns">差</em>比我原来的，它已经解决了大约0.0231的损失。我敢打赌,<code class="fe nd ne nf ng b">desc</code>特性正在碍事——在94%的行上跨越300列输入数据的零可能会使模型非常混乱。我将会看到，如果我重复这个过程，同时去掉<code class="fe nd ne nf ng b">desc</code>(使<code class="fe nd ne nf ng b">title</code>向量成为这个模型与我原来的模型相比唯一的新特征)，会发生什么。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kg kh ki kj gt nj ng nk nl aw nm bi"><span id="5ccd" class="nn lu iq ng b gy no np l nq nr">/opt/conda/lib/python3.7/site-packages/pandas/core/strings.py:2001: UserWarning: This pattern has match groups. To actually get the groups, use str.extract.<br/>  return func(self, *args, **kwargs)<br/></span><span id="0e98" class="nn lu iq ng b gy nu np l nq nr">[Pipeline] ....... (step 1 of 3) Processing nlp_imputer, total=   0.1s<br/>[Pipeline] .... (step 2 of 3) Processing nlp_vectorizer, total=  41.3s<br/>[Pipeline] ........ (step 3 of 3) Processing nlp_scaler, total=   4.6s<br/>[ColumnTransformer] ...... (1 of 7) Processing nlp_cols, total=  45.9s<br/>[ColumnTransformer] .... (2 of 7) Processing emp_length, total=   0.2s<br/>[ColumnTransformer] .......... (3 of 7) Processing term, total=   0.3s<br/>[ColumnTransformer]  (4 of 7) Processing home_ownership, total=   0.3s<br/>[ColumnTransformer] ....... (5 of 7) Processing purpose, total=   0.3s<br/>[ColumnTransformer]  (6 of 7) Processing application_type, total=   0.3s<br/>[ColumnTransformer] ..... (7 of 7) Processing remainder, total=   1.1s<br/></span><span id="936f" class="nn lu iq ng b gy nu np l nq nr">Training model: 100%|██████████| 100/100 [22:26&lt;00:00, 13.46s/epoch]<br/></span><span id="f052" class="nn lu iq ng b gy nu np l nq nr">Final metrics: loss: 0.02396 - val_loss: 0.02451</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/59d8c4d2743d4e04e769eacb916da8ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/0*xzJtngrHVS_TUO6r.png"/></div></figure><p id="98ef" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">哇，还是不够好，打不过我原来的模型。为了好玩，我还尝试了额外的跑步，我训练了1000个周期，其他的我把前两个密集层的节点数增加到128和64。我试着把批量减少到64。但是，这些都没有打败我原来的模型。我认为这些文本特征在贷款结果方面没有预测性。有意思。</p><h1 id="149e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">后续步骤</h1><p id="d4a8" class="pw-post-body-paragraph ml mm iq ky b kz mn jr mo lb mp ju mq ld mr ms mt lf mu mv mw lh mx my mz lj ij bi translated">如果增加这两个特征降低了预测能力，那么也许我已经使用的一些其他变量也在做同样的事情。我应该尝试使用scikit-learn的一些<a class="ae kv" href="https://scikit-learn.org/stable/modules/feature_selection.html" rel="noopener ugc nofollow" target="_blank">特征选择方法</a>来减少输入数据的维数。</p><p id="8ebe" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">一种更有效的超参数优化方法也会非常有用。我应该给AutoKeras一个机会。</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="fb34" class="pw-post-body-paragraph ml mm iq ky b kz la jr mo lb lc ju mq ld na ms mt lf nb mv mw lh nc my mz lj ij bi translated">嗯，那很有趣！对如何更好地将语言数据集成到模型中有什么想法吗？请回复——我很想听听他们的意见！</p></div></div>    
</body>
</html>