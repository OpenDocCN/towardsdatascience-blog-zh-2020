<html>
<head>
<title>ANOVA in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的方差分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anova-in-r-4a4a4edc9448?source=collection_archive---------22-----------------------#2020-10-12">https://towardsdatascience.com/anova-in-r-4a4a4edc9448?source=collection_archive---------22-----------------------#2020-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="291f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何在R中执行方差分析(ANOVA)来比较3组或更多组。另请参见如何解释结果和执行事后测试</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e32f207c6eb924d7b97442a26727287a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zKIeQDJCCU6r6fyZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@battlecreekcoffeeroasters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Battlecreek咖啡烘焙师</a>拍摄</p></figure><h1 id="65e5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="0e98" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi mn translated"><span class="l mo mp mq bm mr ms mt mu mv di">NOVA(方差分析)是一种统计测试，用于确定两个或多个总体均值是否不同。换句话说，它用于<strong class="lt iu">比较两个或更多组</strong>，以查看它们是否显著<strong class="lt iu">不同</strong>。</span></p><p id="3bd0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">然而，实际上:</p><ul class=""><li id="3c7c" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">学生t检验</strong> </a>用于比较<strong class="lt iu"> 2组</strong>；</li><li id="241a" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu"> ANOVA </strong>将t检验推广到2组以上，因此用于比较<strong class="lt iu"> 3组或更多组</strong>。</li></ul><p id="dcd8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">注意，ANOVA有几种版本(例如，单向ANOVA、双向ANOVA、混合ANOVA、重复测量ANOVA等。).在本文中，我们只给出最简单的形式——单向ANOVA<strong class="lt iu"/><a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn1" rel="noopener ugc nofollow" target="_blank">1</a>——在本文的剩余部分我们称之为ANOVA。</p><p id="1f72" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">虽然ANOVA是用来对不同组的<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-by-hand/#mean" rel="noopener ugc nofollow" target="_blank">表示</a>进行推断的，但这种方法叫做“分析<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-by-hand/#variance" rel="noopener ugc nofollow" target="_blank"> <em class="np">方差</em> </a>”。之所以这么叫，是因为它比较了“之间”方差(不同组之间的方差)和“内”方差(每组内的方差)。如果组间方差明显大于组内方差，则说明组均值不同。否则，我们无法得出这样或那样的结论。通过取比值(方差之间/方差之内)，然后将该比值与费希尔<a class="ae ky" href="https://www.statsandr.com/blog/a-guide-on-how-to-read-statistical-tables/" rel="noopener ugc nofollow" target="_blank">概率分布</a>中的阈值(基于特定显著性水平的阈值，通常为5%)进行比较，将两个方差相互比较。</p><p id="7d3e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这是关于方差分析方法的足够的理论。在本文的剩余部分，我们将从更实际的角度来讨论它，特别是，我们将涵盖以下几点:</p><ul class=""><li id="858a" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">方差分析的目的、何时使用以及无效/替代假设</li><li id="c33b" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">方差分析的基本假设以及如何检查它们</li><li id="585a" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如何在R中进行方差分析</li><li id="d8d1" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如何解释方差分析的结果</li><li id="32d7" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">理解事后测试的概念并解释结果</li><li id="0d60" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如何可视化方差分析和事后检验的结果</li></ul><h1 id="edb0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据</h1><p id="7741" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">本文的数据是<code class="fe nq nr ns nt b">penguins</code>数据集(众所周知的<code class="fe nq nr ns nt b">iris</code>数据集的替代)，可通过<code class="fe nq nr ns nt b"><a class="ae ky" href="https://github.com/allisonhorst/palmerpenguins" rel="noopener ugc nofollow" target="_blank">{palmerpenguins}</a></code> <a class="ae ky" href="https://github.com/allisonhorst/palmerpenguins" rel="noopener ugc nofollow" target="_blank">包</a>访问:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="75ef" class="ny la it nt b gy nz oa l ob oc"># install.packages("palmerpenguins")<br/>library(palmerpenguins)</span></pre><p id="c1cf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">该数据集包含3个不同物种(阿德利企鹅、下巴颏企鹅和巴布亚企鹅)的344只企鹅的数据。数据集包含8个变量，但我们只关注本文中的鳍肢长度和物种，所以我们只保留这2个变量:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="6ddf" class="ny la it nt b gy nz oa l ob oc">library(tidyverse)</span><span id="019a" class="ny la it nt b gy od oa l ob oc">dat &lt;- penguins %&gt;%<br/>  select(species, flipper_length_mm)</span></pre><p id="b654" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">(如果不熟悉管道操作符(<code class="fe nq nr ns nt b">%&gt;%</code>)，也可以<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/#subset-a-data-frame" rel="noopener ugc nofollow" target="_blank">用<code class="fe nq nr ns nt b">penguins[, c("species", "flipper_length_mm")]</code>选择变量</a>。在关于<a class="ae ky" href="https://statsandr.com/blog/data-manipulation-in-r/" rel="noopener ugc nofollow" target="_blank">数据操作</a>的文章中了解更多选择变量的方法。)</p><p id="ffc5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">下面是一些基本的<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank">描述性统计数据</a>和我们数据集的一个图(用<code class="fe nq nr ns nt b"><a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">{ggplot2}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">包</a>制作)，然后我们继续进行方差分析的目标:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="6814" class="ny la it nt b gy nz oa l ob oc">summary(dat)</span><span id="2ab2" class="ny la it nt b gy od oa l ob oc">##       species    flipper_length_mm<br/>##  Adelie   :152   Min.   :172.0    <br/>##  Chinstrap: 68   1st Qu.:190.0    <br/>##  Gentoo   :124   Median :197.0    <br/>##                  Mean   :200.9    <br/>##                  3rd Qu.:213.0    <br/>##                  Max.   :231.0    <br/>##                  NA's   :2</span></pre><p id="957c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">鳍状肢的长度从172毫米到231毫米不等，平均长度为200.9毫米。阿德利企鹅、下颚带企鹅和巴布亚企鹅分别有152只、68只和124只。</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="f3ca" class="ny la it nt b gy nz oa l ob oc">library(ggplot2)</span><span id="c310" class="ny la it nt b gy od oa l ob oc">ggplot(dat) +<br/>  aes(x = species, y = flipper_length_mm, color = species) +<br/>  geom_jitter() +<br/>  theme(legend.position = "none")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/b71624688850abeaa36f2597385e7391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PPxiVdzhHGBjxFI0.png"/></div></div></figure><p id="8ff0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这里，<a class="ae ky" href="https://www.statsandr.com/blog/data-types-in-r/#factor" rel="noopener ugc nofollow" target="_blank">因子</a>是<code class="fe nq nr ns nt b">species</code>变量，包含3个模态或组(Adelie、Chinstrap和Gentoo)。</p><h1 id="9e20" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方差分析的目的和假设</h1><p id="a805" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如引言中所述，ANOVA用于比较各组(实际上是3组或更多组)。更一般地说，它用于:</p><ul class=""><li id="6b16" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">研究<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">分类</a>变量的不同模态(在方差分析中也称为水平或处理)的测量值是否相似</li><li id="b1e2" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">比较分类变量的不同水平对<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#quantitative" rel="noopener ugc nofollow" target="_blank">定量</a>变量的影响</li><li id="41e4" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">根据定性变量解释定量变量</li></ul><p id="0d62" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在这种情况下，作为一个例子，我们将使用方差分析来帮助我们回答这个问题:“<strong class="lt iu">三种企鹅的鳍状肢长度不同吗？</strong>”。</p><p id="47c7" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">方差分析的无效假设和替代假设是:</p><ul class=""><li id="a1af" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">H0:μ_ Adelie =μ_ Chinstrap =μ_ Gentoo(三个物种的鳍状肢长度相等)</li><li id="f876" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">H1: <em class="np">至少有一个平均值是不同的(至少有一个物种与其他两个物种的鳍长度不同)</em></li></ul><p id="bf79" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">注意另一个假设是<strong class="lt iu"> <em class="np">而不是</em> </strong>所有的方法都不同。所有平均数相等的反面(H0)是至少有一个平均数不同于其他平均数(H1)。在这个意义上，如果零假设被拒绝，这意味着至少有一个物种不同于其他2，但不一定是所有3个物种彼此不同。可能阿德利物种的鳍状肢长度不同于下颚带和巴布亚，但是下颚带和巴布亚的鳍状肢长度相似。必须执行其他类型的测试(称为事后测试，包含在本<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#post-hoc-test" rel="noopener ugc nofollow" target="_blank">部分</a>中)来测试所有3个物种是否不同。</p><h1 id="73c1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方差分析的基本假设</h1><p id="2e5a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">至于许多<a class="ae ky" href="https://www.statsandr.com/tags/inferential-statistics/" rel="noopener ugc nofollow" target="_blank">统计测试</a>，为了能够解释结果，需要满足一些假设。当一个或几个假设不满足时，尽管技术上可以进行这些测试，但解释结果和相信结论是不正确的。</p><p id="6ea2" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">下面是方差分析的假设，如何测试它们，以及如果假设不满足，还有哪些测试:</p><ul class=""><li id="7448" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated"><strong class="lt iu">变量类型</strong> : ANOVA需要混合一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#continuous" rel="noopener ugc nofollow" target="_blank">连续定量</a>因变量(对应于与问题相关的测量)和一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">定性</a>自变量(至少有2个水平，用于确定要比较的组)。</li><li id="f8dc" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">独立性</strong>:从总<a class="ae ky" href="https://www.statsandr.com/blog/what-is-the-difference-between-population-and-sample/" rel="noopener ugc nofollow" target="_blank">人口</a>中随机选择的代表性部分收集的数据，在组间和组内应该是独立的。独立性的假设通常基于实验的设计和对实验条件的良好控制来验证，而不是通过正式的测试。如果你仍然不确定基于实验设计的独立性，问问自己一个观察是否与每个组内或组间的另一个观察相关(如果一个观察对另一个有影响)。如果没有，很可能你有独立的<a class="ae ky" href="https://www.statsandr.com/blog/what-is-the-difference-between-population-and-sample/" rel="noopener ugc nofollow" target="_blank">样本</a>。如果样本之间的观察值(形成待比较的不同组)是相关的(例如，如果三个测量值是在<strong class="lt iu">相同的个体</strong>上收集的，这是医学研究中在测量(I)治疗前、(ii)治疗期间和(iii)治疗后的指标时经常出现的情况)，那么重复测量值ANOVA应该是首选的，以便考虑样本之间的相关性。</li><li id="8ca8" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">正态</strong>:残差<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn2" rel="noopener ugc nofollow" target="_blank"> 2 </a>应该近似遵循一个<a class="ae ky" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu">正态分布</strong> </a>。正态性假设可以通过<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#histogram" rel="noopener ugc nofollow" target="_blank">直方图</a>和<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#qq-plot" rel="noopener ugc nofollow" target="_blank"> QQ图</a>进行直观测试，和/或通过<a class="ae ky" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#normality-test" rel="noopener ugc nofollow" target="_blank">正态性测试</a>进行正式测试，如夏皮罗-维尔克或科尔莫戈罗夫-斯米尔诺夫测试。如果，即使在对数据进行变换(例如，对数变换、平方根、Box-Cox等)后，)，残差仍然不符合近似正态分布，可以应用Kruskal-Wallis检验(R中的<code class="fe nq nr ns nt b">kruskal.test(variable ~ group, data = dat</code>)。这种非参数检验对非正态分布稳健，与ANOVA的目标相同—比较3个或更多组—但它使用样本中位数而不是样本均值来比较组。</li><li id="b716" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><strong class="lt iu">方差相等</strong>:不同组的方差在总体中应该相等(这种假设被称为方差的同质性，或者有时被称为同方差，与方差在不同组之间不相等的异方差相对)。这种假设可以通过图形测试(例如通过比较<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#boxplot" rel="noopener ugc nofollow" target="_blank">箱线图</a>或<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#dotplot" rel="noopener ugc nofollow" target="_blank">点线图</a>中的离散度)，或者更正式地通过Levene测试(<code class="fe nq nr ns nt b">{car}</code>包中的<code class="fe nq nr ns nt b">leveneTest(variable ~ group)</code>)或Bartlett测试，等等。如果等方差假设被拒绝，可以使用ANOVA的另一个版本:Welch检验(<code class="fe nq nr ns nt b">oneway.test(variable ~ group, var.equal = FALSE)</code>)。请注意，韦尔奇检验不要求方差齐性，但分布仍应近似遵循正态分布。请注意，Kruskal-Wallis检验既不需要正态假设，也不需要方差的同方差假设。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn3" rel="noopener ugc nofollow" target="_blank"> 3 </a></li></ul><p id="bac5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据假设是否满足来选择合适的测试可能会令人困惑，因此这里有一个简短的总结:</p><ol class=""><li id="0eef" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">检查你的观察是否独立。</li><li id="8910" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">如果它们是独立的，检验残差的正态性:</li></ol><ul class=""><li id="9908" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">如果假设正态性，检验方差的同质性:</li><li id="cfdb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如果差异相等，使用<strong class="lt iu"> ANOVA </strong>。</li><li id="afe5" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如果差异不相等，使用<strong class="lt iu">韦尔奇测试</strong>。</li><li id="5cd8" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">如果没有假设正态性，使用<strong class="lt iu">克鲁斯卡尔-沃利斯检验</strong>。</li></ul><p id="f646" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">既然我们已经看到了方差分析的基本假设，我们在应用适当版本的测试之前，专门为我们的数据集回顾它们。</p><h1 id="87ff" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">可变类型</h1><p id="930a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">因变量<code class="fe nq nr ns nt b">flipper_length_mm</code>是一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#quantitative" rel="noopener ugc nofollow" target="_blank">定量</a>变量，自变量<code class="fe nq nr ns nt b">species</code>是一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">定性</a>变量(3个等级对应3个物种)。所以我们有两种变量的混合，这个假设是成立的。</p><h1 id="f06c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">独立性ˌ自立性</h1><p id="fe22" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设观察值是独立的，因为数据是从人群中随机选择的部分收集的，并且3个样本内部和之间的测量值是不相关的。</p><p id="5481" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">独立性假设通常是基于实验设计和对实验条件的良好控制来验证的，就像这里的情况一样。如果你真的想更正式地测试它，你可以通过一个统计测试来测试它——Durbin-Watson测试(在R: <code class="fe nq nr ns nt b">durbinWatsonTest(res_lm)</code>中，其中<code class="fe nq nr ns nt b">res_lm</code>是一个线性模型)。该检验的零假设指定自相关系数= 0，而替代假设指定自相关系数≠ 0。</p><h1 id="6741" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">常态</h1><p id="2554" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">请记住，残差的<a class="ae ky" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank">正态性</a>可以通过<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#histogram" rel="noopener ugc nofollow" target="_blank">直方图</a>和<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#qq-plot" rel="noopener ugc nofollow" target="_blank"> QQ图</a>进行直观测试，和/或通过<a class="ae ky" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/#normality-test" rel="noopener ugc nofollow" target="_blank">正态性测试</a>(例如夏皮罗-维尔克测试)进行正式测试。</p><p id="50fb" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在检查正态性假设之前，我们首先需要计算方差分析(在<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#anova-in-r" rel="noopener ugc nofollow" target="_blank">部分</a>中有更多相关信息)。然后我们将结果保存在<code class="fe nq nr ns nt b">res_aov</code>:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="f654" class="ny la it nt b gy nz oa l ob oc">res_aov &lt;- aov(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span></pre><p id="419a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们现在可以直观地检查正常性:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="ee18" class="ny la it nt b gy nz oa l ob oc">par(mfrow = c(1, 2)) # combine plots</span><span id="cae0" class="ny la it nt b gy od oa l ob oc"># histogram<br/>hist(res_aov$residuals)</span><span id="929b" class="ny la it nt b gy od oa l ob oc"># QQ-plot<br/>library(car)<br/>qqPlot(res_aov$residuals,<br/>  id = FALSE # id = FALSE to remove point identification<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/4efee687c76f7207235dab0dc37587f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BRuxT64X1TKfFwjW.png"/></div></div></figure><p id="bd05" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从上面的直方图和QQ-plot，我们已经可以看到，正态性假设似乎得到了满足。事实上，直方图大致形成一条钟形曲线，表明残差遵循正态分布。此外，QQ图中的点大致遵循直线，并且它们中的大多数都在置信带内，这也表明残差近似遵循正态分布。</p><p id="4665" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">一些研究人员就此打住，假设满足正态性，而其他人也通过正式的统计测试来检验这一假设。您可以选择(I)仅通过目测，(ii)仅通过正态性测试，或(iii)同时通过目测和正态性测试进行测试。但是，请记住以下两点:</p><ol class=""><li id="001b" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">方差分析对偏离正态分布的小偏差非常稳健。这意味着如果少量的点稍微偏离正态性(从ANOVA结果解释的角度来看),</li><li id="e60c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">正态性检验有时相当保守，这意味着正态性的零假设可能会由于与正态性的有限偏离而被拒绝。对于大样本来说尤其如此，因为测试的功效随着样本量的增加而增加。</li></ol><p id="027d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">实际上，我倾向于只选择(I)视觉方法，但是，这是一个个人选择的问题，也取决于分析的背景。</p><p id="3a56" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">还是为了说明，我们现在也通过正态性检验来检验正态性假设。你可以使用夏皮罗-维尔克检验或者科尔莫戈罗夫-斯米尔诺夫检验等等。请记住，无效假设和替代假设是:</p><ul class=""><li id="1c2a" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">H0:数据来自正态分布</li><li id="f294" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">H1:数据做<strong class="lt iu"> <em class="np">不是</em> </strong>来自正态分布</li></ul><p id="64a8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在R中，借助于<code class="fe nq nr ns nt b">shapiro.test()</code>函数，我们可以用夏皮罗-维尔克检验来检验残差的正态性:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="6939" class="ny la it nt b gy nz oa l ob oc">shapiro.test(res_aov$residuals)</span><span id="788c" class="ny la it nt b gy od oa l ob oc">## <br/>##  Shapiro-Wilk normality test<br/>## <br/>## data:  res_aov$residuals<br/>## W = 0.99452, p-value = 0.2609</span></pre><p id="b205" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="np">P</em>-残差的夏皮罗-维尔克检验值大于通常的显著性水平α=5%，所以我们不拒绝残差服从正态分布的假设(<em class="np">P</em>-值= 0.261)。</p><p id="201b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这个结果符合目测法。在我们的例子中，正态假设在视觉上和形式上都得到了满足。</p><p id="b01b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="np">边注:提醒p值是假设零假设为真，我们在样本中观察到的极端情况的概率</em><a class="ae ky" href="https://www.statsandr.com/blog/the-9-concepts-and-formulas-in-probability-that-every-data-scientist-should-know/" rel="noopener ugc nofollow" target="_blank"><em class="np"/></a><em class="np">。如果p值</em> &lt; α <em class="np">(表示假设原假设为真，不太可能观察到我们在样本中拥有的数据)，则拒绝原假设，否则不拒绝原假设。查看更多关于</em> <a class="ae ky" href="https://www.statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/#a-note-on-p-value-and-significance-level-alpha" rel="noopener ugc nofollow" target="_blank"> <em class="np"> p值和显著性水平</em> </a> <em class="np">如果你对那些重要的统计学概念不熟悉。</em></p><p id="a82d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请记住，如果没有达到正态假设，则需要对原始数据进行一些变换，希望残差能够更好地符合正态分布，或者您需要使用ANOVA的非参数版本—Kruskal-Wallis检验。</p><p id="fec0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">正如一位读者所指出的(见文章最后的评论)，正态性假设也可以在“原始”数据(即观察值)而不是残差上进行检验。但是，如果您测试原始数据的正态性假设，则必须单独测试<em class="np">每组数据</em>，因为方差分析需要<em class="np">每组数据</em>的正态性。</p><p id="1b7e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">对所有残差或每组观察值进行正态性检验是等效的，并且会给出相似的结果。的确，说“每组内Y的分布是正态分布”和说“残差是正态分布”是一样的。</p><p id="a559" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请记住，残差是Y的实际值与特定X值的Y平均值之间的距离，因此在计算残差时会引入分组变量。</p><p id="649c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">总之，在方差分析中，你实际上有两个检验正态性的选择:</p><ol class=""><li id="84f7" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">分别检查每组“原始”数据(Y值)的正态性</li><li id="9120" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">检查所有残差的正态性(但不是每个组)</li></ol><p id="b373" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在实践中，您会发现，只使用残差并一起检查它们通常会更容易，尤其是当您有许多组或每组的观察值很少时。</p><p id="a973" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如果你仍然不相信:记住方差分析是线性模型的一个特例。假设你的自变量是一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#continuous" rel="noopener ugc nofollow" target="_blank">连续变量</a>(而不是一个<a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">分类变量</a>)，你剩下的唯一选择就是检查残差的正态性，这正是在线性回归模型中检验正态性所做的。</p><h1 id="6ec7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方差相等—同质性</h1><p id="ab38" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设残差服从正态分布，现在是时候检查物种之间的方差是否相等了。结果将会影响我们是否使用方差分析或韦尔奇检验。</p><p id="4c93" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这可以再次通过视觉验证——通过<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#boxplot" rel="noopener ugc nofollow" target="_blank">箱线图</a>或<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#dotplot" rel="noopener ugc nofollow" target="_blank">点线图</a>——或者更正式地通过统计测试(Levene的测试，等等)。</p><p id="0b39" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">视觉上，我们有:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="3baf" class="ny la it nt b gy nz oa l ob oc"># Boxplot<br/>boxplot(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/314e0650da682ca01ed5292c1893f8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qbDkQAxq5-oEpei0.png"/></div></div></figure><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="7bff" class="ny la it nt b gy nz oa l ob oc"># Dotplot<br/>library("lattice")</span><span id="dbb5" class="ny la it nt b gy od oa l ob oc">dotplot(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/30400545f1bbf8e2805a8109f2cf1065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nCAl0PUu3Eo2jEg4.png"/></div></div></figure><p id="2d3b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">箱线图和点图都显示了不同物种的相似方差。在箱线图中，这可以从以下事实中看出:对于所有物种来说，盒子和须状物具有可比较的大小。有几个<a class="ae ky" href="https://www.statsandr.com/blog/outliers-detection-in-r/" rel="noopener ugc nofollow" target="_blank">异常值</a>，如胡须外的点所示，但这不会改变不同物种之间的<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-by-hand/#dispersion" rel="noopener ugc nofollow" target="_blank">分散</a>或多或少相同的事实。</p><p id="f2a4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在点图中，这可以通过所有3个物种的点具有或多或少相同的<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#range" rel="noopener ugc nofollow" target="_blank">范围</a>这一事实看出，这是离散的标志，因此<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-by-hand/#variance" rel="noopener ugc nofollow" target="_blank">方差</a>是相似的。</p><p id="6886" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">与正态性假设一样，如果您觉得直观的方法不够充分，您可以使用Levene或Bartlett的测试来正式测试方差的相等性。请注意，Levene检验对偏离正态分布的敏感度低于Bartlett检验。</p><p id="6b0a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">两种检验的无效假设和替代假设是:</p><ul class=""><li id="9122" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">H0:差异是相等的</li><li id="e98b" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">H1:至少有一个差异是不同的</li></ul><p id="93ff" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在R中，Levene的测试可以通过<code class="fe nq nr ns nt b">{car}</code>包中的<code class="fe nq nr ns nt b">leveneTest()</code>函数来执行:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="ddbf" class="ny la it nt b gy nz oa l ob oc"># Levene's test<br/>library(car)</span><span id="e02d" class="ny la it nt b gy od oa l ob oc">leveneTest(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span><span id="2b2c" class="ny la it nt b gy od oa l ob oc">## Levene's Test for Homogeneity of Variance (center = median)<br/>##        Df F value Pr(&gt;F)<br/>## group   2  0.3306 0.7188<br/>##       339</span></pre><p id="26a2" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="np">p</em>-值大于0.05的显著性水平，我们不拒绝零假设，所以我们不能拒绝物种间方差相等的假设(<em class="np">p</em>-值= 0.719)。</p><p id="0155" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这个结果也符合视觉方法，所以方差的同质性在视觉上和形式上都得到满足。</p><h1 id="f9cf" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">检验正态性和同质性的另一种方法</h1><p id="f819" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">供您参考，也可以通过<code class="fe nq nr ns nt b">plot()</code>功能直观地(同时)测试方差的同质性和残差的正态性:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="8e36" class="ny la it nt b gy nz oa l ob oc">par(mfrow = c(1, 2)) # combine plots</span><span id="2b76" class="ny la it nt b gy od oa l ob oc"># 1. Homogeneity of variances<br/>plot(res_aov, which = 1)</span><span id="d35d" class="ny la it nt b gy od oa l ob oc"># 2. Normality<br/>plot(res_aov, which = 2)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/cad61f9f2601f0d2181833fdda681e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cJpMgMX6YWp79W22.png"/></div></div></figure><p id="610a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">左侧的图显示残差和拟合值(每组的平均值)之间没有明显的关系，因此假设方差齐性。如果方差的同质性被破坏，红线就不会是平的。</p><p id="7f77" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">右手边的图显示残差近似遵循正态分布，因此假设正态性。如果常态被破坏，点将持续偏离虚线。</p><h1 id="bc58" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方差分析</h1><p id="276c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们表明方差分析的所有假设都得到满足。因此，我们可以继续实施R中的方差分析，但首先，让我们做一些初步的分析，以更好地理解研究问题。</p><h1 id="cc08" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">初步分析</h1><p id="f56c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在实际执行R中的ANOVA之前，一个好的做法是<strong class="lt iu">可视化与研究问题相关的数据</strong>。最好的方法是绘制并比较每个物种的数量变量<code class="fe nq nr ns nt b">flipper_length_mm</code>的箱线图。</p><p id="30b3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">这可以通过基数R中的<code class="fe nq nr ns nt b">boxplot()</code>函数来完成(与等方差的视觉检查代码相同):</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="2bb6" class="ny la it nt b gy nz oa l ob oc">boxplot(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2edac4b170e0698c54aeaa0ac46adb46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VhvS5RY3gh98Zodw.png"/></div></div></figure><p id="a0af" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">或者用<code class="fe nq nr ns nt b"><a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">{ggplot2}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">包</a>:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="3dab" class="ny la it nt b gy nz oa l ob oc">library(ggplot2)</span><span id="5f93" class="ny la it nt b gy od oa l ob oc">ggplot(dat) +<br/>  aes(x = species, y = flipper_length_mm) +<br/>  geom_boxplot()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/f6c0b68334122f99cd88b77fa538c2f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iRoTAMVTS1TIeiFx.png"/></div></div></figure><p id="3b73" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">上面的方框图显示，至少对我们的样本来说，<code class="fe nq nr ns nt b">Gentoo</code>企鹅似乎有最大的鳍状肢，而<code class="fe nq nr ns nt b">Adelie</code>企鹅的鳍状肢最小。</p><p id="73b1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">除了每个物种的箱线图外，计算一些描述性统计数据<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a>也是一个很好的做法，例如物种的<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#mean" rel="noopener ugc nofollow" target="_blank">平均值</a>和<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/#standard-deviation-and-variance" rel="noopener ugc nofollow" target="_blank">标准差</a>。例如，这可以通过<code class="fe nq nr ns nt b">aggregate()</code>功能来实现:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="5cfa" class="ny la it nt b gy nz oa l ob oc">aggregate(flipper_length_mm ~ species,<br/>  data = dat,<br/>  function(x) round(c(mean = mean(x), sd = sd(x)), 2)<br/>)</span><span id="2ef4" class="ny la it nt b gy od oa l ob oc">##     species flipper_length_mm.mean flipper_length_mm.sd<br/>## 1    Adelie                 189.95                 6.54<br/>## 2 Chinstrap                 195.82                 7.13<br/>## 3    Gentoo                 217.19                 6.48</span></pre><p id="d0c8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">或者使用<code class="fe nq nr ns nt b">{dplyr}</code>组件中的<code class="fe nq nr ns nt b">summarise()</code>和<code class="fe nq nr ns nt b">group_by()</code>功能:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="c08f" class="ny la it nt b gy nz oa l ob oc">library(dplyr)</span><span id="7fda" class="ny la it nt b gy od oa l ob oc">group_by(dat, species) %&gt;%<br/>  summarise(<br/>    mean = mean(flipper_length_mm, na.rm = TRUE),<br/>    sd = sd(flipper_length_mm, na.rm = TRUE)<br/>  )</span><span id="2009" class="ny la it nt b gy od oa l ob oc">## # A tibble: 3 x 3<br/>##   species    mean    sd<br/>##   &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt;<br/>## 1 Adelie     190.  6.54<br/>## 2 Chinstrap  196.  7.13<br/>## 3 Gentoo     217.  6.48</span></pre><p id="bc29" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">平均值也是<code class="fe nq nr ns nt b">Adelie</code>最低，<code class="fe nq nr ns nt b">Gentoo</code>最高。然而，箱线图和描述性统计数据不足以得出结论，三个企鹅种群的鳍状肢有显著差异。</p><h1 id="93ce" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">R中的方差分析</h1><p id="95a1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如你现在所猜测的，只有方差分析可以帮助我们根据手头的样本对种群做出推断，并帮助我们回答最初的研究问题“三种企鹅的鳍状肢长度不同吗？”。</p><p id="1ffb" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">R中的方差分析可以用几种方法进行，下面介绍其中的两种方法:</p><ol class=""><li id="39e3" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">使用<code class="fe nq nr ns nt b">oneway.test()</code>功能:</li></ol><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="2dbd" class="ny la it nt b gy nz oa l ob oc"># 1st method:<br/>oneway.test(flipper_length_mm ~ species,<br/>  data = dat,<br/>  var.equal = TRUE # assuming equal variances<br/>)</span><span id="e008" class="ny la it nt b gy od oa l ob oc">## <br/>##  One-way analysis of means<br/>## <br/>## data:  flipper_length_mm and species<br/>## F = 594.8, num df = 2, denom df = 339, p-value &lt; 2.2e-16</span></pre><p id="ab67" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">2.使用<code class="fe nq nr ns nt b">summary()</code>和<code class="fe nq nr ns nt b">aov()</code>功能:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="a877" class="ny la it nt b gy nz oa l ob oc"># 2nd method:<br/>res_aov &lt;- aov(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span><span id="69d4" class="ny la it nt b gy od oa l ob oc">summary(res_aov)</span><span id="d69f" class="ny la it nt b gy od oa l ob oc">##              Df Sum Sq Mean Sq F value Pr(&gt;F)    <br/>## species       2  52473   26237   594.8 &lt;2e-16 ***<br/>## Residuals   339  14953      44                   <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## 2 observations deleted due to missingness</span></pre><p id="cba4" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从上面的两个输出可以看出，两种方法的检验统计量(<code class="fe nq nr ns nt b">F =</code>在第一种方法中，而<code class="fe nq nr ns nt b">F value</code>在第二种方法中)和<em class="np">p</em>-值(<code class="fe nq nr ns nt b">p-value</code>在第一种方法中，而<code class="fe nq nr ns nt b">Pr(&gt;F)</code>在第二种方法中)完全相同，这意味着在方差相等的情况下，结果和结论不会改变。</p><p id="1776" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">第一种方法的优点是很容易从ANOVA(方差相等时使用)切换到Welch检验(方差不相等时使用)。这可以通过用<code class="fe nq nr ns nt b">var.equal = FALSE</code>替换<code class="fe nq nr ns nt b">var.equal = TRUE</code>来实现，如下所示:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="69a4" class="ny la it nt b gy nz oa l ob oc">oneway.test(flipper_length_mm ~ species,<br/>  data = dat,<br/>  var.equal = FALSE # assuming unequal variances<br/>)</span><span id="e416" class="ny la it nt b gy od oa l ob oc">## <br/>##  One-way analysis of means (not assuming equal variances)<br/>## <br/>## data:  flipper_length_mm and species<br/>## F = 614.01, num df = 2.00, denom df = 172.76, p-value &lt; 2.2e-16</span></pre><p id="6d2c" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">然而，第二种方法的优点是:</p><ul class=""><li id="2d93" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">完整的ANOVA表(含自由度、均方差等。)打印出来，这在某些(理论上的)情况下可能是有意义的</li><li id="881f" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">方差分析(<code class="fe nq nr ns nt b">res_aov</code>)的结果可以保存以备后用(对<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#post-hoc-test" rel="noopener ugc nofollow" target="_blank">事后检验</a>特别有用)</li></ul><h1 id="2bda" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方差分析结果的解释</h1><p id="e17e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">鉴于<em class="np">p</em>-值小于0.05，我们拒绝零假设，因此我们拒绝所有均值相等的假设。因此，我们可以断定<strong class="lt iu">至少有一个物种在脚蹼长度</strong>(<em class="np">p</em>-value&lt;2.2e-16)方面与其他物种不同。</p><p id="193e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">(<em class="np">为了便于说明</em>，如果<em class="np">p</em>-值大于0.05:我们不能拒绝所有平均值相等的零假设，因此我们不能拒绝所考虑的三种企鹅的鳍长度相等的假设。)</p><p id="9873" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在R中报告方差分析结果的一种简单而又好的方法是使用<code class="fe nq nr ns nt b">{report}</code>包中的<code class="fe nq nr ns nt b">report()</code>函数:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="beff" class="ny la it nt b gy nz oa l ob oc"># install.packages("remotes")<br/># remotes::install_github("easystats/report") # You only need to do that once<br/>library("report") # Load the package every time you start R</span><span id="3f04" class="ny la it nt b gy od oa l ob oc">report(res_aov)</span><span id="4cf2" class="ny la it nt b gy od oa l ob oc">## The ANOVA (formula: flipper_length_mm ~ species) suggests that:<br/>## <br/>##   - The main effect of species is significant and large (F(2, 339) = 594.80, p &lt; .001; Eta2 = 0.78, 90% CI [0.75, 0.80])<br/>## <br/>## Effect sizes were labelled following Field's (2013) recommendations.</span></pre><p id="47d8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如您所见，该函数为您解释了结果，并显示了物种对鳍状肢长度的大而显著的主要影响(<em class="np">p</em>-值【t 33.001】)。</p><p id="3930" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">注意<code class="fe nq nr ns nt b">report()</code>功能可用于其他分析。如果你觉得这个有用，请查看R 中的更多<a class="ae ky" href="https://statsandr.com/blog/tips-and-tricks-in-rstudio-and-r-markdown/" rel="noopener ugc nofollow" target="_blank">提示和技巧。</a></p><h1 id="6973" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">下一步是什么？</h1><p id="c629" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果<strong class="lt iu">零假设没有被拒绝</strong> ( <em class="np"> p </em> -value ≥ 0.05)，则说明我们没有拒绝所有组都相等的假设。方差分析差不多到此为止。当然，也可以进行其他类型的分析，但是——根据手头的数据——我们无法证明至少有一组是不同的，所以我们通常不会进一步进行方差分析。</p><p id="bc85" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">相反，如果<strong class="lt iu">零假设被拒绝</strong>(因为这是我们的情况，因为<em class="np">p</em>-值&lt; 0.05)，我们证明至少有一组是不同的。如果我们只对检验所有物种的鳍状肢长度是否相等感兴趣，我们可以决定就此打住。</p><p id="143f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">但是大多数时候，当我们通过方差分析表明至少有一个群体是不同的时候，我们也有兴趣知道哪一个群体是不同的。然而，方差分析的结果是<strong class="lt iu"> <em class="np">而不是</em> </strong>告诉我们哪一组与其他组不同。</p><p id="83cc" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了测试这一点，我们需要使用其他类型的测试，称为事后测试(在拉丁语中，“在此之后”，因此在获得具有统计意义的ANOVA结果之后)或多个成对比较测试。这一系列的统计测试是下面几节的主题。</p><h1 id="2013" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">事后测试</h1><h1 id="a6b0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">多重测试问题</h1><p id="aaa8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了看出哪一组与其他组不同，我们需要<strong class="lt iu">对两组进行比较</strong>。实际上，由于有3个物种，我们将按如下方式比较物种2和2:</p><ol class=""><li id="7905" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">下颚带对抗阿德利</li><li id="1199" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">Gentoo对Adelie</li><li id="4085" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">Gentoo vs. Chinstrap</li></ol><p id="d7a3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">理论上，我们可以通过3个学生的t检验来比较物种，因为我们需要比较两个组，在这种情况下t检验被精确地使用。</p><p id="6bea" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">但是，如果执行了几个t测试，就会出现<strong class="lt iu">多重测试</strong>(也称为多重性)的问题。简而言之，当几个统计测试被执行时，一些会有<em class="np">p</em>-值小于α纯属偶然，即使所有的无效假设事实上都是真的。</p><p id="ec8f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了演示这个问题，考虑我们的情况，我们有3个假设要测试，期望的显著性水平为0.05。偶然观察到至少一个重要结果(至少一个<em class="np">p</em>-值&lt; 0.05)的概率为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/4e6f17b5c8e95fd28dd59f41fb065651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*1IYK1TRedp3xTyrqiocVFw.png"/></div></figure><p id="3039" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">因此，只要考虑3个测试，我们就有14.26%的机会观察到至少一个显著的结果，即使所有的测试实际上都不显著。</p><p id="7256" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">随着组数的增加，比较的次数也在增加，所以仅仅因为偶然而产生重要结果的概率也在增加。例如，对于10个组，我们需要进行45次比较，至少有一个重要结果的概率变成1−(1−0.05)^45 = 90%。因此，当比较10组时，很可能只是偶然观察到显著的结果，而当我们有14组或更多组时，我们几乎肯定(99%)有假阳性！</p><p id="d751" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">事后检验考虑到进行了多次检验，并通过以某种方式调整α来处理问题，因此，由于偶然性而观察到至少一个显著结果的概率保持在我们期望的显著性水平以下。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn4" rel="noopener ugc nofollow" target="_blank"> 4 </a></p><h1 id="142a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">R中的事后检验及其解释</h1><p id="e70f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">事后测试是一系列统计测试，所以有几种。最常用的是<strong class="lt iu"> Tukey HSD </strong>和<strong class="lt iu"> Dunnett的</strong>测试:</p><ul class=""><li id="c9c8" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">Tukey HSD用于比较<strong class="lt iu">所有组</strong>(因此所有可能的2组比较)。</li><li id="bcdb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">Dunnett用于与参照组进行比较。例如，考虑2个治疗组和1个对照组。如果您只想将2个治疗组与对照组进行比较，而不想将2个治疗组进行相互比较，则首选Dunnett检验。</li></ul><p id="1fb3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，假设两个测试的方差相等。它们将在下一节中介绍。如果方差不相等，可以使用Games-Howell检验等方法。</p><h1 id="2855" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">图基HSD试验</h1><p id="d37e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们的例子中，由于没有“参考”物种，我们对比较所有物种感兴趣，我们将使用Tukey HSD测试。</p><p id="488f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在R中，Tukey HSD测试如下进行。这就是执行ANOVA的<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#anova-in-r" rel="noopener ugc nofollow" target="_blank">第二种方法</a>派上用场的地方，因为结果(<code class="fe nq nr ns nt b">res_aov</code>)被重新用于事后检验:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="fc1d" class="ny la it nt b gy nz oa l ob oc">library(multcomp)</span><span id="cfda" class="ny la it nt b gy od oa l ob oc"># Tukey HSD test:<br/>post_test &lt;- glht(res_aov,<br/>  linfct = mcp(species = "Tukey")<br/>)</span><span id="896c" class="ny la it nt b gy od oa l ob oc">summary(post_test)</span><span id="5eff" class="ny la it nt b gy od oa l ob oc">## <br/>##   Simultaneous Tests for General Linear Hypotheses<br/>## <br/>## Multiple Comparisons of Means: Tukey Contrasts<br/>## <br/>## <br/>## Fit: aov(formula = flipper_length_mm ~ species, data = dat)<br/>## <br/>## Linear Hypotheses:<br/>##                         Estimate Std. Error t value Pr(&gt;|t|)    <br/>## Chinstrap - Adelie == 0   5.8699     0.9699   6.052   &lt;1e-08 ***<br/>## Gentoo - Adelie == 0     27.2333     0.8067  33.760   &lt;1e-08 ***<br/>## Gentoo - Chinstrap == 0  21.3635     1.0036  21.286   &lt;1e-08 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## (Adjusted p values reported -- single-step method)</span></pre><p id="8ccf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在Tukey HSD测试的输出中，我们感兴趣的是在<code class="fe nq nr ns nt b">Linear Hypotheses:</code>之后显示的表格，更准确地说，是表格的第一列和最后一列。第一列显示已经进行的比较；最后一列(<code class="fe nq nr ns nt b">Pr(&gt;|t|)</code>)显示每次比较的调整后的<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn5" rel="noopener ugc nofollow" target="_blank">5</a><em class="np">p</em>-值(零假设为两组相等，替代假设为两组不同)。</p><p id="9cdf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">正是这些调整后的p值用于测试两组是否有显著差异，我们可以确信整个比较集合的误差率为0.05。</p><p id="5c44" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在我们的示例中，我们测试了:</p><ol class=""><li id="e2e8" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">下颚带对抗阿德利(第<code class="fe nq nr ns nt b">Chinstrap - Adelie == 0</code>行)</li><li id="1287" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">巴布亚对阿德利(线<code class="fe nq nr ns nt b">Gentoo - Adelie == 0</code>)</li><li id="0f57" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">Gentoo vs. Chinstrap(第<code class="fe nq nr ns nt b">Gentoo - Chinstrap == 0</code>行)</li></ol><p id="9a5e" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">所有三个<em class="np">p</em>-值都小于0.05，因此我们拒绝所有比较的零假设，这意味着<strong class="lt iu">所有物种在鳍状肢长度方面都有显著差异</strong>。</p><p id="1ae2" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">事后测试的结果可以通过<code class="fe nq nr ns nt b">plot()</code>功能可视化:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="02b8" class="ny la it nt b gy nz oa l ob oc">par(mar = c(3, 8, 3, 3))<br/>plot(post_test)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/9ba7b2cfc7ca71f5bef26c2e270e323a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UzGBKw-o-4OuYjx1.png"/></div></div></figure><p id="8dac" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们看到置信区间没有越过零线，这表明所有组都有显著差异。</p><p id="467b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，Tukey HSD测试也可以在R中使用<code class="fe nq nr ns nt b">TukeyHSD()</code>功能完成:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="ebcd" class="ny la it nt b gy nz oa l ob oc">TukeyHSD(res_aov)</span><span id="c600" class="ny la it nt b gy od oa l ob oc">##   Tukey multiple comparisons of means<br/>##     95% family-wise confidence level<br/>## <br/>## Fit: aov(formula = flipper_length_mm ~ species, data = dat)<br/>## <br/>## $species<br/>##                       diff       lwr       upr p adj<br/>## Chinstrap-Adelie  5.869887  3.586583  8.153191     0<br/>## Gentoo-Adelie    27.233349 25.334376 29.132323     0<br/>## Gentoo-Chinstrap 21.363462 19.000841 23.726084     0</span></pre><p id="fba0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">对于这个代码，我们感兴趣的是列<code class="fe nq nr ns nt b">p adj</code>(也是最后一列)。请注意，结论与上面的相同:所有物种的鳍状肢长度都有显著差异。</p><p id="9286" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">结果也可以通过<code class="fe nq nr ns nt b">plot()</code>功能可视化:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="ed44" class="ny la it nt b gy nz oa l ob oc">plot(TukeyHSD(res_aov))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/e5de80744ee24596dc7e3877fb465908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rOsrzcqkZMUBPncb.png"/></div></div></figure><h1 id="806d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">邓尼特试验</h1><p id="fe6c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们在本<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#issue-of-multiple-testing" rel="noopener ugc nofollow" target="_blank">部分</a>中已经看到，随着组数的增加，比较的次数也在增加。随着<strong class="lt iu">比较次数的增加</strong>，事后分析必须进一步降低个体显著性水平，这导致<strong class="lt iu">较低的统计功效</strong>(因此群体中组均值之间的差异不太可能被检测到)。</p><p id="53e0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">减轻这种情况并提高统计功效的一种方法是减少比较次数。这种减少允许后特设过程使用更大的个体错误率来实现期望的全局错误率。虽然用Tukey HSD试验比较所有可能的组是一种常见的方法，但许多研究有一个对照组和几个治疗组。对于这些研究，您可能只需要将治疗组与对照组进行比较，这样可以减少比较的次数。</p><p id="d56a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">邓尼特的测试恰恰做到了这一点——它只是将一个群体与所有其他群体进行比较，而不是将所有群体相互比较。</p><p id="32cf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">概括一下:</p><ul class=""><li id="c8b9" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">Tukey HSD测试允许比较<strong class="lt iu">所有</strong>组，但代价是<strong class="lt iu">更少的功率</strong></li><li id="4c15" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">邓尼特测试只允许与参照组进行<strong class="lt iu">比较，但好处是<strong class="lt iu">更有力量</strong></strong></li></ul><p id="d7ad" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">现在，再次为了说明起见，考虑物种<code class="fe nq nr ns nt b">Adelie</code>是参照物种，我们只对参照物种与其他两个物种的比较感兴趣。在这种情况下，我们将使用邓尼特测试。</p><p id="5538" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在R中，Dunnett测试按如下方式进行(与Tukey HSD测试代码的唯一区别是在第<code class="fe nq nr ns nt b">linfct = mcp(species = "Dunnett")</code>行):</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="ab21" class="ny la it nt b gy nz oa l ob oc">library(multcomp)</span><span id="ccb7" class="ny la it nt b gy od oa l ob oc"># Dunnett's test:<br/>post_test &lt;- glht(res_aov,<br/>  linfct = mcp(species = "Dunnett")<br/>)</span><span id="cd14" class="ny la it nt b gy od oa l ob oc">summary(post_test)</span><span id="e3ad" class="ny la it nt b gy od oa l ob oc">## <br/>##   Simultaneous Tests for General Linear Hypotheses<br/>## <br/>## Multiple Comparisons of Means: Dunnett Contrasts<br/>## <br/>## <br/>## Fit: aov(formula = flipper_length_mm ~ species, data = dat)<br/>## <br/>## Linear Hypotheses:<br/>##                         Estimate Std. Error t value Pr(&gt;|t|)    <br/>## Chinstrap - Adelie == 0   5.8699     0.9699   6.052 7.59e-09 ***<br/>## Gentoo - Adelie == 0     27.2333     0.8067  33.760  &lt; 1e-10 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## (Adjusted p values reported -- single-step method)</span></pre><p id="58a1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">解释与Tukey HSD试验相同，除了在Dunett试验中，我们只比较:</p><ol class=""><li id="b94c" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">下颚带对抗阿德利(第<code class="fe nq nr ns nt b">Chinstrap - Adelie == 0</code>行)</li><li id="6001" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">Gentoo vs. Adelie(第<code class="fe nq nr ns nt b">Gentoo - Adelie == 0</code>行)</li></ol><p id="f1fd" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">两个<em class="np">p</em>-值(显示在最后一列)都低于0.05，因此我们拒绝两个比较的零假设。这意味着<strong class="lt iu">物种下巴颏带和巴布亚企鹅在鳍状肢长度方面与参照物种阿德利</strong>有显著差异。(不过，关于Chinstrap和Gentoo之间的比较，没什么可说的。)</p><p id="3db3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">同样，事后测试的结果可以通过<code class="fe nq nr ns nt b">plot()</code>功能可视化:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="feed" class="ny la it nt b gy nz oa l ob oc">par(mar = c(3, 8, 3, 3))<br/>plot(post_test)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2d64e59af7f111e071f8e75bb33650e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*b2bILZnNimALKJVw.png"/></div></div></figure><p id="8d23" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们看到置信区间没有越过零线，这表明Gentoo和Chinstrap两个物种都与参考物种Adelie显著不同。</p><p id="bd6a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">注意，在R中，默认情况下，<a class="ae ky" href="https://www.statsandr.com/blog/data-types-in-r/#factor" rel="noopener ugc nofollow" target="_blank">因子变量</a>的参考类别是字母顺序中的第一个类别。这就是默认情况下参考物种是阿德利的原因。</p><p id="9523" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">可以用<code class="fe nq nr ns nt b">relevel()</code>功能(或用<code class="fe nq nr ns nt b"><a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/#reordering-factors" rel="noopener ugc nofollow" target="_blank">{questionr}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/#reordering-factors" rel="noopener ugc nofollow" target="_blank">插件</a>)改变参考类别。考虑到我们希望Gentoo而不是Adelie作为参考类别:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="b591" class="ny la it nt b gy nz oa l ob oc"># Change reference category:<br/>dat$species &lt;- relevel(dat$species, ref = "Gentoo")</span><span id="c17a" class="ny la it nt b gy od oa l ob oc"># Check that Gentoo is the reference category:<br/>levels(dat$species)</span><span id="f2c5" class="ny la it nt b gy od oa l ob oc">## [1] "Gentoo"    "Adelie"    "Chinstrap"</span></pre><p id="9ec8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">Gentoo现在是三个类别中的第一个，它确实被认为是参考级别。</p><p id="b70d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">为了使用新的参考值执行Dunnett检验，我们首先需要重新运行ANOVA以考虑新的参考值:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="1266" class="ny la it nt b gy nz oa l ob oc">res_aov2 &lt;- aov(flipper_length_mm ~ species,<br/>  data = dat<br/>)</span></pre><p id="a0fd" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">然后，我们可以使用方差分析的新结果运行Dunett检验:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="08e0" class="ny la it nt b gy nz oa l ob oc"># Dunnett's test:<br/>post_test &lt;- glht(res_aov2,<br/>  linfct = mcp(species = "Dunnett")<br/>)</span><span id="0f70" class="ny la it nt b gy od oa l ob oc">summary(post_test)</span><span id="defe" class="ny la it nt b gy od oa l ob oc">## <br/>##   Simultaneous Tests for General Linear Hypotheses<br/>## <br/>## Multiple Comparisons of Means: Dunnett Contrasts<br/>## <br/>## <br/>## Fit: aov(formula = flipper_length_mm ~ species, data = dat)<br/>## <br/>## Linear Hypotheses:<br/>##                         Estimate Std. Error t value Pr(&gt;|t|)    <br/>## Adelie - Gentoo == 0    -27.2333     0.8067  -33.76   &lt;1e-10 ***<br/>## Chinstrap - Gentoo == 0 -21.3635     1.0036  -21.29   &lt;1e-10 ***<br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## (Adjusted p values reported -- single-step method)</span><span id="f438" class="ny la it nt b gy od oa l ob oc">par(mar = c(3, 8, 3, 3))<br/>plot(post_test)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/94db76e3e776f5b60ea862e5c4933f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nV7MiB57PblkS3f1.png"/></div></div></figure><p id="34d5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">根据以上结果，我们得出结论，阿德利和下巴颏物种在鳍状肢长度方面与巴布亚物种有显著差异(<em class="np">p</em>-值&lt; 1e-10)。</p><p id="761d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，即使您的研究没有可以与其他组进行比较的参考组，进行由一些研究问题决定的多重比较通常也比进行所有成对测试要好。通过将事后比较的数量减少到必要的数量，你可以最大化统计能力。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fn6" rel="noopener ugc nofollow" target="_blank"> 6 </a></p><h1 id="ee4c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">其他p值校正方法</h1><p id="234a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于感兴趣的读者，请注意，通过使用<code class="fe nq nr ns nt b">pairwise.t.test()</code>功能，您可以使用其他<em class="np"> p </em>值调整方法:</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="2125" class="ny la it nt b gy nz oa l ob oc">pairwise.t.test(dat$flipper_length_mm, dat$species,<br/>  p.adjust.method = "holm"<br/>)</span><span id="439d" class="ny la it nt b gy od oa l ob oc">## <br/>##  Pairwise comparisons using t tests with pooled SD <br/>## <br/>## data:  dat$flipper_length_mm and dat$species <br/>## <br/>##           Gentoo  Adelie <br/>## Adelie    &lt; 2e-16 -      <br/>## Chinstrap &lt; 2e-16 3.8e-09<br/>## <br/>## P value adjustment method: holm</span></pre><p id="3b0f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">默认情况下，将应用Holm方法，但也存在其他方法。参见<code class="fe nq nr ns nt b">?p.adjust</code>了解所有可用选项。</p><h1 id="dada" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">同一地块上方差分析和事后检验的可视化</h1><p id="14e8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你有兴趣在同一个图上(直接在箱线图上)包括方差分析和事后测试的结果，这里有一段你可能感兴趣的代码(我根据这篇<a class="ae ky" href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/76-add-p-values-and-significance-levels-to-ggplots/" rel="noopener ugc nofollow" target="_blank">文章</a>中的代码编辑的):</p><pre class="kj kk kl km gt nu nt nv nw aw nx bi"><span id="cb0e" class="ny la it nt b gy nz oa l ob oc"># Edit from here<br/>x &lt;- which(names(dat) == "species") # name of grouping variable<br/>y &lt;- which(<br/>  names(dat) == "flipper_length_mm" # names of variables to test<br/>)<br/>method1 &lt;- "anova" # one of "anova" or "kruskal.test"<br/>method2 &lt;- "t.test" # one of "wilcox.test" or "t.test"<br/>my_comparisons &lt;- list(c("Chinstrap", "Adelie"), c("Gentoo", "Adelie"), c("Gentoo", "Chinstrap")) # comparisons for post-hoc tests<br/># Edit until here<br/></span><span id="45d2" class="ny la it nt b gy od oa l ob oc"># Edit at your own risk<br/>library(ggpubr)<br/>for (i in y) {<br/>  for (j in x) {<br/>    p &lt;- ggboxplot(dat,<br/>      x = colnames(dat[j]), y = colnames(dat[i]),<br/>      color = colnames(dat[j]),<br/>      legend = "none",<br/>      palette = "npg",<br/>      add = "jitter"<br/>    )<br/>    print(<br/>      p + stat_compare_means(aes(label = paste0(..method.., ", p-value = ", ..p.format..)),<br/>        method = method1, label.y = max(dat[, i], na.rm = TRUE)<br/>      )<br/>      + stat_compare_means(comparisons = my_comparisons, method = method2, label = "p.format") # remove if p-value of ANOVA or Kruskal-Wallis test &gt;= alpha<br/>    )<br/>  }<br/>}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/f160ac0e27ebc70b6579e18f0f4f611a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1o2ucCQfInMKq1t-.png"/></div></div></figure><p id="da34" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">正如你在上面的图上看到的，物种的箱线图与方差分析和事后检验的<em class="np"> p </em>值一起显示。</p><p id="ba80" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">除了在同一个图上结合了可视化表示和结果的事实之外，这段代码还具有可以一次执行多个ANOVA测试的优点。更多信息请参见本文<a class="ae ky" href="https://www.statsandr.com/blog/how-to-do-a-t-test-or-anova-for-many-variables-at-once-in-r-and-communicate-the-results-in-a-better-way/" rel="noopener ugc nofollow" target="_blank">的</a>部分。</p><h1 id="286d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="d9b8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，我们回顾了ANOVA的<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#aim-and-hypotheses-of-anova" rel="noopener ugc nofollow" target="_blank">目标和假设</a>，在能够信任结果之前需要验证哪些<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#underlying-assumptions-of-anova" rel="noopener ugc nofollow" target="_blank">假设</a>(即独立性、正态性和同质性)，然后我们向<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#anova-in-r" rel="noopener ugc nofollow" target="_blank">展示了如何在R </a>中进行ANOVA，以及如何<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#interpretations-of-anova-results" rel="noopener ugc nofollow" target="_blank">解释结果</a>。</p><p id="97da" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">如果不讨论<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#post-hoc-test" rel="noopener ugc nofollow" target="_blank">事后检验</a>，特别是<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#tukey-hsd-test" rel="noopener ugc nofollow" target="_blank">Tukey HSD</a>——比较所有组——和<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#dunnetts-test" rel="noopener ugc nofollow" target="_blank"> Dunnett的</a>检验——比较一个参照组和所有其他组，那么一篇关于方差分析的文章就不完整。</p><p id="d059" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">最后但同样重要的是，我们展示了如何在同一个图中<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#visualization-of-anova-and-post-hoc-tests" rel="noopener ugc nofollow" target="_blank">可视化</a>方差分析和事后检验的数据和结果。</p><p id="a3c1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">感谢阅读。</p><p id="5d1f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><ol class=""><li id="ecd8" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">请注意，它被称为<em class="np">单向</em>或<em class="np">单因素</em> ANOVA，因为均值与单个自变量或因素的不同模态相关。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="5162" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">残差(表示为ϵϵ)是因变量的观测值(y)和预测值(y hat)之间的差值。在ANOVA的上下文中，残差对应于观察值和该组所有值的平均值之间的差异。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref2" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="6885" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">只要你使用Kruskal-Wallis检验来比较各组，就不需要同质性。如果你想比较中位数，Kruskal-Wallis检验需要同质性。在这篇<a class="ae ky" href="https://influentialpoints.com/Training/Kruskal-Wallis_ANOVA_use_and_misuse.htm" rel="noopener ugc nofollow" target="_blank">文章</a>中查看更多关于差异的信息。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref3" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="cea6" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">注意，正如在文章末尾的评论中所讨论的，事后检验在某些情况下可以直接进行(不需要ANOVA)。详见许(<a class="ae ky" href="https://statsandr.com/blog/anova-in-r/#ref-hsu1996multiple" rel="noopener ugc nofollow" target="_blank"> 1996 </a>)的评论。<a class="ae ky" href="https://statsandr.com/blog/anova-in-r/#fnref4" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="22e0" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">请注意，原则上您可以将Bonferroni校正应用于所有测试。例如，在上面的例子中，有3个测试和α = 0.05的全局期望显著性水平，如果<em class="np">p</em>-值小于0.05 / 3 = 0.0167，我们将拒绝零假设。然而，已知这种方法相当保守，导致潜在的高假阴性率。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref4" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="9b9c" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">调整<em class="np">p</em>-值，将全局显著性水平保持在所需水平。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref5" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="b4b9" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">感谢Michael Friendly的建议。<a class="ae ky" href="https://www.statsandr.com/blog/anova-in-r/#fnref6" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li></ol><h1 id="069a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关文章</h1><ul class=""><li id="bfb7" class="nb nc it lt b lu lv lx ly ma oo me op mi oq mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/" rel="noopener ugc nofollow" target="_blank">一次比例和拟合优度检验(R和手动)</a></li><li id="78f0" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-perform-a-one-sample-t-test-by-hand-and-in-r-test-on-one-mean/" rel="noopener ugc nofollow" target="_blank">如何手工进行单样本t检验，并对一个均值进行R:检验</a></li><li id="5535" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/" rel="noopener ugc nofollow" target="_blank">R中的Wilcoxon检验:如何在非正态假设下比较两组</a></li><li id="5095" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-do-a-t-test-or-anova-for-many-variables-at-once-in-r-and-communicate-the-results-in-a-better-way/" rel="noopener ugc nofollow" target="_blank">如何在R中一次对多个变量进行t检验或方差分析</a></li><li id="f480" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">学生的R和手工t检验:如何在不同场景下比较两组</a></li></ul></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><p id="009f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="np">原载于2020年10月12日https://statsandr.com</em><a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank"><em class="np"/></a><em class="np">。</em></p></div></div>    
</body>
</html>