<html>
<head>
<title>Mastering Data Filtering with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫掌握数据过滤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-data-filtering-with-pandas-449eb91f8890?source=collection_archive---------21-----------------------#2020-11-05">https://towardsdatascience.com/mastering-data-filtering-with-pandas-449eb91f8890?source=collection_archive---------21-----------------------#2020-11-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a712" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫的三个有用的数据过滤功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7437e920531f161ee48a246ec7705291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8O_BeHj67xdbk70Tx1D-GA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://www.pexels.com/@ken-tomita-127057" rel="noopener ugc nofollow" target="_blank">肯·富田</a>在<a class="ae ky" href="https://www.pexels.com/photo/architecture-business-clean-computer-389818/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄的照片</p></figure><p id="c9c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个python库，用于生成统计数据、争论数据、分析数据等等。在这篇文章中，我将讨论三个有用的函数，它们可以让我们使用Pandas轻松过滤数据。</p><p id="8700" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="f307" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们将使用<em class="lv"> FIFA 19 </em>数据集，可以在这里<a class="ae ky" href="https://www.kaggle.com/karangadiya/fifa19" rel="noopener ugc nofollow" target="_blank">找到</a>。</p><p id="2a15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们导入熊猫包:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8a9a" class="mb mc it lx b gy md me l mf mg">import pandas as pd </span></pre><p id="7521" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们将显示列和行的最大数量设置为“None”:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ff42" class="mb mc it lx b gy md me l mf mg">pd.set_option('display.max_columns', None)<br/>pd.set_option('display.max_rows', None)</span></pre><p id="affd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们读入数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="7519" class="mb mc it lx b gy md me l mf mg">df = pd.read_csv('fifa_data.csv')</span></pre><p id="cf4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将打印前五行数据，以了解列类型及其值(列结果被截断):</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="aa5c" class="mb mc it lx b gy md me l mf mg">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/29f352e04e5aed8028b211e3ec5b24f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRy7jXURBt4hlRy_i5Ol3g.png"/></div></div></figure><p id="93aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以考虑的第一个功能是按类别过滤。让我们定义我们的函数‘filter _ category’。我们的函数将接受一个类别和类别值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="13e8" class="mb mc it lx b gy md me l mf mg">def filter_category(category, category_value):</span></pre><p id="cf81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用“loc”操作符来选择类别值是我们选择的值的行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="d8e7" class="mb mc it lx b gy md me l mf mg">def filter_category(category, category_value):<br/>    df_filter = df.loc[df[category] == category_value]<br/>    return df_filter</span></pre><p id="be6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们过滤阿根廷国籍:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ba8d" class="mb mc it lx b gy md me l mf mg">df_filter = filter_category('Nationality', 'Argentina')<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/e815bd7bae19c1c01967c9e5f035cb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KvY0astu1eUKTFvSumn26Q.png"/></div></div></figure><p id="1499" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到“国籍”的所有值都是“阿根廷”。另一种有用的函数是按值列表过滤的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="42f3" class="mb mc it lx b gy md me l mf mg">def filter_category_with_list(category, category_value_list):<br/>    df_filter = df.loc[df[category].isin(category_value_list)]<br/>    return df_filter</span></pre><p id="39da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以筛选“国籍”为“巴西”、“西班牙”或“阿根廷”的行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="b932" class="mb mc it lx b gy md me l mf mg">df_filter = filter_category_with_list('Nationality', ['Brazil', 'Spain', 'Argentina'])<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/5ad4b665fa6a5dcc1beecd95ce9e9f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eUemNB_epLsnr4tLSYLxQ.png"/></div></div></figure><p id="fd06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以通过分类栏“俱乐部”进行过滤。让我们过滤“曼城”、“皇家马德里”和“巴塞罗那足球俱乐部”:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="41a2" class="mb mc it lx b gy md me l mf mg">df_filter = filter_category_with_list('Club', [‘Manchester City’, ‘Real Madrid’, ‘FC Barcelona’])<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/bad686926ab2060ffed49a646894d660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlP5Kun2PJOe7OyWWvrZFg.png"/></div></div></figure><p id="6666" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以定义一个根据数值过滤的函数。该函数将能够根据输入值以及行是大于、小于还是等于输入值来筛选行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5d17" class="mb mc it lx b gy md me l mf mg">def filter_numerical(numerical, numerical_value, relationship):<br/>    if relationship == 'greater':<br/>        df_filter = df.loc[df[numerical] &gt; numerical_value]<br/>    elif relationship == 'less':<br/>        df_filter = df.loc[df[numerical] &lt; numerical_value]     <br/>    else: <br/>        df_filter = df.loc[df[numerical] == numerical_value]  <br/>    return df_filter</span></pre><p id="c92d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以筛选足球运动员的“年龄”大于30的行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="61a9" class="mb mc it lx b gy md me l mf mg">df_filter = filter_numerical('Age', 30, 'greater')<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/c2719e99d6fac348dda530a4b7215468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrkGyqtf2jE5nuYP2zeKsw.png"/></div></div></figure><p id="8d7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不到30:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="d6a3" class="mb mc it lx b gy md me l mf mg">df_filter = filter_numerical('Age', 30, 'less')<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/198166890fefb7ca55d510d8c0c04571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-mLAS6sP5we5zjpJw28aw.png"/></div></div></figure><p id="6ca6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者等于30:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9419" class="mb mc it lx b gy md me l mf mg">df_filter = filter_numerical('Age', 30, 'equal')<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/e94fd4069c0c73e36851eabcf152a22a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQQhb3E1sTVh0e9cQua4Eg.png"/></div></div></figure><p id="bd26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以按工资过滤。首先，让我们将工资转换成浮动工资:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="fef1" class="mb mc it lx b gy md me l mf mg">f['Wage'] = df['Wage'].str.lstrip('€')<br/>df['Wage'] = df['Wage'].str.rstrip('K')<br/>df['Wage'] = df['Wage'].astype(float)*1000.0</span><span id="2a97" class="mb mc it lx b gy mo me l mf mg">print(df['Wage'].head())</span></pre><p id="9daa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们过滤工资低于100000欧元的情况:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c2cc" class="mb mc it lx b gy md me l mf mg">df_filter = filter_numerical('Wage', 100000, 'less')<br/>print(df_filter.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/58fde2f3b6d4cd89bcd1470c42d85c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uOfii0A6SlWqxCRcH5XnqA.png"/></div></div></figure><p id="ee92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是我鼓励你自己动手处理数据和编写代码。可以考虑编写一个有趣的函数，它根据数值和分类列值进行过滤。</p><h2 id="23b2" class="mb mc it bd mq mr ms dn mt mu mv dp mw li mx my mz lm na nb nc lq nd ne nf ng bi translated">结论</h2><p id="40b4" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何定义三个函数来轻松过滤数据行。首先，我们讨论了如何通过单个分类值过滤数据行。然后我们讨论如何使用分类值列表过滤行。最后，我们展示了如何通过数字列值过滤数据行。如果你有兴趣学习更多关于熊猫的数据操作、机器学习甚至只是python编程的一些基础知识，请查看<a class="ae ky" href="https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&amp;keywords=sadrach+python&amp;qid=1604966500&amp;s=books&amp;sr=1-1" rel="noopener ugc nofollow" target="_blank"><em class="lv">Python for Data Science and Machine Learning:Python编程、熊猫和Scikit-初学者学习教程</em> </a>。我希望你觉得这篇文章有用有趣。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/pandas_data_filtering.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>