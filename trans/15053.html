<html>
<head>
<title>Conditional and Controllable Generative Adversarial Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">条件可控的生成对抗网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/conditional-and-controllable-generative-adversarial-networks-a149691ddae6?source=collection_archive---------25-----------------------#2020-10-16">https://towardsdatascience.com/conditional-and-controllable-generative-adversarial-networks-a149691ddae6?source=collection_archive---------25-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="38cf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">理解条件可控GAN并在TensorFlow 2.x中实现CGAN</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1d07125001b80da2ae2de9a97dd3c664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*viU2D4hNPHj9VgDT5Gb49Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@mrtt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">TT先生</a>在<a class="ae kv" href="https://unsplash.com/s/photos/art?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d0d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将了解条件和可控GAN，它们的需求是什么，以及如何使用TensorFlow 2.x实现简单的条件GAN。在您进一步阅读之前，我希望您熟悉DCGANs，您可以在这里找到<a class="ae kv" rel="noopener" target="_blank" href="/deep-convolutional-vs-wasserstein-generative-adversarial-network-183fbcfdce1f"/>。</p><h2 id="669b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">为什么有条件甘</h2><p id="0450" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">到目前为止，生成器是随机生成图像的，我们无法控制要生成的图像的类别，即在训练GAN时，生成器每次都会生成一个随机数字，即它可能会生成一个、六个或三个，我们不知道它会生成什么。但是条件句我们可以告诉生成器生成一个或六个图像。这就是有条件的GAN派上用场的地方。通过有条件的GAN，您可以生成您选择的类别的图像。</p><h2 id="030b" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">它是如何工作的？</h2><p id="b0bd" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">到目前为止，我们将图像作为唯一的输入提供给我们的生成器和鉴别器。但是现在我们将向两个网络提供班级信息。</p><ol class=""><li id="0794" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">生成器将随机噪声和一个独热编码类标签作为输入。并输出特定类别的假图像。</li><li id="cc1e" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">鉴别器获取一个带有作为深度添加到图像(通道)的独热标签的图像，即，如果您有一个大小为28 * 28 *1的图像和大小为n的独热向量，则图像大小将为28 * 28 * (n+1)。</li><li id="0953" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">鉴别器输出图像是否属于该类别，即真实或虚假。</li></ol></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="1c3b" class="nl lt iq bd lu nm nn no lx np nq nr ma jw ns jx md jz nt ka mg kc nu kd mj nv bi translated">密码</h1><p id="0fd3" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">本文的代码与DCGAN的代码几乎相同，只是做了一些修改。让我们看看这些差异。</p><blockquote class="nw nx ny"><p id="3775" class="kw kx nz ky b kz la jr lb lc ld ju le oa lg lh li ob lk ll lm oc lo lp lq lr ij bi translated">注意:跟随实现是一种幼稚的方式，并且非常慢。你可以参考<a class="ae kv" href="https://machinelearningmastery.com/how-to-develop-a-conditional-generative-adversarial-network-from-scratch/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">这里的</strong> </a>找到一个更好的编码条件gan的方法。</p></blockquote><h2 id="18ee" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">组合图像和标签</h2><ol class=""><li id="a479" class="mq mr iq ky b kz ml lc mm lf od lj oe ln of lr mv mw mx my bi translated">首先，我们加载MNIST数据集并归一化图像。</li><li id="9c58" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">然后，我们定义一个add_channels函数，它将一个图像和相应的一个hot标签作为输入。并且输出具有表示独热标签的附加深度通道的图像。在添加的所有深度通道中，只有一个通道包含值1，所有其他通道都包含零值。</li><li id="ebf5" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">首先，我们迭代所有的图像和相应的标签。对于独热标签中的每个数字，我们创建一个图像形状向量，其中包含等于该数字的每个值。之后，我们把这些向量和图像叠加起来。</li><li id="6601" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">这里，我们有10个类，这就是为什么我们在一个热标签中循环了10个数字。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="b06e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结合噪音和标签</h2><ol class=""><li id="1044" class="mq mr iq ky b kz ml lc mm lf od lj oe ln of lr mv mw mx my bi translated">以下代码将噪声向量与一键标签和其他函数结合起来，输出生成器和鉴别器的输入尺寸。</li><li id="583c" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">这是必要的，因为我们的模型是使用顺序API编码的，我们需要显式地传递输入维度。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><h2 id="3234" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">训练循环</h2><ol class=""><li id="afa2" class="mq mr iq ky b kz ml lc mm lf od lj oe ln of lr mv mw mx my bi translated">训练循环也与DCGAN相同，但这一次我们为生成器合并了噪声和标签。并且在将伪图像送入鉴别器之前对其进行图像处理。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="eadd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的condition GANs实现代码非常慢，但它运行良好，有助于理解这个概念。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="c622" class="nl lt iq bd lu nm nn no lx np nq nr ma jw ns jx md jz nt ka mg kc nu kd mj nv bi translated">可控GANs</h1><p id="9d9e" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">条件甘帮助生成我们选择的类的图像。但是我们无法控制输出图像的内容，也就是说，如果我们想要一只戴着红帽子或眼镜的狗怎么办。这就是可控GANs出现的原因。但是它是如何工作的呢？所以让我们来找出答案。</p><h2 id="738f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">概念</h2><p id="8fae" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">可控的GANs对于在生成的图像中获得选择的特征是有用的。例如，如果我们想生成一个黑头发绿眼睛的人的图像，那么你需要调整输入噪声。</p><ol class=""><li id="129c" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated">当您向发生器提供随机噪声向量时，该噪声向量中的元素对应于所生成图像中的某些特征。</li><li id="24ef" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">当您更改噪波向量中的元素时，它会更改图像中的一些特征，例如向量中的一些更改可能会更改人的头发或眼睛的颜色。</li><li id="d749" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">这可以通过在一些向量空间中映射具有相关特征的向量来实现。</li><li id="7352" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated">这可以通过使用预先训练的分类器来执行，该分类器告知特定特征是否出现在生成的图像中，例如人的眼睛是否是绿色的。这可以用于找到不同特征的噪声矢量。</li></ol><h2 id="5c5c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">可控氮化镓面临的挑战</h2><p id="347b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">可控GANs面临以下两个主要挑战。</p><ol class=""><li id="85b0" class="mq mr iq ky b kz la lc ld lf ms lj mt ln mu lr mv mw mx my bi translated"><strong class="ky ir">相关性黑白特征:</strong>当我们为了改变一个特征而改变噪声向量的一个元素时(就像给女性的图像添加面部毛发)，会导致其他特征的改变(就像改变图像中人的性别)。这可能是因为模特们见过面部毛发带有阳刚之气的脸。</li><li id="0a29" class="mq mr iq ky b kz mz lc na lf nb lj nc ln nd lr mv mw mx my bi translated"><strong class="ky ir">矢量空间纠缠:</strong>噪声矢量中的元素在对应特征时发生纠缠。</li></ol><h1 id="be4e" class="nl lt iq bd lu nm oi no lx np oj nr ma jw ok jx md jz ol ka mg kc om kd mj nv bi translated">结论</h1><p id="7558" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">条件gan用于生成属于我们选择的类的图像，而可控gan用于控制图像中的特征。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="8afa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以在这里找到这篇文章的完整代码。请继续关注即将发表的文章，我们将在那里实现更多的算法。</p><p id="8f08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，本文到此结束。谢谢你的阅读，希望你喜欢并且能够理解我想要解释的内容。希望你阅读我即将发表的文章。哈里奥姆…🙏</p><h1 id="bb25" class="nl lt iq bd lu nm oi no lx np oj nr ma jw ok jx md jz ol ka mg kc om kd mj nv bi translated">参考</h1><div class="on oo gp gr op oq"><a href="https://www.coursera.org/specializations/generative-adversarial-networks-gans" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">生成对抗网络</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">由DeepLearning.AI提供关于GANs生成对抗网络(GANs)是强大的机器学习模型…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">www.coursera.org</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kp oq"/></div></div></a></div></div></div>    
</body>
</html>