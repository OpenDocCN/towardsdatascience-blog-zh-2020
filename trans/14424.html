<html>
<head>
<title>Create Beautiful Architecture Diagrams with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python创建漂亮的架构图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-beautiful-architecture-diagrams-with-python-7792a1485f97?source=collection_archive---------3-----------------------#2020-10-05">https://towardsdatascience.com/create-beautiful-architecture-diagrams-with-python-7792a1485f97?source=collection_archive---------3-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9143" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="52f7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">停止花费时间手动调整未对准的箭头</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/d1213ca387153e6ef27f0145a85df1c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixZigf-RFm06ka4TZKmqBQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">建立与代码从要点链接<a class="ae lh" href="https://gist.github.com/dd48a8d3cb7dc581d976329208c1c422.git" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></figure><h1 id="94bd" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">一些背景故事</h1><p id="b167" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">本周早些时候，我偶然发现了一个Python库，它有一个非常吸引人的价值主张。这个库叫做<a class="ae lh" href="https://diagrams.mingrammer.com/" rel="noopener ugc nofollow" target="_blank">图</a>，正如它的名字一样，它创建图。这些生成的图表通常是我通过笨拙地将图像粘贴到draw.io或Google图表中而创建的，之后我会浪费几个小时来正确地对齐一切。除了那个令人疲惫的过程之外，当我后来需要更新这些图时，仅仅为了对架构的一些改变，就需要提升和移动超过一半的组件。在进一步研究了library之后，我发现它能够减轻我的痛苦。</p><h1 id="7b72" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">开始使用您自己的图表</h1><p id="a305" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">开始构建这些图的第一个要求是安装Python 3.6或更高版本。一旦是这种情况，你将需要安装GraphViz，因为这是什么呈现的图表。Github库实际上也有一个相当不错的“入门”部分，所以如果你需要帮助安装任何东西，请随意参考这里的<a class="ae lh" href="https://github.com/mingrammer/diagrams#getting-started" rel="noopener ugc nofollow" target="_blank"/>。一旦用您最喜欢的Python包管理器安装了库“图表”,您就可以开始创建了。</p><p id="7f27" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">对我来说，开始就像下面的命令一样简单，因为我满足了最初的要求。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="d094" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">组件类型</h1><p id="0ecd" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">图形库为许多不同的提供者提供组件。以下可能是14个可用用例中最相关的。</p><ul class=""><li id="596d" class="nd ne it mc b md mw mg mx mj nf mn ng mr nh mv ni nj nk nl bi translated"><strong class="mc jd"> AWS/GCP/Azure </strong> —这些提供商公开了正式的云服务资产，您将在任何利用主要云提供商之一的图表中使用这些资产。我的团队主要在GCP工作，在偶然发现这个库之前，我会花几个小时手工构建这些图，所以当我发现这些节点资产唾手可得时，我有点兴奋。</li><li id="97e1" class="nd ne it mc b md nm mg nn mj no mn np mr nq mv ni nj nk nl bi translated"><strong class="mc jd">通用和本地</strong> —如果您希望以云不可知的方式说明底层技术，这些节点可能会一起使用。例如，通过显示Google数据流为一个架构提供一个Beam组件。</li><li id="1ee1" class="nd ne it mc b md nm mg nn mj no mn np mr nq mv ni nj nk nl bi translated"><strong class="mc jd">框架</strong> —如果你想用编程语言说明一个节点，这些组件会很有用。</li><li id="a759" class="nd ne it mc b md nm mg nn mj no mn np mr nq mv ni nj nk nl bi translated"><strong class="mc jd">SaaS</strong>——甚至有一个SaaS节点的集合，当你想显示你的架构有通知在Slack之类的地方着陆时，它会派上用场。</li></ul><h1 id="8566" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">图表概念</h1><p id="54ec" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><strong class="mc jd">图表</strong> —图表是表示图表的主要对象。</p><p id="0298" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">节点</strong>——代表单个系统组件的抽象概念。</p><p id="da07" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">集群</strong> —允许您将节点组织成组(或集群)，而不是孤立的组件。</p><p id="28a5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">边</strong> —表示节点之间的链接。</p><h1 id="4a81" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">你的第一张图</h1><p id="d9e4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在你已经知道了基本概念，让我们按照我们学习这些概念的顺序，用代码构建一个极其简单的图表。我们将构建的示例图将是一个简单的AWS负载平衡网站，它使用PostgreSQL数据库和Redis缓存，因此我们可以使用多个组件提供者。</p><h2 id="f2ff" class="nr lj it bd lk ns nt dn lo nu nv dp ls mj nw nx lu mn ny nz lw mr oa ob ly iz bi translated">步骤1:创建图表工作空间</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="aebf" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这将简单地呈现一个带有指定标签的空白图，如下所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/bdf7068db3a973ef40153d2b27a5647d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*xz3LKC4voG3VS53tiO4Jlg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用gist链接的代码<a class="ae lh" href="https://gist.github.com/dd48a8d3cb7dc581d976329208c1c422.git" rel="noopener ugc nofollow" target="_blank">在这里</a>构建。</p></figure><h2 id="d624" class="nr lj it bd lk ns nt dn lo nu nv dp ls mj nw nx lu mn ny nz lw mr oa ob ly iz bi translated">步骤2:添加节点</h2><p id="887f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在我们有了工作空间，是时候添加我们网站需要的节点了。我们要添加的节点来自两个不同的提供者。AWS和OnPrem提供程序。如果你真的这样做，你可能会坚持使用AWS，因为他们有RDS和ElastiCache等产品，你可能会与云提供商一起使用。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="a986" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如您所见，我们不再有空白图表。我们的每一个节点都被描绘出来，这些是我们想要构建的架构的“成分”。接下来的步骤是将我们的一些节点组织成逻辑分组，然后用边连接每个节点。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/63fb4f86b4a63e2485aa20d9ff68de48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Fm-jBM57ZIKCwsMc2KVZYg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用链接到这里的<a class="ae lh" href="https://gist.github.com/dd48a8d3cb7dc581d976329208c1c422.git" rel="noopener ugc nofollow" target="_blank">要点中的代码构建。</a></p></figure><h2 id="d873" class="nr lj it bd lk ns nt dn lo nu nv dp ls mj nw nx lu mn ny nz lw mr oa ob ly iz bi translated">步骤3:对节点进行分组(可选)</h2><p id="339e" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在本例中，我们将只对负载平衡的web服务器进行分组。在我过去创建的许多图表中，这并不总是必要的，但是随着您的体系结构的增长，将这些节点分组到集群中通常会增强可读性。</p><p id="317d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">下面您可以看到，要做到这一点，我们只需要将节点的实例化移动到我们正在创建的集群的范围内。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="c28d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如您所见，该图仍然只是一个节点列表，但是我们现在已经将适当的节点聚集到逻辑分组中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/11a530c00c64576028d2d480cf943f44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*KGSnj6mtXSi8YzyarTljlg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用链接到<a class="ae lh" href="https://gist.github.com/dd48a8d3cb7dc581d976329208c1c422.git" rel="noopener ugc nofollow" target="_blank">这里</a>的要点中的代码构建。</p></figure><h2 id="3094" class="nr lj it bd lk ns nt dn lo nu nv dp ls mj nw nx lu mn ny nz lw mr oa ob ly iz bi translated">第四步:将所有内容联系在一起</h2><p id="75d6" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在最后一步中，我们将不会链接我们刚刚安排在我们的体系结构中使用的节点。当我需要更新或者调整一个架构的时候，这个任务花费了我最长的时间。如果你看一下下面，它只是一个用双箭头定义流向每个节点的问题，你就完成了！在这个例子中，我们将只链接没有标签的节点，但是如果你看一下文档，将标签应用到你的链接是一个非常简单的任务。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="1677" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">生成的图像如下所示，您现在可以看到图中每个节点之间的逻辑流。通过更改定义节点的顺序，可以反转此流程。除了调整流程，你还可以改变很多东西，因为一个边缘对象包含三个属性:标签、颜色和样式。我们将不会涵盖如何在这里柚木这些。如果您有兴趣了解更多信息，本文末尾提供了文档链接，这些属性反映了相应的graphviz edge属性，如果您过去使用过该工具，这将使事情变得更容易。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/d6f034516dbdc383239cca0626cf2f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mNVtDcYpcDR6JbTRJuojLA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用链接到<a class="ae lh" href="https://gist.github.com/dd48a8d3cb7dc581d976329208c1c422.git" rel="noopener ugc nofollow" target="_blank">这里</a>的要点中的代码构建。</p></figure><h1 id="e99e" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">结论</h1><p id="20ba" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在你已经开始用代码构建一个漂亮的图表，当涉及到自动化的可能性时，利用这个工作流有很大的潜力，并且节省了架构图的一般维护的时间。</p><p id="0f18" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">使用这个工具节省的时间会让我在将来使用这个方法。我当然不会错过手动调整图表、小心地将组件和箭头与我的架构的每一次迭代对齐所付出的努力。</p><p id="022a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我希望我钻研用代码构建图的经历是有趣的，并且对您未来的绘图工作可能有用。感谢阅读！</p><h1 id="6731" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">资源</h1><ul class=""><li id="5f8b" class="nd ne it mc b md me mg mh mj og mn oh mr oi mv ni nj nk nl bi translated"><a class="ae lh" href="https://diagrams.mingrammer.com/" rel="noopener ugc nofollow" target="_blank">图表文档</a></li><li id="7045" class="nd ne it mc b md nm mg nn mj no mn np mr nq mv ni nj nk nl bi translated"><a class="ae lh" href="https://github.com/mingrammer/diagrams" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></li><li id="c518" class="nd ne it mc b md nm mg nn mj no mn np mr nq mv ni nj nk nl bi translated"><a class="ae lh" href="https://colab.research.google.com/drive/10Nq0KmjbgvAzcaLiqQPwMeDVdkHBCy6y" rel="noopener ugc nofollow" target="_blank">带有示例的Google Colab】</a></li></ul></div></div>    
</body>
</html>