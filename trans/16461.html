<html>
<head>
<title>How to Select Time Series DB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何选择时间序列数据库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-select-time-series-db-123b0eb4ab82?source=collection_archive---------23-----------------------#2020-11-13">https://towardsdatascience.com/how-to-select-time-series-db-123b0eb4ab82?source=collection_archive---------23-----------------------#2020-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4ecb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">物联网分析第3部分:时间序列引擎的比较</h2></div><h1 id="62a8" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="b8c3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一般来说，时间序列用例，尤其是物联网领域，增长如此之快，因此为每个特定用例选择正确的存储至关重要。</p><p id="b64f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如今，所有其他数据库引擎或平台都是以面向时间序列的方式销售的，所以让我们试着更深入地了解一下，找出哪一个最适合每个特定的需求。</p><h1 id="1134" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">问题陈述</h1><p id="9de4" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了正式确定引擎选择，让我们明确定义成功的输入和标准。作为一个<strong class="lc iu">输入</strong>，让我们考虑一个<strong class="lc iu">遥测数据集。</strong></p><p id="02a6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">作为<strong class="lc iu">成功的标准</strong>，我们有:</p><ul class=""><li id="0db7" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><strong class="lc iu">功能需求的覆盖范围</strong>与不同级别的数据查询/分析相关</li><li id="e80d" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">非功能需求</strong>的覆盖范围</li></ul><p id="af47" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们更具体地定义它们。</p><h2 id="6bb9" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">遥测数据集</h2><p id="b599" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">作为物联网数据分析系列文章的继续，让我们使用健身追踪器用例，它很好地代表了典型的物联网用例。数据集(也称为<a class="ae nb" href="https://medium.com/swlh/iot-data-analytics-part1-types-of-storages-677b8a24657d" rel="noopener">这里的</a>和<a class="ae nb" rel="noopener" target="_blank" href="/iot-data-analytics-part-2-data-model-3da9676cb449">这里的</a>)由一组观察值组成，每个观察值包含:</p><ul class=""><li id="a9f2" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">由传感器/边缘生成的<strong class="lc iu">度量名称</strong>，<em class="nc">即:</em> <em class="nc">心率、心率、步数</em></li><li id="9351" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">与<strong class="lc iu">时间点</strong>、<em class="nc">绑定的传感器产生的<strong class="lc iu">度量值</strong>，即:(2020–11–12 17:14:07，71bpm)、(2020–11–12 17:14:32，93bpm)等</em></li><li id="a1d2" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">标签或上下文</strong>或<strong class="lc iu">描述</strong>其中给定传感器正在生成数据，<em class="nc">即:设备型号、地理位置、用户、活动类型等</em>。</li></ul><h1 id="4c38" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">功能需求</h1><p id="0a6e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">围绕数据分析有许多不同的可能性，所以让我们将它们分为初级、中级和高级。</p><h2 id="caed" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">基本级别:简单的数据检索</h2><ul class=""><li id="d6f7" class="mb mc it lc b ld le lg lh lj nd ln ne lr nf lv mg mh mi mj bi translated"><strong class="lc iu">随机数据访问:</strong>为特定时间点返回适当的度量值</li><li id="ca90" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">小范围扫描:</strong>对于特定的时间范围(相当小，根据数据生成的频率，在几分钟或几小时内)返回连续的度量值(即:在其上绘制标准图表)</li></ul><h2 id="bdb5" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">中级:时间窗归一化</h2><p id="7052" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">测量事件通常应该在预定义的重复基础上触发，但是数据点定时总是存在偏差。这就是为什么非常需要围绕构建预定义的时间窗口来标准化时间序列数据的能力。</p><p id="2be1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">所需的能力包括:</p><ul class=""><li id="200f" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><strong class="lc iu">构建时间段</strong>以正确标准化数据</li><li id="2a9f" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">标准化时段上的聚合</strong></li><li id="2150" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">间隙填充</strong>，使用<strong class="lc iu">插值</strong>在一组离散的已知数据点范围内构建新的数据点。</li></ul><p id="aea8" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">对于中级容量，值得添加更复杂的诊断分析/特别查询:</p><ul class=""><li id="b7f7" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><strong class="lc iu">灵活过滤:</strong>根据标签/上下文属性上的谓词过滤数据点，<em class="nc">即:根据某个区域、用户或活动类型过滤数据点</em></li><li id="27a6" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">灵活聚合:</strong>标签/上下文属性或其组合上的分组和聚合<em class="nc">，即:按活动类型按区域的最大炉膛率。</em></li></ul><h2 id="dc4a" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">高级级别:顺序行模式匹配</h2><p id="855b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最高级将包括检查<strong class="lc iu">事件序列</strong> <strong class="lc iu">是否与</strong>特定<strong class="lc iu">模式</strong>匹配，以执行自检和高级诊断:</p><ul class=""><li id="b348" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">在特定事件之前有相似的测量模式吗？；</li><li id="417c" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">什么样的测量可能表明某个事件的原因，例如失败？</li></ul><p id="767a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">到目前为止，很少有数据库支持这样的特性，但是我相信它们会出现的。</p><p id="fd7e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在这里，我们可以区分以下能力:</p><ul class=""><li id="65ae" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">找到一系列连续事件，即:会话定义</li><li id="027e" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">模式匹配</strong>:趋势反转，周期性事件</li></ul><h1 id="47b8" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">非功能性需求</h1><p id="cc85" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">除了功能性需求之外，考虑非功能性需求也非常重要，这些需求通常是选择的主要驱动因素:</p><ul class=""><li id="d211" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><strong class="lc iu">可扩展存储:</strong>处理大数据量的能力</li><li id="1e8c" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">可扩展写入:</strong>处理大量并发写入的能力。这与实时数据访问密切相关，即在数据点生成和可供读取之间尽可能缩短延迟的能力。</li><li id="a57a" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">可伸缩读取:</strong>处理大量并发读取的能力</li><li id="e3f8" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">高成熟度:</strong>在市场上的存在和社区支持。</li></ul><h1 id="b717" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">市场上的时间序列数据库和平台</h1><p id="cb73" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们回顾一下市场上有什么可以满足我们的严格需求。有多种选择。这真的很难涵盖所有这些，所以我将尝试描述发动机家族。</p><h2 id="3192" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">带有内置分类功能的NoSQL <strong class="ak"/></h2><p id="f790" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">BigTable、HBase、Cassandra、DynamoDB、Accumulo常用于存储时序数据。有大量关于如何在这些存储上实现时序用例的文章；如何避免热点使用盐等？</p><blockquote class="ng nh ni"><p id="288d" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">优势:</strong>非常适合写入。极其高效地执行基本级别的分析。</p><p id="cff6" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">弱势:</strong>所有其他类型的分析都不受支持且效率低下</p></blockquote><h2 id="de2c" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">NoSQL特制时间序列数据库</h2><p id="98e2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">有一些引擎是作为时间序列数据库从头开始设计的。在大多数情况下，他们是NoSQL。最突出的例子是<strong class="lc iu"> InfluxDB </strong>，它位于所有谷歌搜索的首位。</p><h2 id="6779" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">基于时序类固醇的MPP SQL引擎</h2><p id="a15d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一些成熟的MPP分析引擎，如<strong class="lc iu"> Vertica </strong>不断增加新的分析功能，包括与时间序列数据处理相关的功能。但缺点是，从设计上来说，它们不是为高效的流数据摄取而创建的。但是如果微批处理是可接受的，它们可能是许多用例的最佳匹配。</p><blockquote class="ng nh ni"><p id="dadf" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">优势:</strong>提供最大的分析能力。</p><p id="11b2" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">弱方:</strong>实时摄取可能很有挑战性，而且效率不高</p></blockquote><p id="f1df" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><em class="nc">注意:Oracle不是传统的MPP，但是从功能的角度来看，它支持MATCH_RECOGNIZE子句，该子句涵盖了复杂的模式匹配特性</em></p><h2 id="621a" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">内存数据库</h2><p id="1732" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">SQL数据库的内存特性提高了它们处理快速数据接收的能力。由时段规范化支持丰富的SQL接口，如<strong class="lc iu"> SingleStore MemSQL </strong>数据库对于时间序列用例来说看起来非常有吸引力</p><blockquote class="ng nh ni"><p id="94ff" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">优势:</strong>提供触达分析能力。</p><p id="504d" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">弱势:</strong>读写的可伸缩性通常有限或者非常昂贵</p></blockquote><h2 id="ddd0" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">云时序平台</h2><p id="a4e0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Azure和AWS最近发布了他们的时序数据服务/平台:</p><ul class=""><li id="6dbd" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated"><strong class="lc iu"> Azure时序洞察</strong></li><li id="167f" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated"><strong class="lc iu">亚马逊时光流</strong></li></ul><p id="0861" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这些平台涵盖了时间序列数据存储、可视化和查询功能的许多方面。它们内置了热存储、热存储和冷存储之间的数据分离，从拥有成本的角度来看，可以很好地平衡数据存储和检索。</p><blockquote class="ng nh ni"><p id="6876" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">优势:</strong>很好地集成到适当的云基础设施中，提供了范围查询功能以及</p><p id="b651" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">弱点:</strong>对于某些用例来说，紧密的云集成可能是一个限制；在市场上出现的时间还太短，不能把它们当作成熟的产品。</p></blockquote><h2 id="3f90" class="mp kj it bd kk mq mr dn ko ms mt dp ks lj mu mv ku ln mw mx kw lr my mz ky na bi translated">其他人</h2><p id="04c5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">也有其他选择和小众玩家。我有机会使用一个叫做<strong class="lc iu"> GeoMesa </strong>平台/框架的例子。这是一个基于Accumulo/Hbase/Cassandra等NoSQL存储的框架，能够为时态和地理时态数据建立特殊索引；它还通过二级索引提供了额外的灵活性。</p><blockquote class="ng nh ni"><p id="5dfa" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">优势:</strong>高效的基本时序分析以及良好的缩放水平。地理时态查询支持是一项关键功能，也是物联网数据的一大优势。</p><p id="a239" class="la lb nc lc b ld lw ju lf lg lx jx li nj ly ll lm nk lz lp lq nl ma lt lu lv im bi translated"><strong class="lc iu">弱势:</strong>尽管开发社区非常友好且响应迅速，但它的采用率和成熟度都很低。</p></blockquote><h1 id="3ff5" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">汇总比较</h1><p id="b5d9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">请使用我们在下面开头定义的标准来查找不同时间序列存储的高级比较:</p><figure class="nn no np nq gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi nm"><img src="../Images/e3da7f980699cb19ada037e3b1e8b45e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFs1ggu-LA4X2LiZbqeUIQ.png"/></div></div></figure><p id="dcc6" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">哪里</strong></p><figure class="nn no np nq gt nr gh gi paragraph-image"><div role="button" tabindex="0" class="ns nt di nu bf nv"><div class="gh gi ny"><img src="../Images/5ecc249c2be9ee13b1a6b05dbaec22e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgNjWCCXA_S618YW1bczIQ.png"/></div></div><p class="nz oa gj gh gi ob oc bd b be z dk translated">作者图片</p></figure><h1 id="7326" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="ebaf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这个主题非常广泛，值得一本书来详细介绍，但是我希望这篇文章能够帮助您在时序引擎世界中导航，并帮助您为您的特定用例选择正确的方向。</p></div></div>    
</body>
</html>