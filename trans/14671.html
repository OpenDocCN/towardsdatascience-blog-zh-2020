<html>
<head>
<title>Data Carpentry for Electronic Medical Records (I)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电子病历的数据木工(一)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-carpentry-for-electronic-medical-records-cb3aba015df4?source=collection_archive---------46-----------------------#2020-10-09">https://towardsdatascience.com/data-carpentry-for-electronic-medical-records-cb3aba015df4?source=collection_archive---------46-----------------------#2020-10-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6d12" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第一部分:数据的形状</h2></div></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><p id="fc6b" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><em class="li">电子病历(EMR)中的数据可能很复杂，难以浏览。这一系列文章是为那些希望理解数据分析师做什么并交流他们对数据操作和分析的意图的临床医生而写的。</em></p><h1 id="3e36" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">我们希望数据是什么样的</h1><p id="a2bd" class="pw-post-body-paragraph km kn iq ko b kp mb jr kr ks mc ju ku kv md kx ky kz me lb lc ld mf lf lg lh ij bi translated">大多数临床医生都熟悉平面数据。这是一种数据在二维表中的格式，通常每行一个患者，每个属性一列(如患者年龄、实验室值、出院日期)。数据分析师也可能将此描述为整洁的数据。<em class="li">然而，电子病历数据很少像这样结构化！</em></p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/9f2f83fa9a9668f15c0b5a945e91091d.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*OQ0xE6YyWfXOAkur_5k_3w.png"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">平面数据:临床医生通常想要什么(图片由作者提供)</p></figure><p id="e7fb" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">患者生成的大多数数据都是通过多个非周期性事件产生的。我们需要考虑如何在数据库中表示它们。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/af909925d14e70b4cd91cdb38daed3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdVhjVyViewjeP8uC7Yx9Q.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">患者时间表示例(图片由作者提供)</p></figure><h1 id="e3e4" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">真实的数据是什么样的</h1><p id="644f" class="pw-post-body-paragraph km kn iq ko b kp mb jr kr ks mc ju ku kv md kx ky kz me lb lc ld mf lf lg lh ij bi translated">数据库通常以<strong class="ko ir">【长】</strong>格式表示数据。在长表格中，变量的每个<em class="li">观察值</em>都有一行。一个变量可以在不同时间进行多次观察(如系列肌钙蛋白)。因此，每个变量可能不止一行，每个患者也可能不止一行。表格之所以“长”,是因为通常行数比列数多。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/9cb13dab790ec263f5358bc9d4ae7591.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*UzO1enBBPWdeYiRnmx986w.png"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">一张长桌(图片由作者提供)</p></figure><p id="db2e" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">长表格通常被转换成<strong class="ko ir">‘宽’</strong>格式。数据集中的每个<em class="li">患者</em>都有一行。该表有多列，代表不同时间点的变量测量值。它“宽”是因为列比行多。这个过程被称为<strong class="ko ir">旋转</strong>，因为数据被翻转到它的一侧。我们可以理解宽格式几乎就像一条时间线。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0b9846b225469dfdf067b1d25258c704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*fLNjurRCg3p7UeoOLG6rGg.png"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">宽桌子——由上面的长桌子改造而成(图片由作者提供)</p></figure><p id="2854" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">您可能会注意到，宽表中有许多单元格包含空值。空值是空白。这是不定期临床测量的反映，对于每个患者，临床测量不会在完全相同的时间发生。您可能想知道为什么EMR数据库不像这样存储数据——这是因为这种结构要求每个时间点都有一个新列，但是该列中的许多值都是空值。就存储而言，这将是非常低效的！</p><p id="432d" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这个表还不够整洁，因为每个变量下有多列。这由两级列标签表示。为了使数据集整洁，我们需要将每个变量折叠成一列。</p><h1 id="099c" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">划界和聚合</h1><p id="f3db" class="pw-post-body-paragraph km kn iq ko b kp mb jr kr ks mc ju ku kv md kx ky kz me lb lc ld mf lf lg lh ij bi translated">要折叠每个变量下的列，我们必须<strong class="ko ir">划定</strong>相关的时间段，然后<strong class="ko ir">汇总</strong>该时间段内的观察值。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/d6e09bd83808cca501f68b4df6881bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*QqxhoM6gTjksXjdj2d5c2Q.png"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">在ICU入院开始和结束之间(定界)，平均毛细血管血糖(总量)<em class="na">(图片由作者提供)</em></p></figure><p id="438c" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">界定可确保我们排除与研究无关的时间段。例如，如果我们对一个病人的ICU入院感兴趣，我们应该划定入院的开始和结束日期。</p><p id="882f" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">聚合是接受几个值，输出一个值的任何规则。医学中常见的聚合规则包括寻找平均值、中值、最大值或最小值以及第一个或最后一个值。</p><p id="a41a" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在上面的示例中，我们可能指定了时间1到时间2的界限，并使用平均值进行了聚合。请注意，Var 3具有空值，因为从时间1到时间2没有相关的观察值。这给了我们一个整洁的表格——每个病人一行，每个变量一列！</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/82599868a96524e1136f735f260a32de.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*F1vpJnY2i5dDNZIVUCeVlg.png"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">整洁的桌子(图片由作者提供)</p></figure><h1 id="2d77" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">注意:为什么划定一个范围很重要？</h1><p id="c659" class="pw-post-body-paragraph km kn iq ko b kp mb jr kr ks mc ju ku kv md kx ky kz me lb lc ld mf lf lg lh ij bi translated">当我们想到一个离散事件时，很容易直接指定一个集合(例如，在入住ICU之前测量的“最后”肌酐值)。这可能适用于大多数情况，但我们应该小心——如果患者在一年前有“最后”数值(例如，患者从A&amp;E直接入住ICU，入住时尚未报告实验室)，该怎么办？强烈建议定界以获得有效和一致的结果！</p><p id="73ae" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><em class="li">在这篇文章中，我们了解了电子医疗记录数据是如何构建的，以及我们如何让它变得整洁——从长到宽，通过定界和聚合。请继续关注电子病历数据木工的更多内容！</em></p></div></div>    
</body>
</html>