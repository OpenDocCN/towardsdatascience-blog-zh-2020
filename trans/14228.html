<html>
<head>
<title>Visualizing Word Embedding with PCA and t-SNE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于主成分分析和t-SNE的可视化单词嵌入</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-word-embedding-with-pca-and-t-sne-961a692509f5?source=collection_archive---------3-----------------------#2020-10-01">https://towardsdatascience.com/visualizing-word-embedding-with-pca-and-t-sne-961a692509f5?source=collection_archive---------3-----------------------#2020-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="68b6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="9e07" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在2D或3D中创建单词嵌入的交互式可视化</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/80a541286306f26a04fbfe5e611f7561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yAXnKd6fnTeAwPtFv4zHPA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@francesco_ungaro?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">弗朗西斯科·温加罗</a>在<a class="ae lh" href="https://unsplash.com/s/photos/letter-word?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="8990" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当你听到<em class="me">‘茶’</em>和<em class="me">‘咖啡’</em>这两个词，你会怎么想？大概你会说它们都是饮料，都含有一定量的咖啡因。关键是，我们可以很容易地识别出这两个词是相互关联的。然而，当我们向计算机提供单词<em class="me">‘茶’</em>和<em class="me">‘咖啡’</em>时，它无法像我们一样识别这两个单词之间的关联。</p><p id="f065" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Word不是计算机会自然理解的东西。为了让计算机理解单词背后的含义，需要将单词编码成数字形式。这就是单词嵌入背后的技术有用的地方。</p><p id="6935" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">单词嵌入是自然语言处理中常用的一种技术，用于将单词转换成向量形式的数值。这些向量将占据一定维数的嵌入空间。</p><p id="a593" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果两个单词具有相似的上下文，如<em class="me">‘茶’</em>和<em class="me">‘咖啡’</em>那样，那么这两个单词在嵌入空间中的距离将会彼此接近，而与具有不同上下文的其他单词的距离将会更远。</p><p id="5d0c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将一步一步地向你展示如何可视化单词嵌入。由于本文的重点不是详细解释单词embedding背后的基本理论，您可以在本文和<a class="ae lh" rel="noopener" target="_blank" href="/introduction-to-word-embeddings-4cf857b12edc">中阅读更多关于理论</a><a class="ae lh" rel="noopener" target="_blank" href="/why-do-we-use-embeddings-in-nlp-2f20e1b632d2">的内容。</a></p><p id="c3a4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了可视化单词嵌入，我们将使用常见的降维技术，如PCA和t-SNE。为了将单词映射到它们在嵌入空间中的向量表示，将实现预先训练的单词嵌入手套。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="b87d" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">加载预先训练的单词嵌入模型</h1><p id="b921" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">在可视化单词嵌入之前，通常我们需要首先训练模型。然而，训练单词嵌入在计算上是非常昂贵的。因此，通常使用预先训练的单词嵌入模型来代替。它包含嵌入空间中的记号及其相关向量表示。</p><p id="cc18" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">除了Google开发的word2vec之外，GloVe是一个由斯坦福研究人员开发的流行的预训练单词嵌入模型。本文实现了GloVe预训练单词嵌入，你可以在这里下载<a class="ae lh" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">。同时，我们可以使用Gensim库来加载预先训练好的单词嵌入模型。您可以使用pip命令安装该库，如下所示。</a></p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="7a57" class="no mn it nk b gy np nq l nr ns">pip install gensim</span></pre><p id="dfa4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作为第一步，我们需要将GloVe文件格式转换为word2vec文件格式。使用word2vec文件格式，我们可以使用Gensim库将预先训练好的单词嵌入模型加载到内存中。由于每次调用该命令时，文件加载都会花费一些时间，因此如果我们使用一个单独的Python文件来实现这个目的，效果会更好。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="f181" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">创建输入单词并生成相似的单词</h1><p id="eeac" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">现在我们有了一个Python文件来加载预训练的模型，接下来我们可以在另一个Python文件中调用它，根据输入的单词生成最相似的单词。根据您的喜好，输入的单词可以是任何单词。</p><p id="2167" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我们键入输入的单词后，下一件事就是创建一个代码来读取它。然后，我们需要根据模型将生成的每个输入单词指定相似单词的数量。最后，我们将相似单词的结果存储在一个列表中。下面是实现这一目的的代码。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7c5f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，假设我们想要找出与<em class="me">“学校”</em>相关的5个最相似的单词。因此，<em class="me">‘学校’</em>将是我们的输入单词。使用上面的代码，我们将得到单词<em class="me">、</em>、<em class="me">、【学校】、<em class="me">、【小学】、<em class="me">、【学生】、</em>和<em class="me">、【学生】、</em>作为结果。</em></em></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="7612" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">用主成分分析可视化单词嵌入</h1><p id="fb1d" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">到目前为止，我们已经有了输入单词和基于它生成的相似单词。接下来，是时候让我们在嵌入空间中可视化它们了。</p><p id="5a3b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有了预训练的模型，每个单词现在可以用它的向量表示法映射到嵌入空间。然而，单词嵌入具有非常高的维数，这意味着不可能可视化单词如何占据嵌入空间。</p><p id="ef25" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">通常实现诸如主成分分析(PCA)的方法来降低单词嵌入的维度。简而言之，PCA是一种特征提取技术，它结合变量，然后丢弃最不重要的变量，同时仍然保留变量中有价值的部分。如果你想深入研究PCA，我推荐<a class="ae lh" rel="noopener" target="_blank" href="/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c">这篇文章</a>。</p><p id="7498" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用PCA，我们可以在2D或3D中可视化单词嵌入。因此，让我们使用我们在上面的代码块中调用的模型创建代码来可视化单词嵌入。在下面的代码中，只显示了3D可视化。为了使2D的认证后活动形象化，只需稍加改动。您可以在代码的注释部分找到需要更改的部分。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="6797" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">例如，假设我们想要可视化与<em class="me">、【球】、<em class="me">、【学校】、<em class="me">、【食物】、</em>相关联的前5个最相似的单词。使用我们到目前为止创建的代码，下面是2D的可视化示例。</em></em></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/2a49c1d6c8af0eaa2837a0daf4122cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_gwJa1g_DCi3AehkXYCjQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于主成分分析的2D词嵌入可视化</p></figure><p id="f548" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是同样一组单词的三维可视化。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/065a007512c31c11bafeffe5753e23fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzXwhDnDmu60OHyEFGnF-Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于主成分分析的三维单词嵌入可视化</p></figure><p id="6130" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">从可视化中，现在我们可以看到这些单词所占空间的模式。与<em class="me">‘ball’</em>相关联的单词被放置得彼此靠近，因为它们具有相似的上下文。同时，它们和与<em class="me">【学校】</em><em class="me">【食物】</em>相关的词之间的距离更远，因为它们有不同的上下文。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="09f0" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">用t-SNE可视化单词嵌入</h1><p id="b383" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">除了PCA之外，另一种常用的降维技术是t分布随机邻居嵌入或t-SNE。主成分分析和t-SNE之间的区别是它们都实现了降低维数的基本技术。</p><p id="89fc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">PCA是一种线性降维方法。高维空间中的数据被线性映射到低维空间，同时最大化数据的方差。同时，t-SNE是一种非线性降维方法。利用t-SNE，该算法计算高维空间和低维空间的相似度。接下来，使用优化方法，例如梯度下降方法，最小化两个空间中的相似性差异。</p><p id="2677" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">使用t-SNE可视化单词嵌入的代码与使用PCA的代码非常相似。在下面的代码中，只显示了3D可视化。为了使2D的SNE霸王龙形象化，只需要做一些小的改动。您可以在代码的注释部分找到需要更改的部分。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="c820" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于与PCA可视化中相同的例子，即与<em class="me">‘球’</em>、<em class="me">‘学校’</em>和<em class="me">‘食物’</em>相关联的前5个最相似单词的可视化，下面是在2D的可视化结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/f34b0ccd5c1edd171401ed89568b4ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gfcIS9W5z6eZ_PdIEnBYQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于t-SNE的2D单词嵌入可视化</p></figure><p id="1030" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是同样一组单词的三维可视化。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/8905b465ed3ff497801a4f36509e7977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWwsXa36ugemh9YMcLdV9w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基于t-SNE的三维单词嵌入可视化</p></figure><p id="62c2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与主成分分析的方法相同，注意如何将具有相似上下文的单词放在彼此靠近的位置，而将具有不同上下文的单词放在较远的位置。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="70f3" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">创建一个Web应用程序来可视化单词嵌入</h1><p id="09b3" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">到目前为止，我们已经成功地创建了一个Python脚本，使用PCA或t-SNE在2D或3D中可视化单词嵌入。接下来，我们可以创建一个Python脚本来构建一个web应用程序，以获得更好的用户体验。</p><p id="fee4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">web应用程序使我们能够通过许多功能和交互性来可视化单词嵌入。例如，用户可以键入他们自己的输入单词，并且他们还可以选择与将被返回的每个输入单词相关联的前n个最相似的单词。</p><p id="42a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">可以使用Dash或Streamlit创建web应用程序。在本文中，我将向您展示如何构建一个简单的交互式web应用程序，用Streamlit可视化单词嵌入。</p><p id="dd52" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，我们将使用我们之前创建的所有Python代码，并将它们放入一个Python脚本中。接下来，我们可以开始创建如下几个用户输入参数:</p><ul class=""><li id="5dad" class="nx ny it lk b ll lm lo lp lr nz lv oa lz ob md oc od oe of bi translated">降维技术，用户可以选择是应用PCA还是t-SNE。因为只有两个选项，所以我们可以使用Streamlit的<code class="fe og oh oi nk b">selectbox </code>属性。</li><li id="2793" class="nx ny it lk b ll oj lo ok lr ol lv om lz on md oc od oe of bi translated">可视化的维度，其中用户有一个选项，他们是否希望在2D或3D中可视化单词嵌入。和以前一样，我们可以使用<code class="fe og oh oi nk b">selectbox </code>属性。</li><li id="3d3b" class="nx ny it lk b ll oj lo ok lr ol lv om lz on md oc od oe of bi translated">输入单词。这是一个用户输入参数，要求用户键入他们想要的输入单词，例如<em class="me">‘球’</em>、<em class="me">‘学校’</em>和<em class="me">‘食物’</em>。因此，我们可以使用<code class="fe og oh oi nk b">text_input </code>属性。</li><li id="7c3d" class="nx ny it lk b ll oj lo ok lr ol lv om lz on md oc od oe of bi translated">前n个最相似的单词，其中用户需要指定将返回多少个与每个输入单词相关联的相似单词。由于我们可以选择任何数字，那么<code class="fe og oh oi nk b">slider </code>属性将是最好的选择。</li></ul><p id="a781" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，我们需要考虑在我们决定使用SNE霸王龙时会出现的参数。在t-SNE中，我们可以调整一些参数来获得最佳的可视化结果。这些参数是困惑度、学习率和优化迭代次数。在每种情况下，这些参数都没有单一的最佳值，因此最好的解决方案是让用户指定这些值。</p><p id="cfb0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于我们使用的是Scikit-learn，我们可以参考文档<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" rel="noopener ugc nofollow" target="_blank">来找出这些参数的默认值。困惑的默认值是30，但是我们可以在5到50之间调整这个值。学习率的默认值是300，但是我们可以在10到1000之间调整这个值。最后，迭代次数的默认值是1000，但是我们可以将这个值调整为250。我们可以使用<code class="fe og oh oi nk b">slider </code>属性来创建这些参数值。</a></p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e4e4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们已经涵盖了构建web应用程序的所有必要部分。最后，我们可以将所有的东西打包成一个完整的脚本，如下所示。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="aab8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您现在可以使用Conda提示符运行web应用程序。在提示符下，转到Python脚本的目录，然后输入以下命令:</p><pre class="ks kt ku kv gt nj nk nl nm aw nn bi"><span id="b7ff" class="no mn it nk b gy np nq l nr ns">$ streamlit run your_script_name.py</span></pre><p id="f820" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，会自动弹出一个浏览器窗口，您可以在这里本地访问您的web应用程序。下面是您可以使用web应用程序做些什么的快照。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/05a281f77c0f4e2274b1053597655919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*57jX83MmXSUbmVakuq95EA.gif"/></div></figure><p id="1af8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这样！您已经创建了一个简单的web应用程序，它具有很多交互性，可以用PCA或t-SNE可视化单词嵌入。</p><p id="e22d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你想看这个单词嵌入可视化的完整代码，可以在我的GitHub页面<a class="ae lh" href="https://github.com/marcellusruben/Word_Embedding_Visualization" rel="noopener ugc nofollow" target="_blank">这里</a>访问。</p></div></div>    
</body>
</html>