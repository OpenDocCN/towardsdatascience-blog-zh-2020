<html>
<head>
<title>From CityGML 3D City Model to 3D Web Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从CityGML三维城市模型到三维网络应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-citygml-3d-city-model-to-3d-web-application-829eb8e90514?source=collection_archive---------20-----------------------#2020-11-05">https://towardsdatascience.com/from-citygml-3d-city-model-to-3d-web-application-829eb8e90514?source=collection_archive---------20-----------------------#2020-11-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="fe58" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="90da" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">在Web应用程序上可视化CityGML的分步指南——荷兰海牙市的一个示例区域。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/813daa626d2cdab085b79fc4f2995455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OsGDE8vZG1EWeEBF.JPG"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">本教程的预期输出截图——在海牙地区使用3D语义建筑模型的3D网络应用</strong>(作者)</p></figure><p id="ab2d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated"><span class="l mf mg mh bm mi mj mk ml mm di">基于虚拟地球的3D可视化最新技术是一个独特的机会，可以促进各种应用领域的高级分析和可视化任务，如城市规划、室内/室外步行导航、环境模拟、文化遗产或设施管理。让这个概念成为现实的一个核心数据是由开放地理空间联盟(https://www.ogc.org/ OGC—<a class="ae mn" href="https://www.ogc.org/" rel="noopener ugc nofollow" target="_blank"/>)开发的CityGML模型。CityGML是用于描述3D地理空间化城市模型的全球数据模型模式。公开提供开源CityGML模型的城市越来越多。</span></p><p id="f674" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本文将指导您如何基于这些CityGML 3D城市模型数据集使用CesiumJS创建交互式3D web地图。本指南材料最初是(由作者)特别为2020年荷兰大地测量和地理信息中心(NCG) <a class="ae mn" href="https://ncgeo.nl/index.php/en/actueelgb/nieuwsgb/item/2814-ncg-symposium-2020" rel="noopener ugc nofollow" target="_blank">研讨会</a>的<a class="ae mn" href="https://pengdlzn.github.io/events/interactive-online-maps/" rel="noopener ugc nofollow" target="_blank">研讨会</a>制作的。</p><h1 id="9c02" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">架构和工作流程</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/6e8617539ac76ec97a4d596106062ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwsjwkNNplIs98clGJPdcQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">基于这些CityGML 3D城市模型使用CesiumJS创建交互式3D网络地图的工作流程</strong>(作者)</p></figure><p id="3077" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">3D网络app的整体系统架构如上图所示。它包括四个主要组件:CityGML数据集、3D Tiles数据集、Web服务器和用户。</p><ul class=""><li id="dfed" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated"><strong class="lk jd">组件1) CityGML 3D城市模型</strong></li><li id="49a8" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated"><strong class="lk jd">组件2) 3D瓦片城市模型</strong></li><li id="1bc3" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated"><strong class="lk jd">组件3)网络服务器</strong></li><li id="a35b" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated"><strong class="lk jd">组件4)用户</strong></li></ul><h2 id="78fa" class="nv mp it bd mq nw nx dn mu ny nz dp my lr oa ob na lv oc od nc lz oe of ne iz bi translated">因此，让我们开始一起创建每个组件💻</h2><h1 id="e348" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">组件1) CityGML 3D城市模型</h1><p id="05eb" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">我们可以下载CityGML格式的3D城市模型。在这篇文章中，我选择了海牙地区的3D城市模型，因为它是一个紧凑的模型。</p><ul class=""><li id="248b" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">从下载部分的<a class="ae mn" href="https://denhaag.dataplatform.nl/#/data/36049d1a-4a0f-4c5d-8adb-21dbfb7252f9" rel="noopener ugc nofollow" target="_blank">https://den haag . data platform . nl/#/data/36049 d1a-4a 0f-4c 5d-8 ADB-21 dbfb 7252 F9</a>下载CityGML数据集。</li></ul><p id="b0ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当然，您也可以自由探索其他CityGML数据集。越来越多的城市公开提供数据集，如下文所列:</p><div class="ol om gp gr on oo"><a rel="noopener follow" target="_blank" href="/open-source-3d-semantical-building-models-in-2020-f47c91f6cd97"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd jd gy z fp ot fr fs ou fu fw jc bi translated">2020年开源3D语义建筑模型</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">开源3D城市模型的完整列表(2020年10月更新)</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">towardsdatascience.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc lb oo"/></div></div></a></div><h1 id="a540" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">组件2) 3D瓦片城市模型</h1><p id="7a17" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">为了优化3D web可视化，必须将CityGML转换为3D切片格式。有几种工具可以执行这种转换。在这篇文章中，我们将使用FME，它有一个<a class="ae mn" href="https://www.safe.com/free-fme-licenses/" rel="noopener ugc nofollow" target="_blank">开放免费许可证</a>至少可以免费使用一年，供家庭、研究人员等使用。</p><h2 id="a1f9" class="nv mp it bd mq nw nx dn mu ny nz dp my lr oa ob na lv oc od nc lz oe of ne iz bi translated"><strong class="ak">用FME将CityGML模型转换成3D瓦片</strong></h2><ul class=""><li id="32bd" class="nh ni it lk b ll og lo oh lr pd lv pe lz pf md nm nn no np bi translated">从打开FME工作台开始，将所有CityGML模型拖放到FME窗口。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/e1e1bd91e947ea57a09f83f2cb223c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*grxpkozVZmIqfWS2.JPG"/></div></div></figure><ul class=""><li id="1f90" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">选择输入格式“CityGML”和工作流选项“单一合并要素类型”。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/76e494d4a011558088a5788bbc463557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/0*iei7pgq9uUc83YwC.JPG"/></div></figure><ul class=""><li id="4c2b" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">点击“添加一个新的作家”按钮，并选择格式“铯三维瓷砖”</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/070f2627df24a6d52767511664aa9a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/0*WVO44DNuxmuKTSw3.JPG"/></div></figure><ul class=""><li id="75d5" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">工作流应该如下图所示。单击运行，然后等待转换完成。然后，最终的3D平铺城市模型将位于您输入的目标文件夹中。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/f689e770fba09258800b9e6340e95388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PZFhJD7Z06t09m1Q.JPG"/></div></div></figure><h1 id="c7b3" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">组件3) Web服务器</h1><h2 id="a577" class="nv mp it bd mq nw nx dn mu ny nz dp my lr oa ob na lv oc od nc lz oe of ne iz bi translated">使用CesiumJS库准备3D Web应用程序</h2><p id="72a6" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">在这一步中，我们将使用CesiumJS库创建一个包含3D Web Globe的HTML web文档。你可以使用任何你喜欢的代码空闲或编辑器。我的选择是VS代码。然后，创建一个名为“denHaagApp.html”的文件。您可以使用自己喜欢的名称创建文档，并遵循下面的示例HTML代码。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pk pl l"/></div></figure><ul class=""><li id="d72d" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">CesiumJS查看器(第13行)是构建具有灵活设置的3D globe的主要组件(如本例中的第14到21行)。您可以查看<a class="ae mn" href="https://cesium.com/docs/cesiumjs-ref-doc/Viewer.html" rel="noopener ugc nofollow" target="_blank"> CesiumJS API文档</a>了解更多可用设置。</li><li id="6ad6" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated">3D Tiles数据可以作为tileset加载到CesiumJS查看器中(第23到25行)。不要忘记在第24行指定目标Tileset.json的URL。您可以查看文档<a class="ae mn" href="https://cesium.com/docs/cesiumjs-ref-doc/Viewer.html" rel="noopener ugc nofollow" target="_blank"> CesiumJS API文档</a>了解更多关于3D Tiles数据集的设置。</li></ul><h2 id="c91e" class="nv mp it bd mq nw nx dn mu ny nz dp my lr oa ob na lv oc od nc lz oe of ne iz bi translated">在Web服务器上托管3D Web应用程序</h2><p id="1403" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">这一步，我们将在Web服务器上托管第2步中的Web应用程序和第1步中的3D Tiles城市模型。你可以自由使用任何你喜欢的网络服务器。在这个例子中，我们使用XAMPP开源web服务器。(可以从<a class="ae mn" href="https://www.apachefriends.org/index.html" rel="noopener ugc nofollow" target="_blank">https://www.apachefriends.org/index.html</a>那里得到)</p><ul class=""><li id="0938" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">安装XAMPP。打开XAMPP控制面板并启动APACHE web服务器。或者，您可以通过<em class="pm">C:\ xampp \ Apache \ bin \ httpd . exe手动启动Apache。</em></li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/48be9f750237a796bf332437160d7aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dfg7hr-VNsequ-Vb.JPG"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">用XAMPP控制面板启动Apache web服务器。</strong>(作者)</p></figure><ul class=""><li id="bcfc" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">在macOS和Linux中，您可以使用终端输入以下命令来触发Apache HTTP服务。</li></ul><pre class="ks kt ku kv gt po pp pq pr aw ps bi"><span id="d3d4" class="nv mp it pp b gy pt pu l pv pw"><strong class="pp jd">$ sudo apachectl -k start   </strong>// start Apache<strong class="pp jd"><br/>$ sudo apachectl -k stop    </strong>// stop Apache<strong class="pp jd"><br/>$ sudo apachectl -k restart </strong>// restart Apache</span><span id="5303" class="nv mp it pp b gy px pu l pv pw">or </span><span id="96e4" class="nv mp it pp b gy px pu l pv pw"><strong class="pp jd">$ sudo /usr/sbin/apachectl -k start   </strong>// start Apache<strong class="pp jd"><br/>$ sudo /usr/sbin/apachectl -k stop    </strong>// stop Apache<strong class="pp jd"><br/>$ sudo /usr/sbin/apachectl -k restart </strong>// restart Apache</span></pre><ul class=""><li id="8c7a" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">将最后一节中的web文档(【denHaagApp.html】)和组件2)中的output 3D Tiles city models文件夹放在C:\xampp\htdocs目录中。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi py"><img src="../Images/3e78f2695fb34a0ef77598ac4074ea8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tr5RFN461TzumVKq.JPG"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">复制并粘贴3D瓷砖模型和web文档。</strong>(作者)</p></figure><ul class=""><li id="8e60" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">在HTML web文档中，将URL值更新到<em class="pm"> htdocs </em>文件夹中3D Tiles模型的tileset.json文件。例如，如果您的3D Tiles目录位于C:\ xampp \ htdocs \ 3D tile \ tileset . JSON .您应该将URL值设置为"<em class="pm">。/3dtile/tileset.json </em>"或"<em class="pm">http://localhost/3d tile/tileset . JSON</em>"因为APACHE将为相对于"<em class="pm"> http://localhost </em>"的<em class="pm"> htdocs </em>目录中的所有内容提供服务。</li></ul><h1 id="8a1f" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">组件4)用户</h1><p id="7381" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">前三个组件完成后，我们可以通过Web服务器测试3D Web应用程序。您可以在您的web浏览器上访问您的3D web应用程序可视化3D城市模型，网址为<a class="ae mn" href="http://localhost/denHaagApp.html" rel="noopener ugc nofollow" target="_blank">http://localhost/denhaagapp . html</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/765a926a3222b1cafb239de4f304d5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eOi5FVUXPpYyzCM-.JPG"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">用本地主机测试3D Web App。</strong>(作者)</p></figure><h1 id="1aaf" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">结论</h1><p id="a495" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">本文提供了从CityGML语义3D城市模型创建3D基于web的应用程序的分步教程。该指南首先介绍了CityGML数据模型。然后，引入FME作为从CityGML到3D瓦片格式的转换工具。最终的3D web应用程序由CesiumJS库创建，托管在Apache HTTP web服务器上。</p></div><div class="ab cl pz qa hx qb" role="separator"><span class="qc bw bk qd qe qf"/><span class="qc bw bk qd qe qf"/><span class="qc bw bk qd qe"/></div><div class="im in io ip iq"><h1 id="dd31" class="mo mp it bd mq mr qg mt mu mv qh mx my ki qi kj na kl qj km nc ko qk kp ne nf bi translated">作者</h1><p id="7fcb" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated"><strong class="lk jd">Thunyathep Santhanavanich(JOE)</strong>博士候选人<br/>地理信息、计算机科学和数学系，<br/>应用科学大学，斯图加特，Schellingstr。24、D-70174斯图加特<br/><a class="ae mn" href="mailto:thunyathep.santhanavanich@hft-stuttgart.de" rel="noopener ugc nofollow" target="_blank">thunyathep . santhanavanich @ hft-Stuttgart . de</a></p><p id="a050" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">⭐需要我协助你的项目吗？在这里找到我<a class="ae mn" href="https://www.fiverr.com/joe_ths" rel="noopener ugc nofollow" target="_blank">⭐</a></p><h1 id="31e2" class="mo mp it bd mq mr ms mt mu mv mw mx my ki mz kj na kl nb km nc ko nd kp ne nf bi translated">引用</h1><p id="27a5" class="pw-post-body-paragraph li lj it lk b ll og kd ln lo oh kg lq lr oi lt lu lv oj lx ly lz ok mb mc md im bi translated">[1]吴，何，何，龚等(2010).公众参与城市规划过程的基于虚拟地球的三维可视化和交互式框架。计算机，环境和城市系统，34(4)，291–298。<a class="ae mn" href="https://doi.org/10.1016/j.compenvurbsys.2009.12.001" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1016/j.compenvurbsys.2009.12.001</a></p></div><div class="ab cl pz qa hx qb" role="separator"><span class="qc bw bk qd qe qf"/><span class="qc bw bk qd qe qf"/><span class="qc bw bk qd qe"/></div><div class="im in io ip iq"><p id="59a8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">喜欢这篇文章吗？成为 <a class="ae mn" href="https://medium.com/@joets/membership" rel="noopener"> <em class="pm">中等会员</em> </a> <em class="pm">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ol om gp gr on oo"><a href="https://medium.com/@joets/membership" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd jd gy z fp ot fr fs ou fu fw jc bi translated">通过我的推荐链接加入Medium-Joe t . Santhanavanich</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="ql l oz pa pb ox pc lb oo"/></div></div></a></div></div></div>    
</body>
</html>