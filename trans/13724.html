<html>
<head>
<title>Using dotenv to Hide Sensitive Information in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用dotenv隐藏Python中的敏感信息</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-dotenv-to-hide-sensitive-information-in-python-77ab9dfdaac8?source=collection_archive---------14-----------------------#2020-09-21">https://towardsdatascience.com/using-dotenv-to-hide-sensitive-information-in-python-77ab9dfdaac8?source=collection_archive---------14-----------------------#2020-09-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="0f49" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">教程| Python | dotenv</h2><div class=""/><div class=""><h2 id="1b5b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">隐藏您的密码和API令牌，使您的代码更加安全</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/998421d6bf514ef01a9fb56818ca786b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TbI4RqkINJS6vQVk"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">一只藏起来的猫，就像你的证件一样！|照片由<a class="ae lh" href="https://unsplash.com/@thomasbormans?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托马斯·博曼斯</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="06e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在之前的帖子中，我在脚本中留下了一个不和谐令牌。这不是理想的编码方式，尤其是如果我不想每次共享代码时都重新生成令牌的话。在您的数据科学和编程项目中使用凭证和API令牌是不可避免的，但是暴露它们是可以避免的。使用<code class="fe me mf mg mh b">dotenv</code> python模块可以帮助保护这些敏感信息免受窥探。</p><blockquote class="mi mj mk"><p id="c740" class="li lj ml lk b ll lm kd ln lo lp kg lq mm ls lt lu mn lw lx ly mo ma mb mc md im bi translated">在之前的一篇文章中，我使用python中的Discord.py创建了一个Discord机器人。这个例子将在这里继续，但同样的想法可以用在任何使用敏感凭证或API令牌的代码中</p></blockquote><div class="mp mq gp gr mr ms"><a href="https://medium.com/python-in-plain-english/hello-world-how-to-make-a-simple-discord-bot-using-discord-py-c532611681ba" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jd gy z fp mx fr fs my fu fw jc bi translated">你好世界！如何使用Discord.py制作一个简单的不和谐机器人</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">使用Python在短短30分钟内运行您自己的不和谐机器人！</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">medium.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng lb ms"/></div></div></a></div><h1 id="2cd5" class="nh ni it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">问题是</h1><p id="0c87" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">您已经完成了全新的Discord bot，并希望与全世界分享您的代码。很自然，你把它上传到GitHub，然后把链接发出去。很快机器人停止工作。为什么？您在代码中留下了API令牌，有人接管了您的bot。</p><blockquote class="oe"><p id="7783" class="of og it bd oh oi oj ok ol om on md dk translated">您将API令牌留在了代码中，有人接管了您的bot</p></blockquote><p id="43c9" class="pw-post-body-paragraph li lj it lk b ll oo kd ln lo op kg lq lr oq lt lu lv or lx ly lz os mb mc md im bi translated">API令牌为控制应用程序提供了巨大的能力。对于某些API，使用情况会受到监控，甚至会对您的使用进行计费！幸运的是，Discord不会向您收费，但是在您的编码项目中使用凭据时，您仍然需要保证它们的安全。</p><h1 id="8ce3" class="nh ni it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">解决方案</h1><p id="d14a" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">输入环境变量。Jim Medlock 在他的<a class="ae lh" href="https://medium.com/chingu/an-introduction-to-environment-variables-and-how-to-use-them-f602f66d15fa" rel="noopener">环境变量介绍和如何使用它们</a>中对它们有很好的解释。在那篇文章中，他说:</p><blockquote class="oe"><p id="d9bd" class="of og it bd oh oi oj ok ol om on md dk translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Environment_variable" rel="noopener ugc nofollow" target="_blank"> <em class="ot">环境变量</em> </a>是一个变量，其值在程序外部设置，通常通过操作系统或微服务内置的功能来设置。环境变量由一个名称/值对组成，可以创建任意数量的名称/值对，并在某个时间点提供引用。</p></blockquote><p id="c349" class="pw-post-body-paragraph li lj it lk b ll oo kd ln lo op kg lq lr oq lt lu lv or lx ly lz os mb mc md im bi translated">我们将使用它们在GitHub提交中安全地保留我们的不和谐令牌。同样的过程也可以用于添加到bot中的任何其他敏感信息，甚至是您正在处理的其他项目。例如，如果你把你的用户名和密码放在机器人的代码中进行网页抓取，你会想用<code class="fe me mf mg mh b">dotenv</code>来保证它的安全。</p><h2 id="50d7" class="ou ni it bd nj ov ow dn nn ox oy dp nr lr oz pa nt lv pb pc nv lz pd pe nx iz bi translated">装置</h2><p id="1266" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">让我们从安装模块开始。我们可以使用python 的<a class="ae lh" href="https://pip.pypa.io/en/stable/" rel="noopener ugc nofollow" target="_blank">包安装程序来完成这项工作，通常称为pip。</a></p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="c1ae" class="ou ni it mh b gy pj pk l pl pm">$ pip install python-dotenv</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pn"><img src="../Images/4b9497d984831d45e668acdf58dc0118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3lq1-oTu1U50NH-V4XBng.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">我已经装了，就是这么好！</p></figure><h2 id="33d7" class="ou ni it bd nj ov ow dn nn ox oy dp nr lr oz pa nt lv pb pc nv lz pd pe nx iz bi translated">。环境设置</h2><p id="0d74" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">现在让我们设置我们的<code class="fe me mf mg mh b">.env</code>文件。该文件应始终位于项目文件夹的顶层文件夹或根目录中。在那个位置创建一个新的文本文件，将其重命名为<code class="fe me mf mg mh b">.env</code>。Windows将要求您确认是否要更改文件类型。单击是。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi po"><img src="../Images/d4015ad567c89cfec9fe910e56cdc62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*8gaTug5bo7q4Zy-xfBkRuQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">如果Windows不让你命名。env，改为命名为discord.env</p></figure><p id="704a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，用文本编辑器打开<code class="fe me mf mg mh b">.env</code>文件。我更喜欢<a class="ae lh" href="https://atom.io/" rel="noopener ugc nofollow" target="_blank"> Atom </a>或者<a class="ae lh" href="https://notepad-plus-plus.org/" rel="noopener ugc nofollow" target="_blank"> Notepad++ </a>，但是<a class="ae lh" href="https://www.microsoft.com/en-us/p/windows-notepad/9msmlrh6lzf3?activetab=pivot:overviewtab" rel="noopener ugc nofollow" target="_blank"> Notepad </a>也可以。按照<a class="ae lh" href="https://google.github.io/styleguide/shellguide.html#s7.3-constants-and-environment-variable-names" rel="noopener ugc nofollow" target="_blank">约定</a>，<strong class="lk jd">环境变量全部大写，单词之间用下划线</strong>隔开。我们可以将我们的命名为<strong class="lk jd"> TUTORIAL_BOT_TOKEN </strong>并粘贴我们的令牌。保存并关闭文件。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="6a51" class="ou ni it mh b gy pj pk l pl pm">TUTORIAL_BOT_TOKEN=NzUzNzU3Mjg0NTI1NTM5MzQ4.X1q1LA.4xD7lSQrN0EqJivrrogLUScNdfY</span></pre><h2 id="1bee" class="ou ni it bd nj ov ow dn nn ox oy dp nr lr oz pa nt lv pb pc nv lz pd pe nx iz bi translated">添加到。gitignore</h2><p id="16fd" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">现在我的假设是你正在使用<a class="ae lh" href="https://github.com/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>作为你的数据科学项目的版本控制。如果你不是，你应该是！如果出现问题，这是回滚代码更改的好方法。GitHub还支持与其他人的协作。你不希望他们也有你的令牌，所以我们有一些工作要做。如果您没有为项目设置存储库或者不知道如何设置，不要担心，我将在另一篇文章中讨论这个问题。您可以安全地进入下一部分。</p><p id="36ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">GitHub将保存对代码的所有修改，但是我们需要排除<code class="fe me mf mg mh b">.env</code>文件，因为它包含了我们的令牌。为了确保<code class="fe me mf mg mh b">.env</code>文件没有被提交到存储库中，打开项目文件夹中的<code class="fe me mf mg mh b">.gitignore</code>文件并添加下面一行。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="083b" class="ou ni it mh b gy pj pk l pl pm">*.env</span></pre><p id="9018" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">添加这一行将忽略我们之前创建的<code class="fe me mf mg mh b">.env</code>文件。通过使用星号(*)，我们排除了顶级文件夹或根目录中扩展名为<code class="fe me mf mg mh b">.env</code>的所有文件提交到存储库。</p><h2 id="646c" class="ou ni it bd nj ov ow dn nn ox oy dp nr lr oz pa nt lv pb pc nv lz pd pe nx iz bi translated">加载环境变量</h2><p id="cec8" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">现在我们有了包含我们敏感信息的<code class="fe me mf mg mh b">.env</code>文件，它不会被提交到您的存储库中，我们需要在我们的python脚本中实际使用它。</p><p id="2d69" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先我们需要加载<code class="fe me mf mg mh b">dotenv</code>和<code class="fe me mf mg mh b">os</code>模块。对于这个例子，我们可以将它们添加到我的<a class="ae lh" href="https://medium.com/python-in-plain-english/hello-world-how-to-make-a-simple-discord-bot-using-discord-py-c532611681ba" rel="noopener"> Hello World Discord.py教程</a>的脚本中。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="1cc4" class="ou ni it mh b gy pj pk l pl pm"># Imports<br/>from dotenv import load_dotenv<br/>import os</span></pre><p id="3e37" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe me mf mg mh b">load_dotenv</code>将用于将<code class="fe me mf mg mh b">.env</code>文件加载到环境变量中。<code class="fe me mf mg mh b">os</code>将用于引用代码中的那些变量。先说<code class="fe me mf mg mh b">load_dotenv</code>。这将加载。环境文件。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="752b" class="ou ni it mh b gy pj pk l pl pm"># Credentials<br/>load_dotenv('.env')</span></pre><p id="b76a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要使用环境变量，我们可以在bot脚本末尾的<code class="fe me mf mg mh b">client.run</code>命令中使用<code class="fe me mf mg mh b">os.getenv</code>。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="143d" class="ou ni it mh b gy pj pk l pl pm">client.run(os.getenv('TUTORIAL_BOT_TOKEN'))</span></pre><h2 id="f6cc" class="ou ni it bd nj ov ow dn nn ox oy dp nr lr oz pa nt lv pb pc nv lz pd pe nx iz bi translated">测试代码</h2><p id="cd9c" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">现在一切都设置好了，在命令行中导航到bot脚本位置，运行脚本来启动bot。</p><pre class="ks kt ku kv gt pf mh pg ph aw pi bi"><span id="5758" class="ou ni it mh b gy pj pk l pl pm">$ cd path\to\bot<br/>$ python 02_Discord_dotenv.py</span></pre><p id="13b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您将看到机器人名称和ID打印到控制台上。为了彻底起见，请使用bot进入服务器并测试！helloworld命令，应该可以完美运行！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pp"><img src="../Images/001d3f858d394ca65ae8fbd88e825c31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuV4LlxnFYYDAYym0yHtcw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">不出所料，该命令工作正常！</p></figure><h1 id="6394" class="nh ni it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">结束语</h1><p id="3c08" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated"><code class="fe me mf mg mh b">dotenv</code>模块是隐藏敏感信息的好方法。它不必局限于与不和谐机器人一起使用。任何代码使用登录凭证、数据库连接信息、API令牌或任何您不想与外界共享的东西的地方，请将其放在您的。环境文件。</p><p id="f265" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要了解更多关于<code class="fe me mf mg mh b">dotenv</code> python模块的信息，请查看<a class="ae lh" href="https://github.com/theskumar/python-dotenv" rel="noopener ugc nofollow" target="_blank"> GitHub知识库</a>，其中包含更多关于该模块的文档。</p><h1 id="d8cf" class="nh ni it bd nj nk nl nm nn no np nq nr ki ns kj nt kl nu km nv ko nw kp nx ny bi translated">寻找更多的项目创意？</h1><p id="fb87" class="pw-post-body-paragraph li lj it lk b ll nz kd ln lo oa kg lq lr ob lt lu lv oc lx ly lz od mb mc md im bi translated">看看我的另一篇文章，帮助你产生一些想法，在那里你可以应用这里讨论的概念。让您的项目在GitHub上脱颖而出，同时保证您的证书安全！</p><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/6-ways-to-make-your-data-science-projects-stand-out-1eca46f5f76f"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jd gy z fp mx fr fs my fu fw jc bi translated">让您的数据科学项目脱颖而出的6种方法</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">提高您的数据科学项目并获得关注的简单步骤</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="pq l nd ne nf nb ng lb ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a href="https://realdrewdata.medium.com/membership" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jd gy z fp mx fr fs my fu fw jc bi translated">通过我的推荐链接加入Medium-Drew Seewald</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">realdrewdata.medium.com</p></div></div><div class="nb l"><div class="pr l nd ne nf nb ng lb ms"/></div></div></a></div></div></div>    
</body>
</html>