<html>
<head>
<title>The Perils of Using Google Analytics User Counts in A/B Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在A/B测试中使用Google Analytics用户计数的风险</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-perils-of-using-google-analytics-user-counts-in-a-b-testing-e50b5dfc5f6c?source=collection_archive---------51-----------------------#2020-10-19">https://towardsdatascience.com/the-perils-of-using-google-analytics-user-counts-in-a-b-testing-e50b5dfc5f6c?source=collection_archive---------51-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4e9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如今，许多分析师、营销人员、产品经理、UX和CRO的专业人士都依赖Google Analytics、Adobe Analytics或类似工具提供的<strong class="jp ir">用户计数</strong>来执行各种统计分析。这种分析可能涉及统计假设检验和A/B检验的估计部分，也可能包括回归和预测模型(LTV、流失等)。).如果你是他们中的一员，<strong class="jp ir">做好准备</strong>，因为这篇文章将揭示一些关于这些用户数量的惊人“秘密”。</p><p id="c5d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我不会轻易说“秘密”。</strong>尽管我有多年的谷歌分析经验，但我只是最近才意识到我在这里分享的是什么，所以我认为“秘密”是当之无愧的。当涉及到在A/B测试中使用GA用户数量时，GA用户数量的真正本质的含义是巨大的。可能还有其他统计分析。哦，就我有限的理解，Adobe Analytics的用户似乎也不能幸免。所以抓紧你们的帽子，让我们开始吧。</p><h1 id="e94d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">谷歌分析中显示的用户数量不是用户计数</h1><p id="10ae" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">对于越来越多的谷歌分析用户来说，上述情况是真实的。在所有各种谷歌分析报告中显示的用户数量<strong class="jp ir">并不是在任何给定的时间范围内在网站上执行操作的用户数量</strong>的精确计数。说得专业一点——他们<em class="lo">没有显示</em>GA会话日志中存在的唯一cookies浏览器/GA客户端id的数量。</p><p id="798c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相反，这些报告中显示的用户数量是对真实用户数量的<strong class="jp ir">概率估计。</strong></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/023e9c448259816b371bbfb4f13141a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GhGXdAshjPKbvwmCJxQ-Q.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">谷歌分析报告中报告的用户数量示例(图片由作者提供)</em></p></figure><p id="926f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着显示的数字几乎不可避免地会偏离真实的计数一个可变的百分比。故意的。无论你做什么，如果某个开关被设置为开(见下文)，你就不能在谷歌分析界面或API中得到一个真实的计数。人们得到的都是近似值。</p><h1 id="a91e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">怎么会这样呢？</h1><p id="895c" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">这一事实在官方文档中有所提及，该文档在某个时间点进行了更新，以反映2017年发生的变化:</p><blockquote class="mh mi mj"><p id="711f" class="jn jo lo jp b jq jr js jt ju jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj kk ij bi translated"><em class="iq">2017年初，Google Analytics开始更新对用户和活跃用户指标的计算，以更高效地统计用户，具有高准确度和低错误率(通常低于2%)。</em></p><p id="98ea" class="jn jo lo jp b jq jr js jt ju jv jw jx mk jz ka kb ml kd ke kf mm kh ki kj kk ij bi translated"><em class="iq">“</em>如何根据用户指标识别用户”，分析帮助</p></blockquote><p id="804a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">属性设置屏幕中这种看似无害的切换是在以前的用户数量计算(精确计数)和使用近似值的新计算之间切换的方式:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/af835f3171ba17e2b490848b2ed35e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*MafWA3hOd6udW7WLAd6t3w.png"/></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">谷歌分析界面中的用户指标切换(图片由作者提供)</em></p></figure><p id="aec8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，新的谷歌分析属性的<strong class="jp ir">开关是打开的(与文档所述相反)。这也是许多用户在过去几年中一直关注的事情，因为它在大多数分析报告中提供了更有用的(与其他选项-会话相比)用户指标。在各种谷歌分析属性中，用户计数处理的缓慢变化可能是几乎没有人注意到的原因，包括我自己，直到最近。</strong></p><p id="4aba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上也意味着:</p><h1 id="1de3" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">没有抽样的报告可能包含估计值，而不是精确计数</h1><p id="8a3a" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在我看来，低于100%抽样的报告是我期望在GA报告中看到概率估计而不是原始计数的唯一情况。当分析需要通过超过500，000个会话来生成临时报告时，会出现不到100%的采样。预定义报告明显不受此限制。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mo"><img src="../Images/99b394629a9f563bb3e1eb2b715f5055.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/0*z8DL9ozKy5E2BDIa.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">(图片作者)</em></p></figure><p id="a833" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要我看到绿色盾牌图标，我就确信我看到的数据包含精确的计数，因此准确到不受任何实施问题和通常的跟踪障碍影响的程度。</p><p id="58ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，现在只有当“在报告中启用用户指标”开关设置为关闭时，这种情况才成立。如果该属性已经手动或默认设置为ON，则上述直觉变得不正确，因为<strong class="jp ir">即使对100%的会话进行采样，并且即使在预定义的报告中，用户数量也不是精确的计数。</strong></p><p id="1d30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如下文所述，这具有重要的意义。但是首先，为了在报告中考虑用户指标，牺牲了多少准确性？</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="ac74" class="kl km iq bd kn ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li bi translated">分析中显示的用户数量有多准确？</h1><p id="8c43" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">虽然文档指出，在用户分析打开的情况下，估计用户计数的错误率通常小于2%，但通过了解更多有关Google Analytics所采用的算法，可以获得更准确的图像。</p><p id="1819" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Analytics 360(以前的Google Analytics Premium)是一个付费的分析版本，允许通过Google BigQuery访问原始数据。BigQuery允许从原始命中数据中获得用户的准确计数，或者指示引擎使用基于<a class="ae mg" href="https://en.wikipedia.org/wiki/HyperLogLog" rel="noopener ugc nofollow" target="_blank"> HyperLogLog++算法</a>的概率估计来进行基数估计。使用HyperLogLog++ (HLL++)估算提取的数字与Analytics用户界面中显示的用户数量相匹配。Patryk Buczyński在<a class="ae mg" href="https://www.linkedin.com/pulse/oh-my-big-query-ga-numbers-different-patryk-buczy%C5%84ski/" rel="noopener ugc nofollow" target="_blank">和</a><a class="ae mg" href="https://adswerve.com/blog/why-google-analytics-users-dont-match-bigquery-users/" rel="noopener ugc nofollow" target="_blank">在</a>描述了这一点。一位知情的谷歌员工在电子邮件中也向我证实了使用HyperLogLog (HLL)的消息。</p><p id="c997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Patryk Buczyński的文章中，Google Analytics使用的精度参数估计为14。这意味着，如BigQuery文档<a class="ae mg" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/hll_functions" rel="noopener ugc nofollow" target="_blank">所述，对于68%的估计，它的准确度为0.41%，对于95%的估计，准确度为0.81%，对于99%的估计，准确度为1.22%。这相当于用16位寄存器初始化的HLL的精度。</a></p><p id="8fb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于99%的估计值，上述精度转化为高达<strong class="jp ir"> 2%相对误差的绝对值，这正是上述分析文档中规定的典型<em class="lo">误差率限值。</em></strong></p><p id="c90e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了形象化这个错误的大小，假设有一个网站在工作日每天接收200，000个用户，在周末接收100，000个用户。下面是对这些数字进行精确计数后的用户趋势的比较，以及这些数字与随机生成的相同真实计数的超对数估计值的比较:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nb"><img src="../Images/aa073f6c5ad0138139c1f107fb3ccbfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qL37ULEc9VzIvJCBg5SzuA.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">将精确的用户数与HyperLogLog++中的基数估计值进行比较(图片由作者提供)</em></p></figure><p id="9e66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于99%的估计值来说，最大2%的误差可能听起来没什么大不了的，而且在上图中也看起来不像。事实证明，这种印象远非正确。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="ba4f" class="kl km iq bd kn ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li bi translated">对A/B测试结果的准确性有哪些影响？</h1><p id="3428" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">首先，简要回顾一下在线控制实验的成功标准。我在不止一个场合说过，大多数A/B测试应该基于基于用户的指标，理想的是每个用户的平均收入。基于用户而不是基于会话的指标意味着:</p><ul class=""><li id="c1c1" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">其结果在解释上不那么模糊，并且对决策有更大的影响。</li><li id="e4c8" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">与基于会话或页面浏览量的指标不同，基于用户的指标尽可能接近<a class="ae mg" href="https://www.analytics-toolkit.com/glossary/independent-observation/" rel="noopener ugc nofollow" target="_blank">独立观察</a>，这是许多统计测试中的一个关键假设，因此提高了统计的有效性。</li></ul><p id="9c4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于会话的指标暂且不谈，让我们采用最简单的基于用户的指标:某种基于用户的转换率，比如基于用户的订阅率。</p><p id="be39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果在一次测试中每支队伍的<strong class="jp ir">用户少于12，000人</strong>，那么统计数据将在很大程度上保持不受影响，因为HyperLogLog++算法在这些水平上实现了极高的准确性。当超过每个测试组的用户数量时，情况就不同了，用户越多，情况就越糟。</p><p id="c81f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是超级对数++基数估计对统计分析准确性的<a class="ae mg" href="http://blog.analytics-toolkit.com/2020/the-effect-of-using-cardinality-estimates-like-hyperloglog-in-statistical-analyses/" rel="noopener ugc nofollow" target="_blank">影响的模拟结果</a>:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nq"><img src="../Images/c8674f49b0f77bdf41004cc0a5729643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYkwns_VHZ9RDl9d6aI9wA.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated">HyperLogLog++基数估计对统计分析影响的模拟结果<em class="mf">(图片由作者提供)</em></p></figure><p id="63ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用户每测试臂</strong> <strong class="jp ir"> P值低于0.05 </strong> <strong class="jp ir"> α膨胀</strong> <strong class="jp ir"> P值低于0.01 </strong> <strong class="jp ir"> α膨胀</strong> <strong class="jp ir"> P值低于0.001 </strong> <strong class="jp ir"> α膨胀</strong></p><p id="beed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果没有来自HyperLogLog的影响，则“P值低于0.05”列中的所有数字应该为5%或更低，“P值低于0.01”列中的所有数字应该为1%或更低，“P值低于0.001”列中的所有值应该为0.1%或更低。事实远非如此，而且随着样本量的增加，差异也会增加。</p><p id="60b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> α通货膨胀</strong>栏显示了差异的百分比。也就是说，仅仅凭借使用谷歌分析HLL++用户计数，他们的不确定性估计会偏离多少:如果阈值为0.05，不确定性会增加16%到13倍(相当于95%的置信度)，如果阈值为0.001，不确定性会增加70%到53倍(相当于99.9%的置信度)。</p><p id="bfb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图直观地展示了相同的数据。这六个图表是来自10，000个<a class="ae mg" href="https://www.analytics-toolkit.com/glossary/a-a-test/" rel="noopener ugc nofollow" target="_blank"> A/A测试</a>的<a class="ae mg" href="https://www.analytics-toolkit.com/glossary/p-value/" rel="noopener ugc nofollow" target="_blank"> p值</a>分布。如果一切正常，它们应该都包含接近均匀分布的图。相反，请注意随着每臂样本量(基数)的增加，分布变得多么偏斜:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nr"><img src="../Images/43f927371203c86375830d7c4fcd0512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2akApFWrgoOODaz_su0AQ.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">来自HLL++ A/A测试的比例p值的绝对差异(图片由作者提供)</em></p></figure><p id="9016" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管2%的相对误差看似无害的99%的误差幅度，但它对统计估计的有效性有<strong class="jp ir">严重的影响</strong>。名义上保证5%的I型错误率可能最终是100%的实际错误率，并且基数足够大。类似地，95%置信区间的覆盖范围将从名义上的95%减少到实际的0%。贝叶斯估计也好不到哪里去，类似的效果也可能适用于其他类型的统计分析。</p><p id="8833" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相比之下，这相当于一个非常频繁的<a class="ae mg" href="https://www.analytics-toolkit.com/glossary/peeking/" rel="noopener ugc nofollow" target="_blank">偷看结果</a>意图停止(<a class="ae mg" href="http://blog.analytics-toolkit.com/2017/the-bane-of-ab-testing-reaching-statistical-significance/" rel="noopener ugc nofollow" target="_blank">等待显著性</a>)，但不同于偷看，来自HLL++估计的效果实际上是无限的。</p><p id="f08b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上意味着<strong class="jp ir">在用户分析开关打开的情况下，任何具有适当样本量的A/B测试(依赖于从Google Analytics属性中提取的基于用户的指标)的结果都会完全受损。</strong></p><p id="1b1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要更全面地了解使用HyperLogLog++和类似基数估计的效果，请阅读<a class="ae mg" href="http://blog.analytics-toolkit.com/2020/the-effect-of-using-cardinality-estimates-like-hyperloglog-in-statistical-analyses/" rel="noopener ugc nofollow" target="_blank">整篇文章</a>。</p><p id="8ab3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">鉴于上述情况，我相信所有关心使用Google Analytics数据进行统计测试和评估的人都应该对获得准确的用户数感兴趣，而不是概率性的评估。</p><h1 id="a6dd" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">对A/B测试结果的影响示例</h1><p id="dce8" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在这里，我给出了两个真实世界的数据例子，来说明使用评估可以对实验指标做些什么。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ns"><img src="../Images/adc1906d51cd250fc0a94b5b8a617fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CJvx32_jXrqcVx3p5Tjn0g.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">对A/B测试结果的影响示例(图片由作者提供)</em></p></figure><p id="bb98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在一批二十个测试中，上面的六个测试通过使用精确计数而不是分析提供的基数估计，完全逆转了结果</strong>。Impl，”代表实施干预。剩下的14个没有，但被改动的程度较小。显然，点估计和区间估计也会受到类似的影响。应当注意的是，前三项测试也未通过其<a class="ae mg" href="https://www.gigacalculator.com/calculators/sample-ratio-mismatch-calculator.php" rel="noopener ugc nofollow" target="_blank"> SRM检查</a>，而后三项则未通过。</p><p id="441b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述统计结果来自简单的固定样本分析。在实践中，经常使用顺序分析来代替，因此这里有两个用户计数估计和精确用户计数的示例(单击查看完整大小的图像)。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nt"><img src="../Images/06cd6cb4c785a7bb2e6ce14743f8fdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZ7Lpkxa82R4uOHvs7q2ZQ.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">敏捷AB测试示例——相同的结果，不同的估计值(p值、lift、CI)(图片由作者提供)</em></p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nt"><img src="../Images/46c75f6d99018af41cf3c13f1fb4bf77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U1MHx4Y_OKsCJ3kmR0qa2Q.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">敏捷AB测试示例——不同的结果和评估(图片由作者提供)</em></p></figure><p id="ce8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第一个示例中，基数估计数据的测试很早就停止了，虽然在这种情况下实际数据的结果是相同的，但由于较高的不确定性(较低的观察到的和估计的提升，较低的p值，不同的置信区间界限)，它来得较晚，并且统计估计是不同的。</p><p id="ed6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第二个例子中，当使用HLL++估计时，测试提前停止，并且无效(观察到低于期望的统计显著结果的概率)。它在最后一个可能的时间停止了，带来了相反的结果，自然也带来了不同的估计。</p><h1 id="41e8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">用估计值代替用户数的广泛影响</h1><p id="735e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我知道很多本土系统<strong class="jp ir">依赖谷歌分析</strong>来存储数据，然后进行统计分析。有些完全由JavaScript驱动，而有些则使用服务器端系统来交付测试体验。一些从业者可能会使用类似Google Optimize这样的工具来运行测试，使用Google Analytics来存储数据，然后分别进行分析(这种方法也是我建议的一种运行A/B测试的<a class="ae mg" href="http://blog.analytics-toolkit.com/2018/affordable-ab-testing-google-optimize-data-agile-statistics/" rel="noopener ugc nofollow" target="_blank">经济实惠的方式</a>)。</p><p id="4a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最重要的是，即使是使用其他系统进行实验和存储测试数据的CRO &amp; UX从业者，也经常会用GA 中的片段分析来补充主分析。在进行这种分析的范围内，它们实际上面临相同的问题。</p><p id="da91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，虽然本文讨论的重点是Google Analytics，但其他平台可能会使用相同或更差的基数估计算法。例如，<strong class="jp ir"> Adobe Analytics </strong>使用HyperLogLog，其实现方式为95%的估计提供高达5%的误差。这将导致比Google Analytics用户更糟糕的结果，如果他们实际上使用的是裸机HyperLogLog而不是HyperLogLog++，那么即使每只手臂的用户少于12，000人的测试也可能会遇到严重的统计有效性问题。如果在Adobe Target A/B测试软件中使用相同的系统，结果会更加直接。</p><p id="4a9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">采用基数估计代替精确计数的更广泛的后果是，过去几年中，未知但可能相当大量的A/B测试以及可能使用Google Analytics用户数据进行的其他统计分析<strong class="jp ir">如果样本量足够大，就会受到彻底的损害</strong>。这同样适用于依赖Adobe Analytics数据(可能还有Adobe Target数据)的测试。</p><p id="9d5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据此类实验得出的决策数量以及每个案例中的利害关系，这种<strong class="jp ir">可能会转化为严重的累积损害</strong>。包括这样一个事实，即所做的一些决策将对未来产生深远的影响，以及作为元分析的一部分的持续影响和指导未来发展的“成功”模式的集合，累积的潜在损害可能比迄今为止发生的损害高几倍。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="4e6a" class="kl km iq bd kn ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li bi translated">如何在Universal Analytics中获得准确的用户数？</h1><p id="0501" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">鉴于以上所述，如果Google Analytics用户数将用于任何类型的统计分析，例如用于A/B测试目的的细分(例如，自定义维度包含用户被分配的测试ID和变量)，恢复这些用户数的准确性是非常重要的。不幸的是，这既不容易也不是没有代价的。</p><p id="0afd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我提供了实现这一目标的四个步骤:</p><ol class=""><li id="0989" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nu ni nj nk bi translated"><strong class="jp ir">步骤1: </strong>从管理&gt;属性&gt;属性设置中关闭“启用报告中的用户指标”切换。</li><li id="4dd0" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nu ni nj nk bi translated"><strong class="jp ir">第2步:</strong>准备一个自定义报告，键入Flat Table，其中第一维是包含实验ID和变量ID的维度(例如，一个自定义维度，或用于优化实验的内置“带有变量的实验ID”维度)。第二个维度应该是浏览器，第三个维度应该是设备类别。对于度量，选择用户、新用户和会话。基于主维度添加一个包含过滤器，以便它与您将从中提取数据的实验ID和变量完全匹配。</li><li id="4042" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nu ni nj nk bi translated"><strong class="jp ir">步骤3: </strong>加载报告并选择合适的日期范围。从“显示行”表下拉列表中选择比显示的行数更多的行。在报告顶部选择导出，然后选择最适合你的选项(我估计你不会想要PDF格式的)。</li><li id="4163" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nu ni nj nk bi translated"><strong class="jp ir">步骤4: </strong>打开生成的电子表格，获得每个测试变量或其他感兴趣的细分市场的用户总数。</li></ol><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nv"><img src="../Images/356ada62db0bc5cfbe16abf941b76250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jywZZDYWlgrFYm4UkHpe8w.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated"><em class="mf">示例自定义报告配置，用于分析中的准确用户计数(按作者分类的图片)</em></p></figure><p id="67f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于要分析的每个区段或测试，需要单独的自定义报告，或者您需要不断编辑报告的过滤器设置。</p><p id="114a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成上述操作后，可以重新打开开关，直到下一次。也就是说，除非使用API自动提取数据，在这种情况下，需要将其永久设置为OFF。如果在任何给定时间都有多人在访问分析报告，那么切换也不会很好…将切换移动到视图级别似乎可以解决很多问题，但这不是任何最终用户都可以做到的。</p><p id="47d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，API提取是由控制UI报告的同一个开关控制的，这使得HyperLogLog问题成为一个大问题，即使对于技术上有能力的团队来说，他们还没有足够的钱来负担Analytics 360。选择是放弃UI中的用户数据，以便通过使用API保持足够的准确性。</p><h1 id="6844" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">关于Google Analytics 4的说明</h1><p id="2e02" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">随着<strong class="jp ir"> Google Analytics 4 </strong>刚刚推出，现在可以选择将原始分析数据导出到BigQuery，但这显然会带来自己的成本和开发资源。另一方面，GA4中目前没有自定义报告，也没有可以打开或关闭HLL估计的开关。由于版本4仍在推出，我还没有将其中的数据与等效的UA属性进行比较，以找出其中的用户计数是如何计算的(我在文档中找不到任何关于此事的信息)。</p><p id="8212" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着更多信息的出现，我可能会在不久的将来更新这一部分来反映事情的状态。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="0ae2" class="kl km iq bd kn ko mw kq kr ks mx ku kv kw my ky kz la mz lc ld le na lg lh li bi translated">外卖食品</h1><p id="6450" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">任何Google Analytics报告中显示的用户数量不应用于A/B测试统计分析，如果每个测试组超过12，000个用户，并且该属性的“在报告中启用用户指标”设置为on，因为这些数字是概率估计值，而不是精确计数。由此引入的误差高达99%的估计值的2%,但即使如此，它的大小对任何统计估计值的有效性都有严重的负面影响，因此使任何测试结果无效。</p><p id="7aa0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">视情况而定，标称和实际误差率、覆盖率等之间的差异。相当于前者的许多倍。测试中的数据越多，统计估计就越糟糕。对于Adobe Analytics用户来说，情况似乎更糟。</p><p id="1216" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你使用谷歌分析用户进行任何类型的A/B测试，你需要<strong class="jp ir">确保使用原始计数，而不是超对数概率估计</strong>。不幸的是，对于大多数用户来说，从Universal Analytics获得准确的用户数似乎是不必要的困难。在谷歌分析4中，这甚至不是一个选项。Adobe Analytics和许多其他软件产品(包括内部开发的软件)的用户可能处于类似的情况。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="e112" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lo">最初在Analytics-Toolkit.com博客上发表为</em> <a class="ae mg" href="http://blog.analytics-toolkit.com/2020/the-perils-of-using-google-analytics-user-counts-in-a-b-testing/" rel="noopener ugc nofollow" target="_blank"> <em class="lo">《在A/B测试中使用谷歌分析用户数的危险》</em></a><em class="lo">2020年10月19日。</em></p></div></div>    
</body>
</html>