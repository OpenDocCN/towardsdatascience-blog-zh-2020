<html>
<head>
<title>A beginner’s guide to SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-sql-b8a94be51db9?source=collection_archive---------43-----------------------#2020-10-19">https://towardsdatascience.com/a-beginners-guide-to-sql-b8a94be51db9?source=collection_archive---------43-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3ffd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在不到10分钟的时间里学会一项最渴望的技术技能</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f929d9cba2bc02fc94fc4b07a29a6701.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YhcZIaB5CYDY6th2_fi7w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="769a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">简介</strong></h1><p id="8cd1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">数据库是计算机系统，允许存储和方便地访问数据。根据数据的组织方式，数据库可以是关系型的<strong class="lq ir"> </strong> ( <strong class="lq ir"> RDBMS </strong>)或非关系型的(<strong class="lq ir"> NoSQL </strong>)。关系数据库以表格的形式构建，类似于彼此相关的csv文件或excel电子表格。虽然，关系数据库比csv或json文件健壮得多。与单个文件不同，如果多个用户试图与存储在数据库中的数据进行交互，所采取的操作不会相互影响，并且只有根据某些规则有效时才会被保存。此外，如果操作的一部分失败，整个操作将失败，数据库将保持不变；一旦完成，它将被永久保存(即使数据库崩溃)。</p><p id="9343" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">下图显示了关系数据库的一个示例，其中的表有一个带<em class="mp">主键</em>的列，该列包含每行的唯一值。表也可以有<em class="mp">外键</em>，作为到其他表的链接。这些链接定义了关系数据库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/54045f87e513e7c05be6d746867933ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ORyKyPiGA6JXsTwAg_R0sQ.png"/></div></div></figure><p id="1ac7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">关系数据库的一些例子是MySQL和PostgreSQL(免费和开源)或Oracle和Microsoft SQL(主要由公司使用)。</p><p id="3168" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">所有这些数据库都可以用SQL来访问和操作，SQL是一种编程语言，代表结构化查询语言。学习SQL比学习其他编程语言容易得多，因为它读起来像一种自然语言。在接下来的部分中，我将展示如何在SQL数据库中创建、操作和查询数据。</p><h1 id="5316" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">用SQLite建立数据库</h1><p id="976b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本练习中，我们将使用SQLite，它类似于其他SQL数据库，只是它是一个单磁盘文件，因此没有中间服务器进程。这些特性使得SQLite更适合小型项目，因为它是基于文件的，所以不需要任何安装。在您的<a class="ae kv" href="https://www.ionos.com/help/email/troubleshooting-mail-basicmail-business/access-the-command-prompt-or-terminal/#:~:text=Open%20Command%20Prompt%20in%20Windows,cmd%22%20and%20then%20click%20OK." rel="noopener ugc nofollow" target="_blank">命令行</a>中，您可以简单地键入<code class="fe mr ms mt mu b">sqlite3</code> <em class="mp"> </em>，后跟您想要访问或创建的数据库的名称<code class="fe mr ms mt mu b">exercise.sqlite</code>。</p><p id="9291" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您会注意到终端提示符变成了<code class="fe mr ms mt mu b">sqlite&gt;</code>。您可以在这里键入您的SQL命令，后跟一个分号(；)来执行它们。</p><h1 id="45d4" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">创建表格</h1><p id="ecd5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们现在将尝试重新创建上面的插图，它显示了<em class="mp">客户</em>表和<em class="mp">贷款</em>表。SQL命令的语法遵循简单的模式:<code class="fe mr ms mt mu b">CREATE TABLE table_name (column_name data_type constrains)</code>创建表，<code class="fe mr ms mt mu b">ALTER TABLE table_name ADD/DROP COLUMN column_name</code>修改表。</p><p id="1d09" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">指定哪种数据将被插入到表中是很重要的。SQL支持不同的字段类型，包括字符串、数字、日期和时间。有关不同数据类型的更多细节，您可以查看此<a class="ae kv" href="https://www.journaldev.com/16774/sql-data-types" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><p id="1fe5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">创建表时，还可以添加几个约束。最常见的是<code class="fe mr ms mt mu b">NOT NULL</code>，它防止列有空值，以及<code class="fe mr ms mt mu b">PRIMARY KEY</code>或<code class="fe mr ms mt mu b">FOREIGN KEY</code>，它们唯一地标识一个表中或另一个表中的记录。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="8545" class="mz kx iq mu b gy na nb l nc nd">CREATE TABLE customers (<br/>    customer_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,<br/>    name VARCHAR(50) NOT NULL,<br/>    email VARCHAR(50) NOT NULL<br/>);</span><span id="8213" class="mz kx iq mu b gy ne nb l nc nd">CREATE TABLE loans (<br/>    loan_id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,<br/>    customer_id INTEGER NOT NULL,<br/>    requested DOUBLE NOT NULL,<br/>    approved DOUBLE NOT NULL,<br/>    FOREIGN KEY (customer_id) REFERENCES customers (customer_id) ON DELETE CASCADE ON UPDATE CASCADE<br/>);</span></pre><p id="2edd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">到目前为止，我们的数据库有一个结构，但没有数据。您可以通过键入以下代码向表中添加数据。请注意，两个表的第一列只支持主键，因此，如果我们使用现有的条目，我们将会得到一个错误。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="5d50" class="mz kx iq mu b gy na nb l nc nd">/*Data for the table customers */</span><span id="928a" class="mz kx iq mu b gy ne nb l nc nd">INSERT INTO customers (customer_id,name,email) VALUES (1,'Grace','grace@gmail.com');<br/>INSERT INTO customers(customer_id,name,email) VALUES (2,’James’,’james@gmail.com’);<br/>INSERT INTO customers(customer_id,name,email) VALUES (3,’Tony’,’tony@gmail.com’);<br/>INSERT INTO customers(customer_id,name,email) VALUES (4,’Alex’,’alex@gmail.com’);</span><span id="687b" class="mz kx iq mu b gy ne nb l nc nd">/*Data for the table loans */</span><span id="8ca2" class="mz kx iq mu b gy ne nb l nc nd">INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (1,1,80.00,80.00);<br/>INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (2,4,100.00,80.00);<br/>INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (3,4,50.00,50.00);<br/>INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (4,2,140.00,0.00);<br/>INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (5,1,200.00,0.00);<br/>INSERT INTO loans(loan_id,customer_id,requested,approved) VALUES (6,1,100.00,100.00);</span></pre><p id="915a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要更新或删除记录，您可以使用<code class="fe mr ms mt mu b">UPDATE</code>或<code class="fe mr ms mt mu b">DELETE</code>命令。</p><p id="1a34" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">示例:<code class="fe mr ms mt mu b">UPDATE loans SET customer_id = 3 WHERE loan_id = 1;</code>将表<em class="mp"> loans </em>中的customer_id更改为3，其中loan_id等于1。</p><p id="7bbb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">示例:<code class="fe mr ms mt mu b">DELETE FROM customers WHERE name like 'Leonard';</code>从<em class="mp">客户</em>表中删除所有名为“伦纳德”的客户。</p><h1 id="f2c7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">在Python环境中查询数据库</h1><p id="fe36" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">就我个人而言，我更喜欢使用Jupyter Notebook来查询数据库，而不是终端，因为它有更好的视觉效果。有几种方法可以直接在笔记本上运行SQL。</p><p id="7740" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一个不需要安装任何库的选项是使用<strong class="lq ir"> Python SQLite3包</strong>。只需导入库并运行下面的代码来建立与数据库的连接。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="27e2" class="mz kx iq mu b gy na nb l nc nd">import sqlite3                              # import library<br/>sqlite_db = 'exercise.sqlite'               # select database<br/>conn = sqlite3.connect(sqlite_db)           # connect<br/>c = conn.cursor()                           # create cursor object</span></pre><p id="4312" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">使用SQLite3时，有必要创建cursor对象来迭代数据行并获取信息。创建表的语法类似于控制台，只是现在我们需要编写括号内的SQL代码，并使用游标对象<code class="fe mr ms mt mu b">c</code>的<code class="fe mr ms mt mu b">.execute()</code>方法执行它。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="0c28" class="mz kx iq mu b gy na nb l nc nd">c.execute("INSERT INTO customers VALUES (5,’Ann’,’ann@gmail.com’);")</span><span id="6e26" class="mz kx iq mu b gy ne nb l nc nd"># commit changes<br/>conn.commit()</span></pre><h2 id="1351" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">从表中选择列</h2><p id="b412" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我们都设置好了，我们可以运行我们的第一个数据查询。每个数据查询中必须存在的两个主要子句是<code class="fe mr ms mt mu b">SELECT</code>和<code class="fe mr ms mt mu b">FROM</code>。</p><p id="6e52" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">SELECT</code>允许从数据库中选择我们想要的列。</p><p id="037c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">FROM</code>指定我们从哪个表中提取列。</p><p id="ee17" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">要使用SQLite3包运行查询，首先我们需要存储我们的结果，然后使用<code class="fe mr ms mt mu b">.fetchall()</code>方法提取它们。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="f0af" class="mz kx iq mu b gy na nb l nc nd">results = c.execute("SELECT * FROM loans")    <br/>results.fetchall()</span></pre><p id="f7e1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">另一种方法是使用pandas函数<code class="fe mr ms mt mu b">.read_sql()</code>将SQL查询读入数据帧。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="84da" class="mz kx iq mu b gy na nb l nc nd">sql_query = (“SELECT * FROM loans”) <br/>pd.read_sql(sql_query, con=conn)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/876c8648d517f33bd9f82eafafe523d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SZaivxv0Ouo9JkTIk1JNQ.png"/></div></div></figure><p id="7fc5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请注意，要选择所有列，可以使用星号(*)。SQL也是不区分大小写的，这意味着键入<code class="fe mr ms mt mu b">SELECT</code>和<code class="fe mr ms mt mu b">select</code>没有区别。</p><h2 id="c787" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">聚合函数</h2><p id="bed0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">聚合函数接受值列表并返回单个值。它们可以在<code class="fe mr ms mt mu b">SELECT</code>语句中使用，通常与<code class="fe mr ms mt mu b">GROUP BY</code>函数结合使用。</p><p id="c838" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最常见的有:<code class="fe mr ms mt mu b">AVG()</code>、<code class="fe mr ms mt mu b">COUNT()</code>、<code class="fe mr ms mt mu b">MAX()</code>、<code class="fe mr ms mt mu b">MIN()</code>、<code class="fe mr ms mt mu b">SUM()</code>。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="712b" class="mz kx iq mu b gy na nb l nc nd">sql_query = (“SELECT AVG(requested) FROM loans”) <br/>pd.read_sql(sql_query, con=conn)</span></pre><p id="0c1b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在此示例中，查询返回请求贷款的平均金额。</p><h2 id="6d34" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">过滤数据</h2><p id="e307" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><code class="fe mr ms mt mu b">WHERE</code>子句是在SQL中过滤结果的最常见方式。它出现在<code class="fe mr ms mt mu b">FROM</code>子句之后，包含一个或多个逻辑表达式，用于评估每一行，如果条件为真，则返回这些表达式。</p><p id="943d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在<code class="fe mr ms mt mu b">WHERE</code>子句中最常用的<strong class="lq ir">比较运算符</strong>有:=(等于)、&lt; &gt; or！=(不等于)、&lt;(小于)、&gt;(大于)、&lt; =(小于等于)、&gt; =(大于等于)。</p><p id="ac68" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">逻辑运算符</strong>，如<code class="fe mr ms mt mu b">AND</code>、<code class="fe mr ms mt mu b">OR</code>、<code class="fe mr ms mt mu b">LIKE</code>，也可用于检验条件的真值。要获得所有逻辑运算符的完整列表，我建议查看这个<a class="ae kv" href="https://www.sqltutorial.org/sql-logical-operators/" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="7977" class="mz kx iq mu b gy na nb l nc nd">sql_query = ("""</span><span id="ca1a" class="mz kx iq mu b gy ne nb l nc nd">SELECT * FROM customers<br/>WHERE name = 'Tony' OR name = 'Grace'</span><span id="e29b" class="mz kx iq mu b gy ne nb l nc nd">""")<br/>pd.read_sql(sql_query, con=conn)</span></pre><p id="a6ec" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">上面的查询返回姓名为“Tony”或“Grace”的客户。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/851fc83e3f061c899470febe44b80834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ac6HAMVm1dAdsqdmE8mymQ.png"/></div></div></figure><h2 id="d2c7" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">分类数据</h2><p id="41d5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">可以使用<code class="fe mr ms mt mu b">ORDER BY</code>子句对查询结果进行排序。该子句出现在<code class="fe mr ms mt mu b">FROM</code>子句和<code class="fe mr ms mt mu b">WHERE</code>子句(如果存在)之后。要对结果进行排序，您需要指定要对值进行排序的列和顺序(升序<code class="fe mr ms mt mu b">ASC</code>或降序<code class="fe mr ms mt mu b">DESC</code>)。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="a83a" class="mz kx iq mu b gy na nb l nc nd">sql_query = ("""</span><span id="54fa" class="mz kx iq mu b gy ne nb l nc nd">SELECT loan_id, customer_id, requested <br/>FROM loans<br/>WHERE approved != 0<br/>ORDER BY customer_id ASC</span><span id="111d" class="mz kx iq mu b gy ne nb l nc nd">""")<br/>pd.read_sql(sql_query, con=conn)</span></pre><p id="2b71" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在此示例中，查询从表“loans”中选择三列，筛选数据，使批准的金额不等于0，然后按customer_id以升序对结果进行排序。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/aad74338c26f3ad8ee9e05cc78617d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BWzMwMrGtNsFuKwaw6Tcrw.png"/></div></div></figure><h2 id="25ff" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">分组数据</h2><p id="293a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在<code class="fe mr ms mt mu b">SELECT</code>语句之后使用<code class="fe mr ms mt mu b">GROUP BY</code>子句将行组合成组。如果您想在分组之前过滤行，那么在<code class="fe mr ms mt mu b">GROUP BY</code>子句之前应用<code class="fe mr ms mt mu b">WHERE</code>子句，而要过滤组，您需要在分组之后使用<code class="fe mr ms mt mu b">HAVING</code>子句。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="38f7" class="mz kx iq mu b gy na nb l nc nd">sql_query = ("""</span><span id="deaf" class="mz kx iq mu b gy ne nb l nc nd">SELECT customer_id, AVG(requested) AS avg_requested <br/>FROM loans<br/>GROUP BY customer_id<br/>HAVING avg_requested &gt; 100<br/>ORDER BY customer_id ASC</span><span id="d7b9" class="mz kx iq mu b gy ne nb l nc nd">""")<br/>pd.read_sql(sql_query, con=conn)</span></pre><p id="6c63" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里，数据按customer_id分组并进行筛选，以便每个客户的平均请求量大于100。请注意，最后添加了<code class="fe mr ms mt mu b">ORDER BY</code>子句。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/acb0cae89c6cbd9d0ae8c4bddfc0846a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72pGl4DDJW148KVe0SlLAQ.png"/></div></div></figure><h2 id="9c59" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">连接表格</h2><p id="f20c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">到目前为止，我们一直是一次查询一个表，但是我们也可以将表链接在一起，同时查询它们。这个过程被称为“连接”,类似于交叉表的概念。最常见的连接类型有:</p><p id="350e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">INNER JOIN</code>:只保留两个表共有的行。</p><p id="828a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">LEFT JOIN</code>:将保留第一个表格的行。</p><p id="c0f7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">RIGHT JOIN</code>:将保留第二个表格的行。</p><p id="f695" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><code class="fe mr ms mt mu b">FULL OUTER JOIN</code>:将保留两个表中的行。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="cdd3" class="mz kx iq mu b gy na nb l nc nd">sql_query = ("""</span><span id="2190" class="mz kx iq mu b gy ne nb l nc nd">SELECT * FROM customers<br/>LEFT JOIN loans ON customers.customer_id = loans.customer_id</span><span id="5440" class="mz kx iq mu b gy ne nb l nc nd">""")<br/>pd.read_sql(sql_query, con=conn)</span></pre><p id="db39" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在此查询中，我们将连接列“customer_id”上的两个表。因为我们使用了<code class="fe mr ms mt mu b">LEFT JOIN</code>，所以即使Ann没有申请贷款，结果也会包含“customers”表中的所有行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/7c91580efc9da1b915b8bd78572af81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aq3VpqFG1ZsZSCWKzCMsjQ.png"/></div></div></figure><p id="73de" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如果我们使用<code class="fe mr ms mt mu b">INNER JOIN</code>，结果将只包括请求贷款的客户。</p><h2 id="092d" class="mz kx iq bd ky nf ng dn lc nh ni dp lg lx nj nk li mb nl nm lk mf nn no lm np bi translated">其他资源和注意事项</h2><p id="c1c7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本教程到此为止！如果你喜欢它，请继续关注，因为还会有更多的。与此同时，您可以查看<a class="ae kv" href="https://www.sqltutorial.org/" rel="noopener ugc nofollow" target="_blank">sqltutorial.org</a>了解更多关于SQL语法和子句的细节。</p><p id="5a9c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">注意，根据您使用的数据库，SQL有许多方言，所以一定要检查可能的差异。</p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="3d53" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">领英:<a class="ae kv" href="https://www.linkedin.com/in/veronica-nigro/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/veronica-nigro/</a></p><div class="oc od gp gr oe of"><a href="https://github.com/veronicanigro" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">veronicanigro -概述</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">在GitHub上注册你自己的个人资料，这是托管代码、管理项目和构建软件的最佳地方…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">github.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot kp of"/></div></div></a></div></div></div>    
</body>
</html>