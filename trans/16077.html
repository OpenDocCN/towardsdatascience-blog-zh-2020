<html>
<head>
<title>Area Under The ROC Curve and Integrals</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ROC曲线下面积和积分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/essential-math-for-data-science-area-under-the-roc-curve-and-integrals-8a0f718dc9df?source=collection_archive---------17-----------------------#2020-11-05">https://towardsdatascience.com/essential-math-for-data-science-area-under-the-roc-curve-and-integrals-8a0f718dc9df?source=collection_archive---------17-----------------------#2020-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="9b6c" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/essential-math" rel="noopener" target="_blank">数据科学的基本数学</a></h2><div class=""/><div class=""><h2 id="a343" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用ROC曲线下的面积了解积分和模型性能比较</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/9a25123b6a6e34fdb776bde022d53386.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1gRrJk-meA-V2nCX7TAvQ.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> ( </em>图片作者<em class="le"> ) </em></p></figure><h1 id="feec" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">积分和曲线下的面积</h1><p id="edb4" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">微积分是数学的一个分支，它通过两个主要领域提供研究函数变化率的工具:导数和积分。在机器学习和数据科学的背景下，您可能会使用积分来计算曲线下的面积(例如，评估具有ROC曲线的模型的性能，或者根据密度来计算概率。</p><p id="afcd" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在本文中，您将学习积分和曲线下面积，使用ROC曲线下面积的实际数据科学示例来比较两种机器学习模型的性能。从这个例子开始，你会从数学的角度看到曲线下面积和积分的概念(来自我的书《数据科学基础数学》)。</p><h1 id="eb23" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">实际项目</h1><p id="ca71" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">比方说，你想从葡萄酒的各种化学特性来预测葡萄酒的质量。你想做一个质量的二元分类(区分非常好的葡萄酒和不太好的葡萄酒)。您将开发一些方法，允许您在考虑受试者操作特征(ROC)曲线下面积不平衡数据的情况下评估您的模型。</p><h2 id="4228" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">资料组</h2><p id="9780" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">为此，我们将使用一个数据集来显示红葡萄酒的各种化学特性及其质量评级。数据集来自这里:<a class="ae nj" href="https://archive.ics.uci.edu/ml/datasets/wine+quality" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/wine+quality</a>。相关论文是Cortez，Paulo等人的“通过物理化学性质的数据挖掘对葡萄酒偏好建模”决策支持系统47.4(2009):547–553。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nk"><img src="../Images/830977728ceaaaac69521acdb1c5f1c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p7odU5qxEkblRylB.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图1:葡萄酒质量建模示意图。(</em>图片作者<em class="le"> ) </em></p></figure><p id="710a" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如图1所示，数据集代表了葡萄酒的化学分析(特性)和质量评级。这个评级是目标:这是你要尝试评估的。</p><p id="a3f4" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">首先，让我们加载数据，看看特性:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="0708" class="my lg iq no b gy ns nt l nu nv">Index([‘fixed acidity’, ‘volatile acidity’, ‘citric acid’, ‘residual sugar’,<br/> ‘chlorides’, ‘free sulfur dioxide’, ‘total sulfur dioxide’, ‘density’,<br/> ‘pH’, ‘sulphates’, ‘alcohol’, ‘quality’],<br/> dtype=’object’)</span></pre><p id="b72d" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">最后一列<code class="fe nw nx ny no b">quality</code>很重要，因为您将使用它作为您分类的目标。质量由从3到8的等级来描述:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="37d8" class="my lg iq no b gy ns nt l nu nv">array([5, 6, 7, 4, 8, 3])</span></pre><p id="06f1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">既然目标是对<em class="nz">非常好</em>质量的红酒进行分类，那么让我们决定当评级为7或8时红酒是非常好的，否则就不是非常好。</p><p id="5626" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们创建一个数据集，其中<code class="fe nw nx ny no b">y</code>是质量(因变量，0表示评分小于7，1表示评分大于或等于7)，而<code class="fe nw nx ny no b">X</code>包含所有其他特征。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="9ba3" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在查看数据之前，要做的第一件事是将数据分成一部分用于训练算法(训练集)和一部分用于测试算法(测试集)。这将使您能够评估模型在培训期间不可见的数据上的性能。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="9761" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">预处理</h2><p id="2b8e" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">作为第一步，让我们标准化数据，以帮助算法的收敛。你可以使用Sklearn的类<code class="fe nw nx ny no b">StandardScaler</code>。</p><p id="37ad" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">请注意，您不希望考虑来自测试集的数据来进行标准化。方法<code class="fe nw nx ny no b">fit_transform()</code>计算标准化所需的参数并同时应用。然后，您可以对测试集应用相同的标准化，而无需再次拟合。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h2 id="3a51" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">第一个模型</h2><p id="ac9a" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">作为第一个模型，让我们在训练集上训练逻辑回归，并在测试集上计算分类准确度(正确分类的百分比):</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="91b4" class="my lg iq no b gy ns nt l nu nv">0.8729166666666667</span></pre><p id="3575" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">准确度约为0.87，这意味着87%的测试示例已被正确分类。你应该对这个结果感到高兴吗？</p><h1 id="1d06" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">不平衡数据集的度量</h1><h2 id="2181" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">不平衡数据集</h2><p id="0b4f" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">由于我们将数据分为非常好的葡萄酒和不太好的葡萄酒，因此数据集是<em class="nz">不平衡的</em>:每个目标类别对应的数据量不同。</p><p id="fb2e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们看看你在消极类(不是很好的葡萄酒)和积极类(很好的葡萄酒)中有多少观察结果:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="fda4" class="my lg iq no b gy ns nt l nu nv">0.8650580875781948</span></pre><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="f6db" class="my lg iq no b gy ns nt l nu nv">0.13494191242180517</span></pre><p id="fab8" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">它表明大约有86.5%的例子对应于0类，13.5%对应于1类。</p><h2 id="1cf6" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">简单模型</h2><p id="b721" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">为了说明关于准确性和不平衡数据集的这一点，让我们创建一个模型作为基线，并查看其性能。这将有助于您了解使用准确性之外的其他指标的优势。</p><p id="bb5c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">利用数据集不平衡这一事实的非常简单的模型将总是估计具有最大数量观察值的类。在你的例子中，这样一个模型将总是估计所有的葡萄酒都是坏的，并得到相当的准确性。</p><p id="21ca" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们通过创建低于0.5的随机概率来模拟这个模型(例如，0.15的概率意味着该类有15%的可能性是正的)。我们需要这些概率来计算准确性和其他指标。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="2aa3" class="my lg iq no b gy ns nt l nu nv">array([2.08511002e-01, 3.60162247e-01, 5.71874087e-05, …,<br/> 4.45509477e-01, 1.36436118e-02, 2.61025624e-01])</span></pre><p id="e5d4" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">假设如果概率高于0.5，则该类被估计为正:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="c291" class="my lg iq no b gy ns nt l nu nv">array([0, 0, 0, …, 0, 0, 0])</span></pre><p id="4b47" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">变量<code class="fe nw nx ny no b">y_pred_random</code>只包含零。让我们评估一下这个随机模型的准确性:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="8a5c" class="my lg iq no b gy ns nt l nu nv">0.8625</span></pre><p id="9a0c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这说明，即使是随机模型，精度一点都不差:不代表模型好。</p><p id="6bfb" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">总的来说，每一类都有不同数量的观察值，你不能依靠精确度来评估你的模型的性能。在我们的例子中，模型可以只输出零，你会得到大约86%的准确性。</p><p id="fc5f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您需要其他指标来评估具有不平衡数据集的模型的性能。</p><h2 id="78b9" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">ROC曲线</h2><p id="d61a" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">精度的一个很好的替代方法是接收机工作特性(ROC)曲线。你可以在Géron，Aurélien查看Aurélien Géron关于ROC曲线的非常好的解释。使用Scikit-Learn、Keras和TensorFlow进行机器学习:构建智能系统的概念、工具和技术。奥莱利媒体，2019。</p><p id="1f03" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">主要思想是将模型中的估计分为四类:</p><ul class=""><li id="f9b0" class="oa ob iq lz b ma mt md mu mg oc mk od mo oe ms of og oh oi bi translated">真阳性(TP):预测值为1，真实类别为1。</li><li id="2432" class="oa ob iq lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">误报(FP):预测是1，但真实类别是0。</li><li id="8252" class="oa ob iq lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">真负值(TN):预测值为0，真实类别为0。</li><li id="5df8" class="oa ob iq lz b ma oj md ok mg ol mk om mo on ms of og oh oi bi translated">假阴性(FN):预测值为0，但真实类别为1。</li></ul><p id="3643" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们为您的第一个逻辑回归模型计算这些值。可以使用Sklearn的函数<code class="fe nw nx ny no b">confusion_matrix</code>。它提供了一个组织如下的表格:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/2e495f327555cef82e029328f17462e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mGDUBM_Wp7W4EQPm.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图2:混淆矩阵的图示。(</em>图片作者<em class="le"> ) </em></p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="cb99" class="my lg iq no b gy ns nt l nu nv">array([[414, 0],<br/> [ 66, 0]])</span></pre><p id="26d1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">你可以看到，没有一个积极的观察已被正确分类(TP)与随机模型。</p><p id="6061" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> <em class="nz">决定阈值</em> </strong></p><p id="06cd" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在分类任务中，您希望估计数据样本的类别。对于像逻辑回归这样输出0到1之间概率的模型，您需要使用<em class="nz">决策阈值</em>或仅使用<em class="nz">阈值</em>将该分数转换为0或1类。高于阈值的概率被认为是正类。例如，使用决策阈值的默认选择0.5，当模型输出高于0.5的分数时，您认为估计的类是1。</p><p id="c29f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">但是，您可以选择其他阈值，用于评估模型性能的指标将取决于此阈值。</p><p id="cfbe" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">使用ROC曲线，您可以考虑0到1之间的多个阈值，并根据每个阈值的假阳性率来计算真阳性率。</p><p id="0236" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">可以使用Sklearn的函数<code class="fe nw nx ny no b">roc_curve</code>来计算假阳性率(fpr)和真阳性率(tpr)。该函数还输出相应的阈值。让我们用我们模拟的随机模型来试试吧，在这个模型中，输出只有低于0.5的值(<code class="fe nw nx ny no b">y_pred_random_proba</code>)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="8635" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们来看看输出结果:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="9ad4" class="my lg iq no b gy ns nt l nu nv">array([0. , 0. , 0.07246377, …, 0.96859903, 0.96859903,<br/> 1. ])</span></pre><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="27f8" class="my lg iq no b gy ns nt l nu nv">array([0. , 0.01515152, 0.01515152, …, 0.98484848, 1. ,<br/> 1. ])</span></pre><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="eee0" class="my lg iq no b gy ns nt l nu nv">array([1.49866143e+00, 4.98661425e-01, 4.69443239e-01, …,<br/> 9.68347894e-03, 9.32364469e-03, 5.71874087e-05])</span></pre><p id="02a2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在，您可以根据这些值绘制ROC曲线:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi op"><img src="../Images/f65bf5967a46f62977ff26b4b876ffc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*-MJqfN12KKYpMmXO.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图3:随机模型对应的ROC曲线。(</em>图片作者<em class="le"> ) </em></p></figure><p id="314e" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">图3显示了对应于随机模型的ROC曲线。它给出了真阳性率，作为每个阈值的假阳性率的函数。</p><p id="6ac7" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">但是，要小心，阈值是从1到0。例如，左下方的点对应于阈值1:有0个真阳性和0个假阳性，因为不可能有大于1的概率，所以阈值为1时，没有观察结果可以归类为阳性。在右上方，阈值是0，因此所有的观察都被分类为阳性，导致100%的真阳性和100%的假阳性。</p><p id="15d4" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">对角线周围的ROC曲线意味着模型不比随机模型好，这里就是这种情况。对于所有假阳性率值，完美的模型将与真阳性率为1的ROC曲线相关联。</p><p id="1712" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在让我们来看看与您之前训练的逻辑回归模型相对应的ROC曲线。你将需要来自模型的概率，你可以使用<code class="fe nw nx ny no b">predict_proba()</code>而不是<code class="fe nw nx ny no b">predict</code>得到:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="2e91" class="my lg iq no b gy ns nt l nu nv">array([[0.50649705, 0.49350295],<br/> [0.94461852, 0.05538148],<br/> [0.97427601, 0.02572399],<br/> …,<br/> [0.82742897, 0.17257103],<br/> [0.48688505, 0.51311495],<br/> [0.8809794 , 0.1190206 ]])</span></pre><p id="a1b5" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">第一列是类0的分数，第二列是分数1(因此，每行的总和是1)，所以您可以只保留第二列。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi op"><img src="../Images/392f36084749b60d14fc8ececd3049a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*7v6jp-Mtc3cd--3Z.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图logistic模型对应的ROC曲线。(</em>图片作者<em class="le"> ) </em></p></figure><p id="a6b2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您可以在图4中看到，您的模型实际上比随机模型更好，这是您无法从模型精度中得知的(它们是等价的:随机模型大约为0.86，而您的模型为0.87)。</p><p id="b406" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">目视检查是好的，但是用一个单一的数字指标来比较你的模型也是至关重要的。这通常由ROC曲线下的面积提供。在接下来的章节中，你会看到曲线下的面积是多少，以及如何计算。</p><h1 id="34be" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">积分</h1><p id="1dba" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated"><em class="nz">积分</em>是微分的逆运算。取一个函数f(x)并计算它的导数f'(x)，f'(x)的<em class="nz">不定积分</em>(也称为<em class="nz">反导数</em>)返回f(x)(直到一个常数，你很快就会看到)。</p><p id="8a88" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">您可以使用积分来计算曲线下的<em class="nz">面积，这是由函数界定的形状的面积，如图5所示。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/fd64256f4265f0916f56d0e6afa32f2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*EMxYkYiHWxu2JtqN8XUEXA.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图5:曲线下的区域。(</em>图片作者<em class="le"> ) </em></p></figure><p id="66ab" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><em class="nz">定积分</em>是特定区间上的积分。它对应于这个区间内曲线下的面积。</p><h1 id="914d" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">例子</h1><p id="7579" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">通过这个例子你会看到如何理解函数的积分和曲线下面积的关系。为了说明这个过程，您将使用曲线下面积的离散化来近似函数g(x) = 2x的积分。</p><h2 id="7e50" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">示例描述</h2><p id="4442" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">让我们再以行驶中的火车为例。你看到速度是时间的函数，距离是时间的导数。这些功能如图6所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi or"><img src="../Images/14ab30a1fdac3d787efc08f27a705a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3Vsn2yJ4nETDJ6r-.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图6:左图显示f(x ),它是距离与时间的函数，右图显示它的导数g(x ),它是速度与时间的函数。(</em>图片作者<em class="le"> ) </em></p></figure><p id="15c8" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">图6左图所示的函数定义为f(x) = x。其导数定义为g(x)=2x。</p><p id="b477" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在这个例子中，你将学习如何找到g(x)曲线下面积的近似值。</p><h2 id="d499" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">分割函数</h2><p id="e350" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">要估算一个形状的面积，可以使用切片法:用简单的形状(如矩形)将形状切割成小切片，计算每个切片的面积，然后求和。</p><p id="7a91" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">你要做的就是找到g(x)曲线下面积的近似值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi os"><img src="../Images/766d50ba7f6ed2686ae78c46357ad30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*xGXpUFM97ikeD3zQxvjEQw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图7:通过将速度曲线下的面积离散化为时间的函数，得到曲线下面积的近似值。(</em>图片作者<em class="le"> ) </em></p></figure><p id="2f5f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">图7显示了f'(x)的曲线下的区域，该区域被切成一秒钟的矩形(我们称之为差值δx)。请注意，我们低估了面积(查看丢失的三角形)，但我们稍后会解决这个问题。</p><p id="cb2b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们试着理解切片的含义。拿第一个来说:它的面积被定义为2 ⋅ 1。切片的高度是一秒钟的速度(值为2)。所以第一个切片有两个单位的速度乘以一个单位的时间。面积相当于速度和时间的乘积:这是一个距离。</p><p id="868f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">例如，如果你以每小时50英里的速度行驶了两个小时，你行驶了50 ⋅ 2 = 100英里的距离。这是因为速度的单位对应于距离和时间的比率(比如英里<em class="nz">每小时</em>)。你得到:(距离/时间)⋅时间=距离。</p><p id="8c28" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">总结一下，距离对时间函数的导数就是速度对时间的函数，速度对时间函数的曲线下面积(它的积分)给你一个距离。这就是导数和积分的关系。</p><h2 id="83a0" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">履行</h2><p id="8434" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">让我们用切片来近似函数g(x)=2x的积分。首先，让我们定义函数g(x):</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="3f8f" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如图7所示，您将认为该函数是离散的，并以δx = 1为步长。您可以创建一个值从0到6的x轴，并对每个值应用函数<code class="fe nw nx ny no b">g_2x()</code>。您可以使用Numpy方法<code class="fe nw nx ny no b">arange(start, stop, step)</code>创建一个数组，用从<code class="fe nw nx ny no b">start</code>到<code class="fe nw nx ny no b">stop</code>的值填充(不包括):</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="ed02" class="my lg iq no b gy ns nt l nu nv">array([0, 1, 2, 3, 4, 5, 6])</span></pre><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="7512" class="my lg iq no b gy ns nt l nu nv">array([ 0, 2, 4, 6, 8, 10, 12])</span></pre><p id="dce2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">然后，您可以通过迭代并将宽度(δx)乘以高度(此时的y值)来计算切片的面积。切片的。正如您所看到的，这个区域(下面代码中的<code class="fe nw nx ny no b">delta_x * y[i-1]</code>)对应于一个距离(移动的火车在第I个片段中行驶的距离)。最后，您可以将结果追加到一个数组中(下面代码中的<code class="fe nw nx ny no b">slice_area_all</code>)。</p><p id="85a1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">注意<code class="fe nw nx ny no b">y</code>的索引是<code class="fe nw nx ny no b">i-1</code>，因为矩形在我们估计的x值的左边。例如，对于x=0和x=1，面积为零。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="3964" class="my lg iq no b gy ns nt l nu nv">array([ 0., 0., 2., 4., 6., 8., 10.])</span></pre><p id="7a17" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这些值是切片的面积。</p><p id="fb43" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">要计算从起点到相应时间点(不对应每个切片)的距离，可以用Numpy函数<code class="fe nw nx ny no b">cumsum()</code>计算<code class="fe nw nx ny no b">slice_area_all</code>的累计和:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="0811" class="my lg iq no b gy ns nt l nu nv">array([ 0., 0., 2., 6., 12., 20., 30.])</span></pre><p id="0fcc" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这是g(x)的曲线下面积作为x的函数的估计值，我们知道函数g(x)是f(x)=x的导数，所以我们要通过对g(x)的积分把f(x)取回来。</p><p id="17ee" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们画出我们的估计和f(x)，我们称之为“真实函数”，来比较它们:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/bbd839e75ef02fd65a504eed0aac0aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/0*_G7kR97u15RUU6Xu.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图8:估算函数和原始函数的比较。(</em>图片作者<em class="le"> ) </em></p></figure><p id="beff" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">图8中表示的估计表明该估计并不差，但是可以改进。这是因为我们错过了图9中用红色表示的所有三角形。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ou"><img src="../Images/bb5a573542976d4753a308a05acc14c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NalLzN3SW_0ZbDO_vD1TBw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图9:速度函数切片中的缺失部分(红色)。δx越小误差越小<em class="le"> ( </em>图片作者<em class="le"> ) </em></p></figure><p id="6880" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">让我们估计δx = 0.1的积分函数:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/f2e10f972721ec1743f4a6994321ce6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/0*uFxW0h_rfwZbvYJ5.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图10:切片宽度越小，对原始函数的估计越好。(</em>图片作者<em class="le"> ) </em></p></figure><p id="e378" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如图10所示，我们恢复了(至少，直到一个附加常数)我们对其导数进行积分的原始函数。</p><h2 id="a69e" class="my lg iq bd lh mz na dn ll nb nc dp lp mg nd ne lr mk nf ng lt mo nh ni lv iw bi translated">延长</h2><p id="bf2b" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在我们之前的例子中，您对函数2x进行了积分，这是一个线性函数，但是对于任何连续函数，原理都是相同的(例如，参见图11)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/a5fc4f0a618631103939ebf22a73125a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y2bthXsxd1nHjolW.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图11:切片方法可用于许多线性或非线性函数，包括所有连续函数。(</em>图片作者<em class="le"> ) </em></p></figure><h1 id="185a" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">黎曼和</h1><p id="0a47" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">使用这种切片方法近似积分被称为<em class="nz">黎曼和</em>。黎曼和可以用不同的方法计算，如图12所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ow"><img src="../Images/6877400d01c57f26725522778a019315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kOIrICCc2DbhswKH.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图12:积分逼近的四种黎曼和。(</em>图片作者<em class="le"> ) </em></p></figure><p id="f4f7" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">如图12所示，使用左黎曼和，曲线与矩形的左角对齐。使用右黎曼和，曲线与矩形的右角对齐。使用中点规则，曲线与矩形的中心对齐。对于梯形法则，使用梯形形状而不是矩形。曲线穿过梯形的两个顶角。</p><h1 id="d4c6" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">数学定义</h1><p id="3696" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">在上一节中，您看到了曲线下面积和积分之间的关系(您从导数中恢复了原始函数)。现在让我们看看积分的数学定义。</p><p id="a8a4" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">函数f(x)关于x的积分表示如下:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/c92ecce1d108fcb124e59cf74f6018ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*MX-2uF-yXJB5wkZOK_9hrg.png"/></div></figure><p id="6286" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">符号dx被称为x的<em class="nz">微分</em>，指的是x的无穷小变化的想法，它是x中接近0的差。积分的主要思想是对无限个宽度无限小的切片求和。</p><p id="5679" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">符号∫是整数符号，表示无限个切片的总和。</p><p id="4b29" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">每个切片的高度是值f(x)。f(x)的乘法</p><p id="621a" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">因此dx是每个切片的面积。最后，∫ f(x) dx是无限个切片的切片面积之和(切片的宽度趋于零)。这是曲线下的<em class="nz">区域。</em></p><p id="39a1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">你在上一节看到了如何近似函数积分。但是如果你知道一个函数的导数，你就可以在知道它是逆运算的情况下检索积分。例如，如果您知道:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/7f0b22fb682970d4ca07be553b428bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*Hl00_-_XpEKq5MtovTidbg.png"/></div></figure><p id="5556" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">可以得出2x的积分是x，但是，有一个问题。如果你给我们的函数加一个常数，导数是一样的，因为常数的导数是零。举个例子，</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/028e20ab3af3a8c1ef8eab3d3bc101f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*C7pnjRGY3_VHl1mzRhAjGw.png"/></div></figure><p id="7c8c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">不可能知道常数的值。因此，您需要在表达式中添加一个未知常数，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/0eac2898632ffa28ea9972ac8c85e5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*C30jmkPvw8Yy59JXJE6sXw.png"/></div></figure><p id="5cea" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">其中c是常数。</p><p id="7d9c" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja"> <em class="nz">定积分</em> </strong></p><p id="db68" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在<em class="nz">定积分</em>的情况下，用整数符号上下的数字表示积分区间，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/fb71bf8012e276af37ff07e50baad06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*GSa9J8o6rfIO9MwQxOVR1A.png"/></div></figure><p id="97a6" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">它对应于x=a和x=b之间函数f(x)曲线下的面积，如图13所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/c4c20aa63eb22e78cdddafef20ba71fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*heuOI6Z6vJq04bPIZ1Bo9w.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图13:x = a和x=b之间曲线下的面积<em class="le"> ( </em>图片作者<em class="le"> ) </em></p></figure><h1 id="6997" class="lf lg iq bd lh li lj lk ll lm ln lo lp kf lq kg lr ki ls kj lt kl lu km lv lw bi translated">ROC曲线下面积</h1><p id="4b3c" class="pw-post-body-paragraph lx ly iq lz b ma mb ka mc md me kd mf mg mh mi mj mk ml mm mn mo mp mq mr ms ij bi translated">现在你知道了曲线下的面积与积分的关系，让我们来看看如何计算它来比较你的模型。</p><p id="a3b6" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">请记住，您的ROC曲线如图14所示:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi op"><img src="../Images/084448b81b6600e5c7dffbc38eb8f87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*rx_hVmLwJ4MS52PI.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">图14:随机模型(蓝色)和逻辑回归模型(绿色)的ROC曲线。(</em>图片作者<em class="le"> ) </em></p></figure><p id="b7f1" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">先说随机模型。您希望将每个真阳性率值乘以x轴上的宽度(即相应的假阳性率值与前一个值之差)进行求和。您可以通过以下方式获得这些差异:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="a920" class="my lg iq no b gy ns nt l nu nv">array([0.00241546, 0.01207729, 0. , …, 0.01207729, 0. ,<br/> 0.06038647])</span></pre><p id="3e62" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">所以随机模型的ROC曲线下的面积是:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="04af" class="my lg iq no b gy ns nt l nu nv">0.5743302591128678</span></pre><p id="fc2b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">或者您可以简单地使用Sklearn的函数<code class="fe nw nx ny no b">roc_auc_score()</code>,将真实目标值和概率作为输入:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="9864" class="my lg iq no b gy ns nt l nu nv">0.5743302591128678</span></pre><p id="2cd2" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">ROC曲线下0.5的面积对应于不比随机更好的模型，面积1对应于完美的预测。</p><p id="f623" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">现在，让我们将该值与您的模型的ROC曲线下的面积进行比较:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nl nm l"/></div></figure><pre class="kp kq kr ks gt nn no np nq aw nr bi"><span id="325c" class="my lg iq no b gy ns nt l nu nv">0.8752378861074513</span></pre><p id="f056" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">这表明你的模型实际上并不差，你对葡萄酒质量的预测也不是随机的。</p><p id="dfdc" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated">在机器学习中，你可以用几行代码来训练复杂的算法。然而，正如你在这里看到的，一点数学知识可以帮助你充分利用它，加快你的工作。它会让你在学科的各个方面更加轻松，甚至，例如，理解像Sklearn这样的机器学习库的文档。</p><p id="940b" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><em class="nz">原载于2020年11月6日</em><a class="ae nj" href="https://hadrienj.github.io/posts/ch02_integrals_medium/" rel="noopener ugc nofollow" target="_blank"><em class="nz">https://hadrienj . github . io</em></a><em class="nz">。</em></p><p id="7a34" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><strong class="lz ja">这篇文章是我的书<em class="nz">数据科学基础数学</em>的样本！</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><a href="https://bit.ly/34ZXUsy"><div class="gh gi oq"><img src="../Images/17ba0d27d4e1447f66eead11310ad9cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*9S5qA5aYzopRFt9kIu2l4w.jpeg"/></div></a></figure><p id="6a61" class="pw-post-body-paragraph lx ly iq lz b ma mt ka mc md mu kd mf mg mv mi mj mk mw mm mn mo mx mq mr ms ij bi translated"><a class="ae nj" href="https://bit.ly/34ZXUsy" rel="noopener ugc nofollow" target="_blank">在此获取图书！</a></p></div></div>    
</body>
</html>