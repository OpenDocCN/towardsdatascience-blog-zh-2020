<html>
<head>
<title>How I customarily bin data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我习惯如何将数据与熊猫绑定</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-i-customarily-bin-data-with-pandas-9303c9e4d946?source=collection_archive---------9-----------------------#2020-10-21">https://towardsdatascience.com/how-i-customarily-bin-data-with-pandas-9303c9e4d946?source=collection_archive---------9-----------------------#2020-10-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b324" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">熊猫“咔”和“咔”</h2><div class=""/><div class=""><h2 id="5ce4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">您可能只使用了默认值</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/346fda2d76480e56f2c2debb62217d7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9QRA343A2dlK_2OQ"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@steve_j?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯蒂夫·约翰森</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="6d9a" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">动机</h2><blockquote class="md"><p id="00b3" class="me mf it bd mg mh mi mj mk ml mm mn dk translated">“这是什么鬼？”</p></blockquote><p id="2ce0" class="pw-post-body-paragraph mo mp it mq b mr ms kd mt mu mv kg mw lr mx my mz lv na nb nc lz nd ne nf mn im bi translated">这是初学者在查看一些硬函数的输出时经常得到的反应。很多教程和课程用一句话就介绍了这些功能，然后转到其他话题，这总是让我感到困惑。即使你从头到尾阅读他们的文档，我保证也要超过一分钟。</p><p id="dc48" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">作为一个初学者，当我遇到这种情况时，我总是很沮丧。有一次，当我在Udacity攻读纳米学位时，我正在学习Matplotlib的热图。如果你知道，Matplotlib不能像Seaborn一样自动为热图创建注释，所以你必须手工创建它们。为此，你可以使用<code class="fe ng nh ni nj b">qcut</code>或<code class="fe ng nh ni nj b">cut</code>(这是本文的主题)将你的数据分类，我对这些函数完全陌生。</p><p id="f42e" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">讲师用一句话简单地“解释”了这些功能，屏幕上出现了文档链接🤦‍♂️.他甚至快进了他输入语法的部分。</p><p id="e175" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">最近，我一直在写一个小编，解释<code class="fe ng nh ni nj b">pandas</code>最难的功能，希望其他人不会面临同样的困难。这是第四部分，是关于使用<code class="fe ng nh ni nj b">qcut</code>和<code class="fe ng nh ni nj b">cut</code>的宁滨数字数据。</p><div class="np nq gp gr nr ns"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">通过我的推荐链接加入Medium-BEXGBoost</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lb ns"/></div></div></a></div><p id="1ca9" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">获得由强大的AI-Alpha信号选择和总结的最佳和最新的ML和AI论文:</p><div class="np nq gp gr nr ns"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">alphasignal.ai</p></div></div><div class="ob l"><div class="oh l od oe of ob og lb ns"/></div></div></a></div></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="643f" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">可点击的目录</h2><p id="9199" class="pw-post-body-paragraph mo mp it mq b mr op kd mt mu oq kg mw lr or my mz lv os nb nc lz ot ne nf mn im bi translated">∘ <a class="ae lh" href="#6d9a" rel="noopener ugc nofollow">动机</a> <br/> ∘ <a class="ae lh" href="#005a" rel="noopener ugc nofollow">设置与基础探索</a> <br/> ∘ <a class="ae lh" href="#f2fb" rel="noopener ugc nofollow">音程记谱复习</a> <br/> ∘ <a class="ae lh" href="#3a1b" rel="noopener ugc nofollow">熊猫qcut() </a> <br/> ∘ <a class="ae lh" href="#03d2" rel="noopener ugc nofollow">熊猫q cut()</a></p><blockquote class="ou ov ow"><p id="c51d" class="mo mp ox mq b mr nk kd mt mu nl kg mw oy nm my mz oz nn nb nc pa no ne nf mn im bi translated">文中用到的笔记本可以从<a class="ae lh" href="https://github.com/BexTuychiev/medium_stories/tree/master/qcut_cut" rel="noopener ugc nofollow" target="_blank">这个</a> GitHub repo下载。</p></blockquote></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="005a" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">设置和基本探索</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="5682" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">对于样本数据，我将使用内置的<code class="fe ng nh ni nj b">seaborn</code>数据集<code class="fe ng nh ni nj b">planets</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/b2726df017d52e2e4ff643dfde763246.png" data-original-src="https://miro.medium.com/v2/format:webp/1*MUWyIGDC8E0jahv7AW2hzA.png"/></div></figure><pre class="ks kt ku kv gt pe nj pf pg aw ph bi"><span id="0b1e" class="li lj it nj b gy pi pj l pk pl">&gt;&gt;&gt; planets.describe()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/62996057e3b5caeeaddb1d9025fa9d95.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gDlGbvd7H3TIK_GPDkZdrw.png"/></div></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="a06d" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated"><code class="fe ng nh ni nj b">planets</code>数据集是从美国宇航局的<a class="ae lh" href="https://exoplanets.nasa.gov/exoplanet-catalog" rel="noopener ugc nofollow" target="_blank">系外行星目录</a>下载的，包含了太阳系外行星的数据。感兴趣的三列是<code class="fe ng nh ni nj b">orbital_period</code>、<code class="fe ng nh ni nj b">mass</code>和<code class="fe ng nh ni nj b">distance</code>:</p><ol class=""><li id="eda2" class="pm pn it mq b mr nk mu nl lr po lv pp lz pq mn pr ps pt pu bi translated"><code class="fe ng nh ni nj b">mass</code> -这颗行星比木星重多少倍</li><li id="b338" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn pr ps pt pu bi translated"><code class="fe ng nh ni nj b">distance</code> -这颗行星距离地球多少光年</li><li id="0766" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn pr ps pt pu bi translated"><code class="fe ng nh ni nj b">orbital_period</code> -地球绕其恒星一周需要多少个地球日</li></ol></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="f2fb" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">区间记数复习器</h2><p id="312a" class="pw-post-body-paragraph mo mp it mq b mr op kd mt mu oq kg mw lr or my mz lv os nb nc lz ot ne nf mn im bi translated">为了从这篇文章中获得最大的收获，并理解我将使用的一些语言，这里有一个关于区间符号的温和复习:</p><ul class=""><li id="8ee6" class="pm pn it mq b mr nk mu nl lr po lv pp lz pq mn qa ps pt pu bi translated"><strong class="mq jd"> (1，10) </strong>:两边不闭合。不要在区间中包含1和10</li><li id="fc4b" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><strong class="mq jd">【1，10】</strong>:左闭区间。包括1但不包括10</li><li id="28fa" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><strong class="mq jd"> (1，10)</strong>:右闭区间。包括10个，但不包括1个</li><li id="6dee" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><strong class="mq jd">【1，10】</strong>:两边闭合。包括1和10</li></ul></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="3a1b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">熊猫<code class="fe ng nh ni nj b">qcut()</code></h2><p id="cbf8" class="pw-post-body-paragraph mo mp it mq b mr op kd mt mu oq kg mw lr or my mz lv os nb nc lz ot ne nf mn im bi translated">为了理解<code class="fe ng nh ni nj b">qcut()</code>是如何工作的，让我们从直方图开始:</p><pre class="ks kt ku kv gt pe nj pf pg aw ph bi"><span id="7ad6" class="li lj it nj b gy pi pj l pk pl">sns.histplot(planets['mass'])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/b27250969ac0fa497f3017dc8844e498.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ypSkYXKR39KTmSC1XI4hRg.png"/></div></figure><p id="490c" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">直方图自动将一个数组或一个数字列表分成几个箱，每个箱包含不同数量的观察值。在<code class="fe ng nh ni nj b">seaborn</code>中，可以控制箱子的数量:</p><pre class="ks kt ku kv gt pe nj pf pg aw ph bi"><span id="4089" class="li lj it nj b gy pi pj l pk pl">sns.histplot(planets['mass'], bins=10)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/061e09d46096a2abe595a2c85175c385.png" data-original-src="https://miro.medium.com/v2/format:webp/1*LK7SL7tR2zQpgHLupQnBsQ.png"/></div></figure><p id="9281" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">直方图是你可能见过的第一个宁滨数据的例子。下面是使用<code class="fe ng nh ni nj b">pandas</code>的<code class="fe ng nh ni nj b">describe()</code>功能的另一个例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="90a5" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">默认情况下，<code class="fe ng nh ni nj b">describe()</code>将数字列划分为4个桶(箱)-(最小，25日)，(25日，中值)，(中值，75日)，(75日，最大)，并显示箱边缘。您还可以为函数传递自定义百分点:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/32056889a38d7dd46899d0b2e134458b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xfXCgebtj22U46zOtOTAVQ.png"/></div></figure><p id="c26d" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">这些都是宁滨数据的例子。但是如果你注意到了，在上面所有的例子中，我们不能真正地控制箱子。我们只是选择箱子的数量，仅此而已。此外，你不能真的把这些箱子从它们的特定功能中分离出来。</p><p id="9db9" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">现在，这里有一个问题:如何将每个观察值所属的bin存储在一个新列中，或者为以后执行一些操作？这就是<code class="fe ng nh ni nj b">qcut()</code>和<code class="fe ng nh ni nj b">cut()</code>的用武之地。</p><p id="a68e" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">首先，让我们探索一下<code class="fe ng nh ni nj b">qcut()</code>功能。它作用于任何类似数字数组的对象，如列表、<code class="fe ng nh ni nj b">numpy.array</code>或<code class="fe ng nh ni nj b">pandas.Series</code>(数据帧列)，并将它们分成多个箱(桶)。<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.qcut.html" rel="noopener ugc nofollow" target="_blank">文档</a>称其正式名称为基于分位数的离散化函数。</p><p id="6b61" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">让我们从一般语法开始:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="bd67" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">如果您第一次看到这个输出，它可能会非常吓人。但是请耐心听我说，你很快就会掌握这个功能。</p><p id="8a4f" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">该函数的第一个参数是要装箱的列。下一个需要的参数是<code class="fe ng nh ni nj b">q</code>，它代表<em class="ox">分位数</em>。<code class="fe ng nh ni nj b">qcut()</code>将数据分成百分位箱，而不是用数字边缘构建每个箱。</p><p id="9365" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">让我们分别研究输出的不同部分。当我们将<code class="fe ng nh ni nj b">q</code>设置为4时，我们告诉<code class="fe ng nh ni nj b">pandas</code>创建4个区间或区间，并让它自己计算出放置值的位置。</p><p id="4e37" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">最后一行给出了每个区间的边，分别是(1.349，24.498)，(24.498，39.94)，(39.94，59.332)，(59.332，354)。区间边缘对应于一个百分点值，取决于<code class="fe ng nh ni nj b">q</code>的值(在这种情况下，最小值、第25个百分点、中值、第75个百分点、最大值)。我们可以用<code class="fe ng nh ni nj b">describe()</code>函数验证这一点，因为它也将数据分成4个分位数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="948a" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">如您所见，<code class="fe ng nh ni nj b">min</code>、<code class="fe ng nh ni nj b">max</code>、<code class="fe ng nh ni nj b">median</code>、25、75个百分点的值都是相同的。</p><p id="31eb" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">现在，主要的部分:如果你看实际的结果，每一行或索引被放入四个容器中的一个。默认情况下，<code class="fe ng nh ni nj b">pandas</code>为每个观察值提供文字数字箱名称。为了更好地了解情况，让我们将输出存储到一个新列中:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/4429033386e82843a279f18ca5a91127.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QYW7iFid33GYQm7fezhDAA.png"/></div></figure><p id="4e64" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">存储后，我们可以更好地鸟瞰数据帧。您可以验证每个<code class="fe ng nh ni nj b">distance</code>值是否放在正确的区间内。我还引入了一个新的参数<code class="fe ng nh ni nj b">precision</code>，它让我们指定要保留的小数点位数。</p><p id="f68e" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">然而，新专栏仍未达到最佳状态。理想的情况是，如果可以为每个区间指定特定的标签。这将提高我们数据的可读性。</p><p id="24b1" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">为了实现这一点，我们需要创建一个标签列表，并将其传递给<code class="fe ng nh ni nj b">qcut()</code>的<code class="fe ng nh ni nj b">labels</code>参数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/b6e5342fc1f80f665f572553760507a3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SVudqBx1DFFXlmluZ-dAnA.png"/></div></figure><p id="45f2" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">好多了！但是，我们仍然没有谈到<code class="fe ng nh ni nj b">qcut()</code>的定义点。让我们在最新的列上调用<code class="fe ng nh ni nj b">value_counts()</code>函数，看看会发生什么:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="ba3b" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">如果分布中没有太多极值，那么每个箱中的值的数量将会超级接近。如果你熟悉统计学，这是有意义的，因为我已经说过<code class="fe ng nh ni nj b">qcut()</code>定义了箱边缘为分布的百分位数。</p><p id="d836" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">注意，这并不意味着容器的大小是相同的。如果你从右边减去箱子的左边，你会得到不同的结果。例如，让我们将质量分成5个箱，并获得每个箱的宽度:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="ca45" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">将<code class="fe ng nh ni nj b">retbins</code>(代表返回箱)设置为<code class="fe ng nh ni nj b">True</code>会返回一个额外的<code class="fe ng nh ni nj b">numpy.ndarray</code>，包含我们切割的箱边缘。我用一个循环来显示每个箱子的宽度来验证我的观点。</p><p id="bd1b" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">为了下一节简单起见，我将删除新列:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="03d2" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">熊猫<code class="fe ng nh ni nj b">cut()</code></h2><p id="8f68" class="pw-post-body-paragraph mo mp it mq b mr op kd mt mu oq kg mw lr or my mz lv os nb nc lz ot ne nf mn im bi translated">在讨论了<code class="fe ng nh ni nj b">qcut()</code>之后，你现在能够理解<code class="fe ng nh ni nj b">cut()</code>之间的差异。</p><p id="6a0f" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated"><code class="fe ng nh ni nj b">qcut()</code>对我们的数据进行划分，使每个条柱中的值数量大致相同，但条柱范围不同。第一部分中的许多概念在这里也适用。</p><p id="ba23" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">主要区别在于<code class="fe ng nh ni nj b">cut()</code>使用实际的数字箱边缘，默认情况下，它将分布划分为大小相等的箱。与<code class="fe ng nh ni nj b">qcut()</code>正好相反。我们先来看一个例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="9672" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">我们将<code class="fe ng nh ni nj b">mass</code>列分为三个不同的类别。和以前一样，我将把结果存储回数据框，并对其调用<code class="fe ng nh ni nj b">value_counts()</code>:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/118bcc1565a9517efe09cd3fe74e367d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ChXaLy5DfgVd-cPbz55Xpg.png"/></div></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="df54" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">此外，让我们看看每个箱的范围:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="0f41" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">如您所见，这一次箱的宽度大致相同，我们在每个箱中有不同数量的观测值。</p><p id="a7f3" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">当我们想要为箱子定义自定义范围时，<code class="fe ng nh ni nj b">cut</code>的真正威力就发挥出来了。通常，对于真实数据，您不想让<code class="fe ng nh ni nj b">pandas</code>自动为您定义边缘。例如，如果您在一家电话公司工作，您可能希望根据服务的总体持续时间对客户进行分类。您可能会优先考虑合作时间较长的客户，并相应地对其他客户进行排序。</p><p id="e3a3" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">让我们来看一个为<code class="fe ng nh ni nj b">mass</code>定制宁滨的例子。我们将创建4个间隔，并给它们定制标签:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl pd"><img src="../Images/8092109903219e18dd0d3ad6bdf341f3.png" data-original-src="https://miro.medium.com/v2/format:webp/1*fH2A0wsPNoUcCJ300_Dzmg.png"/></div></figure><p id="8d4a" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">这个例子清楚地显示了<code class="fe ng nh ni nj b">cut</code>提供的灵活性。<code class="fe ng nh ni nj b">bins</code>参数可以接受3种选择:</p><ul class=""><li id="ceb7" class="pm pn it mq b mr nk mu nl lr po lv pp lz pq mn qa ps pt pu bi translated"><em class="ox">一个整数</em>:我们已经看到例子了。如果传递一个整数，该函数将创建范围相等的存储桶。</li><li id="1d81" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><em class="ox">一系列数字或标量</em>:当传递一系列数字时，该函数将它们视为自定义bin边缘。箱的数量将总是比箱边缘的总数少1。</li><li id="3694" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><code class="fe ng nh ni nj b"><em class="ox">pandas.IntervalIndex</em></code> <em class="ox">对象</em>:也可以使用<code class="fe ng nh ni nj b">pandas.interval_range</code>函数传递自定义范围(稍后将详细介绍)。</li></ul><p id="36a3" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">通常，在一个列表中定义自定义的bin范围是很棘手的。所以最好使用<code class="fe ng nh ni nj b">numpy.arange</code>或<code class="fe ng nh ni nj b">numpy.linspace</code>功能。两者都创建了一个等间距的数字序列，可以作为<code class="fe ng nh ni nj b">cut</code>的bin范围传递。你可以在这篇有用的文章中了解更多关于这些功能的信息。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="1014" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">在上面代码片段的第一行，我们创建了一个包含5个元素的<code class="fe ng nh ni nj b">numpy.ndarray</code>。因此，<code class="fe ng nh ni nj b">cut</code>将为<code class="fe ng nh ni nj b">distance</code>减少一个间隔数。</p><p id="f373" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">一般的经验法则是对较少的箱使用简单的列表，但对许多区间使用<code class="fe ng nh ni nj b">numpy</code>函数。</p><p id="9cba" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">使用<code class="fe ng nh ni nj b">pandas.interval_range</code>基本可以得到相同的音程。该函数，而不是列表，返回可以进一步定制的<code class="fe ng nh ni nj b">IntervalIndex</code>对象:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="054a" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">是的，基本上是一样的，但是有一个额外的参数使这个函数非常有用:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="41b5" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated"><code class="fe ng nh ni nj b">closed</code>参数接受4个字符串来控制间隔边缘:</p><ul class=""><li id="526b" class="pm pn it mq b mr nk mu nl lr po lv pp lz pq mn qa ps pt pu bi translated"><em class="ox">左侧</em>:左侧<strong class="mq jd"/>关闭</li><li id="e099" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><em class="ox">右侧</em>:右侧<strong class="mq jd">(</strong>)关闭(默认)</li><li id="ad19" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><em class="ox">两边</em>:<strong class="mq jd"/>两边关闭</li><li id="842c" class="pm pn it mq b mr pv mu pw lr px lv py lz pz mn qa ps pt pu bi translated"><em class="ox"/>:<strong class="mq jd">()</strong>两边都不闭合</li></ul><p id="0b74" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">一个带有<code class="fe ng nh ni nj b">cut</code>的例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pb pc l"/></div></figure><p id="07c4" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">使用<code class="fe ng nh ni nj b">interval_range</code>的缺点是在<code class="fe ng nh ni nj b">cut</code>中不能使用标签。</p><p id="fc9c" class="pw-post-body-paragraph mo mp it mq b mr nk kd mt mu nl kg mw lr nm my mz lv nn nb nc lz no ne nf mn im bi translated">关于参数也有一些细微差别，所以一定要查看<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.cut.html" rel="noopener ugc nofollow" target="_blank">文档</a>以了解本质细节。另外，这里有一篇类似的<a class="ae lh" href="https://pbpython.com/pandas-qcut-cut.html" rel="noopener ugc nofollow" target="_blank">文章</a>，比较了来自实用商业Python的<code class="fe ng nh ni nj b">cut</code>和<code class="fe ng nh ni nj b">qcut</code>。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="e8b3" class="qb lj it bd lk qc qd qe ln qf qg qh lq ki qi kj lu kl qj km ly ko qk kp mc ql bi translated">如果你喜欢这篇文章，请分享并留下反馈。作为一名作家，你的支持对我来说意味着一切！</h1><p id="c37d" class="pw-post-body-paragraph mo mp it mq b mr op kd mt mu oq kg mw lr or my mz lv os nb nc lz ot ne nf mn im bi translated">阅读更多与主题相关的文章:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">认识熊猫最难的功能，第一部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">掌握pivot_table()、stack()、unstack()的时机和方式</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qm l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">认识熊猫最难的功能，第二部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">掌握交叉表的时间和方式()</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qn l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">认识熊猫最难的功能，第三部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">形状像果冻的桌子有熊猫旋转()和融化()</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qo l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">来自Kagglers:DS和ML的最佳项目设置</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">来自顶级Kagglers的项目成功最佳实践的集合</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qp l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/ever-wanted-progress-bars-in-jupyter-bdb3988d9cfc"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">想要Jupyter的进度条吗？</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">对你的长时间循环进行健全性检查(和一点视觉风格)</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qq l od oe of ob og lb ns"/></div></div></a></div></div></div>    
</body>
</html>