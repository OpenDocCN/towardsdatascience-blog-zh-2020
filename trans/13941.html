<html>
<head>
<title>Determining Optimal Distribution Centers locations using Weighted K-Means</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用加权K-均值确定最优配送中心位置</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/determining-optimal-distribution-centers-locations-using-weighted-k-means-1dd099726307?source=collection_archive---------20-----------------------#2020-09-25">https://towardsdatascience.com/determining-optimal-distribution-centers-locations-using-weighted-k-means-1dd099726307?source=collection_archive---------20-----------------------#2020-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cb01" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">寻找在美国分发新冠肺炎疫苗所需的DC的位置和最佳数量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ec673986f409cc363d851b1aaa93e7b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_SH07t2f-FITkBa0"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> CHUTTERSNAP </a>拍摄</p></figure><h2 id="044c" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">背景</h2><p id="909b" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在座的各位一定听说过亚马逊及其近年来的增长。亚马逊成功的主要原因之一是其供应链管理。所有至少从亚马逊订购过一次的人都应该熟悉他们广受欢迎的1日送达服务。有没有想过像亚马逊这样的公司如何能如此迅速地将产品送到美国的任何地方？</p><p id="97ec" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">考虑到美国广袤的土地和他们每天从全国各地收到的订单数量，这不是一个简单的任务。事实证明，你订购的大多数产品都是直接从你所在的州发货，而不是从其他地方。所有像沃尔玛、亚马逊这样的公司都会根据客户需求预测，在配送中心储存客户不急需的剩余产品。</p><p id="acdf" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">所有的服务，如产品混合、订单履行、跨站台、包装都在配送中心完成。<strong class="lu ir"> </strong>这些DC的位置便于在最短的时间内将货物运送到最大的区域。任何公司要想取得成功，有效的供应链战略是必不可少的，而DC在供应链战略中扮演着至关重要的角色。</p><h2 id="d96a" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">问题</strong></h2><p id="61d2" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">9月24日，美国的COVID 19例病例总数已突破700万大关。另一方面，许多国家，如英国，声称他们的新冠肺炎疫苗开发已进入最后阶段，将于2020年底发布。我认为了解疫苗何时最终发布并在所有医院分发会很有趣，包括美国治疗新冠肺炎患者的临床中心。如果美国政府计划利用配送中心向所有治疗新冠肺炎患者的医院提供疫苗接种，<em class="mq">DC的配送中心应该设在哪里？需要多少个DC？</em></p><p id="5c3a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">首先，我从维基百科的一些网络垃圾开始，得到美国所有医院的地址和郡名。并将医院区域的县名与该区域中活跃的新冠肺炎病例进行匹配。为了使绘图和查找距离更容易，我使用地理编码找到了所有地址的纬度和经度，对此我在之前的博客中清楚地解释了步骤。</p><div class="mr ms gp gr mt mu"><a rel="noopener follow" target="_blank" href="/geocoding-and-reverse-geocoding-using-python-36a6ad275535"><div class="mv ab fo"><div class="mw ab mx cl cj my"><h2 class="bd ir gy z fp mz fr fs na fu fw ip bi translated">使用Python进行地理编码和反向地理编码</h2><div class="nb l"><h3 class="bd b gy z fp mz fr fs na fu fw dk translated">当地址已知时查找纬度和经度，或者如果纬度和经度是…</h3></div><div class="nc l"><p class="bd b dl z fp mz fr fs na fu fw dk translated">towardsdatascience.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni kp mu"/></div></div></a></div><p id="b98a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">找到所有医院的经纬度后对数据集的一瞥</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/78667c0f46832d2c365e6410826f825b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcIjRbvul1aa1ThMggFtyg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图一。美国医院位置数据</p></figure><p id="3627" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">既然我们有了纬度和经度，就很容易把它们标绘出来。下图显示了美国所有使用python中的follow地图生成的活跃新冠肺炎病例的医院。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/700cd487a963b56c7c395f53633351c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7d73ZR97LEckHnkkMWhZiA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图二。美国有活跃新冠肺炎病例数的医院位置(图片由作者提供)</p></figure><p id="4047" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">这里，圆圈较大的点代表新冠肺炎活跃病例较多的区域。可以清楚地看到，加利福尼亚州的一些地区的活跃病例数最高。回到我们的问题，我们正试图找到配送中心向所有医院供应疫苗的最佳位置。这里，为特定医院确定DC的位置类似于将所有医院分成不同的集群，并为每个医院集群定位一个质心点。这种情况与K-Means聚类算法非常相似。因此，可以应用K-均值聚类。</p><p id="c62b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">(标准)K均值聚类是如何工作的？</p><p id="491a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">K均值聚类是一种流行的无监督ML算法，用于将数据划分为K个聚类。该算法反复工作，将每个数据点分配给<em class="mq"> K </em>个组中的一个。数据被随机分成K组，每组分配一个平均质心点，算法迭代以找到:</p><ol class=""><li id="9c4d" class="nl nm iq lu b lv ml ly mm lf nn lj no ln np mk nq nr ns nt bi translated">所有数据点到质心点之间的距离，并通过将数据点重新分配到其最近的质心来形成新的聚类。</li><li id="8036" class="nl nm iq lu b lv nu ly nv lf nw lj nx ln ny mk nq nr ns nt bi translated">再次通过取距离的平均值找到新的质心点。</li></ol><p id="3b83" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">重复这个过程，直到距离平方和最小，或者达到预定的极限。</p><p id="68c5" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在开始k-means之前要执行的一个重要步骤是决定聚类的数量。K的数量是一个预定义的超参数，应该对其进行调整以获得最佳结果。这可以使用肘方法来完成，本文稍后将对此进行简要说明。</p><p id="f6b5" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">这是一个通用的算法，可用于任何分组。用例的一些例子是基于需求的库存分组或基于购买的客户细分。</p><p id="7efd" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">解题:</strong></p><p id="2118" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们在这里的唯一问题是，应该更多地优先考虑新冠肺炎病例更活跃的地点。这就是加权K均值聚类发挥作用的地方。</p><blockquote class="nz"><p id="9bea" class="oa ob iq bd oc od oe of og oh oi mk dk translated">标准的K-means方法不会起作用，因为它没有考虑到这样一个事实，即医院所在的一些地区有更多活跃的新冠肺炎病例，这意味着对要供应的疫苗有更高的需求量。</p></blockquote><p id="44a9" class="pw-post-body-paragraph ls lt iq lu b lv oj jr lx ly ok ju ma lf ol mc md lj om mf mg ln on mi mj mk ij bi translated"><strong class="lu ir">加权K均值与标准K均值有何不同？</strong></p><p id="03c6" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">加权K-均值与标准K-均值聚类的工作原理相同。唯一的区别是，不是仅仅根据距离的平均值来计算质心点。应该使用加权平均值。因此，数据点的权重越大，质心将被拉得越近。下图显示了标准K均值和加权K均值的对比。这里，在右图中，W2和W3的数据点权重较高。所以，质心被拉着它们而不是位于中心。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/d949930b1a1cfdeb1a126c14dde6f6f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*XIPX836WZjE2ed3Wv7DCPA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图三。不带权重的左侧图像与带权重的右侧图像(作者提供的图像)</p></figure><p id="7503" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">权重可以赋予我们想要从数据集中得到的任何变量，如城市或城市的总人口。在我们的例子中，权重将给予每个县的总活跃新冠肺炎病例。所以应该给他们更多的优先权。</p><p id="3d11" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">另一个问题是，我们不能使用传统的欧几里德距离作为距离度量来寻找质心点，因为我们有代表地球球面维度的纬度和经度，而不是欧几里德距离中的2D (x，y)坐标。许多选项可用于计算两个球形点之间的距离，如<a class="ae kv" href="https://en.wikipedia.org/wiki/Haversine_formula" rel="noopener ugc nofollow" target="_blank">哈弗线距离</a>或大圆距离。我们将使用哈弗线距离。</p><p id="21ac" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">哈弗森距离</strong></p><p id="7f41" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">哈弗线距离d可以用下面的公式求出，其中φ代表纬度，λ代表经度。</p><p id="70a5" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><em class="mq">A = sin((φB—φA)/2)+cosφA * cosφB * sin((λB—λA)/2)</em></p><p id="ab23" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><em class="mq"> c = 2 * atan2( √a，√( 1a))</em></p><p id="e3a5" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><em class="mq"> d = R ⋅ c (R =地球半径，即6371公里)</em></p><p id="38b3" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">幸运的是，我们不需要使用所有这些公式来计算哈弗辛距离，因为在python中，有一个名为哈弗辛的库，它用一行代码直接计算位置坐标之间的距离</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="f547" class="kw kx iq oq b gy ou ov l ow ox">from haversine import haversine<br/>haversine((31.215827,-85.363433),(28.703230,-81.815668))</span></pre><p id="b386" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">使用具有哈弗线距离的加权K-Means作为距离度量，创建了一个改进的加权K-Means算法，可以在我的<a class="ae kv" href="https://github.com/JaswanthBadvelu/Optimal_DC_locator" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到。</p><p id="2953" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">最后，我们需要确定配送中心的最佳数量，以更好地满足需求并最小化配送费用。即k的最佳数量。这可以使用肘方法来确定。</p><p id="f3cd" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">肘法</strong></p><p id="15ff" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在聚类分析中，肘方法是一种启发式方法，用于确定数据集中聚类的最佳数量。计算'<strong class="lu ir"> k' </strong>的不同值的组内误差平方和(SSE)<strong class="lu ir">。对于</strong>而言，无论哪个<strong class="lu ir">‘k’</strong>值WSS首先开始变小，都选择那个特定的<strong class="lu ir">‘k’</strong>。通常，形成<em class="mq">弯头形状</em>的K值被认为是最佳值。SSE只不过是所有聚类中每个数据点到各自质心的距离的平方和。下图显示了SSE与我们数据的聚类数的关系。因为在4个聚类之后SSE值的降低不再显著。K=4可以被认为是我们的最佳K值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/d6bdde9760b4ab3e1922462adc5b90bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*v4bYaIeGvvON0m7gUdRGdA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4。确定最佳聚类(K=4)的肘方法(图片由作者提供)</p></figure><p id="c6c9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">最后，我们发现4是所需配送中心的最佳数量。在用4个集群实现了我们的算法之后，DC发现的位置如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/f9b88780792bcbda3ea9cfa700c9a691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unkBjF6Zd-gSLsz6QZNJkw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图五。美国最佳配送中心位置(图片由作者提供)</p></figure><p id="c809" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">实施该算法后发现的推荐DC位置为:</p><ol class=""><li id="dda8" class="nl nm iq lu b lv ml ly mm lf nn lj no ln np mk nq nr ns nt bi translated">加州河滨</li><li id="ccbf" class="nl nm iq lu b lv nu ly nv lf nw lj nx ln ny mk nq nr ns nt bi translated">德克萨斯州达拉斯</li><li id="2ff6" class="nl nm iq lu b lv nu ly nv lf nw lj nx ln ny mk nq nr ns nt bi translated">伊利诺伊州厄巴纳</li><li id="1d87" class="nl nm iq lu b lv nu ly nv lf nw lj nx ln ny mk nq nr ns nt bi translated">弗吉尼亚州彼得斯堡。</li></ol><h2 id="d0ca" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h2><p id="cdb3" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在本文中，应用加权K-均值聚类算法来确定最佳分布位置进行了演示。综上所述，在这种改进的K-Means聚类中，通过考虑加权平均值而不是平均值来计算质心，并且使用哈弗斯距离而不是欧几里德距离。</p><p id="0279" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">希望那有用！如果你有任何问题，请随时在LinkedIn上给我发信息。并且代码可以在我的<a class="ae kv" href="https://github.com/JaswanthBadvelu/Optimal_DC_locator" rel="noopener ugc nofollow" target="_blank"> Github库</a>中找到。</p></div></div>    
</body>
</html>