<html>
<head>
<title>Building a Movie Recommender using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python构建电影推荐器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-movie-recommender-using-python-277959b07dae?source=collection_archive---------8-----------------------#2020-09-24">https://towardsdatascience.com/building-a-movie-recommender-using-python-277959b07dae?source=collection_archive---------8-----------------------#2020-09-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cf6a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用sci-kit learn的简单实用的机器学习项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3bef3c1f0e03d1ed901cc79d62dccc28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JRxBm9B2uTT6vwdY2Jsqbw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@morningbrew?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">晨酿</a>在<a class="ae ky" href="https://unsplash.com/s/photos/apple-tv?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5139" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">在这篇文章中，我将向你展示如何使用Python来构建一个电影推荐程序。这将是一个简单的项目，我们将能够看到机器学习如何在我们的日常生活中使用。如果你查看我的其他文章，你会发现我喜欢演示动手项目。我觉得这是练习我们编码技能，提升自己的最好方式。建立一个电影推荐程序是开始使用机器推荐器的好方法。在分享了目录之后，我想给你介绍一下推荐系统。</span></p><h2 id="6f78" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">内容</h2><ul class=""><li id="4d06" class="mx my it lb b lc mz lf na li nb lm nc lq nd lu ne nf ng nh bi translated"><strong class="lb iu">简介</strong></li><li id="0357" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><strong class="lb iu">电影数据</strong></li><li id="278f" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><strong class="lb iu">数据准备</strong></li><li id="b2dc" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><strong class="lb iu">基于内容的推荐器</strong></li><li id="a1d0" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><strong class="lb iu">显示时间</strong></li><li id="bd95" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated"><strong class="lb iu">视频演示</strong></li></ul></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="36d5" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">介绍</h1><p id="4129" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">推荐系统已经伴随我们有一段时间了，它们是如此的强大。这些天来，他们确实对我们的决定有很大的影响。从电影流媒体服务到在线购物商店，它们几乎无处不在。如果你想知道在你的购物车中添加一个“x”项目后，他们如何知道你可能会购买什么，答案很简单:<strong class="lb iu"> <em class="oi">数据的力量</em> </strong>。</p><p id="d244" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能看起来非常不同，但我们的习惯可能非常相似。这些公司喜欢寻找他们客户的相似习惯。由于他们知道许多购买了“x”商品的人也购买了“y”商品，他们建议您将“y”商品添加到购物车中。你猜怎么着，你买得越多，你就在训练你自己的推荐者，这意味着机器会更了解你。</p><p id="c5fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">推荐系统是机器学习的一个非常有趣的领域，它的酷之处在于它就在我们身边。关于这个话题有很多东西要学，为了简单起见，我就讲到这里。让我们开始建立自己的电影推荐系统吧！</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="d900" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">电影数据</h1><p id="7553" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">我在Kaggle上找到了很棒的电影数据。如果你没有听说过Kaggle，Kaggle是世界上最大的数据科学社区，拥有强大的工具和资源来帮助你实现数据科学目标。</p><p id="8a55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是下载<a class="ae ky" href="https://www.kaggle.com/rounakbanik/the-movies-dataset/data" rel="noopener ugc nofollow" target="_blank">数据集</a>的链接。</p><h2 id="37f4" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">语境</h2><ul class=""><li id="0a31" class="mx my it lb b lc mz lf na li nb lm nc lq nd lu ne nf ng nh bi translated">数据文件夹包含完整的<a class="ae ky" href="https://grouplens.org/datasets/movielens/latest/" rel="noopener ugc nofollow" target="_blank"> MovieLens </a>数据集中列出的所有45，000部电影的元数据。</li><li id="0108" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">该数据集由2017年7月或之前上映的电影组成。数据点包括演员、工作人员、情节关键词、预算、收入、海报、上映日期、语言、制作公司、国家、TMDB票数和平均票数。</li><li id="bc37" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">该数据文件夹还包含评级文件，该文件具有来自270，000个用户对所有45，000部电影的2，600万个评级。</li></ul></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="9158" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">数据准备</h1><p id="4493" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">首先，让我们从导入和探索我们的数据开始。下载数据文件夹后，您将多个数据集文件。对于这个项目，我们将使用<em class="oi"> movies_metadata.csv </em>数据集。这个数据集包含了我们创建电影推荐器所需的所有内容。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="bece" class="me mf it ok b gy oo op l oq or">import pandas as pd</span><span id="1fba" class="me mf it ok b gy os op l oq or">#load the data<br/>movie_data = pd.read_csv('data/movie_data/movies_metadata.csv', low_memory=False)</span><span id="5bee" class="me mf it ok b gy os op l oq or">movie_data.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/c03e57efac5e0aefae6c7a098e16970a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfpRz1BY81xRUb5b3du1qg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">电影数据头</p></figure><h2 id="a787" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">绘图概述</h2><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="d8e0" class="me mf it ok b gy oo op l oq or">movie_data['overview'].head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/bb0c47aab475e2cc98351d96c3d4b326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-AR-aGl8CKLc0DmhylLVcA.png"/></div></div></figure><p id="cdd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完美！我们的数据都准备好了。准备接受我们模特的训练。是时候进入下一步了，我们将开始构建基于内容的推荐器。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="8182" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">基于内容的推荐器</h1><p id="36c4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">基于内容的推荐器是一种推荐模型，它根据特定的项目返回项目列表。推荐者的一个很好的例子是网飞、YouTube、Disney+等等。例如，网飞推荐你以前看过的更喜欢的类似节目。通过这个项目，你将更好地理解这些在线流媒体服务的算法是如何工作的。</p><p id="aafd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回到这个项目，作为训练我们模型的输入，我们将使用我们之前检查过的电影的概述。然后我们将使用一些sci-kit learn ready函数来构建我们的模型。我们的推荐程序将在四个简单的步骤中准备就绪。我们开始吧！</p><h2 id="65f1" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">1.定义矢量器</h2><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="2e74" class="me mf it ok b gy oo op l oq or">from sklearn.feature_extraction.text import TfidfVectorizer</span><span id="3fbd" class="me mf it ok b gy os op l oq or">tfidf_vector = TfidfVectorizer(stop_words='english')</span><span id="f97e" class="me mf it ok b gy os op l oq or">movie_data['overview'] = movie_data['overview'].fillna('')</span><span id="064f" class="me mf it ok b gy os op l oq or">tfidf_matrix = tfidf_vector.fit_transform(movie_data['overview'])</span></pre><p id="13e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解上面的代码</p><ul class=""><li id="537b" class="mx my it lb b lc ld lf lg li ov lm ow lq ox lu ne nf ng nh bi translated">从sci-kit学习模块导入矢量器。在这里了解更多<a class="ae ky" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="ae36" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">Tf-idf矢量器对象删除所有英文停用词，如' the '，' a '等。</li><li id="2c51" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">我们用空字符串替换空值，这样在训练它们时就不会返回错误消息。</li><li id="5cbc" class="mx my it lb b lc ni lf nj li nk lm nl lq nm lu ne nf ng nh bi translated">最后，我们通过拟合和转换数据来构建所需的Tf-idf矩阵</li></ul><h2 id="2f4f" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">2.线性核</h2><p id="2456" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">我们将从sci-kit学习模块中导入线性内核函数开始。线性核将帮助我们创建一个相似性矩阵。这些行执行起来要花一点时间，不要担心这是正常的。计算两个巨大矩阵的点积并不容易，即使对机器来说也是如此:)</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="859a" class="me mf it ok b gy oo op l oq or">from sklearn.metrics.pairwise import linear_kernel</span><span id="cc8e" class="me mf it ok b gy os op l oq or">sim_matrix = linear_kernel(tfidf_matrix, tfidf_matrix)</span></pre><h2 id="4352" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">3.指数</h2><p id="e1a7" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">现在，我们必须构建索引和电影标题的反向映射。在系列函数的第二部分，我们用一个简单的函数<em class="oi"> drop_duplicates </em>清除重复的电影标题。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="0e87" class="me mf it ok b gy oo op l oq or">indices = pd.Series(movie_data.index, index=movie_data['title']).drop_duplicates()</span><span id="3cd2" class="me mf it ok b gy os op l oq or">indices[:10]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/42cb7aa524100d2f6ed47e8144cbb331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gYJFCU5hJ7yYR3C1xscjFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">前十个指数</p></figure><h2 id="6f06" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">4.最后—推荐功能</h2><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="3b72" class="me mf it ok b gy oo op l oq or">def content_based_recommender(title, sim_scores=sim_matrix):<br/>    idx = indices[title]</span><span id="503c" class="me mf it ok b gy os op l oq or">    sim_scores = list(enumerate(sim_matrix[idx]))</span><span id="282b" class="me mf it ok b gy os op l oq or">    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)</span><span id="f4be" class="me mf it ok b gy os op l oq or">    sim_scores = sim_scores[1:11]</span><span id="054a" class="me mf it ok b gy os op l oq or">    movie_indices = [i[0] for i in sim_scores]</span><span id="d3cc" class="me mf it ok b gy os op l oq or">    return movie_data['title'].iloc[movie_indices]</span></pre></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="224d" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">秀场</h1><p id="76c8" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">干得好！是时候测试我们的推荐者了。让我们看看实际情况，看看它到底有多强大。我们将通过添加电影名称作为一个字符串参数来运行该函数。</p><h2 id="9771" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">类似《玩具总动员》的电影</h2><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="51c6" class="me mf it ok b gy oo op l oq or">content_based_recommender('Toy Story')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/8cc1cfdfc0c353aa960309204c3b37fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QOOXQ0dNWQXFF3CR_Q6Hzg.png"/></div></div></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="de8a" class="nu mf it bd mg nv nw nx mj ny nz oa mm jz ob ka mp kc oc kd ms kf od kg mv oe bi translated">视频演示</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pa pb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">项目视频演示</p></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><p id="6331" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你。！您创建了一个向您推荐电影的程序。现在，当你想选择下一场网飞秀时，你有一个程序可以运行。希望你喜欢阅读这个动手项目。如果你今天学到了新东西，我会很高兴。从事像这样的动手编程项目是提高编码技能的最好方式。</p><p id="70e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在执行代码时有任何问题，请随时<a class="ae ky" href="https://sonsuzdesign.blog/" rel="noopener ugc nofollow" target="_blank">联系我</a>。</p><blockquote class="pc pd pe"><p id="5a90" class="kz la oi lb b lc ld ju le lf lg jx lh pf lj lk ll pg ln lo lp ph lr ls lt lu im bi translated">关注我的<a class="ae ky" href="https://medium.com/@lifexplorer" rel="noopener">博客</a>和<a class="ae ky" href="https://www.youtube.com/channel/UCmo4tnTcj92DlzES5hvlWwQ" rel="noopener ugc nofollow" target="_blank"> youtube </a>频道，保持灵感。谢谢你，</p></blockquote></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h2 id="4ba1" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">更多机器学习项目</h2><div class="pi pj gp gr pk pl"><a rel="noopener follow" target="_blank" href="/building-a-face-recognizer-in-python-7fd6630c6340"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">用Python构建人脸识别器</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">使用OpenCv库进行实时人脸识别的分步指南</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="pv l pw px py pu pz ks pl"/></div></div></a></div><div class="pi pj gp gr pk pl"><a rel="noopener follow" target="_blank" href="/extracting-speech-from-video-using-python-f0ec7e312d38"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">使用Python从视频中提取语音</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">使用Google语音识别API的简单实用项目</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="qa l pw px py pu pz ks pl"/></div></div></a></div></div></div>    
</body>
</html>