<html>
<head>
<title>A Beginners Guide to Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit初学者指南-学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-scikit-learn-14b7e51d71a4?source=collection_archive---------7-----------------------#2020-09-22">https://towardsdatascience.com/a-beginners-guide-to-scikit-learn-14b7e51d71a4?source=collection_archive---------7-----------------------#2020-09-22</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="92ef" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="2c63" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">开始使用排名第一的python机器学习库</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj ks"><img src="../Images/29e38ebb9ed3867db261ccc102fba581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhR0GNM_wrfEawQ4HfU2ZQ.jpeg"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">照片由<a class="ae li" href="https://unsplash.com/@clemhlrdt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克莱门特H </a>在<a class="ae li" href="https://unsplash.com/s/photos/code?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="21aa" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn ，最初是作为2007年谷歌代码之夏项目开发的，现在被广泛认为是最受欢迎的机器学习Python库。</p><p id="0116" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这个库被视为机器学习项目的最佳选择之一，尤其是在生产系统中，原因有很多。这些包括但不限于以下内容。</p><ul class=""><li id="f044" class="mf mg iu ll b lm ln lp lq ls mh lw mi ma mj me mk ml mm mn bi translated">它对库的开发有高级别的支持和严格的管理，这意味着它是一个非常健壮的工具。</li><li id="fcae" class="mf mg iu ll b lm mo lp mp ls mq lw mr ma ms me mk ml mm mn bi translated">有一个清晰、一致的代码风格，确保您的机器学习代码易于理解和可复制，同时也大大降低了编写机器学习模型的门槛。</li><li id="35d7" class="mf mg iu ll b lm mo lp mp ls mq lw mr ma ms me mk ml mm mn bi translated">它受到第三方工具的广泛支持，因此可以丰富功能以适应各种用例。</li></ul><p id="2b31" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果你正在学习机器学习，那么Scikit-learn可能是最好的入门库。它的简单性意味着它相当容易掌握，通过学习如何使用它，你也将很好地掌握典型的机器学习工作流程中的关键步骤。</p><p id="0f39" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下面的文章是对该工具的初学者友好的介绍，应该给你足够的理解，能够开发一个简单的机器学习模型。</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><p id="f9bb" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">要安装最新版本的Scikit-learn，请运行以下命令。</p><pre class="kt ku kv kw gu na nb nc nd aw ne bi"><span id="49c4" class="nf ng iu nb b gz nh ni l nj nk">pip install scikit-learn</span></pre><p id="3606" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">本文中的代码示例都是在经典的<a class="ae li" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_wine.html" rel="noopener ugc nofollow" target="_blank"> wine数据集</a>上运行的，该数据集可以直接从Scikit-learn API导入。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="62cd" class="nn ng iu bd no np nq nr ns nt nu nv nw kj nx kk ny km nz kn oa kp ob kq oc od bi translated">评估者</h1><p id="4277" class="pw-post-body-paragraph lj lk iu ll b lm oe ke lo lp of kh lr ls og lu lv lw oh ly lz ma oi mc md me in bi translated">Scitkit-learn库提供了非常多种预构建的算法来执行有监督和无监督的机器学习。他们通常被称为<strong class="ll je">估计器</strong>。</p><p id="f1bd" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">您为项目选择的评估者将取决于您拥有的数据集和您试图解决的问题。Scikit-learn文档提供了下图，帮助您确定哪种算法适合您的任务。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oj"><img src="../Images/fdb47601dc406385d9a0355f9deb03e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k67P_Lh18fp2WCIJph1HHw.png"/></div></div><p class="le lf gk gi gj lg lh bd b be z dk translated">来源:<a class="ae li" href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html" rel="noopener ugc nofollow" target="_blank"> Scikit-learn文档</a></p></figure><p id="d761" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn之所以如此易于使用，是因为不管您使用的是什么模型或算法，用于模型训练和预测的代码结构都是相同的。</p><p id="343b" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">为了说明这一点，我们来看一个例子。</p><p id="56f5" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">假设您正在处理一个回归问题，并希望训练一个线性回归算法，并使用生成的模型进行预测。使用Scikit-learn的第一步是调用<a class="ae li" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank">逻辑回归估计器</a>，并将其保存为一个对象。下面的例子调用算法并将其保存为一个名为<strong class="ll je"> lr </strong>的对象。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><p id="8a4e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">下一步是使模型符合一些训练数据。这是使用<strong class="ll je"> fit() </strong>方法完成的。我们在特性和目标数据上调用<code class="fe ok ol om nb b"><strong class="ll je">lr.fit()</strong></code>，并将结果模型保存为一个名为<strong class="ll je">模型</strong>的对象。在下面的例子中，我也使用了<code class="fe ok ol om nb b"><strong class="ll je">train_test_split()</strong></code>方法将数据集分成测试和训练数据。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><p id="27ef" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">接下来，我们使用该模型和<strong class="ll je"> predict() </strong>方法来预测之前未见过的数据。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><p id="e1c1" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果我们现在使用Scitkit-learn来执行不同的任务，比方说，我们想要训练一个随机森林分类器。代码看起来非常相似，并且有相同的步骤数。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><p id="209d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这种一致的代码结构使得开发机器学习模型非常直接，并且还产生了高度可读和可再现的代码。</p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="f375" class="nn ng iu bd no np nq nr ns nt nu nv nw kj nx kk ny km nz kn oa kp ob kq oc od bi translated">预处理</h1><p id="1ab5" class="pw-post-body-paragraph lj lk iu ll b lm oe ke lo lp of kh lr ls og lu lv lw oh ly lz ma oi mc md me in bi translated">在大多数现实世界的机器学习项目中，您使用的数据不一定准备好训练模型。很可能首先需要执行一些数据预处理和转换步骤，例如处理缺失值、将分类数据转换为数值或应用要素缩放。</p><p id="4bbb" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn具有执行这些预处理步骤的内置方法。例如，<strong class="ll je">simple imputr()</strong>使用您选择的方法来填充缺失值。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><p id="06ca" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn文档在这里列出了数据预处理的全部选项<a class="ae li" href="https://scikit-learn.org/stable/modules/preprocessing.html" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="66b9" class="nn ng iu bd no np nq nr ns nt nu nv nw kj nx kk ny km nz kn oa kp ob kq oc od bi translated">估价</h1><p id="a901" class="pw-post-body-paragraph lj lk iu ll b lm oe ke lo lp of kh lr ls og lu lv lw oh ly lz ma oi mc md me in bi translated">一旦一个模型被训练好了，你就需要衡量这个模型对新数据的预测能力。这一步被称为模型评估，您选择的度量标准将由您试图解决的任务决定。例如，通常在回归问题中，你可能选择RMSE，而对于分类，你可能选择F1分数。</p><p id="a764" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">所有估计器都包括一个<strong class="ll je"> score() </strong>方法，该方法返回一个与它们执行的机器学习任务最相关的默认度量。</p><p id="f639" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn另外还有一组<strong class="ll je">度量函数</strong>，为模型提供更详细的评估。例如，对于分类任务，库有一个分类报告，它提供精确度、召回率、F1分数和总体准确度。</p><p id="3abe" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">分类报告代码和输出如下所示。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj on"><img src="../Images/caf7200a84c358665e129434ed5f0fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5e4lzk9tHlAHIGJ7oIx6w.png"/></div></div></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="ae79" class="nn ng iu bd no np nq nr ns nt nu nv nw kj nx kk ny km nz kn oa kp ob kq oc od bi translated">模型优化</h1><p id="afd6" class="pw-post-body-paragraph lj lk iu ll b lm oe ke lo lp of kh lr ls og lu lv lw oh ly lz ma oi mc md me in bi translated">Scikit-learn库中的所有估计器都包含一系列参数，这些参数有多个选项。您为特定算法选择的值将影响最终模型的性能。例如，使用RandomForestClassifier，您可以将树的max_depth设置为任何值，根据您的数据和任务，此参数的不同值将产生不同的结果。</p><p id="1b84" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这个尝试不同参数组合以找到最佳组合的过程被称为<strong class="ll je">超参数优化</strong>。</p><p id="e147" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">Scikit-learn提供了两个工具来自动执行这项任务，<strong class="ll je"> GridSearchCV </strong>实现了一种称为<a class="ae li" href="https://www.oreilly.com/library/view/mastering-predictive-analytics/9781789617740/231cc752-8164-4248-9557-26d1adb4623a.xhtml" rel="noopener ugc nofollow" target="_blank">穷举网格搜索</a>的技术，以及<strong class="ll je"> RandomizedSearchCV </strong>执行<a class="ae li" href="https://www.jmlr.org/papers/volume13/bergstra12a/bergstra12a.pdf" rel="noopener ugc nofollow" target="_blank">随机化参数优化</a>。</p><p id="3e89" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">以下示例使用GridSearchCV来查找RandomForestClassifier的最佳参数。输出显示在代码下方。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gi gj oo"><img src="../Images/1a82913d43a303e70ad580297051973e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ERhrX030DFz9bt-SfpAHA.png"/></div></div></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><h1 id="43af" class="nn ng iu bd no np nq nr ns nt nu nv nw kj nx kk ny km nz kn oa kp ob kq oc od bi translated">管道</h1><p id="0e70" class="pw-post-body-paragraph lj lk iu ll b lm oe ke lo lp of kh lr ls og lu lv lw oh ly lz ma oi mc md me in bi translated">Scikit-learn包以<strong class="ll je">管道</strong>的形式提供了更方便的代码封装形式。该工具将所有预处理任务与分类器步骤链接在一起，因此只需在单个管道对象上调用fit()或predict()即可执行工作流中的所有步骤。</p><p id="078e" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">这有助于提高代码的可读性，并减少机器学习工作流程中的重复步骤。</p><p id="deea" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">要创建管道，我们首先在下面的代码中定义我称为管道的对象中的步骤。然后我们可以简单地在这个对象上调用fit来训练模型。管道对象还可以用于对新数据进行预测。</p><figure class="kt ku kv kw gu kx"><div class="bz fq l di"><div class="nl nm l"/></div></figure></div><div class="ab cl mt mu hy mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="in io ip iq ir"><p id="f55d" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">如果您喜欢这篇文章，并想进一步探索Scikit-learn库，您可能会喜欢阅读下面显示的我的早期帖子。</p><div class="op oq gq gs or os"><a href="https://medium.com/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf" rel="noopener follow" target="_blank"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd je gz z fq ox fs ft oy fv fx jd bi translated">Scikit-learn管道简单指南</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">了解如何在scikit-learn机器学习工作流中使用管道</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg lc os"/></div></div></a></div><div class="op oq gq gs or os"><a rel="noopener follow" target="_blank" href="/10-things-you-didnt-know-about-scikit-learn-cccc94c50e4f"><div class="ot ab fp"><div class="ou ab ov cl cj ow"><h2 class="bd je gz z fq ox fs ft oy fv fx jd bi translated">关于Scikit你不知道的10件事-了解</h2><div class="oz l"><h3 class="bd b gz z fq ox fs ft oy fv fx dk translated">…直到现在</h3></div><div class="pa l"><p class="bd b dl z fq ox fs ft oy fv fx dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg lc os"/></div></div></a></div><p id="a14a" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">感谢阅读！</p><p id="8cff" class="pw-post-body-paragraph lj lk iu ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me in bi translated">我每月都会发一份简讯，如果你想加入，请点击此链接注册。期待成为您学习旅程的一部分！T3】</p></div></div>    
</body>
</html>