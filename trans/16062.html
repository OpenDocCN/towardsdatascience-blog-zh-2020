<html>
<head>
<title>fastText for Text Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于文本分类的快速文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fasttext-for-text-classification-a4b38cbff27c?source=collection_archive---------2-----------------------#2020-11-05">https://towardsdatascience.com/fasttext-for-text-classification-a4b38cbff27c?source=collection_archive---------2-----------------------#2020-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0706" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我探索了一种用于多类分类的快速文本分类器。</h2></div><p id="ff53" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的上一篇文章中，我探索了两种不同的NLP模型来完成文本分类的任务。虽然我没有计划把它做成一个系列，但我在NLP领域偶然发现了一些更新的模型，并决定写下它们。</p><p id="6f8d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你愿意，可以查看<a class="ae lb" rel="noopener" target="_blank" href="/a-guide-to-word-embeddings-8a23817ab60f"> <strong class="kh ir">第一篇</strong> </a> <strong class="kh ir"> </strong>出来，在这篇文章中，我重点训练了自己的单词嵌入，并将其与预先训练的手套单词嵌入模型进行比较。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="ef98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用fastText分类器对堆栈溢出问题的质量进行分类。如果你跟随本教程，请从<a class="ae lb" href="https://www.kaggle.com/imoore/60k-stack-overflow-questions-with-quality-rate" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">这里</strong> </a>下载数据集。</p><h1 id="c150" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">什么是fastText？</h1><p id="9577" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">fastText是一个开源库，由脸书人工智能研究实验室开发。它的主要重点是实现文本分类和表示任务的可扩展解决方案，同时快速准确地处理大型数据集。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mg"><img src="../Images/57387625580904cc1116ebce3ecd756f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dNRcHa_nGv1AvLZ3"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">Marc Sendra Martorell 在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c5b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我强烈推荐阅读脸书自己的<a class="ae lb" href="https://fasttext.cc/blog/2016/08/18/blog-post.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">博客文章</strong> </a> <strong class="kh ir"> </strong>和<strong class="kh ir"> </strong> <a class="ae lb" href="https://arxiv.org/pdf/1607.04606.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">研究论文</strong> </a> <strong class="kh ir"> </strong>关于fastText背后的动机，并了解它是如何实现其开发目的的。</p><blockquote class="mw"><p id="4a80" class="mx my iq bd mz na nb nc nd ne nf la dk translated">根据他们的研究，fastText在准确性以及训练和测试时间方面都令人印象深刻，超过了以前发布的最先进的模型。</p></blockquote><p id="9534" class="pw-post-body-paragraph kf kg iq kh b ki ng jr kk kl nh ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">它通过采用两种方法来解决文本的分类和训练单词表示来实现这种计算效率和准确性。</p><h1 id="804f" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">1.分级Softmax</h1><p id="ba99" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">在多类分类问题中，Softmax函数通常用作激活函数来输出给定输入属于<em class="nl"> k </em>类的概率。</p><p id="2da8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当存在大量类别并且数据中存在类别不平衡时，分层Softmax被证明是非常有效的。在这里，类被安排在一个树形分布中，而不是一个平面的、类似列表的结构。</p><p id="fe4a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分层softmax层的构建基于霍夫曼编码树，该编码树使用较短的树来表示更频繁出现的类，而使用较长的树来表示更罕见、更不频繁出现的类。</p><p id="6f2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个给定的文本属于一个类的概率是通过沿着不同分支的节点的深度优先搜索来探索的。因此，具有低概率的分支<em class="nl">(或者等价地，类)</em>可以被丢弃掉。</p><p id="bcfe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于存在大量类别的数据，这将导致复杂度的极大降低，从而与传统模型相比显著加快分类过程。</p><h1 id="d2eb" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">2.单词n-grams</h1><p id="ecfe" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">仅使用一个单词包来表示文本忽略了重要的连续信息。对于大型数据集来说，考虑词序最终会导致计算开销很大。</p><p id="a611" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，作为一种令人愉快的媒介，fastText结合了一包n-grams表示和单词向量，以保存每个单词附近出现的周围单词的一些信息。</p><p id="f684" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种表示对于分类应用非常有用，因为几个不同单词串在一起的上下文含义也会导致该段文本所呼应的特定情感。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="5c89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们已经了解了fastText的一些主要特性，让我们来看看如何实现fastText和实现分类任务。</p><h1 id="e49d" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">装置</h1><p id="e816" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">遵循这些来自博览会的<a class="ae lb" href="https://fasttext.cc/docs/en/supervised-tutorial.html#installing-fasttext" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">安装和设置说明</strong> </a>。我们将使用Python实现这个项目。</p><h1 id="328f" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">数据准备</h1><p id="f3bf" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">为了训练和评估这个分类器，我们必须以fastText期望的格式准备数据。</p><blockquote class="mw"><p id="2273" class="mx my iq bd mz na nb nc nd ne nf la dk translated">fastText首先期望类别，在每个类别前加上前缀' __label__ '，然后是输入文本，像这样，</p></blockquote><blockquote class="nm nn no"><p id="9139" class="kf kg nl kh b ki ng jr kk kl nh ju kn np ni kq kr nq nj ku kv nr nk ky kz la ij bi translated">__label__positive我非常喜欢这家餐厅。很想再去看看。</p></blockquote><p id="bb64" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，我们将应用一些NLP预处理技术来删除不需要的符号、标点符号并将文本转换为小写。</p><p id="6ad6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码负责将前缀“__label__”添加到category列中的每一行。我们将使用gensim的<strong class="kh ir"><em class="nl">simple _ preprocess</em></strong>方法来标记我们的问题并移除符号。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h1 id="053e" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">培训和评估</h1><p id="eb0d" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">将数据帧保存为文本文件后，下一步是训练和测试我们的模型。</p><p id="bc7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了提高我们模型的性能，将<strong class="kh ir"> <em class="nl">字组</em> </strong>参数设置为2。换句话说，该模型是在二元模型上训练的，而不是考虑单个单词。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="98b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有两种方法来测试我们的模型，这两种方法略有不同。</p><p id="2dcf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="nl">预测</em> </strong>方法用于预测给定输入最可能的标签。在上面的代码中，我选择了一个属于类别“HQ”的观察，并针对它测试了模型。正如你在下面看到的，它正确地预测了“HQ”的类别，并且以95%的概率做到了。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nu"><img src="../Images/4398f220971982b892f8b846a54dadb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*kj_Vn-qhr4l3althB6dZrw.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">用一个句子来测试模型。</p></figure><p id="1979" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用<strong class="kh ir"> <em class="nl">测试</em> </strong>方法在整个测试数据集(15000个样本)上评估我的分类器，得到的精度值为0.83，召回值为0.83。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/0dcd2df7d471179ebbb4debe7abf669b.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*fSTrPapO83HvZ-dOO-C09Q.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">模型在测试集上的性能。</p></figure><blockquote class="mw"><p id="0712" class="mx my iq bd mz na nw nx ny nz oa la dk translated">精度是分类器在所有标签中预测的正确标签的数量，召回是在真实标签中成功预测的标签的数量。</p><p id="a7af" class="mx my iq bd mz na nb nc nd ne nf la dk translated">- <a class="ae lb" href="https://fasttext.cc/docs/en/supervised-tutorial.html#advanced-readers-precision-and-recall" rel="noopener ugc nofollow" target="_blank">文本分类fastText博客</a></p></blockquote><p id="af45" class="pw-post-body-paragraph kf kg iq kh b ki ng jr kk kl nh ju kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">在我们的例子中，由于我没有指定参数k的值，默认情况下，模型将只预测它认为给定输入问题所属的1个类。</p><h1 id="990d" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">结论</h1><p id="34e7" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">与我以前训练自己的嵌入和使用预训练手套嵌入的模型相比，fastText表现得更好。</p><p id="9437" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">fastText比在多维单词向量上训练神经网络快得多，在测试集上也取得了良好的性能。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="d64a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">谢谢你过来看这篇文章。请关注本系列中的更多文章，因为我将发布更多的教程并学习更新的模型。</p><p id="c61b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">祝您愉快，在我的下一篇文章中再见！</p></div></div>    
</body>
</html>