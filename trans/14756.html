<html>
<head>
<title>CUPED R-Shiny Tool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">杯形R-闪亮工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cuped-r-shiny-tool-7a4869d77f0a?source=collection_archive---------32-----------------------#2020-10-11">https://towardsdatascience.com/cuped-r-shiny-tool-7a4869d77f0a?source=collection_archive---------32-----------------------#2020-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f1d175e21db0b9a9e35365c741db1a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtAy20n8zOWU6jpRef7_tw.png"/></div></div></figure><h1 id="748d" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">CUPED简介</h1><p id="3485" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">最近，我一直在探索提高实验灵敏度的方法——通过减少与实验前信息相关的方差。如果可以确定实验前指标(协变量)和实验指标之间的强相关性，则在进行任何显著性测试之前，可以控制实验指标中存在的方差。当使用预实验数据(CUPED)方法实施控制时，有几个不同的程序值得考虑，但我在<a class="ae lx" href="https://medium.com/bbc-data-science/increasing-experiment-sensitivity-through-pre-experiment-variance-reduction-166d7d00d8fd" rel="noopener"> <strong class="lb iu">以前的中型帖子</strong> </a> <strong class="lb iu"> </strong>(改编自<a class="ae lx" href="https://booking.ai/how-booking-com-increases-the-power-of-online-experiments-with-cuped-995d186fff1d" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">【Booking.com】</strong></a>)中已经写过关于“协变方法”的内容。协变量方法关注预实验和实验指标之间的关系(这通常是一个连续变量)，忽略实验开始前存在的差异。所述方差的减少导致实验能力的增加，这意味着您更有可能检测到统计上显著的影响(考虑这是一种降噪的方法，以便检测在您的实验条件之间可能存在或可能不存在的任何真实影响)。</p><p id="b419" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">我以前在CUPED方法方面的工作包括一个使用我在Python中的一些工作的例子，以及如何将预实验信息合并到您在<em class="md"> cookie_id </em>单元上的实验数据中。遗憾的是，执行这种分析可能是相当劳动密集型的，包括导入数据帧，确保它们具有唯一的标识符，然后执行与实验前和实验数据帧的合并(我们大多数人都没有那么多时间)。</p><p id="fe99" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">出于这个原因，我构建了一个前端的、用户友好的R Shiny工具，它只需要上传几个简单的文件，所有繁重的工作都会为您完成。除了将我的Python作品翻译成R函数，这是一个相当简单的工作，你可以在这里 找到该工具的<a class="ae lx" href="https://googlyanalytics.shinyapps.io/cuped_analysis_app/?_ga=2.236935368.893426594.1602426019-115386085.1602426019" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">链接。</strong></a></p><p id="2d50" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">你也可以在我的<a class="ae lx" href="https://github.com/frankhopkins/cuped_analysis_application" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> GitHub </strong> </a>上找到该工具的代码。</p><h1 id="b40f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">使用工具</h1><p id="adef" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">可以通过上面的url访问CUPED分析工具。您只需为协变量和实验指标填写两个单独的<em class="md"> xlsx </em>文件。您可以下载这些模板并将它们上传回应用程序。</p><p id="6490" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">一旦这些文件被上传回应用程序，就会为您计算CUPED调整后的指标，因此不需要额外的代码。应用于每个<em class="md"> cookie_unit </em>的常数(θ)计算如下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1a2a" class="mn kc it mj b gy mo mp l mq mr">cor_frame &lt;- inner_join(covariate, metric, by = ‘User_Id’)<br/> <br/> covariance &lt;- cov(cor_frame$Metric, cor_frame$Covariate_Metric)<br/> <br/> variance &lt;- var(cor_frame$Covariate_Metric)<br/> <br/> theta &lt;- covariance/variance<br/> <br/> cor_frame$CUPED_Adjusted_Metric &lt;- cor_frame$Metric — (cor_frame$Covariate_Metric — mean(cor_frame$Covariate_Metric)) * theta</span></pre><p id="9013" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">然后，您可以为您的协变量和实验指标绘制散点图；还提供了您的R和p值，这有助于您确定变量之间的关系强度，以及随后您的协变量是否适合CUPED方法:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f1d175e21db0b9a9e35365c741db1a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HtAy20n8zOWU6jpRef7_tw.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图一。实验前协变量和实验指标之间的相关性，以及每个实验条件和指标的分布。r和p值在图上给出。</p></figure><p id="37d2" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在确定了实验前指标和实验指标之间的关系后，您可以对CUPED调整后的指标执行显著性测试。此输出提供组间方差分析(ANOVA)的结果，其中<em class="md"> p </em>设置为<strong class="lb iu"> 0.05 </strong>:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/cb158c78b2c9921c361ef507a0cf2943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuwQ61c-XTo3GyIjn1wgHw.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图二。经CUPED调整的指标的组间单向方差分析的输出。</p></figure><p id="f72c" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">然后，您可以分别生成实验指标和实验前协变量的平均值和标准差的表格。此表中最右边的一行显示了在显著性测试之前，您的CUPED调整指标忽略的相对差异量:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/b48469faed716782b5fff28f2a93a6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gFL1VtrBKMADRopCeztfg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图3。计算前后平均值和标准偏差的表格输出。方差减少的百分比是两个标准差之间的相对差值。</p></figure><p id="91bd" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">从图3中可以看出，在对所有三个实验条件进行显著性测试之前，已经减少了大量的差异。进行这种分析意味着你将提高实验的灵敏度，并得出更大数量的具有统计学意义的测试结论。</p><p id="ab41" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">您还可以在您的实验中使用的每个个体变体之间生成成对比较(重复<em class="md"> t检验</em>)。这不仅有助于您识别给定的变异是否超出了您的控制条件，还能识别所有其他比较之间的统计差异:</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/85916764de58cc58af40b51f1f2610b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdrYZdfHo6vIlmdcaLK5gg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图4。表输出显示了CUPED调整指标的实验条件之间的独立t检验</p></figure><p id="c55a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">享受这个工具吧！</p><p id="d533" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">弗兰克</p></div></div>    
</body>
</html>