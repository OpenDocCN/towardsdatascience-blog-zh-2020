<html>
<head>
<title>Functions in Power BI — (Table.FindText)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幂BI中的函数—(表。FindText)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/functions-in-power-bi-table-findtext-176709853957?source=collection_archive---------36-----------------------#2020-10-28">https://towardsdatascience.com/functions-in-power-bi-table-findtext-176709853957?source=collection_archive---------36-----------------------#2020-10-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bec0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">…使用表格。FindText可在文件中的任意位置搜索任何内容。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c89ad38751faa73f8a7b720ffe34a5be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XG2ajIyfYnEbfTkP"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Rabie Madaci 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="bdfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我一直对简单的查找功能感到惊讶。您可以找到任何符合条件的内容，即使您的搜索项目隐藏在不同的工作表、打开的文本或表格中。</p><p id="c453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">想象一下，你可以搜索原始数据中出现的任何内容。即使它隐藏在打开的文本字段中的某个地方。相当神奇！</strong></p><p id="81be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这有什么帮助？如果你正在寻找一个关键词或一组重要的数字，但你不知道去哪里找，这将非常有帮助。该号码可以在开放文本字段中，也可以在名称字段中，等等。</p><p id="38f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦找到，你就可以把这些搜索结果结合起来，用它讲一个故事。有时，做一个发现只是出于好奇，但有时你可能会对你的发现感到惊讶。</p><p id="fff1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用过这张桌子。FindText功能是一个欺诈检测练习，它非常方便，因为我的表很大，而我只是在寻找一个人。这个简单的函数还有其他用处。您可以使用它作为帐户记录的历史搜索，并回答您可能有的一些问题。</p><p id="28cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="666b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来看看<a class="ae ky" href="https://docs.microsoft.com/en-us/powerquery-m/table-findtext" rel="noopener ugc nofollow" target="_blank">表。微软的FindText </a>函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/9c19a9628dd7aa6ce321622b08d31e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3BdIIQCDaTCg_EFFhtdEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="44ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单地说，这个函数使用一个表作为输入，并在该表中搜索一个条目。然后，它返回一个表，其中包含与您的条件匹配的行。</p><p id="864b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试试这个。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="034d" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">拿桌子</h1><p id="3a9f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">第一步很棘手——也许你很幸运，已经为你设置了一列表格，但是我必须将文件夹中的二进制文件转换成表格格式。</p><p id="29fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并不困难，我使用这个功能。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="2957" class="nf me it nb b gy ng nh l ni nj">(FOLDER_PATH , FILENAME ) =&gt;<br/>let<br/>    Source = Csv.Document(File.Contents(FOLDER_PATH&amp;FILENAME)),<br/>    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true])<br/>in<br/>   #"Promoted Headers"</span></pre><p id="48d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您使用folders选项连接Power BI并有一个二进制文件列表，您可以使用上述函数将这些二进制文件转换成表格。</p><p id="ad47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要添加新功能，只需进入<strong class="lb iu">电力查询</strong> &gt; <strong class="lb iu">新建空白查询</strong> &gt; <strong class="lb iu">高级编辑</strong> &gt; <strong class="lb iu">粘贴到脚本</strong></p><p id="01a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个查询中的<strong class="lb iu"> FOLDER_PATH </strong>和<strong class="lb iu"> FILENAME </strong>参数是Power Query在您连接到它时为您准备的列。</p><p id="f7f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/346fd11e52ad0066a80ed9cff39b8749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrWlm58e9Iwg1T7naK7hrw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="db13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我将使用调用函数选项来应用该函数。如果你对如何使用函数感到困惑，<a class="ae ky" rel="noopener" target="_blank" href="/functions-in-power-bi-56e9e11e4669?sk=32f65f6e5196dbd96ed43a53584ad2fc">这里有一篇文章</a>给你，帮助你入门。功能很棒！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/66c88d4457f0051486617bd910a030dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l53yx-uKusOMrZpGNHvewg.png"/></div></div></figure><p id="c37d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我应用这个函数之后，我得到了这个输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/3034d8b6b52e022934a7c16144912384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s3cCKL0fFyDB1sLpEcn4Iw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d693" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在我有一列表来应用我的表。FindText()。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5997" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">应用函数</h1><p id="f24c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">我将删除不需要的列，只反映表格列。</p><p id="82c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在需要做的就是通过创建一个新列来应用我们的函数。我想看看“Apple”这个词是否出现在我的表中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/ed95f47a5d1cd5015ba24352924a84c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmXwc6f-UwV7SH1V1iVo6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="dba2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，当你向下钻取时，你可以看到“苹果”出现在“口味”列下的表格中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/a805b53e24b88fdb385a2f58ad8671aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*AVA0GLzpDAGzwkRh2NijPw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="236c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我将它移动到另一个选项，您可以看到“Apple”也出现在“Appleton”下的“Stand”列中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/71c504af0b2f2fadecf3a30ba35cb784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*m205UNWp-HDvDrk9zze4fA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9afa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，为了分析您的结果，您可以将所有文件组合起来，这些文件将包含只包含单词“Apple”的行。</p><p id="b0e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我的例子很简单，我只有10个表，但是这样想，如果你能够理解如何构建一个简单的原型，你可以在你的日常工作中使用任何数量的表:)</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="70d0" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">带走:</h1><ol class=""><li id="8255" class="nq nr it lb b lc mv lf mw li ns lm nt lq nu lu nv nw nx ny bi translated">桌子。FindText()是一个简洁的函数。发挥你的想象力，你可以在任何列和表格中找到你的搜索选项。</li></ol><p id="22f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.删除一些开始时不需要的列，这样运行起来会快很多！</p><p id="a5d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.棘手的部分不是使用搜索功能，而是将二进制文件转换成表格。</p><p id="3473" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能会发现还有其他有用的功能。</p><p id="6e2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你已经知道你要找的关键词或数字，并且<strong class="lb iu">你知道要找哪一栏</strong>，这些功能将会很有用。他们是<a class="ae ky" href="https://docs.microsoft.com/en-us/powerquery-m/table-contains" rel="noopener ugc nofollow" target="_blank">的表。包含()</a>，<a class="ae ky" href="https://docs.microsoft.com/en-us/powerquery-m/table-containsall" rel="noopener ugc nofollow" target="_blank">表。ContainsAll() </a>表。ContainsAny() 。</p><p id="eab3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将来也会写一篇关于这些的文章。</p><p id="ceaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意安全，感谢您的阅读！</p></div></div>    
</body>
</html>