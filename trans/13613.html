<html>
<head>
<title>Learn to Develop a KNN Classifier with a Project Using Python’s Scikit_learn Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习使用Python的Scikit_learn库通过项目开发KNN分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clear-understanding-of-a-knn-classifier-with-a-project-for-the-beginners-865f56aaf58f?source=collection_archive---------31-----------------------#2020-09-18">https://towardsdatascience.com/clear-understanding-of-a-knn-classifier-with-a-project-for-the-beginners-865f56aaf58f?source=collection_archive---------31-----------------------#2020-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e56832d3cfeda8985e09d6a6da67be3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LVlBzSl8W56K3d7M"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">杰克·威瑞克在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="115f" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">适合机器学习新手</h2></div><p id="ff3a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">学习机器学习概念的最佳方式是做一个项目。在这篇文章中，我将使用一个项目来描述一些关键的机器学习概念。</p><p id="a715" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将详细解释一个分类模型，它是<strong class="la jk">，一个监督机器学习的主要类型</strong>。顾名思义，我们将要研究的模型叫做KNN分类器。</p><p id="f88b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">KNN分类器是一种非常流行和众所周知的监督机器学习技术。本文将通过一个简单但完整的项目来解释KNN分类器。</p><h2 id="c6ec" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">什么是监督学习模型？</h2><p id="1bd6" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我来详细解释一下。但是维基百科是这么说的:</p><blockquote class="ms mt mu"><p id="2b25" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated"><strong class="la jk">监督学习</strong>是学习函数的<a class="ae jg" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">机器学习</a>任务，该函数基于示例输入-输出对将输入映射到输出。它从由一组训练示例组成的标记的<a class="ae jg" href="https://en.wikipedia.org/wiki/Training_set" rel="noopener ugc nofollow" target="_blank">训练数据</a>中推断出一个函数。</p></blockquote><p id="adec" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">监督学习模型采用输入特征(X)和输出(y)来训练模型。该模型的目标是定义一个可以使用输入要素并计算输出的函数。</p><blockquote class="ms mt mu"><p id="f5f6" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated"><strong class="la jk">举个例子会更清楚</strong></p></blockquote><p id="3572" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一个数据集，包含一些水果样本的质量、宽度、高度和颜色分数。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/621861459187ef7de5e63aa893103bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/0*fwp6IAuDXFpyoeCK.png"/></div></figure><p id="0ed1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该数据集的目的是训练一个模型，这样如果我们向模型输入质量、宽度、高度和颜色分数，模型就可以让我们知道水果的名称。就像如果我们输入一块水果的质量、宽度、高度和颜色分数分别为175、7.3、7.2、0.61，模型应该输出水果的名称为苹果。</p><p id="c66d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，质量、宽度、高度和颜色分数是输入特征(X)。水果的名字是输出变量或标签(y)。</p><blockquote class="ms mt mu"><p id="10df" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated">这个例子对你来说可能听起来很傻。但这是在非常高级的监督机器学习模型中使用的机制。</p></blockquote><p id="6804" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">稍后，我将用一个真实的数据集展示一个实际的例子。</p><h2 id="9a13" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">KNN分类器</h2><p id="5a73" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">KNN分类器是基于记忆的机器学习模型的一个例子。</p><p id="6134" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着这个模型记住了带标签的训练样本，并使用它们来对它以前没有见过的对象进行分类。</p><blockquote class="ne"><p id="6563" class="nf ng jj bd nh ni nj nk nl nm nn lt dk translated">KNN分类器中的k是它将检索的训练样本的数量，以便预测新的测试样本。</p></blockquote><blockquote class="ms mt mu"><p id="bf64" class="ky kz mv la b lb no kk ld le np kn lg mw nq lj lk mx nr ln lo my ns lr ls lt im bi translated"><strong class="la jk"> KNN分类器分三步工作:</strong></p></blockquote><ol class=""><li id="fde4" class="nt nu jj la b lb lc le lf lh nv ll nw lp nx lt ny nz oa ob bi translated">当给它一个新的实例或例子进行分类时，它将检索以前记忆的训练例子，并从中找到k个最接近的例子。</li><li id="1d71" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated">然后分类器查找这k个最接近的例子的标签(上面例子中的水果名称)。</li><li id="409c" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated">最后，模型将这些标签结合起来进行预测。通常，它会预测多数标签。例如，如果我们选择我们的k为5，从最近的5个例子中，如果我们有3个橙子和2个苹果，新实例的预测将是橙色。</li></ol><h2 id="a7a3" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">数据准备</h2><p id="475a" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在我们开始之前，我鼓励您检查您的计算机中是否有以下可用资源:</p><ol class=""><li id="eb50" class="nt nu jj la b lb lc le lf lh nv ll nw lp nx lt ny nz oa ob bi translated"><a class="ae jg" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy库</a></li><li id="a90d" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated"><a class="ae jg" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫图书馆</a></li><li id="8dae" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated"><a class="ae jg" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib库</a></li><li id="d72d" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated"><a class="ae jg" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn库</a></li><li id="c597" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated"><a class="ae jg" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>环境。</li></ol><p id="d375" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您没有安装Jupyter笔记本，请使用您选择的任何其他笔记本。我建议用谷歌合作笔记本。<a class="ae jg" href="https://colab.research.google.com/notebooks/intro.ipynb#recent=true" rel="noopener ugc nofollow" target="_blank">跟随此链接开始</a>。只要记住一件事，</p><blockquote class="ms mt mu"><p id="c689" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated">谷歌合作笔记本不是私人的。所以，不要在那里做任何专业或敏感的工作。但对练习很有帮助。因为里面已经安装了很多常用的包。</p></blockquote><p id="e7b1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">我建议</strong>，下载数据集。我在页面底部提供了链接。如果你是为了学习这个而阅读的话，请自己运行每一行代码。</p><p id="80b8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，导入必要的库:</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="d442" class="lu lv jj oi b gy om on l oo op">%matplotlib notebook<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>from sklearn.model_selection import train_test_split</span></pre><p id="a235" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本教程，我将使用来自<a class="ae jg" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的Titanic数据集。我将这个数据集上传到我笔记本所在的文件夹中。</p><p id="d45b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是我如何使用pandas在笔记本中导入数据集。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="af99" class="lu lv jj oi b gy om on l oo op">titanic = pd.read_csv('titanic_data.csv')<br/>titanic.head()<br/>  <br/>#titaninc.head() gives the first five rows of the dataset. We will    #print first five rows only to examine the dataset.</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/0639f315967233d346835a668814fa78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LSqoQSBRDAYGOuJS.png"/></div></div></figure><p id="781d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看第二列。它包含了这个人是否幸存的信息。0表示该人幸存，1表示该人未幸存。</p><p id="b560" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我们的目标是预测“幸存”特征。</p><p id="8688" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了简单起见，我将保留几个对算法更重要的关键特征，去掉其余的。</p><p id="2b39" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个数据集非常简单。仅仅从直觉上，我们可以看到有一些列对于预测‘幸存’特征来说是不重要的。</p><p id="3fe5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，“乘客Id”、“姓名”、“机票”和“客舱”似乎不能用来预测乘客是否幸存。</p><p id="dd16" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将创建一个具有一些关键特性的新数据框架，并将其命名为titanic1。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="6d05" class="lu lv jj oi b gy om on l oo op">titanic1 = titanic[['Pclass', 'Sex', 'Fare', 'Survived']]</span></pre><p id="5d5b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“性别”列具有字符串值，需要进行更改。因为计算机不理解单词。它只懂数字。我将更改0的“男性”和1的“女性”。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="9362" class="lu lv jj oi b gy om on l oo op">titanic1['Sex'] = titanic1.Sex.replace({'male':0, 'female':1})</span></pre><p id="fd6a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是数据帧titanic1的样子:</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/118d17c41e210c2e78ddc5219b9833c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/0*CHFT6_vMBByTsO8Z.png"/></div></figure><p id="4b19" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的目标是根据titanic1数据图中的其他信息预测“幸存”参数。因此，输出变量或标签(y)是“幸存的”。输入特征(X)是“P级”、“性别”和“费用”。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="2c23" class="lu lv jj oi b gy om on l oo op">X = titanic1[['Pclass', 'Sex', 'Fare']]<br/>y = titanic1['Survived']</span></pre><h2 id="e64f" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">KNN分类器模型</h2><p id="5398" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">首先，我们需要将数据集分成两组:训练集和测试集。</p><p id="4b03" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用训练集来训练模型，其中模型将记住输入特征和输出变量。</p><p id="9bcf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们将使用测试集来查看模型是否可以使用“P-class”、“Sex”和“Fare”来预测乘客是否幸存。</p><p id="f386" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">方法'<a class="ae jg" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> train_test_split </a>'将有助于拆分数据。默认情况下，此函数将75%的数据用于定型集，25%的数据用于测试集。如果您愿意，您可以更改它，并且您可以指定“训练大小”和“测试大小”。</p><p id="cc74" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果将train_size设置为0.8，则拆分为80%的训练数据和20%的测试数据。但是对我来说，默认值75%就不错了。因此，我没有使用train_siz或test_size参数。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="b39a" class="lu lv jj oi b gy om on l oo op">X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)</span></pre><p id="1289" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住对“random_state”使用相同的值。这样，每次进行这种拆分时，训练集和测试集都会获得相同的数据。</p><p id="da39" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我选择random_state为0。你可以选择一些你喜欢的。</p><p id="a345" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python的scikit -learn库已经有了KNN分类器模型。我会进口那个。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="e011" class="lu lv jj oi b gy om on l oo op">from sklearn.neighbors import KNeighborsClassifier</span></pre><p id="8e45" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">将此分类器保存在变量中。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="9ae8" class="lu lv jj oi b gy om on l oo op">knn = KNeighborsClassifier(n_neighbors = 5)</span></pre><p id="370c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，n_neighbors是5。</p><p id="76f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这意味着当我们要求我们的训练模型预测新实例的生存机会时，将需要5个最接近的训练数据。</p><p id="0a0b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">基于这5个训练数据的标签，模型将预测新实例的标签。</p><p id="66f3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我将使训练数据适合模型，以便模型可以记住它们。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="f0b2" class="lu lv jj oi b gy om on l oo op">knn.fit(X_train, y_train)</span></pre><p id="2bda" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可能会认为，由于它记住了训练数据，它可以正确预测100%的训练特征的标签。但这并不确定。为什么？</p><p id="7a85" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看，每当我们输入并要求它预测标签时，它会从5个最近的邻居那里进行投票，即使它已经记住了完全相同的特征。</p><p id="9480" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看它能给我们多少训练数据的准确性</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="68c4" class="lu lv jj oi b gy om on l oo op">knn.score(X_train, y_train)</span></pre><p id="c9d7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我得到的训练数据准确率是0.83或者83%。</p><p id="1e2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">记住，我们有一个我们的模型从未见过的测试数据集。现在检查一下，它能多准确地预测测试数据集的标签。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="08e6" class="lu lv jj oi b gy om on l oo op">knn.score(X_test, y_test)</span></pre><p id="3901" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">准确率出来是0.78或者78%。</p><p id="0cfd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">祝贺你！你开发了一个KNN分类器！</strong></p><p id="ed3f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，训练集的精度比测试集的精度高一点。那太合适了。</p><blockquote class="ms mt mu"><p id="6dfb" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated"><strong class="la jk">什么是过度拟合？</strong></p></blockquote><p id="0f2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时，模型对训练集的学习非常好，因此可以很好地预测训练数据集标签。但是，当我们要求模型使用测试数据集或以前没有看到的数据集进行预测时，它的表现不如训练数据集。这种现象被称为过度拟合。</p><p id="a33e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用一句话来说，当训练集精度高于测试集精度时，我们称之为过拟合。</p><h2 id="06c4" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">预言；预测；预告</h2><p id="f54b" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">如果您想要查看测试数据集的预测输出，以下是如何操作的:</p><p id="c01a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输入:</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="f2b9" class="lu lv jj oi b gy om on l oo op">y_pred <strong class="oi jk">=</strong> knn.predict(X_test)y_pred</span></pre><p id="b5e2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="226e" class="lu lv jj oi b gy om on l oo op">array([0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0,<br/>       0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/>       1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0,<br/>       1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1,<br/>       1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1,<br/>       0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,<br/>       0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0,<br/>       1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0,<br/>       1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1,<br/>       1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1,<br/>       0, 1, 1], dtype=int64)</span></pre><p id="941e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者你可以只输入一个例子并找到标签。</p><p id="5971" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我想看看当一个人乘坐“P-class”3旅行时，“性别”是女性，这意味着1，并且支付了25英镑的“车费”，如果她能按照我们的模型生存下来。</p><p id="04d5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输入:</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="eefb" class="lu lv jj oi b gy om on l oo op">knn.predict([[3, 1, 25]])</span></pre><blockquote class="ms mt mu"><p id="9afb" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated">记得用两个括号，因为它需要一个2D数组</p></blockquote><p id="cc52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出:</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="5466" class="lu lv jj oi b gy om on l oo op">array([0], dtype=int64)</span></pre><p id="1940" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出为零。这意味着根据我们训练的模型，这个人不可能存活。</p><blockquote class="ms mt mu"><p id="2cab" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated">请随意尝试更多像这样不同的输入！</p></blockquote><h2 id="4f1a" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">如果你想看一些KNN分类器的进一步分析</h2><p id="bc71" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">KNN分类器对“k”或n个邻居的选择非常敏感。在上面的例子中，我使用了n个邻居5。</p><p id="eb66" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于不同的n_neighbors，分类器会有不同的表现。</p><p id="c077" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看它在不同n_neighbors值的训练数据集和测试数据集上的表现。我选1到20。</p><p id="5a15" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将计算从1到20的每个n_neighbors值的训练集精度和测试集精度，</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="7f55" class="lu lv jj oi b gy om on l oo op">training_accuracy  = []  <br/>test_accuracy = []<br/>for i in range(1, 21):<br/>    knn = KNeighborsClassifier(n_neighbors = i)<br/>    knn.fit(X_train, y_train)<br/>    training_accuracy.append(knn.score(X_train, y_train))<br/>    test_accuracy.append(knn.score(X_test, y_test))</span></pre><p id="dafa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">运行这个代码片段后，我得到了不同n_neighbors的训练和测试精度。</p><p id="28b9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们在同一个图中绘制针对n_neighbors的训练和测试集精度。</p><pre class="na nb nc nd gt oh oi oj ok aw ol bi"><span id="5836" class="lu lv jj oi b gy om on l oo op">plt.figure()<br/>plt.plot(range(1, 21), training_accuracy, label='Training Accuarcy')<br/>plt.plot(range(1, 21), test_accuracy, label='Testing Accuarcy')<br/>plt.title('Training Accuracy vs Test Accuracy')<br/>plt.xlabel('n_neighbors')<br/>plt.ylabel('Accuracy')<br/>plt.ylim([0.7, 0.9])<br/>plt.legend(loc='best')<br/>plt.show()</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/92c485b75428882d6e4b673d7ffca6ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/0*bTI7947p5ajbiob8.png"/></div></figure><blockquote class="ms mt mu"><p id="5072" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated"><strong class="la jk">分析上图</strong></p></blockquote><p id="2cc9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一开始，当n_neighbors为1、2或3时，训练精度比测试精度高得多。因此，该模型正遭受高度过拟合。</p><p id="9fd5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从那以后，训练和测试的准确性越来越接近。这是最佳点。我们希望如此。</p><p id="619d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是当n_neighbors变得更高时，训练集和测试集的精度都下降了。我们不需要那个。</p><p id="1bd3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据上图，该特定数据集和模型的最佳n_neighbors应为6或7。</p><blockquote class="ms mt mu"><p id="6851" class="ky kz mv la b lb lc kk ld le lf kn lg mw li lj lk mx lm ln lo my lq lr ls lt im bi translated"><strong class="la jk">这是一个很好的分类器！</strong></p></blockquote><p id="4514" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看上面的图！当n_neighbors约为7时，训练和测试准确率都在80%以上。</p><h2 id="417a" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">结论</h2><p id="ee14" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">本文的目的是用一个项目展示一个KNN分类器。如果你是一个机器学习初学者，这将帮助你学习一些机器学习和工作流程的关键概念。有这么多不同的机器学习模型。但这是监督机器学习模型的典型工作流程。</p><p id="b229" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我在文章中使用的泰坦尼克号:</p><div class="is it gp gr iu ot"><a href="https://github.com/rashida048/Datasets/blob/master/titanic_data.csv" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">rashida 048/数据集</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">在GitHub上创建一个帐户，为rashida048/Datasets开发做出贡献。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">github.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ja ot"/></div></div></a></div><h2 id="0cfa" class="lu lv jj bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">更多阅读:</h2><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/a-complete-understanding-of-precision-recall-and-f-score-concepts-23dc44defef6"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">完全理解精确度、召回率和F分数的概念</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">机器学习中如何处理倾斜数据集</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pi l pe pf pg pc ph ja ot"/></div></div></a></div><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/k-mean-clustering-algorithm-from-scratch-in-python-and-dimensional-reduction-step-by-step-guide-9ebabe5ca433"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">Python中从头开始的k均值聚类算法:分步指南</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">并学习使用它来降低图像的维数</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pj l pe pf pg pc ph ja ot"/></div></div></a></div><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/your-everyday-cheatsheet-for-pythons-matplotlib-c03345ca390d"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">Python Matplotlib的日常备忘单</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">完整的可视化课程</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pk l pe pf pg pc ph ja ot"/></div></div></a></div><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/all-the-datasets-you-need-to-practice-data-science-skills-and-make-a-great-portfolio-857a348883b5"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">练习数据科学技能和制作优秀投资组合所需的所有数据集</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">一些有趣的数据集提升你的技能和投资组合</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pl l pe pf pg pc ph ja ot"/></div></div></a></div><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/sort-and-segment-your-data-into-bins-to-get-sorted-ranges-pandas-cut-and-qcut-7785931bbfde"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">数据宁滨与熊猫削减或Qcut方法</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">当你在寻找一个范围而不是一个确切的数值，一个等级而不是一个分数</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pm l pe pf pg pc ph ja ot"/></div></div></a></div><div class="is it gp gr iu ot"><a rel="noopener follow" target="_blank" href="/master-pandas-groupby-for-efficient-data-summarizing-and-analysis-c6808e37c1cb"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd jk gy z fp oy fr fs oz fu fw ji bi translated">Pandas的Groupby功能详细，可进行高效的数据汇总和分析</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">学习对数据进行分组和汇总，以使用聚合函数、数据转换、过滤、映射、应用函数…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pn l pe pf pg pc ph ja ot"/></div></div></a></div></div></div>    
</body>
</html>