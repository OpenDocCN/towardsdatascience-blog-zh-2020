<html>
<head>
<title>MongoDB: Migrating from mLab to Atlas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MongoDB:从mLab迁移到Atlas</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mongodb-migrating-from-mlab-to-atlas-1070d06fddca?source=collection_archive---------44-----------------------#2020-11-13">https://towardsdatascience.com/mongodb-migrating-from-mlab-to-atlas-1070d06fddca?source=collection_archive---------44-----------------------#2020-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0bd7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">迁移您的MongoDB以保持Heroku应用程序正常工作</h2></div><p id="c3ed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">由:</em> <a class="ae lf" href="https://www.linkedin.com/in/edkrueger/" rel="noopener ugc nofollow" target="_blank"> <em class="le">爱德华·克鲁格</em> </a> <em class="le">和</em> <a class="ae lf" href="https://www.linkedin.com/in/douglas-franklin-1a3a2aa3/" rel="noopener ugc nofollow" target="_blank"> <em class="le">道格拉斯·富兰克林</em> </a> <em class="le">。</em></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/8c6aa7a91e2883f6387e0cc2d263e0df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bH5l8pRntvk-BJgnbqLYpg.jpeg"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">肯里克·米尔斯在Unsplash上拍摄的照片</p></figure><p id="940a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上一篇文章中，我们讨论了如何从Heroku部署中分离mLab数据库。我们这样做是为了给我们赢得一些时间，为我们的MongoDB应用程序开发一个更持久的解决方案。看看下面作品吧！希望你现在已经超脱了。如果你错过了最后期限，mongo说你仍然可以重置密码。然而，我们没有这方面的运气，因为链接被打破了。</p><div class="lw lx gp gr ly lz"><a rel="noopener follow" target="_blank" href="/keeping-your-mlab-mongodbs-detaching-from-heroku-173b5c97c715"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">保持你的mLab MongoDBs:脱离Heroku</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">2020年11月10日从Heroku分离mLab以保存您的数据不被删除的简要指南。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn lq lz"/></div></div></a></div><p id="e63f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">MongoDB在2018年收购了mLab，并决定在2020年11月10日结束这项服务。这是一种让用户将数据库迁移到MongoDB Atlas的努力，我们将在这里讨论。</p><p id="783e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Mongo在他们发给我们的邮件中提供了一个指南；然而，我们不会在本文中遵循它。我们这里的方法将为您提供更多的迁移选择。</p><p id="f0be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用Google Cloud shell将一个数据库从mLab迁移到Atlas。要开始使用本指南，我们需要一个免费的GCP帐户。使用云外壳将比在本地完成该过程更容易，但这不是必需的。</p><h1 id="787b" class="mo mp it bd mq mr ms mt mu mv mw mx my jz mz ka na kc nb kd nc kf nd kg ne nf bi translated">迁移指南</h1><p id="3e8f" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">在我们开始之前，我们需要访问亚多拉斯的MongoDB。</p><h2 id="4b2b" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated">在Mongo.com上创建帐户以使用他们的免费服务。</h2><div class="lw lx gp gr ly lz"><a href="https://www.mongodb.com/cloud/atlas/mongodb-google-cloud" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">在谷歌云平台上运行MongoDB的最佳方式</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">福布斯美国首席技术官Vadim Supitskiy:爱荷华州、俄勒冈州、N. Virginia、南卡罗来纳州、洛杉矶、Salt…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">www.mongodb.com</p></div></div><div class="mi l"><div class="nx l mk ml mm mi mn lq lz"/></div></div></a></div><ul class=""><li id="f62b" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">创建帐户后，命名项目并选择语言首选项。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oh"><img src="../Images/32d34e0b9789098df061b32fd432a1a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uaCC1xFxM5GK2RGusiuGmQ.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">免费集群入门</p></figure><ul class=""><li id="8b0b" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">对于这篇文章，我们将使用免费计划。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oi"><img src="../Images/cc84f38cb9ee4f4ac2a4c22bf961c4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g58T-eAqT9ZlaWv10ot74A.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">亚多拉斯集群层</p></figure><ul class=""><li id="9795" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">选择您使用的云提供商和地区。无论选择什么，这都不会显示在您的项目中。您应该选择低延迟的云和区域。这些选择决定了您的Atlas DB将在哪里启动。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oj"><img src="../Images/1c27745a986f7f31b60940400a879fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aN3DHxUWf_W9MVah38q-g.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">云提供商选择</p></figure><ul class=""><li id="b995" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">最后，部署集群！</li></ul><p id="b000" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们有一个AtlasDB实例可以使用了。</p><h2 id="171c" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 2。安装Mongo工具</strong></h2><p id="4db7" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在，我们将使用Google Cloud shell来设置一个mongo客户端和一些迁移所需的mongo工具。如果你还没有，你可能需要在他们那里建立一个免费账户。</p><div class="lw lx gp gr ly lz"><a href="https://cloud.google.com/shell" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">云壳|谷歌云</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">从任何浏览器管理您的基础架构和开发您的应用程序。查看该产品的文档。云…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">cloud.google.com</p></div></div><div class="mi l"><div class="ok l mk ml mm mi mn lq lz"/></div></div></a></div><p id="106b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经编写了一个shell脚本来为您获取工具！请注意，这些都是针对Debian 10的版本。当我们需要使用mongo shell时，这个shell脚本可以很好地重用，因为它会将文件添加到一个不持久的位置。</p><p id="3488" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将在Debian 9和10上工作。如果你运行的是另一个版本的Linux，你可以在<strong class="kk iu"> </strong> <a class="ae lf" href="https://docs.mongodb.com/manual/installation/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> Mongo的安装说明</strong> </a> <strong class="kk iu">中找到更多信息。</strong></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ol"><img src="../Images/1ba886faced1f2f446113240655e7497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1YcfbtEWcAuPOhQLYa06VA.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">云壳终端</p></figure><ul class=""><li id="ddf9" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">打开终端后，使用以下命令克隆repo。</li></ul><pre class="lh li lj lk gt om on oo op aw oq bi"><span id="8ab0" class="nl mp it on b gy or os l ot ou">git clone https://github.com/edkrueger/download-mongo-shell-tools.git</span></pre><ul class=""><li id="5098" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">通过运行shell脚本安装MongoDB工具。</li></ul><pre class="lh li lj lk gt om on oo op aw oq bi"><span id="9250" class="nl mp it on b gy or os l ot ou">sh install.sh</span></pre><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ov"><img src="../Images/fcec18813011c97d86f2fbc6df1d2c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DnngmdloGTX6A_OHi2aP5w.png"/></div></div></figure><p id="77b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个下载获得了mongo客户端、<code class="fe ow ox oy on b">mongodump</code>和<code class="fe ow ox oy on b">mongorestore</code>以及其他一些我们不太关心的文件。</p><h2 id="21e5" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 3。保存您的mLab连接字符串</strong></h2><p id="a578" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">我们将把我们的连接字符串保存为环境变量，以使我们的生活变得更简单。</p><ul class=""><li id="02e7" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">从mLab获取您的连接字符串URI。这可能会在Heroku上作为你的<code class="fe ow ox oy on b">mongodb_uri</code>出现。</li><li id="2fa2" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">运行以下命令，确保用MongoDB连接字符串替换<code class="fe ow ox oy on b">&lt;connection-string&gt;</code>。这将保存该字符串供以后使用。</li></ul><pre class="lh li lj lk gt om on oo op aw oq bi"><span id="4faf" class="nl mp it on b gy or os l ot ou">export MLAB=&lt;connection-string&gt;</span></pre><ul class=""><li id="a84c" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">通过以下方式连接到mongo:</li></ul><pre class="lh li lj lk gt om on oo op aw oq bi"><span id="2c21" class="nl mp it on b gy or os l ot ou">mongo $MLAB</span></pre><ul class=""><li id="8dfd" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">在这里，您应该能够查看和查询您的收藏。</li></ul><h2 id="4105" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 4。将用户添加到Atlas数据库</strong></h2><p id="1a98" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在我们需要添加一个用户到我们的亚多拉斯云数据库来连接它。</p><ul class=""><li id="6501" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">回到阿特拉斯。</li><li id="f13f" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">单击数据库访问。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi pe"><img src="../Images/04e3d1d9d47ea21e63ef83dab3c82ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r2R3aF7sXeL2exoUIzFP8w.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">数据库访问面板</p></figure><ul class=""><li id="4bd9" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">单击添加新数据库用户。</li><li id="49a3" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">创建用户名和密码，然后单击添加用户。默认设置就可以了。</li></ul><h2 id="fae8" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 5。改变网络接入</strong></h2><p id="0439" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">接下来，我们需要允许连接到Atlas数据库。</p><ul class=""><li id="45b6" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">单击左侧的网络访问。</li><li id="6ffe" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">点按“添加”和“允许从任何地方访问”，这会将0.0.0.0/0添加为访问IP。这使得我们的来源可以是任何IP。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi pf"><img src="../Images/fa05da9b48dd54b2c3ee81f2ed7da581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUyr1Ica7ZLUvb8MUecePg.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">网络存取</p></figure><p id="0740" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住这里的安全风险，如果使用敏感数据，只添加您信任的IP。</p><h2 id="43a0" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated">6。保存你的图集连接字符串</h2><p id="159d" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在我们可以连接了，让我们从Atlas中获取连接字符串，并将其保存为环境变量。</p><ul class=""><li id="9749" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">选择左侧的群集。</li><li id="4bd8" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">单击<code class="fe ow ox oy on b">Cluster0</code>实例下面的连接。</li><li id="5bce" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">点击“连接Mongo Shell”，你会看到下面的屏幕。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi pg"><img src="../Images/52d8d97dac63f21b80d39791884edaff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAcFuBqGw-YsnW5KvFU-bA.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">MongoDB连接字符串</p></figure><ul class=""><li id="6c88" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">复制连接字符串并插入您的<code class="fe ow ox oy on b">&lt;dbname&gt;</code>。</li><li id="b9a5" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">将Atlas DB连接字符串保存为环境变量。</li></ul><pre class="lh li lj lk gt om on oo op aw oq bi"><span id="8a42" class="nl mp it on b gy or os l ot ou">export ATLAS=mongodb+srv://cluster0.5g6iu.mongodb.net/&lt;dbname&gt;</span></pre><ul class=""><li id="a42e" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">与<code class="fe ow ox oy on b">mongo $ATLAS</code>连接。</li><li id="1bd5" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">用<code class="fe ow ox oy on b">db.test.insertOne({"Hello": "World"})</code>测试。</li></ul><h2 id="3bfe" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated">7。使用mongodump和mongorestore迁移数据</h2><p id="fd8a" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在我们可以从云Shell连接到两个数据库，并将连接字符串作为环境变量，我们已经为迁移做好了准备。我们将使用shell脚本中获得的工具来简化这个过程！</p><ul class=""><li id="a620" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">运行<code class="fe ow ox oy on b">mongodump --uri $MLAB</code>将旧数据库转储到一个. bson文件中。</li><li id="1167" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">将路径复制到。以下命令的bson文件。</li><li id="4900" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">运行<code class="fe ow ox oy on b">mongorestore --uri $ATLAS dump/heroku_g76fhzjn/posts.bson</code>确保使用您的。bson路径，不是我们的！您可能需要检查您的收藏名称；我们的默认是<code class="fe ow ox oy on b">heroku_g76fhz</code>。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ph"><img src="../Images/86201a87c30e2e8d57747246ed9728d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HyWNYTTy0LdOzqImpkj-ww.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">mongorestore向Atlas添加数据</p></figure><h2 id="8eca" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 8。验证迁移</strong></h2><p id="0283" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">现在我们已经加载了新的数据库，让我们验证一下我们是否已经正确地完成了。</p><ul class=""><li id="232a" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">运行<code class="fe ow ox oy on b">mongo $ATLAS</code>连接到新加载的数据库。</li><li id="152f" class="ny nz it kk b kl oz ko pa kr pb kv pc kz pd ld od oe of og bi translated">在mongo shell中，运行<code class="fe ow ox oy on b">show collections</code>，然后运行<code class="fe ow ox oy on b">db.collection-name.find()</code>来查看您的数据，确保使用正确的集合名。同样，如果你的数据库包含大量信息，使用<code class="fe ow ox oy on b">findOne()</code>!</li></ul><p id="9c56" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您看到您的数据，您就完成了迁移！现在让我们的应用程序运行。</p><h2 id="ac8a" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated"><strong class="ak"> 9。重新部署Heroku应用程序</strong></h2><p id="0a08" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">我们必须添加<code class="fe ow ox oy on b">dnspython</code>到我们的应用程序正确连接的要求。这是为了适应新的mongo srv协议，您可以在我们的连接字符串中看到。</p><p id="271d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过向Github提交一个具有这种依赖关系的新Pipfile，然后运行<code class="fe ow ox oy on b">pipenv install dnspython</code>来确保它在Pipfile.lock中。</p><p id="1c25" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在您的环境包含<code class="fe ow ox oy on b">dnspython</code>之后:</p><ul class=""><li id="609f" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">在Heroku上添加Atlas Connection URI。</li></ul><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi pi"><img src="../Images/7f7b196375e20265ee84159757f3438b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RcpuuHdXSTHsCVVb6HCXPA.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">显示配置变量以添加新的URI</p></figure><ul class=""><li id="f5cd" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated">从所需的分支重新部署应用程序。</li></ul><p id="4670" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果应用程序出现任何问题，请检查您的构建日志！这是我们被警告缺少依赖项的地方，<code class="fe ow ox oy on b">dnspython</code>。</p><h2 id="aa1a" class="nl mp it bd mq nm nn dn mu no np dp my kr nq nr na kv ns nt nc kz nu nv ne nw bi translated">包扎</h2><p id="2a0c" class="pw-post-body-paragraph ki kj it kk b kl ng ju kn ko nh jx kq kr ni kt ku kv nj kx ky kz nk lb lc ld im bi translated">这是一个将数据从mLab迁移到Atlas以保持Heroku应用程序运行的指南。</p><p id="41fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在MongoDB上做了一个免费的账户来使用Atlas。然后配置了一个google云shell来运行mongo shell和工具。配置好外壳后，我们将旧的URI保存为<code class="fe ow ox oy on b">$MLAB</code>，新的URI保存为<code class="fe ow ox oy on b">$ATLAS</code>。完成所有这些设置后，我们可以使用<code class="fe ow ox oy on b">mongodump</code>和<code class="fe ow ox oy on b">mongorestore</code>轻松地将mLab数据库中的数据加载到Atlas数据库中。</p><p id="e111" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦我们的数据成功转移，我们需要重新部署我们的应用程序。在我们的应用程序使用新的连接字符串运行之前，我们需要指示Heroku安装<code class="fe ow ox oy on b">dnspython</code>。</p><p id="102c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过向Pipfile添加依赖项，运行pipenv install，然后从Heroku上的主分支重新构建应用程序来实现这一点。</p><p id="1039" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是我们通过将数据从mLab迁移到Atlas来保持Heroku应用程序运行的方式。我们的下一个指南将涵盖从mLab到Azure Cosmos的数据库迁移！</p><div class="lw lx gp gr ly lz"><a rel="noopener follow" target="_blank" href="/mongodb-migrating-from-mlab-to-azure-cosmos-db-88c508f72d24"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">MongoDB:从mLab迁移到Azure Cosmos DB</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">如何将您的mLab数据库迁移到Azure Cosmos DB以保持您的应用程序运行。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">towardsdatascience.com</p></div></div><div class="mi l"><div class="pj l mk ml mm mi mn lq lz"/></div></div></a></div><p id="3417" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在这里发布了mLab到Cosmos的指南！</p></div></div>    
</body>
</html>