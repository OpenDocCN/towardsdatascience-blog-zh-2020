<html>
<head>
<title>Biometric Signal Verification of Handwriting with Hidden Markov Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于隐马尔可夫模型的笔迹生物特征识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/biometric-signal-verification-of-handwriting-with-hmms-8808cbd05699?source=collection_archive---------24-----------------------#2020-10-14">https://towardsdatascience.com/biometric-signal-verification-of-handwriting-with-hmms-8808cbd05699?source=collection_archive---------24-----------------------#2020-10-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a0e5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用hmmlearn在Python中实现</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/192ac04e01b2b997b052cef343209822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvZ-IviZWYsNEGvFs2ja7Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/de/users/thedigitalartist-202249/" rel="noopener ugc nofollow" target="_blank">数码师</a>在<a class="ae kv" href="http://www.pixabay.com" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄的照片</p></figure><p id="3b16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数字签名正在兴起。由于我们中的许多人现在在家工作，许多机密的公司电子邮件需要在线签名。<br/>伊恩古德费罗斯(Ian Goodfellows)发明的生成对抗网络(GAN)展示了如今在数据集上生成虚假数字是多么容易。这实际上只是一小步，也能够生成模仿任何人的笔迹风格的签名。但是那不是很危险吗？</p><p id="2260" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们能用机器学习来区分原始签名和人工制作的签名吗？我们确实可以！我们甚至不需要那些花哨的神经网络方法，我们可以用<strong class="ky ir">隐马尔可夫模型(HMM) </strong>完全经典。在这篇文章中，我将展示我们如何结合HMM来分类签名是原始的还是模仿的。</p><p id="884b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个项目的灵感大致来自朱利安·菲尔兹等人的论文。艾尔。发表于2007年，名为:<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395" rel="noopener ugc nofollow" target="_blank">基于HMM的在线签名验证</a>。</p><h1 id="b580" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">介绍</h1><p id="33d5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">即使隐马尔可夫模型不是最先进的，正如上面论文的出版日期“2007”已经表明的，它们仍然是每个数据科学家至少应该听说过的基本概念。当你想了解更近期的技术如递归神经网络时，理解HMM的工作方式会有启发，因为许多技术都是从HMM的基本思想发展而来的。</p><h2 id="7b38" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak">隐马尔可夫模型</strong></h2><p id="4c3a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">隐马尔可夫模型可以在它们的计算中包括时间相关性。在下面的图1中，我们可以看到，从每个状态(雨天、晴天)我们可以来回转换到雨天或晴天，每个状态都有一定的概率在每个时间步长发出三种可能的输出状态(步行、购物、清洁)。总是需要提供开始概率(雨天60%，晴天40%)来开始计算链。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ef425db3da65727c3b3af1c9caaaf984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujYAjEp_LXGcEl9jTMYfQw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1来自<a class="ae kv" href="https://en.wikipedia.org/wiki/Hidden_Markov_model#/media/File:HMMGraph.svg" rel="noopener ugc nofollow" target="_blank">维基百科</a>:隐马尔可夫模型</p></figure><p id="c90b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的情况下，这意味着签名是从左到右，一个字母接一个字母地写。所以时间依赖关系包括笔移动形成一个字母的速度，压力和坐标。所有这些信息都可以考虑在内，以估计签名是由原作者书写还是伪造的可能性有多大。</p><p id="a4ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">图1表明我们需要预先了解:</p><ul class=""><li id="a4a1" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">开始概率(雨天60%或晴天40%) <strong class="ky ir">向量</strong></li><li id="a1f6" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">过渡(例如从多雨到多雨70%) <strong class="ky ir">矩阵</strong>，</li><li id="412d" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">排放(从雨天到步行10%、购物40%或清洁50%) <strong class="ky ir">矩阵</strong></li></ul><p id="d54c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，开始概率总计为100%，对于矩阵转换和发射，每行总计为100%。</p><h2 id="c5e1" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">高斯混合模型(GMM)</h2><p id="cbd7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们需要依赖于时间的数据并从中计算特征，然后我们可以拟合GMM来找到我们的HMM的参数。当我们有了HMM的参数，我们可以计算原始签名和模仿签名的分数。根据分数，我们可以对签名的真实性进行分类评估。</p><p id="8867" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么我们首先要使用高斯混合模型来训练HMM参数？嗯，基本上<em class="np"> hmmlearn </em>为我们提供了三种选择:</p><ul class=""><li id="9dff" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">GMM-嗯</li><li id="6b2b" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">高斯HMM</li><li id="ba77" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">多项式HMM</li></ul><p id="928a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GMM效果最好，因为估计我们特征的密度很可能不仅仅是单个高斯或单个分布，而是地面实况看起来更像一个山谷，可以通过GMM更好地近似。</p><p id="8f9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以利用GMM的所谓EM(期望最大化)算法，让我们自动计算那些隐藏参数。EM算法期望什么来计算隐藏参数？</p><blockquote class="nq nr ns"><p id="7997" class="kw kx np ky b kz la jr lb lc ld ju le nt lg lh li nu lk ll lm nv lo lp lq lr ij bi translated">答案是:<strong class="ky ir">特色</strong>。</p></blockquote></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="f4d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GMM使用<strong class="ky ir"> EM </strong>算法计算其参数:</p><ul class=""><li id="cebd" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">步骤e:使用GMM参数(均值、方差)的当前估计值计算组件占用概率P(M|x)</li><li id="b9ef" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">步骤m:使用组件占用概率的当前估计值计算GMM参数。</li></ul><p id="c4ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们必须选择GMM的超参数，它们是:</p><ul class=""><li id="ab5e" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">m:高斯混合分量</li><li id="a8bb" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">学生:嗯，状态(晴天，雨天)</li></ul><p id="601b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上，我们无法知道最佳的超参数集是什么，但是我们可以使用K-Fold交叉验证来找出答案。</p><p id="353b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="np">等等什么，超参数，HMM参数？</em></p><blockquote class="nq nr ns"><p id="c6f6" class="kw kx np ky b kz la jr lb lc ld ju le nt lg lh li nu lk ll lm nv lo lp lq lr ij bi translated"><em class="iq">好的，超参数是我们人类需要选择的值。这也叫模式选择问题。模型参数是GMM和EM算法为我们计算的参数。</em></p></blockquote><h1 id="e3f9" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">资料组</h1><p id="99a3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">用于测量这些类型的特征(压力、速度等。)，我们需要一个类似于下图最左侧所示的设备:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/bb775091c8dd3a5d685dd2baf211ed70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ENcdeYdX9L08o-q1hC3Z6A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图1 by [1]:提出的在线签名验证系统的体系结构。</p></figure><p id="071c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我用的是<a class="ae kv" href="https://ms.sapientia.ro/~manyi/mobisig.html" rel="noopener ugc nofollow" target="_blank"> <em class="np"> mobisig </em> </a> <em class="np"> </em>数据集。它总共包含83个条目(49个男性，34个女性)，我们稍后将把它们分成训练集、测试集和模拟集。签名是由Margit Antal等人收集的。艾尔。<strong class="ky ir"> </strong>并于2017年发表在他们的研究论文中:<a class="ae kv" href="https://www.hindawi.com/journals/misy/2018/3127042/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">mobi SIG指画签名语料库上的在线签名验证</strong> </a>。</p><p id="541e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文提供了一个签名示例。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/fbd017364df5b90e82a7097bfea80eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYW3NQCtJlnZODOXB3qeeA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图2 by [2]:来自数据库的伪签名。第一列包含真实签名，第二列包含伪造签名。</p></figure><p id="aa53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以看出，伪造签名包含了更密集连接的<em class="np">压力</em>点。这篇论文解释了伪造是如何产生的。如果你愿意，你可以阅读它，但这篇文章的重点是我们如何检测这种伪造，而不是它是如何产生的。</p><h1 id="4228" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包导入</h1><p id="63f5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我将使用python的<a class="ae kv" href="https://hmmlearn.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"><em class="np">HMM learn</em></a><em class="np"/>包，这样我就不用从头开始构建HMM了。</p><p id="3a08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从导入这个项目的默认包开始。我设置了随机种子，所以你会有和我完全一样的情节。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文件加载</p></figure><p id="9df4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，我们希望确保正确地加载数据集，如上面的代码片段所示。数据存储在字典中，每个人有两个条目(“原始”和“模仿”)，每个条目被进一步分成多个签名。此外，所有签名都有几百或几千行带有时间戳id(以毫秒为单位)。</p><h1 id="09bd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">特征抽出</h1><p id="a73e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">回头看图1，第一步是特征提取。如果数据点以零为中心并且具有标准化的标准偏差，则拟合高斯，尤其是混合高斯会更加有效和高效。从文献[1]中，我们可以得到以下归一化步骤:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/1e5c0300f6a25f9357894325d9f6c64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*I97tEeg46nj7_wPb_3sfJA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图3: 1。步骤:位置标准化</p></figure><p id="b8ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们在归一化步骤之后提取四个特征。公式(2。步骤)从[3]中获得:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/293d96cbae7dc7485021ba82b43c327b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOa8E_AT7wpdbB2hldFWMQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2.步骤:特征提取</p></figure><p id="5385" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">规范化步骤1显示在代码的函数(第1–2行)中。图3中的公式只是对所有x和y求和，然后除以出现次数n，因此只需取平均值。此外，增加了ε(e =<em class="np">NP . finfo</em>)来防止<em class="np">除以零</em>的错误。</p><p id="b79f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第2步中的四个特征非常容易计算。x和y上的点表示使用我们刚刚计算的赋范x和y。除此之外，theta can的计算与代码第24行中的公式完全一样。第27行用同样的方法计算路径速度。它只是平方根！</p><p id="375e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特别要注意的是<em class="np">对数曲率半径</em>，因为如果你仔细观察，你会发现作者希望θ也被归一化。因此，在计算<strong class="ky ir">ρ</strong>(ρ)<strong class="ky ir"/>的第30行，我们也调用<strong class="ky ir">θ</strong>(θ)上的范数函数。</p><p id="f3a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在代码中把最后一个特性称为alpha，因为它听起来比a更好。它和代码第33行中的其他特性一样容易计算。</p><p id="f507" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我将所有的特征添加到它们相应的列表中，因为我们需要将这些特征输入到隐马尔可夫学习函数中。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="6cd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们完成了特征提取步骤。现在让我们建立模型。<br/> <strong class="ky ir">哦不！<br/> </strong>我们需要将数据分成训练、测试和模拟数据集。从提到的条目中，我使用前25个人作为训练示例，这是防止过度拟合的最小数量，其中一个条目对应于一个人的多个签名。所以列车组包含25个不同的人，他们有许多真实和伪造的签名。测试集包含另外20个不同的人，验证集(X_val)包含所有模仿的签名。</p><pre class="kg kh ki kj gt oj ok ol om aw on bi"><span id="7dc3" class="mp lt iq ok b gy oo op l oq or">X_train: (3940, 8)<br/>X_test: (3140, 8)<br/>X_val: (10338, 8)</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="8c20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我说过所有签名的行长度是不同的，所以我总是需要跟踪当前长度，并将其附加到新的数据帧中。正确编程是相当困难的。在第51行，我将特性重命名为特性提取步骤中的名称。</p><blockquote class="nq nr ns"><p id="6bd3" class="kw kx np ky b kz la jr lb lc ld ju le nt lg lh li nu lk ll lm nv lo lp lq lr ij bi translated">需要注意的是，我在第47–49行调用了特征提取函数来计算特征。</p></blockquote><h1 id="33ac" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">建立GMM-HMM模型</h1><p id="d7b6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了训练GMM HMM，我们需要看一下来自<a class="ae kv" href="https://hmmlearn.readthedocs.io/en/latest/api.html#hmmlearn.hmm.GMMHMM" rel="noopener ugc nofollow" target="_blank"> hmmlearn </a>的文档。</p><p id="07e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们需要两个基本变量:</p><ul class=""><li id="5dc9" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">transmat(转换矩阵)(雨天，晴天)</li><li id="0771" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">startprob(开始的初始概率矩阵)(60% 40% —根据S的数量(<em class="np"> HMM状态</em>))</li></ul><p id="af40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转移矩阵将被参数化，使得它以50%的概率(0.5)对角填充，除了第一个和最后一个条目。这是hmmlearn在文档中建议的。startprob矩阵也是如此，我从hmmlearn中选择了默认的初始化。</p><p id="2d3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">特征变量<strong class="ky ir"> X_train </strong>现在包含一个时间戳和每行七个特征:</p><ul class=""><li id="5e87" class="nb nc iq ky b kz la lc ld lf nd lj ne ln nf lr ng nh ni nj bi translated">x和Y位置</li><li id="56de" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">压力</li><li id="9b61" class="nb nc iq ky b kz nk lc nl lf nm lj nn ln no lr ng nh ni nj bi translated">四个提取的特征</li></ul><p id="90df" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们可以在下面代码的第20行创建模型。成分的数量和混合的数量在模拟签名的估计有多好方面起着重要的作用，但是正如已经说过的，我们无法知道最佳值是什么。因此，我尝试了不同的组合。让我们来看看这两个超参数是如何相互对抗的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="4024" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第35、39和43行中的score函数计算三个不同集合的分数。这些分数由GMM的目标函数计算得出，即<strong class="ky ir">负对数似然</strong>。</p><p id="1c2e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，让我们用不同的分量值和GMM值调用fit_hmm函数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">绘制gif图</p></figure><blockquote class="os"><p id="7f3a" class="ot ou iq bd ov ow ox oy oz pa pb lr dk translated">当我们拥有一组分数不同于或低于原始签名(蓝色或绿色)的模仿签名时，我们称之为成功。</p></blockquote><figure class="pd pe pf pg ph kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/69fd0e511931f6b854859646df9902bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/1*Yk5ZCGWMoskZgTwiwz9lAw.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由我用Matplotlib创建:用户3</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/5443b6a692cf6aac3982cd855d2d0137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/1*8JbwKA8O2zpLG0Wh4Gef5g.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由我用Matplotlib创建:用户7</p></figure><p id="7c85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，HMM状态的数量对分数的影响最大。我们希望分数尽可能将红点(模仿)与原始蓝点和绿点分开。七个或更少的HMM状态似乎很好地将红点从其余的中分离出来，并且GMM分量显然对输出的影响很小。</p><h1 id="8303" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">估价</h1><p id="5630" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果我们在彩色点之间画一条线性分类线，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/d6f1b5805291f0bb6eebc7ed822301a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*Qf_r_HSqpNqctYGMniVyUg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">如果签名是假的，请分类</p></figure><p id="6acf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到HMM能够多好地检测签名是否是伪造的。例如，我们将阈值设置为-2200，然后对新的签名进行评分。如果分数的值小于-2200，我们认为它是假的，如果分数大于-2200，我们认为它是原始签名。</p><h2 id="94ec" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">延长</h2><p id="54dc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们现在可以做的是保存分数，并训练例如逻辑回归来预测概率(0-100%)，基于签名是否是原始的分数<strong class="ky ir">。</strong>这个逻辑回归可以用<em class="np"> sklearn </em>的准确度分数进一步扩展，以估计模型的不确定性。</p><h1 id="56c6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="8841" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">成功！我们可以成功地区分模仿签名和原始签名。一些也映射时间约束的最新方法是递归神经网络。但是现在，我们看到这也可以用非常经典的方法实现，比如HMM。</p><p id="b27c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要了解更多信息，你可以访问我的<a class="ae kv" href="https://timloehr.me/" rel="noopener ugc nofollow" target="_blank">网站</a>，并在我链接的社交媒体中添加我。如果你在这篇博文上给我鼓掌，我会很高兴的:)。</p><h1 id="ba9a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">参考</h1><p id="bc76" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">[1] Julian Fierrez等人。艾尔。、<a class="ae kv" href="https://www.sciencedirect.com/science/article/abs/pii/S0167865507002395" rel="noopener ugc nofollow" target="_blank"> HMM-based在线签名验证:特征提取和签名建模</a> (2007)、<a class="ae kv" href="http://www.sciencedirect.com" rel="noopener ugc nofollow" target="_blank">科学直接</a><br/>【2】马吉特·安塔尔、拉斯洛·佐尔特·绍博和图·NDE·托尔戴<strong class="ky ir">、</strong> <a class="ae kv" href="https://www.hindawi.com/journals/misy/2018/3127042/" rel="noopener ugc nofollow" target="_blank">在MOBISIG手指绘制签名语料库上的在线签名验证</a> (2017)、<a class="ae kv" href="http://www.hindawi.com" rel="noopener ugc nofollow" target="_blank">欣达维</a><br/>【3】朱利安·菲尔雷兹等。艾尔。，<a class="ae kv" href="https://link.springer.com/chapter/10.1007/11527923_54" rel="noopener ugc nofollow" target="_blank">基于局部和全局信息融合的在线签名验证系统</a> (2005)，<a class="ae kv" href="https://link.springer.com/" rel="noopener ugc nofollow" target="_blank"> Springer </a></p><p id="8863" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇博文基于从弗里德里希·亚历山大大学埃尔兰根-纽伦堡的课程模式分析中获得的知识。我使用了Christian Riess博士演讲的部分内容来说明这篇文章的例子。所以所有权利归克里斯汀·里斯博士所有。</p></div></div>    
</body>
</html>