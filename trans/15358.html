<html>
<head>
<title>Magic tables in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Power BI中的魔表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/magic-tables-in-power-bi-ab4e8dd9af38?source=collection_archive---------10-----------------------#2020-10-22">https://towardsdatascience.com/magic-tables-in-power-bi-ab4e8dd9af38?source=collection_archive---------10-----------------------#2020-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b111" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">您的Power BI报告中的表格不需要是老式的枯燥视觉效果。查看如何为用户创建令人惊讶的表格！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9d93564fe2cfe0e7e01254dbba49d259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3_81H6qRMKEAkEXDGzrKw.jpeg"/></div></div></figure><p id="2bfa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">桌子，桌子，桌子…爱他们，或者恨他们，我们，Power BI开发者，离不开他们。我们的用户也是。你有多少次听到你的用户，这样的一句话:<em class="lq">嘿，那些图表很酷，这些颜色也很好看……但是，给我表格里我的数据。你知道，我是一个“Excel人”,喜欢看到我的数据排成行和列</em> …</p><p id="85d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这完全没问题——当你收到这样的请求时，不要感到不安。然而，世卫组织说我们必须给我们的用户“正常”的表格。如果我们可以满足他们的要求，但只需要一点创意和魔法，同时将他们的桌面体验提升到一个全新的水平，会怎么样？</p><h2 id="1e7f" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">把我的桌子给我…</h2><p id="a6fb" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">这是一个商业场景。我们有关于通过推荐计划注册我们服务的客户的数据。如果这些客户为我们的服务进行了第一次存款，我们也有数据，因此我们可以轻松跟踪客户注册但没有存款的情况，我们的客户支持部门可以联系他们，检查他们在注册后是否面临任何问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/d89a92cc60a36a6faa86c1af9a30076f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XS4X_9a8nSrlhO9kSF0VcA.png"/></div></div></figure><p id="f2ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我的例子中，数据来自Excel文件，但在现实生活中，它存储在SQL Server数据库中。</p><p id="94db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以在Power BI中基于上图中看到的数字创建一系列可视化效果，但是我们的用户很固执，想要他的表。好了，这就对了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/bfd8446e89125d601275ce06c4023c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSTXKIbrY-0hfLyzDnF9VQ.png"/></div></div></figure><p id="290b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你问我，那看起来比在Excel中稍微好一点，但是它仍然——丑陋！我的意思是，我们可以对表格应用一些格式并添加一些颜色，但它仍然是一个普通的旧表格。</p><h2 id="069e" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">阿布拉卡达布拉——让这张桌子闪闪发光！</h2><p id="da23" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">正如我已经提到的，通过一些想象力和创造力，我们可以让这张桌子脱颖而出。所以，我们先给底层数据添加一些逻辑。我将打开超级查询编辑器，在“添加列”选项卡下，我将选择“自定义列”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d110515b5ab47abd5edd17d86b6212a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4DTnOVH6TbLrQSo0aWYkQ.png"/></div></div></figure><p id="06d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，由于我们已经学习了<a class="ae mr" rel="noopener" target="_blank" href="/power-query-tips-for-every-power-bi-developer-da9ebd3dcd93">电力查询</a>中的一些基本时间操作，我将编写下面的M公式来计算今天的日期与客户签约的日期之间的天数:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="34aa" class="lr ls it mt b gy mx my l mz na">Duration.TotalDays(Date.From(DateTime.LocalNow())-[Signup Date])</span></pre><p id="0070" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此外，我想计算注册和首次存款之间的天数。这可以通过使用下面的M语句来完成:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="58e9" class="lr ls it mt b gy mx my l mz na">Duration.TotalDays(Date.From([First Deposit])-[Signup Date])</span></pre><p id="f5cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，由于我已经用两个额外的列扩展了我的数据模型，我可以执行一系列不同的计算，例如注册日期和第一次存款日期之间的平均数。此外，我可以在我的报告中使用这些列作为切片器，例如，只检查那些在注册后3-6天内没有存款的客户！</p><p id="8831" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们把重点放在增强我们原来的“丑陋”的表。为了让我们的表格更加“用户友好”，我们需要应用一些<a class="ae mr" rel="noopener" target="_blank" href="/5-tips-to-boost-your-power-bi-development-a44d7e782037">特定的格式</a>，包括常规格式和条件格式。</p><p id="e160" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将首先创建一个列来保存自客户注册以来的天数的文本值:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="3820" class="lr ls it mt b gy mx my l mz na">Signup Text = IF(Signups[Days Signed] = 1,<br/>            "1 day ago",<br/>            Signups[Days Signed]&amp;" days ago"<br/>)</span></pre><p id="bdd9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个公式将帮助我们处理复数和单数文本定义。我将需要另一个计算列来跟踪客户-如果他存款或没有:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5df7" class="lr ls it mt b gy mx my l mz na">Signup vs Deposit = IF(Signups[Days Deposit] &lt; 1 &amp;&amp; Signups[Days Signed] &lt; 3,<br/>                        2,<br/>                        IF(Signups[Days Signed] &gt;= 3 &amp;&amp; Signups[Days Deposit] &lt; 1,0,1)<br/>)</span></pre><p id="9091" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本上，这个想法是有三个层次的标记:第一个是客户谁存款，不管什么时候。第二层是前2天报名，但还没有订金的客户。最后，最后一组是两天前注册但仍未存款的客户。而且这个群体应该很容易被我们的客户支持识别出来，这样他们就可以很快隔离那些客户并联系他们。</p><p id="f0d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该公式将这三个级别分开，为每个级别分配一个数字(0，1，2)，该数字将在以后用于条件格式。</p><p id="8a80" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一步，在样式下设置稀疏，关闭垂直网格。这里有一个简短的声明:<em class="lq">你可以按照你喜欢的方式格式化你的表格，你不需要遵循我选择的所有风格</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/b58851965e1e6c6647a13531b4996f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*DAIWumo_GAgueGV2GTej0Q.png"/></div></figure><p id="9da5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，最重要的部分是根据特定的值有条件地格式化我们的字段。首先，我将设置我的注册栏的格式，使用一些渐变的颜色，这样当客户注册时就可以立即看到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8e715e40acee1beb750b6c14a4669827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gekHte4GyLVMXptTtmvhhg.png"/></div></div></figure><p id="4136" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是我的表现在的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/b09f69bf330834573c24dde7f062aecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V1QH7_PVxedOB4IpddIsPg.png"/></div></div></figure><p id="33b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它已经看起来更好了，自从客户注册以来，这种颜色渐变为我们的桌子增加了额外的质量。</p><p id="1aef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，最后的接触是标记“目标”客户。为了实现这一点，我们将再次使用条件格式，这一次是针对具有0、1、2值的列。打开图标，在“高级控制”下，定义每个特定值的图标:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f80ba5af0efd2fc2145a6d31fc69d433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dOcHS7Vktn4KrtIz1Dp0Q.png"/></div></div></figure><p id="1079" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我们的表看起来像这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/709635a7ba45ccb08eb27669c7123cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGlg7RN9xBW-o4EYbEoEtg.png"/></div></div></figure><p id="9fce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">绿色符号表示该客户进行了存款。黄色感叹号表示该客户尚未存款，但他在前两天注册了。最后，我们的“目标”群体是一个带有红色符号的客户，他不久前注册了，但仍未存款。</p><p id="77e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如您可能看到的，这仍然是一个表，但它比我们开始使用的那个表更友好。当然，我们可以通过让用户使用切片器来操作数据，为我们的报告添加一些额外的逻辑:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/358224718f60e7a749959e780ef029c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KyK0gYGSyeqbEyNF7Dhx5w.png"/></div></div></figure><p id="d890" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过这种方式，我们的报告用户可以轻松地过滤掉不感兴趣的数据进行分析，并专注于他们的目标。</p><h2 id="5f7b" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">结论</h2><p id="7478" class="pw-post-body-paragraph ku kv it kw b kx mk ju kz la ml jx lc ld mm lf lg lh mn lj lk ll mo ln lo lp im bi translated">正如你所看到的，桌子不一定需要是老式的无聊的视觉效果。通过一些小小的调整和对不同属性应用条件格式，您可以创建出引人注目的闪亮表格。更重要的是，它们肯定会丰富你的用户体验。</p><p id="7fc4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢阅读！</p><p id="0364" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">成为会员，阅读Medium上的每一个故事！</p><p id="d7ef" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">订阅<a class="ae mr" href="http://eepurl.com/gOH8iP" rel="noopener ugc nofollow" target="_blank">这里</a>获取更多有见地的数据文章！</p></div></div>    
</body>
</html>