<html>
<head>
<title>Searching and sorting encrypted data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">搜索和排序加密数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/searching-and-sorting-encrypted-data-59fc95d961b7?source=collection_archive---------36-----------------------#2020-10-27">https://towardsdatascience.com/searching-and-sorting-encrypted-data-59fc95d961b7?source=collection_archive---------36-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b728" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">走向安全的云数据库</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c0cfec1a9c2b16affe2dd9c4aac34aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3c1MwjEGwnnnOKL6"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Mauro Sbicego 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9fac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设有一天，你的老板走进办公室，给你一份工作:</p><blockquote class="ls lt lu"><p id="6c57" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">老板:我要你对一组数据进行排序</p><p id="97ab" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">你:好吧！给我意见，我会处理的</p><p id="ffe0" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">老板:我不信任你，我的数据对我来说是合理的</p><p id="1dc3" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">你:如果你不想给我数据，我该怎么分类？</p><p id="bc38" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">老板:不知道！想办法！这就是我付钱给你的原因😤</p></blockquote><blockquote class="lz"><p id="c838" class="ma mb iq bd mc md me mf mg mh mi lr dk translated"><strong class="ak">如果你没有数据，你怎么能对一组数据进行排序呢？</strong></p></blockquote><p id="4de0" class="pw-post-body-paragraph kw kx iq ky b kz mj jr lb lc mk ju le lf ml lh li lj mm ll lm ln mn lp lq lr ij bi translated">和大多数隐私问题一样，答案在于<strong class="ky ir"> <em class="lv">密码术</em> </strong>的秘密。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/aa9c87488d1120d31559eb30aae139c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PNPggjDYiWr8x4Jy"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斯蒂芬·斯坦鲍尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="d1ed" class="mp mq iq bd mr ms mt dn mu mv mw dp mx lf my mz na lj nb nc nd ln ne nf ng nh bi translated">关于通用加密的一个词</h2><p id="a494" class="pw-post-body-paragraph kw kx iq ky b kz ni jr lb lc nj ju le lf nk lh li lj nl ll lm ln nm lp lq lr ij bi translated">我想我们所有人，作为程序员，都至少在自己写的软件中使用过一次密码学。有些人可能只是在服务器上启用TLS，有些人可能编写了特殊的加密软件。在所有这些情况下，您都有一些想要加密的数据。</p><p id="00a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最常见的加密方案，如AES、RSA等。有一个至关重要的特性:它们在语义上是安全的。这是什么意思？嗯，是关于两个人的游戏。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/c1339e9deab26e71ccaee2246ed9b65b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*viYTmngoPrnbnaKN"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="2536" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个游戏(称为IND-CPA游戏)中，一个玩家是攻击者，另一个是挑战者。游戏如下:</p><ol class=""><li id="50ec" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">攻击者选择一些消息，挑战者提供这些消息的密文</li><li id="193c" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">攻击者选择两条相同长度的消息发送给挑战者</li><li id="9fd5" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">挑战者从两条消息中随机选择一条，加密并发送给攻击者</li><li id="8acf" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">如果攻击者猜对了哪条消息被加密，该方案就被破解了</li></ol><p id="1eb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图说明了这个游戏:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/77b7447e229713ec0ca1b4ef752e41a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAxYkCBK5lmSdnXhwjHpkQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Ryan Henry I 538 /B 609:密码学简介</p></figure><h2 id="3e88" class="mp mq iq bd mr ms mt dn mu mv mw dp mx lf my mz na lj nb nc nd ln ne nf ng nh bi translated">回到老板的问题</h2><p id="3c0e" class="pw-post-body-paragraph kw kx iq ky b kz ni jr lb lc nj ju le lf nk lh li lj nl ll lm ln nm lp lq lr ij bi translated">所以你的老板有一些数据，他想排序，但他不想给你看😵</p><p id="8e61" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可能想告诉你的老板在把数据交给你之前先加密。假设数组只包含两个元素:<em class="lv"> m1 </em>和<em class="lv"> m2 </em>。计划如下:</p><ol class=""><li id="1eb2" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">老板使用某种加密方案对这两个元素进行加密，得到两个密文:<em class="lv"> c1 </em>和<em class="lv"> c2 </em></li><li id="4363" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">你比较一下<em class="lv"> c1 </em>和<em class="lv"> c2。</em>如果<em class="lv"> c1 &lt; c2 </em>你告诉你老板，排序后的数组是[ <em class="lv"> m1 </em>，<em class="lv"> m2 </em> ]。否则你告诉你老板，排序后的数组是[ <em class="lv"> m2 </em>，<em class="lv"> m1 </em> ]。</li></ol><blockquote class="lz"><p id="de40" class="ma mb iq bd mc md me mf mg mh mi lr dk translated">为此，你需要一个<strong class="ak">保序</strong>的加密方案。</p></blockquote><p id="098b" class="pw-post-body-paragraph kw kx iq ky b kz mj jr lb lc mk ju le lf ml lh li lj mm ll lm ln mn lp lq lr ij bi translated">也就是说，该方案保留了明文的顺序。举个例子，如果<em class="lv"> c1 </em>是<em class="lv"> m1 </em>的加密，<em class="lv"> c2 </em>是<em class="lv"> m2 </em>和<em class="lv"> m1 </em> &lt; <em class="lv"> m2 </em>的加密，那么<em class="lv"> c1 </em> &lt; <em class="lv"> c2 </em>。</p><p id="af63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你正在考虑一个共同的加密方案，如AES或RSA，它不会工作。为什么？记住所有这些方案都是语义安全的。</p><p id="2ffb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">如果你能比较两个密文，并推断出明文的顺序，你就能打破IND-CPA游戏。</strong></p><p id="4348" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">方法如下:</p><p id="875d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">游戏第一步，你会选择两条消息<em class="lv"> m1 </em>和<em class="lv">m2</em>(<em class="lv">m1</em>&lt;<em class="lv">m2</em>)。挑战者将返回两条消息的密文:<em class="lv"> c1 </em>和<em class="lv"> c2 </em>。然后，在步骤2中，您将向挑战者发送在第一步中选择的相同消息(<em class="lv"> m1 </em>和<em class="lv"> m2 </em>)。挑战者将返回一个密文<em class="lv"> c </em>，该密文将是<em class="lv"> m1 </em>的加密或<em class="lv"> m2 </em>的加密。如果<em class="lv"> c </em>是对<em class="lv"> m1 </em>的加密，那么<em class="lv"> c &lt; c2 </em>如果<em class="lv"> c </em>是对<em class="lv"> m2 </em>的加密，那么<em class="lv"> c &gt; c1 </em></p><p id="e834" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，您不能使用AES、RSA或任何其他众所周知的加密方案。那你应该用什么呢？</p><blockquote class="lz"><p id="c949" class="ma mb iq bd mc md od oe of og oh lr dk translated">Boldyreva的加密方案是您的正确答案</p></blockquote><p id="6806" class="pw-post-body-paragraph kw kx iq ky b kz mj jr lb lc mk ju le lf ml lh li lj mm ll lm ln mn lp lq lr ij bi translated">如果你想了解更多可以阅读原文<a class="ae kv" href="https://www.cc.gatech.edu/~aboldyre/papers/bclo.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="lv">这里</em> </a>。</p><p id="2ea1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们开始工作，实现加密数据的排序和搜索。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/45abb8cfd2888e61ab215428de53b0a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J3i8Yxu2VC3-xrSW"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@corinnekutz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Corinne Kutz </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="bd66" class="mp mq iq bd mr ms mt dn mu mv mw dp mx lf my mz na lj nb nc nd ln ne nf ng nh bi translated">在python中排序和搜索加密数据</h2><p id="7bf8" class="pw-post-body-paragraph kw kx iq ky b kz ni jr lb lc nj ju le lf nk lh li lj nl ll lm ln nm lp lq lr ij bi translated">Boldyreva的方案已经在<a class="ae kv" href="https://pypi.org/project/pyope/" rel="noopener ugc nofollow" target="_blank"> pyope </a>库中实现。因此，让我们导入库:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="131d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要使用该方案，我们必须首先生成密钥并实例化密码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="767a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们用一个简单的数组来排序它:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="e9fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了加密这个数组，我们需要在<em class="lv"> simple_array </em>的每个元素上调用<em class="lv">密码</em>对象的<em class="lv">加密</em>方法<em class="lv">T3:</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="b988" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只需对列表进行排序:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="2cc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您已经对数组进行了排序，让我们解密它，并验证原始元素是否按升序排列。为此，您需要在<em class="lv">simple _ array _ encrypted:</em>的每个元素上调用<em class="lv"> cipher </em>对象的<em class="lv"> decrypt </em>方法</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="e980" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你应该看到[1，2，3，4，7]。</p><p id="fccf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你的老板给你一个加密的元素，并询问它是否存在于他给的加密数组中，你只需从numpy库中调用<a class="ae kv" href="https://numpy.org/doc/stable/reference/generated/numpy.searchsorted.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">search sorted</em></a><em class="lv"/>函数即可:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="8cbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您应该看到2。</p><h2 id="fa3c" class="mp mq iq bd mr ms mt dn mu mv mw dp mx lf my mz na lj nb nc nd ln ne nf ng nh bi translated">结论</h2><p id="6d47" class="pw-post-body-paragraph kw kx iq ky b kz ni jr lb lc nj ju le lf nk lh li lj nl ll lm ln nm lp lq lr ij bi translated">恭喜你！你刚刚意识到了不可能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a91b78dcba435d9f012281ff5dfc3ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9QkL37BIZX9em5bG"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">威尔·斯图尔特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d2e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您能够在不知道元素本身的情况下对元素列表进行排序和搜索。保序加密和揭示序加密是密码学中非常活跃的研究领域。这些加密方法有许多应用，尤其是在数据库领域。随着数据量的增加，通过个人资源维护数据库变得越来越困难。你需要把你的数据放到云中。然而，没有必要以清晰的形式给出你的数据。你可以使用像保序加密这样的东西，首先加密你的数据，然后把它发送到云端。加密方案允许您继续使用数据库，即使数据一直被加密。这就是密码学的美妙之处，❤️.</p><p id="610b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读😊</p><p id="2ab3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，我为你准备了一个colab笔记本，上面有所有代码。你可以从<a class="ae kv" href="https://colab.research.google.com/drive/1qloJ3Uz5czz4uoGkvcTOoBgsVz7ugTb6?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>进入。</p></div></div>    
</body>
</html>