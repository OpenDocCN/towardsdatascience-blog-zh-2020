<html>
<head>
<title>Cosine similarity: How does it measure the similarity, Maths behind and usage in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">余弦相似性:它是如何衡量相似性的，背后的数学原理以及在Python中的用法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cosine-similarity-how-does-it-measure-the-similarity-maths-behind-and-usage-in-python-50ad30aad7db?source=collection_archive---------8-----------------------#2020-09-27">https://towardsdatascience.com/cosine-similarity-how-does-it-measure-the-similarity-maths-behind-and-usage-in-python-50ad30aad7db?source=collection_archive---------8-----------------------#2020-09-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/ebd23d9a372ef736e49b542cbf78faeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yYMofdAlVtlbfpwi"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Artem Kniaz 在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="09f1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">什么是余弦相似度？</strong></p><p id="334a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">余弦相似性通过计算两个向量之间角度的余弦来度量两个向量之间的相似性。</p><p id="abd3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">余弦相似性是数据科学中使用最广泛、最强大的相似性度量之一。它被用于多种应用，例如在自然语言处理中寻找相似的文档，信息检索，在生物信息学中寻找与DNA相似的序列，检测剽窃等等。</p><p id="4438" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">余弦相似度计算如下:</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi le"><img src="../Images/6fa4c0e2778c5d5636604f9ddb16aee2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*AqWG1VHnLf8P7_H4KDBwVQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">两个二维向量A和B之间的角度(图片由作者提供)</p></figure><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lj"><img src="../Images/0af6e5271ddb47fd7bfe8df1ec80c079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LfW66-WsYkFqWc4XYJbEJg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">A和B之间夹角余弦的计算</p></figure><p id="a385" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">为什么A和B之间的夹角余弦给了我们相似性？</strong></p><p id="ceef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你看看余弦函数，θ= 0°时为1，θ= 180°时为-1，这意味着对于两个重叠的矢量，余弦将是两个完全相反的矢量的最高和最低值。你可以把1余弦当作距离。</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lk"><img src="../Images/7de7dbeed9e402542a6bfb14f035ee46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTPC_CFlHlQ1oyPsn9zRqQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">余弦(作者图片)</p></figure><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ll"><img src="../Images/2c76432288c4625fe4d8ea4d6f90b65b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17iIvBSo_BS9T3Ww7hUdkg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">不同角度的余弦值(图片由作者提供)</p></figure><p id="a7cd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">用Python怎么算？</strong></p><p id="44c4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">公式的分子是两个向量的点积，分母是两个向量的L2范数的乘积。两个向量的点积是向量的元素相乘的和，L2范数是向量的元素平方和的平方根。</p><p id="f0f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用Numpy库中的内置函数来计算向量的点积和L2范数，并将其放入公式中，或者直接使用来自sklearn.metrics.pairwise的余弦相似度。考虑二维中的两个向量A和B，下面的代码计算余弦相似度，</p><pre class="lf lg lh li gt lm ln lo lp aw lq bi"><span id="dcee" class="lr ls it ln b gy lt lu l lv lw">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="e916" class="lr ls it ln b gy lx lu l lv lw"># consider two vectors A and B in 2-D<br/>A=np.array([7,3])<br/>B=np.array([3,7])</span><span id="bf24" class="lr ls it ln b gy lx lu l lv lw">ax = plt.axes()</span><span id="155b" class="lr ls it ln b gy lx lu l lv lw">ax.arrow(0.0, 0.0, A[0], A[1], head_width=0.4, head_length=0.5)<br/>plt.annotate(f"A({A[0]},{A[1]})", xy=(A[0], A[1]),xytext=(A[0]+0.5, A[1]))</span><span id="5f5b" class="lr ls it ln b gy lx lu l lv lw">ax.arrow(0.0, 0.0, B[0], B[1], head_width=0.4, head_length=0.5)<br/>plt.annotate(f"B({B[0]},{B[1]})", xy=(B[0], B[1]),xytext=(B[0]+0.5, B[1]))</span><span id="22fd" class="lr ls it ln b gy lx lu l lv lw">plt.xlim(0,10)<br/>plt.ylim(0,10)</span><span id="fa22" class="lr ls it ln b gy lx lu l lv lw">plt.show()<br/>plt.close()</span><span id="62b6" class="lr ls it ln b gy lx lu l lv lw"># cosine similarity between A and B<br/>cos_sim=np.dot(A,B)/(np.linalg.norm(A)*np.linalg.norm(B))<br/>print (f"Cosine Similarity between A and B:{cos_sim}")<br/>print (f"Cosine Distance between A and B:{1-cos_sim}")</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/b920755aab523673df19d73a71328a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZMKAFB5YRbw38_yROaAJw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">代码输出(图片由作者提供)</p></figure><pre class="lf lg lh li gt lm ln lo lp aw lq bi"><span id="b017" class="lr ls it ln b gy lt lu l lv lw"># using sklearn to calculate cosine similarity<br/>from sklearn.metrics.pairwise import cosine_similarity,cosine_distances</span><span id="15b9" class="lr ls it ln b gy lx lu l lv lw">cos_sim=cosine_similarity(A.reshape(1,-1),B.reshape(1,-1))<br/>print (f"Cosine Similarity between A and B:{cos_sim}")<br/>print (f"Cosine Distance between A and B:{1-cos_sim}")</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/5187301deae0a97a11e144cbc076f183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgP7-TGp8Nz8yMTE4eRE5w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">代码输出(图片由作者提供)</p></figure><pre class="lf lg lh li gt lm ln lo lp aw lq bi"><span id="9c6b" class="lr ls it ln b gy lt lu l lv lw"># using scipy, it calculates 1-cosine<br/>from scipy.spatial import distance</span><span id="d1b4" class="lr ls it ln b gy lx lu l lv lw">distance.cosine(A.reshape(1,-1),B.reshape(1,-1))</span></pre><figure class="lf lg lh li gt ju gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/0cb2e95b5c69863f5a7eb00f3fe02d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*aEnzPEGh55orcD1JPBztXw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">代码输出(图片由作者提供)</p></figure><p id="8249" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">公式的证明</strong></p><p id="9a7d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">余弦相似公式可以用余弦定律来证明，</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/f3cf0983cf6fa612a357c2cf56dab9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ScrWLNQ7IzZrYZdt6-Yu5g.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">余弦定律(图片由作者提供)</p></figure><p id="d756" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑二维的两个向量A和B，例如，</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mb"><img src="../Images/6ebeac5dd07aef6eb272ef6ac18aaf9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mv617aAq7NHIXFXFa2xH4A.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">两个二维向量(图片由作者提供)</p></figure><p id="b43e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">利用余弦定律，</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/8aa287888cb2574f56b6921766afd9c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4DauTnyl2DYjKb2G5bryyA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">余弦相似性使用余弦定律(图片由作者提供)</p></figure><p id="48db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以证明同样的3维或任何维度。它遵循与上面完全相同的步骤。</p><p id="f7d6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">总结</strong></p><p id="cbca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到了余弦相似性是如何工作的，如何使用它以及它为什么工作。我希望这篇文章有助于理解这个强大指标背后的整个概念。</p></div></div>    
</body>
</html>