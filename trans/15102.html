<html>
<head>
<title>What is the Softmax Function? — Teenager Explains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是Softmax函数？—少年解释道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-the-softmax-function-teenager-explains-65495eb64338?source=collection_archive---------23-----------------------#2020-10-17">https://towardsdatascience.com/what-is-the-softmax-function-teenager-explains-65495eb64338?source=collection_archive---------23-----------------------#2020-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b765" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">softmax函数的简要说明，什么是softmax函数，它是如何工作的，以及一些代码。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b4bece4bcf48d6acdc8aa3c924aed0ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kkaxMlJh2LaWtaLtSbaGIg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者通过<a class="ae kv" href="https://imgflip.com/memegenerator" rel="noopener ugc nofollow" target="_blank"> Imgflip </a>生成的图片</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kw"><img src="../Images/0861654381cef337902b6068ae145c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KhqUdBcTPMV4BoAfgcXnfw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由作者通过<a class="ae kv" href="https://imgflip.com/memegenerator" rel="noopener ugc nofollow" target="_blank"> Imgflip </a>生成</p></figure><blockquote class="kx"><p id="09ac" class="ky kz iq bd la lb lc ld le lf lg lh dk translated">softmax函数是一个激活函数，它将真实值转化为概率。</p></blockquote><p id="adaa" class="pw-post-body-paragraph li lj iq lk b ll lm jr ln lo lp ju lq lr ls lt lu lv lw lx ly lz ma mb mc lh ij bi md translated"><span class="l me mf mg bm mh mi mj mk ml di">在</span>一个正常的学年，此时此刻，我可能正坐在离家两个小时的咖啡店里，读着我计算机编程课前的讲座。或者，此时此刻，我可能正在上课，试图跟上我的教授对<em class="mm">精确方程</em>的解释。随着世界各地的学校关闭，像我这样的学生只能靠自己来对抗拖延症。一场可悲的斗争，一场我显然不会赢的斗争。在过去的几周里，尽管我的大学有大量的在线工作，但我已经决定这是学习我所能学习的关于深度学习的一切的最佳时间。像许多其他好奇的人一样，我决定在Udacity上参加一个名为<a class="ae kv" href="https://www.udacity.com/course/deep-learning-pytorch--ud188" rel="noopener ugc nofollow" target="_blank">深度学习与PyTorch </a>的课程(自然，本文的灵感来自于这个课程中的概念。)</p><p id="26f0" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">如果你已经阅读了我上一篇关于<a class="ae kv" href="https://medium.com/@anjalibhardwaj2700/what-is-a-perceptron-basics-of-neural-networks-c4cfea20c590" rel="noopener">感知器</a> <strong class="lk ir">，</strong>的文章，你已经知道感知器是一种二进制分类算法，它使用一些线性函数进行预测。但是如果我们想要对两种以上的数据进行分类呢？我们如何做到这一点？我们实际上可以使用一个激活函数，称为softmax函数。<strong class="lk ir">在本帖中，我们将讨论什么是softmax函数，比较二进制分类和多类分类，讨论softmax函数如何工作，并提供一些示例代码。</strong></p><h1 id="ff2d" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak">什么是Softmax函数？</strong></h1><p id="768e" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated">softmax函数是逻辑函数的推广，可用于对多种数据进行分类。softmax函数接受不同类别的实际值，并返回概率分布。</p><p id="156b" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">标准逻辑函数能够进行二元分类，而softmax函数能够进行多类分类。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/6f769291201093fe802fd18ae1d85bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhIgVHXmvfRdtkTpw9NYbw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="cb54" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak">让我们看看二元分类和多类分类是如何工作的</strong></h1><p id="e64a" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated"><strong class="lk ir">二元分类模型</strong></p><p id="55cc" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">假设我们有一个模型，我们知道你得到或得不到工作的概率是，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/32041955306d0550706af4e7daf7e98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*W4nISFiDZ01zC3V5IgndQg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="537f" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">因此，你得到工作的概率是p(工作)= 0.8，因此，你得不到工作的概率是p(没有工作)= 0.2。</p><p id="672e" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">该模型将接受一些输入，如你的期末考试成绩是多少？或者你建了多少个项目？基于线性模型，它将返回一个“分数”(作为一个未绑定的值)，分数越高，可能性越大。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/c2484c31f353327d4a82e3496a0b3cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcTkaBC5hnmJodqA5ed_jg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7f67" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">那么得到工作的概率就简单的是分数的sigmoid函数。(如果你想知道更多关于sigmoid函数如何工作的信息，请查看视频。).正如我们所知，sigmoid函数会将分数转换为概率，其中概率介于0和1之间。</p><p id="fdf9" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">然后将这个概率与我们已知的概率进行比较(所以，p(工作)= 0.8，p(不工作)= 0.2)。</p><p id="010e" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated"><strong class="lk ir">多类分类</strong></p><p id="3870" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">假设，我们试图建立一个模型，对3个不同的项目进行分类。一支铅笔，一支钢笔和一块橡皮。假设得到铅笔的概率是p(铅笔)= 0.5，得到钢笔的概率是p(钢笔)= 0.4，得到橡皮擦的概率是p(橡皮擦)= 0.1。因此概率看起来像，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/5e75830619184f4fd8e3f946538b5d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N29MZtDvlPPIrZgAUwJUxQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="b193" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">其中概率之和为1。</p><p id="9b81" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">现在，让我们对我们的模型执行与二元分类相同的步骤，给定一些输入，计算线性函数，并给每个项目打分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/edaf9142320727023c629549507ecf02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zu7rXeuMJFuNY4fDwuoORQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="33f2" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">现在我们有了分数，我们怎样才能找到这三项的概率呢？这就是softmax函数发挥作用的地方。</p><h1 id="f2e8" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak">soft max功能是如何工作的？</strong></h1><p id="0cfd" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated">给定上面的无界分数，让我们试着把这个转换成概率。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><h2 id="d6af" class="ob mt iq bd mu oc od dn my oe of dp nc lr og oh ne lv oi oj ng lz ok ol ni om bi translated">现在你可能会问，<strong class="ak">“为什么我们不能只使用一个sigmoid函数？”</strong></h2><p id="f639" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated">我们需要一个能做两件事的函数，</p><ol class=""><li id="3d18" class="on oo iq lk b ll mn lo mo lr op lv oq lz or lh os ot ou ov bi translated">使结果概率介于0和1之间。</li><li id="e6aa" class="on oo iq lk b ll ow lo ox lr oy lv oz lz pa lh os ot ou ov bi translated">使所得概率之和等于1。</li></ol><p id="0b1c" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">Sigmoid函数并不总是等于1。换句话说，sigmoid函数输出独立的分布p(x1)和p(x2 ),因此对于sigmoid函数，我们可以说p(作业)= 0.89，p(非作业)= 0.26，这两者之和不等于1。因此，当我们有独立的二进制标签时，如红色或蓝色，猫或狗等，sigmoid函数是有用的。正如我们将很快看到的，softmax函数的分布与输出变量p(x1，x2，x3)等相关联。</p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="f45c" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">我们将这些分数转换成概率的一种方法是使用这个函数，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/2897568550b4e1271a19b3ae64cd31af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ArRxsSEeEY68aRz6Mjpyew.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="d3fa" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">一个项目的分数，超过所有分数的总和。这是可行的，因为每个概率都在0和1之间。它还会使每个概率加起来为1。</p><p id="0cda" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">这看起来不错，但是你可能已经猜到有一个问题。如果分数是负数呢？这可能是有问题的，因为概率不再等于1。</p><p id="c568" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">怎么才能让每个数字都是正数呢？我们可以试着用一个指数函数，这样函数看起来就像这样，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/884ba6c1c2e735a8bcbcfdc16431a9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jf_Qr_etCPtIKq7NYa6F_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="7d34" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">我们做到了！</p><p id="e421" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">这就是所谓的softmax函数。它可以接受真实值并将其转化为概率。这非常有用，因为现在我们可以对两种以上的数据进行分类。(关于视频解释，我建议你看看这个！)</p><h1 id="7fd7" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak">代号</strong></h1><p id="0d9c" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated">现在我们来看看如何用python编写softmax函数的公式。</p><pre class="kg kh ki kj gt pd pe pf pg aw ph bi"><span id="7adc" class="ob mt iq pe b gy pi pj l pk pl">import numpy as np</span><span id="801e" class="ob mt iq pe b gy pm pj l pk pl">def softmax(L):<br/>    expL = np.exp(L) #calculating the numerator <br/>    sumExpL = sum(expL) #calculating the denominator <br/>    result = []<br/>    for i in expL:<br/>        result.append(i*1.0/sumExpL) #divind the numerator and denominator <br/>    return result<br/>    <br/>    # Note: The function np.divide can also be used here, as follows:<br/>    # def softmax(L):<br/>    #     expL = np.exp(L)<br/>    #     return np.divide (expL, expL.sum())</span></pre><p id="94fb" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated"><em class="mm">这段代码直接取自Udacity课程，</em> <a class="ae kv" href="https://classroom.udacity.com/courses/ud188/lessons/b4ca7aaa-b346-43b1-ae7d-20d27b2eab65/concepts/9e1364a8-e8b4-4eac-be12-4d44a139f721" rel="noopener ugc nofollow" target="_blank"> <em class="mm">深度学习用Pytorch </em> </a> <em class="mm">。</em></p><p id="9d63" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">这个softmax函数接受一个值L，它表示分数。计算函数的分子和分母，然后除以它。</p><h1 id="7333" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">关键要点</h1><p id="115c" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated"><strong class="lk ir">什么是softmax函数？</strong></p><p id="91c7" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">softmax函数是可以执行多类分类的激活函数。它接受真实值并进行概率分布。这个函数看起来像这样，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/884ba6c1c2e735a8bcbcfdc16431a9e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jf_Qr_etCPtIKq7NYa6F_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h1 id="d498" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">Week✨的DL视频</h1><p id="9923" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated">看看这深深的假！这看起来像是流行歌手爱莉安娜·格兰德，但这个视频实际上是来自热门的youtuber网站Emma Chamberlain。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pn po l"/></div></figure><h1 id="9f9e" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">额外资源/引用</h1><p id="ecb8" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated"><a class="ae kv" href="https://classroom.udacity.com/courses/ud188/lessons/b4ca7aaa-b346-43b1-ae7d-20d27b2eab65/concepts/9e1364a8-e8b4-4eac-be12-4d44a139f721" rel="noopener ugc nofollow" target="_blank">本文在很大程度上基于Udacity教授的PyTorch深度学习课程。你一定要去看看！</a></p><p id="770f" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">这个视频很好地解释了<a class="ae kv" href="https://www.youtube.com/watch?v=Aj7O9qRNJPY" rel="noopener ugc nofollow" target="_blank">乙状结肠</a>的功能。同样是Youtuber上的这个视频很好地解释了softmax的功能。</p><p id="970b" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">这里是对softmax函数及其与逻辑回归的关系的一个很好的概述。</p><p id="4f0a" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">阅读维基百科总是有用的！</p><p id="c581" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">吴恩达也很好地解释了softmax函数！</p><p id="e032" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated">关于sigmoid函数和softmax函数之间差异的详细解释可以在reddit表单上阅读。</p><h1 id="c05a" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak">哪里可以找到我</strong>😝</h1><p id="c185" class="pw-post-body-paragraph li lj iq lk b ll nk jr ln lo nl ju lq lr nm lt lu lv nn lx ly lz no mb mc lh ij bi translated"><a class="ae kv" href="http://www.linkedin.com/in/anjalibhardwaj2700" rel="noopener ugc nofollow" target="_blank">我的LinkedIn！</a>请随时与我联系，我喜欢谈论人工智能！</p><p id="00f7" class="pw-post-body-paragraph li lj iq lk b ll mn jr ln lo mo ju lq lr mp lt lu lv mq lx ly lz mr mb mc lh ij bi translated"><a class="ae kv" href="https://medium.com/@anjalibhardwaj2700" rel="noopener">关注我的中页了解更多</a>！</p></div></div>    
</body>
</html>