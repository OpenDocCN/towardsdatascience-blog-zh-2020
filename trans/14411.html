<html>
<head>
<title>Monte Carlo Tree Search (MCTS) AI Gameplay in Swift</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Swift中的蒙特卡罗树搜索(MCTS)人工智能游戏</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/monte-carlo-tree-search-mcts-ai-gameplay-in-swift-891745d764d6?source=collection_archive---------36-----------------------#2020-10-04">https://towardsdatascience.com/monte-carlo-tree-search-mcts-ai-gameplay-in-swift-891745d764d6?source=collection_archive---------36-----------------------#2020-10-04</a></blockquote><div><div class="fc hw hx hy hz ia"/><div class="ib ic id ie if"><figure class="ih ii gc ge ij ik fu fv paragraph-image"><div role="button" tabindex="0" class="il im di in bf io"><div class="fu fv ig"><img src="../Images/5c36a20732db242f0ebb282c580aac7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3NRVvf1pZFzKH7dERfjmHQ.jpeg"/></div></div><p class="ir is fw fu fv it iu bd b be z dk translated">尼克·卡沃尼斯在<a class="ae iv" href="https://unsplash.com/s/photos/monte-carlo-tree?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="d525" class="pw-subtitle-paragraph jv ix iy bd b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dk translated">再加上在Jupyter笔记本里设置S4TF！</h2></div><ol class=""><li id="44d5" class="kn ko iy kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le bi translated"><strong class="kp iz"> Swift不只是苹果的</strong></li><li id="c78e" class="kn ko iy kp b kq lf ks lg ku lh kw li ky lj la lb lc ld le bi translated">玩游戏的人工智能很棒</li><li id="0e6a" class="kn ko iy kp b kq lf ks lg ku lh kw li ky lj la lb lc ld le bi translated"><strong class="kp iz"> Swift是<em class="lk">不是</em>只为苹果！</strong></li></ol><p id="f45e" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">在这篇文章中，我将解释我如何在Jupyter笔记本中设置Swift，然后我如何使用Swift创建一个有时间限制的蒙特卡罗树搜索算法代理，它可以在17秒内玩2048。<em class="lk">整齐！</em></p><p id="bad1" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">《2048》之所以是一个测试人工智能代理的有趣游戏，是因为它不是确定性的:它是随机的。因此——不像其他一些用于测试人工智能的传统游戏，如CartPole和noughts &amp; crosses——这不是一个神经网络适合的问题。相反，我们可以使用随机算法，询问“哪一步造成的伤害最小？”一遍又一遍，并能快速浏览场景。</p><p id="3826" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">你说速度？是的——使用Swift可以让我们创建一个每秒能运行55步的代理，这是相当快的速度。</p></div><div class="ab cl ly lz hm ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ib ic id ie if"><h2 id="025f" class="mf mg iy bd mh mi mj dn mk ml mm dp mn ku mo mp mq kw mr ms mt ky mu mv mw mx bi translated">2048年的游戏</h2><p id="39b3" class="pw-post-body-paragraph ll lm iy kp b kq my jz ln ks mz kc lo ku na lq lr kw nb lt lu ky nc lw lx la ib bi translated">由意大利网络开发商Gabriele Cirulli设计，2048在4x4的棋盘上玩，初始化时你有两个随机的瓷砖，上面有“2”或“4”。通过向左、向右、向上或向下滑动，您可以将接触到的匹配值牌相加(例如，“2”和“2”变成“4”)，以便通过将所有牌相加得到数字“2048”来获胜。每一回合，新的牌上都会生成“2”或“4 ”,这意味着在您到达目标之前，棋盘很容易填满并被阻挡！</p><p id="597a" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">2048年很复杂，因为你玩得越多，每一步棋对最终棋盘状态的影响就越深远。我们不想让我们的人工智能太容易。</p><h2 id="1fce" class="mf mg iy bd mh mi mj dn mk ml mm dp mn ku mo mp mq kw mr ms mt ky mu mv mw mx bi translated">限时蒙特卡罗树搜索(T-B MCTS)</h2><p id="3ade" class="pw-post-body-paragraph ll lm iy kp b kq my jz ln ks mz kc lo ku na lq lr kw nb lt lu ky nc lw lx la ib bi translated">MCTS是一种与人工智能一起使用的搜索技术，它是概率性的和启发式的，将经典的树搜索与强化学习的机器学习(ML)原则结合在一起。作为一种算法，它于2006年推出，并已被广泛应用于许多游戏实例中，包括国际象棋、扑克，甚至是战役。</p><p id="7190" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">它利用探索和定期评估，处理当前最佳行动实际上可能不是最佳行动的可能性(这是扩展树的<em class="lk">宽度</em>并使用随机化)。这通过利用方法来平衡，通过坚持具有最大估计值的路径来避免低效率(这是扩展树的<em class="lk">深度</em>)。</p><p id="ab72" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">为什么有时间限制？当使用一个详细的算法时，定义一个做出决定的最大时间是很重要的。事实上，你分配给这个过程的时间(资源)越多越好，这是一个权衡。在这个例子中，我给每个决定分配了0.015秒。</p><p id="94d5" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated"><em class="lk">要想全面详细地了解MCTS，我推荐看看GeeksforGeeks </em>  <em class="lk">上这篇</em> <a class="ae iv" href="https://www.geeksforgeeks.org/ml-monte-carlo-tree-search-mcts/" rel="noopener ugc nofollow" target="_blank"> <em class="lk">有用的文章。</em></a></p></div><div class="ab cl ly lz hm ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ib ic id ie if"><p id="8b30" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">首先，让我们把一切都准备好。</p><p id="0441" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated"><em class="lk">请注意:我将介绍我在课程中使用的设置，其中包括用于TensorFlow的Swift(S4TF ),但它肯定不是创建MCTS代理的唯一可能设置。</em></p><h2 id="8996" class="mf mg iy bd mh mi mj dn mk ml mm dp mn ku mo mp mq kw mr ms mt ky mu mv mw mx bi translated"><strong class="ak">设置</strong></h2><ol class=""><li id="1c30" class="kn ko iy kp b kq my ks mz ku nd kw ne ky nf la lb lc ld le bi translated">除非你使用Linux或Mac，否则你需要一个Linux的Windows子系统(WSL)。我使用Ubuntu 18.04(在微软商店免费获得)</li><li id="6eec" class="kn ko iy kp b kq lf ks lg ku lh kw li ky lj la lb lc ld le bi translated">为TensorFlow安装<a class="ae iv" href="https://github.com/tensorflow/swift/blob/master/Installation.md" rel="noopener ugc nofollow" target="_blank">Swift</a></li></ol><h2 id="4e2e" class="mf mg iy bd mh mi mj dn mk ml mm dp mn ku mo mp mq kw mr ms mt ky mu mv mw mx bi translated">Swift Jupyter内核的可选设置</h2><p id="8f6a" class="pw-post-body-paragraph ll lm iy kp b kq my jz ln ks mz kc lo ku na lq lr kw nb lt lu ky nc lw lx la ib bi translated">这花费了我比预期更长的时间，但是如果你想以一种干净和可共享的格式展示你的Swift作品(就像使用Jupyter一样),这是值得的。)</p><p id="8868" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">我找到的最有价值的指南是在Swift-Jupyter repo。有几个选项可供设置，包括conda和Docker选项，但我发现使用Swift for TensorFlow toolchain和virtualenv效果很好(最终)。</p><p id="73bb" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated"><strong class="kp iz">提示</strong>:我花了<em class="lk">这么长时间</em>试图在LLDB Python3支持下设计出Swift工具链。我最终在Ubuntu中使用了curl:</p><pre class="ng nh ni nj gg nk nl nm nn aw no bi"><span id="3932" class="mf mg iy nl b gm np nq l nr ns">$ curl -O <a class="ae iv" href="https://storage.googleapis.com/swift-tensorfl" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/swift-tensorfl</a>ow-artifacts/nightlies/latest/swift-tensorflow-DEVELOPMENT-ubuntu18.04.tar.gz</span></pre><p id="39f2" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">如果你不打算偏离标准，那么一旦你在Ubuntu中有了Swift工具链，你需要做的就是运行这个:</p><pre class="ng nh ni nj gg nk nl nm nn aw no bi"><span id="12fd" class="mf mg iy nl b gm np nq l nr ns">$ git clone https://github.com/google/swift-jupyter.git<br/>cd swift-jupyter<br/>python3 -m venv venv<br/>. venv/bin/activate<br/>pip install -r requirements.txt<br/>python register.py --sys-prefix --swift-toolchain ~/swift-jupyter</span></pre><p id="647c" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">最后，Jupyter笔记本可以使用Swift内核发布。</p><figure class="ng nh ni nj gg ik fu fv paragraph-image"><div class="fu fv nt"><img src="../Images/77cd048d1407f5ea567954874530e411.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*Kg6C8c4GeZrBVmBfzveFvg.png"/></div><p class="ir is fw fu fv it iu bd b be z dk translated">漂亮！</p></figure><h2 id="8f18" class="mf mg iy bd mh mi mj dn mk ml mm dp mn ku mo mp mq kw mr ms mt ky mu mv mw mx bi translated">玩游戏</h2><p id="56a2" class="pw-post-body-paragraph ll lm iy kp b kq my jz ln ks mz kc lo ku na lq lr kw nb lt lu ky nc lw lx la ib bi translated">使用Swift(无论是在上述Jupyter笔记本中，还是在您偏好的其他环境中)，您需要导入提供基础层功能的基础框架:</p><pre class="ng nh ni nj gg nk nl nm nn aw no bi"><span id="9214" class="mf mg iy nl b gm np nq l nr ns">import Foundation</span></pre><p id="de72" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">我们使用一个大的坏代码块来管理2048游戏，并确保它快速工作。这是一个位板实现:</p><figure class="ng nh ni nj gg ik"><div class="bz nu l di"><div class="nv nw l"/></div></figure><p id="bd6f" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">太棒了。现在我们需要代理自动游戏，这意味着一个函数，它接受一个游戏状态，返回移动的方向，然后执行随机移动。它还应该返回棋盘的分数。</p><p id="edc4" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">重要的是，这是我们定义算法做出决定所需要的最大时间量的地方(假设maxTime = 0.015)。</p><p id="e7ef" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">它还创建了一个保存所选方向和相关分数的字典，返回平均分数最高的方向:</p><figure class="ng nh ni nj gg ik"><div class="bz nu l di"><div class="nv nw l"/></div></figure><p id="678d" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">最后，我们有了一个可以工作的2048机器人，哇哦！现在我们需要初始化一个新的游戏实例，运行一个while循环，重复直到游戏结束。在这个循环中，它将决定最好的走法，玩它，并打印新的棋盘状态:</p><figure class="ng nh ni nj gg ik fu fv paragraph-image"><div role="button" tabindex="0" class="il im di in bf io"><div class="fu fv nx"><img src="../Images/1fec5820d792ce779af88a08e947d32a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bfHlW9kNCnFU0Ei1t0yRVw.png"/></div></div><p class="ir is fw fu fv it iu bd b be z dk translated">真快！</p></figure><p id="f9cb" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated">正如你所看到的，人工智能仅用了17秒就走了961步，速度接近每秒56步。这还不包括优化，所以你当然可以运行得更快更好！</p><p id="80a1" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated"><strong class="kp iz">你可以在我的</strong> <a class="ae iv" href="https://github.com/kingnif/legendary-S4TF/blob/master/SWIFT_TB-MCTS.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kp iz"> Github这里</strong> </a> <strong class="kp iz">找到完整的笔记本和所有代码，并查看我之前为<em class="lk">迈向数据科学</em>所做的工作！</strong></p><div class="ih ii gc ge ij ny"><a rel="noopener follow" target="_blank" href="/chaos-in-the-calm-what-is-chaos-engineering-5311c27b2c7e"><div class="nz ab hd"><div class="oa ab ob cl cj oc"><h2 class="bd iz gm z nu od oe of og oh oi ix bi translated">平静中的混沌:什么是混沌工程？</h2><div class="oj l"><h3 class="bd b gm z nu od oe of og oh oi dk translated">是时候主动出击而不是被动应对了</h3></div><div class="ok l"><p class="bd b dl z nu od oe of og oh oi dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq ip ny"/></div></div></a></div><div class="ih ii gc ge ij ny"><a rel="noopener follow" target="_blank" href="/how-i-used-python-code-to-improve-my-korean-2f3ae09a9773"><div class="nz ab hd"><div class="oa ab ob cl cj oc"><h2 class="bd iz gm z nu od oe of og oh oi ix bi translated">我如何使用Python代码来提高我的韩语水平</h2><div class="oj l"><h3 class="bd b gm z nu od oe of og oh oi dk translated">“你好世界！”/ "안녕하세요 세계!"</h3></div><div class="ok l"><p class="bd b dl z nu od oe of og oh oi dk translated">towardsdatascience.com</p></div></div><div class="ol l"><div class="or l on oo op ol oq ip ny"/></div></div></a></div></div><div class="ab cl ly lz hm ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ib ic id ie if"><p id="2fb7" class="pw-post-body-paragraph ll lm iy kp b kq kr jz ln ks kt kc lo ku lp lq lr kw ls lt lu ky lv lw lx la ib bi translated"><em class="lk">这是基于IBM开发人员技能网络在</em><a class="ae iv" href="https://cognitiveclass.ai/courses" rel="noopener ugc nofollow" target="_blank"><em class="lk">cognitive class . AI</em></a><em class="lk">上提供的令人敬畏的“使用Swift进行TensorFlow (S4TF)的人工智能游戏”课程，我强烈建议您查看他们的学习路径。</em></p></div></div>    
</body>
</html>