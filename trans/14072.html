<html>
<head>
<title>Build &amp; Deploy Diabetes Prediction app using Flask, ML and Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask、ML和Heroku构建和部署糖尿病预测应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-deploy-diabetes-prediction-app-using-flask-ml-and-heroku-2de07cbd902d?source=collection_archive---------12-----------------------#2020-09-28">https://towardsdatascience.com/build-deploy-diabetes-prediction-app-using-flask-ml-and-heroku-2de07cbd902d?source=collection_archive---------12-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c465" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从训练模型到在Heroku上部署模型的端到端机器学习项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b01f04becdc2b8ecf84d50185c990fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0HOy-JP8YU5-n_LKXzttA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由CHUTTERSNAP在Unsplash上拍摄</p></figure><h2 id="73e6" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">欢迎我的朋友，</h2><p id="2f56" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi mn translated">根据美国消费者新闻与商业频道的说法，未来十年最时尚的工作是数据科学家和机器学习工程师。现在是我们学习一些机器学习算法，创造一些项目扔出去的最好时机。</p><p id="32f4" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">你经常看到所有那些教程和博客解释不同类型的机器学习算法，但大多数都没有告诉你如何构建一个项目，然后使用这些算法部署它。</p><p id="0d69" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu">不要担心，在这个博客中，我们将创建一个端到端的机器学习项目，然后将它部署在Heroku。</strong></p><h2 id="933d" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们将分四步完成它</h2><ol class=""><li id="bbc0" class="nb nc it lw b lx ly ma mb lh nd ll ne lp nf mm ng nh ni nj bi translated"><strong class="lw iu"> <em class="nk">使用机器学习创建模型</em> </strong></li><li id="a850" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated"><strong class="lw iu"> <em class="nk">使用flask创建web应用程序，并将其与模型</em> </strong>连接</li><li id="799c" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated"><strong class="lw iu"> <em class="nk">将项目提交给Github </em> </strong></li><li id="462b" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated"><strong class="lw iu"> <em class="nk">使用Heroku </em> </strong>部署我们的模型</li></ol></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="e41f" class="nx kz it bd la ny nz oa ld ob oc od lg jz oe ka lk kc of kd lo kf og kg ls oh bi translated">在开始之前，让我们先<br/> <strong class="ak"> <em class="oi">设置我们的环境</em> </strong></h1><ol class=""><li id="a827" class="nb nc it lw b lx ly ma mb lh nd ll ne lp nf mm ng nh ni nj bi translated"><strong class="lw iu"> <em class="nk">下载最新版Python </em> </strong></li></ol><div class="oj ok gp gr ol om"><a href="https://www.python.org/downloads/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">下载Python</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">关于特定端口的信息、开发人员信息来源和二进制可执行文件由发布经理或……</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.python.org</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div><p id="fd0a" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">2.<strong class="lw iu"> <em class="nk">安装所需软件包</em> </strong></p><p id="4e5a" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">所有软件包都可以使用cmd(终端)中的pip进行安装。</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="774c" class="ky kz it pc b gy pg ph l pi pj">pip install pandas,numpy,matplotlib,scikit-learn,seaborn</span></pre><p id="d472" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">3.<strong class="lw iu"> <em class="nk">安装Jupyter笔记本</em> </strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="5d6e" class="ky kz it pc b gy pg ph l pi pj">pip install jupyter-notebook</span><span id="c27a" class="ky kz it pc b gy pk ph l pi pj">jupyter notebook ### for running</span></pre><p id="cb07" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">完成所有三个步骤后，现在让我们开始我们的项目。</p><h1 id="00a5" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated"><strong class="ak"> <em class="oi">在jupyter中打开一个新的笔记本，按照下面的步骤沿着</em> </strong></h1></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="c28f" class="nx kz it bd la ny nz oa ld ob oc od lg jz oe ka lk kc of kd lo kf og kg ls oh bi translated">1.使用机器学习创建模型</h1><h2 id="d530" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">导入必要的库</h2><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="b39c" class="ky kz it pc b gy pg ph l pi pj">#importing Libraries</span><span id="f5d2" class="ky kz it pc b gy pk ph l pi pj">import numpy as np   <br/>np.random.seed(42)   ## so that output would be same<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>import seaborn as sns<br/>%matplotlib inline   ## our plot lies on the same notebook</span><span id="0703" class="ky kz it pc b gy pk ph l pi pj">#models<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.svm import SVC</span><span id="588b" class="ky kz it pc b gy pk ph l pi pj">#Evaluation<br/>from sklearn.model_selection import train_test_split,cross_val_score<br/>from sklearn.model_selection import RandomizedSearchCV,GridSearchCV<br/>from sklearn.metrics import confusion_matrix, classification_report<br/>from sklearn.metrics import precision_score, recall_score, f1_score<br/>from sklearn.metrics import plot_roc_curve</span><span id="39ab" class="ky kz it pc b gy pk ph l pi pj">#for warning<br/>from warnings import filterwarnings<br/>filterwarnings("ignore")  ## To remove any kind of warning</span></pre><h1 id="1b91" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">加载数据集</h1><p id="f947" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">数据集在Kaggle上可用，但我们将使用我的Github链接来加载数据。</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="ba1f" class="ky kz it pc b gy pg ph l pi pj">data = pd.read_csv("<a class="ae pq" href="https://raw.githubusercontent.com/Abhayparashar31/Diabetes-prediction/master/diabetes.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/Abhayparashar31/Diabetes-prediction/master/diabetes.csv</a>")</span></pre><h2 id="ddb4" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak"> <em class="oi">关于数据集</em> </strong></h2><p id="8cca" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">数据集由几个医学预测变量(独立变量)和一个目标变量(因变量)组成，<em class="nk">结果。</em>独立变量包括患者的怀孕次数、身体质量指数、胰岛素水平、年龄、<br/>等。</p><h2 id="9eb8" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated"><strong class="ak">列</strong></h2><p id="a080" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated"><strong class="lw iu">怀孕</strong> : <em class="nk">怀孕次数</em> <br/> <strong class="lw iu">血糖</strong> : <em class="nk">口服葡萄糖耐量试验2小时血糖浓度</em> <br/> <strong class="lw iu">血压</strong> : <em class="nk">舒张压(毫米汞柱)</em> <br/> <strong class="lw iu">皮肤厚度</strong> : <em class="nk">三头肌皮褶厚度(毫米)</em> <br/> <strong class="lw iu">胰岛素</strong> : <em class="nk"> 2小时血清胰岛素(胰岛素 </em>  <br/> <strong class="lw iu">年龄:</strong> <em class="nk">年龄(年)</em> <br/> <strong class="lw iu">结局:</strong> <em class="nk">类变量(0或1)768中的268为1，其余为0 </em></p><h2 id="f700" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">工作</h2><blockquote class="pr ps pt"><p id="6b45" class="lu lv nk lw b lx mw ju lz ma mx jx mc pu my me mf pv mz mh mi pw na mk ml mm im bi translated"><strong class="lw iu"> <em class="it">建立机器学习模型，准确预测数据集中的患者是否患有糖尿病？</em>T48】</strong></p></blockquote><h1 id="73fe" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">数据集上的EDA</h1><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="60c8" class="ky kz it pc b gy pg ph l pi pj">print(data.shape)  ### Return the shape of data <br/>print(data.ndim)   ### Return the n dimensions of data<br/>print(data.size)   ### Return the size of data <br/>print(data.isna().sum())  ### Returns the sum fo all na values<br/>print(data.info())  ### Give concise summary of a DataFrame</span></pre><h2 id="7b7b" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">让我们将一些列可视化并进行比较</h2><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="6c82" class="ky kz it pc b gy pg ph l pi pj">data["Outcome"].value_counts().plot(kind="bar",color=["salmon","deeppink"])<br/>plt.xticks(np.arange(2), ('No Diabetes', 'Diabetes'),rotation=0);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi px"><img src="../Images/f9488572b81c35a4b5c74d5d71f6e82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*M2CXNoAj5_kzp8J0Isiw8Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="a0c5" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk"># Comparing Glucose with the Outcome</em></strong><br/>pd.crosstab(data.Glucose[::15],data.Outcome).plot(kind="bar",figsize=(18,8),color=["yellow","deeppink"])<br/>plt.ylabel("people");<br/>plt.xticks(rotation=0);<br/>plt.legend(['No Diabetes', 'Diabetes']);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/78756c3e62e2175cdb1332f4149416ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f_WZY8s-gtwzL9E5sATiIQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="7d9e" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk">#find out Blood Pressure and age of entries who have diabetes</em></strong><br/>plt.figure(figsize=(10,6))</span><span id="0954" class="ky kz it pc b gy pk ph l pi pj"># Scatter with positive example<br/>plt.scatter(data.Age[data.Outcome==1],data.BloodPressure[data.Outcome==1],c="Red");</span><span id="62df" class="ky kz it pc b gy pk ph l pi pj"># Scatter with negative example<br/>plt.scatter(data.Age[data.Outcome==0],data.BloodPressure[data.Outcome==0],c="lightblue");</span><span id="4587" class="ky kz it pc b gy pk ph l pi pj"># Add some helpful info<br/>plt.title("Diabetes in function of Age and Blood pressure")<br/>plt.xlabel("Age")<br/>plt.ylabel("Blood Pressure")<br/>plt.legend(["Diabetes","No Diabetes"]);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/8764fabbbcc7d9f2df1c0ade75da8719.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-XggeopiPS2n7_iybA0jg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="7be6" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk">## Pairplotting of dataframe</em></strong><br/>import seaborn as sns<br/>sns.set(style="ticks", color_codes=True)<br/>sns.pairplot(data,hue='Outcome',palette='gnuplot');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/b1b4406211050013f1fcc0dd33d73976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rxZXy6ZNgG73IxUkIu0Vg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="509f" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk"># Histogram of all coloumns when the Outcome is 1( has Diabetes)</em></strong></span><span id="046d" class="ky kz it pc b gy pk ph l pi pj">fig, ax = plt.subplots(nrows=4, ncols=2, figsize=(12, 10))<br/>fig.tight_layout(pad=3.0)<br/>ax[0,0].set_title('Glucose')<br/>ax[0,0].hist(data.Glucose[data.Outcome==1]);<br/>ax[0,1].set_title('Pregnancies')<br/>ax[0,1].hist(data.Pregnancies[data.Outcome==1]);<br/>ax[1,0].set_title('Age')<br/>ax[1,0].hist(data.Age[data.Outcome==1]);<br/>ax[1,1].set_title('Blood Pressure')<br/>ax[1,1].hist(data.BloodPressure[data.Outcome==1]);<br/>ax[2,0].set_title('Skin Thickness')<br/>ax[2,0].hist(data.SkinThickness[data.Outcome==1]);<br/>ax[2,1].set_title('Insulin')<br/>ax[2,1].hist(data.Insulin[data.Outcome==1]);<br/>ax[3,0].set_title('BMI')<br/>ax[3,0].hist(data.BMI[data.Outcome==1]);<br/>ax[3,1].set_title('Diabetes Pedigree Function')<br/>ax[3,1].hist(data.DiabetesPedigreeFunction[data.Outcome==1]);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/e04c04027d1175abddee4a617cc2a9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mvDJhsQabaaWYUgmGjeFNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="9753" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk"># correlation matrix between columns</em></strong><br/><strong class="pc iu"><em class="nk">## It shows the correlation(positive,neagative) between different columns(only integer value columns) </em></strong></span><span id="a821" class="ky kz it pc b gy pk ph l pi pj">corr_matrix = data.corr()<br/>fig,ax = plt.subplots(figsize=(15,10))ax = sns.heatmap(corr_matrix,annot=True,linewidth=0.5,fmt=".2f",cmap="YlGnBu")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/dd7191f29bbcb7a31b9afc1679ffda89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaMwpv1H9WPxlTpBF8OPdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><h1 id="0201" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">建模和培训</h1><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="304a" class="ky kz it pc b gy pg ph l pi pj">#random data shuffelin</span><span id="b4d2" class="ky kz it pc b gy pk ph l pi pj">data.sample(frac=1)</span><span id="537e" class="ky kz it pc b gy pk ph l pi pj">#Spliting the data<br/>X = data.drop("Outcome",axis=1)<br/>y = data["Outcome"]<br/>X_train,X_test,y_train,y_test =  train_test_split(X,y,test_size=0.2)</span></pre><p id="793c" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">我们将在4个算法<br/> <strong class="lw iu"> <em class="nk"> 1上<strong class="lw iu">训练</strong>我们的模型。逻辑回归<br/> 2。KNN <br/> 3。随机森林分类器<br/> 4。支持向量机</em> </strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="10ff" class="ky kz it pc b gy pg ph l pi pj"><strong class="pc iu"><em class="nk">## Build an model (Logistic Regression)</em></strong><br/>from sklearn.linear_model import LogisticRegression<br/>log_reg = LogisticRegression(random_state=0)<br/>log_reg.fit(X_train,y_train);<br/>## Evaluating the model<br/>log_reg = log_reg.score(X_test,y_test)</span><span id="40f3" class="ky kz it pc b gy pk ph l pi pj"><strong class="pc iu"><em class="nk">## Build an model (KNN)<br/></em></strong>knn = KNeighborsClassifier()<br/>knn.fit(X_train,y_train);<br/>## Evaluating the model<br/>knn = knn.score(X_test,y_test)</span><span id="72d7" class="ky kz it pc b gy pk ph l pi pj"><strong class="pc iu"><em class="nk">## Build an model (Random forest classifier)<br/></em></strong>clf= RandomForestClassifier()<br/>clf.fit(X_train,y_train);<br/>## Evaluating the model<br/>clf = clf.score(X_test,y_test)</span><span id="58df" class="ky kz it pc b gy pk ph l pi pj"><strong class="pc iu"><em class="nk">## Build an model (Support Vector Machine)<br/></em></strong>svm = SVC()<br/>svm.fit(X_train,y_train)<br/>## Evaluating the model<br/>svm = svm.score(X_test,y_test)</span></pre><p id="ecfc" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">让我们想象一下所有模型的训练表现</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="dba5" class="ky kz it pc b gy pg ph l pi pj">model_compare = pd.DataFrame({"Logistic Regression":log_reg,<br/>"KNN":knn,<br/>"Random Forest Classifier":clf,<br/>"Support Vector Machine":svm,},<br/>index=["accuracy"])</span><span id="4832" class="ky kz it pc b gy pk ph l pi pj">model_compare.T.plot.bar(figsize=(15,10));</span><span id="923a" class="ky kz it pc b gy pk ph l pi pj">##############OUTPUT###############<br/><br/>         Logistic Regression    KNN     Random ForestClassifier  SVM<br/>accuracy      0.818182        0.772727       0.798701       0.818182</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qd"><img src="../Images/55caeb10f47030132f6b816977257172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7wr3hLQcIFJI-2CyPHn6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><blockquote class="pr ps pt"><p id="5559" class="lu lv nk lw b lx mw ju lz ma mx jx mc pu my me mf pv mz mh mi pw na mk ml mm im bi translated">在这里，我们可以看到SVM和逻辑回归都表现得非常好，准确率为81%。我们可以使用超参数调整来进一步提高精度。</p></blockquote><h1 id="feb2" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">使用超参数调谐提高精度</h1><p id="bf15" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">我们将使用网格搜索cv和随机搜索cv进行超参数旋转。</p><p id="8649" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">在逻辑回归中，我们很容易超调的参数是<code class="fe qe qf qg pc b">C</code>和<code class="fe qe qf qg pc b">solver</code>。</p><h2 id="8e1f" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">使用随机搜索进行超参数调整</h2><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="d0cb" class="ky kz it pc b gy pg ph l pi pj"># Create a hyperparameter grid for LogisticRegression<br/>log_reg_grid = {"C": np.logspace(-4, 4, 20),"solver": ["liblinear"]}</span><span id="385d" class="ky kz it pc b gy pk ph l pi pj"># Tune LogisticRegression<br/>np.random.seed(42)<br/># Setup random hyperparameter search for LogisticRegression<br/>rs_log_reg = RandomizedSearchCV(LogisticRegression(),<br/>                                  param_distributions=log_reg_grid,<br/>                                  cv=5,<br/>                                  n_iter=20,<br/>                                  verbose=True)<br/># Fit random hyperparameter search model for LogisticRegression<br/>rs_log_reg.fit(X_train, y_train)<br/>score = rs_log_reg.score(X_test,y_test)<br/>print(score*100)</span><span id="0791" class="ky kz it pc b gy pk ph l pi pj">##########OUTPUT###########<br/>83.11688311688312</span></pre><blockquote class="pr ps pt"><p id="6c7d" class="lu lv nk lw b lx mw ju lz ma mx jx mc pu my me mf pv mz mh mi pw na mk ml mm im bi translated"><strong class="lw iu">太好了，</strong>使用随机搜索cv，我们将准确率提高了<strong class="lw iu"> 2%。</strong></p></blockquote><h2 id="5c8b" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">使用GridSearchcv进行超参数调整</h2><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="b685" class="ky kz it pc b gy pg ph l pi pj">log_reg_grid = {'C': np.logspace(-4,4,30),</span><span id="0867" class="ky kz it pc b gy pk ph l pi pj">"solver":["liblinear"]}<br/>#setup  the gird cv<br/>gs_log_reg = GridSearchCV(LogisticRegression(),<br/>                          param_grid=log_reg_grid,<br/>                          cv=5,<br/>                           verbose=True)<br/>#fit grid search cv<br/>gs_log_reg.fit(X_train,y_train)<br/>score = gs_log_reg.score(X_test,y_test)<br/>print(score*100)</span><span id="66f3" class="ky kz it pc b gy pk ph l pi pj">########OUTPUT#########<br/>83.76623376623377</span></pre><blockquote class="pr ps pt"><p id="4afd" class="lu lv nk lw b lx mw ju lz ma mx jx mc pu my me mf pv mz mh mi pw na mk ml mm im bi translated"><strong class="lw iu">太好了，</strong>使用网格搜索CV，我们将准确率提高了2.5%。</p></blockquote><blockquote class="qh"><p id="aa2f" class="qi qj it bd qk ql qm qn qo qp qq mm dk translated">最佳模型是逻辑回归，准确率为83%</p></blockquote><h1 id="09bd" class="nx kz it bd la ny pl oa ld ob pm od lg jz qr ka lk kc qs kd lo kf qt kg ls oh bi translated">评估模型</h1><p id="f109" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">先来预测一下<strong class="lw iu"> X_test </strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="1844" class="ky kz it pc b gy pg ph l pi pj">y_preds = gs_log_reg.predict(X_test)<br/>y_preds</span><span id="5e86" class="ky kz it pc b gy pk ph l pi pj">######OUTPUT#########<br/>array([0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0,0,0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0,0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0,0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1,0, 0],dtype=int64)</span></pre><p id="8fb2" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu"> <em class="nk">让我们看看混淆矩阵、准确率评分、分类报告、roc曲线。</em>T72】</strong></p><p id="1969" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu">混淆矩阵</strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="b34e" class="ky kz it pc b gy pg ph l pi pj">sns.set(font_scale=2)<br/>import seaborn as sns<br/>sns.heatmap(confusion_matrix(y_test,y_preds), annot=True,cbar=False, fmt='g')<br/>plt.xlabel("True label")<br/>plt.ylabel("Predicted label");</span></pre><p id="f7b0" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu">准确度分数</strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="c553" class="ky kz it pc b gy pg ph l pi pj">print(accuracy_score(y_test,y_pred))</span><span id="729b" class="ky kz it pc b gy pk ph l pi pj">#######OUTPUT########<br/>0.8376</span></pre><p id="737f" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu">分类报告</strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="1ff4" class="ky kz it pc b gy pg ph l pi pj">print(classification_report(y_test, y_preds))</span></pre><p id="3052" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu"> ROC曲线</strong></p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="5ba2" class="ky kz it pc b gy pg ph l pi pj">plot_roc_curve(gs_log_reg,X_test,y_test)</span></pre><h1 id="99a4" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">保存并加载模型</h1><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="77d7" class="ky kz it pc b gy pg ph l pi pj">import pickle<br/># Save trained model to file<br/>pickle.dump(gs_log_reg, open("Diabetes.pkl", "wb"))</span><span id="af5d" class="ky kz it pc b gy pk ph l pi pj">loaded_model = pickle.load(open("Diabetes.pkl", "rb"))<br/>loaded_model.predict(X_test)<br/>loaded_model.score(X_test,y_test)</span><span id="ef67" class="ky kz it pc b gy pk ph l pi pj">#######OUTPUT########<br/>0.8376623376623377</span></pre><h1 id="c812" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">2.使用flask创建web应用程序并将其与模型连接</h1><p id="4c3c" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">因此，要创建一个web应用程序，让我们准备一个文件夹结构</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="17bf" class="ky kz it pc b gy pg ph l pi pj">diabetes(root)<br/>    |____templates<br/>            |___index.html<br/>    |____static<br/>            |____css<br/>            |_____js<br/>    |____app.py<br/>    |_____Diabetes.pkl</span></pre><p id="31ad" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu"> <em class="nk">从我的Github下载模板和静态目录</em> </strong></p><div class="oj ok gp gr ol om"><a href="https://github.com/Abhayparashar31/Diabetes-prediction" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">abhayparashar 31/糖尿病预测</h2><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="qu l ox oy oz ov pa ks om"/></div></div></a></div><p id="2ada" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">让我们创建<strong class="lw iu"> <em class="nk"> app.py </em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="qv qw l"/></div></figure><p id="b071" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">现在让我们在本地主机上运行代码</p><p id="a38b" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">打开CMD并转到根(糖尿病)文件夹，然后使用<code class="fe qe qf qg pc b">python app.py</code>运行app.py，然后您会看到如下消息👇</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qx"><img src="../Images/902bc9785638bfd91150ae2048264ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4jvkehJjGpjgwpTDocYiA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><p id="1589" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">只需在任何浏览器中打开网址，使用一些随机输入来测试应用程序。</p><h1 id="824d" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">3.将项目提交给Github</h1><p id="eb5a" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">在将项目提交给Github之前，我们还要创建两个文件。</p><p id="b13d" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu"> 1。Profile: </strong> Heroku应用程序包含一个Procfile，它指定了应用程序在启动时执行的命令。</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="18cc" class="ky kz it pc b gy pg ph l pi pj">web: gunicorn app:app</span></pre><p id="9f6a" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated"><strong class="lw iu"> 2。requires . txt:</strong>要求。txt文件用于指定运行项目所需的python包。</p><pre class="kj kk kl km gt pb pc pd pe aw pf bi"><span id="0787" class="ky kz it pc b gy pg ph l pi pj">Flask==1.1.1<br/>gunicorn==19.9.0<br/>itsdangerous==1.1.0<br/>Jinja2==2.10.1<br/>MarkupSafe==1.1.1<br/>Werkzeug==0.15.5<br/>numpy&gt;=1.9.2<br/>scipy&gt;=0.15.1<br/>scikit-learn&gt;=0.18<br/>matplotlib&gt;=1.4.3<br/>pandas&gt;=0.19</span></pre><p id="35f0" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">现在之后，去你的Github账户上传文件，然后提交给分支机构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qy"><img src="../Images/f889d155abe72848f300d052460051f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxDt7VZF2GQyn_Chkx0S3w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><h1 id="9a4b" class="nx kz it bd la ny pl oa ld ob pm od lg jz pn ka lk kc po kd lo kf pp kg ls oh bi translated">4.使用Heroku部署模型</h1><p id="1511" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">访问<a class="ae pq" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>并创建一个免费帐户，然后登录您的帐户。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qy"><img src="../Images/a40a48c1d7a4dec3ef7b24ada6b1865d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvtPhqT_6fC23iepljaHCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi qz"><img src="../Images/096a34c0750458fd40328bceebe326ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*asOoSgWYejgn669DhTECcg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“作者提供的图像”</p></figure><p id="94bf" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">你可以在我的Github简介<a class="ae pq" href="https://github.com/Abhayparashar31/Diabetes-prediction" rel="noopener ugc nofollow" target="_blank"> Abhayparashar31 </a>中找到所有的源代码</p><p id="6169" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">谢谢你的阅读😄</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="8abf" class="pw-post-body-paragraph lu lv it lw b lx mw ju lz ma mx jx mc lh my me mf ll mz mh mi lp na mk ml mm im bi translated">感谢你读到这里，如果你喜欢我的内容并想支持我，最好的方式是—</p><ol class=""><li id="df16" class="nb nc it lw b lx mw ma mx lh ra ll rb lp rc mm ng nh ni nj bi translated">跟我上<a class="ae pq" href="http://abhayparashar31.medium.com/" rel="noopener"> <strong class="lw iu"> <em class="nk">中</em> </strong> </a>。</li><li id="e923" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated">在<a class="ae pq" href="https://www.linkedin.com/in/abhay-parashar-328488185/" rel="noopener ugc nofollow" target="_blank"><strong class="lw iu"><em class="nk">LinkedIn</em></strong></a>上联系我。</li><li id="7ab8" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated">使用<a class="ae pq" href="https://abhayparashar31.medium.com/membership" rel="noopener"> <strong class="lw iu"> <em class="nk">我的推荐链接</em> </strong> </a>用一个披萨的费用成为中等会员。你会费的一小部分会归我。</li><li id="6f01" class="nb nc it lw b lx nl ma nm lh nn ll no lp np mm ng nh ni nj bi translated">订阅<a class="ae pq" href="https://abhayparashar31.medium.com/subscribe" rel="noopener"> <strong class="lw iu"> <em class="nk">我的邮件列表</em> </strong> </a>从不会错过我的一篇文章。</li></ol></div></div>    
</body>
</html>