<html>
<head>
<title>Meet the hardest functions of Pandas, Part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">认识熊猫最难的功能，第三部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6?source=collection_archive---------9-----------------------#2020-10-13">https://towardsdatascience.com/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6?source=collection_archive---------9-----------------------#2020-10-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7b17" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">用熊猫重塑桌子</h2><div class=""/><div class=""><h2 id="9e64" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">形状像果冻的桌子有熊猫旋转()和融化()</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/5f87a86d32431fc9fd65504dc067a747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPMXflXtGuSmW2HxcgOrtw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@visualsbyroyalz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Anastase Maragos </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h2 id="d30b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">介绍</h2><p id="539d" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi mw translated">我并不羞于承认。<code class="fe nf ng nh ni b">melt()</code>和<code class="fe nf ng nh ni b">pivot()</code>对我来说是<code class="fe nf ng nh ni b">pandas</code>中最难学的。我花了3-4个多月才想明白。当我第一次看到它们时，我试了又试，但不明白它们是如何或何时被使用的。所以，我放弃了，继续前进，再次遇见他们。尝试过，失败过，继续前进，再相遇。重复了很多次。</p><p id="d687" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">令我感到困惑的是，在这个有数百万视频和博客教程的时代，我找不到一个简单的好的来源可以更好地解释这些功能。我最喜欢的<code class="fe nf ng nh ni b">pandas</code>博客，实用商业Python，它涵盖了<code class="fe nf ng nh ni b">pandas</code>的许多硬功能，好心地把它们省略了<em class="no">😔😔</em>。而且，他们的文档只有在你完全了解这些功能后才有意义，一些网站(如果你搜索这些功能，它们的排名总是很高)只是复制文档😶😶。</p><p id="b8b9" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">所以，就像我最近一直在写的<code class="fe nf ng nh ni b">pandas</code>的硬功能一样(它们表现得真的很好)，现在是<code class="fe nf ng nh ni b">melt()</code>和<code class="fe nf ng nh ni b">pivot()</code>的时候了。我希望这篇文章对面临类似困难的人有用。</p><div class="np nq gp gr nr ns"><a href="https://ibexorigin.medium.com/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">通过我的推荐链接加入Medium-BEXGBoost</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">获得独家访问我的所有⚡premium⚡内容和所有媒体没有限制。支持我的工作，给我买一个…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">ibexorigin.medium.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lb ns"/></div></div></a></div><p id="15b4" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">获得由强大的AI-Alpha信号选择和总结的最佳和最新的ML和AI论文:</p><div class="np nq gp gr nr ns"><a href="https://alphasignal.ai/?referrer=Bex" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">阿尔法信号|机器学习的极品。艾总结的。</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">留在循环中，不用花无数时间浏览下一个突破；我们的算法识别…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">alphasignal.ai</p></div></div><div class="ob l"><div class="oh l od oe of ob og lb ns"/></div></div></a></div></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="5c9a" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">可点击的目录(仅限网络)</h2><p id="e028" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">∘ <a class="ae lh" href="#d30b" rel="noopener ugc nofollow">简介</a> <br/> ∘ <a class="ae lh" href="#203e" rel="noopener ugc nofollow">设置</a> <br/> ∘ <a class="ae lh" href="#668c" rel="noopener ugc nofollow">熊猫融()</a> <br/> ∘ <a class="ae lh" href="#675b" rel="noopener ugc nofollow">熊猫融()</a> <br/> ∘ <a class="ae lh" href="#0726" rel="noopener ugc nofollow">熊猫枢()</a></p><blockquote class="op oq or"><p id="dd25" class="md me no mf b mg nj kd mi mj nk kg ml os nl mn mo ot nm mq mr ou nn mt mu mv im bi translated">你可以从<a class="ae lh" href="https://github.com/BexTuychiev/medium_stories/tree/master/hardest_of_pandas3" rel="noopener ugc nofollow" target="_blank">这个</a> GitHub repo下载笔记本和样本数据。在每个函数第一次出现时，我还用超链接链接了它们的文档。</p></blockquote></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="203e" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">设置</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="668c" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">熊猫融化()</h2><p id="6f7d" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">让我们从一个非常愚蠢的例子开始。我将创建一个1x1的数据帧，保存一个城市名称和一天的温度。然后，我会在它上面调用<code class="fe nf ng nh ni b"><a class="ae lh" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html" rel="noopener ugc nofollow" target="_blank">melt()</a></code>，看看它有什么效果:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/626d4f28d9184eca70952414c8fee617.png" data-original-src="https://miro.medium.com/v2/format:webp/1*yabTQY9gzfYCeSZr4d_zLA.png"/></div></figure><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="5c05" class="li lj it ni b gy pc pd l pe pf">&gt;&gt;&gt; df.melt()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/6c118f368f862f2f497ad24b18115bc8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*rfzcG-NGzfjl4BbsH2VlnQ.png"/></div></figure><p id="66c1" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">因此，在没有任何参数的情况下，<code class="fe nf ng nh ni b">melt()</code>获取一列，并将其转换为包含两个新列的行(不包括索引)。让我们再添加两个城市作为列:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/46dfd73401e4eb9f383379f0beb02f06.png" data-original-src="https://miro.medium.com/v2/format:webp/1*l_uZrCtOcs2bDTlFJaJ9vQ.png"/></div></figure><p id="0a92" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">如果你注意到，这种数据帧格式不容易使用，而且不干净。最理想的是将列转化为行，它们的温度值在右边:</p><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="32aa" class="li lj it ni b gy pc pd l pe pf">df.melt()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/5e1ba76f187793e0b38d3607881d0fde.png" data-original-src="https://miro.medium.com/v2/format:webp/1*JTsefjlDRB-UlOEkhO-prA.png"/></div></figure><p id="9c54" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">让我们为城市添加更多的温度:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/3a5aa6b506182b8bf33abaad43f86eb4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*n8EbPsx8uM3Il0JCbIk0vA.png"/></div></figure><p id="4b53" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">如果我们在这个版本的数据帧上调用<code class="fe nf ng nh ni b">melt()</code>，你认为会发生什么？手表:</p><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="c271" class="li lj it ni b gy pc pd l pe pf">df_larger.melt()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/02c11c7f8df917324157960205faa15c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oQXGr7cfjgYxqNel7hp_SA.png"/></div></figure><p id="a2db" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">正如预期的那样，它将每个列值转换成一行。例如，让我们以一个键值对为例。纽约的气温是[25，27，23，25，29]。这意味着有5个键值对，当我们使用<code class="fe nf ng nh ni b">melt()</code>，<code class="fe nf ng nh ni b">pandas</code>获取每一个键值对，并将它们显示为一行两列。在<code class="fe nf ng nh ni b">pandas</code>与<code class="fe nf ng nh ni b">New York</code>完成之后，它移动到其他列。</p><p id="0c79" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">当<code class="fe nf ng nh ni b">melt()</code>在两列中显示每个键-值对时，它为这两列提供默认名称<code class="fe nf ng nh ni b">variable</code>和<code class="fe nf ng nh ni b">value</code>。可以将它们更改为更有意义的内容:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/a055633e613c245c32518efdcd1ef15e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*afVzUcxXgBWFIsC9NcN10g.png"/></div></figure><p id="04f9" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated"><code class="fe nf ng nh ni b">var_name</code>和<code class="fe nf ng nh ni b">value_name</code>可用于改变熔化数据框的列的标签。</p><p id="8c40" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">如果我们继续添加列，<code class="fe nf ng nh ni b">melt()</code>将总是把每个值转换成一个包含两列的行，这两列包含前一列的名称和它的值。</p><p id="8b4d" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">现在，让我们严肃一点。假设我们有这个数据框架:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/a8b535e5b3b41be8b8143d7fc3df66de.png" data-original-src="https://miro.medium.com/v2/format:webp/1*mz1Xvbo5aauX9MJj4ja-wg.png"/></div></figure><p id="7da8" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">这一次，我们已经把城市列成了一列。但是，这种类型的表格格式仍然没有用。该数据集包含5个城市5天的温度信息。我们甚至不能对这种类型的数据进行简单的计算，比如平均。让我们尝试熔化数据帧:</p><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="944c" class="li lj it ni b gy pc pd l pe pf">&gt;&gt;&gt; temperatures.melt()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/45adcc0a277c2040647eeb81bd01f502.png" data-original-src="https://miro.medium.com/v2/format:webp/1*EXAw53LfgMLZrJv7iEnvjQ.png"/></div></figure><p id="93de" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">这不是我们想要的，<code class="fe nf ng nh ni b">melt()</code>把城市名也变成了行。理想的情况是，我们将城市保留为列，并将剩余的列追加为行。<code class="fe nf ng nh ni b">melt()</code>有一个名为<code class="fe nf ng nh ni b">id_vars</code>的参数可以做到这一点。</p><p id="eac8" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">如果我们只想把一些列变成行，那么把要保留的列作为一个列表(即使是单个值)传递给<code class="fe nf ng nh ni b">id_vars</code>。<code class="fe nf ng nh ni b">id_vars</code>代表身份变量。</p><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="eb36" class="li lj it ni b gy pc pd l pe pf">temperatures.melt(id_vars=['city'])</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/7b240818daef3839b39722152f41a7f7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*WRnEZ1-Xkhv-deSbRrBhvA.png"/></div></figure><p id="4362" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">使用<code class="fe nf ng nh ni b">id_vars</code>后，<code class="fe nf ng nh ni b">city</code>列作为列留了下来。但是它变长了。原因是每个城市都有5天的观测时间。当我们从列中获取这些观察值并将其显示为行时，<code class="fe nf ng nh ni b">pandas</code>会自动添加新的行来适应新的值。</p><p id="abb9" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">即使我们有了更好的表，列名也不是我们想要的。我们可以直接用<code class="fe nf ng nh ni b">melt()</code>来做，而不是在融化表格后手动更改它们:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/66676971461b0a60ef5e11d0daec4240.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ep0r2VNhzrMyqQQreomI3g.png"/></div></figure><p id="05ae" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">具有不同列标签的相同数据帧。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="675b" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">熊猫在真实世界的数据上融化()</h2><p id="e247" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">现在，是时候我们在真实世界的数据集上工作来证明这一点了。我将加载纽约股票数据集，可以使用这个<a class="ae lh" href="https://www.kaggle.com/dgawlik/nyse/download" rel="noopener ugc nofollow" target="_blank">链接</a>从Kaggle下载。它包含超过501家公司2016年的股票信息:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/6aaed2cc4272ec2edfd354c6767c729e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*vPzix-rC7UrK9rOYsN59Zw.png"/></div></figure><p id="2df3" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">我将只对一个月进行子集划分，因为每天都有观察:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/2f580dec12a8a058fa4950be14b6fc12.png" data-original-src="https://miro.medium.com/v2/format:webp/1*aOzLgq0g8gA7zy4JxHA_Ag.png"/></div></figure><p id="e482" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">现在，为了向您展示如何在真实世界的数据上使用<code class="fe nf ng nh ni b">melt()</code>，我将使用<code class="fe nf ng nh ni b">pivot()</code>执行一个操作，我将在本文后面教您。</p><p id="3981" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">数据现在是这样的格式:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/bc3b6f06308c5cc418839dc3e05521f9.png" data-original-src="https://miro.medium.com/v2/format:webp/1*awXl0qe1pGcPeP9ULuhMEA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">500行，22列</p></figure><p id="1f56" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">它为所有公司提供了500行，为2月份的22天提供了22列。每个单元格包含股票在某一天的收盘价。我为什么选择这种格式？因为现实世界的数据经常是这种形状。</p><p id="5018" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">例如，当记录这个数据集时，假设他们想为新的一天添加一个新值。有500家公司，如果您不将新的一天作为新列添加，您将不得不再次写出500家公司，向数据集中再添加500行。对于记录这些数据的人来说，添加新的观察值作为新的列非常方便。</p><p id="592b" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">因此，现在我们想使用<code class="fe nf ng nh ni b">melt()</code>将这个<code class="fe nf ng nh ni b">stocks_small</code>数据集转换回它的原始格式，以便更容易处理。如果您再次查看数据，我们希望将所有日期列转换成两列，其中包含(日期，收盘价)键-值对，保留<code class="fe nf ng nh ni b">symbol</code>列。就像我们在前面的例子中所做的一样，如果我们将<code class="fe nf ng nh ni b">symbol</code>传递给<code class="fe nf ng nh ni b">id_vars</code>，它保持为一列，其他日期将变成行:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/55d498a8c6377a3395c5bae880bf6b4e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*RVUeN6y0NdhDdnsWvVEH4Q.png"/></div></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="7d6f" class="li lj it ni b gy pc pd l pe pf">Number of rows in melted table: 10500</span></pre><p id="e902" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">将其与原始数据进行比较:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="7f9f" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">简而言之，<code class="fe nf ng nh ni b">melt()</code>采用宽数据帧，并使其变长变细。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="0726" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">熊猫枢轴()</h2><p id="d083" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated"><code class="fe nf ng nh ni b"><a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html" rel="noopener ugc nofollow" target="_blank">pivot()</a></code>与<code class="fe nf ng nh ni b">melt()</code>完全相反。有时，您会希望将干净的长格式数据转换为宽格式数据。让我们看看我是如何将子集<code class="fe nf ng nh ni b">stocks</code>转换成更宽的格式的。这里有数据提醒你:</p><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="b667" class="li lj it ni b gy pc pd l pe pf">stocks_small.head()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/eecde00f3b64e3d6ef00681a10c1c815.png" data-original-src="https://miro.medium.com/v2/format:webp/1*jA5eUmu5Uk--QtNn-okINQ.png"/></div></figure><p id="9610" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">现在，我将旋转表格:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/0ff462fac626678c16f710ba579e107d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*NXvGY5objpXy_9nPu5DaFw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">500行，42列</p></figure><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="0ae4" class="li lj it ni b gy pc pd l pe pf">&gt;&gt;&gt; <!-- -->pivoted.shape<br/>(500, 42)</span></pre><p id="658a" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">当您使用<code class="fe nf ng nh ni b">pivot()</code>时，请记住以下几点:</p><ol class=""><li id="33d7" class="pg ph it mf b mg nj mj nk lr pi lv pj lz pk mv pl pm pn po bi translated"><code class="fe nf ng nh ni b">pandas</code>将接受您为<code class="fe nf ng nh ni b">index</code>参数传递的变量，并将其唯一值显示为索引。</li><li id="4231" class="pg ph it mf b mg pp mj pq lr pr lv ps lz pt mv pl pm pn po bi translated"><code class="fe nf ng nh ni b">pandas</code>将接受您为<code class="fe nf ng nh ni b">columns</code>传递的变量，并将其唯一值显示为单独的列。</li></ol><p id="dff1" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">如果你注意到了，上面的数据帧不是我们在<code class="fe nf ng nh ni b">melt()</code>中使用的那个。那是因为它还包含了不仅仅是收盘价的股票价格。在<code class="fe nf ng nh ni b">pivot()</code>中，有一个名为<code class="fe nf ng nh ni b">values</code>的参数，如果没有指定，它会告诉<code class="fe nf ng nh ni b">pandas</code>将所有剩余的列包含到旋转数据帧中。这次我们只选择<code class="fe nf ng nh ni b">close</code>价格:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl ox"><img src="../Images/0c1b76148d4d91b03b0a19452c1d540b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*vCKm2xcrkQPRGzc3vQwIaA.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">500行，21列</p></figure><pre class="ks kt ku kv gt oy ni oz pa aw pb bi"><span id="8781" class="li lj it ni b gy pc pd l pe pf">&gt;&gt;&gt; pivoted2.shape<br/>(500, 21)</span></pre><p id="b738" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated"><code class="fe nf ng nh ni b">pivot()</code>差不多就是这样。令人惊讶的是，它是<code class="fe nf ng nh ni b">pandas</code>中最难的函数之一，然而它只有3个参数，甚至没有一个额外的参数来填充缺失的值。</p><p id="bebc" class="pw-post-body-paragraph md me it mf b mg nj kd mi mj nk kg ml lr nl mn mo lv nm mq mr lz nn mt mu mv im bi translated">对于<code class="fe nf ng nh ni b">pivot()</code>，只需记住它接受两个分类变量，并将它们的唯一值显示为索引和列。这个结果表将是这两个变量的网格。如果没有指定<code class="fe nf ng nh ni b">values</code>参数，所有剩余的列将作为单元格值给出，这将使表格更宽。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h1 id="259e" class="pu lj it bd lk pv pw px ln py pz qa lq ki qb kj lu kl qc km ly ko qd kp mc qe bi translated">如果你喜欢这篇文章，请分享并留下反馈。作为一名作家，你的支持对我来说意味着一切！</h1><p id="a1c8" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">阅读更多与主题相关的文章:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">认识熊猫最难的功能，第一部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">掌握pivot_table()、stack()、unstack()的时机和方式</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qf l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">认识熊猫最难的功能，第二部分</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">掌握交叉表的时间和方式()</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qg l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/ever-wanted-progress-bars-in-jupyter-bdb3988d9cfc"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">想要Jupyter的进度条吗？</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">对你的长时间循环进行健全性检查(和一点视觉风格)</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qh l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">来自Kagglers:DS和ML的最佳项目设置</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">来自顶级Kagglers的项目成功最佳实践的集合</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qi l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/how-i-customarily-bin-data-with-pandas-9303c9e4d946"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">我习惯如何将数据与熊猫绑定</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">您可能只使用了默认值</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qj l od oe of ob og lb ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/masteriadsf-246b4c16daaf"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jd gy z fp nx fr fs ny fu fw jc bi translated">掌握连接:Pandas合并、连接、追加方法</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">从半连接/反连接到验证数据合并</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="qk l od oe of ob og lb ns"/></div></div></a></div></div></div>    
</body>
</html>