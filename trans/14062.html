<html>
<head>
<title>Yolo v5 Object Detection Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Yolo v5物体检测教程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/yolo-v5-object-detection-tutorial-2e607b9013ef?source=collection_archive---------2-----------------------#2020-09-28">https://towardsdatascience.com/yolo-v5-object-detection-tutorial-2e607b9013ef?source=collection_archive---------2-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cfdb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何建立和训练一个Yolo v5物体检测模型？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/75fbc9808a31a95052bc0e439ca84a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idFzREuCIvlnizQWkwC-2g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Yolo v5物体检测教程。斯蒂芬·科斯马在<a class="ae ky" href="https://unsplash.com/s/photos/artificial-intelligence?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3bbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">物体检测是人工智能中的一项任务，重点是检测图像中的物体。Yolo V5是目前最好的物体检测模型之一。这种深度神经网络的伟大之处在于，它非常容易在您自己的定制数据集上重新训练网络。</p><p id="a600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将介绍如何训练Yolo V5对象检测模型。我将把重点放在如何快速轻松地开始上，而不是调优模型的超参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/57d5ee2cb08676e6bc46944c9af2969f.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*tDd09Mjjho35GQk1ycuN-g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用预训练的Yolo V5模型的对象检测示例。<a class="ae ky" href="https://commons.wikimedia.org/wiki/File:Astronaut_candidate_Jeremy_Hansen_speaks_to_a_crowd_at_Johnson_Space_Center.jpg." rel="noopener ugc nofollow" target="_blank">原文来源</a>。<a class="ae ky" href="https://en.wikipedia.org/wiki/en:Creative_Commons" rel="noopener ugc nofollow" target="_blank">知识共享</a> <a class="ae ky" href="https://creativecommons.org/licenses/by-sa/4.0/deed.en" rel="noopener ugc nofollow" target="_blank">归属-共享4.0国际</a>。</p></figure><p id="92ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://jooskorstanje.com/yolov5-training-a-custom-object-detection-model.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">你可以跟着满满的笔记本过来。</strong>T13】</a></p><h1 id="ce40" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">如何训练一个定制的Yolo V5车型？</h1><p id="9ea2" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要训练自定义Yolo V5模型，请遵循以下步骤:</p><ol class=""><li id="f006" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">设置您的环境</li><li id="b279" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">设置数据和目录</li><li id="efab" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">设置配置YAML文件</li><li id="a50e" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">训练模型以学习如何检测物体</li><li id="5fbd" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">使用您的定制Yolo V5模型来检测测试数据上的对象</li></ol><h1 id="f12c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">1.如何设置您的环境来训练Yolo V5对象检测模型？</h1><p id="37e7" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要训练一个Yolo V5模型，需要从网上下载一些东西。</p><p id="9f70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在笔记本电脑中，最简单的方法是直接从笔记本电脑中使用终端命令下载并设置您的环境，如下所示:</p><ul class=""><li id="c2b1" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu nh mz na nb bi translated">从GitHub克隆yolo V5存储库</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="6383" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将在您的机器上创建一个名为'<em class="nk"> yolov5 </em>'的文件夹。该文件夹将包含您进一步需要的所有内容，包括模型的预训练权重和特定的目录结构。</p><ul class=""><li id="d081" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu nh mz na nb bi translated">安装pytorch和其他必需的包</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="1824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Yolo V5运行在Torch上，有时安装起来可能会很复杂。如果你在这里挣扎，你可以移动到Kaggle或Colab笔记本:这些通常对这个安装很好。</p><h1 id="26c1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">2.如何设置用于训练Yolo V5对象检测模型的数据和目录？</h1><p id="174e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">Yolo V5需要一套非常特殊的数据文件夹才能工作。</p><h1 id="9e4c" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">Yolo V5目录结构</h1><p id="5bb3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">您需要在与您的<em class="nk"> yolov5 </em>文件夹相同的层次上创建一个名为<em class="nk"> data的文件夹。<em class="nk"> </em>在这个<em class="nk">数据</em>文件夹中你需要创建一个图像文件夹和一个标签文件夹。在每一个文件夹中，您都为训练数据和验证数据创建了一个文件夹。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9debfc4eb492efafcb10767a4dad60a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*XupA8TGTSGdZdjsrs16hkw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于训练Yolo V5模型的目录树</p></figure><p id="0fa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果文件没有放在正确的目录中，您以后可能会遇到错误。</p><h1 id="f9bc" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak"> Yolo V5数据格式</strong></h1><h2 id="0c45" class="nm lx it bd ly nn no dn mc np nq dp mg li nr ns mi lm nt nu mk lq nv nw mm nx bi translated"><strong class="ak">图像</strong></h2><p id="e85b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">图像必须直接放在图像文件夹中。<em class="nk">数据/图像/训练</em>文件夹中的训练图像和<em class="nk">数据/图像/有效</em>文件夹中的验证图像。图像的名称必须是带有. jpg(或其他格式)的唯一名称。</p><h2 id="dbf1" class="nm lx it bd ly nn no dn mc np nq dp mg li nr ns mi lm nt nu mk lq nv nw mm nx bi translated">标签</h2><p id="b86b" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">标签必须在<em class="nk">数据/标签/序列/ </em>或<em class="nk">数据/标签/有效中。</em>标签文件的名称必须与图像名称相同，但带有“.”。txt“而不是”。jpg”。</p><p id="5b87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">边界框必须作为每行一个边界框列出，该行上有:</p><ul class=""><li id="fab8" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu nh mz na nb bi translated">边界框中对象的类别号(如果只有一个类别，则始终为0)</li><li id="d949" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">以宽度表示的边界框的标准化中心像素</li><li id="8469" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">以高度表示的边界框的标准化中心像素</li><li id="0a79" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">边框的标准化宽度</li><li id="5c4f" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">边框的标准化高度</li></ul><p id="1a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标准化是通过将像素数除以图像的总像素数来完成的。因此，在大小为(100，100)的图片上，宽度为30×40的像素(10，20)上的边界框将被标准化为(0.1，0.2，0.3，0.4)。</p><p id="3f2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标签文件的行数是一幅图像中边界框的数量。标签文件的数量就是图像的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/6b0ef3cfc51cae95d91410f85a97244e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*nVcy0L2Xxm-BuedAGcueKw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个名为“00333207”的训练图像的标签的提取。</p></figure><h1 id="c6f1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">3.如何配置用于训练Yolo V5对象检测模型的YAML文件？</h1><p id="24b9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">要开始训练一个Yolo V5模型，你需要两个YAML文件。</p><p id="13be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个YAML规定:</p><ul class=""><li id="5114" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu nh mz na nb bi translated">你的训练数据在哪里，</li><li id="7564" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">你的验证数据在哪里，</li><li id="436b" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">您想要检测的类别(对象类型)的数量，</li><li id="3c05" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu nh mz na nb bi translated">以及与这些类别相对应的名称。</li></ul><p id="0a71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个YAML看起来像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="a515" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个YAML是指定整个模型，但是对于开始，我建议只改变第一行，"<em class="nk"> nc 【T21 ")，以得到正确的类数。</em></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="4f17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以将这些YAML文件放在任何您想要的地方，因为您稍后将引用完整的路径。</p><h1 id="71e2" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">4.如何训练自己定制的YoloV5模型？</h1><p id="5611" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">训练是使用train.py终端命令完成的，您可以从笔记本中执行该命令。</p><p id="a8f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以指定多个超参数，例如批次大小、时期数和图像大小。然后，指定我们刚刚在上面创建的两个yaml文件的位置。您还需要指定一个名称，这对以后查找结果很重要。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8066" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这一行将在yolov5中创建一个子文件夹，其中包含这个训练模型的权重，您可以在第5步中重用它。</p><p id="f482" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些文件夹将始终创建在同一个目录中:<em class="nk">yolov 5/runs/exp0 _ your name/…</em></p><p id="01b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您重新运行“train”命令时，Exp0将增加到exp1等。</p><h1 id="f13b" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">5.如何使用您定制的Yolo V5模型对新数据进行对象检测？</h1><p id="0422" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在是最后一个阶段，你需要检测看不见的照片上的物体。这是使用终端命令detect.py完成的，它将生成一个包含输出的新文件夹。您可以生成带有边框的图片，也可以生成带有边框位置的文本文件。</p><p id="97c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是按如下方式完成的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="13fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后你可以在文件夹<em class="nk"> yolov5/inference/output/中找到你的输出。</em>会有带注释的图片和。带有预测边界框的txt文件。</p><p id="1250" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="nk">我希望这篇教程有用，感谢阅读！</em></p></div></div>    
</body>
</html>