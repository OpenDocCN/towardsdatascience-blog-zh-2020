<html>
<head>
<title>Six Python Tips for Geospatial Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">地理空间数据科学的六个Python技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/six-python-tips-for-geospatial-data-science-4438a531b0bf?source=collection_archive---------32-----------------------#2020-09-28">https://towardsdatascience.com/six-python-tips-for-geospatial-data-science-4438a531b0bf?source=collection_archive---------32-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d733" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用Geopandas在Python中轻松有效地整合空间要素</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4629623c62d5d91e0bd85a2022cd4274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bjhHCE8UeAyVnSLn"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@osac?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拍摄的奥斯卡·雪佛兰</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="c166" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一轮关于Python的地理空间技巧中，我通过六个关键方面来使用Geopandas有效地处理和制作Python中的漂亮地图。</p><p id="0e05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想访问地理空间数据处理的最新提示和技巧，可以访问:</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/5-geospatial-tips-and-tricks-in-python-eef86aec5110"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python中的5个地理空间提示和技巧</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">第1部分:如何使用Geopandas在Python中轻松有效地集成空间要素。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/7-geospatial-data-processing-tips-in-python-dac5e4d28439"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Python中的7个地理空间数据处理技巧</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">第2部分:如何使用Geopandas在Python中轻松有效地集成空间要素。</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm ks ly"/></div></div></a></div><p id="9669" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我们在本文中包含的技巧列表。</p><ul class=""><li id="6f96" class="mo mp it lb b lc ld lf lg li mq lm mr lq ms lu mt mu mv mw bi translated"><a class="ae ky" href="#025c" rel="noopener ugc nofollow">图例位置</a></li><li id="ac4d" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated"><a class="ae ky" href="#9ac7" rel="noopener ugc nofollow">轻松地理编码</a></li><li id="c383" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated"><a class="ae ky" href="#cca8" rel="noopener ugc nofollow">空间连接</a></li><li id="16ee" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated"><a class="ae ky" href="#223c" rel="noopener ugc nofollow">行过滤器</a></li><li id="2325" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated"><a class="ae ky" href="#4041" rel="noopener ugc nofollow">夹子</a></li><li id="a25f" class="mo mp it lb b lc mx lf my li mz lm na lq nb lu mt mu mv mw bi translated"><a class="ae ky" href="#530b" rel="noopener ugc nofollow">单独的图例</a></li></ul><h2 id="025c" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">提示1 —图例位置</h2><p id="9b4b" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">传说是地图制作的重要组成部分。使用GIS软件，您可以拖放图例的位置以适应您的整体设计并避开障碍物。在Geopadnas中，您可以更改图例的位置。</p><p id="b604" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，图例显示在地图的右上角。在本例中，我们使用<code class="fe oa ob oc od b">legend_kwd</code>和<code class="fe oa ob oc od b">loc</code>参数将图例的位置更改到左上方。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/68580a4a3afbe26e9ba391b8fa364810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sstd1f97rcznW6qMP1iyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图例位置-作者的图像。</p></figure><p id="b470" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是用上面的代码生成的地图。如您所见，图例位置现在位于地图的左上角。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/eec1fd8bcb13a60bd8c2e0fd05790339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nvEpj5BVy9eIz2D-ASNflw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左上角带有图例的大陆地图-图片由作者提供。</p></figure><h2 id="9ac7" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">提示2-简单的地理编码</h2><p id="036b" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">地理编码是将物理地址描述转换为地球表面位置(以数字坐标表示的空间)的计算过程— <a class="ae ky" href="https://en.wikipedia.org/wiki/Geocoding" rel="noopener ugc nofollow" target="_blank">维基百科</a>。</p><p id="fc00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Python中使用OpenStreetMap免费进行地理编码很容易。在本例中，我们将对三个地址进行地理编码。首先，我们创建一个包含三个地址的数据帧。一旦我们有了数据帧，我们就可以在数据帧上快速调用. tools.geocode方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/8d036ea28a0871f8193265936587cac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Sa3Va3uAr8ql_0VHSbQRQ.png"/></div></div></figure><p id="1b76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们进行地理编码，我们就会得到一个额外的列，即几何列，它帮助我们执行地理功能，如缓冲、计算距离和最近点等。</p><h2 id="cca8" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">提示3-空间连接</h2><p id="87ca" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">作为基本的地理空间功能之一，空间连接几乎占了所有地理空间处理的一半。我们可以使用Geopandas通过位置快速连接空间数据。在本例中，我们使用SQL语法和Geopandas <code class="fe oa ob oc od b">read_file</code>方法从PostgreSQL中读取数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/412ac90afe44744e8997b0e8f565d16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YCeGB21aIbFeRHjdqQZhyw.png"/></div></div></figure><p id="3a4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们读取了数据，就很容易通过位置来连接数据。在上面代码的最后一行，我们使用Geopandas的<code class="fe oa ob oc od b">sjoin</code> sjoin方法将列表点连接到静态区域多边形。我们以两个数据集的连接结束，表明每个点属于哪一个。</p><p id="b7f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用Pandas的group by和aggregation函数进一步处理数据，以获得统计数据。在本例中，我将对每个多边形或统计区域中的列表进行聚合和计数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/b9bf816627df5d003381546e8193f827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRQRlp0CXJlFB7sEWButcQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">空间连接数据的聚合函数-图片由作者提供。</p></figure><p id="49a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终的数据框仅包含统计代码和每个多边形中Airbnb房源的数量。这是一张地图，显示了每个地区的列表数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/3db4b2ebbf9f59c80e1c76513e2234b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mr182xbq_Cs8M_Zx6XJTRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Airbnb房源Choropleth地图——作者图片</p></figure><h2 id="223c" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">提示#4 —行过滤器</h2><p id="4d46" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">就像pandas数据帧一样，Geopandas允许您限制或过滤出想要读取的行数。当您有一个大的数据集，并且您只想试验数据集的某一部分时，行筛选器非常有用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/4e02a264cec4500f24ab02278342eec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EaNJbMUuuc7S2RBwzXqvLw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按行过滤数据-按作者过滤图像。</p></figure><p id="88d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过传递rows参数来实现这一点。在上述代码的第一个实例中，我们将获得从零到一千的行。然而，通过切片，我们可以得到起始和结束数字之间的任意范围的行。</p><h2 id="4041" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">技巧5——夹子</h2><p id="67e5" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">我们很少获得具有适当界限的正确数据。有时，我们需要将数据裁剪到我们感兴趣的边界。使用Geopandas裁剪地理空间数据就像调用。裁剪方法并提供两个地理数据框架。在本例中，我们将把街道裁剪为预定义的边界多边形。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/45e7c1e128834fb0edc68ceb1444f2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pac938teSSGyBjHpR50HQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Geopandas中裁剪。—图片由作者提供。</p></figure><p id="ef01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们比较这两个数据集。下图显示了裁剪后的数据与原始边界和街道数据集的对比。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/b22c9c5cf76a43e6f7e5d5f726a73134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NiGIJwrwQST9OVoDM-kAqg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">裁剪数据集-作者提供的图像。</p></figure><h2 id="530b" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">提示#6 —单独的图例</h2><p id="f206" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">在第一篇技巧文章中，我们从图例位置开始，最后以图例方向结束。默认情况下，我们有一个垂直方向的图例。但是，出于任何原因，如果您希望有水平图例，您也可以使用legend_kwds和方向参数。让我们看一个水平图例方向的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/51dc9915ea6ccb96a2db9c8a616240ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hjfb9hyGmd6Yt_k0ZoiUBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">横向图例—作者图片。</p></figure><p id="00ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出是带有水平图例的地图。水平图例可以是美观的，并且可以帮助读者比垂直默认图例更好地阅读图例数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6761bbd63813b08a6447908b290b70ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*cVodg1jXXo8QyJLc18cn7w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">横向图例图—图片由作者提供。</p></figure><h2 id="2c3f" class="nc nd it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">结论</h2><p id="7d96" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">我希望您喜欢这一轮Python中的地理空间数据技巧。在本文中，我们看到了有效使用Geopandas进行地理空间数据分析的六个技巧。</p><p id="a398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中一些技巧是直接的几何操作，对于处理地理空间数据至关重要:空间连接、裁剪和地理编码。其他三个提示与地图制作和图例样式有关。</p><p id="2738" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢我在Twitter上发布的这些提示和技巧，你可以在<a class="ae ky" href="https://twitter.com/SpatialML" rel="noopener ugc nofollow" target="_blank"> @spatialML </a>找到它们</p></div></div>    
</body>
</html>