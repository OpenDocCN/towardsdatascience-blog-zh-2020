<html>
<head>
<title>Machine learning for anomaly detection: Elliptic Envelope</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于异常检测的机器学习:椭圆包络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-for-anomaly-detection-elliptic-envelope-2c90528df0a6?source=collection_archive---------21-----------------------#2020-10-07">https://towardsdatascience.com/machine-learning-for-anomaly-detection-elliptic-envelope-2c90528df0a6?source=collection_archive---------21-----------------------#2020-10-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b9e460f9d4d3c03473688fb284073cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KWL0KvgJCt-w4Sw1"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@markomons?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马可·蒙斯</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="ed4a" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">小型数据科学</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="46dd" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">欢迎回到异常检测；这是一系列关注异常值检测的“小数据”科学中的第6篇。今天我写的是一个叫做<code class="fe mb mc md me b">EllipticEnvelope</code>的机器学习算法，它是数据科学家工具箱中的又一个工具，用于欺诈/异常/异常值检测。</p><p id="2bcf" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果您错过了我以前的文章，或者您有兴趣了解关于这个主题的更多信息，请找到下面的链接:</p><ul class=""><li id="6284" class="mf mg jj lh b li lj ll lm lo mh ls mi lw mj ma mk ml mm mn bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/anomaly-detection-with-local-outlier-factor-lof-d91e41df10f2">局部异常因子(LOF) </a></li><li id="0141" class="mf mg jj lh b li mo ll mp lo mq ls mr lw ms ma mk ml mm mn bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/z-score-for-anomaly-detection-d98b0006f510"> Z分数</a></li><li id="e621" class="mf mg jj lh b li mo ll mp lo mq ls mr lw ms ma mk ml mm mn bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/boxplot-for-anomaly-detection-9eac783382fd">箱线图</a></li><li id="a7c8" class="mf mg jj lh b li mo ll mp lo mq ls mr lw ms ma mk ml mm mn bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/statistical-techniques-for-anomaly-detection-6ac89e32d17a">统计技术</a></li><li id="df28" class="mf mg jj lh b li mo ll mp lo mq ls mr lw ms ma mk ml mm mn bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/time-series-anomaly-detection-with-anomalize-library-67472003c003">时间序列异常检测</a></li></ul><h1 id="f392" class="mt mu jj bd mv mw mx my mz na nb nc nd kp ne kq nf ks ng kt nh kv ni kw nj nk bi translated">椭圆形信封</h1><p id="6bc2" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">那么什么是椭圆包络，算法背后的直觉是什么？</p><p id="1469" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果你上过几何课，你可能对椭圆很熟悉——一种在二维平面上呈椭圆形的几何形状。</p><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/ae3cd6dce9be54d8c0eaa6d78b6ddf61.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*CYgTfGIjb35GkZCh5NgD4g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">椭圆形外壳的概念图</p></figure><p id="03dc" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">上图中的绿色区域是一个椭圆。因此，算法——椭圆包络——在给定数据集周围创建一个假想的椭圆区域。落在包络线内的值被视为正常数据，任何超出包络线的值都作为异常值返回。因此，自然地，上图中的红色数据点应该被该算法识别为异常值。从该图可以明显看出，如果数据具有高斯分布，则该算法工作得最好。</p><h1 id="b6f4" class="mt mu jj bd mv mw mx my mz na nb nc nd kp ne kq nf ks ng kt nh kv ni kw nj nk bi translated">履行</h1><p id="1b6a" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated"><code class="fe mb mc md me b">sklearn</code>是机器学习算法的瑞士军刀。因此毫不奇怪，它也有一个使用椭圆包络进行异常检测的模块。下面我用5个简单的步骤演示了一个使用虚拟数据点的实现。</p><h2 id="50a6" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated">步骤1:导入库</h2><pre class="nr ns nt nu gt oh me oi oj aw ok bi"><span id="7669" class="nv mu jj me b gy ol om l on oo"># import libraries<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn.covariance import EllipticEnvelope<br/>import matplotlib.pyplot as plt</span></pre><h2 id="6895" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated"><strong class="ak">第二步:获取训练数据</strong></h2><pre class="nr ns nt nu gt oh me oi oj aw ok bi"><span id="287c" class="nv mu jj me b gy ol om l on oo"># create a dataframe<br/>df = pd.DataFrame(np.array([[0,1], [1,1], [1,2], [2,2], [5,6]]), columns = ["x", "y"], index = [0,1,2,3,4])</span><span id="5cae" class="nv mu jj me b gy op om l on oo"># show data in a scatterplot<br/>plt.scatter(df["x"], df["y"], color = "r")<br/>plt.grid()</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/24d4850e8862e649fe7477128e9b68ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*QkWEJvsoMAC2BeQzXpuUdg.png"/></div></figure><h2 id="59a7" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated">步骤3:准备输入</h2><pre class="nr ns nt nu gt oh me oi oj aw ok bi"><span id="6fec" class="nv mu jj me b gy ol om l on oo"># convert dataframe to arrays<br/>data = df[['x', 'y']].values</span></pre><h2 id="d128" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated">第四步:建模</h2><p id="fc43" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">定义模型时最重要的参数是设置“污染”参数，它基本上定义了将被识别为异常值的值的比例。参数值的范围在0到0.5之间</p><pre class="nr ns nt nu gt oh me oi oj aw ok bi"><span id="7008" class="nv mu jj me b gy ol om l on oo"># instantiate model<br/>model1 = EllipticEnvelope(contamination = 0.1) </span><span id="13b7" class="nv mu jj me b gy op om l on oo"># fit model<br/>model1.fit(data)</span></pre><h2 id="44bd" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated">第五步:预测</h2><pre class="nr ns nt nu gt oh me oi oj aw ok bi"><span id="3946" class="nv mu jj me b gy ol om l on oo"># new data for prediction (data needs to be in arrays)<br/>new_data = np.array([[10,10], [1,1], [1,1], [1,1]])</span><span id="b1d1" class="nv mu jj me b gy op om l on oo"># predict on new data <br/>pred1 = model1.predict(new_data)<br/>print(pred1)</span></pre><figure class="nr ns nt nu gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/76b8c987ba67dbfc7d8f6ba31a41a161.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*chy6ZRp48aOtolWHxjuccw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">负值是异常值</p></figure><h2 id="0d70" class="nv mu jj bd mv nw nx dn mz ny nz dp nd lo oa ob nf ls oc od nh lw oe of nj og bi translated">总结和后续步骤</h2><p id="18cf" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">本文的目的是介绍椭圆包络——一种用于异常检测的机器学习算法——并使用Scikit-Learn库实现该算法。如果您现在已经清楚了关键概念，那么继续尝试在真实数据集上实现它，例如，<a class="ae jg" href="https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv" rel="noopener ugc nofollow" target="_blank">在线可用的Iris数据集</a>。您应该能够对这个数据集使用上面的5个步骤，只需要确保您选择了正确的列以使算法工作。</p></div></div>    
</body>
</html>