<html>
<head>
<title>“Powering-up” health facilities in SSA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“启动”撒哈拉以南非洲的卫生设施</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/powering-up-health-facilities-in-ssa-fb626babddbe?source=collection_archive---------55-----------------------#2020-10-19">https://towardsdatascience.com/powering-up-health-facilities-in-ssa-fb626babddbe?source=collection_archive---------55-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c7ec" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用开放存取数据的探索性方法&amp; Python中的空间分析</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/389a342d3c44f2ea6d504e03e39e4c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9bIWRjbwodl2pWLfzNVSg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马丁·桑切斯在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="6765" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">目录</h1><p id="018e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><a class="ae kv" href="#96a4" rel="noopener ugc nofollow">动机</a> <br/> <a class="ae kv" href="#0ec6" rel="noopener ugc nofollow">循序渐进指南</a> <br/> <a class="ae kv" href="#5b80" rel="noopener ugc nofollow">结束语</a> <br/> <a class="ae kv" href="#72db" rel="noopener ugc nofollow">链接到辅助材料</a></p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="96a4" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">动机</h1><p id="1f80" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">据估计，全球约有7 . 89亿人没有电力供应。绝大多数(约75% )位于撒哈拉以南非洲。这是一个影响社会经济发展和人类福祉的关键服务差距，特别是在最不发达地区的贫困农村人口中。</p><p id="794c" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">与此同时，新冠肺炎突出强调了电力在卫生部门的重要性。在诊所和卫生站获得电力，使人们保持联系，便于信息管理、药品冷藏和其他服务，以保护弱势群体。因此，缺乏可靠的电力正在损害数百万人的医疗保健质量。</p><p id="e50a" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir">这就迫切需要“加强”最不发达地区的卫生设施，以便及时应对新冠肺炎危机。</strong></p><p id="8139" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">本博客介绍了一种探索性的、基于GIS的方法，用于在缺乏这类详细数据的地区估算医疗机构的电力需求。它利用现有的开放访问数据集(和模型),以提供这些设施中年度电力需求的高水平画面，并随后指示如何作为最低成本电气化计划的一部分来满足这些需求。</p><p id="fac2" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">下面的例子集中在莫桑比克的<a class="ae kv" href="https://en.wikipedia.org/wiki/Mecanhelas_District" rel="noopener ugc nofollow" target="_blank"> Mecanhelas </a>区(任意选择)。然而，该代码可用于在任何行政级别(例如，国家和/或区域)扩大分析。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="0ec6" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">循序渐进的指南</h1><h1 id="393f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第一步。设置python环境和导入数据集</h1><h2 id="e86e" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">导入必要的模块</h2><p id="4fd2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">作为Jupyter中任何建模练习的一部分，第一步需要导入必要的python模块。你可以参考<a class="ae kv" href="https://github.com/akorkovelos/gep_health_facilities/blob/master/requirements.txt" rel="noopener ugc nofollow" target="_blank"> requirements.txt </a>来检查这个例子的依赖关系。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="f097" class="nb kx iq no b gy ns nt l nu nv"># Import python modules<br/>import geopandas as gpd<br/>import pandas as pd<br/>import pyproj<br/>import numpy as np<br/><br/>from functools import reduce<br/>from shapely.geometry import Point, Polygon, MultiPoint<br/>from shapely.ops import nearest_points</span><span id="a60e" class="nb kx iq no b gy nw nt l nu nv">import datapane as dp<br/># !datapane login --token="yourpersonaltoken"</span><span id="2e88" class="nb kx iq no b gy nw nt l nu nv">import folium<br/>from folium.features import GeoJsonTooltip<br/>import branca.colormap as cm<br/>import os<br/>from IPython.display import display, Markdown, HTML<br/><br/>import matplotlib.pyplot as plt<br/>from matplotlib.ticker import MaxNLocator<br/><br/>%matplotlib inline</span></pre><h2 id="3b09" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">导入数据集</h2><p id="9cbf" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这里，我们导入将要使用的数据集。其中包括以下三种:</p><p id="0d98" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir"> 1。行政边界(矢量多边形):</strong>这定义了我们感兴趣区域的边界框。在这个例子中，我们使用的是莫桑比克西北部省份Mecanhelas的行政边界。你可以从<a class="ae kv" href="https://gadm.org/" rel="noopener ugc nofollow" target="_blank"> GADM </a>那里取回这个。</p><p id="9fdb" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir"> 2。卫生设施的位置(向量点)</strong>:在这种情况下，我们使用由<a class="ae kv" href="https://www.nature.com/articles/s41597-019-0142-2" rel="noopener ugc nofollow" target="_blank"> Maina等人</a>提供的卫生设施的空间数据库。该数据集包括98，745个公共卫生机构，所有这些机构都有地理位置。</p><p id="6269" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir"> 3。人口集群(矢量多边形)</strong>:这是指建成区的矢量化版本，如<a class="ae kv" href="https://www.mdpi.com/1996-1073/12/7/1395" rel="noopener ugc nofollow" target="_blank"> Korkovelos等人</a>所述。撒哈拉以南非洲所有国家的人口集群都是开放的，可在<a class="ae kv" href="https://data.mendeley.com/datasets/z9zfhzk8cr/6" rel="noopener ugc nofollow" target="_blank"> PopClusters </a>上获得。(在本练习中，我们使用2020年9月1日发布的版本6)。</p><blockquote class="nx ny nz"><p id="f946" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注1 </strong>。出于本练习的目的，在导入笔记本之前,( 2)和(3)都基于(1)进行了剪裁。你可以使用<a class="ae kv" href="https://geopandas.org/reference/geopandas.clip.html" rel="noopener ugc nofollow" target="_blank"> geopandas </a>或<a class="ae kv" href="https://docs.qgis.org/2.8/en/docs/user_manual/processing_algs/gdalogr/ogr_geoprocessing/clipvectorsbypolygon.html" rel="noopener ugc nofollow" target="_blank"> Qgis </a>来完成这项工作。</p><p id="89c5" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注2 </strong>。在导入之前，所有数据集都在WGS84坐标系中。请确保这是事实，否则请纠正。</p></blockquote><h2 id="5104" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">将行政边界作为地理数据框架导入</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="0115" class="nb kx iq no b gy ns nt l nu nv"># Define path and name of the file<br/>admin_path = r"input_data\Testing_Sample"<br/>admin_name = "mecanhelas_admin.gpkg"</span><span id="8a1d" class="nb kx iq no b gy nw nt l nu nv"># Create a new geo-dataframe<br/>admin_gdf = gpd.read_file(admin_path + "\\" + admin_name)</span><span id="d82f" class="nb kx iq no b gy nw nt l nu nv"># Create the axis first<br/>fig, ax = plt.subplots(figsize=(10, 10))<br/>admin_gdf.plot(ax=ax, edgecolor='black', alpha=0.2)<br/>ax.set_aspect('equal', 'box')<br/>txt = ax.set_title('Mecanhelas Administrative Boundary'.format(""))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/7502454847e53101518a37ccbc99b355.png" data-original-src="https://miro.medium.com/v2/format:webp/1*1Wm772fLPHaWE14l4bowdw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莫桑比克Mecanhelas区的行政区域—图片由作者提供</p></figure><h2 id="5cfb" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">进口卫生设施</h2><blockquote class="nx ny nz"><p id="8550" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注意</strong>为了让下面的代码正常工作，这应该是一个“点”层；如果几何特征为“多点”,您应该将其转换为“点”以继续。你可以使用Qgis来完成这项工作。</p></blockquote><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="c3cc" class="nb kx iq no b gy ns nt l nu nv"># Define path and name of the file<br/>health_path = r"input_data\Testing_Sample"<br/>health_name = "mec_health_index.gpkg"</span><span id="f54e" class="nb kx iq no b gy nw nt l nu nv"># Create a new geo-dataframe<br/>health_gdf = gpd.read_file(health_path + "\\" + health_name)</span><span id="3052" class="nb kx iq no b gy nw nt l nu nv">health_gdf.head(3)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/b61472b83c2d92fed8c864d8467536aa.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QpTwv9557DicfjD4ZqN-GQ.png"/></div></figure><h2 id="72b9" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">…和可视化</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="9edc" class="nb kx iq no b gy ns nt l nu nv">fig, ax = plt.subplots(figsize=(10, 10))<br/><br/>admin_gdf.plot(ax=ax, edgecolor='brown', alpha=0.2)<br/>health_gdf.plot(ax=ax, legend=True, markersize=3, figsize=(15, 15), alpha=0.5)<br/><br/>ax.set_aspect('equal', 'box')<br/>txt = ax.set_title('Location of health facilities in Mecanhelas'.format(""))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/1ef5a2e37e9f62400acbdd454a16e1f8.png" data-original-src="https://miro.medium.com/v2/format:webp/1*AQR6tqnpO5SD_i41cCOknw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莫桑比克Mecanhelas卫生机构的位置—图片由作者提供</p></figure><h2 id="b40a" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">导入人口聚类</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="0864" class="nb kx iq no b gy ns nt l nu nv"># Define path and name of the file<br/>clusters_path = r"input_data\Testing_Sample"<br/>clusters_name = "mecanhelas_clusters.gpkg"</span><span id="dac6" class="nb kx iq no b gy nw nt l nu nv">clusters_gdf = gpd.read_file(clusters_path + "\\" + clusters_name)</span><span id="7eef" class="nb kx iq no b gy nw nt l nu nv">clusters_gdf.head(2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/352b2d8986e77a7ec303e1d5c959831e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*3UZTMzdYuXkRGcgE0tDWyw.png"/></div></figure><h2 id="ccd7" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">…并使用每个聚类的质心创建新的地理数据框</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="8bbe" class="nb kx iq no b gy ns nt l nu nv">clusters_centroid = gpd.GeoDataFrame(clusters_gdf, geometry=clusters_gdf.centroid)</span><span id="dc44" class="nb kx iq no b gy nw nt l nu nv">fig, ax = plt.subplots(figsize=(10, 10))<br/><br/>admin_gdf.plot(ax=ax, edgecolor='brown', alpha=0.2)<br/>clusters_centroid.plot(ax=ax, legend=True, markersize=3, figsize=(15, 15), alpha=0.5)<br/><br/>ax.set_aspect('equal', 'box')<br/>txt = ax.set_title('Population cluster centroids in Mecanhelas'.format(""))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/76590d9643363044a5416c350366c402.png" data-original-src="https://miro.medium.com/v2/format:webp/1*99EhnM40-K4fIKhFTUGSIQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莫桑比克Mecanhelas区的“矢量化”建筑——图片由作者提供</p></figure><p id="1cd0" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">输入的数据表明，Mecanhelas有<strong class="lq ir"> 10，703个人口集群</strong>(或定居点)，由<strong class="lq ir"> 19个卫生设施</strong>提供服务。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="d40c" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">第二步。数据集的空间处理</h1><p id="1309" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">一旦数据集成功导入，我们就可以为医疗机构计算简单的空间统计数据。也就是说，我们使用它们的位置并从附近的人口聚类中提取值。这里我们有两个选择。</p><h2 id="d4dc" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">选项1-最近枢纽分析</h2><p id="1dd3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">部署最近中心分析，并计算与每个医疗机构的“集水区”相关的统计数据。</p><blockquote class="nx ny nz"><p id="e21a" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注意</strong>下面的NNA代码是从<a class="ae kv" href="https://github.com/shakasom/NearestNeighbour-Analysis" rel="noopener ugc nofollow" target="_blank"> shakasom </a>中检索出来的。</p></blockquote><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="7c95" class="nb kx iq no b gy ns nt l nu nv"># Simple function getting the nearest hub for a given set of points<br/>def calculate_nearest(row, destination, val, col="geometry"):<br/>    dest_unary = destination["geometry"].unary_union<br/>    nearest_geom = nearest_points(row[col], dest_unary)<br/>    match_geom = destination.loc[destination.geometry == nearest_geom[1]]<br/>    match_value = match_geom[val].to_numpy()[0]<br/>    return match_value</span></pre><h2 id="d5ad" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">为每个集群分配最近的医疗机构</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="a7c8" class="nb kx iq no b gy ns nt l nu nv">clusters_centroid["index"] = clusters_centroid.apply(calculate_nearest, destination=health_gdf, val="index", axis=1)</span></pre><h2 id="6b80" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">基于医疗机构id分解聚类，并计算每个医疗机构的基本统计数据</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="78ed" class="nb kx iq no b gy ns nt l nu nv">stat_list = ['sum', 'mean', 'count']<br/><br/>HF_hub_stats = clusters_centroid.dissolve(by='index', aggfunc=stat_list)</span></pre><blockquote class="nx ny nz"><p id="f84a" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注意！</strong>这会产生一个多点矢量层；每个多点包含由同一医疗机构提供服务的聚类(质心)的位置。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/60953de6c202366714e1e30753b292e2.png" data-original-src="https://miro.medium.com/v2/format:webp/1*eUSlPdZwyhiy3fFtJtj4MQ.png"/></div></figure><h2 id="de66" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">将结果与初始医疗设施点图层合并</h2><p id="b4b9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是为了在原始医疗机构数据帧中附加新检索的统计数据。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="d8d1" class="nb kx iq no b gy ns nt l nu nv">HF_hub = health_gdf.merge(HF_hub_stats, on="index")</span></pre><p id="39f1" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">整理结果后，<strong class="lq ir">选项1 </strong>生成以下地理数据框，其中根据聚类的最近距离计算每个医疗机构的基本统计数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/b3f0a18b30049a6ccdb262c28ae6a468.png" data-original-src="https://miro.medium.com/v2/format:webp/1*EFrAnZkyOiaHIPm2bU03_g.png"/></div></figure><h2 id="9186" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">选项2 —基于缓冲区的统计</h2><p id="8b02" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">将缓冲区应用于每个医疗机构，并计算落入其中的集群的统计数据。这种方法计算量较小。</p><h2 id="2337" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">首先，我们需要将图层投影到正确的CRS中</h2><p id="e8bb" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在这种情况下，我们使用<a class="ae kv" href="https://epsg.io/32737" rel="noopener ugc nofollow" target="_blank"> epsg.io </a>中为莫桑比克标识的“epsg:32737”。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="fc29" class="nb kx iq no b gy ns nt l nu nv">admin_gdf_prj = admin_gdf.to_crs({'init': 'epsg:32737'})<br/>health_gdf_prj = health_gdf.to_crs({'init': 'epsg:32737'})<br/>clusters_gdf_prj = clusters_gdf.to_crs({'init': 'epsg:32737'})</span><span id="6de7" class="nb kx iq no b gy nw nt l nu nv"># Drop selected columns<br/>clusters_gdf_prj.drop(["index"], axis=1, inplace=True)<br/>clusters_gdf_prj.head(2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/ab11dddd439ef64becdb661678abf27e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*IzeI56popV1WMRTv38eGaw.png"/></div></figure><h2 id="e122" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">…我们重新生成了群集质心层，只是这次使用了投影的群集</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="b978" class="nb kx iq no b gy ns nt l nu nv">clusters_centroid_proj = gpd.GeoDataFrame(clusters_gdf_prj, geometry=clusters_gdf_prj.centroid)</span></pre><h2 id="f2ef" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">为每个卫生设施增加一个缓冲区</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="99d2" class="nb kx iq no b gy ns nt l nu nv">health_gdf_prj['geometry'] = health_gdf_prj.geometry.buffer(1000)   # in meters</span></pre><h2 id="476d" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">应用空间连接</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="bdc8" class="nb kx iq no b gy ns nt l nu nv">#Spatial join<br/>health_gdf_prj_joined = gpd.sjoin(clusters_centroid_proj, health_gdf_prj, op='within', how='right')</span><span id="2826" class="nb kx iq no b gy nw nt l nu nv">health_gdf_prj_joined.head(2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/76c052bcc6289cdee2ea320f75b5dbb7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*e0FZpITlsOu96VXwIUPeaw.png"/></div></figure><h2 id="330c" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">基于索引对要素进行分组</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="7584" class="nb kx iq no b gy ns nt l nu nv"># Basic statistics to calculate<br/>stat_list = ['sum', 'mean', 'count']<br/><br/># Apply groupby function<br/>HF_buf_stats = health_gdf_prj_joined.dissolve(by='index', aggfunc=stat_list)</span></pre><h2 id="ed92" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">与初始医疗机构数据集合并</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="7192" class="nb kx iq no b gy ns nt l nu nv">HF_buf = health_gdf_prj.merge(HF_buf_stats, on="index")</span></pre><h2 id="a6c0" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">将结果转换为原始CRS中的地理数据框</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="9549" class="nb kx iq no b gy ns nt l nu nv">## Creating a geo-dataframe - appointing geometry attribute<br/>HF_buf['geometry'] = list(zip(HF_buf['Lon'], HF_buf['Lat']))<br/>HF_buf['geometry'] = HF_buf['geometry'].apply(Point)<br/>HF_buf_gdf = gpd.GeoDataFrame(HF_buf, geometry='geometry', crs={'init': 'epsg:4326'})</span></pre><p id="bb2b" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">整理结果后，<strong class="lq ir">选项2 </strong>生成以下地理数据框，其中基于缓冲区计算每个医疗机构的基本统计数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/7d57fcea014a0a19be77c618ccbce206.png" data-original-src="https://miro.medium.com/v2/format:webp/1*O08qwA3W8ogGu9u5qvyVXQ.png"/></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="e92a" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">描述性分析</h2><p id="1f75" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">无论选择何种方法(<strong class="lq ir">选项1 </strong>或<strong class="lq ir">选项2 </strong>)，生成的地理数据框架都具有相似的格式。接下来，我们希望对结果进行描述性分析，以便了解数据类型和潜在的分类技术。</p><h2 id="5bb5" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated"><strong class="ak">选项1的结果</strong></h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="cf3c" class="nb kx iq no b gy ns nt l nu nv">HF_hub_gdf.pop_sum.describe()</span><span id="cbf5" class="nb kx iq no b gy nw nt l nu nv">count       19.000000<br/>mean     26882.061818<br/>std      10771.348988<br/>min       5685.042735<br/>25%      21419.189453<br/>50%      25469.963919<br/>75%      30545.254864<br/>max      59730.107002<br/>Name: pop_sum, dtype: float64</span><span id="89af" class="nb kx iq no b gy nw nt l nu nv">bin_values = np.arange(start=0, stop=HF_hub_gdf.pop_sum.sum())<br/><br/>HF_hub_gdf['pop_sum'].hist(figsize=[14,6])<br/>plt.title("Population served by each health facility")<br/><br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/1d13bc21e2980d4033957adc2a9076de.png" data-original-src="https://miro.medium.com/v2/format:webp/1*WNTxFg9YbIHVPbdfYDYnuQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按作者分类的图表</p></figure><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="0d92" class="nb kx iq no b gy ns nt l nu nv"># remove inconsistencies hospital type names    <br/>HF_hub_gdf["fctype"].replace("\?", 'u', regex=True, inplace=True)<br/><br/># remove inconsistencies hospital type names    <br/>HF_hub_gdf["fcname"].replace("\?", 'u',regex=True, inplace=True)</span><span id="4dea" class="nb kx iq no b gy nw nt l nu nv">ls_of_hf = HF_hub_gdf.fctype.unique()<br/>print('\nThis administrative area has {} different types of hospitals:\n'.format(len(ls_of_hf)))<br/>print(*ls_of_hf, sep = '\n')</span><span id="ddee" class="nb kx iq no b gy nw nt l nu nv"><strong class="no ir">This administrative area has 2 different types of hospitals:<br/></strong><br/>Centro de Saude Rural II<br/>Centro de Saude Rural I</span></pre><h2 id="8017" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated"><strong class="ak">选项2 </strong>的结果</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="f5d4" class="nb kx iq no b gy ns nt l nu nv">HF_buf_gdf.pop_sum.describe()</span><span id="6411" class="nb kx iq no b gy nw nt l nu nv">count       19.000000<br/>mean      4121.879924<br/>std       6517.540750<br/>min        253.035754<br/>25%        819.507531<br/>50%        991.796760<br/>75%       2666.860946<br/>max      20250.234550<br/>Name: pop_sum, dtype: float64</span><span id="3559" class="nb kx iq no b gy nw nt l nu nv">bin_values = np.arange(start=0, stop=HF_buf_gdf.pop_sum.sum())<br/><br/>HF_buf_gdf['pop_sum'].hist(figsize=[14,6])<br/>plt.title("Population served by each health facility")<br/><br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/7090d6b39790d5aa4bac29b1b2ff9016.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HbckiY0I2Lco3hcY-e2n5w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按作者分类的图表</p></figure><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="d0b4" class="nb kx iq no b gy ns nt l nu nv">ls_of_hf = HF_buf_gdf.fctype.unique()<br/>print('\nThis administrative area has {} different types of hospitals:\n'.format(len(ls_of_hf)))<br/>print(*ls_of_hf, sep = '\n')</span><span id="6dc0" class="nb kx iq no b gy nw nt l nu nv"><strong class="no ir">This administrative area has 2 different types of hospitals:</strong><br/><br/>Centro de Saude Rural II<br/>Centro de Saude Rural I</span></pre><p id="4982" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">描述性统计提供了每个卫生机构(潜在)服务人数的概念。基于原始数据的属性，也可以检索其他特征(例如，我们在该区域确定的医疗机构的类型)。这些信息可用于帮助将健康诊所分类为不同的“能源使用”组(参见下面的步骤3)。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="58bd" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">第三步。描述卫生设施的类型并预测电力需求</h2><p id="b1d3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">您可以选择以上任何一种方法继续。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="daac" class="nb kx iq no b gy ns nt l nu nv">HF = HF_hub_gdf      # you may change the input gdf here</span><span id="2572" class="nb kx iq no b gy nw nt l nu nv"># Initialize a Health Facility Category column<br/>HF['HF_Cat'] = 0</span></pre><h2 id="c16d" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">卫生设施的分类</h2><p id="7d63" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">下面介绍的分类过程是基于这样的想法，即卫生设施分为四个主要类别，即:</p><ul class=""><li id="9f04" class="of og iq lq b lr mw lu mx lx oh mb oi mf oj mj ok ol om on bi translated"><strong class="lq ir">类型4: </strong>地区/转诊医院(&gt; 145张床位)</li><li id="338a" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ok ol om on bi translated"><strong class="lq ir">类型3: </strong>乡村医院(约55张床位)</li><li id="3355" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ok ol om on bi translated"><strong class="lq ir">类型2: </strong>小型急病门诊(约14张床位)</li><li id="e6c4" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ok ol om on bi translated"><strong class="lq ir">类型1: </strong>农村药房——无住院病人(约4张急诊床)</li></ul><p id="4031" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">这种分类与文献中的类似方法一致(例如，参见<a class="ae kv" href="https://www.sciencedirect.com/science/article/pii/S2213138817301376" rel="noopener ugc nofollow" target="_blank"> Franco等人</a>)。它还被采用并用于<a class="ae kv" href="https://poweringhealth.homerenergy.com/" rel="noopener ugc nofollow" target="_blank">HOMER power Health Tool</a>。</p><p id="3547" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">在本例中，我们使用三个值(我们在上一步中已经计算过)来帮助对医疗机构进行相应的分类。其中包括:</p><ol class=""><li id="9251" class="of og iq lq b lr mw lu mx lx oh mb oi mf oj mj ot ol om on bi translated"><strong class="lq ir"> "urban_mean" </strong>:这是与每个卫生设施相关的所有集群的平均城市状态{城市:1或农村:0}。值&gt;大于0.5表示医疗设施服务于更多的城市居民区，因此更有可能是更高级的类型。</li><li id="2e33" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ot ol om on bi translated"><strong class="lq ir"> "pop_sum" </strong>:这是与每个医疗机构相关的所有集群中的人口总数(基于上一步中最近的中心或缓冲区分析)。更高的潜在服务人群可能表明更高的类型。</li><li id="be9f" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ot ol om on bi translated"><strong class="lq ir"> "elecpop_sum" </strong>:这是与每个卫生设施相关的所有集群中通电人口的总和。这在一定程度上表明，附近的电气化状况可能与卫生设施的类型有关。</li></ol><p id="6280" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">在缺乏更详细的(如调查)数据的情况下，目前很难对这种方法进行交叉验证。因此，方法的这一部分对用户输入是开放的。其想法是，建模者可以与当地的利益相关者密切合作，以便校准过程或在获得更多信息时添加“预测器”。</p><blockquote class="nx ny nz"><p id="a184" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注意！</strong>在我们的示例中，医疗机构确实包含一些属性，例如它们的类型(如Centro de Saude Rural I或II)。如果可能的话，可以使用这一特性(或任何类似的特性)来帮助估计电力需求。然而，在接下来的步骤中，我们仅使用检索到的人口聚类数据统计，因此该方法可复制到其他地区。</p></blockquote><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="a8c8" class="nb kx iq no b gy ns nt l nu nv"># District/Referral hospital with more than 145 beds<br/>HF.loc[(HF['urban_mean'] &gt;= 0.5) &amp;<br/>       (HF['pop_sum'] &gt;= 20000) &amp;<br/>       (HF['elecpop_sum'] &gt;= 0), 'HF_Cat'] = 4<br/><br/># Rural hospital - 50 beds<br/>HF.loc[(HF['urban_mean'] &lt;= 0.5) &amp;<br/>       (HF['pop_sum'] &gt;= 20000) &amp;<br/>       (HF['elecpop_sum'] &gt;= 0), 'HF_Cat'] = 3<br/><br/># Small impatient clinic - 14 beds<br/>HF.loc[(HF['urban_mean'] &lt;= 0.5) &amp;<br/>       (HF['pop_sum'] &lt; 20000) &amp;<br/>       (HF['elecpop_sum'] &gt; 0), 'HF_Cat'] = 2<br/><br/># Rural dispensary - no inpatient - 4 emergency beds<br/>HF.loc[(HF['urban_mean'] &lt;= 0.5) &amp;<br/>       (HF['pop_sum'] &lt; 20000) &amp;<br/>       (HF['elecpop_sum'] == 0), 'HF_Cat'] = 1</span></pre><h2 id="ef66" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">分类的绘图结果</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="e3c2" class="nb kx iq no b gy ns nt l nu nv">ax = HF['HF_Cat'].value_counts().plot(kind='bar',figsize=[12,7])<br/>ax.yaxis.set_major_locator(MaxNLocator(integer=True))<br/>plt.title("Categorization of Health facilities in the selected admin area")</span><span id="85b6" class="nb kx iq no b gy nw nt l nu nv">Text(0.5, 1.0, 'Categorization of Health facilities in the selected admin area')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/2dbf46f691b7095462ee174e7a41ba91.png" data-original-src="https://miro.medium.com/v2/format:webp/1*syQc7ymJ8WmfyZTqf3j8ZA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莫桑比克Mecanhelas医疗机构的数量(y轴)和类型(x轴)——作者图表</p></figure><h2 id="5d41" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">根据类别类型分配电力需求</h2><p id="2a5b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">与分类(见上文)类似，考虑到缺乏定量的地面数据，估计每个医疗机构的电力需求并不是一件容易的事情。在本例中，我们使用<a class="ae kv" href="https://poweringhealth.homerenergy.com/" rel="noopener ugc nofollow" target="_blank"> HOMER供电健康工具</a>界面来量化每种类型的健康机构的潜在电力需求(千瓦时/年)。建模者可以选择适当的设备并相应地定制电力目标。</p><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="541d" class="nb kx iq no b gy ns nt l nu nv">HF.loc[(HF['HF_Cat'] == 1), 'HF_kWh'] = 5.7*365<br/>HF.loc[(HF['HF_Cat'] == 2), 'HF_kWh'] = 13.9*365                                                <br/>HF.loc[(HF['HF_Cat'] == 3), 'HF_kWh'] = 37*365                          <br/>HF.loc[(HF['HF_Cat'] == 4), 'HF_kWh'] = 361.1*365</span></pre><p id="def8" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">基于上述假设，预计Mecanhelas医疗机构的电力需求为<strong class="lq ir"> ~225，314.5kWh/年</strong>。</p><h1 id="7e54" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">在地图上打印带有估计需求的医疗机构的位置</h1><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="19aa" class="nb kx iq no b gy ns nt l nu nv"># Vizualize result on an interactive map exported as html <br/><br/>#Define limits for map rendering<br/>x_ave = HF["Lon"].mean()<br/>y_ave = HF["Lat"].mean()<br/><br/># Create the map using folium module<br/>map_dem = folium.Map(location=[y_ave,x_ave], zoom_start=6, control_scale=True)<br/><br/># Definition of a function that returns different color names based on lcoe result categorization<br/># Colors are in Hexa-code e.g. #RRGGBB<br/>def colorvalue(x):<br/>    if x &lt;= 0.5:<br/>        return "#ADFF2F"<br/>    elif x &gt;= 1 and x &lt; 5000:<br/>        return "#32CD32"<br/>    elif x &gt;= 5000 and x &lt; 10000:<br/>        return "#228B22"<br/>    elif x &gt;= 10000 and x &lt; 15000:<br/>        return "#008000"<br/>    elif x &gt;= 15000 and x &lt; 20000:<br/>        return "#006400"<br/>    else:<br/>        return "#000000" <br/><br/># Then we create a marker for each cluster; <br/># We pass coordinates as attributes to appear on the rendered map<br/>for index, row in HF.iterrows():<br/>    el_demand = row["HF_kWh"]<br/>    color_code = colorvalue(el_demand)<br/>    folium.CircleMarker([row["Lat"], row["Lon"]],<br/>                        radius=2,<br/>                        color=color_code,<br/>                        popup="&lt;b&gt;Name:&lt;/b&gt; {}, &lt;br&gt; &lt;br&gt; &lt;b&gt;Type:&lt;/b&gt; {}, &lt;br&gt; &lt;br&gt; &lt;b&gt;Demand:&lt;/b&gt; {} kWh/year, &lt;br&gt; &lt;br&gt; &lt;b&gt;".format(row["fcname"], row["fctype"], row["HF_kWh"]),<br/>                        fill = True,<br/>                        fill_opacity=0).add_to(map_dem)<br/><br/># We define the limits of the legend and fix its printout format<br/># We use branca module to create a colormap legend and then add legend to the map<br/>min_dem = HF["HF_kWh"].min()<br/>max_dem = HF["HF_kWh"].max()<br/>min_dem = float("{0:.2f}".format(min_dem))<br/>max_dem = float("{0:.2f}".format(max_dem))<br/>legend = cm.LinearColormap(['#ADFF2F','#32CD32','#228B22','#008000','#006400','#000000'], <br/>                           index=None, vmin=min_dem, vmax=max_dem)<br/>legend.add_to(map_dem)  <br/><br/>expl_text = '#ADFF2F:1, #32CD32:2, #228B22:3, #008000:4, #006400:5'<br/>iframe = folium.IFrame(expl_text, width=700, height=450)<br/>popup = folium.Popup(iframe, max_width=3000)<br/><br/>Text = folium.Marker(location=[x_ave,y_ave], popup=popup,<br/>                     icon=folium.Icon(icon_color='green'))<br/>map_dem.add_child(Text)<br/><br/># Create a new directory where the map(s) can be saved<br/>try:<br/>    os.makedirs('maps')<br/>except FileExistsError:<br/>    pass<br/><br/>map_dem_output = 'maps/map_{}_{}.html'.format("Health_Facilities", "Mecanhelas")<br/>map_dem.save(map_dem_output)</span><span id="a4ec" class="nb kx iq no b gy nw nt l nu nv"># Publish map on datapane for easier rendering in websites<br/>dp.Report(dp.Plot(map_dem)).publish(name='HF_elec_demand_Mecanhelas', visibility='PUBLIC')</span><span id="5c23" class="nb kx iq no b gy nw nt l nu nv"># Add the link that leads to the final map output<br/>display(Markdown('&lt;a href="{}" target="_blank"&gt;Click here to render the map of electrification of health facilities &lt;/a&gt;'.format(map_dem_output)))</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">莫桑比克Mecanhelas卫生设施的位置和预计电力需求。作者地图—通过数据面板呈现—查看完整报告<a class="ae kv" href="https://datapane.com/alexandros/reports/HF_elec_demand_Mecanhelas" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></figure><h1 id="db85" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">第四步。将医疗机构目标电力需求分配回人口集群</h1><p id="907b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">每个医疗机构的电力需求被分配给最近的集群。</p><h2 id="1617" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">查找最近的聚类</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="2a54" class="nb kx iq no b gy ns nt l nu nv">HF["id"] = HF.apply(calculate_nearest, destination=clusters_centroid, val="id", axis=1)</span></pre><h2 id="bde7" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">将结果合并到初始聚类</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="857d" class="nb kx iq no b gy ns nt l nu nv">clusters_gdf = gpd.read_file(clusters_path + "\\" + clusters_name)</span><span id="29e8" class="nb kx iq no b gy nw nt l nu nv">final_clusters_HF_kWh = HF.merge(clusters_gdf, how="outer", on='id')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/af9b3c4b3ec440ced7916fe47e34e5de.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Xh2XmD24ZCGUMTmz9BRFZg.png"/></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="00d9" class="kw kx iq bd ky kz mr lb lc ld ms lf lg jw mt jx li jz mu ka lk kc mv kd lm ln bi translated">第五步。映射结果并导出更新的人口聚类数据集</h1><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="f07c" class="nb kx iq no b gy ns nt l nu nv">final_clusters_HF_kWh_gdf = gpd.GeoDataFrame(final_clusters_HF_kWh, geometry='geometry', crs={'init': 'epsg:4326'})</span><span id="bf50" class="nb kx iq no b gy nw nt l nu nv"># Create the axis first<br/>fig, ax = plt.subplots(figsize=(10, 10))<br/><br/>admin_gdf.plot(ax=ax, edgecolor='brown', alpha=0.2)<br/><br/>final_clusters_HF_kWh_gdf.sort_values('HF_kWh', ascending=True).plot(ax=ax, column='HF_kWh',<br/>                           legend=True, markersize=3, cmap="viridis",<br/>                           figsize=(10, 10), alpha=0.5)<br/><br/>ax.set_aspect('equal', 'box')<br/>txt = ax.set_title('Electricity requirements (kWh/year) for HF in Mecanhelas'.format(""))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl oe"><img src="../Images/da7611586aa0fad514744441d90f5cca.png" data-original-src="https://miro.medium.com/v2/format:webp/1*wY6MOhgObDqUoHoVUPogjw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="9dbd" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">将图层导出为地理包</h2><pre class="kg kh ki kj gt nn no np nq aw nr bi"><span id="63d6" class="nb kx iq no b gy ns nt l nu nv">final_clusters_HF_kWh_gdf.to_file("Mecanhelas_HF_kWh.gpkg", driver="GPKG")</span></pre><blockquote class="nx ny nz"><p id="2d84" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated">请注意，本例中给出的方法和结果<strong class="lq ir">仅是说明性的</strong>；仅显示空间分析如何用于支持类似的规划活动。</p></blockquote><h1 id="5b80" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结束语</h1><p id="1bdc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是一种探索性的方法，仅基于现有的开放访问数据集。因此，对于量化撒南地区卫生设施电力需求的尝试，它只能提供一个粗略的“第一步”，特别是在没有太多数据的偏远农村地区。</p><p id="95ac" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">这种分析当然可以通过以下方式得到改进:</p><ul class=""><li id="f034" class="of og iq lq b lr mw lu mx lx oh mb oi mf oj mj ok ol om on bi translated">利用地理定位卫生设施的更好属性数据；此类数据集可能已经存在于国家机构中，如人口普查局/部门、公共统计局、国家调查和制图机构以及其他部门/部委。</li><li id="5a37" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ok ol om on bi translated">与目标地区健康和能源实践的当地利益相关者密切合作，以便更好地校准和/或改进此处介绍的方法。</li><li id="b9d9" class="of og iq lq b lr oo lu op lx oq mb or mf os mj ok ol om on bi translated">相应地，使用详细的调查数据(如果可用)和机器学习来改进分类和对卫生设施的类型和电力需求的预测。</li></ul><p id="2ddd" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">如果结果令人满意，最终产品(包括卫生设施电力需求的人口集群)可用于地理空间电气化模型，以制定成本最低的投资计划。一个例子是<a class="ae kv" href="https://github.com/global-electrification-platform/gep-onsset" rel="noopener ugc nofollow" target="_blank">GEP-昂塞特模型</a>，它最近被修改以允许包含电力的生产性使用。</p><p id="c1d1" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">作为参考，您可以查看以下地图，这些地图显示了莫桑比克医疗机构和/或相关人群的最低成本电气化方案。</p><blockquote class="nx ny nz"><p id="79ef" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated"><strong class="lq ir">注意！！</strong>下面的结果是<strong class="lq ir">只是说明性的</strong>。</p></blockquote><p id="c91f" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir">地图1 </strong>:莫桑比克医疗机构的位置，包括其成本最低的电气化技术(结果以弹出形式提供)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者地图—通过数据面板呈现—查看完整报告<a class="ae kv" href="https://datapane.com/alexandros/reports/HF_elec_demand_Mozambique" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></figure><p id="5844" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated"><strong class="lq ir">地图2: </strong>与莫桑比克一个或多个医疗机构相关的人口集群的最低成本电气化计划(结果以医疗机构弹出窗口和集群工具提示的形式提供)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou ov l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者地图—通过数据面板呈现—查看完整报告<a class="ae kv" href="https://datapane.com/alexandros/reports/Clusters_elec_demand_Mozambique" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></figure><h1 id="72db" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">支持材料的链接</h1><p id="3455" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">要快速浏览支持这个博客的方法和代码，你可以看看<a class="ae kv" href="https://nbviewer.jupyter.org/gist/akorkovelos/baef0f0377f24c60a540b78fbb1bf227" rel="noopener ugc nofollow" target="_blank"> nbviewer </a>。</p><p id="4c05" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">或者你可以在<a class="ae kv" href="https://github.com/akorkovelos/gep_health_facilities" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上访问(并贡献)完整版本的代码。</p><p id="4c97" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">这项工作是支持<a class="ae kv" href="https://electrifynow.energydata.info/" rel="noopener ugc nofollow" target="_blank">全球电气化平台</a>开发的多年研究工作的一部分。</p><p id="76a6" class="pw-post-body-paragraph lo lp iq lq b lr mw jr lt lu mx ju lw lx my lz ma mb mz md me mf na mh mi mj ij bi translated">感谢阅读！</p><blockquote class="nx ny nz"><p id="44ff" class="lo lp oa lq b lr mw jr lt lu mx ju lw ob my lz ma oc mz md me od na mh mi mj ij bi translated">特别感谢Benjamin Stewart、Ashish Shrestha、Rhonda Lenai Jordan、Nicolina Erica Maria Lindblad、Babak Khavari、Andreas Sahlberg和Mark Howells，他们都支持这项工作。</p></blockquote></div></div>    
</body>
</html>