<html>
<head>
<title>Graph classification by computer vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉的图形分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/graph-classification-by-computer-vision-286572aaa750?source=collection_archive---------37-----------------------#2020-11-06">https://towardsdatascience.com/graph-classification-by-computer-vision-286572aaa750?source=collection_archive---------37-----------------------#2020-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="42e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">如今，图形分析变得越来越流行，但是与计算机视觉方法相比，它的表现如何？我们将展示，虽然计算机视觉模型的训练速度慢得多，但与图论相比，它们的表现相当好。</p><ul class=""><li id="94d3" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">Github回购与所有代码，<a class="ae ld" href="https://github.com/Diyago/Graph-clasification-by-computer-vision" rel="noopener ugc nofollow" target="_blank">链接</a></li></ul><h1 id="4612" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">图形分析</h1><p id="842c" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">一般来说，图论表示对象之间的成对关系。我们不会在这里留下太多的细节，但你可以考虑它的某种网络如下:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mh"><img src="../Images/0ff0e6a1dff3ac5e16485619041d2ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p8PG01is5C-9zgCs"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">网络。照片由<a class="ae ld" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿丽娜·格鲁布尼亚</a>在<a class="ae ld" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="bac6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们需要知道的要点是，通过用边连接对象，我们可以可视化图形。然后我们将能够使用经典的计算机视觉模型。不幸的是，我们可能会丢失一些初始信息。例如，图表可能包含不同类型的对象、连接，在2D也许不可能把它可视化。</p><h2 id="1854" class="mx lf iq bd lg my mz dn lk na nb dp lo jy nc nd ls kc ne nf lw kg ng nh ma ni bi translated">图书馆</h2><p id="48f9" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">如果您愿意开始使用它们，您可以查看大量的库:</p><ul class=""><li id="3143" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><a class="ae ld" href="https://networkx.org/" rel="noopener ugc nofollow" target="_blank"> networkx </a> —经典算法，可视化</li><li id="7f88" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://github.com/rusty1s/pytorch_geometric" rel="noopener ugc nofollow" target="_blank">pytorch _ geometric</a>—SOTA算法图，py torch之上的一个框架</li><li id="6f37" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://graph-tool.skewed.de/" rel="noopener ugc nofollow" target="_blank">图形工具</a> —经典算法、可视化</li><li id="6ffa" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://scikit-network.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> scikit-network </a> —经典算法，sklearn like API</li><li id="928c" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://www.tensorflow.org/graphics" rel="noopener ugc nofollow" target="_blank">TensorFlow Graphics</a>—SOTA算法图，一个基于tensor flow的框架</li></ul><p id="3b28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">都是针对自己的特定角色。这就是为什么它取决于你的任务使用哪一个。</p><p id="c3bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">理论</strong></p><p id="2b28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章更多的是针对实际应用，这就是为什么对于理论我将只留下一些链接:</p><ul class=""><li id="d9b3" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><a class="ae ld" href="http://Hands-on Graph Neural Networks with PyTorch &amp; PyTorch Geometric" rel="noopener ugc nofollow" target="_blank">用PyTorch的手动图形神经网络&amp; PyTorch几何</a></li><li id="ed59" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="http://web.stanford.edu/class/cs224w/" rel="noopener ugc nofollow" target="_blank"> CS224W:带图的机器学习</a></li><li id="e44b" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated">图分类将基于图卷积网络(GCN)，<a class="ae ld" href="https://arxiv.org/abs/1609.02907" rel="noopener ugc nofollow" target="_blank"> arxiv链接</a></li></ul><h2 id="621b" class="mx lf iq bd lg my mz dn lk na nb dp lo jy nc nd ls kc ne nf lw kg ng nh ma ni bi translated">模型架构</h2><p id="77f9" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们将使用以下架构作为基线:</p><pre class="mi mj mk ml gt no np nq nr aw ns bi"><span id="0efa" class="mx lf iq np b gy nt nu l nv nw">* GCNConv - 6 blocks<br/>* JumpingKnowledge for aggregation sconvolutions<br/>* global_add_pool with relu<br/>* Final layer is softmax</span></pre><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="a4a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码<a class="ae ld" href="https://github.com/Diyago/Graph-clasification-by-computer-vision/tree/main/models" rel="noopener ugc nofollow" target="_blank">链接</a>就是基于这个<a class="ae ld" href="http://pages.di.unipi.it/citraro/files/slides/Landolfi_tutorial.pdf" rel="noopener ugc nofollow" target="_blank">教程</a>。</p><h1 id="d703" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">计算机视觉</h1><p id="45fb" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">通过阅读本文，您将获得所有必需的理论和技术技能:</p><ul class=""><li id="fa99" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><a class="ae ld" rel="noopener" target="_blank" href="/guide-to-learn-computer-vision-in-2020-36f19d92c934">2020年指导如何学习和掌握计算机视觉</a></li></ul><p id="2709" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，您应该熟悉以下主题:</p><ul class=""><li id="6f45" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">效率网<a class="ae ld" href="https://arxiv.org/abs/1905.11946" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1905.11946</a></li><li id="b351" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated">焦损失<a class="ae ld" href="https://arxiv.org/abs/1708.02002" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1708.02002</a></li><li id="838e" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://github.com/albumentations-team/albumentations" rel="noopener ugc nofollow" target="_blank">白蛋白</a> —扩增库</li><li id="4d9b" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk kz la lb lc bi translated"><a class="ae ld" href="https://github.com/PyTorchLightning/pytorch-lightning" rel="noopener ugc nofollow" target="_blank">py torch-lightning</a>—py torch框架</li></ul><h2 id="52c9" class="mx lf iq bd lg my mz dn lk na nb dp lo jy nc nd ls kc ne nf lw kg ng nh ma ni bi translated">模型架构</h2><p id="036d" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们将使用以下没有任何超参数调整的模型:</p><pre class="mi mj mk ml gt no np nq nr aw ns bi"><span id="ecc8" class="mx lf iq np b gy nt nu l nv nw">* efficientnet_b2b as encoder<br/>* FocalLoss and average precision as early stopping criteria<br/>* TTA with flip left right and up down<br/>* Augmentation with albumentation<br/>* Pytorch-lightning as training model framework<br/>* 4 Folds Assembling<br/>* mixup</span></pre><p id="02e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码<a class="ae ld" href="https://github.com/Diyago/Graph-clasification-by-computer-vision/blob/main/fit_predict_graph.py#L48" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><h1 id="43ab" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">实验</h1><h2 id="7b88" class="mx lf iq bd lg my mz dn lk na nb dp lo jy nc nd ls kc ne nf lw kg ng nh ma ni bi translated">数据</h2><p id="c91c" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我们将预测活动(针对COVID？)的不同分子。</p><p id="21e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据集示例:</p><pre class="mi mj mk ml gt no np nq nr aw ns bi"><span id="2efc" class="mx lf iq np b gy nt nu l nv nw">smiles, activity<br/>OC=1C=CC=CC1CNC2=NC=3C=CC=CC3N2, 1<br/>CC(=O)NCCC1=CNC=2C=CC(F)=CC12, 1<br/>O=C([C@@H]1[C@H](C2=CSC=C2)CCC1)N, 1</span></pre><p id="d607" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了生成用于计算机视觉方法的图像，我们首先将图形转换为<em class="nz"> networkx </em>格式，然后通过调用<em class="nz"> draw_kamada_kawai </em>函数获得所需的图像:</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="nx ny l"/></div></figure><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi oa"><img src="../Images/d708474ef0315cb197d900f29b555945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y9zdWyG-_PmepaRbDfdn1w.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">不同的分子可视化将用于计算机视觉方法。图片由Insaf Ashrapov提供</p></figure><p id="cd00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">链接到<a class="ae ld" href="https://github.com/yangkevin2/coronavirus_data/raw/master/data/mpro_xchem.csv" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><h2 id="6d22" class="mx lf iq bd lg my mz dn lk na nb dp lo jy nc nd ls kc ne nf lw kg ng nh ma ni bi translated">实验结果</h2><pre class="mi mj mk ml gt no np nq nr aw ns bi"><span id="c08f" class="mx lf iq np b gy nt nu l nv nw">TEST</span><span id="e209" class="mx lf iq np b gy ob nu l nv nw">Computer vision<br/><br/>**Test**<br/>* ROC AUC 0.697<br/>* MAP 0.183<br/><br/>Graph method<br/><br/>**Test**<br/>* ROC AUC 0.702<br/>* MAP 0.199</span></pre><p id="081d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为你可以得到几乎相似的结果。图表法得到的结果稍高一些。此外，训练GNN只需1分钟，CNN只需30分钟。我不得不说:这只是一个概念验证项目，有许多简化。</p><p id="424b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">换句话说，你可以可视化图形，训练著名的计算机视觉模型，而不是新奇的GNN。</p><h1 id="6cd8" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">参考</h1><ol class=""><li id="ab64" class="ku kv iq jp b jq mc ju md jy oc kc od kg oe kk of la lb lc bi translated">Github repo与Insaf Ashrapov的所有代码<a class="ae ld" href="https://github.com/Diyago/Graph-clasification-by-computer-vision" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="29bb" class="ku kv iq jp b jq nj ju nk jy nl kc nm kg nn kk of la lb lc bi translated">GNN教程<a class="ae ld" href="http://pages.di.unipi.it/citraro/files/slides/Landolfi_tutorial.pdf" rel="noopener ugc nofollow" target="_blank">http://pages . di . unipi . it/citraro/files/slides/Lando lfi _ tutorial . pdf</a></li></ol></div></div>    
</body>
</html>