<html>
<head>
<title>Movie Recommender System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电影推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/movie-recommender-system-a5dbfdb2585d?source=collection_archive---------21-----------------------#2020-10-29">https://towardsdatascience.com/movie-recommender-system-a5dbfdb2585d?source=collection_archive---------21-----------------------#2020-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="772a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于(1)基于记忆的协同过滤，(2)矩阵分解协同过滤和(3)基于神经的协同过滤的电影推荐系统的比较。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c5812c2dfdca693158d5feb56d1f5315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3SBOGpZQpwQ8MHYED7EyQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae kv" href="https://unsplash.com/s/photos/remote-control-and-tv?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9ae2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">互联网的发展给我们带来了大量的在线数据和信息。像推荐系统这样的工具允许我们过滤我们想要或需要的信息。推荐系统可以在许多环境中使用，其中之一是用于视频或音乐服务的播放列表生成器。</p><p id="5961" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个项目中，我选择了基于K-近邻(k-NN)、矩阵分解(MF)以及基于神经网络的方法来构建电影推荐系统。我选择研究的数据是由GroupLens Research收集的<a class="ae kv" href="https://grouplens.org/datasets/movielens/" rel="noopener ugc nofollow" target="_blank"> MovieLens </a>数据集。这个<a class="ae kv" href="https://grouplens.org/datasets/movielens/100k/" rel="noopener ugc nofollow" target="_blank">数据集</a>有943个用户对1682部电影给出的100，000个评价，每个用户至少评价了20部电影。等级是基于从1到5的范围。</p><p id="4d51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">评级构成了来自用户的显式响应，这将用于随后构建基于协作的过滤系统。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/b3f866f3806586db49166e4d31319e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUw1SeU95EECk9mVIqqlpQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">查尔斯·德鲁维奥在<a class="ae kv" href="https://unsplash.com/s/photos/movies?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2f99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该项目分为三个阶段:</p><ol class=""><li id="33ac" class="lt lu iq ky b kz la lc ld lf lv lj lw ln lx lr ly lz ma mb bi translated">数据预处理</li><li id="0707" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">模型结构</li><li id="2bc3" class="lt lu iq ky b kz mc lc md lf me lj mf ln mg lr ly lz ma mb bi translated">结果分析和结论</li></ol><p id="c9a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于k-NN和基于MF的协同过滤—数据预处理</strong></p><p id="8692" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于基于k-NN和基于MF的模型，使用了来自Surprise Python sci-kit的内置数据集ml-100k。惊奇是一个很好的选择，开始了解推荐系统。它适用于构建和分析处理显式评级数据的推荐系统。</p><p id="1f63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于k-NN的协同过滤——建模</strong></p><p id="64c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据分为75%的训练测试样本和25%的维持样本。GridSearchCV执行5次以上，用于为预测算法寻找相似性度量配置(sim_options)的最佳集合。它使用准确性度量作为基础，通过交叉验证过程找到sim_options的各种组合。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/d1d43abd087452aa57ab84a73966d6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDENlsV_RpyvAqWWofjOEg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="ea16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在k-NN模型中，我选择使用余弦相似度作为相似性度量。这将计算所有用户对(或项目)之间的余弦相似性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/4258b8598b8792f768bcff96693343fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyvndjPb93Da9-uE_eItKw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="1fd2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上图是基于协作的过滤(基于用户)的简单说明。</p><p id="d9c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它显示了三个用户Maria、Sally和Kim，以及他们对电影A和b的评级。k-NN模型试图预测Sally对电影C的评级(Sally尚未对电影C进行评级)。</p><p id="682a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，它首先需要找到一个与Sally相似的用户。从电影A和B的评级来看，基于余弦相似度，玛丽亚与莎莉的相似度大于金与莎莉的相似度。</p><p id="0880" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，该模型将根据玛丽亚对电影C的评级来预测莎莉对电影C的评级。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/8c27961ccd398af8818b64529173fb5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5NPojzUpZIg4ClzpLiFUg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者照片</p></figure><p id="7fa2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上图是基于协作的过滤(基于项目)的简单说明。</p><p id="bd57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它显示了用户Maria和Kim对三部电影A、B和C的评级。当Sally已经对电影A和b进行了分级时，k-NN模型试图预测Sally对电影C的分级(尚未分级)</p><p id="2c6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从玛丽亚和金对电影A、B和C的评级来看，基于余弦相似度，电影A与电影C的相似度大于电影B与电影C的相似度。</p><p id="ce75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，该模型将根据Sally对电影a的评价来预测Sally对电影C的评价。</p><p id="449f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GridSearchCV将根据均方根误差(RMSE)找出基于用户还是基于项目的结果精度最高。</p><p id="d46c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个模型使用的算法是KNNWithMeans。这是一个基本的协同过滤算法，考虑了每个用户的平均评级。通过这种算法消除他们的偏见，个人用户偏好被考虑在内。</p><p id="3376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于GridSearch CV，RMSE值为0.9551。维持样本的RMSE值为0.9402。MSE和MAE值分别为0.884和0.742。</p><p id="acbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于MF的协同过滤——建模</strong></p><p id="cde2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">矩阵分解根据潜在因素将用户项目矩阵压缩成低维表示。这些潜在因素提供了关于用户和项目的隐藏特征。用户与项目的交互被建模为他们潜在向量的乘积。</p><p id="7bf7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用的基于MF的算法是奇异向量分解(SVD)。GridSearchCV用于寻找随机梯度下降过程的迭代次数、学习速率和正则化项的最佳配置。</p><p id="cc43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于GridSearch CV，RMSE值为0.9530。维持样本的RMSE值为0.9430。MSE和MAE值分别为0.889和0.754。</p><p id="8f8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于神经的协同过滤—数据预处理</strong></p><p id="0e12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由用户、电影、收视率和时间戳组成的数据文件被读入pandas数据帧进行数据预处理。</p><p id="9e93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">需要枚举电影和用户来用于建模。创建包含数据中唯一用户和电影总数的变量，然后映射回电影id和用户id。</p><p id="ec57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">找到数据中存在的最小和最大额定值。然后将评级标准化，以便于训练模型。</p><p id="81dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于神经的协同过滤—建模</strong></p><p id="36e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嵌入用于在数据中表示每个用户和每部电影。这些嵌入将具有由模型拟合的向量大小n，以捕捉每个用户/电影的交互。</p><p id="bed7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">用户和电影都被嵌入到50维(n = 50)数组向量中，用于训练和测试数据。对75%的数据进行训练，对25%的数据进行测试。</p><p id="1854" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了捕捉用户-电影交互，计算用户向量和电影向量之间的点积，以获得预测的评级。</p><p id="f7c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Adam优化器用于最小化预测值和实际测试值之间的精度损失。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/8a0484e7cae4049ba302de5ef5c1f419.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*gKN9DEChVNXHQf0ARhTrmA.png"/></div></figure><p id="198c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从训练和验证损失图可以看出，基于神经网络的模型具有很好的拟合性。训练损失曲线已经下降到一个稳定点。验证(测试)损失曲线也下降到一个稳定点，与训练损失有一个小的差距。</p><p id="131f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来自基于神经的模型的MSE和MAE值是0.075和0.224。</p><p id="ab1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结果和结论</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/ccb095cce1d50264f3e24d7f3b344b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2o9ghjFi2GyvnsF8aSVIdw.png"/></div></div></figure><p id="8ff2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与基于记忆的k-NN模型和基于矩阵分解的SVD模型相比，基于神经的协同过滤模型显示出最高的准确度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/1b8cbee7be98c79d6f2b2f2ebeeb2afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*p2CP9UCxiIzhXDGzGI-3Jw.png"/></div></figure><p id="7a9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的图像显示了用户838在过去评价很高的电影以及基于神经的模型推荐的电影。</p><p id="a381" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个<a class="ae kv" href="https://github.com/syleo22/SiuYin_Projects/tree/master/Project04" rel="noopener ugc nofollow" target="_blank">链接</a>到我的GitHub，在那里你可以找到我的代码和演示幻灯片。也可以通过<a class="ae kv" href="https://www.linkedin.com/in/syleo/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>