<html>
<head>
<title>Ruining Sudoku — A Data Science project (Part 2: Data Preprocessing)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破坏数独——一个数据科学项目(第2部分:数据预处理)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ruining-sudoku-a-data-science-project-part-2-data-preprocessing-27a290803c48?source=collection_archive---------58-----------------------#2020-10-19">https://towardsdatascience.com/ruining-sudoku-a-data-science-project-part-2-data-preprocessing-27a290803c48?source=collection_archive---------58-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/adf2a7b1365d7e6589a76d1e0d6ab5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*d22mhQuyXlHyn504Sdxt2Q.jpeg"/></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">在数据预处理中，您可以对输入图像进行调整，以便在后续步骤中使用。万一你觉得还没准备好，害怕把事情搞砸，记住这个发生的<strong class="bd jy">。<br/><a class="ae jz" href="https://www.flickr.com/photos/33255628@N00/7923536516" rel="noopener ugc nofollow" target="_blank">Ecce Home，前、后、后</a>After by<a class="ae jz" href="https://www.flickr.com/photos/33255628@N00" rel="noopener ugc nofollow" target="_blank">Cea。</a>由2.0 在<a class="ae jz" href="https://creativecommons.org/licenses/by/2.0/?ref=ccsearch&amp;atype=rich" rel="noopener ugc nofollow" target="_blank"> CC下授权</a></strong></p></figure><p id="2070" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">欢迎来到本系列文章的第二篇,该系列文章致力于如何利用数据科学作为惹恼一位不愉快的亲戚的借口！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="4508" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">摘要</h1><p id="8fc8" class="pw-post-body-paragraph ka kb iq kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ij bi translated">本文是系列文章的一部分:</p><ul class=""><li id="e641" class="mi mj iq kc b kd ke kh ki kl mk kp ml kt mm kx mn mo mp mq bi translated"><a class="ae jz" rel="noopener" target="_blank" href="/ruining-sudoku-a-data-science-project-part-1-introduction-and-project-design-160a3c5caee5">第一部分:简介和项目设计</a></li><li id="f0d3" class="mi mj iq kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq bi translated">第2部分:数据预处理—您正在阅读它！</li><li id="3f7c" class="mi mj iq kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq bi translated"><a class="ae jz" href="https://medium.com/@matteo.a.barbieri/ruining-sudoku-a-data-science-project-part-3-digits-recognition-and-sudoku-solver-5271e6acd81f" rel="noopener">第三部分:数字识别和数独解算器</a></li><li id="19ee" class="mi mj iq kc b kd mr kh ms kl mt kp mu kt mv kx mn mo mp mq bi translated"><a class="ae jz" rel="noopener" target="_blank" href="/ruining-sudoku-a-data-science-project-part-4-deployment-and-retro-27620bbeca75">第4部分:部署和追溯</a></li></ul></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="719a" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">在第1部分<a class="ae jz" rel="noopener" target="_blank" href="/ruining-sudoku-a-data-science-project-part-1-introduction-and-project-design-160a3c5caee5">中，我们经历了项目计划，也就是通过迭代地将它们分割成更小、更易管理的子任务，列出完成项目所需的所有任务。在本文中，我们将讨论在输入数据(在本例中是图像)被传递到管道的下一步，即数字分类器之前，需要对其进行什么处理。</a></p><h1 id="6909" class="lf lg iq bd lh li mw lk ll lm mx lo lp lq my ls lt lu mz lw lx ly na ma mb mc bi translated">图像预处理</h1><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nb"><img src="../Images/cc6dad4b2022d2088bd676bbcc259abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dbVh_TzczxFYLfDgM-0rAw.jpeg"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">数据预处理任务的分解。<br/>作者图片</p></figure><p id="224f" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">为了决定图像必须经过什么样的转换，有必要了解下一个组件(数字分类器)将需要什么样的格式。对于我们的例子，因为我们计划使用基于MNIST数据集的图像分类器，所以格式是28 x 28 <strong class="kc ir">灰度</strong>图像，只包含一个数字。</p><p id="54c4" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">如果输入图像只包含数独网格(我们将它分成9行9列)，识别81个单元格将是一个相对琐碎的任务<em class="nk">。然而，事实并非如此:理想情况下，我们希望用户能够用手机拍一张照片，然后传给应用程序。</em></p><p id="0ef8" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">因此，我们需要一个额外的步骤，将网格从页面的其余内容中分离出来，补偿旋转，并裁剪边界。然而，要做到这一点，我们首先必须对图像进行一些标准调整，以便于下面的步骤。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nl"><img src="../Images/b875cbc9fc98625c63d9feea0f5f3bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q-jQN0lb5TImIP8NtQ-16Q.jpeg"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">原始输入图像。<br/>作者图片</p></figure><p id="d75c" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">对图像的初始调整包括使用<em class="nk">高斯滤波器</em>和<em class="nk">阈值</em>的一些基本去噪，以去除大部分缺陷并获得<em class="nk">二进制图像</em>。我们还将<em class="nk">反转</em>颜色，因为这是用于执行几何操作的算法的要求，我们将使用该算法来检测网格并扭曲图像，使其最终成为正方形。</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nl"><img src="../Images/300a7edd12748af3eaa643df74407929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULAjQifz7ERQtGcbEkZNLA.png"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">基本预处理(高斯滤波和阈值处理)后的输入图像。<br/>作者图片</p></figure><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="42f7" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">然后，我们必须首先确定网格所在的区域，然后应用所需的变换将其扭曲成正方形。这分两步完成，最终结果是这样的:</p><figure class="nc nd ne nf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi no"><img src="../Images/266a9f3787f242937c742ef36f6eb851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbztMrZher1067dRVeqS-Q.png"/></div></div><p class="ju jv gj gh gi jw jx bd b be z dk translated">扭曲和裁剪后从图像中提取的网格。<br/>作者图片</p></figure><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="nc nd ne nf gt jr"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="005b" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">此时，将图像分割成81个单元格是微不足道的。任务完成[几乎]！</p><h1 id="1e40" class="lf lg iq bd lh li mw lk ll lm mx lo lp lq my ls lt lu mz lw lx ly na ma mb mc bi translated">能偷多少就偷多少</h1><p id="1b53" class="pw-post-body-paragraph ka kb iq kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ij bi translated">关于时间管理的重要说明:上面的大部分代码不是我写的，而是取自各种来源，要么是stackoverflow评论，要么是quadrillions之一“用深度学习解决数独！”在媒体上或其他地方的教程。见鬼，我甚至不完全理解它的某些部分，我只是玩玩它，直到我足够信任它可以工作，并且在这个过程中不会烧坏我的电脑。</p><p id="2e58" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">在这个星球上生活了36年，看了无数集《神秘博士》,我明白了一件事:时间是一种资源，通常情况下，你没有足够的时间。所以请允许我尽可能明确地说:</p><blockquote class="np"><p id="5765" class="nq nr iq bd ns nt nu nv nw nx ny kx dk translated">不要重新发明该死的轮子。</p></blockquote><p id="b560" class="pw-post-body-paragraph ka kb iq kc b kd nz kf kg kh oa kj kk kl ob kn ko kp oc kr ks kt od kv kw kx ij bi translated">如果一个任务足够具体，很可能在某个黑暗的房间里已经有人写了一段代码来解决它。所以去抓住它，而不是花几个小时自己实现它。</p><h1 id="e4cf" class="lf lg iq bd lh li mw lk ll lm mx lo lp lq my ls lt lu mz lw lx ly na ma mb mc bi translated">最后一笔</h1><p id="8704" class="pw-post-body-paragraph ka kb iq kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ij bi translated">快好了。我们仍然有一个问题:如果你只是通过将图像水平和垂直划分为9个部分来分割图像，其中一些可能会包含部分边界，如果你的数字分类器不是最擅长的，这可能会是一个问题。</p><p id="f308" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">看着你，<em class="nk">字面上任何训练有素的分类器对MNIST </em>。</p><p id="898c" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">因此，在我们进入有趣的部分之前，我们消耗了大量的精力，只是为了看到Karen阿姨脸上的笑容消失，花几行代码来识别并从网格中删除剩菜是一个好主意。</p><div class="nc nd ne nf gt ab cb"><figure class="oe jr of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><img src="../Images/30e1a175af126640222ca2373662822f.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*4WWljj3RJnI-8Tbuxpy9Bw.png"/></div></figure><figure class="oe jr ok og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><img src="../Images/c78ca34e4479228df543eeea090e413a.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*rKEdAJnPGwAlDV9KRtjiow.png"/></div></figure><figure class="oe jr ok og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><img src="../Images/79e73e7df66ba1ad181e50671c673854.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*TNOktnDIKfoA_V8k4U3jPw.png"/></div><p class="ju jv gj gh gi jw jx bd b be z dk ol di om on translated">最后的预处理步骤:从原始单元格(左)中，我们首先从网格中删除可能保留的块(中)，最后将其大小调整为28 x 28像素(右)，因为这是我们将要使用的分类器的预期图像大小。<br/>作者图片</p></figure></div><h1 id="7270" class="lf lg iq bd lh li mw lk ll lm mx lo lp lq my ls lt lu mz lw lx ly na ma mb mc bi translated">就这些了，伙计们</h1><p id="9486" class="pw-post-body-paragraph ka kb iq kc b kd md kf kg kh me kj kk kl mf kn ko kp mg kr ks kt mh kv kw kx ij bi translated">暂时就这样了。你可以找到我在<a class="ae jz" href="https://github.com/matteobarbieri/sudoku" rel="noopener ugc nofollow" target="_blank">这个仓库</a>中使用的jupyter笔记本，然而上面的要点涵盖了所有必要的(和有趣的部分)。</p><p id="566d" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">下周，是时候我们打开图形处理器，让神经元滚动:没有数字会保持不被识别。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="54a4" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">[1]我们最终将使用与略有不同的东西<em class="nk">，但在我计划的时候，这似乎是一个合理的选择，所以我暂时这么称呼它。</em></p><p id="6043" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">[2]我开始尝试复杂的东西，结果每边只剪了10%左右。很管用。</p></div></div>    
</body>
</html>