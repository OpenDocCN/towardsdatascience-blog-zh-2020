<html>
<head>
<title>Zero-Shot Text Classification &amp; Evaluation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零镜头文本分类和评估</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/zero-shot-text-classification-evaluation-c7ba0f56688e?source=collection_archive---------16-----------------------#2020-09-18">https://towardsdatascience.com/zero-shot-text-classification-evaluation-c7ba0f56688e?source=collection_archive---------16-----------------------#2020-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="d369" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最近，零镜头文本分类由于其简单性引起了人们极大的兴趣。在这篇文章中，我们将看到如何使用零镜头文本分类和任何标签，并解释背景模型。然后，我们将在情感分析、新闻分类和情感分类中使用人工标注数据集来评估它的性能。</p><p id="aacd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">零镜头文本分类</strong></p><p id="e352" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在零镜头文本分类中，该模型可以在没有任何先验数据的情况下对给定标签之间的任何文本进行分类。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/37cb7a8dbd489ca5443ddba0c199d3ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dcFVCKjxy2oBr7JF.jpg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">白板(图片由<a class="ae le" href="https://en.wikipedia.org/wiki/Tabula_rasa" rel="noopener ugc nofollow" target="_blank">维基百科</a>提供)</p></figure><p id="4f90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用零触发文本分类，可以执行:</p><ul class=""><li id="7444" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated">情感分析</li><li id="0d5e" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">新闻分类</li><li id="3d0e" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated">情感分析</li></ul><h1 id="b9be" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">背景</strong></h1><p id="4b67" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">实际上，零镜头文本分类的最新实现源于一个非常简单但非常棒的想法。自然语言处理中有一个领域叫做自然语言推理(NLI)。这个领域研究一个假设对于一个给定的前提是真的(蕴涵)，假的(矛盾)，还是不确定的(中性)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/818d0ffddfc7c56b24327f16aed56b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*nZJ_zCz_upBbKOBf7mQp1g.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">监督NLI系统</p></figure><p id="8dae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们假设我们的文本是<em class="mx">“我爱这部电影。”</em>我们想要预测候选标签<em class="mx">正</em>和<em class="mx">负</em>之间的文本的情感。我们将这两个假设-前提对给已经训练好的NLI模型，并检验结果。</p><blockquote class="my mz na"><p id="7ac4" class="jq jr mx js b jt ju jv jw jx jy jz ka nb kc kd ke nc kg kh ki nd kk kl km kn im bi translated"><em class="it">前提:</em>我爱这部电影。<br/> <em class="it">假设-1: </em>本例为<strong class="js iu">正</strong>。</p><p id="2ee5" class="jq jr mx js b jt ju jv jw jx jy jz ka nb kc kd ke nc kg kh ki nd kk kl km kn im bi translated"><em class="it">前提:</em>我爱这部电影。<br/> <em class="it">假设——2:</em>这个例子是<strong class="js iu">否定</strong>。</p></blockquote><p id="cd55" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基本上，它为每个类别创建“此示例是…”的假设模板，以预测前提的类别。如果推论是蕴涵，就意味着前提属于那个类。在这种情况下，它是积极的。</p><h1 id="8002" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">代码</strong></h1><p id="3abc" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">得益于HuggingFace，可以通过<a class="ae le" href="https://huggingface.co/transformers/main_classes/pipelines.html#transformers.ZeroShotClassificationPipeline" rel="noopener ugc nofollow" target="_blank">管道模块</a>轻松使用。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="d2c3" class="nj lu it nf b gy nk nl l nm nn">#!pip install transformers datasets<br/>from transformers import pipeline</span><span id="88f5" class="nj lu it nf b gy no nl l nm nn">classifier = pipeline("zero-shot-classification", device=0) #GPU</span><span id="28e7" class="nj lu it nf b gy no nl l nm nn">candidate_labels = ["positive", "negative"]<br/>text = "I don't know why I like this movie so well, but I never get tired of watching it."<br/>classifier(text, candidate_labels)</span><span id="9aa0" class="nj lu it nf b gy no nl l nm nn">&gt; {'labels': ['positive', 'negative'],<br/>&gt; 'scores': [0.8987422585487366, 0.10125774145126343],<br/>&gt; 'sequence': "I don't know why I like this movie so well, but I<br/>never get tired of watching it."}</span></pre><p id="47ed" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在第一个示例中，我们从transformers管道中初始化分类器，然后从<a class="ae le" href="http://ai.stanford.edu/~amaas/data/sentiment/" rel="noopener ugc nofollow" target="_blank"> IMDB数据集</a>中给出一个示例。您可以看到分类器为每个标签生成了分数。在第一个例子中，它正确地预测文本的情感是积极的。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="6426" class="nj lu it nf b gy nk nl l nm nn">candidate_labels = ["world", "sports", "business", "sci/tech"]<br/>text = "Quality Gets Swept Away Quality Distribution is hammered after reporting a large loss for the second quarter."<br/>classifier(text, candidate_labels)</span><span id="79ca" class="nj lu it nf b gy no nl l nm nn">&gt; {'labels': ['business', 'world', 'sci/tech', 'sports'],<br/>&gt; 'scores': [0.8066419363021851,   0.16538377106189728,   0.018306914716959,   0.009667363949120045],<br/>&gt; 'sequence': 'Quality Gets Swept Away Quality Distribution is hammered after reporting a large loss for the second quarter.'}</span></pre><p id="dd2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的第二个例子是来自<a class="ae le" href="http://groups.di.unipi.it/~gulli/AG_corpus_of_news_articles.html" rel="noopener ugc nofollow" target="_blank"> AG新闻数据集</a>的新闻分类。它能正确预测商业类新闻。</p><pre class="kp kq kr ks gt ne nf ng nh aw ni bi"><span id="42bb" class="nj lu it nf b gy nk nl l nm nn">candidate_labels = ["anger", "fear", "joy", "love", "sadness", "surprise"]<br/>text = "i didnt feel humiliated"<br/>classifier(text, candidate_labels)</span><span id="329a" class="nj lu it nf b gy no nl l nm nn">&gt; {'labels': ['surprise', 'joy', 'love', 'sadness', 'fear', 'anger'],<br/>&gt; 'scores': [0.66361004114151,   0.1976112276315689,   0.04634414240717888,   0.03801531344652176,   0.03516925126314163,   0.01925000175833702],<br/>&gt; 'sequence': 'i didnt feel humiliated'}</span></pre><p id="9891" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们的上一个例子中，我们研究了来自<a class="ae le" href="https://github.com/dair-ai/emotion_dataset" rel="noopener ugc nofollow" target="_blank">情感数据集</a>的一个例子。零镜头分类模型预测句子“我不觉得丢脸”的情感为<em class="mx">惊喜，</em>然而金标是<em class="mx">悲伤</em>。</p><h1 id="2067" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">评估</strong></h1><p id="68b5" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">在这些例子中，零射击分类看起来很有希望。然而，它的性能应该通过使用已经标记的例子用正确的测量来评估。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi np"><img src="../Images/00bdc430eac06228db0a5e6e1a0eb9c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DI-IkbYxbs4cuY3k"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">摘樱桃？？？Andriyko Podilnyk 在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9768" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过使用HuggingFace最新的<a class="ae le" href="https://github.com/huggingface/datasets" rel="noopener ugc nofollow" target="_blank">数据集库</a>，我们可以很容易地在几个数据集上评估它的性能。</p><ul class=""><li id="3723" class="lf lg it js b jt ju jx jy kb lh kf li kj lj kn lk ll lm ln bi translated"><a class="ae le" href="http://ai.stanford.edu/~amaas/data/sentiment/" rel="noopener ugc nofollow" target="_blank"> IMDB数据集</a>:情感分析<br/>类:<em class="mx">正，负</em></li><li id="d00c" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><a class="ae le" href="http://groups.di.unipi.it/~gulli/AG_corpus_of_news_articles.html" rel="noopener ugc nofollow" target="_blank"> AG-News数据集</a>:新闻分类<br/>类:<em class="mx">世界</em>，<em class="mx">体育</em>，<em class="mx">商业</em>，<em class="mx">科技</em></li><li id="78d6" class="lf lg it js b jt lo jx lp kb lq kf lr kj ls kn lk ll lm ln bi translated"><a class="ae le" href="https://github.com/dair-ai/emotion_dataset" rel="noopener ugc nofollow" target="_blank">情感数据集</a>:情感分类<br/>类:<em class="mx">愤怒</em>，<em class="mx">恐惧</em>，<em class="mx">喜悦</em>，<em class="mx">爱情</em>，<em class="mx">悲伤</em>，<em class="mx">惊喜</em></li></ul><p id="cfe2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们将我们的零镜头文本分类模型与最先进的模型和微平均F1中的随机选取进行比较。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/50c8f46e34c8ca4a597826754b1e7f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82k7_2yBIVmyVMvggzJnJA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">不同数据集中的微观平均F1</p></figure><p id="6fe4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有关初始化零射击分类管道和评估代码的更多详细信息，请查看这篇精心准备的Colab笔记本:</p><div class="nr ns gp gr nt nu"><a href="https://colab.research.google.com/drive/14NuJFnW3hsKNYvy0t37S0x3YYRhrxJ47?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd iu gy z fp nz fr fs oa fu fw is bi translated">零镜头文本分类—谷歌联合实验室</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">详细的讲解和评价！</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">colab.research.google.com</p></div></div><div class="od l"><div class="oe l of og oh od oi ky nu"/></div></div></a></div><h1 id="0d0d" class="lt lu it bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">结论</h1><p id="67f8" class="pw-post-body-paragraph jq jr it js b jt mr jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj mv kl km kn im bi translated">我们可以看到零镜头文本分类在情感分析和新闻分类中取得了显著的效果。在具有6类的情感分类中的表现相当差。我相信这可能是由于类之间的相似性。在没有任何先验数据的情况下，很难区分快乐、爱和惊喜类。</p><p id="eb69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如预期的那样，对于每个任务，零镜头分类的性能低于监督模型。即便如此，如果你没有任何具体分类问题的数据，还是值得尝试的<em class="mx">！</em></p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="ac99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mx">最初发表于</em><a class="ae le" href="https://akoksal.com/articles/zero-shot-text-classification-evaluation" rel="noopener ugc nofollow" target="_blank"><em class="mx">【https://akoksal.com】</em></a><em class="mx">。</em></p><p id="04b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="mx">在Twitter上关注我:</em><a class="ae le" href="https://twitter.com/alkksl" rel="noopener ugc nofollow" target="_blank">https://twitter.com/alkksl</a></p></div></div>    
</body>
</html>