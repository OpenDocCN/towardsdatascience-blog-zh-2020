<html>
<head>
<title>Essential commands for data preparation with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据准备的基本命令</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/essential-commands-for-data-preparation-with-pandas-ed01579cf214?source=collection_archive---------25-----------------------#2020-09-22">https://towardsdatascience.com/essential-commands-for-data-preparation-with-pandas-ed01579cf214?source=collection_archive---------25-----------------------#2020-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/f8167b6f95b2eec4c8c55510d9729c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*isO6ZGFwUpWyfEAM"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@carolineattwood?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡洛琳·阿特伍德</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="9a1c" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">熊猫“小抄”争夺数据</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="355b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果你喜欢烹饪，你会非常了解这一点。打开炉子烹饪食物是整个烹饪过程中很小的一部分。你的大部分汗水和泪水实际上都花在了准备正确的配料上。</p><p id="dd60" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">老生常谈，但值得再说一遍——数据准备是任何数据科学项目中80%的工作。无论是制作仪表板、简单的统计分析，还是拟合高级机器学习模型，都是从找到数据并将其转换为正确的格式开始，这样算法就可以处理其余的事情。</p><p id="a064" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果你是Python爱好者，那么<code class="fe mb mc md me b">pandas</code>就是你数据科学之旅中最好的朋友。配备了所有的工具，它可以帮助您完成项目中最困难的部分。</p><p id="38a0" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">也就是说，像任何新工具一样，你首先需要了解它的功能以及如何使用它们。许多数据科学的初学者仍然很难充分利用Pandas，而是将大量时间花在堆栈溢出上。我认为，这主要是因为无法将Pandas的功能与其分析需求相匹配。</p><p id="e722" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">只要列出典型的数据准备问题清单，并为它们配备合适的Pandas工具，就可以解决大部分问题。下面，我将介绍一个典型的数据准备和探索性分析工作流程，以及必要的Pandas功能。我并不是要记录下世界上所有关于熊猫的事情，而是演示创建你自己的数据争论备忘单的过程。</p><h1 id="54d0" class="mf mg jj bd mh mi mj mk ml mm mn mo mp kp mq kq mr ks ms kt mt kv mu kw mv mw bi translated">建立</h1><p id="a447" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">启动您最喜欢的Python IDE后，您可能想马上开始并导入必要的库。这很好，但是您仍然需要设置您的环境来设置工作目录、定位数据和其他文件等。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="d9cf" class="nk mg jj me b gy nl nm l nn no"># find out your current directory<br/>import os<br/>os.getcwd()</span><span id="2221" class="nk mg jj me b gy np nm l nn no"># if you want to set a different working directory<br/>os.chdir("folder-path")</span><span id="e181" class="nk mg jj me b gy np nm l nn no"># to get a list of all files in the directory<br/>os.listdir()</span></pre><h1 id="e1ef" class="mf mg jj bd mh mi mj mk ml mm mn mo mp kp mq kq mr ks ms kt mt kv mu kw mv mw bi translated">数据导入</h1><p id="8bff" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">接下来是数据导入，这是你第一次使用熊猫。</p><p id="7250" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您的数据可能位于世界上的任何地方—您的本地机器、SQL数据库、云中甚至在线数据库中。数据可以保存为各种格式— csv、txt、excel、sav等。</p><p id="c690" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">根据数据的来源和文件扩展名，您需要不同的Pandas命令。下面是几个例子。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="6021" class="nk mg jj me b gy nl nm l nn no"># import pandas and numpy libraries<br/>import pandas as pd<br/>import numpy as np</span><span id="e26b" class="nk mg jj me b gy np nm l nn no"># import a csv file from local machine<br/>df = pd.read_csv("file_path")</span><span id="e913" class="nk mg jj me b gy np nm l nn no"># import a csv file from an online database<br/>df = pd.read_csv("<a class="ae jg" href="https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv</a>")</span></pre><h2 id="585b" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">数据检查</h2><p id="f1cd" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">在导入数据后，您想要检查一些东西，如列和行的数量，列名等。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="e183" class="nk mg jj me b gy nl nm l nn no"># description of index, entries, columns, data types, memory info<br/>df.info() </span><span id="2d39" class="nk mg jj me b gy np nm l nn no"># check out first few rows<br/>df.head(5) # head</span><span id="c51d" class="nk mg jj me b gy np nm l nn no"># number of columns &amp; rows<br/>df.shape </span><span id="bdf0" class="nk mg jj me b gy np nm l nn no"># column names<br/>df.columns </span><span id="3bcb" class="nk mg jj me b gy np nm l nn no"># number of unique values of a column<br/>df["sepal_length"].nunique()</span><span id="53be" class="nk mg jj me b gy np nm l nn no"># show unique values of a column<br/>df["sepal_length"].unique()</span><span id="40d2" class="nk mg jj me b gy np nm l nn no"># number of unique values alltogether<br/>df.columns.nunique()</span><span id="3e0f" class="nk mg jj me b gy np nm l nn no"># value counts<br/>df['species'].value_counts()</span></pre><h2 id="3be6" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">处理NA值</h2><p id="98c3" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">接下来，检查NA、NaN或缺失值。一些算法可以处理缺失值，但其他算法要求在将数据投入使用之前处理缺失值。无论如何，检查缺失值并理解如何处理它们是“了解”数据的重要部分。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="cba2" class="nk mg jj me b gy nl nm l nn no"># show null/NA values per column<br/>df.isnull().sum()</span><span id="c9f9" class="nk mg jj me b gy np nm l nn no"># show NA values as % of total observations per column<br/>df.isnull().sum()*100/len(df)</span><span id="0636" class="nk mg jj me b gy np nm l nn no"># drop all rows containing null<br/>df.dropna()</span><span id="7de7" class="nk mg jj me b gy np nm l nn no"># drop all columns containing null<br/>df.dropna(axis=1)</span><span id="6be9" class="nk mg jj me b gy np nm l nn no"># drop columns with less than 5 NA values<br/>df.dropna(axis=1, thresh=5)</span><span id="dabd" class="nk mg jj me b gy np nm l nn no"># replace all na values with -9999<br/>df.fillna(-9999)</span><span id="509e" class="nk mg jj me b gy np nm l nn no"># fill na values with NaN<br/>df.fillna(np.NaN)</span><span id="b70d" class="nk mg jj me b gy np nm l nn no"># fill na values with strings<br/>df.fillna("data missing")</span><span id="3be7" class="nk mg jj me b gy np nm l nn no"># fill missing values with mean column values<br/>df.fillna(df.mean())</span><span id="f5e8" class="nk mg jj me b gy np nm l nn no"># replace na values of specific columns with mean value<br/>df["columnName"] = df["columnName"].fillna(df["columnName"].mean())</span><span id="1f39" class="nk mg jj me b gy np nm l nn no"># interpolation of missing values (useful in time-series)<br/>df["columnName"].interpolate()</span></pre><h2 id="da66" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">列操作</h2><p id="ba5a" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">通常情况下，您可能需要执行各种列操作，例如重命名或删除列、对列值进行排序、创建新的计算列等。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="90e4" class="nk mg jj me b gy nl nm l nn no"># select a column<br/>df["sepal_length"]</span><span id="4f33" class="nk mg jj me b gy np nm l nn no"># select multiple columns and create a new dataframe X<br/>X = df[["sepal_length", "sepal_width", "species"]]</span><span id="dfd6" class="nk mg jj me b gy np nm l nn no"># select a column by column number<br/>df.iloc[:, [1,3,4]]</span><span id="d11b" class="nk mg jj me b gy np nm l nn no"># drop a column from dataframe X<br/>X = X.drop("sepalL", axis=1)</span><span id="0a38" class="nk mg jj me b gy np nm l nn no"># save all columns to a list<br/>df.columns.tolist()</span><span id="78dc" class="nk mg jj me b gy np nm l nn no"># Rename columns<br/>df.rename(columns={"old colum1": "new column1", "old column2": "new column2"})</span><span id="3191" class="nk mg jj me b gy np nm l nn no"># sorting values by column "sepalW" in ascending order<br/>df.sort_values(by = "sepal_width", ascending = True)</span><span id="e855" class="nk mg jj me b gy np nm l nn no"># add new calculated column<br/>df['newcol'] = df["sepal_length"]*2</span><span id="5265" class="nk mg jj me b gy np nm l nn no"># create a conditional calculated column<br/>df['newcol'] = ["short" if i&lt;3 else "long" for i in df["sepal_width"]] </span></pre><h2 id="a199" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">行操作(排序、过滤、切片)</h2><p id="e015" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">到上一节为止，您已经清理了大部分数据，但数据准备的另一个重要部分是切片和过滤数据，以进入下一轮分析管道。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="3380" class="nk mg jj me b gy nl nm l nn no"># select rows 3 to 10<br/>df.iloc[3:10,]</span><span id="1778" class="nk mg jj me b gy np nm l nn no"># select rows 3 to 49 and columns 1 to 3<br/>df.iloc[3:50, 1:4]</span><span id="32bf" class="nk mg jj me b gy np nm l nn no"># randomly select 10 rows<br/>df.sample(10)</span><span id="8ad1" class="nk mg jj me b gy np nm l nn no"># find rows with specific strings<br/>df[df["species"].isin(["Iris-setosa"])]</span><span id="906a" class="nk mg jj me b gy np nm l nn no"># conditional filtering<br/>df[df.sepal_length &gt;= 5]</span><span id="ee3a" class="nk mg jj me b gy np nm l nn no"># filtering rows with multiple values e.g. 0.2, 0.3<br/>df[df["petal_width"].isin([0.2, 0.3])]</span><span id="0373" class="nk mg jj me b gy np nm l nn no"># multi-conditional filtering<br/>df[(df.petal_length &gt; 1) &amp; (df.species=="Iris-setosa") | (df.sepal_width &lt; 3)]</span><span id="9534" class="nk mg jj me b gy np nm l nn no"># drop rows<br/>df.drop(df.index[1]) # 1 is row index to be deleted</span></pre><h2 id="2d3b" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">分组</h2><p id="a5ea" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">最后但同样重要的是，您通常需要按不同的类别对数据进行分组——这在探索性数据分析和深入了解分类变量时尤其有用。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="b063" class="nk mg jj me b gy nl nm l nn no"># data grouped by column "species"<br/>X = df.groupby("species")</span><span id="8062" class="nk mg jj me b gy np nm l nn no"># return mean values of a column ("sepal_length" ) grouped by "species" column<br/>df.groupby("spp")["sepal_length"].mean()</span><span id="d649" class="nk mg jj me b gy np nm l nn no"># return mean values of ALL columns grouped by "species" category<br/>df.groupby("species").mean()</span><span id="8106" class="nk mg jj me b gy np nm l nn no"># get counts in different categories<br/>df.groupby("spp").nunique() </span></pre><h2 id="e6ad" class="nk mg jj bd mh nq nr dn ml ns nt dp mp lo nu nv mr ls nw nx mt lw ny nz mv oa bi translated">摘要</h2><p id="ef9f" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">这篇文章的目的是展示一些必要的Pandas函数，这些函数用于数据分析。在这次演示中，我遵循了一个典型的分析过程，而不是以随机的方式显示代码，这将允许数据科学家在项目中以正确的顺序找到正确的工具。当然，我不打算展示处理数据准备中的每个问题所需的每个代码，而是展示如何创建一个基本的Pandas cheatsheet。</p><p id="7bfd" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">希望这有用。如果你喜欢这篇文章，请在Twitter上关注我。</p></div></div>    
</body>
</html>