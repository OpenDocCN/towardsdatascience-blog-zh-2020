<html>
<head>
<title>Customer Clustering using DBSCAN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用DBSCAN进行客户聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customer-clustering-using-dbscan-4672f51fe5aa?source=collection_archive---------22-----------------------#2020-09-28">https://towardsdatascience.com/customer-clustering-using-dbscan-4672f51fe5aa?source=collection_archive---------22-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c8bd127d58ad76390c181fcd2882fa0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I9SyekTIIc06G7pw"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Rajendra Biswal 在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0cb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇博客中，我们将学习我最喜欢的聚类算法之一，那就是DBSCAN算法。我们将首先理解理论，然后我将借助一个非常简单的例子演示DBSCAN的工作原理。</p><p id="5a08" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">DBSCAN代表对有噪声的应用进行基于密度的空间聚类。</p><p id="f26b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它在1996年左右被引入，并且由于其识别不同类型的聚类形状的有效聚类能力以及即使在存在噪声的情况下也能正确识别聚类的能力，在社区中获得了显著的普及。</p><p id="b374" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们跳到一些有助于理解算法基本工作原理的关键术语。</p><p id="9ff8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有两个参数在算法中起着至关重要的作用。1)最小点数和2)ε。</p><p id="6c40" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该算法通过单独处理每个数据点来工作，特别是对于每个点。它会构建一个以点为中心，半径等于ε的圆。</p><h2 id="1a2e" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">敏点:</strong></h2><p id="14a4" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">最小点是距离该点ɛ距离内必须存在的点数。</p><h2 id="6d46" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak"> Epsilon(ɛ) : </strong></h2><p id="f589" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">它是每个物体周围的距离或半径。</p><h2 id="7fc2" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">核心点:</strong></h2><p id="1615" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">考虑下图，画一个以查询点为圆心，以ɛ.为半径的圆如果圆内的点数大于MinPoints(本例中为<em class="mc">min points = 2</em>)，查询点将成为核心点。所以查询点有资格成为核心点。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi md"><img src="../Images/bd6326854efe656329d1adba18ede5b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*hOiidOIJtbG8fAOk04-jgg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">(图片由作者提供)核心点演示:1。圆的半径= <strong class="bd mi"> ɛ，</strong> 2。中心是考虑中的点</p></figure><h2 id="cd8e" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">边界点:</strong></h2><p id="2e3c" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">如果查询点在ɛ内小于最小点，但在ɛ距离内具有核心点，则它是边界点。</p><h2 id="df43" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">噪声点:</strong></h2><p id="e53f" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">既不是核心点也不是边界点的点称为噪声点。见下图。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/c45b5f54182edda5392d9577f39b3461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*3l1ipee0fhEv1_g-15h7Gg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">(图片由作者提供)噪点演示</p></figure><p id="61eb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">DBSCAN将以这种方式处理每一个对象/点，并且最终它将获得所有点的分类，作为核心、边界或噪声点。</p><p id="2050" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦获得了点的分类，下一步就是使用它们来构建聚类。DBSCAN选取一个核心点，然后查看其ε半径圆内的点，并为这些点分配一个聚类标签。</p><p id="f507" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以关键的思想是给一个核心点的圆内的所有点以相同的标号。</p><p id="51c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将为不同的核心点运行多次迭代以分配聚类标签，请注意算法不会为那些在早期迭代中已经考虑的点分配新的聚类标签。</p><h2 id="255f" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">现在让我们看一下DBSCAN在客户数据上的工作示例。</strong></h2><p id="1494" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated"><strong class="ki iu">问题陈述:</strong> <br/>你拥有商场，想根据顾客过去的购买数据了解他们。这种分析将有助于营销团队采取一些策略来锁定目标客户。</p><h2 id="1c7a" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak">数据:</strong></h2><p id="dfe9" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">您的数据由客户ID、年龄、性别、年收入和支出分数等列组成。支出分数是您根据您定义的参数(如客户行为和购买数据)分配给客户的分数。</p><p id="1574" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以从Kaggle.com得到这个数据集。</p><p id="646e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/vjchoudhary 7/customer-segmentation-tutorial-in-python</a></p><h2 id="ca21" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated"><strong class="ak"> Python代码:</strong></h2><pre class="me mf mg mh gt mk ml mm mn aw mo bi"><span id="b419" class="le lf it ml b gy mp mq l mr ms"># DBSCAN Clustering<br/># Importing the libraries<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span><span id="0e40" class="le lf it ml b gy mt mq l mr ms"># Importing the dataset<br/>dataset = pd.read_csv(Mall_customers.csv')<br/>data = dataset.iloc[:, [3, 4]].values<br/>dataset.head()</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/e629e5d6bbf623f40ceb9f1b1987bae9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*gzvA3OOGZ9I_L_K3B6X0vg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">该数据集中有200行</p></figure><pre class="me mf mg mh gt mk ml mm mn aw mo bi"><span id="1a75" class="le lf it ml b gy mp mq l mr ms"># visualizing the dataset<br/>plt.scatter(data[:, 0], data[:, 1], s = 10, c = 'black')</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/c077cdc00167e3a1f3838837b5e11855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*-5DUvoE0tjGq7mIwOXekfA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">(图片由作者提供)年收入和支出分数散点图</p></figure><pre class="me mf mg mh gt mk ml mm mn aw mo bi"><span id="df57" class="le lf it ml b gy mp mq l mr ms"># Fitting DBSCAN to the dataset and predict the Cluster label<br/>from sklearn.cluster import DBSCAN</span><span id="2379" class="le lf it ml b gy mt mq l mr ms">dbscan = DBSCAN(eps=5.5, min_samples=4)<br/>labels = dbscan.fit_predict(data) <br/>np.unique(labels)</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d8e49c546435b9f06fe36a52ce6fe88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*UFwxE8XoJvvwsmf0KHPchA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">聚类标签。注意Cluster = -1表示噪声点</p></figure><pre class="me mf mg mh gt mk ml mm mn aw mo bi"><span id="d2cf" class="le lf it ml b gy mp mq l mr ms"># Visualising the clusters<br/>plt.scatter(data[labels == -1, 0], data[labels == -1, 1], s = 10, c = 'black')</span><span id="8771" class="le lf it ml b gy mt mq l mr ms">plt.scatter(data[labels == 0, 0], data[labels == 0, 1], s = 10, c = 'blue')<br/>plt.scatter(data[labels == 1, 0], data[labels == 1, 1], s = 10, c = 'red')<br/>plt.scatter(data[labels == 2, 0], data[labels == 2, 1], s = 10, c = 'green')<br/>plt.scatter(data[labels == 3, 0], data[labels == 3, 1], s = 10, c = 'brown')<br/>plt.scatter(data[labels == 4, 0], data[labels == 4, 1], s = 10, c = 'pink')<br/>plt.scatter(data[labels == 5, 0], data[labels == 5, 1], s = 10, c = 'yellow')      <br/>plt.scatter(data[labels == 6, 0], data[labels == 6, 1], s = 10, c = 'silver')</span><span id="c35d" class="le lf it ml b gy mt mq l mr ms">plt.xlabel('Annual Income')<br/>plt.ylabel('Spending Score')<br/>plt.show()</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/3f5843002c5929a1d2a6e7deadab9caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*l9pGVf6y4jpdlO3gbLQVGA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">(图片由作者提供)黑点是噪点。</p></figure><p id="bec5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">祝贺您，您的第一次客户聚类迭代已经完成。</p><h2 id="8988" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">结论:</h2><p id="a722" class="pw-post-body-paragraph kg kh it ki b kj lx kl km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">由于聚类是无监督的学习，您需要分析每个聚类并有一个关于业务数据的定义，因为聚类总是受一些业务规则的指导。一旦您的集群接近业务规则，您的模型就有意义了。</p><p id="57b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以更改eps和Min_sample的值来调整模型，使聚类的形状更好。</p><p id="29bd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读。</p><p id="b48d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参考:<a class="ae kf" href="https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/vjchoudhary 7/customer-segmentation-tutorial-in-python</a></p></div></div>    
</body>
</html>