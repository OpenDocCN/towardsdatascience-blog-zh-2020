<html>
<head>
<title>AWS Glue Studio—No Spark Skills-No Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Glue Studio——没有火花技能——没问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/aws-glue-studio-no-spark-skills-no-problem-b3204ed98aa4?source=collection_archive---------27-----------------------#2020-09-29">https://towardsdatascience.com/aws-glue-studio-no-spark-skills-no-problem-b3204ed98aa4?source=collection_archive---------27-----------------------#2020-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="345e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用AWS Glue Studio轻松创建Spark ETL作业——不需要Spark经验</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e28bf8337b9edd1518fa12878bf1c0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-kLHkQv0ReU5tVN6zyYlg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2167835" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</p></figure><p id="a760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> AWS胶水工作室</strong>近日上线。有了AWS Glue Studio，您可以使用GUI来创建、管理和监控ETL作业，而不需要Spark编程技能。用户可以通过可视地定义ETL作业的源/转换/目的节点来可视地创建ETL作业，该ETL作业可以执行诸如获取/保存数据、连接数据集、选择字段、过滤等操作。一旦用户组装了ETL作业的各个节点，AWS Glue Studio就会自动为您生成Spark代码。</p><p id="8445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AWS Glue Studio支持许多不同类型的数据源，包括:</p><ul class=""><li id="43da" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">S3</li><li id="a3b4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">无线电数据系统</li><li id="dcee" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">由外界刺激引起的不随意运动</li><li id="310a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">卡夫卡</li></ul><p id="0a3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们尝试创建一个简单的ETL作业。这个ETL作业将使用3个数据集- <em class="mj">订单、订单细节和产品</em>。目标是连接这三个数据集，选择几个字段，最后过滤产品MRSP大于100美元的订单。最后，我们希望将结果保存到S3。</p><p id="8b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们完成时，ETL工作应该看起来像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/b8a0e72777aad8556a8254af91559733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*VfUMVR_BArKZ_Mh1PNDKaQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从下载本教程所需的数据集开始。将数据集保存在S3。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="44b5" class="mq mr it mm b gy ms mt l mu mv">$ git clone <a class="ae ky" href="https://github.com/mkukreja1/blogs" rel="noopener ugc nofollow" target="_blank">https://github.com/mkukreja1/blogs</a></span><span id="c099" class="mq mr it mm b gy mw mt l mu mv">$ aws s3 mb s3://glue-studio<br/>make_bucket: glue-studio</span><span id="f81a" class="mq mr it mm b gy mw mt l mu mv">$ aws s3 cp blogs/glue-studio/orders.csv s3://glue-studio/data/orders/orders.csv<br/>upload: blogs/glue-studio/orders.csv to s3://glue-studio/data/orders/orders.csv</span><span id="a49e" class="mq mr it mm b gy mw mt l mu mv">$ aws s3 cp blogs/glue-studio/orderdetails.csv s3://glue-studio/data/orderdetails/orderdetails.csv<br/>upload: blogs/glue-studio/orderdetails.csv to s3://glue-studio/data/orderdetails/orderdetails.csv</span><span id="f527" class="mq mr it mm b gy mw mt l mu mv">$ aws s3 cp blogs/glue-studio/products.csv s3://glue-studio/data/products/products.csv<br/>upload: blogs/glue-studio/products.csv to s3://glue-studio/data/products/products.csv<br/></span></pre><p id="85e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将把这些文件保存到S3，并使用Glue Crawler将它们编入<strong class="lb iu">订单</strong>数据库。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="fb0b" class="mq mr it mm b gy ms mt l mu mv">$ aws glue create-database --database-input '{"Name":"orders"}'</span><span id="744c" class="mq mr it mm b gy mw mt l mu mv">$ aws glue create-crawler --cli-input-json '{"Name": "orders","Role": "arn:aws:iam::175908995626:role/glue-role","DatabaseName": "orders","Targets": {"S3Targets": [{"Path": "s3://glue-studio/data/orders/"},{"Path": "s3://glue-studio/data/orders/"}]}}'</span><span id="08fd" class="mq mr it mm b gy mw mt l mu mv">$ aws glue start-crawler --name orders</span><span id="8a3d" class="mq mr it mm b gy mw mt l mu mv">$ aws glue delete-crawler --name orders</span><span id="0b3b" class="mq mr it mm b gy mw mt l mu mv">$ aws glue create-crawler --cli-input-json '{"Name": "orderdetails","Role": "arn:aws:iam::175908995626:role/glue-role","DatabaseName": "orders","Targets": {"S3Targets": [{"Path": "s3://glue-studio/data/orderdetails/"},{"Path": "s3://glue-studio/data/orderdetails/"}]}}'</span><span id="0cb7" class="mq mr it mm b gy mw mt l mu mv">$ aws glue start-crawler --name orderdetails</span><span id="20d4" class="mq mr it mm b gy mw mt l mu mv">$ aws glue delete-crawler --name orderdetails</span><span id="8121" class="mq mr it mm b gy mw mt l mu mv">$ aws glue create-crawler --cli-input-json '{"Name": "products","Role": "arn:aws:iam::175908995626:role/glue-role","DatabaseName": "orders","Targets": {"S3Targets": [{"Path": "s3://glue-studio/data/products/"},{"Path": "s3://glue-studio/data/products/"}]}}'</span><span id="b0c0" class="mq mr it mm b gy mw mt l mu mv">$ aws glue start-crawler --name products</span><span id="f18d" class="mq mr it mm b gy mw mt l mu mv">$ aws glue delete-crawler --name products</span></pre><p id="19fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用AWS控制台打开<strong class="lb iu"> AWS Glue </strong> service，并使用左侧菜单点击<strong class="lb iu"> AWS Glue Studio </strong>。确保您选择了空白图表。点击<strong class="lb iu">创建</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/77e81f6e9db9a56b2158ae2abc3f1736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVFJVJLFM3zHM_4oDTWG6A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先创建第一个转换节点- <strong class="lb iu">获取订单数据</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/69831c4411fd7af7fd907ba7565031bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gNB-De5vVIhSHj0LKJyXw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="79aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保<strong class="lb iu">获取订单数据</strong>指向之前在Glue中分类的订单表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/9cba83a42e522d5ddcd5479cce21ab9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ttuF-H_tPW9xkM9La4Kugg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="20a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用与上述相同的原则创建转换节点- <strong class="lb iu">获取订单明细数据</strong>以及<strong class="lb iu">获取产品数据</strong></p><p id="62c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将创建一个转换节点，它将把<strong class="lb iu">提取订单数据</strong>连接到<strong class="lb iu">提取订单详细信息数据。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/1ece25d3cf4c79a92aeca8b8a28dac29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3r-ColkXyH-AkArwKLGBw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="9f9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意两个表之间的连接条件是如何定义的，如下所示。</p><p id="9d5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用相同的原理创建一个转换节点，该节点将连接<strong class="lb iu">连接订单</strong>到<strong class="lb iu">获取产品数据。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/038d9ba4dd946b273670744988563426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCADwPvki2_3coxTvMB3fQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2a4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们想从三个表中选择一个列的子集，所以我们可以使用<strong class="lb iu">选择字段</strong>节点</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/7ba53f83c02e34aa78a382480958b4c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_o0pbxZPRn7Gx2ewP1KQFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="eb4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意如何为应该包含在最终结果集中的字段选择复选框。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/b143196408b61f44178dd0a6534769b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUXsbO4gOagHVy88BYuEkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="c708" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们要过滤MRSP大于100美元的产品。这可以通过创建如下的<strong class="lb iu">过滤器产品MRSP &gt; 100 </strong>节点来实现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/41eb0aeea4115f2a0e484ec683f2c9b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRlOpFFqgIytC23tnnoxrg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="7fbe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意如何定义一个或多个过滤条件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/3696dc05ca4d7bc63abcf4078d0832b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2UKLptTZtypzJdWTGtXiYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2d09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们希望将结果表以拼花格式保存到S3。对于tis，我们创建一个目的节点- <strong class="lb iu">保存结果</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/f5ec1220f219f7f8eb003272dd09dce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d4m5SlWTwVMd6LcnzMsjdg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/3950e4e0a2a88262cb385d09c9d52c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRLxNJ9wA3LLRbWiV1yilA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="95f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用“保存”按钮保存您的ETL作业。这时你应该可以看到<strong class="lb iu"> AWS Glue Studio </strong>已经自动为你生成了Spark代码。点击<strong class="lb iu">脚本</strong>菜单查看生成的代码。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="7489" class="mq mr it mm b gy ms mt l mu mv">import sys<br/>from awsglue.transforms import *<br/>from awsglue.utils import getResolvedOptions<br/>from pyspark.context import SparkContext<br/>from awsglue.context import GlueContext<br/>from awsglue.job import Job<br/>import re</span><span id="2178" class="mq mr it mm b gy mw mt l mu mv">## <a class="ae ky" href="http://twitter.com/params" rel="noopener ugc nofollow" target="_blank">@params</a>: [JOB_NAME]<br/>args = getResolvedOptions(sys.argv, ['JOB_NAME'])</span><span id="1df9" class="mq mr it mm b gy mw mt l mu mv">sc = SparkContext()<br/>glueContext = GlueContext(sc)<br/>spark = glueContext.spark_session<br/>job = Job(glueContext)<br/>job.init(args['JOB_NAME'], args)<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: DataSource<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [database = "orders", table_name = "orders", transformation_ctx = "DataSource0"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: DataSource0<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: []<br/>DataSource0 = glueContext.create_dynamic_frame.from_catalog(database = "orders", table_name = "orders", transformation_ctx = "DataSource0")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: DataSource<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [database = "orders", table_name = "products", transformation_ctx = "DataSource2"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: DataSource2<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: []<br/>DataSource2 = glueContext.create_dynamic_frame.from_catalog(database = "orders", table_name = "products", transformation_ctx = "DataSource2")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: DataSource<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [database = "orders", table_name = "orderdetails", transformation_ctx = "DataSource1"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: DataSource1<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: []<br/>DataSource1 = glueContext.create_dynamic_frame.from_catalog(database = "orders", table_name = "orderdetails", transformation_ctx = "DataSource1")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: Join<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [keys2 = ["ordernumber"], keys1 = ["ordernumber"], transformation_ctx = "Transform2"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: Transform2<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: [frame1 = DataSource0, frame2 = DataSource1]<br/>Transform2 = Join.apply(frame1 = DataSource0, frame2 = DataSource1, keys2 = ["ordernumber"], keys1 = ["ordernumber"], transformation_ctx = "Transform2")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: Join<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [keys2 = ["productcode"], keys1 = ["productcode"], transformation_ctx = "Transform3"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: Transform3<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: [frame1 = Transform2, frame2 = DataSource2]<br/>Transform3 = Join.apply(frame1 = Transform2, frame2 = DataSource2, keys2 = ["productcode"], keys1 = ["productcode"], transformation_ctx = "Transform3")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: SelectFields<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [paths = ["ordernumber", "orderdate", "requireddate", "shippeddate", "status", "productname", "msrp"], transformation_ctx = "Transform1"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: Transform1<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: [frame = Transform3]<br/>Transform1 = SelectFields.apply(frame = Transform3, paths = ["ordernumber", "orderdate", "requireddate", "shippeddate", "status", "productname", "msrp"], transformation_ctx = "Transform1")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: Filter<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [f = lambda row : (row["msrp"] &gt; 100), transformation_ctx = "Transform0"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: Transform0<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: [frame = Transform1]<br/>Transform0 = Filter.apply(frame = Transform1, f = lambda row : (row["msrp"] &gt; 100), transformation_ctx = "Transform0")<br/>## <a class="ae ky" href="http://twitter.com/type" rel="noopener ugc nofollow" target="_blank">@type</a>: DataSink<br/>## <a class="ae ky" href="http://twitter.com/args" rel="noopener ugc nofollow" target="_blank">@args</a>: [connection_type = "s3", format = "parquet", connection_options = {"path": "s3://glue-studio/results/", "partitionKeys": []}, transformation_ctx = "DataSink0"]<br/>## <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a>: DataSink0<br/>## <a class="ae ky" href="http://twitter.com/inputs" rel="noopener ugc nofollow" target="_blank">@inputs</a>: [frame = Transform0]<br/>DataSink0 = glueContext.write_dynamic_frame.from_options(frame = Transform0, connection_type = "s3", format = "parquet", connection_options = {"path": "s3://glue-studio/results/", "partitionKeys": []}, transformation_ctx = "DataSink0")<br/>job.commit()</span></pre><p id="3980" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都准备好了。让我们使用右上角的<strong class="lb iu">运行</strong>按钮运行作业。点击<strong class="lb iu">运行详细信息</strong>会显示正在运行的作业的状态。一旦作业状态变为<strong class="lb iu">成功</strong>，您就可以去S3查看作业的最终结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/386d6d384b75915fae030b08ec3903b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nr33EybKTn4s9gXclccOUg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="80a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，结果文件夹中应该会生成许多拼花文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/5976acc34daa043b597618ba067037eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PbfUaM-SuNmeDe7LslDjeA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b89b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用Apache Parquet查看器检查文件的上下文。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/e0d8408a604534a6223168a5da4f9905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b57L6cB0gBdBlsDXgk-Q9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="1d55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章是有帮助的。<strong class="lb iu"> AWS Glue Studio </strong>是由<a class="ae ky" href="http://www.datafence.com" rel="noopener ugc nofollow" target="_blank"> Datafence Cloud Academy </a>提供的AWS大数据分析课程的一部分。课程是周末自己在网上教的。</p></div></div>    
</body>
</html>