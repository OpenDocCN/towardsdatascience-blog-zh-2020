<html>
<head>
<title>3 Tips for First-Time Machine Learning Projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">首次机器学习项目的3个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-tips-for-first-time-machine-learning-projects-9f1495c5aac0?source=collection_archive---------46-----------------------#2020-09-18">https://towardsdatascience.com/3-tips-for-first-time-machine-learning-projects-9f1495c5aac0?source=collection_archive---------46-----------------------#2020-09-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8fea" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">帮助构建成功顶点项目的实用工具和技术。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/149b8c03cf02bf05c71b9fa09c901a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u2-yf3l_B1x9wVQexKen0Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/icrhAD-qidc" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="24c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自从我的顶点团队完成我们的森林火灾管理机器学习项目以来，已经过去了几个月。这是一次很棒的经历，最终让我们赢得了2020年安大略省软件工程顶点竞赛！随着学校开学，学生们开始新的项目，我认为分享一些在这个项目中帮助我的技巧是有用的。</p><p id="612e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，我从涉及机器学习的顶点工作中获得的最大收获是，90%的工作都是让数据屈服(或者与数据成为朋友，这取决于你的观点)。</p><p id="0a04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理解干净数据、探索性数据分析、数据争论的重要性对我们项目的成功绝对至关重要。我认为这一点在课程工作中经常被忽视，这会导致人们对这样一个项目中所涉及的工作有一种扭曲的看法。因此，这里有一些工具和技术(有例子)帮助我的团队与数据保持健康的关系，并使项目更加愉快。</p><h1 id="7278" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak"> 1。与Google Colab的合作</strong></h1><p id="5e0a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Google Colab是一款来自Google Drive的用于编码和运行Jupyter笔记本(常用于机器学习项目)的工具。与本地Python脚本甚至本地Jupyter笔记本相比，使用Google Colab有两大优势。</p><p id="40dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，Colab让你可以使用免费的云图形处理器，这可以真正加快你的工作流程。第二，使用Colab允许在Google Drive上存储数据(每个帐户最多有15GB)，这使得在数据争论上的合作更加容易。为了利用这些功能，我们的团队在Google Drive上使用了一个包含我们的Colab笔记本的共享文件夹，以及一个包含gzipped csv文件的共享数据文件夹，这些文件由一些笔记本输出，由其他笔记本用作输入。由于Google Drive文件夹是共享的，所以每个人都可以很容易地访问团队其他成员产生的最新数据。</p><p id="7acc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个使用Google Colab笔记本从共享文件夹导入gzipped csv的示例:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你正在使用大的csv文件，我建议使用gzip压缩来存储它们，因为pandas包可以在一行代码中快速地解压缩和读入文件。</p><p id="c141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的项目中，我们有15个活动的笔记本文件，它们有不同的相互依赖关系，因此有一个明确的位置来存储数据是非常有帮助的。</p><h1 id="965d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak"> 2。使用aiohttp加速数据采集</strong></h1><p id="3178" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">温度、风和湿度都对森林火灾是否会发生以及是否会蔓延有重大影响。由于这些值在一天中变化很大，我们必须从加拿大各地的气象站获得几年来的每小时数据。</p><p id="c172" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对我们来说幸运的是，加拿大政府(加拿大环境和气候变化部)拥有加拿大数百个气象站的<a class="ae ky" href="https://climate.weather.gc.ca/" rel="noopener ugc nofollow" target="_blank">历史每小时天气数据</a>，有些数据甚至可以追溯到1866年！他们甚至提供了完全免费的<a class="ae ky" href="https://drive.google.com/drive/folders/1WJCDEU34c60IfOnG4rv5EPZ4IhhW9vZH" rel="noopener ugc nofollow" target="_blank"> API </a>来批量下载历史天气数据。</p><p id="c72d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下载每小时数据的API要求用户指定站ID、年份和月份。因此，如果我们想要过去10年中150个站点的数据，这将意味着150x10x12 = 18，000个API调用。按顺序执行这些调用需要很长时间，所以我们使用aiohttp包并发地执行API调用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="a480" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码可以用来获取任何类型的csv数据。</p><h1 id="9e53" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak"> 3。矢量化</strong></h1><p id="9638" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在特征工程中，我们的团队假设绝对湿度可以提供额外的信息，有助于森林火灾的预测。绝对湿度可以从温度和相对湿度中导出，使用一个特殊的公式导出<a class="ae ky" href="https://carnotcycle.wordpress.com/2012/08/04/how-to-convert-relative-humidity-to-absolute-humidity/" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><p id="7ce6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是代码中的公式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="aa23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有几种方法可以将它应用于熊猫数据框中每小时的天气数据。我们可以遍历数据帧中的每一行，计算绝对湿度:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="939d" class="mz lw it mv b gy na nb l nc nd"><strong class="mv iu">%%timeit -n 3<br/></strong>abs_humidity_list = []<br/>for index, row in df.iterrows():<br/>    temperature = row['Temp (°C)']<br/>    rel_humidity = row['Rel Hum (%)']<br/>    abs_humidity = calculate_abs_humidity(temperature, rel_humidity)<br/>    abs_humidity_list.append(abs_humidity)</span></pre><p id="cdf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结果:</strong> 3次循环，3次最佳:每次循环8.49秒</p><p id="b14f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然上面的代码完成了这项工作，但是它为每一行计算一次函数。为了更快获得结果，可以使用熊猫应用功能:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="a517" class="mz lw it mv b gy na nb l nc nd"><strong class="mv iu">%%timeit -n 3<br/></strong>abs_humidity_series = df.apply(lambda row:<br/>    calculate_abs_humidity(row['Temp (°C)'], row['Rel Hum (%)']),<br/>    axis=1)</span></pre><p id="6c10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结果:</strong> 3次循环，3次最佳:每次循环1.9秒</p><p id="5d24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">即使这样更快，pandas apply函数基本上仍然是一个循环。为了真正实现快速计算，我们希望将<strong class="lb iu"><em class="ne">create _ ABS _ weather</em></strong>函数应用于同时<strong class="lb iu">的所有温度和相对湿度对</strong>。在我们的大多数项目笔记本中，我们的团队为此使用了numpy的<strong class="lb iu"> <em class="ne">矢量化</em> </strong>功能:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="d7e6" class="mz lw it mv b gy na nb l nc nd">import numpy as np</span><span id="52a7" class="mz lw it mv b gy nf nb l nc nd"><strong class="mv iu">%%timeit -n 3<br/></strong>abs_humidity_np = np.vectorize(calculate_abs_humidity)(<br/>    df[‘Temp (°C)’],<br/>    df[‘Rel Hum (%)’])</span></pre><p id="aa7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结果:</strong> 3次循环，3次最佳:每次循环34.2毫秒</p><p id="b960" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不错的进步。然而，在这篇文章的写作过程中，我发现使用numpy的<strong class="lb iu"><em class="ne"/></strong>矢量化仍然不是<a class="ae ky" href="https://stackoverflow.com/questions/52673285/performance-of-pandas-apply-vs-np-vectorize-to-create-new-column-from-existing-c" rel="noopener ugc nofollow" target="_blank">真正的矢量化</a>。事实上，我们无法使用<strong class="lb iu"><em class="ne">calculate _ ABS _ weather</em></strong>进行真正的矢量化，因为在该函数中，我们使用了<strong class="lb iu"> <em class="ne"> math.exp </em> </strong>，它一次只能对一个数字进行操作，而不能对一长串数字(向量)进行操作。</p><p id="4900" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，numpy有一个等效的指数函数，它作用于向量，<strong class="lb iu"> <em class="ne"> np.exp，</em> </strong>因此，如果我们对原来的<strong class="lb iu"><em class="ne">calculate _ ABS _ weather</em></strong>函数做一点小调整，去掉指数函数，我们会得到:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="7b7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">突然间，我们有了一个可以接收整个熊猫数据帧列的函数:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="e315" class="mz lw it mv b gy na nb l nc nd"><strong class="mv iu">%%timeit -n 3</strong><br/>calculate_abs_humidity_np(df[‘Temp (°C)’], df[‘Rel Hum (%)’])</span></pre><p id="901e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结果:</strong> 3次循环，3次最佳:每次循环5.64毫秒</p><p id="c482" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">真正的矢量化！</p><p id="9c98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能会说，“矢量化真的那么重要吗？节省8秒钟似乎没什么大不了的。”对于小数据集，我同意它不会产生巨大的差异。作为参考，上面的示例使用了过去10年来自单个气象站的每小时数据，结果为78，888行(仍然相对较小)。</p><p id="4b77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们想计算同一时期100个气象站数据的绝对湿度呢？现在，如果您正在遍历每一行，您将不得不等待13分钟，这就是矢量化开始产生重大影响的地方。矢量化还有一个额外的好处，就是可以让代码更加简洁易读，所以我建议尽可能养成使用它的习惯。</p><h1 id="cd7c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">最终注释</strong></h1><p id="0030" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">顶点项目中使用的最终森林火灾预测模型是在包含超过1600万行的数据集上训练的(每行包含过去10年中某一天20x20公里网格的信息)。组装该数据集被证明是项目的关键部分，通过使用以下工具，整个过程变得更加简单:</p><ul class=""><li id="583d" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><strong class="lb iu">Google Colab</strong>——方便分享和协作数据</li><li id="b9b7" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">用于快速获取大量数据</li><li id="3159" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><strong class="lb iu">向量化函数</strong> —用于对具有数百万行的数据集执行高效操作</li></ul><p id="df55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经将所有示例代码包含在一个笔记本文件中:<a class="ae ky" href="https://github.com/ivanzvonkov/examples-3-tips-for-ml-projects/blob/master/example-notebook.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/ivanzvonkov/examples-3-tips-for-ml-projects/blob/master/example-notebook . ipynb</a>。</p><p id="4995" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望您有机会在您的下一个项目中尝试这些工具！</p><p id="74ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想查看实际的顶点工程库，你可以在这里找到:<a class="ae ky" href="https://github.com/ivanzvonkov/forestcasting" rel="noopener ugc nofollow" target="_blank">https://github.com/ivanzvonkov/forestcasting</a>。</p><p id="e800" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，感谢所有反馈！</p></div></div>    
</body>
</html>