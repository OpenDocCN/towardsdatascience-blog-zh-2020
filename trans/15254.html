<html>
<head>
<title>Handling Outliers in Clusters using Silhouette Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用轮廓分析处理聚类中的异常值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handling-outliers-in-clusters-using-silhouette-analysis-5a7d51118dac?source=collection_archive---------14-----------------------#2020-10-20">https://towardsdatascience.com/handling-outliers-in-clusters-using-silhouette-analysis-5a7d51118dac?source=collection_archive---------14-----------------------#2020-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5e59" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从K均值聚类中识别并移除每个聚类中的异常值</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bbac0d56c805c8cdc8b2b7e5a77b40c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*E7XSHnwqxpuEqav5okZovg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由<a class="ae ku" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1987214" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</p></figure><p id="c106" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi lr translated"><span class="l ls lt lu bm lv lw lx ly lz di">现实世界中的数据通常有很多异常值。异常值的原因可能是数据损坏或未能记录数据。异常值的处理在数据预处理过程中非常重要，因为异常值的存在会妨碍模型发挥最佳性能。</span></p><p id="1ed9" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">有各种策略来处理数据集中的异常值。本文将介绍如何在使用剪影分析将数据聚类成几个簇之后处理异常值。</p><h1 id="675d" class="ma mb it bd mc md me mf mg mh mi mj mk jz ml ka mm kc mn kd mo kf mp kg mq mr bi translated">轮廓分析:</h1><p id="a08a" class="pw-post-body-paragraph kv kw it kx b ky ms ju la lb mt jx ld le mu lg lh li mv lk ll lm mw lo lp lq im bi translated"><strong class="kx iu">剪影法</strong>是一种寻找最佳聚类数以及解释和验证数据聚类一致性的方法。剪影方法计算每个点的剪影系数，该系数测量一个点与其自己的聚类相比与其他聚类相似的程度。通过提供一个<strong class="kx iu">简洁的图形表示</strong>来显示每个对象的分类情况。这些图形表示的分析被称为<strong class="kx iu">轮廓分析</strong>。</p><p id="3726" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">剪影值是一个衡量对象与其自身聚类(<strong class="kx iu">内聚</strong>)相比与其他聚类(<strong class="kx iu">分离</strong>)相似程度的指标。轮廓值的范围在[1，-1]之间。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="a11d" class="nc mb it my b gy nd ne l nf ng"><strong class="my iu">Important Points:<br/>The Silhouette coefficient of +1</strong> indicates that the sample is far away from the neighboring clusters.<br/><strong class="my iu">The Silhouette </strong>coefficient <strong class="my iu">of 0</strong> indicates that the sample is on or very close to the decision boundary between two neighboring clusters.<br/><strong class="my iu">Silhouette </strong>coefficient <strong class="my iu">&lt;0</strong> indicates that those samples might have been assigned to the wrong cluster or are outliers.</span></pre><h2 id="9d2a" class="nc mb it bd mc nh ni dn mg nj nk dp mk le nl nm mm li nn no mo lm np nq mq nr bi translated">计算轮廓系数:</h2><p id="654a" class="pw-post-body-paragraph kv kw it kx b ky ms ju la lb mt jx ld le mu lg lh li mv lk ll lm mw lo lp lq im bi translated">求第I个点的轮廓系数的步骤:</p><ol class=""><li id="389e" class="ns nt it kx b ky kz lb lc le nu li nv lm nw lq nx ny nz oa bi translated">计算an (i):该点与同一聚类中所有其他点的平均距离。</li><li id="806e" class="ns nt it kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated">Compute b(i):该点与离其聚类最近的聚类中所有点的平均距离。</li><li id="91bd" class="ns nt it kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated">使用下述公式计算s(I)-轮廓系数或第I点。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2411df066263fecc78160900a50592c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/0*TjZyK0cT1GFbseNB.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0ce6e104078885f946942457b10a737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/0*rIN3QMUESXIks3GM.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">(图片由作者提供)，a(i)和b(i)的图解表示，根据上述公式计算轮廓系数— s(i)</p></figure><h2 id="19d5" class="nc mb it bd mc nh ni dn mg nj nk dp mk le nl nm mm li nn no mo lm np nq mq nr bi translated">使用轮廓分析找到“k”的最佳值:</h2><p id="91d2" class="pw-post-body-paragraph kv kw it kx b ky ms ju la lb mt jx ld le mu lg lh li mv lk ll lm mw lo lp lq im bi translated">使用剪影法寻找最佳的聚类数。也可以用肘法找到，但剪影法被认为是比肘法更好的方法。阅读以下文章了解更多信息:</p><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/silhouette-method-better-than-elbow-method-to-find-optimal-clusters-378d62ff6891"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">轮廓法——比肘法更好的寻找最优聚类的方法</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">k-Means聚类中寻找最优聚类的剪影法深度分析</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ko ol"/></div></div></a></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="pb pc di pd bf pe"><div class="gh gi pa"><img src="../Images/c2b7a164fcc3cad173f5f27cd6679b1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3q4HWWqGxWVjKyRzgOv3Vw.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">(图片由作者提供)，<strong class="bd pf">左:</strong>平均距离与聚类数，<strong class="bd pf">右:</strong>剪影得分与聚类数</p></figure><p id="4559" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">轮廓图显示了一个聚类中的每个点与相邻聚类中的点的接近程度，从而提供了一种视觉评估聚类数量等参数的方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="pb pc di pd bf pe"><div class="gh gi pg"><img src="../Images/5e5bc61c5444f56abbb8f7956faa12bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chza-aot9rDFie3H8bZQJA.jpeg"/></div></div></figure><h2 id="2f6a" class="nc mb it bd mc nh ni dn mg nj nk dp mk le nl nm mm li nn no mo lm np nq mq nr bi translated">轮廓分析的关键要点:</h2><ol class=""><li id="bcc0" class="ns nt it kx b ky ms lb mt le ph li pi lm pj lq nx ny nz oa bi translated">从不同n_clusters值的侧影线图和侧影分析，观察到<strong class="kx iu"> n_cluster=3 </strong>是聚类数(k)的最佳值。</li><li id="ad0d" class="ns nt it kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated">在上面的“<em class="pk">剪影分析，用于对样本数据进行KMeans聚类，n_clusters=3 </em>”的图像中，观察到所有聚类[0，1，2]的大部分点的剪影系数大于平均剪影分数。</li><li id="2ebf" class="ns nt it kx b ky ob lb oc le od li oe lm of lq nx ny nz oa bi translated">在上面的“对样本数据进行KMeans聚类的剪影分析，n_clusters=3 ”的图像中，可以观察到，对于cluster_label 2，很少有点具有负剪影系数，可以将其视为异常值。同样对于cluster_label 1，一些点的轮廓系数小于平均轮廓得分，这些点位于远离其聚类中心的聚类边界上。</li></ol><p id="f518" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">要查找异常值，请查找具有负轮廓系数的点，并将其移除。位于远离聚类中心的聚类边界上的点也可以被移除以创建健壮的模型，但是这取决于案例研究。</p><blockquote class="pl pm pn"><p id="47c9" class="kv kw pk kx b ky kz ju la lb lc jx ld po lf lg lh pp lj lk ll pq ln lo lp lq im bi translated"><strong class="kx iu">阅读</strong> <a class="ae ku" rel="noopener" target="_blank" href="/silhouette-method-better-than-elbow-method-to-find-optimal-clusters-378d62ff6891"> <strong class="kx iu">本文</strong> </a> <strong class="kx iu">获得剪影分析的深潜解释，参考</strong> <a class="ae ku" href="https://gist.github.com/satkr7/2a45e3d4af279458b48eba32add0d17e" rel="noopener ugc nofollow" target="_blank"> <strong class="kx iu">要诀</strong> </a> <strong class="kx iu">获得python代码实现。</strong></p></blockquote></div><div class="ab cl pr ps hx pt" role="separator"><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw"/></div><div class="im in io ip iq"><h1 id="26b1" class="ma mb it bd mc md py mf mg mh pz mj mk jz qa ka mm kc qb kd mo kf qc kg mq mr bi translated">参考资料:</h1><p id="a13f" class="pw-post-body-paragraph kv kw it kx b ky ms ju la lb mt jx ld le mu lg lh li mv lk ll lm mw lo lp lq im bi translated">[1]维基百科:<a class="ae ku" href="https://en.wikipedia.org/wiki/Silhouette_(clustering)#:~:text=The%20silhouette%20value%20is%20a,poorly%20matched%20to%20neighboring%20clusters" rel="noopener ugc nofollow" target="_blank">剪影(聚类)</a>，(2020年9月14日)</p><p id="0d4c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">[2] Scikit学习文档:<a class="ae ku" href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_silhouette_analysis.html#sphx-glr-auto-examples-cluster-plot-kmeans-silhouette-analysis-py" rel="noopener ugc nofollow" target="_blank">通过对KMeans聚类进行轮廓分析来选择聚类数</a></p><blockquote class="qd"><p id="0bfa" class="qe qf it bd qg qh qi qj qk ql qm lq dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>