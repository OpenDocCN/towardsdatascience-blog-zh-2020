<html>
<head>
<title>Machine Learning In Healthcare: Detecting Melanoma</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">医疗保健中的机器学习:检测黑色素瘤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-in-healthcare-detecting-melanoma-70147e1b08de?source=collection_archive---------26-----------------------#2020-10-16">https://towardsdatascience.com/machine-learning-in-healthcare-detecting-melanoma-70147e1b08de?source=collection_archive---------26-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fcf6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过应用若干机器学习算法，使用患者的诊断报告和皮肤病变图像来检测病变是癌性的还是非癌性的。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/564559bcd89b239ac2c1edb7de5e7ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*omuIDdgaLgs1gz-a"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@nci?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">国家癌症研究所</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fd06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">皮肤癌是最常见的癌症。它的发生是由于皮肤细胞的异常生长，通常是在暴露于阳光的区域。有三种主要类型的皮肤癌——基底细胞癌、鳞状细胞癌和黑色素瘤。特别是黑色素瘤，尽管它是最不常见的皮肤癌，但却造成了75%的皮肤癌死亡。</p><p id="8eae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">黑色素瘤是一种致命的疾病，但如果早期发现，大多数黑色素瘤可以通过小手术治愈。</p><p id="b3da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将通过应用几种机器学习算法将病变分类为良性或恶性，从患者的诊断记录和皮肤病变的图像中识别黑色素瘤。更好地检测黑色素瘤有机会对数百万人产生积极影响。</p><blockquote class="ls lt lu"><p id="8a48" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">注意:下面的代码是使用Kaggle提供的数据集<a class="ae kv" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/overview" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> SIIM-ISIC黑色素瘤分类</strong> </a>在<strong class="ky ir"> Kaggle内核</strong>上实现的。你可以在这里找到完整的代码。</p></blockquote><p id="c1db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将遵循以下步骤来实现该算法。</p><h2 id="3af3" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">导入库</h2><p id="9033" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">让我们通过在Kaggle内核中导入所需的库来开始实现，如下所示:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5327" class="lz ma iq my b gy nc nd l ne nf">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import cv2<br/>import pydicom as dicom<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn.metrics import accuracy_score, confusion_matrix<br/>from sklearn.metrics import mean_squared_error, r2_score</span></pre><p id="32c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入的<strong class="ky ir"> pydicom </strong>库用于处理数据集中提供的图像。这些图像属于DICOM(医学数字成像和通信)类型，这是传输、存储、检索、打印、处理和显示医学成像信息的国际标准。</p><h2 id="681d" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">分析数据集</h2><p id="f05c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">下一步是导入Kaggle提供的数据集<a class="ae kv" href="https://www.kaggle.com/c/siim-isic-melanoma-classification/overview" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> SIIM-ISIC黑色素瘤分类</strong> </a>。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="6b52" class="lz ma iq my b gy nc nd l ne nf">df = pd.read_csv('/kaggle/input/siim-isic-melanoma-classification/train.csv')<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/466c1e11a80c3337ab8404a043c7736f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1FyYfewWJNX9K7uCroIbQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd nh"> SIIM-ISIC黑色素瘤分类数据集</strong></p></figure><p id="660b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面给出的数据集，我们可以推断黑色素瘤的分类取决于两件事，即<strong class="ky ir">患者的详细信息</strong>和<strong class="ky ir">患者皮肤损伤的图像</strong>。整个过程解释如下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/ef40cfaf7a068ef1dc904206160c8f89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*d8fYOs9YEPz5ix4GKQC1og.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.bbc.com%2Fnews%2Fhealth-29014838&amp;psig=AOvVaw11bK7plKwzkhhqn5fvlne3&amp;ust=1602953848809000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCJDttuvLuewCFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank">源1 </a>、<a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.123rf.com%2Fclipart-vector%2Fhalf_naked.html&amp;psig=AOvVaw3GQHdeMCj0hJAoqnDot1UM&amp;ust=1602953510615000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCMCf6P3LuewCFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank">源2 </a>、<a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.pixtastock.com%2Fillustration%2F14797843&amp;psig=AOvVaw1Q4HP8sPLSKt2VoqmZTA-z&amp;ust=1602954471391000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCPiOqqHNuewCFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank">源3 </a>、<a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.clipartlogo.com%2Fistock%2Fmedical-stethoscope-with-blank-paper-in-clipboard-1610319.html&amp;psig=AOvVaw0yACOpUWz7BEPTtzJd1O8M&amp;ust=1602955442730000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCNDWwcbQuewCFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank">源4 </a></p></figure><p id="f1e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们获取患者的详细信息和皮肤病变图像，然后应用机器学习算法来检测此人是否患有癌症。</p><h2 id="454f" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">图像分类</h2><p id="804d" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">让我们从检测数据集中提供的图像中存在的黑色素瘤开始。</p><p id="9080" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">黑色素瘤迹象包括:</p><ul class=""><li id="3839" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">带有深色斑点的褐色大斑点</li><li id="e105" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">颜色、大小或感觉改变或出血的痣</li><li id="fbab" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">边缘不规则的小病灶，部分呈现红色、粉色、白色、蓝色或蓝黑色</li><li id="f461" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">发痒或灼烧的疼痛损伤</li><li id="7b74" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">手掌、脚底、指尖或脚趾，或口腔、鼻子、阴道或肛门粘膜上的黑色病变</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/c0c2be55e92df53efc781eb17aea76da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMInPt1r2yAyeFY5VslhYA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://www.facebook.com/SchiffertHealthCenter/photos/a.1055867394532801/2991682010951320/?type=1&amp;theater" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="d4fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用这些迹象，机器学习算法将皮肤损伤分类为良性或恶性。</p><p id="7c4e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从从整个数据集中抽取一小部分数据样本来开始实现。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="1a94" class="lz ma iq my b gy nc nd l ne nf">s0 = df.target[df.target.eq(0)].sample(50).index<br/>s1 = df.target[df.target.eq(1)].sample(60).index</span><span id="2a21" class="lz ma iq my b gy ny nd l ne nf">df = df.loc[s0.union(s1)]<br/>df['target'].value_counts()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/8806e014b3429fbe562e58194fa5f714.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-Wwb-tpboco5G6fpE3p4Q.png"/></div></div></figure><p id="4dbc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们新生成的数据集，我们将使用它来训练我们的机器学习模型。</p><p id="d760" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们来看看这些图片。这些图像以DICOM格式呈现，因此我们使用由<strong class="ky ir"> pydicom </strong>库提供的<strong class="ky ir"> dicom.dcmread() </strong>函数来读取图像。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="cc4d" class="lz ma iq my b gy nc nd l ne nf">image = '/kaggle/input/siim-isic-melanoma-classification/train/' + df['image_name'][1512] +'.dcm'</span><span id="7a5a" class="lz ma iq my b gy ny nd l ne nf">ds = dicom.dcmread(image)</span><span id="797e" class="lz ma iq my b gy ny nd l ne nf">plt.imshow(ds.pixel_array)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/7eeb53cd43d03d8ef681329f8a77536a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiZ6nGN6FAaU4hQ9IapTjw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显示恶性和良性癌症区别的图片</p></figure><p id="01d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一步是训练我们的机器学习模型。为了做到这一点，图像应该首先以模型能够理解的格式表示。为此，我们需要将图像转换成像素格式。</p><p id="d124" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，对于数据集中的每个图像，我们使用<strong class="ky ir"> dicom.dmread() </strong>读取图像，并使用<strong class="ky ir"> ds.pixel_array </strong>提取像素。这些像素是多维的，因此我们使用<strong class="ky ir"> flatten </strong>函数将其转换为一维数组。然后，我们将这些像素格式的图像添加到一个名为<strong class="ky ir"> images的列表中。</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="48d2" class="lz ma iq my b gy nc nd l ne nf">images = []</span><span id="32b1" class="lz ma iq my b gy ny nd l ne nf">for x in df['image_name']:<br/>    image = '/kaggle/input/siim-isic-melanoma-classification/train/' + x +'.dcm'<br/>    ds = dicom.dcmread(image)<br/>    pixels = ds.pixel_array<br/>    images.append(pixels.flatten())</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7620dfcaee0e002615f356c378bc46d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*e-FXCvREvOZm8dqNxTqktg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用像素表示图像</p></figure><p id="8a44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，出现的问题是每个图像都有不同数量的像素，因此生成的数组具有不均匀的长度。为了解决这个问题，我们使用填充技术，要么向数组添加额外的值，要么丢弃某些值，以使数组的长度等于指定的最大长度。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="4fa4" class="lz ma iq my b gy nc nd l ne nf">import tensorflow as tf<br/>images = tf.keras.preprocessing.sequence.pad_sequences(<br/>  images,<br/>  maxlen = 720,<br/>  dtype = "int32",<br/>  padding = "pre",<br/>  truncating = "pre",<br/>  value = 0<br/>)</span></pre><p id="85ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还需要一个包含图像的测试数据集来测试我们的模型。我们可以如下生成测试数据集。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="0941" class="lz ma iq my b gy nc nd l ne nf">test = df.tail(50)<br/>test.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a2e0e089511727fd9a733623c5f9aa03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJwZEX5652HHNObrDsGZwg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试数据集</p></figure><p id="3829" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们准备好数据集，我们就重复上面显示的过程。也就是说，我们首先将图像转换为其像素格式，然后应用填充技术，使图像具有相同数量的像素。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="7e7e" class="lz ma iq my b gy nc nd l ne nf">test_images = []<br/>count = 0</span><span id="f67b" class="lz ma iq my b gy ny nd l ne nf">for x in test['image_name']:<br/>    image = '/kaggle/input/siim-isic-melanoma-classification/train/' + x +'.dcm'<br/>    ds = dicom.dcmread(image)<br/>    pixels = ds.pixel_array<br/>    <br/>    test_images.append(pixels.flatten())<br/>    count +=1<br/>    print(count)</span><span id="d120" class="lz ma iq my b gy ny nd l ne nf">test_images = tf.keras.preprocessing.sequence.pad_sequences(<br/>  test_images,<br/>  maxlen = 720,<br/>  dtype = "int32",<br/>  padding = "pre",<br/>  truncating = "pre",<br/>  value = 0<br/>)</span></pre><p id="ad6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，是时候训练我们的模型了。</p><p id="959e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用几种机器学习算法来训练我们的模型，然后测试它以查看准确性得分。</p><p id="1bcf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将设置的值</p><p id="f055" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> X =图像</strong>(包含像素格式图像的列表)</p><p id="8478" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">y = NP . array(df[' target '])</strong>(表示图像中的病变是良性还是恶性的值)</p><p id="51a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。逻辑回归</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="fc26" class="lz ma iq my b gy nc nd l ne nf">from sklearn.linear_model import LogisticRegression</span><span id="2198" class="lz ma iq my b gy ny nd l ne nf">X = images<br/>y = np.array(df['target'])<br/>classifier_lr = LogisticRegression()<br/>classifier_lr.fit(X,y)</span><span id="fa11" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_lr = classifier_lr.predict(X_test)</span><span id="038d" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_lr))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_lr))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/156eea59d33498062a34940eaae71c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*elfLgYuCtB1FGokUi9HE6Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">逻辑回归算法给出的精确度</p></figure><p id="ca4d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2。支持向量机</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="9e71" class="lz ma iq my b gy nc nd l ne nf">from sklearn import svm<br/>X = images<br/>y = np.array(df['target'])<br/>classifier_svm = svm.SVC()<br/>classifier_svm.fit(X,y)</span><span id="84cc" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_svm = classifier_svm.predict(X_test)</span><span id="c85c" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_svm))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_svm))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/13dd593ab24b69f20ff064c51b656dbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*78fVzx8OL7bnX-vaamRCjw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">支持向量机算法给出的精度</p></figure><p id="1f56" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 3。决策树</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="44ce" class="lz ma iq my b gy nc nd l ne nf">from sklearn.tree import DecisionTreeClassifier<br/>X = images<br/>y = np.array(df['target'])<br/>classifier_dt = DecisionTreeClassifier()<br/>classifier_dt.fit(X,y)</span><span id="f3f4" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_dt = classifier_dt.predict(X_test)</span><span id="bdb5" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_dt))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_dt))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/2e4116bfd4fe9ddd7d515b423336641b.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*d4gX1MvgfG7bQRwgK54nhA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">决策树算法给出的精确度</p></figure><p id="87f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 4。随机森林</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e2c0" class="lz ma iq my b gy nc nd l ne nf">from sklearn.ensemble import RandomForestClassifier<br/>X = images<br/>y = np.array(df['target'])<br/>classifier_rf = RandomForestClassifier()<br/>classifier_rf.fit(X,y)</span><span id="a7fa" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_rf = classifier_rf.predict(X_test)</span><span id="bb0e" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_rf))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_rf))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/cdeb0679b40336153fff2358c2db89b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*uFxxchvsTjb7RfTMmg0ngQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机森林算法给出的精确度</p></figure><p id="90f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 5。自适应增压</strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="4d68" class="lz ma iq my b gy nc nd l ne nf">from sklearn.ensemble import AdaBoostClassifier<br/>X = images<br/>y = np.array(df['target'])<br/>classifier_ab = AdaBoostClassifier()<br/>classifier_ab.fit(X,y)</span><span id="486a" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_ab = classifier_ab.predict(X_test)</span><span id="3813" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_ab))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_ab))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d0b2945cfdf2ff1c4c9c66ce8728b248.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*vlKNWxsKLP6OMbIv-Q4NEg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">自适应升压算法给出的精度</p></figure><p id="f205" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">6。梯度增强</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5cb6" class="lz ma iq my b gy nc nd l ne nf">from sklearn.ensemble import GradientBoostingClassifier<br/>X = images<br/>y = np.array(df['target'])<br/>classifier_gb = GradientBoostingClassifier()<br/>classifier_gb.fit(X,y)</span><span id="b0d2" class="lz ma iq my b gy ny nd l ne nf">X_test = test_images<br/>y_test = np.array(test['target'])<br/>y_pred_gb = classifier_gb.predict(X_test)</span><span id="707c" class="lz ma iq my b gy ny nd l ne nf">print('Accuracy Score: ',accuracy_score(y_test,y_pred_gb))<br/>print('Confusion Matrix: \n',confusion_matrix(y_test,y_pred_gb))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/00ef96e870f90eb33523a78058dd5269.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*zgx3jtSta_tjJiR6UDuVwA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由梯度推进算法给出的精度</p></figure><p id="4fca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在使用几种机器学习算法对图像进行训练和测试后，我们得到了不同的准确度。有些算法会使数据过拟合，而有些算法会使数据欠拟合。因此，我们继续使用<strong class="ky ir">逻辑回归</strong>算法，因为它既不过度拟合也不欠拟合数据，给出96%的准确度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/ae46885d3c978e8a620fe7f2e83a72b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5Bvg5rK6HvbxG1MahOQGw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显示使用机器学习算法获得的精确度的条形图</p></figure><h2 id="210f" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">使用病历进行分类</h2><p id="552c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">为了方便起见，我们先将<em class="lv">“anatom _ site _ general _ challenge”</em>重命名为<em class="lv">“site”</em>。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="c9b0" class="lz ma iq my b gy nc nd l ne nf">df = df.rename(columns = {'anatom_site_general_challenge':'site'})</span></pre><p id="d10f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了开始数据的训练，我们首先需要理解数据。让我们应用一些可视化和数据清理技术来更好地解释我们的数据。</p><p id="f1b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们使用以下代码删除数据集中所有缺失的值</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="223c" class="lz ma iq my b gy nc nd l ne nf">df = df.dropna(axis=0, how = 'any')</span></pre><p id="6621" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑到<strong class="ky ir"> age_approx </strong>并作为一个因素，我们可以使用下面的代码来创建如下所示的图表。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d779" class="lz ma iq my b gy nc nd l ne nf">age = []<br/>for i in range(df.shape[0]):<br/>    try: <br/>        if df['target'][i] == 1:<br/>            age.append(df['age_approx'][i]) <br/>    except:<br/>        pass</span><span id="bcac" class="lz ma iq my b gy ny nd l ne nf">plt.figure(figsize=(15,5))</span><span id="40cb" class="lz ma iq my b gy ny nd l ne nf">plt.subplot(1,2,1)<br/>sns.distplot(age)<br/>plt.title('Distribution of age of people having malignant cancer')</span><span id="f70c" class="lz ma iq my b gy ny nd l ne nf">plt.subplot(1,2,2)<br/>sns.countplot(y = age)<br/>plt.ylabel('Age')<br/>plt.title('Count plot of age of people having malignant cancer')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/b65a502f5b8b2e711b670075feb6b67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4TSnFsI8EayX5naBxPGq0Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用age_approx作为因子创建的图表</p></figure><p id="0b5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面的图表中可以推断出以下几点:</p><ul class=""><li id="25d0" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">大多数恶性肿瘤患者的年龄在40至80岁之间</li><li id="3d7c" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">年龄值大于60岁的癌症患者人数最多，其次是年龄值在55至60岁之间的人。</li><li id="5cdf" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">患有癌症且年龄值低于10岁的患者数量非常少。</li></ul><p id="c6a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">考虑到<strong class="ky ir">站点</strong>，作为一个因素，我们可以使用下面的代码来创建下图。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="314d" class="lz ma iq my b gy nc nd l ne nf">site = []<br/>for i in range(df.shape[0]):<br/>    try: <br/>        if df['target'][i] == 1:<br/>            site.append(df['site'][i]) <br/>    except:<br/>        pass</span><span id="bdaa" class="lz ma iq my b gy ny nd l ne nf">sns.countplot(y = site)</span><span id="1297" class="lz ma iq my b gy ny nd l ne nf">sns.countplot(y = site,palette="rocket")<br/>plt.title('Graph showing count of patients having cancer and the site it is located in')<br/>plt.ylabel('Site')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/20e8688c0657d2572eff54af7d1ceed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*PFz62zDHnKz6JLmKL0Vvaw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用站点作为因素创建的图表</p></figure><p id="9aea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面的图表中可以推断出以下几点:</p><ul class=""><li id="9e4e" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated">大多数病人的躯干都有皮肤损伤</li><li id="23f2" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated">极少数患者的手掌/溃疡或口腔/生殖器部位出现皮肤损伤。</li></ul><p id="f00a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，属性<strong class="ky ir">性别、位置</strong>和<strong class="ky ir">诊断</strong>包含分类数据。因此，我们使用<strong class="ky ir"> pandas.get_dummies() </strong>将分类数据转换为模型可以理解的虚拟变量或指示变量。</p><p id="0e64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还删除了不需要的列，<strong class="ky ir">良性_恶性</strong>和<strong class="ky ir">患者id </strong>。</p><p id="2c0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这可以通过以下方式完成:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="b2a8" class="lz ma iq my b gy nc nd l ne nf">df = pd.get_dummies(df, columns = ['sex'],drop_first=True)</span><span id="5bba" class="lz ma iq my b gy ny nd l ne nf">df = pd.get_dummies(df, columns = ['site'],drop_first=True)</span><span id="0fb2" class="lz ma iq my b gy ny nd l ne nf">df = pd.get_dummies(df, columns = ['diagnosis'],drop_first=True)<br/>df = df.drop('diagnosis_unknown', axis = 1)</span><span id="0b98" class="lz ma iq my b gy ny nd l ne nf">df = df.drop(['benign_malignant', 'patient_id'], axis = 1)<br/>df.head()</span></pre><p id="6f4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的数据集现在包含16个属性。下一步是选择正确的属性来训练我们的模型。我们可以通过找出属性和目标之间的相关性来做到这一点。为此，让我们使用以下代码生成一个热图:</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="493e" class="lz ma iq my b gy nc nd l ne nf">plt.figure(figsize = (10,10))<br/>sns.heatmap(df.corr()[['target']].sort_values('target').tail(16), annot = True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/c4a9589b44d6db9732c1404b3456372f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IRXSuKTjIQZkTb2xysRtUg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显示属性和目标之间相关性的热图</p></figure><p id="44e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面的热图可以推断出以下几点:</p><ul class=""><li id="e2dc" class="nj nk iq ky b kz la lc ld lf nl lj nm ln nn lr no np nq nr bi translated"><strong class="ky ir">诊断_黑色素瘤</strong>与目标值直接相关。因此，如果一个人被诊断患有黑色素瘤，他就患有癌症，如果一个人没有被诊断患有黑色素瘤，他就没有癌症。</li><li id="4380" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">年龄_近似值、性别_男性</strong>和<strong class="ky ir">部位_上肢</strong>与目标正相关。</li><li id="2964" class="nj nk iq ky b kz ns lc nt lf nu lj nv ln nw lr no np nq nr bi translated"><strong class="ky ir">诊断痣、部位下肢</strong>和<strong class="ky ir">部位躯干</strong>与目标呈负相关。</li></ul><p id="2355" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这也可以从下图中得到解释。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/d8f7df29de69f716fe6995cfd51dabf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBtBql9f--PI1CjukzLHqw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f1c231cb4a3365f450f19cba1da117f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sjFhDNiEww_Ib_cw-DSRgw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/be1881c88abf1eb409969273260dc962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1ABRAV3yPPPd6C4MDxq0w.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/82eb4813f8938c22e5fc6dcf227fd888.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*DZ1_eCaGX3Sf6pX4TJr6Bg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显示属性和目标之间相关性的图形</p></figure><p id="9ea8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们训练我们的机器学习模型。我们将使用几种机器学习算法来训练我们的模型，然后测试它以查看准确性得分。</p><p id="8fb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们首先创建训练和测试数据集。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8277" class="lz ma iq my b gy nc nd l ne nf">X = df[['diagnosis_melanoma','site_torso','diagnosis_nevus','site_lower extremity','site_upper extremity', 'sex_male', 'age_approx']]</span><span id="d985" class="lz ma iq my b gy ny nd l ne nf">y = df['target']</span><span id="7bb7" class="lz ma iq my b gy ny nd l ne nf">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 1)</span></pre><p id="d418" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要应用分类算法，该算法采用这些属性并根据目标值训练模型。这可以通过使用上面使用的相同算法和程序来训练具有皮肤损伤图像的模型来完成。</p><p id="cbc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在成功训练算法之后，我们获得以下准确度分数:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/dd2b430108fbdb615e7703683af4767c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ykfBRx2106A3c7IebmQKSA.png"/></div></div></figure><p id="b6a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，支持向量机算法没有过度拟合数据，并给出了98%的准确率，我们选择它进行进一步处理。</p><p id="6535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们选择了<strong class="ky ir">逻辑回归</strong>算法来从图像中预测癌症，我们选择了<strong class="ky ir">支持向量机</strong>来基于患者的医疗细节和诊断来预测癌症。</p><p id="da3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的下一步也是最后一步，我们测试患者的全部记录，并检测他或她是否患有癌症。</p><p id="2559" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">患者记录如下:</p><p id="ae16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">image_name = ISIC_0149568</p><p id="49fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">年龄_大约= 55岁</p><p id="696d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">sex_male = 0</p><p id="7fe8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">站点_下肢= 0</p><p id="e7b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">site_torso = 0</p><p id="e3ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">场地_上肢= 1</p><p id="71e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">诊断_黑色素瘤= 1</p><p id="75d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">诊断_痣= 0</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="70a0" class="lz ma iq my b gy nc nd l ne nf">image_path = '/kaggle/input/siim-isic-melanoma-classification/train/ISIC_0149568.dcm'<br/>details = [[55,0,0,0,1,1,0]]<br/>image_to_test = []<br/>ds = dicom.dcmread(image_path)<br/>pixels = ds.pixel_array<br/>plt.imshow(pixels)<br/>image_to_test.append(pixels.flatten())</span><span id="5777" class="lz ma iq my b gy ny nd l ne nf">image_to_test = tf.keras.preprocessing.sequence.pad_sequences(<br/>  image_to_test,<br/>  maxlen = 720,<br/>  dtype = "int32",<br/>  padding = "pre",<br/>  truncating = "pre",<br/>  value = 0<br/>)</span><span id="0b10" class="lz ma iq my b gy ny nd l ne nf">print(train2.predict(image_to_test))</span><span id="4ce5" class="lz ma iq my b gy ny nd l ne nf">if train1.predict(details) == [1]:<br/>    <br/>    result1 = 'Malignant'<br/>else:<br/>    result1 = 'Benign'</span><span id="9302" class="lz ma iq my b gy ny nd l ne nf">if train2.predict(image_to_test) == [1]:<br/>    result2 = 'Malignant'<br/>else:<br/>    result2 = 'Benign'</span><span id="db4e" class="lz ma iq my b gy ny nd l ne nf">print('Result from patient details: ', result1)<br/>print('Result from patient image: ', result2)</span></pre><p id="590c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">图像路径</strong>存储图像名称的路径</p><p id="f357" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">详细信息</strong>存储患者记录的详细信息</p><p id="60ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">训练1 </strong>是使用患者记录训练的模型。</p><p id="e830" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> train2 </strong>是使用患者皮肤病变图像训练的模型。</p><p id="1ee9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">执行代码后，我们得到如下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/031f7714f2c33b9cf9dd18a49ac1e0ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*_y9JLEJEprtGG_mtJBam3Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最终测试后的输出</p></figure><p id="61b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，算法正确地检测出病人患有癌症。因此，我们可以推断，机器学习算法可以有效地用于医疗保健和医疗领域。</p><p id="e2d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.kaggle.com/sakshibutala/siim-isic-melanoma-classification" rel="noopener ugc nofollow" target="_blank">点击此处查看完整代码。</a></p><p id="0c39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想知道如何使用神经网络而不是机器学习算法对图像进行分类<a class="ae kv" rel="noopener" target="_blank" href="/building-and-deploying-an-alphabet-recognition-system-7ab59654c676">点击这里</a>。</p><h2 id="73b0" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">参考</h2><div class="ot ou gp gr ov ow"><a href="https://www.kaggle.com/c/siim-isic-melanoma-classification/overview" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd ir gy z fp pb fr fs pc fu fw ip bi translated">SIIM-国际标准工业分类黑素瘤分类</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">识别病变图像中的黑色素瘤</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">www.kaggle.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk kp ow"/></div></div></a></div><div class="ot ou gp gr ov ow"><a href="https://www.mayoclinic.org/diseases-conditions/skin-cancer/symptoms-causes/syc-20377605" rel="noopener  ugc nofollow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd ir gy z fp pb fr fs pc fu fw ip bi translated">皮肤癌——症状和原因</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">皮肤癌——皮肤细胞的异常生长——通常发生在暴露在阳光下的皮肤上。但是这种常见的形式…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">www.mayoclinic.org</p></div></div><div class="pf l"><div class="pl l ph pi pj pf pk kp ow"/></div></div></a></div></div></div>    
</body>
</html>