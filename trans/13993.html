<html>
<head>
<title>Building a Plotly Dash App from Google Sheets — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Google Sheets构建一个精巧的Dash应用程序——第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10?source=collection_archive---------21-----------------------#2020-09-26">https://towardsdatascience.com/building-a-plotly-dash-app-from-google-sheets-part-1-d37dc41ece10?source=collection_archive---------21-----------------------#2020-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5e93" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Plotly Dash应用程序</h2><div class=""/><div class=""><h2 id="c834" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用众所周知的免费工具构建的非传统仪表板</h2></div><h1 id="5aeb" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">介绍</h1><p id="fe3c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">对于大多数公司的数据科学家或分析师来说，仪表板仍然是一项非常受欢迎的任务。在一个完美的世界中，你可能会连接到大的数据流管道，或者用OLAP立方体建立一个单独的数据仓库，以提供一组复杂的实时分析。然后在应用程序中构建一些漂亮的灵活性，供业务团队用于即席号码。<em class="mf">也许</em>你甚至可以用一些预测算法来增加数据。听起来很有趣。这不是仪表板。</p><p id="d9ef" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">或者，有时您需要围绕现有的一组流程构建一个仪表板，并且尽量不干扰业务。那是仪表板着陆的地方。这个项目的想法是支持一个为<em class="mf">虚构的</em>自行车公司工作的现场营销团队。每个营销人员在全国各地举办实体活动，并需要向营销主管报告活动的类型、规模和频率。此外，这些指标需要跟踪员工奖金激励的进展。这家T4的大公司有很多繁文缛节，部门内部的部门和超负荷工作的IT团队。因此，营销负责人希望有一个非常简单的解决方案，可以在几天内完成，不需要召开3次预算会议来获得批准，也不需要培训现场员工使用新工具。</p><p id="678d" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">输入谷歌表单。我们将使用Google提供的简单、免费且非常熟悉的工具，而不是创建另一个生产级数据存储和web表单来接收数据。这允许团队快速调整和编辑数据。正如你将看到的，谷歌已经提供了一些他们用来构建G-Suite的相同代码，以制作我们自己的定制解决方案。</p><p id="83e1" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">这个项目将分为4个部分。</p><ol class=""><li id="be5a" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me mq mr ms mt bi translated">使用Google和code.gs的设计和ETL过程</li><li id="edc4" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated"><a class="ae mz" href="https://medium.com/p/f35cea7f834c" rel="noopener">将Google Sheets数据连接到python </a></li><li id="9dcf" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated"><a class="ae mz" href="https://medium.com/p/666c496c8a71" rel="noopener">打造一款Plotly Dash app </a></li><li id="fd18" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">在Heroku上主持[即将推出]</li></ol><h2 id="d2b6" class="na ks it bd kt nb nc dn kx nd ne dp lb ls nf ng ld lw nh ni lf ma nj nk lh iz bi translated">我们要建造这个:</h2><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi nl"><img src="../Images/dd64cb999aeab2cd061ca59afa0223d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*No9tanCHtspP0eBKcRMCIA.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">我们示例仪表板的图像——作者提供的图像。</p></figure></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="99f0" class="kr ks it bd kt ku oi kw kx ky oj la lb ki ok kj ld kl ol km lf ko om kp lh li bi translated">第1部分——使用Google和code.gs进行设计和E.T.L</h1><p id="e139" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在开始dashboard和任何应用程序之前，我们必须首先列出构建它所需的重要元素。</p><ol class=""><li id="c2d0" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me mq mr ms mt bi translated">按日期过滤—我们希望允许营销主管查看特定日期范围内的活动</li><li id="76ac" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">聚合值-每个事件都有一个可量化的特征，如在诊所接受教育的员工人数或测试骑过自行车的消费者人数</li><li id="3209" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">地图——每个事件的规模和位置的直观概述，以便团队识别覆盖范围的缺口</li><li id="9e3e" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">季度日期范围—现场营销团队按季度获得奖金，我们需要按此固定日期进行筛选</li></ol><p id="79a4" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">为了构建这个项目，我们将创建一个简单的<a class="ae mz" href="https://www.google.com/forms/about/" rel="noopener ugc nofollow" target="_blank">谷歌表单</a>。这对于调查和快速数据输入来说非常方便，并且允许数据验证，比如日期和所需的响应，就像典型的SQL db一样。此外，Google Forms会将每个响应存储在一个Google Sheet中，作为我们Dashboard应用程序的数据源。</p><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi on"><img src="../Images/599efef03d3c8864d8038845a11a8ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a8A-CVIqtw_uMXaFsoHEIw.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">谷歌表单样本——作者图片。</p></figure><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi oo"><img src="../Images/e552fc568a1ea1e2e66403f5e8309c50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BqZyelSe2mHt4hPI0o0Meg.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">带有表单响应的Google表单—作者图片</p></figure><h1 id="7f0d" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">地理编码</h1><p id="2258" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">在上述需求中，几乎所有需求都可以在python中以足够快的速度处理，以加载一个应用程序。然而，在Plotly中在地图上绘制坐标的最佳方法是使用纬度和经度。我不想让营销团队在提交Google表单时查找这些坐标，从而使数据输入变得复杂。在这一点上，我无法找到一个预建的Google form解决方案来整合地图，以实现“放下大头针”的解决方案(也许是我的下一个项目想法？).我发现将地址转换成坐标需要调用python中的API，我想在我们的仪表板加载时避免这种情况。</p><p id="f168" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">然而，在Google产品套件中，有一个内部API可以快速调用经度和纬度。接下来，我们将在新的Google Sheet中编写一个脚本，将纬度和经度附加到Google Sheet中存储响应的最后一列。</p><h1 id="9270" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">code.gs</h1><p id="966f" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><a class="ae mz" href="https://developers.google.com/apps-script/reference" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/apps-script/reference</a></p><p id="8d68" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">Google Apps Script是一个非常强大的工具，它允许您构建脚本函数来执行Google表单、文档或幻灯片中尚不存在的任务。code.gs的名字是Node.js的巧妙变化，因为这种脚本语言与基于javascript的语言的外观和感觉有很多相似之处。该工具允许您将自定义函数写入您的电子表格(或任何g-suite工具！)可以像在工作表中使用<code class="fe op oq or os b">=SUM(A1:A5)</code>一样使用。或者您可以使用它连接到您的Google日历，在Google文档中查找会议请求。我不是用javascript写的，也没见过多少代码，但是对代码有一些基本的理解可以让你开始运行一些东西。</p><p id="2c07" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">Sheets脚本语言的核心建立在几个类上，如<code class="fe op oq or os b">.sheet()</code>或<code class="fe op oq or os b">.range()</code>或<code class="fe op oq or os b">.cell()</code>，这允许脚本在工作表中找到特定信息，进行一些转换，并将新值返回到另一个特定位置。正是我们要找的。</p><p id="4889" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">此外，还有很多很多类可以使用其他谷歌服务，比如<a class="ae mz" href="https://developers.google.com/apps-script/reference/maps/geocoder" rel="noopener ugc nofollow" target="_blank">地图类</a>中的<code class="fe op oq or os b">Maps.newGeocoder()</code>。有了这个类，我们就可以在脚本中使用健壮的谷歌地图服务，从<em class="mf">非常基本的</em>城市或邮政编码数据中调用我们的纬度和经度。</p><p id="2345" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">因此，为了准备仪表板的数据，要完成的第一项任务是运行一个脚本来插入纬度和经度。</p><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi ot"><img src="../Images/9faa60c1fd6310859d56ea1b773583e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dA4PeHtPWe0jMEgErS7KpA.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">在带有表单响应的Google表单中，打开脚本编辑器——作者图片</p></figure><p id="62e9" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">在Will Geary 的这篇教程的帮助下，我能够在code.gs中创建一个函数来查找地址并插入纬度/经度坐标:</p><figure class="nm nn no np gt nq"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="24d7" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">如果您熟悉javascript，您可能会找到更简洁或更好的方式来编写这些代码。在伪代码中，这个函数的作用如下:</p><ol class=""><li id="7ae0" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me mq mr ms mt bi translated">第2行:从特定于<em class="mf">的</em>电子表格中获取数据。我有不确定性，因为我阅读的许多文档和我找到的示例代码片段似乎使用了这一行的通用版本，它只要求“当前的电子表格”。这个想法是，这个函数被专门绑定到我打开脚本编辑器的表单上。为了安全起见，我已经输入了该表的确切ID。我不希望这个函数意外地将数据写入我的Google drive中的另一个工作表。您可以在下面找到唯一的ID:</li></ol><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi ow"><img src="../Images/d52abf4ed7d7bf1f39d05054c4172e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4Gg2CEVFuUOSTuXvBJwHw.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">Google工作表的唯一ID—按作者分类的图片</p></figure><ol class=""><li id="226b" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me mq mr ms mt bi translated">从G列开始，检查下一行的数据。这将创建一系列包含数据的行。</li><li id="b55c" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">从第2列到第7列中抓取我们刚刚找到的范围长度的单元格块，以获得每一行的邮政编码</li><li id="4dfd" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">遍历每个单元格并创建一个纬度/经度数据的列表——是的，每次函数运行时都会遍历整个列表，这是一种浪费的编程。但是，我选择保留这一步，以防有人稍后对响应表单中的数据进行手动更改，并且数据不太可能超过1000行。</li><li id="0a57" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">将此数据列表插入工作表的最后一列。这不包括检查最后一列数据的逻辑。它被明确地告知去AB和AC列。如果对Google表单进行了修改并添加了问题，您将需要手动更新该脚本。</li></ol><p id="63ef" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">Logger.log是一个很好的工具，可以测试过程中的各个步骤，并查看每个变量是否都按照应有的方式存储。</p><h1 id="f162" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">功能触发器</h1><p id="7011" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">仪表板构建的第1部分中的最后一步是配置将运行该脚本的触发器。谷歌让这变得超级简单。标准的选择是当文件被打开或数据被更改时运行脚本，但是这只能识别用户的更改，而不能识别由Google表单或其他脚本所做的更改。很简单，Google还设置了一个基于表单提交的特定触发事件。</p><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi ox"><img src="../Images/2b5f0d61475d466b0ac705c246bae06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIwfP1NO7dUbjQ8919W2Qg.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">1.从脚本编辑器中打开项目触发器—按作者排序的图像</p></figure><figure class="nm nn no np gt nq gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/046d50ff3d84f39a40aa238b3cda02d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*BXmq3bGej7FiBlA9bojg8g.png"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">2.为此脚本添加一个新的触发器—作者图片</p></figure><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi oz"><img src="../Images/bf20060a1bba3e6083ac063b99d03970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvy6pT4dMC9YjRLlM79ZsQ.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">3.用您需要的设置配置您的新触发器—按作者分类的图像</p></figure><h1 id="08b9" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">Code.gs</h1><p id="03a8" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">Code.gs在这里是一个非常酷的工具。它有如此大的潜力，将极大地帮助我的实际工作。如果您的公司已经在使用G-suite，那么使用您团队的现有流程，并添加一些自定义功能，作为mvp步骤来帮助他们。许多销售团队将为单个客户或项目存储他们的信息大型电子表格，只需要一点数据帮助。使用地图功能、电子邮件或日历连接工作表。</p><h1 id="fd76" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">将Python连接到Google Docs API</h1><p id="824c" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">接下来，我们将把我们的应用程序直接连接到谷歌表单中的实时数据。</p><p id="0ef0" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">最初的搜索把我带到了Google Docs Quickstar页面。虽然它很全面，对于你可能在命令行中运行的应用程序来说也很棒，但对于我们在Heroku上托管这个应用程序的最终目标来说，它并不起作用。</p><p id="d85e" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">更好的解决方案是使用<a class="ae mz" href="https://cloud.google.com/iam/docs/understanding-service-accounts" rel="noopener ugc nofollow" target="_blank">谷歌服务账户</a>。</p><p id="481c" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">谢天谢地，另一个来自<a class="ae mz" href="https://medium.com/@denisluiz" rel="noopener">的帖子完美地解释了我们在这里需要做什么。</a></p><div class="pa pb gp gr pc pd"><a href="https://medium.com/@denisluiz/python-with-google-sheets-service-account-step-by-step-8f74c26ed28e" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">Python与Google Sheets服务帐户:一步一步</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">几天前，我第一次体验了Google Sheets API。我原以为这是一个简单的任务，但是，嗯…不是。</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">medium.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr nv pd"/></div></div></a></div><p id="27a8" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">我不可能比上面的链接写得更好。相反，我会强调我在这个过程中遇到的地方，并指出我们将为我们的应用程序做出的一些轻微的偏差。</p><ol class=""><li id="32f1" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me mq mr ms mt bi translated">添加你的电子邮件——也许我读教程读得太快了，或者我认为因为我的个人电子邮件负责API和Google表单，权限已经设置好了。您需要将特殊的API电子邮件添加到Google工作表的“共享”部分，就像您邀请同事进行编辑一样。</li></ol><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi ps"><img src="../Images/17fd34e8f73ab228c856100bb52b08f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g68X5My5YKAMbtkL6_IJqg.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">服务帐户设置屏幕截图-按作者分类的图像</p></figure><p id="40b2" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">2.安装Google客户端库——像许多数据科学项目一样，我使用Anaconda作为包管理器。我总是试着用它来管理依赖项，并在安装了其他包之后，把安装pip作为最后的选择。令人欣慰的是，Anaconda <code class="fe op oq or os b">conda install -c conda-forge google-api-python-client google-auth-httplib2 google-auth-oauthlib</code>中也包含了连接到Google API所需的包。最终，当我们到达将应用程序加载到Heroku的最后一步时，这些包将与pip一起下载，但在我测试时，我喜欢使用Anaconda。</p><p id="b3b6" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">3.<strong class="ll jd">stringy凭据— </strong>如果我们要将该应用程序与Heroku一起使用，这与上面的中级教程有很大的不同。代替应用程序在当前工作目录中查找credentials.json文件，我们将使用。json文件作为一个大字符串，并在我们的函数中将其转换回json。</p><p id="6c24" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">这是为了防止我们传递凭证文件并可能暴露它。Heroku有一个内置的系统来传递这样的环境变量到我们的应用程序，就像我们的本地系统一样。</p><p id="c0d2" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">现在，为了在本地测试我们的项目，我们需要将它们添加到<strong class="ll jd">中。bashrc </strong>或<strong class="ll jd">。zshrc </strong>文件。如果你以前没有这样做过:<a class="ae mz" href="https://medium.com/@youngstone89/setting-up-environment-variables-in-mac-os-28e5941c771c" rel="noopener">来自김영석的精彩教程</a></p><ul class=""><li id="af40" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me pt mr ms mt bi translated">在文本编辑器中打开凭证文件，高亮显示并复制所有的凭证文件(包括<code class="fe op oq or os b">{</code> &amp; <code class="fe op oq or os b">}</code>)。</li><li id="5764" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me pt mr ms mt bi translated">打开你的。bashrc文件并添加新的环境变量，用单引号<code class="fe op oq or os b">'</code> <code class="fe op oq or os b">'</code>将您要粘贴的信息括起来:</li><li id="e993" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me pt mr ms mt bi translated"><code class="fe op oq or os b">export GDRIVE_AUTH='&lt;paste your credentials here&gt;'</code></li></ul><p id="5c19" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">4.找到要连接的数据的工作表ID。重复上述步骤，为它创建一个环境变量。</p><figure class="nm nn no np gt nq gh gi paragraph-image"><div role="button" tabindex="0" class="nr ns di nt bf nu"><div class="gh gi ow"><img src="../Images/835ca162106a6484e74cfd9106561a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pMR4op0iKaMaDssZ.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">Google表单的唯一ID——按作者分类的图片</p></figure><ul class=""><li id="bbfe" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me pt mr ms mt bi translated"><code class="fe op oq or os b">export SPREADSHEET_ID='&lt;paste your unique ID here&gt;'</code></li></ul><p id="0fa6" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">5.最后，在工作表中添加需要数据的特定区域作为环境变量</p><ul class=""><li id="3adb" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me pt mr ms mt bi translated"><code class="fe op oq or os b">export RANGE_NAME='Form Responses 1!A1:AF'</code></li></ul><h1 id="5099" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">去拿数据</h1><p id="a2e7" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">我们的Python代码中的第一个任务是调用Google Sheet API，并用最新的值创建一个Pandas DataFrame。</p><p id="0e79" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">Pandas将允许我们在创建图表和视觉效果之前对数据进行大量的操作，并且会以足够快的速度完成这个网页。</p><figure class="nm nn no np gt nq"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="8cd8" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">这个函数需要我们刚刚提到的三个全局变量来定义Google Sheet API应该寻找什么。在最终的Dash应用程序脚本中，我们将在上面的函数之前定义这些。</p><ul class=""><li id="7080" class="ml mm it ll b lm mg lp mh ls mn lw mo ma mp me pt mr ms mt bi translated"><code class="fe op oq or os b">SPREADSHEET_ID = &lt;the unique code from the URL of the Sheet&gt;</code></li><li id="e7ba" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me pt mr ms mt bi translated"><code class="fe op oq or os b">RANGE_NAME = &lt;The name of the tab and range to look for&gt;</code></li><li id="feb8" class="ml mm it ll b lm mu lp mv ls mw lw mx ma my me pt mr ms mt bi translated"><code class="fe op oq or os b">CREDS = The stringified version of our Google API Credentials above</code></li></ul><p id="eba7" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">接下来，我们添加一个简单的函数，将电子表格中的值转换成Pandas数据帧。</p><figure class="nm nn no np gt nq"><div class="bz fp l di"><div class="ou ov l"/></div></figure><p id="817c" class="pw-post-body-paragraph lj lk it ll b lm mg kd lo lp mh kg lr ls mi lu lv lw mj ly lz ma mk mc md me im bi translated">现在，我们准备用结果数据创建一个Plotly Dash应用程序。</p><h1 id="6d97" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">结论</h1><p id="5474" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这里，我们已经完成了构建仪表板的第一部分。我们现在有了一个从我们的数据存储中获取最新数据的流程，然后我们将构建一些可视化并将应用程序部署到Heroku。</p><h2 id="2a5c" class="na ks it bd kt nb nc dn kx nd ne dp lb ls nf ng ld lw nh ni lf ma nj nk lh iz bi translated">第二部分:</h2><p id="0b30" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">构建一个Plotly Dash应用程序</p><div class="pa pb gp gr pc pd"><a href="https://medium.com/@derrickjameslewis/building-a-plotly-dash-app-from-google-sheets-part-3-666c496c8a71" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">从Google Sheets构建一个精巧的Dash应用程序——第3部分</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">到目前为止，我们已经创建了一个免费的用户友好的数据存储，并通过Python API连接到它</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">medium.com</p></div></div><div class="pm l"><div class="pu l po pp pq pm pr nv pd"/></div></div></a></div></div></div>    
</body>
</html>