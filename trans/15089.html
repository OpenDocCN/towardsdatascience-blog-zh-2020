<html>
<head>
<title>How To Create And Use Custom Matplotlib Style Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建和使用自定义Matplotlib样式表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-and-use-custom-matplotlib-style-sheet-9393f498063?source=collection_archive---------10-----------------------#2020-10-17">https://towardsdatascience.com/how-to-create-and-use-custom-matplotlib-style-sheet-9393f498063?source=collection_archive---------10-----------------------#2020-10-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="6f55" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak">为什么要使用样式表？</strong></h1><p id="aa09" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">数据可视化的美感非常重要。我经常认为这是“漂亮的数据应该得到漂亮的展示”——过分讲究图表样式是不被鼓励的，但是适当的润色会大有帮助。</p><p id="0122" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">然而，对于我们通常用matplotlib或seaborn制作的静态图，默认的美学通常需要调整。这就是定制样式表派上用场的地方，至少有两个原因:</p><ul class=""><li id="4102" class="lo lp iq kn b ko lj ks lk kw lq la lr le ls li lt lu lv lw bi translated">使我们的工作流程符合不重复(DRY)原则:我们不需要每次都重复输入相同的样式代码。相反，我们用一行代码来应用样式表</li><li id="f9e0" class="lo lp iq kn b ko lx ks ly kw lz la ma le mb li lt lu lv lw bi translated">风格一致性很容易实现，这可能是个人、团队和组织的隐含特征</li></ul><h1 id="afc2" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">如何设置和使用自定义样式表</h1><h2 id="bd72" class="mc jo iq bd jp md me dn jt mf mg dp jx kw mh mi kb la mj mk kf le ml mm kj mn bi translated">从内置示例开始</h2><p id="6db4" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们大多数人可能已经在日常工作中使用了一些内置的风格。例如，快速运行</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="917b" class="mc jo iq mt b gy mx my l mz na"># This code snippet mimics command usages in ipython console</span><span id="39e1" class="mc jo iq mt b gy nb my l mz na">In [1]: import matplotlib.pyplot as plt</span><span id="40b1" class="mc jo iq mt b gy nb my l mz na">Out [1]: plt.style.available</span></pre><p id="b656" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">将返回样式表的完整列表，我们可以在matplotlib的文档中找到它们效果的图库视图。</p><p id="314a" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">在引擎盖下，我们可以找到这些内置的样式表并看一看:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="2f45" class="mc jo iq mt b gy mx my l mz na"># This code snippet mimics command usages in ipython console</span><span id="261e" class="mc jo iq mt b gy nb my l mz na">In [2]: import matplotlib</span><span id="dcdd" class="mc jo iq mt b gy nb my l mz na"># Locate path to matplotlib by checking where config file is<br/># To learn more about the function below,<br/># type ?matplotlib.matplotlib_fname</span><span id="6215" class="mc jo iq mt b gy nb my l mz na">In [3]: matplotlib.matplotlib_fname()<br/>Out [3]: '/Users/sdou/opt/miniconda3/lib/python3.8/site-packages/matplotlib/mpl-data/matplotlibrc'</span></pre><p id="d1df" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">路径<code class="fe nd ne nf mt b">/Users/.../mpl-data</code>是我们想要去的地方，并且定位样式表:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="b54e" class="mc jo iq mt b gy mx my l mz na">In [4]: !ls /Users/sdou/opt/miniconda3/lib/python3.8/site-packages/matplotlib/mpl-data/<br/>fonts           images          matplotlibrc    stylelib</span></pre><p id="5541" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">感兴趣的文件夹是<code class="fe nd ne nf mt b">stylelib</code>。现在让我们来看看这个文件夹:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="0fb4" class="mc jo iq mt b gy mx my l mz na">In [5]: !ls -1 /Users/sdou/opt/miniconda3/lib/python3.8/site-packages/matplotlib/mpl-data/stylelib/<br/>Solarize_Light2.mplstyle<br/>_classic_test_patch.mplstyle<br/>bmh.mplstyle<br/>classic.mplstyle<br/>dark_background.mplstyle<br/>fast.mplstyle<br/>fivethirtyeight.mplstyle<br/>ggplot.mplstyle<br/>grayscale.mplstyle<br/>seaborn-bright.mplstyle<br/>seaborn-colorblind.mplstyle<br/>seaborn-dark-palette.mplstyle<br/>seaborn-dark.mplstyle<br/>seaborn-darkgrid.mplstyle<br/>seaborn-deep.mplstyle<br/>seaborn-muted.mplstyle<br/>seaborn-notebook.mplstyle<br/>seaborn-paper.mplstyle<br/>seaborn-pastel.mplstyle<br/>seaborn-poster.mplstyle<br/>seaborn-talk.mplstyle<br/>seaborn-ticks.mplstyle<br/>seaborn-white.mplstyle<br/>seaborn-whitegrid.mplstyle<br/>seaborn.mplstyle<br/>tableau-colorblind10.mplstyle</span></pre><p id="3597" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">让我们检查一份<code class="fe nd ne nf mt b">.mplstyle</code>文件。这里我们以<code class="fe nd ne nf mt b">classic.mplstyle</code>为例，显示文件的前37行:</p><figure class="mo mp mq mr gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi ng"><img src="../Images/ceb19e33bdc278a6110e1e8b530502b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rh2AvrABsxjcNDI1I_Mu6A.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">图classic.mplstyle”文件的前37行(37行是任意选择)</p></figure><p id="c5fe" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">我们可以看到matplotlib参数设置及其默认值的综合列表，参数被组织成<code class="fe nd ne nf mt b">lines</code>、<code class="fe nd ne nf mt b">markers</code>、<code class="fe nd ne nf mt b">patch</code>、<code class="fe nd ne nf mt b">text</code>等组。</p><h2 id="1ba0" class="mc jo iq bd jp md me dn jt mf mg dp jx kw mh mi kb la mj mk kf le ml mm kj mn bi translated">打造定制。mplstyle文件</h2><h2 id="ecc5" class="mc jo iq bd jp md me dn jt mf mg dp jx kw mh mi kb la mj mk kf le ml mm kj mn bi translated">极简主义的例子</h2><p id="8317" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">下面是一个建立在内置样式表<code class="fe nd ne nf mt b">seaborn-colorblind.mplstyle</code>之上的极简示例(名为<code class="fe nd ne nf mt b">signature.mplstyle</code></p><figure class="mo mp mq mr gt nh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="5277" class="mc jo iq bd jp md me dn jt mf mg dp jx kw mh mi kb la mj mk kf le ml mm kj mn bi translated">如何调用自定义样式表</h2><ul class=""><li id="d983" class="lo lp iq kn b ko kp ks kt kw nu la nv le nw li lt lu lv lw bi translated">如果我们对上述路径<code class="fe nd ne nf mt b">stylelib</code>有写权限，我们可以将自定义样式表放入同一个文件夹，并使用</li></ul><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="745b" class="mc jo iq mt b gy mx my l mz na"># Scenario 1: Apply globally to a jupyter notebook<br/>plt.style.use(“signature”)</span><span id="0eb3" class="mc jo iq mt b gy nb my l mz na"># Scenario 2: Apply locally with context manager<br/>with plt.style.context("signature"):<br/>    plt.plot([1, 2, 3, 4])</span></pre><ul class=""><li id="f0fd" class="lo lp iq kn b ko lj ks lk kw lq la lr le ls li lt lu lv lw bi translated">如果我们没有写权限，我们需要做的唯一额外的事情就是包含自定义样式表的完整路径。这里我们使用一个简单的例子，将样式表直接存储在主目录下:</li></ul><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="1a18" class="mc jo iq mt b gy mx my l mz na"># Scenario 1: Apply globally to a jupyter notebook<br/>plt.style.use(“/home/signature.mplstyle”)</span><span id="a41a" class="mc jo iq mt b gy nb my l mz na"># Scenario 2: Apply locally with context manager<br/>with plt.style.context("/home/signature.mplstyle"):<br/>    plt.plot([1, 2, 3, 4])</span></pre><h2 id="3c64" class="mc jo iq bd jp md me dn jt mf mg dp jx kw mh mi kb la mj mk kf le ml mm kj mn bi translated">如何恢复默认</h2><p id="a1a1" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">有些情况下，我们希望恢复默认样式。有两种方法可以恢复默认设置:</p><ol class=""><li id="750e" class="lo lp iq kn b ko lj ks lk kw lq la lr le ls li nx lu lv lw bi translated">通过<code class="fe nd ne nf mt b">rcParams.update</code>复位</li></ol><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a244" class="mc jo iq mt b gy mx my l mz na">import matplotlib as mpl<br/>mpl.rcParams.update(mpl.rcParamsDefault)</span></pre><p id="4ccb" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">2.用默认样式表重置</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="e556" class="mc jo iq mt b gy mx my l mz na">plt.style.use('default')</span></pre><h1 id="c91b" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">数据即例子:样式表在行动</h1><p id="b5f3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这里我们以<a class="ae nc" href="https://www.kaggle.com/parulpandey/penguin-dataset-the-new-iris" rel="noopener ugc nofollow" target="_blank">企鹅数据集</a>为例来演示自定义样式表<code class="fe nd ne nf mt b">signaure.mplstyle</code>的效果。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="9a30" class="mc jo iq mt b gy mx my l mz na">import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="8ed5" class="mc jo iq mt b gy nb my l mz na"># Load the penguins dataset<br/>penguins = sns.load_dataset("penguins")</span></pre><ol class=""><li id="5290" class="lo lp iq kn b ko lj ks lk kw lq la lr le ls li nx lu lv lw bi translated">使用默认样式</li></ol><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="b854" class="mc jo iq mt b gy mx my l mz na">plt.style.use("default")<br/># Show the joint distribution using kernel density estimation<br/>g = sns.jointplot(<br/>    data=penguins,<br/>    x="bill_length_mm",<br/>    y="bill_depth_mm",<br/>    hue="species",<br/>    kind="kde",<br/>)<br/>g.fig.suptitle("Styled With Default Style Sheet", y=1.01)<br/>plt.show()</span></pre><figure class="mo mp mq mr gt nh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/70b3679e1b3b846d6546e5bd7f8d1d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*PLKEC8PnWTfwa6TJOuGboQ.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">图matplotlib默认样式的效果</p></figure><p id="cf7f" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">2.使用<code class="fe nd ne nf mt b">signature.mplstyle</code>中的自定义样式集</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="a61e" class="mc jo iq mt b gy mx my l mz na">plt.style.use("signature")<br/># Show the joint distribution using kernel density estimation<br/>g = sns.jointplot(<br/>    data=penguins,<br/>    x="bill_length_mm",<br/>    y="bill_depth_mm",<br/>    hue="species",<br/>    kind="kde",<br/>)<br/>g.fig.suptitle("Styled With Custom Style Sheet", y=1.01)<br/>plt.show()</span></pre><figure class="mo mp mq mr gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nz"><img src="../Images/2306222a6798fa026124887c634c2512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*J4GDexjZKE9Zsy5zc0Tvsg.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">图3:定制样式表“signature.mpl”的效果</p></figure><h1 id="4396" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">关键要点</h1><ul class=""><li id="07ac" class="lo lp iq kn b ko kp ks kt kw nu la nv le nw li lt lu lv lw bi translated">漂亮的数据值得漂亮的展示。但是，与其重复输入大量的样式代码，不如花一点前期时间建立我们自己的定制样式表(文件扩展名<code class="fe nd ne nf mt b">.mplstyle</code>)既能节省时间，又能确保样式的一致性</li><li id="bd87" class="lo lp iq kn b ko lx ks ly kw lz la ma le mb li lt lu lv lw bi translated">要构建定制样式表，我们可以从内置样式表开始，并根据我们的喜好进一步定制它们。关键的一步是在<code class="fe nd ne nf mt b">matplotlib.matplotlib_fname()</code>的帮助下找到这些样式表</li></ul><h1 id="27c4" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">参考</h1><p id="f804" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><a class="ae nc" href="https://jakevdp.github.io/PythonDataScienceHandbook/04.11-settings-and-stylesheets.html" rel="noopener ugc nofollow" target="_blank"> 4.11定制Matplotlib:配置和样式表</a>:Jake Vander plas的《数据科学手册》</p></div></div>    
</body>
</html>