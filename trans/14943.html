<html>
<head>
<title>How to Build a Serverless Application using AWS Chalice</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用AWS Chalice构建无服务器应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-serverless-application-using-aws-chalice-91024416d84f?source=collection_archive---------21-----------------------#2020-10-14">https://towardsdatascience.com/how-to-build-a-serverless-application-using-aws-chalice-91024416d84f?source=collection_archive---------21-----------------------#2020-10-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b8fb" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">动手教程</a>，云计算系列</h2><div class=""/><div class=""><h2 id="669f" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">立即构建和部署基于Python的无服务器REST API</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8b43d965db41188ac8858418d7345172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LPKqbMoSIuzLQaOu_t64MQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片作者。由<a class="ae le" href="https://www.canva.com/p/pixabay/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>通过<a class="ae le" href="https://www.canva.com/media/MADQ4_ajPZc" rel="noopener ugc nofollow" target="_blank"> Canva </a>生成的原始图像</p></figure><p id="65eb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我最近偶然发现了AWS Chalice，并被它提供的简单性和可用性迷住了。AWS Chalice是一个无服务器框架，允许您使用Python构建无服务器应用程序，并使用Amazon API Gateway和AWS Lambda将它们部署在AWS上。</p><p id="a99d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我决定尝试一下，并在几分钟之内在AWS上创建和部署了一个示例REST API。在本文中，我将带您了解构建和部署一个无服务器应用程序所需的步骤，该应用程序使用AWS Chalice从Google News获取最新新闻。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="6e7e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">先决条件</h1><p id="778d" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">本教程需要一个AWS帐户。如果你还没有，那么<a class="ae le" href="https://aws.amazon.com/premiumsupport/knowledge-center/create-and-activate-aws-account/" rel="noopener ugc nofollow" target="_blank">创建一个</a>。我们的应用程序将只使用自由层资源，因此成本应该不是问题。您还需要配置安全性，并为您的访问创建用户和角色。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="4332" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">配置AWS凭据</h1><p id="5e81" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">Chalice在幕后使用AWS命令行界面(CLI)来部署项目。如果您以前没有使用过AWS CLI来处理AWS资源，您可以按照这里的指南<a class="ae le" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank">安装它</a>。</p><p id="f00e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">安装完成后，您需要<a class="ae le" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html" rel="noopener ugc nofollow" target="_blank">配置</a>您的AWS CLI，以使用来自您的AWS帐户的凭证。</p><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="f0a7" class="nk mj iq ng b gy nl nm l nn no">$ aws configure                       <br/>AWS Access Key ID [****************OI3G]:<br/>AWS Secret Access Key [****************weRu]:<br/>Default region name [us-west-2]:<br/>Default output format [None]:</span></pre><h1 id="5896" class="mi mj iq bd mk ml np mn mo mp nq mr ms kf nr kg mu ki ns kj mw kl nt km my mz bi translated">安装圣杯</h1><p id="d7e3" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">接下来，你需要安装圣杯。在本教程中，我们将使用Python 3，但是您可以使用AWS Lambda支持的任何Python版本。</p><h2 id="9606" class="nk mj iq bd mk nu nv dn mo nw nx dp ms lo ny nz mu ls oa ob mw lw oc od my iw bi translated">验证Python安装</h2><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="1ce2" class="nk mj iq ng b gy nl nm l nn no">$ python3 --version<br/>Python 3.8.6</span></pre><h2 id="e1da" class="nk mj iq bd mk nu nv dn mo nw nx dp ms lo ny nz mu ls oa ob mw lw oc od my iw bi translated">安装圣杯</h2><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="e760" class="nk mj iq ng b gy nl nm l nn no">$ python3 -m pip install chalice</span></pre><h2 id="f0c3" class="nk mj iq bd mk nu nv dn mo nw nx dp ms lo ny nz mu ls oa ob mw lw oc od my iw bi translated">验证圣杯安装</h2><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="b9ea" class="nk mj iq ng b gy nl nm l nn no">$ chalice --version<br/>chalice 1.20.0, python 3.8.6, darwin 19.6.0</span></pre></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="742d" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">创建项目</h1><p id="d641" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">接下来，运行<code class="fe oe of og ng b">chalice</code>命令创建一个新项目:</p><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="73f9" class="nk mj iq ng b gy nl nm l nn no">$ chalice new-project daily-news</span></pre><p id="854c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将在当前目录下创建一个<code class="fe oe of og ng b">daily-news</code>文件夹。你可以看到Chalice在这个文件夹中创建了几个文件。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/a2faefcfc58eb71754c51833382a7977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuUtJjyVDWNWs45vv_13xg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="277e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们看看<code class="fe oe of og ng b">app.py</code>文件:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="2a46" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe oe of og ng b">new-project</code>命令创建了一个定义单一视图的示例应用程序，<code class="fe oe of og ng b">/</code>在被调用时返回JSON主体<code class="fe oe of og ng b">{"hello": "world"}</code>。您现在可以修改这个模板并添加更多代码来阅读来自Google的新闻。</p><p id="8648" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将使用Google的RSS提要，并且需要一个名为Beautiful Soup的Python库来解析XML数据。您可以使用<code class="fe oe of og ng b">pip</code>安装Beautiful Soup及其XML解析库。</p><pre class="kp kq kr ks gt nf ng nh ni aw nj bi"><span id="274e" class="nk mj iq ng b gy nl nm l nn no">$ python3 -m pip install bs4<br/>$ python3 -m pip install lxml</span></pre><p id="ac34" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来将下面的导入添加到<code class="fe oe of og ng b">app.py</code>。这实际上增加了从<code class="fe oe of og ng b">urllib</code>进行HTTP调用的导入和从<code class="fe oe of og ng b">bs4</code>解析XML的导入。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="c8f5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，您需要添加一个方法来从Google获取RSS提要，解析它以提取新闻标题和发布日期，并创建一个新闻条目列表。为此，将以下代码添加到您的<code class="fe oe of og ng b">app.py</code>中</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="5de8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">更新<code class="fe oe of og ng b">app.py</code>中的index方法来调用它并返回新闻条目列表作为结果。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="5458" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">请注意，您安装了一些依赖项来使代码工作。这些依赖项是本地安装的，在运行时对AWS Lambda容器不可用。为了使它们对AWS Lambda可用，您需要将它们与您的代码打包在一起。为此，将以下内容添加到<code class="fe oe of og ng b">requirements.txt</code>文件中。在构建期间，Chalice将这些依赖项打包成代码的一部分，并作为Lambda函数的一部分上传。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oi oj l"/></div></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="ab73" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">部署项目</h1><p id="024b" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">让我们部署这个应用程序。从<code class="fe oe of og ng b">daily-news</code>文件夹中，运行<code class="fe oe of og ng b">chalice deploy</code>命令。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/65dff192010e1eb38f29782ff7dc50b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4f9d8AQ5n_iYi4gcvZ5MFQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">部署(图片由作者提供)</p></figure><p id="fb02" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将使用Amazon API Gateway和AWS Lambda在AWS上部署您的API。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/cbae5a4c35fa6a9e7e704dface10d458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3fnjcBmUAj_GocB424nyg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">API网关中的每日新闻API(图片由作者提供)</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi om"><img src="../Images/e5196aade3091dad6ed869c2929125d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0qSPrWQg9og0VoMXdzhYg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">每日新闻-dev Lambda函数(图片由作者提供)</p></figure><p id="779c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您现在可以尝试访问API了。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi on"><img src="../Images/f5f9bd17d170a62dd195569a593c8218.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aa9gMB4hyBlyW1PqD_YjAw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">调用新闻API(图片由作者提供)</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="f12b" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">清理</h1><p id="223a" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">您还可以使用<code class="fe oe of og ng b">chalice delete</code>命令删除运行<code class="fe oe of og ng b">chalice deploy</code>命令时创建的所有资源。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ok"><img src="../Images/dc9ed972434e081542bd9e59429c8024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXgAaUB-9mJfFGZuqO71Ag.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">删除资源(作者图片)</p></figure></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="7166" class="mi mj iq bd mk ml mm mn mo mp mq mr ms kf mt kg mu ki mv kj mw kl mx km my mz bi translated">结论</h1><p id="9cc9" class="pw-post-body-paragraph lf lg iq lh b li na ka lk ll nb kd ln lo nc lq lr ls nd lu lv lw ne ly lz ma ij bi translated">恭喜你！！您刚刚使用Chalice在AWS上部署了一个无服务器应用程序。这并不太难，是吗？</p><p id="05aa" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，您可以继续对您的<code class="fe oe of og ng b">app.py</code>文件进行任何修改，并重新运行<code class="fe oe of og ng b">chalice deploy</code>来重新部署您的更改。</p><p id="41ef" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您还可以使用Chalice将您的无服务器应用程序与亚马逊S3、亚马逊SNS、亚马逊SQS和其他AWS服务集成在一起。看看<a class="ae le" href="https://aws.github.io/chalice/tutorials/index.html" rel="noopener ugc nofollow" target="_blank">教程</a>继续探索。</p><p id="0afe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">本教程的完整源代码可以在<a class="ae le" href="https://github.com/theawesomenayak/daily-news" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>