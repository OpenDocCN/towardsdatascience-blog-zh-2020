<html>
<head>
<title>IOT Data Analytics: Part 2: Data Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IOT数据分析:第2部分:数据模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/iot-data-analytics-part-2-data-model-3da9676cb449?source=collection_archive---------30-----------------------#2020-09-30">https://towardsdatascience.com/iot-data-analytics-part-2-data-model-3da9676cb449?source=collection_archive---------30-----------------------#2020-09-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d062" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">将数据仓库建模的最佳实践应用于物联网数据，以实现最灵活高效的分析</h2></div><h1 id="8cda" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="7cbe" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是上一部分的延续，上一部分描述了与健身跟踪活动示例的物联网数据分析相关的问题陈述。还描述了存储类型选择背后的原因，并推荐了两种类型的存储:</p><ol class=""><li id="5aa1" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv md me mf mg bi translated">大数据存储用于存储时间序列类型的数据</li><li id="b9c9" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">关系分析数据库为数据分析提供了最大的灵活性。更多细节在这里<a class="ae mm" href="https://medium.com/@andriy.zabavskyy/iot-data-analytics-part1-types-of-storages-677b8a24657d" rel="noopener"/>。</li></ol><p id="46a1" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这个故事的目的是描述第二种存储类型(关系分析存储)的推荐数据模型。数据仓库部分的逻辑数据模型。</p><h1 id="f775" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">建模技术</h1><p id="1265" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">幸运的是，数据仓库概念已经在市场上存在了几十年，因此它非常成熟，许多思想领袖围绕解决方案构建和数据建模贡献了最佳实践和模式创建。</p><p id="6f09" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">让我们使用<strong class="lc iu"> Ralph的Kimball </strong>方法来处理特定设计决策的建模和一些模式。</p><p id="1481" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">从方法论的角度来看，我们将执行以下步骤:</p><ol class=""><li id="3870" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv md me mf mg bi translated">选择一个描述我们健身跟踪案例的<strong class="lc iu">业务流程列表</strong></li><li id="6107" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv md me mf mg bi translated">对于我们定义的每个流程:</li></ol><ul class=""><li id="5255" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv mq me mf mg bi translated"><strong class="lc iu">粒度</strong> —存储数据的详细程度</li><li id="c01b" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">描述业务流程上下文的<strong class="lc iu">维度列表</strong>，回答了谁、什么、何时、何地、为什么以及如何的问题</li><li id="a387" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated"><strong class="lc iu">测量列表</strong> —根据颗粒测量事实的定量数值</li></ul><p id="a75a" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">我们在<strong class="lc iu"> Bus matrix、</strong>中收集这些细节，Bus matrix是<strong class="lc iu"> </strong>由业务术语描述的模型的第一个高级版本，非常适合并建议与各种利益相关者共享和讨论。</p><p id="d68b" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">用于创建逻辑数据模型的特定设计模式将是:</p><ul class=""><li id="68b5" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv mq me mf mg bi translated"><strong class="lc iu">星型模式</strong>作为主模型布局，这赋予了最大的灵活性和效率。它还具有良好的可扩展性，这对于物联网用例非常重要。</li><li id="b407" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated"><strong class="lc iu">定期快照事实表</strong> —一个事实表，其中每一行都聚集了某个预定义周期内发生的测量。粮食是一个时期，而不是个人交易</li><li id="704b" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated"><strong class="lc iu">累积快照事实表</strong> —一个事实表，其中每一行<em class="mr"> </em>聚集了在流程开始和结束之间的可预测步骤中发生的测量事件。</li></ul><h1 id="5781" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">健身跟踪总线矩阵</h1><p id="6f18" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">基于问题陈述的描述，我们定义了以下业务流程列表以及粒度、维度和度量:</p><figure class="mt mu mv mw gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ms"><img src="../Images/5f94613e78078742e4126d453f915a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DR45O5yGa-V7LS7IGfmaaw.png"/></div></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">用于健身跟踪的总线矩阵(图片由作者提供)</p></figure><h2 id="80fc" class="ni kj it bd kk nj nk dn ko nl nm dp ks lj nn no ku ln np nq kw lr nr ns ky nt bi translated">总线矩阵注释</h2><p id="dab1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">周期性快照</strong></p><p id="f935" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">来自物联网设备的指标通常会定期出现，但这种规律性并不总是准确的。此外，一些meticss比其他metic出现得更频繁，因此从时间的角度来看，有一个共同的标准是非常有用和方便的。度量在一定的时间段内保持一致，以便能够关联不同的指标并更容易地可视化它们。</p><p id="47fe" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">定期快照有两种模式:</p><ul class=""><li id="c417" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv mq me mf mg bi translated"><strong class="lc iu">健康指标快照</strong> —以标准模式收集健康统计数据，此时不执行任何特殊的健身活动。对齐数据的周期可以选择为一分钟或接近一分钟的时间。</li><li id="0283" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated"><strong class="lc iu">活动指标快照</strong> —在特殊健身活动期间收集统计数据，如跑步、游泳等。在这种模式下，通常会更频繁地收集指标，大约每隔一秒钟收集一次</li></ul><p id="8c9e" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated"><strong class="lc iu">活动圈总结</strong></p><p id="0145" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">该流程的目的是保存健身活动的所有摘要。因为每个活动可以包含动态数量的子阶段，称为<em class="mr"> laps </em>，所以保持单个laps级别的粒度是值得的。</p><p id="b5e9" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">每个活动lap都有严格的开始和结束时间戳，因此我们可以将其视为工作流的简化版本，并为其创建一个累积类型的快照。</p><h1 id="7986" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">逻辑数据模型</h1><p id="2abe" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">实现总线矩阵的逻辑数据模型如下图所示:</p><figure class="mt mu mv mw gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nu"><img src="../Images/17b20c914191e8a2d53fd70f3bbc0120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cbEHYY-J49gmjECbcOxnDw.png"/></div></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">健身跟踪物联网的逻辑数据模型(图片由作者提供)</p></figure><h2 id="541a" class="ni kj it bd kk nj nk dn ko nl nm dp ks lj nn no ku ln np nq kw lr nr ns ky nt bi translated">LDM评论</h2><p id="d98e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">总的来说，数据模型是总线矩阵所描述的过程的非常简单的实现。</p><p id="64d1" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">让我们强调一些要点:</p><ul class=""><li id="26b7" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv mq me mf mg bi translated">日期维度是非常标准的，用于按日/周/月/年进行方便的分组</li><li id="0a9e" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">时间维度用于构建每天的活动画面，按小时分析数据</li><li id="38b7" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">除了日期和时间之外，所有事实表都有时间戳，时间戳可以被视为退化的维度。对于快照事实表，它是周期的开始，对于活动圈，我们有开始和结束里程碑</li><li id="6baa" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">有一个活动ID退化维度，可用于将活动摘要与详细信息绑定在一起</li><li id="bb3a" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">建议基于代理键构建维度表中的主键</li><li id="85ee" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">主键(事实上的表)建议根据粒度在字段子集(主要是维度外键)上构建。</li><li id="7b35" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">即使没有可用的数据，也会对每个期间执行定期快照。建议将测量值设置为空，而不是零，以便进行正确的最小/最大/平均聚合计算</li></ul><h1 id="6227" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">数据分析覆盖面</h1><p id="8c4a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">有了这样一个模型，我们将能够涵盖博客第一部分中描述的所有分析需求</p><h1 id="4fde" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">后续步骤</h1><p id="34f2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">那些深谙Kimball方法论的人可能会问:事务事实表在哪里？</p><p id="9f30" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">快照事实表通常作为主事务事实表的补充，粒度等于每个事务1条记录。在我们的例子中，一个测量事件，比如HR或pace测量可以扮演一个事务的角色。这是一个有道理的观点，但是我相信事务事实表(以非规范化的形式)可以被NoSQL键值或时间序列类型的存储很好地覆盖。</p><p id="398d" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">还有其他一些有趣的话题没有涉及到，值得特别关注:</p><ul class=""><li id="ca45" class="lw lx it lc b ld ly lg lz lj ma ln mb lr mc lv mq me mf mg bi translated">处理设备之间的层次关系</li><li id="a5a7" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">如何执行时间序列和模式匹配类型的查询/分析</li><li id="8400" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">如何存储地理位置GPS数据点并进行基于位置的分析</li><li id="d053" class="lw lx it lc b ld mh lg mi lj mj ln mk lr ml lv mq me mf mg bi translated">当我们对不同类型的活动执行不同的度量时，如何处理动态的或非常大量的度量</li></ul><p id="b86b" class="pw-post-body-paragraph la lb it lc b ld ly ju lf lg lz jx li lj mn ll lm ln mo lp lq lr mp lt lu lv im bi translated">这些话题将会在接下来的文章中涉及。敬请期待</p><h1 id="de52" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">附言</h1><p id="80d8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">更好地理解业务领域和模型中的一些实体属性是受我的个人健身追踪器/智能手表Garmin菲尼克斯的启发。我不为佳明公司工作，我只是其产品的消费者:)</p></div></div>    
</body>
</html>