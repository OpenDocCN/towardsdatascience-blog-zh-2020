<html>
<head>
<title>Understanding Naïve Bayes algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解朴素贝叶斯算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-na%C3%AFve-bayes-algorithm-f9816f6f74c0?source=collection_archive---------10-----------------------#2020-11-08">https://towardsdatascience.com/understanding-na%C3%AFve-bayes-algorithm-f9816f6f74c0?source=collection_archive---------10-----------------------#2020-11-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f0e2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">概率分类器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7eb3adc655a3c76dda40cf23bd3d5312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_SFcCMtgo22pgeuDXOboA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由<a class="ae kv" href="https://unsplash.com/photos/m4sGYaHYN5o" rel="noopener ugc nofollow" target="_blank"> Riho Kroll </a>拍摄，Unsplash</p></figure><p id="d0d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">朴素贝叶斯是一种分类算法，是基于贝叶斯定理的概率分类器。在进入朴素贝叶斯的复杂性之前，我们首先理解贝叶斯定理。</p><h2 id="ffc7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">贝叶斯定理</h2><p id="abc4" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">贝叶斯定理说，如果事件B已经发生，那么我们可以求出事件A给定B的概率<br/>数学上，贝叶斯定理表示为</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8e480bde3a48e41c218475829ea54eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*e3ZMC-ga-NlEvGEyEm7azQ.png"/></div></figure><p id="0721" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其中P(B)！= 0 (!=指不等于)<br/> P(A|B) —事件A给定B的概率(称为后验)<br/> P(B|A) —事件B给定A的概率(称为似然)<br/> P(A) —事件A的概率(称为先验)<br/> P(B) —事件B的概率(称为证据)</p><p id="7f6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果我们有一个查询点X (d维布尔向量)，我们必须预测它属于两个类中的哪一个(Y)。<strong class="ky ir">给定X，如何计算Y的概率？</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/356f23b1ad38a69e3b8094d9c8bed49b.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*M4zxBsg2eDavo8pNOLUr9Q.png"/></div></figure><h2 id="628a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">上述表示中的问题</h2><p id="31ec" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">想想如果我们有上面的公式，可以有多少种组合。x是d维布尔向量，2^d向量x的可能组合，2用于输出(2类分类)。对于P(X1，X2，…，Xd|Y)，总的组合是<strong class="ky ir"> 2^(d+1) </strong>，这是巨大的，并且在真实世界的场景中是无效的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/8631272d178b93f9a355686018b8267f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4j1jT7tckMpF6OMrYUdlw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由Unsplash的Andrea Piacquadio提供</p></figure><p id="42a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">朴素贝叶斯通过做一个假设来处理这个问题。</p><h1 id="ff93" class="mt lt iq bd lu mu mv mw lx mx my mz ma jw na jx md jz nb ka mg kc nc kd mj nd bi translated">朴素贝叶斯</h1><p id="0bd7" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><strong class="ky ir">假设</strong> — <strong class="ky ir">输入向量中的每个特征有条件地独立于其他特征。</strong></p><p id="1338" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数学上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/22b70c33d647e895d1078d99b7b0e1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*mHyrzhwpi8yMD4wijQQ66g.png"/></div></figure><p id="f596" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它说明给定c，A有条件地独立于B。</p><p id="5bb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这有什么帮助？</p><p id="9471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分子，即P(X1，X2，…，Xd|Y)*P(Y)，等价于联合概率模型，可以表示为P(X1，X2，…，Xd，Y)。然后我们可以用条件概率展开它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c204df4b9cd242413a4be8d0a1104ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*5An6fao7CVjDtuwQ4yTu9g.png"/></div></figure><p id="3d35" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在应用条件独立性的假设时，它可以写成</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/df129a441655c376b3f3a0b6743f2ec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*_zF8czGQxU-T3Q23C48O3A.png"/></div></figure><p id="5239" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，使用条件独立的概率公式为</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d83bf5af0d404e8c59e2706cb88c1a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*d9M5_ctu3gN3G4sJLAam5w.png"/></div></figure><p id="f012" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">优点是，当假设条件独立时，我们只需找到P(X1，X2，…，Xd|Y)的<strong class="ky ir"> (2d+2)值</strong>，<strong class="ky ir">(与2^(d+2相比明显较少)</strong> (2^(d+1)和P(Y)的2个值。</p><p id="2a20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们有两个类，给定一个查询点(X)，我们可以得到类1 P(Y=1|X)和类0 P(Y=0|X)的概率。基于MAP判定规则(最大后验概率)来决定分配给查询点的类别，即，给定X (P(Y|X))时具有较高概率的类别。</p><h2 id="a579" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">例子</h2><p id="8252" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">根据天气、温度和风力等特征，预测天气条件是否适合打网球。</p><p id="b981" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">x =[前景，温度，多风]<br/>Y =[是，否]</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/2031d9a75ac1fa805b5fd03221ea0399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJai9bufyRCNa72Ti6Z-nA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="cfb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于朴素贝叶斯遵循条件独立，我们将为X中的所有I和y中的j计算P(Xi|Yj)</p><p id="512d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将计算可能性表。</p><p id="3170" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">表1 </strong></p><p id="3394" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Outlook P(Outlook|class)-其中Outlook可以是<strong class="ky ir">阴天、雨天和晴天</strong>，而class可以是<strong class="ky ir">是和否</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/68deaf7ffb1600acfa053a9bbf048495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*X7FeGXCu8hOTLYdUBPu0Ag.png"/></div></figure><p id="8232" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">表2 </strong></p><p id="eb81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">温度P(温度|等级)-其中温度可以是<strong class="ky ir">热、温和、冷</strong>，等级可以是<strong class="ky ir">是和否</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/f7c890d8b4018785d80382f4f1d826d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkN5BQEI-6VPHQKbmzTs3g.png"/></div></div></figure><p id="169b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">表3 </strong></p><p id="d79f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Windy P(Windy | class)——其中Windy可以是<strong class="ky ir">强和弱</strong>而class可以是<strong class="ky ir">是和否</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/f10fdb20ca220b3ba6a637ddade952b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XO4j1JK7h4mL70jmZplxbQ.png"/></div></div></figure><p id="0647" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">先验知识是:P(类=是)= 9/14 <br/> P(类=否)= 5/14 </p><p id="0d63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">那么如果我们有一个查询点，如何计算它属于哪个类呢？</strong></p><p id="e50a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定一个查询点<strong class="ky ir"> X' =【晴、凉、强】</strong></p><p id="091e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们计算P(class=Yes|X ')和P(class=No|X ')</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/319df22311fe7a49dc987ec0b5174964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*web3DsC8Rbk5ZQeY-SCIyg.png"/></div></div></figure><p id="f233" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">p(X’)是一个常数项，它等于</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/113e72a345309f930dedbf966c5417d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOHy035g-CumNGMv14JrSw.png"/></div></div></figure><p id="0f90" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从可能性表中，我们得到公式中所需的值</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/46e01198bff422f3268db0fcb8efa285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*zhfvBZL70NPXzrz1EayJIQ.png"/></div></figure><p id="31f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于类别'<strong class="ky ir">否'</strong>给定X '的概率高于类别<strong class="ky ir">'是'</strong>给定X '，查询点属于类别<strong class="ky ir">'否'。</strong></p><h2 id="2867" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">优势</h2><ol class=""><li id="4079" class="np nq iq ky b kz ml lc mm lf nr lj ns ln nt lr nu nv nw nx bi translated">朴素贝叶斯算法还可以通过比较给定查询点的所有类的概率来执行多类分类。</li><li id="7b4a" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">nave Bayes算法在大数据集上是高效的，并且空间复杂度较小。<br/>运行时间复杂度为O(d*c ),其中d是查询向量的维数，c是类别总数。空间复杂度也是O(d*c ),因为我们只存储每个特征相对于类的可能性，即P(Xd|Yc ),其中d是特征，c是类。所以总的组合是(d*c)。</li><li id="9b93" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">朴素贝叶斯在诸如垃圾邮件过滤和评论分类等文本分类问题上工作得相当好。</li></ol><p id="3968" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有不同类型的NB，例如<strong class="ky ir">高斯朴素贝叶斯</strong>，它在处理连续数据时效果很好，<strong class="ky ir">多项式朴素贝叶斯</strong>，它通过使用文档中每个词的频率来进行文本分类。另一种类型是<strong class="ky ir">伯努利朴素贝叶斯</strong>，它只在特征采用两个值(0和1)时有效，类似于二进制单词袋模型中的值。</p><h2 id="2777" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="349f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">朴素贝叶斯是一种分类算法，它基于贝叶斯定理和条件独立性假设。由于时间和空间复杂度较低，它在要求低延迟的实际应用中工作得很好。</p><p id="9914" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>