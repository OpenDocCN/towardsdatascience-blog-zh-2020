<html>
<head>
<title>Forecasting the Sound of Mainstream Music with Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用深度学习预测主流音乐的声音</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-future-sound-of-music-with-lstm-modeling-85488d8eac18?source=collection_archive---------32-----------------------#2020-10-30">https://towardsdatascience.com/predicting-the-future-sound-of-music-with-lstm-modeling-85488d8eac18?source=collection_archive---------32-----------------------#2020-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/41ea9a4d85d1e52e90444c96050eb87e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0GU0CJEUTYfkvsFR"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@fixelgraphy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">夹具</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="bf4a" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">毫无疑问，Spotify是当今最受欢迎的音乐流媒体平台之一，它高度受数据驱动。数据科学家利用机器学习推荐系统进行个人策划的播放列表，这是该平台最受欢迎和准确得出奇的功能之一。更多深思熟虑的，甚至是新颖的功能被不断地寻找，以保持用户与平台的互动。</p><p id="bd19" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">所以我在想如何利用Spotify的开发者数据来获得创意。</p><p id="34b1" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">当有人提到一位艺术家时，你听说过“超越时代”这个词吗？如果我们今天就能预测明天谁会领先于他们的时代，那会怎么样？当然,“走在时代前面”的音乐家大多很有名，但更重要的是，他们通常负责发起他们流派的变革。<em class="li">声波历史进程的改变。</em></p><p id="3114" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">进入数据科学Spotify对每首歌曲的歌曲特征进行令人印象深刻的算法音频分析。</strong></p><p id="b159" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">Spotify使用算法，根据“声音”、“可跳舞性”和“速度”等特征，给每首歌曲一个数字轮廓。我们可以随着时间的推移汇总这些特征来回答我们的问题。</p><h1 id="749e" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">目标:</h1><p id="6b06" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">该项目的主要目标是分析和预测Spotify上超过160，000首歌曲的数据集的年平均(主流)趋势。我将尝试使用长短期记忆(LSTM)递归神经网络来预测每个特征在未来可能的值。这基本上是一个数据驱动的数字表示，代表了5年后普通音乐的声音。然后，可以创建与这些未来特征值最接近的歌曲播放列表，并将其命名为“领先于他们的时间的曲目”，并可以作为对应用程序用户的流行吸引力。</p><h2 id="3d70" class="mm lk iq bd ll mn mo dn lp mp mq dp lt kv mr ms lx kz mt mu mb ld mv mw mf mx bi translated">数据:</h2><p id="90e7" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">从1920年到2020年发行了超过160，000首曲目，每首曲目都有14个特征值:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">点击“查看文件”可以在Jovian.ai上看到完整的EDA/处理笔记本。</p></figure><p id="11e4" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">来自<a class="ae kc" href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/" rel="noopener ugc nofollow" target="_blank"> Spotify开发者页面</a>的一些功能定义:</p><p id="93fc" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir"> Acousticness </strong>:一个从0.0到1.0的置信度度量，表示音轨是否是声学的。1.0表示音轨是声学的高置信度。</p><p id="090f" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">可跳性</strong>:可跳性描述了一首曲目在音乐元素组合的基础上适合跳舞的程度，包括速度、节奏稳定性、节拍强度和整体规律性。值0.0最不适合跳舞，1.0最适合跳舞。</p><p id="b402" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">活跃度</strong>:检测录音中是否有观众。较高的活跃度值表示音轨被现场执行的概率增加。高于0.8的值表示该轨迹很有可能是实时的。</p><p id="d6a0" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">乐器性</strong>:预测一个音轨是否不包含人声。“Ooh”和“aah”在这种情况下被视为乐器。Rap或口语词轨道明显是“有声的”。乐器度值越接近1.0，轨道不包含人声内容的可能性就越大。高于0.5的值旨在表示乐器轨道，但随着该值接近1.0，置信度会更高。</p><p id="d62d" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="km ir">效价</strong>:从0.0到1.0的量度，描述一首曲目所传达的音乐积极性。高价曲目听起来更积极(例如，快乐、愉快、欣快)，而低价曲目听起来更消极(例如，悲伤、沮丧、愤怒)。</p><h1 id="c9db" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">探索数据</h1><p id="16a7" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">这些年来，音乐在数字上是如何发展的？以下是我在EDA期间看到的几个例子:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/b4aa140c77a2972cfaf88bb925982626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ei3FSDpqI0E9WZFHGBzUSw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd nf">“声音”特征框随时间变化图</strong></p></figure><p id="d9a4" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">声音有明显的区别。20世纪早期的高音质音乐。乐器、扩音器和制作设备的技术进步可能是大多数最新音乐的声学乐器和整体声音较少的原因。</p><p id="3e65" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这些数据的分布告诉我，每年的声学平均值可能并不能很好地代表这些数据，因为它们会受到异常值的影响。我们可能需要创建一个新的具有中间值的年度数据框。中值将更准确地代表大部分数据。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/4960f22ec4c2878fda0a65d38e70a380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuIRcFCixFdkLqWnSmhklg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">随着时间推移，小提琴演奏出了“关键”</p></figure><p id="96ef" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这里我们有一个不同的音乐音阶的用法的概念，一个分类的特征，随着时间的推移。在大多数年份，0和7键音阶是使用最多的，这可以从他们小提琴的粗细看出。</p><h1 id="20c4" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">清洁</h1><p id="533b" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">乍一看，这个数据集对我来说非常干净。它没有丢失的值，没有奇怪的字符，等等。但是经过EDA的进一步检查和可视化，一些需要处理的细节开始出现。</p><p id="7b7f" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">例如,“语速”的定义告诉我们:“语速检测音轨中口语单词的存在。越是类似语音的录音(例如脱口秀、有声读物、诗歌)，属性值就越接近1.0。高于0.66的值描述了可能完全由口语单词组成的音轨。”</p><p id="a6e5" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我们现在知道过滤掉任何包含超过0.66的语音值的音轨，因为它们是由实际上不是音乐的歌曲组成的。换句话说，这些是录音讲话，也许是单口喜剧录音，它们不会在音乐潮流中扮演角色。</p><h1 id="0aca" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">特征工程</h1><p id="14ec" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">我在EDA过程中注意到，我需要创建一个新的数据框架，该框架根据中位数而不是平均值对每年的每个值进行分组。这是因为异常值的不平衡分布使得平均值不是集中趋势测量的准确表示。看看一段时间内中值“声音”与平均值“声音”的比较:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/eee5cec3664bc25623b5b2934df094aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bQJBHhs8kaFEATGtxt8Jw.png"/></div></div></figure><p id="baf0" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我能够创建这个新数据框的最简单的方法是将“分组依据”中位数分配给单独的列，然后合并它们，因为有许多原始列与我们无关，如“显式”或“名称”。在这里看看我的代码:</p><figure class="my mz na nb gt jr"><div class="bz fp l di"><div class="nc nd l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">点击“查看文件”可以在Jovian.ai上看到完整的EDA/处理笔记本。</p></figure><h1 id="9e42" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">建模</h1><p id="51ac" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">我进行了ARIMA和LSTM建模和调整，最初使用“声学”功能，其绘制的时间序列如下所示:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/8b45e31bb44951c4203e881274880201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYKKKD5KRN_jr9q6GN5rkw.png"/></div></div></figure><p id="3c22" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这里真正的目标是练习使用LSTM模型，但是我用ARIMA做了基线建模。在使用记录值、差分数据、LSTM层叠加、双向LSTM层等众多ARIMA和LSTM模型后，给我最低均方根误差(RMSE)的模型是利用1滞后差分数据的LSTM模型。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/cc3d705156132d476ead9f2169749076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9AwuUFnibVBd-ZfMLz0-w.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">使用差异数据的LSTM验证损失曲线</p></figure><p id="d676" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">那么，什么是LSTM模式呢？ LSTM代表“长短期记忆”，这是一种循环神经网络(RNN)。通过一系列的sigmoid和tan激活，LSTM细胞选择性地遗忘其长期序列的一部分(通过循环遗忘门)。这些剩余值被用于预测下一个值，该值被输出到下一个单元中，作为下一个序列的存储单元输入。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/443ff42b5a5107c5ae09a06e83b9c8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*w0p_AjnBeaihdBhjCViTeQ.png"/></div></figure><p id="283d" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">如果你想从技术上更深入地了解如何创建LSTM模型，可以看看我写的分解编码过程的帖子(链接即将推出！).</p><h1 id="5985" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">用最佳LSTM模型预测未来值</h1><p id="f957" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">由于价值(在我们的例子中是年)越来越难以预测，我们将预测上限定在5年。下面的图表显示了到2025年所有标准化要素的预测值(可以放在同一y轴上):</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/441ae79198db7973eec094fb1e7a9762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4GZDlYza1onxBSiRUekFQ.png"/></div></div></figure><h1 id="5fdf" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">过滤“超越时代”的艺术家</h1><p id="8b10" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">我决定从建模中去掉一些在历史上具有相同中值的特征，比如“显式”和“模式”。</p><p id="3f42" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">不幸的是，我们的数据集不包含任何与所有特征的预测(中值)完全匹配的歌曲。对于最接近2025年预测值的歌曲，我采用每个预测模型RMSE与其预测值之间的间隔来过滤数据。</p><p id="7362" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">最“超前”的艺术家:<a class="ae kc" href="https://open.spotify.com/album/3cQO7jp5S9qLBoIVtbkSM1?highlight=spotify:track:3bnVBN67NBEzedqQuWrpP4" rel="noopener ugc nofollow" target="_blank">二十一名飞行员——我心中的泪点</a></p><p id="9182" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">第二大“超前”艺人:<a class="ae kc" href="https://open.spotify.com/album/66ocxSzZ98wk1rWNfrvU8u?highlight=spotify:track:6N81xlWzMaEYhjHry55OSI" rel="noopener ugc nofollow" target="_blank">新浪潮摇滚乐队——美少女</a></p><p id="4931" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">第三和第四位最“超前”的艺术家:<a class="ae kc" href="https://open.spotify.com/album/3bt4LNUYoC2ELK8HBa7rjs?highlight=spotify:track:1Ml32gIRsMAQuUTEt8hwpZ" rel="noopener ugc nofollow" target="_blank">卢·凯尔，里尔·特杰——错了(壮举。Lil Tjay)混音</a></p><p id="e230" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><a class="ae kc" href="https://open.spotify.com/album/4b13SJlne61y53KSEwuQtD?highlight=spotify:track:1x5sYLZiu9r5E43kMlt9f8" rel="noopener ugc nofollow" target="_blank">莎拉·拉尔森清洁盗贼——交响乐(壮举。莎拉·拉尔森)</a></p><p id="d2d5" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我们的数据集中没有符合每个预测特征范围的歌曲。我们发现与2025年预测(10个中有7个)特征范围最相似的一首歌是《21个飞行员》——《我心中的泪》。这首歌在我们的“可跳舞性”、“持续时间_毫秒”、“能量”、“速度”、“效价”、“流行度”和“关键”误差范围内，与实际预测值相差不大。有10个共有特征中有6个的歌曲是新浪潮摇滚乐队的《美丽的女孩》。两首歌分享了10分中的5分。12首歌分享了10个值中的4个。</p><h1 id="cc20" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">结论</h1><p id="bd90" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">我们已经成功预测了我们的每个特征。那么他们告诉了我们什么？我们的模型预测，到2025年，普通歌曲将具备以下特征:</p><p id="f81a" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">节奏将增加到122.2 BPM左右。响度将继续反弹，并达到接近-6db的中值。(挺大声的！)歌曲中的工具性可能已经卷土重来，从0。语速(人声/口语)将趋于平稳。声学度将再次降低，降至0.08。平均受欢迎程度将继续增长。效价(积极/快乐)将下降并稳定在0.455。能量会继续反弹，触及0.649。可跳舞性或多或少也会保持稳定，只会上升一小部分，达到0.697。换句话说，未来5年将保持最高的可跳性。</p><p id="de4e" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">随后的研究表明，简单的时间序列，如数据点较少的时间序列，通常在ARIMA模型中表现更好，而LSTM模型在非常复杂的时间序列中表现更好，效率更高。考虑到这一点，我们能够使用稳定数据，通过LSTM建模获得较低的RMSE，用于我们对每个特征的最终预测！</p><h1 id="bc15" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">进一步建议</h1><p id="05db" class="pw-post-body-paragraph kk kl iq km b kn mh kp kq kr mi kt ku kv mj kx ky kz mk lb lc ld ml lf lg lh ij bi translated">如果可能的话，我们可以直接访问Spotify API，在整个Spotify库中查询那些拥有所有功能的最前沿艺术家。Spotify总共列出了超过5000万首歌曲。找到与每个建模特征的未来平均值完全匹配的歌曲的概率要高得多。</p><p id="8080" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">将这种预测进一步扩展到各个流派，看看每个流派是如何随着时间的推移而演变的，以及这些流派中的哪些艺术家更早就演奏了这些价值观的音乐，这将是很有趣的。</p><p id="6a12" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">最后，更多的时间分配来改进模型分层和/或参数将有助于我们预测的准确性。</p></div><div class="ab cl kd ke hu kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ij ik il im in"><p id="df8e" class="pw-post-body-paragraph kk kl iq km b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">欢迎在GitHub <a class="ae kc" href="https://github.com/oac0de/Spotify-Sound-Of-Future-Prediction" rel="noopener ugc nofollow" target="_blank">这里</a>查看整个项目，如果你对我的过程有任何问题或建议，也可以给我发消息！</p></div></div>    
</body>
</html>