<html>
<head>
<title>Homebrew and Pyenv Python Playing Pleasantly in Partnership</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">家酿和Pyenv Python愉快地合作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/homebrew-and-pyenv-python-playing-pleasantly-in-partnership-3a342d86319b?source=collection_archive---------13-----------------------#2020-10-15">https://towardsdatascience.com/homebrew-and-pyenv-python-playing-pleasantly-in-partnership-3a342d86319b?source=collection_archive---------13-----------------------#2020-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ebc8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用pyenv的Python来满足自制程序的依赖性，因此只有pyenv管理您机器上的Python 3安装</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8487759d6b8ae22a32ec7ac0729a1194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-x2n-m3IMdrGStbjaCKcw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">接下来，我要清理我的桌子！图片作者。</p></figure><p id="67ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">像<a class="ae lr" rel="noopener" target="_blank" href="/how-to-setup-a-python-environment-for-machine-learning-354d6c29a264">很多</a> <a class="ae lr" rel="noopener" target="_blank" href="/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb">数据</a> <a class="ae lr" rel="noopener" target="_blank" href="/the-python-dreamteam-27f6f9f08c34">科学家</a>和<a class="ae lr" rel="noopener" target="_blank" href="/guide-of-choosing-package-management-tool-for-data-science-project-809a093efd46"> Python </a> <a class="ae lr" rel="noopener" target="_blank" href="/how-to-setup-an-awesome-python-environment-for-data-science-or-anything-else-35d358cc95d5">开发者</a> <a class="ae lr" rel="noopener" target="_blank" href="/managing-virtual-environment-with-pyenv-ae6f3fb835f8">之前</a> <a class="ae lr" rel="noopener" target="_blank" href="/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb">我</a>，<a class="ae lr" rel="noopener" target="_blank" href="/setting-up-your-data-science-work-bench-4a8d3a28205c">我已经</a> <a class="ae lr" rel="noopener" target="_blank" href="/python-environment-101-1d68bda3094d">给了</a><a class="ae lr" rel="noopener" target="_blank" href="/venvs-pyenvs-pipenvs-oh-my-2411149e2f43"/><a class="ae lr" rel="noopener" target="_blank" href="/the-top-4-virtual-environments-in-python-for-data-scientists-5db1c01fd779">上</a>管理我自己的Python构建并转向<a class="ae lr" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank"> pyenv </a>(链接到《走向数据科学》中的编年帖子)。在不同的时间点，我自己从源代码中构建Python版本<a class="ae lr" href="https://www.python.org/downloads/source/" rel="noopener ugc nofollow" target="_blank"/>或者在OSX上使用<a class="ae lr" href="https://www.python.org/downloads/mac-osx/" rel="noopener ugc nofollow" target="_blank">预建框架安装程序</a>，同时手工管理<code class="fe ls lt lu lv b">/usr/local/bin</code>中的链接。使用这两种方法中的任何一种，我从任何已安装的版本中旋转虚拟环境都没有问题，但是最近我和PATH混淆了我们是使用家酿的<code class="fe ls lt lu lv b">python@3.8</code>还是我安装的框架版本。输入pyenv。如果你在寻找如何设置pyenv，<a class="ae lr" href="https://amaral.northwestern.edu/resources/guides/pyenv-tutorial" rel="noopener ugc nofollow" target="_blank">有</a> <a class="ae lr" href="https://opensource.com/article/20/4/pyenv" rel="noopener ugc nofollow" target="_blank">有</a><a class="ae lr" href="https://wilsonmar.github.io/pyenv/" rel="noopener ugc nofollow" target="_blank">无</a><a class="ae lr" href="https://mungingdata.com/python/how-pyenv-works-shims/" rel="noopener ugc nofollow" target="_blank"/><a class="ae lr" href="https://realpython.com/intro-to-pyenv/" rel="noopener ugc nofollow" target="_blank">文章</a> <a class="ae lr" href="https://medium.com/python-every-day/python-development-on-macos-with-pyenv-2509c694a808" rel="noopener">或</a> <a class="ae lr" href="https://medium.com/@weights_biases/pyenv-tutorial-for-machine-learning-9638e43a790f" rel="noopener">博客</a> <a class="ae lr" href="https://sourabhbajaj.com/mac-setup/Python/" rel="noopener ugc nofollow" target="_blank">帖子</a> <a class="ae lr" href="https://anil.io/blog/python/pyenv/using-pyenv-to-install-multiple-python-versions-tox/" rel="noopener ugc nofollow" target="_blank">上</a> <a class="ae lr" href="https://stackabuse.com/managing-python-environments-with-direnv-and-pyenv/" rel="noopener ugc nofollow" target="_blank">如何</a> <a class="ae lr" href="https://duncanleung.com/set-up-python-pyenv-virtualenv-poetry/" rel="noopener ugc nofollow" target="_blank">到</a> <a class="ae lr" href="https://binx.io/blog/2019/04/12/installing-pyenv-on-macos/" rel="noopener ugc nofollow" target="_blank">安装</a> <a class="ae lr" href="https://www.digitalocean.com/community/tutorials/how-to-manage-python-with-pyenv-and-direnv" rel="noopener ugc nofollow" target="_blank">它</a>正如这些文章中提到的，有许多方法可以在您的OSX系统上安装Python:</p><ul class=""><li id="5d16" class="lw lx iq kx b ky kz lb lc le ly li lz lm ma lq mb mc md me bi translated">有内置的Python 2.7.x(注:Python 2自2019年12月起已弃用)。</li><li id="3566" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">Homebrew将提供一个Python 3版本来满足它自己的依赖性。</li><li id="c50d" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">你可以有框架版本。</li><li id="d7e4" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">您可以从源代码构建它。</li><li id="fa3f" class="lw lx iq kx b ky mf lb mg le mh li mi lm mj lq mb mc md me bi translated">或者像许多人建议的那样，您可以使用pyenv来管理版本。</li></ul><p id="2622" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您的系统需要内置的，而Homebrew实际上只会为您保留一个版本的Python 3，所以如果您想管理Python 2或3的特定版本，您需要在后三个版本中进行选择。我省略了Anaconda，因为我不需要它，也没有花时间去真正理解它是如何工作的，但是我听说过Windows用户的成功故事。在这里，我们将选择pyenv来管理python版本，但是这样做的话，我们的系统上最初会有多个版本的Python 2和Python 3(除了builtin版本2和homebrew版本3之外，还有来自pyenv的版本)。再说一次，我们对Python 2的内置无能为力，OSX需要它。<strong class="kx ir">对于Python 3，我们可以让自制软件<em class="mk">使用pyenv的Python版本之一</em>来消除冗余的来源。</strong>在我们开始之前，值得注意的是，如果你像pyenv推荐的那样使用你的<code class="fe ls lt lu lv b">PATH</code>，你不太可能经历pyenv和homebrew之间的<a class="ae lr" href="https://stackoverflow.com/questions/32018969/coexistence-of-homebrew-and-pyenv-on-macosx-yosemite/64364243#64364243" rel="noopener ugc nofollow" target="_blank">冲突，并且</a><a class="ae lr" href="https://docs.brew.sh/Homebrew-and-Python" rel="noopener ugc nofollow" target="_blank"> Homebrew对此发出警告</a>；你正在涉水进入依靠你自己的理解来支持这个用例的领域(正如家酿在他们的帖子中所说的)。</p><h1 id="4bbf" class="ml mm iq bd mn mo mp mq mr ms mt mu mv jw mw jx mx jz my ka mz kc na kd nb nc bi translated">使用pyenv的Python来满足自制依赖</h1><p id="f964" class="pw-post-body-paragraph kv kw iq kx b ky nd jr la lb ne ju ld le nf lg lh li ng lk ll lm nh lo lp lq ij bi translated">这些<a class="ae lr" href="https://stackoverflow.com/questions/30499795/how-can-i-make-homebrews-python-and-pyenv-live-together" rel="noopener ugc nofollow" target="_blank">堆栈溢出答案</a>有使用符号链接(symlinks)的正确想法，但是据我所知，他们没有得到正确的链接。让我们把它们做好！</p><p id="0fa6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你已经有了任何家酿的python3的痕迹，首先把它们去掉(<code class="fe ls lt lu lv b">brew unlink python3</code>和<code class="fe ls lt lu lv b">brew uninstall python3</code>)。如果你已经有了来自Homebrew的python@3.8，当卸载它的时候，记下依赖它的包(例如，<code class="fe ls lt lu lv b">ffmpeg</code>，然后重新安装它们。</p><p id="459f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，Homebrew预计是Python 3.8.6，因为它是python@3.8，所以首先按照他们的文档安装pyenv <a class="ae lr" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank">的那个版本:</a></p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="f907" class="nm mm iq lv b gy nn no l np nq">pyenv install 3.8.6</span></pre><p id="3ff6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这将(默认情况下)把实际的Python安装放在</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="b7aa" class="nm mm iq lv b gy nn no l np nq">~/.pyenv/versions/3.8.6</span></pre><p id="ef07" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们只需要添加一个链接，然后让brew完成剩下的工作。我将在这里使用完整路径，因此您可以从任何地方运行它(记住在头脑中把<code class="fe ls lt lu lv b">ln -s ... ...</code>读成“link-symbolic[target][linkname]”):</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="0ef7" class="nm mm iq lv b gy nn no l np nq">ln -s ~/.pyenv/versions/3.8.6 $(brew --cellar python)/3.8.6</span></pre><p id="7ab2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<code class="fe ls lt lu lv b">-f</code>标志，您可以省略后面的<code class="fe ls lt lu lv b">/3.8.6</code>，因为<code class="fe ls lt lu lv b">ln</code>将使用目标的名称。为了在链接上尽可能清晰，您应该</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="2ef6" class="nm mm iq lv b gy nn no l np nq">ln -s ~/.pyenv/versions/3.8.6 /usr/local/Cellar/python@3.8/3.8.6</span></pre><p id="37a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">结果应该是这样的:</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="2092" class="nm mm iq lv b gy nn no l np nq">➜  ~ ll $(brew --cellar python)<br/>total 0<br/>lrwxr-xr-x  1 [my username]  admin    36B Oct 14 16:52 3.8.6 -&gt;<br/>/Users/[my username]/.pyenv/versions/3.8.6</span></pre><p id="6db6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，让家酿管理其余必要的链接:</p><pre class="kg kh ki kj gt ni lv nj nk aw nl bi"><span id="0270" class="nm mm iq lv b gy nn no l np nq">brew link python3</span></pre><p id="019e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这篇文章的灵感来自于我自己对如何让它工作的探索，而这个关于栈溢出的问题的答案是没有答案的(<a class="ae lr" href="https://stackoverflow.com/a/64364156/2577988" rel="noopener ugc nofollow" target="_blank">我回答了，我想！</a>)。</p></div></div>    
</body>
</html>