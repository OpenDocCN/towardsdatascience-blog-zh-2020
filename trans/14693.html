<html>
<head>
<title>DBSCAN — a density-based unsupervised algorithm for fraud detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DBS can——一种基于密度的无监督欺诈检测算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dbscan-a-density-based-unsupervised-algorithm-for-fraud-detection-887c0f1016e9?source=collection_archive---------13-----------------------#2020-10-10">https://towardsdatascience.com/dbscan-a-density-based-unsupervised-algorithm-for-fraud-detection-887c0f1016e9?source=collection_archive---------13-----------------------#2020-10-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ea7c4b0728dabe63dfd99679c5f435f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wj-K6Wb02-RIrGJh"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">帕特里克·托马索在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="15a8" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">欺诈检测方面的小数据科学</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="fd0b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><a class="ae jg" href="https://www.javelinstrategy.com/coverage-area/2020-identity-fraud-study-genesis-identity-fraud-crisis?ekey=1041077962&amp;edate=20201007&amp;cmpgnid=em-dcp-EFLS_0002M&amp;uniqueid=J41025338000803&amp;lnk_loc=FOOTER" rel="noopener ugc nofollow" target="_blank">根据最近的一份报告</a>欺诈交易造成的财务损失已达到约170亿美元，多达5%的消费者遭遇过某种形式的欺诈事件。</p><p id="925e" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">鉴于如此巨大的财务损失，每个行业都非常重视欺诈检测。不仅仅是金融行业容易受到影响，异常现象在每一个行业都很普遍，并且可能采取多种不同的形式，例如网络入侵、业务绩效中断和KPI的突然变化等。</p><p id="7236" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">欺诈/异常/异常值检测长期以来一直是数据科学领域的热门研究课题。在不断变化的欺诈检测环境中，每天都在测试和使用新的工具和技术来筛选异常情况。在这一系列文章中，到目前为止，我已经讨论了六种不同的欺诈检测技术:</p><ul class=""><li id="a913" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/machine-learning-for-anomaly-detection-elliptic-envelope-2c90528df0a6">椭圆形信封</a></li><li id="eb02" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/anomaly-detection-with-local-outlier-factor-lof-d91e41df10f2">局部异常值因子(LOF) </a></li><li id="9f78" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/z-score-for-anomaly-detection-d98b0006f510"> Z值</a></li><li id="a3bf" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/boxplot-for-anomaly-detection-9eac783382fd">箱线图</a></li><li id="5043" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/statistical-techniques-for-anomaly-detection-6ac89e32d17a">统计技术</a></li><li id="5915" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/time-series-anomaly-detection-with-anomalize-library-67472003c003">时间序列异常检测</a></li></ul><p id="1939" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">今天，我将介绍另一种称为DBSCAN的技术，它是基于密度的噪声应用空间聚类的缩写。</p><p id="7bd1" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">顾名思义，DBSCAN是一种基于密度的无监督机器学习算法。它将多维数据作为输入，并根据模型参数(例如ε和最小样本)对其进行聚类。基于这些参数，算法确定数据集中的某些值是否是异常值。</p><p id="d64d" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">下面是Python编程语言的简单演示。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="3c99" class="mp mq jj bd mr ms mt mu mv mw mx my mz kp na kq nb ks nc kt nd kv ne kw nf ng bi translated">Scikit-Learn中的DBSCAN实现</h1><p id="b28b" class="pw-post-body-paragraph lf lg jj lh b li nh kk lk ll ni kn ln lo nj lq lr ls nk lu lv lw nl ly lz ma im bi translated">Scikit-learn有一个DBSCAN模块，作为其无监督机器学习算法的一部分。只需几个简单的步骤，这种算法就可以立即用于欺诈检测。</p><h2 id="5c1e" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated"><strong class="ak">第一步:导入库</strong></h2><p id="ffc0" class="pw-post-body-paragraph lf lg jj lh b li nh kk lk ll ni kn ln lo nj lq lr ls nk lu lv lw nl ly lz ma im bi translated">对于这个演示，我们需要三个关键库来处理数据、可视化和建模。</p><pre class="ny nz oa ob gt oc od oe of aw og bi"><span id="b652" class="nm mq jj od b gy oh oi l oj ok"># data wrangling<br/>import pandas as pd</span><span id="c4cd" class="nm mq jj od b gy ol oi l oj ok"># visualization<br/>import matplotlib.pyplot as plt</span><span id="8639" class="nm mq jj od b gy ol oi l oj ok"># algorithm<br/>from sklearn.cluster import DBSCAN</span></pre><h2 id="f04b" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated"><strong class="ak">第二步:导入&amp;可视化数据</strong></h2><p id="33b4" class="pw-post-body-paragraph lf lg jj lh b li nh kk lk ll ni kn ln lo nj lq lr ls nk lu lv lw nl ly lz ma im bi translated">我使用的是网上著名的虹膜数据集，所以你可以跟着练习，不用担心从哪里得到数据，如何清理这些数据。</p><pre class="ny nz oa ob gt oc od oe of aw og bi"><span id="2edc" class="nm mq jj od b gy oh oi l oj ok"># import data<br/>df = pd.read_csv("<a class="ae jg" href="https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv</a>")</span><span id="d422" class="nm mq jj od b gy ol oi l oj ok">print(df.head())</span></pre><figure class="ny nz oa ob gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/46bf50ec09f8171cb18c801613c3d2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*SLX7NbUKbE4i7UNJnDTtNQ.png"/></div></figure><p id="83c0" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们选择一个数据子集来测试算法，并将它们可视化在散点图中。</p><figure class="ny nz oa ob gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/4ac2d4a0fc63b7ef5b9140d0b8aa851c.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*eRPIfGmXi7eGNsqIF3aoRg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">二维数据散点图</p></figure><h2 id="8123" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated">第三步:建模</h2><p id="e74c" class="pw-post-body-paragraph lf lg jj lh b li nh kk lk ll ni kn ln lo nj lq lr ls nk lu lv lw nl ly lz ma im bi translated">该模型采用的两个最重要的参数值是(i) <em class="oo"> esp </em>，其指定两点之间的距离，即，数据点彼此应该有多接近以被认为是聚类的一部分；以及(ii) <em class="oo"> min_samples，</em>，其指定一个点在一个聚类中应该具有的邻居的最小数量。</p><pre class="ny nz oa ob gt oc od oe of aw og bi"><span id="b253" class="nm mq jj od b gy oh oi l oj ok"># input data<br/>data = df[["sepal_length", "sepal_width"]]</span><span id="0ef3" class="nm mq jj od b gy ol oi l oj ok"># specify &amp; fit model<br/>model = DBSCAN(eps = 0.4, min_samples = 10).fit(data)</span></pre><h2 id="b86a" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated"><strong class="ak">第四步:可视化</strong></h2><pre class="ny nz oa ob gt oc od oe of aw og bi"><span id="f5a9" class="nm mq jj od b gy oh oi l oj ok"># visualize outputs<br/>colors = model.labels_<br/>plt.scatter(data["sepal_length"], data["sepal_width"], c = colors)</span></pre><figure class="ny nz oa ob gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/d909ebbf6b2e8545b90a6ec4bb0dd843.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*FgxV2V8uqz9KBjjwHTW_yg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">紫色中检测到异常值</p></figure><h2 id="5404" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated"><strong class="ak">步骤5:创建异常值数据框</strong></h2><pre class="ny nz oa ob gt oc od oe of aw og bi"><span id="4f7a" class="nm mq jj od b gy oh oi l oj ok"># outliers dataframe<br/>outliers = data[model.labels_ == -1]</span><span id="7610" class="nm mq jj od b gy ol oi l oj ok">print(outliers)</span></pre><figure class="ny nz oa ob gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/e6152dd20023b12d08895cc98044e950.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*4sRTWzVoWbz0yUCNeSPB-g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">异常值的数据框架</p></figure><h2 id="2780" class="nm mq jj bd mr nn no dn mv np nq dp mz lo nr ns nb ls nt nu nd lw nv nw nf nx bi translated"><strong class="ak">总结</strong></h2><p id="cd01" class="pw-post-body-paragraph lf lg jj lh b li nh kk lk ll ni kn ln lo nj lq lr ls nk lu lv lw nl ly lz ma im bi translated">本文的目的是介绍DBS can——一种基于聚类的无监督机器学习技术，用于欺诈/异常值/异常检测。它的实现可以简单到只需要使用<code class="fe or os ot od b">sklearn</code>库的五个步骤。当然，这只是一个简单的概念演示。真实世界的应用程序需要更多的实验来找到适合特定环境和行业的最佳模型。</p></div></div>    
</body>
</html>