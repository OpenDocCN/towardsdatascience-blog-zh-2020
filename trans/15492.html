<html>
<head>
<title>Kaggle’s Titanic Competition in 10 Minutes | Part-II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">10分钟后卡格尔的泰坦尼克号比赛|第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kaggles-titanic-competition-in-10-minutes-part-ii-3ae626bc6519?source=collection_archive---------17-----------------------#2020-10-25">https://towardsdatascience.com/kaggles-titanic-competition-in-10-minutes-part-ii-3ae626bc6519?source=collection_archive---------17-----------------------#2020-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="b8e5" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" rel="noopener" target="_blank" href="/kaggles-titanic-competition-in-10-minutes-part-i-e6d18e59dbce"> ←第一部分</a> |机器学习教程| <a class="ae ep" rel="noopener" target="_blank" href="/kaggles-titanic-competition-in-10-minutes-part-iii-a492a1a1604f">第三部分→ </a></h2><div class=""/><div class=""><h2 id="bf52" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">改进我们的代码，通过数据分析和可视化以及梯度推进算法为Kaggle的大赛获得更好的结果</h2></div><p id="0719" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在本教程的<a class="ae ln" href="https://medium.com/@oyalcin/complete-your-first-kaggle-competition-a-k-a-d5ca937a6451" rel="noopener">第一部分</a>中，我们开发了一个不到20行的小python程序，让我们得以参加第一届Kaggle比赛。</p><div class="lo lp gp gr lq lr"><a rel="noopener follow" target="_blank" href="/kaggles-titanic-competition-in-10-minutes-part-i-e6d18e59dbce"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jd gy z fp lw fr fs lx fu fw jc bi translated">10分钟后卡格尔的泰坦尼克号比赛|第一部分</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">使用决策树分类器|机器学习，用不到20行代码完成您的第一次Kaggle竞赛…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf mg lr"/></div></div></a></div><p id="0514" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然而，由于我们没有进行良好的数据探索和准备来更好地理解数据和构建模型，因此该模型的表现不是很好。在教程的第二部分，我们将使用<a class="ae ln" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>和<a class="ae ln" href="http://matplotlib.org" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>来探索数据集。此外，新的概念将被引入和应用于一个更好的执行模式。最后，我们将在第二次提交中增加我们的排名。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mh"><img src="../Images/55c52eaf9a5f3770d8c1243ed616d5b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KCkU54wGMOokVURx.jpg"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图一。<a class="ae ln" href="https://upload.wikimedia.org/wikipedia/commons/d/d7/Sea_Trials_of_RMS_Titanic%2C_2nd_of_April_1912.jpg" rel="noopener ugc nofollow" target="_blank">皇家邮轮泰坦尼克号</a>在<a class="ae ln" href="http://wikipedia.org" rel="noopener ugc nofollow" target="_blank">维基百科</a>上的海试</p></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="078c" class="nd ne it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">使用Jupyter或Google Colab笔记本</h1><p id="785b" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">对于您的编程环境，您可以选择以下两个选项之一:<a class="ae ln" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter Notebook </a>和<a class="ae ln" href="http://colab.research.google.com" rel="noopener ugc nofollow" target="_blank"> Google Colab Notebook </a>:</p><h2 id="f21f" class="oa ne it bd nf ob oc dn nj od oe dp nn la of og np le oh oi nr li oj ok nt iz bi translated">Jupyter笔记本</h2><p id="170c" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">正如在第一部分中提到的，您需要在系统上安装Python来运行任何Python代码。还有，需要安装Numpy、Pandas、Matplotlib、Seaborn等库。此外，您需要一个IDE(文本编辑器)来编写代码。当然，您可以使用自己选择的IDE。不过我强烈推荐安装<a class="ae ln" href="https://www.anaconda.com/products/individual" rel="noopener ugc nofollow" target="_blank"> Anaconda发行</a>的Jupyter笔记本。Jupyter Notebook利用了<a class="ae ln" href="http://iPython.org" rel="noopener ugc nofollow" target="_blank"> iPython </a>，它提供了一个交互式外壳，为测试你的代码提供了很多方便。所以，如果你还没有使用它，你一定要检查一下。</p><h2 id="32e6" class="oa ne it bd nf ob oc dn nj od oe dp nn la of og np le oh oi nr li oj ok nt iz bi translated">谷歌Colab笔记本</h2><p id="f1a8" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">Google Colab建立在Jupyter笔记本之上，并为您提供云计算功能。不需要完成以上所有步骤，你可以创建一个<a class="ae ln" href="http://colab.research.google.com" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>笔记本，它预装了这些库。所以，它更加流线型。比起Jupyter，我更推荐Google Colab，但最终还是要看你自己。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="0be1" class="nd ne it bd nf ng nh ni nj nk nl nm nn ki no kj np kl nq km nr ko ns kp nt nu bi translated">探索我们的数据</h1><p id="3767" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">为了能够创建一个好的模型，首先，我们需要探索我们的数据。<a class="ae ln" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>，一个统计数据可视化库，非常方便。首先，让我们记住数据集的样子:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi ol"><img src="../Images/ea227b85495e164f38fd179fe347d2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrJo2ySP9pQTqy0AbFpXkg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">表1。我们培训数据的前5行(按作者列出的表格)</p></figure><p id="3219" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是你在上面看到的变量的解释:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi om"><img src="../Images/cc3e536c0fd3a017d2aa36d9fe1bc6d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NmvyFTdTO35UqIRO83WvAw.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">表二。对变量的解释(表格由作者提供)</p></figure><p id="88f6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">所以，现在是时候探索这些变量对生存概率的影响了！</p><p id="bb27" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的第一个猜想是，一个人的性别(男-女)和他/她的生存概率之间存在相关性。为了能够理解这种关系，我们根据存活和非存活标签创建了男性和女性类别的条形图:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi on"><img src="../Images/491f1c77cc1a7072b45369f2f8733a04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EboUgsAs3gdVz2cOREChsQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图二。男性和女性的存活数(按作者分列)</p></figure><p id="01e9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如你在图中看到的，女性比男性有更大的生存机会。因此，性别必须是我们模型中的一个解释变量。</p><p id="7f2c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">其次，我们怀疑乘客等级和存活率之间也有关联。当我们绘制Pclass对抗Survival时，我们得到下面的图:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi on"><img src="../Images/42de31d77e6142e3c8bcd61bbb9138c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vm5RJ__0OB2u_mqzwtd45A.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图3。不同乘客等级的幸存人数(作者提供的数字)</p></figure><p id="c7ec" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如我们所怀疑的，乘客级别对一个人的生存机会有很大的影响。看来，如果有人乘坐三等舱旅行，那么他很有可能无法生还。所以Pclass对生存概率肯定是有解释力的。</p><p id="f1af" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">第三，我们还怀疑船上兄弟姐妹的数量(SibSp)和船上父母的数量(Parch)在解释生存机会方面也很重要。因此，我们需要绘制SibSp和Parch变量与存活率的关系图，我们得到如下结果:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi oo"><img src="../Images/e6c52e4b122780ebef8033cb3f9eb0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utj7Pc2A_0Os8_pbeK4STQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图4。基于船上兄弟姐妹和父母的幸存人数(作者提供数据)</p></figure><p id="da2b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，我们得出这样的结论:随着船上兄弟姐妹数量或船上父母数量的增加，生存的机会也会增加。换句话说，和家人一起旅行的人有更高的生存机会。</p><p id="605a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们模型的另一个潜在解释变量(特征)是上船变量。当我们着手对抗生存的阴谋时，我们获得这样的结果:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi on"><img src="../Images/b8af98f80db4ec19789dc542650d7380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-ln_Dm04HX7sk2C6fSngg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图5。基于装载港口的生存统计(作者提供的数据)</p></figure><p id="c4fe" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">很明显，登上南安普敦港的人没有其他人那么幸运。因此，我们也将在我们的模型中包括这个变量。</p><p id="e5fb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">到目前为止，我们检查了5个分类变量(性别、Plclass、SibSp、Parch、apollowed)，似乎它们都在一个人的生存机会中发挥了作用。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="89cd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在是时候研究我们的数字变量票价和年龄了。首先，我们希望看到年龄对生存机会的影响。因此，我们绘制年龄变量(seaborn.distplot):</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi op"><img src="../Images/3d48d83e505851d937fafefd05f41ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Niln8qOPuuFfEovHCkU_TA.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图6。存活率与年龄的关系图(作者提供的数据)</p></figure><p id="c832" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们可以看到，18岁以下的儿童存活率较高，而18岁以上、35岁以下的人，这个比率较低。年龄在生存中起着作用。</p><p id="660f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后，我们需要看看票价是否有助于解释生存概率。因此，我们绘制票价变量(seaborn.distplot):</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi op"><img src="../Images/20a67fa2d5c0b77751f48f34f11699a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1sLgrgvFzvc7Yw4_HsURQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图7。幸存者与票价的关系图(作者提供的数据)</p></figure><p id="486d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">总的来说，我们可以看到，随着乘客支付的车费增加，生存的机会也增加，正如我们所预料的那样。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="d151" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将忽略三列:Name、Cabin、Ticket，因为我们需要使用更高级的技术将这些变量包含在我们的模型中。为了说明如何从这些变量中提取特征:您可以对乘客的姓名进行标记，并派生出他们的头衔。除了先生和夫人之类的头衔，你还会发现其他头衔，如主人或女士等。当然，这在那天晚上拯救谁的问题上起了作用。因此，您可以利用给定的名称列以及客舱和机票列。</p><h1 id="43c3" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">检查数据中的空值</h1><p id="f8db" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">空值是我们的敌人！在泰坦尼克号数据集中，我们有一些缺失值。首先，我们将在删除训练数据集的幸存列后合并这两个数据集。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="8e7a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们需要得到关于空值的信息！有两种方法可以完成这个任务:<em class="ox">。info() </em>功能和热图(更酷的方式！).为了能够检测到空值，我们可以使用seaborn的热图，代码如下:</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="1955" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是结果。黄线是缺失的值。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi oy"><img src="../Images/ed62d2ede9aceacf11e42adca47aa8a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPHu25hmTptKf1nkjWcD3g.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图8。空值的热图(作者提供的图)</p></figure><p id="d4d8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有很多遗漏的年龄和客舱值。“已装船”列中缺少两个值，而“票价”列中缺少一个值。让我们先处理这些。或者，我们可以使用。<em class="ox"> info() </em>功能以文本形式接收相同的信息:</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/e4e875f2579ba23f454900e76c1300a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*ydDFEWJx8RSXJNbgrcLxoA.png"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图9。联合泰坦尼克号数据的空值信息(作者提供的图表)</p></figure><h1 id="d595" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">读取数据集</h1><p id="fffa" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">由于在<a class="ae ln" rel="noopener" target="_blank" href="/kaggles-titanic-competition-in-10-minutes-part-i-e6d18e59dbce">第一部分</a>中已经涉及到，我们将不再讨论数据集的细节。使用下面的代码，我们可以导入Pandas &amp; Numpy库并读取train &amp; test CSV文件。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="e6fb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从上面我们知道，在训练集和测试集中我们都有空值。我们需要估算这些空值，并分别为模型拟合和预测准备数据集。</p><h1 id="50b2" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">输入空值</h1><p id="d799" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">解决数据集中缺失值问题有两种主要方法:丢弃或填充。放弃是简单而天真的出路；虽然，有时它实际上可能表现得更好。在我们的例子中，我们将填充它们，除非我们决定完全删除整个列。</p><p id="55a2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的数据集的初始外观如下:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi ol"><img src="../Images/ea227b85495e164f38fd179fe347d2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jrJo2ySP9pQTqy0AbFpXkg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">表3。训练数据集的初始外观(按作者排列的表格)</p></figure><p id="8fb6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将进行几次<a class="ae ln" href="https://en.wikipedia.org/wiki/Imputation_(statistics)" rel="noopener ugc nofollow" target="_blank">插补</a>和转换，以获得完全数字化的干净数据集，从而能够用以下代码拟合机器学习模型(它还包含<a class="ae ln" href="https://en.wikipedia.org/wiki/Imputation_(statistics)" rel="noopener ugc nofollow" target="_blank">插补</a>):</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">清理训练数据集的Python代码</p></figure><p id="e32e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在训练数据集上运行此代码后，我们得到了以下结果:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi pa"><img src="../Images/59b29c944af2faf66debf4129f6874fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDQ5Yl0XZlzOsaviG-Mhyg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">表4。训练数据集的干净版本(按作者列出的表)</p></figure><p id="3cb5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">没有空值、字符串或类别会妨碍我们。现在，我们可以将数据分成两部分，特征(X或解释变量)和标签(Y或响应变量)，然后我们可以使用<a class="ae ln" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"> sklearn </a>的<a class="ae ln" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> train_test_split() </a>函数在训练数据集中进行训练测试拆分。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><pre class="mi mj mk ml gt pb pc pd pe aw pf bi"><span id="211d" class="oa ne it pc b gy pg ph l pi pj"><strong class="pc jd">Note:</strong> We have another dataset called <em class="ox">test</em>. This isn’t very clear due to the naming made by Kaggle. We are training and testing our model using the train dataset by splitting it into <em class="ox">X_train</em>, <em class="ox">X_test</em>, <em class="ox">y_train</em>, <em class="ox">y_test</em> DataFrames, and then applying the trained model on our test dataset to generate a predictions file.</span></pre><h1 id="2926" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">创建梯度推进模型和训练</h1><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi pk"><img src="../Images/e9dac983d93949715b8ba04eb9318f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V9IFn4zFJ0Lmjj5InMPmZQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图10。梯度推进算法的可视化(图片由作者提供)</p></figure><p id="0dd3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在第一部分中，我们使用了一个基本的决策树模型作为我们的机器学习算法。另一个众所周知的机器学习算法是<a class="ae ln" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" rel="noopener ugc nofollow" target="_blank">梯度提升分类器</a>，由于它通常优于<a class="ae ln" href="https://scikit-learn.org/stable/modules/tree.html" rel="noopener ugc nofollow" target="_blank">决策树</a>，我们将在本教程中使用梯度提升分类器。下面分享的代码允许我们导入梯度提升分类器算法，基于它创建一个模型，使用<em class="ox"> X_train </em>和<em class="ox"> y_train </em> DataFrames拟合和训练模型，最后在<em class="ox"> X_test </em>上进行预测。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="eef0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，我们有了预测，也知道了答案，因为<em class="ox"> X_test </em>是从列车数据帧中分离出来的。为了能够衡量我们的成功，我们可以使用混淆矩阵和分类报告。您可以通过运行以下代码来实现这一点:</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="65ed" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是输出结果:</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi pl"><img src="../Images/abacc11ec4cddff11f51534bcf5f144a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QTXVw08eQ2kQqgF1QCAIXQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图11。混淆矩阵和分类报告我们的结果(图由作者)</p></figure><p id="f62c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们获得了大约82%的准确率，这可以被认为是非常好的，尽管仍有改进的空间。</p><h1 id="0bca" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated"><strong class="ak">为卡吉尔比赛创建预测文件</strong></h1><p id="d1bf" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">现在，我们有了一个训练有素的工作模型，可以用来预测<strong class="kt jd"> <em class="ox"> test.csv </em> </strong>文件中乘客的生存概率。</p><p id="65fd" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">首先，我们将使用以下代码清理和准备数据(与我们清理训练数据集的方式非常相似)。请注意，在以“ids”的名称删除PassengerId列之前，我们将它保存为一个单独的dataframe。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="42e7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后，我们可以预测测试数据帧的存活值，并根据需要使用以下代码写入CSV文件。</p><figure class="mi mj mk ml gt mm"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="f1b0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这样你就有了一个新的更好的Kaggle竞赛模型。我们在代码中做了一些改进，提高了大约15–20%的准确性，这是一个很好的改进。正如我上面提到的，仍然有一些改进的空间，准确率可以提高到85–86%左右。然而，在我看来，记分牌的分数并不十分可靠，因为许多人使用了不诚实的技术来提高他们的排名。</p><h1 id="4258" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">这个迷你系列的第三部分</h1><p id="bfde" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">在第三部分中，我们将使用更先进的技术，如自然语言处理(NLP)、深度学习和GridSearchCV，以提高我们在Kaggle的泰坦尼克号比赛中的准确性。</p><div class="lo lp gp gr lq lr"><a rel="noopener follow" target="_blank" href="/kaggles-titanic-competition-in-10-minutes-part-iii-a492a1a1604f"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd jd gy z fp lw fr fs lx fu fw jc bi translated">10分钟后卡格尔的泰坦尼克号比赛|第三部分</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">在Kaggle的泰坦尼克号比赛|机器中使用自然语言处理(NLP)、深度学习和GridSearchCV</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">towardsdatascience.com</p></div></div><div class="ma l"><div class="pm l mc md me ma mf mg lr"/></div></div></a></div><p id="0c34" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">既然您正在阅读这篇文章，我相信我们有着相似的兴趣，并且现在/将来会从事相似的行业。那么我们就通过<a class="ae ln" href="https://linkedin.com/in/orhangaziyalcin/" rel="noopener ugc nofollow" target="_blank"><em class="ox">Linkedin</em></a><em class="ox">来连线吧！请不要犹豫发送联系请求！</em><a class="ae ln" href="https://linkedin.com/in/orhangaziyalcin/" rel="noopener ugc nofollow" target="_blank"><em class="ox">Orhan g . Yal n—Linkedin</em></a></p><h1 id="2d5f" class="nd ne it bd nf ng oq ni nj nk or nm nn ki os kj np kl ot km nr ko ou kp nt nu bi translated">订阅时事通讯获取完整代码</h1><p id="7f9d" class="pw-post-body-paragraph kr ks it kt b ku nv kd kw kx nw kg kz la nx lc ld le ny lg lh li nz lk ll lm im bi translated">如果你想获得Google Colab上的教程代码和我的最新内容，可以考虑订阅我的<em class="ox"> GDPR兼容</em> <a class="ae ln" href="http://eepurl.com/hd6Xfv" rel="noopener ugc nofollow" target="_blank"> <strong class="kt jd">时事通讯</strong> </a> <strong class="kt jd">！✉️ </strong></p><blockquote class="pn"><p id="fb9e" class="po pp it bd pq pr ps pt pu pv pw lm dk translated"><a class="ae ln" href="http://eepurl.com/hd6Xfv" rel="noopener ugc nofollow" target="_blank">现在就订阅</a></p></blockquote></div></div>    
</body>
</html>