<html>
<head>
<title>PyTorch in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的PyTorch</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pytorch-in-python-77ab9fab1b39?source=collection_archive---------39-----------------------#2020-11-14">https://towardsdatascience.com/pytorch-in-python-77ab9fab1b39?source=collection_archive---------39-----------------------#2020-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e721" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对深度学习和人工智能感兴趣？PyTorch是一个基于Python的计算库，它使用图形处理单元的能力。当谈到深度学习研究平台时，它受到许多人的青睐。这里有一些关于PyTorch和一些可能的真实应用程序的见解。</p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/cfb4dd53e3fee958514b009dcce7c143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SLGpYIz3OmVt_5sVIW7Png.jpeg"/></div></div><p class="lh li gj gh gi lj lk bd b be z dk translated">照片由<a class="ae ll" href="https://unsplash.com/@maximalfocus?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Maximalfocus </a>在<a class="ae ll" href="https://unsplash.com/s/photos/neural-network?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3c2c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，让我从解释PyTorch将如何对您有用开始。PyTorch有许多不同的用途，但主要用于替代NumPy使用GPU的能力，以及提供灵活性和速度的深度学习研究平台。</p><h1 id="f0f7" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">机器学习/深度学习</h1><p id="0780" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">人工智能本质上是构建智能机器，这些机器能够执行通常需要人类智能才能完成的任务。它包括机器学习和深度学习。机器学习为计算机系统提供了从经验中学习和改进的能力，但无需显式编程，即开发可以自行访问数据并从中学习的计算机程序。深度学习是机器学习、算法和神经网络的子集，其灵感来自人类从大量数据中学习。深度学习算法重复执行一项任务，并在每次迭代中进行调整，以提高结果的成功程度。术语“深度学习”指的是神经网络中能够进行学习的深层。深度学习的一个流行例子是虚拟助手，如Siri或Alexa，它们从你使用的语音和语言中学习，以更好地提高性能。你可能听说过谷歌的人工智能，用于增强人的能力。请看一下<a class="ae ll" href="https://ai.google/about/" rel="noopener ugc nofollow" target="_blank">的关于页面<strong class="js iu">这里</strong>T7】。</a></p><blockquote class="mp mq mr"><p id="bfc0" class="jq jr ms js b jt ju jv jw jx jy jz ka mt kc kd ke mu kg kh ki mv kk kl km kn im bi translated">“谷歌的使命是组织世界上的信息，并使其普遍可用和有用。人工智能正在以令人兴奋的新方式帮助我们做到这一点，为我们的用户、客户和世界解决问题。”</p></blockquote></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="1997" class="lm ln it bd lo lp mw lr ls lt mx lv lw lx my lz ma mb mz md me mf na mh mi mj bi translated">入门指南</h1><p id="dc6a" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">说到使用PyTorch，我建议从学习Python编程语言和面向对象编程的基础开始。面向对象编程提供了一种结构化程序的方法，将属性和行为捆绑到对象中。一个对象可以代表一个人，其属性包括姓名和年龄，行为包括走路和跳舞。和往常一样，最好看一下文档，以获得函数及其参数的参考，您可以在这里找到<a class="ae ll" href="https://pytorch.org/docs/stable/torch.html" rel="noopener ugc nofollow" target="_blank"><strong class="js iu"/></a>。</p><p id="538f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当谈到创建模型时，比如下面的线性回归模型，你需要掌握张量，以便在深度学习中使用。张量是线性代数中使用的一种数据结构类型。你可以用张量计算算术运算，就像用向量和矩阵一样。假设您正在使用如下所示的NumPy数组。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi nb"><img src="../Images/a90fcc035e7a0f22423bda23d193b816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OEjEHFyXWig6ld1ZfjuuOA.png"/></div></div><p class="lh li gj gh gi lj lk bd b be z dk translated">作者图片</p></figure><p id="c2a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最右边的三维数组是一个张量。标量有零维，向量有一维，矩阵有二维，张量有三维或更多维。然而，向量和矩阵也是张量，任何东西不是标量就是张量。这些是用于数据的张量，它们也可以用作可训练参数。用作可训练参数或权重的张量需要计算其梯度。PyTorch支持GPU加速张量计算来解决此类问题。它通过许多不同的包来做到这一点，如自动签名、动态计算图、优化器、损失计算和模型。</p><ol class=""><li id="965f" class="nc nd it js b jt ju jx jy kb ne kf nf kj ng kn nh ni nj nk bi translated"><strong class="js iu">亲笔签名</strong>:一个自动微分包，让我们能够忽略偏导数和链式法则。它会为我们计算所有的梯度。</li><li id="dc19" class="nc nd it js b jt nl jx nm kb nn kf no kj np kn nh ni nj nk bi translated"><strong class="js iu">动态</strong> <strong class="js iu">计算图</strong>:深度学习框架维护一个计算图，显示需要执行的计算顺序。能够使用动态图是一件大事，因为不同的框架(如Tensorflow和Theano)只允许您创建静态图。这意味着在运行模型之前，您必须定义整个图形。在PyTorch中，您可以在运行时定义或调整您的图形。</li><li id="eccd" class="nc nd it js b jt nl jx nm kb nn kf no kj np kn nh ni nj nk bi translated"><strong class="js iu">优化算法</strong>:获取我们想要更新的参数、期望的学习率，并使用其<em class="ms"> step()方法执行这些更新。</em>这通常通过使用计算的梯度手动更新参数来完成。这对于只有几个变量的情况来说还不算太糟，但是对于多个参数来说肯定会变得更加困难。</li><li id="8aa9" class="nc nd it js b jt nl jx nm kb nn kf no kj np kn nh ni nj nk bi translated"><strong class="js iu">损失计算</strong> : PyTorch包括许多损失函数，因为下面的例子是一个回归，我们将使用MSE(均方差)损失来计算给定预测和标签的损失。</li><li id="52f8" class="nc nd it js b jt nl jx nm kb nn kf no kj np kn nh ni nj nk bi translated"><strong class="js iu">模型</strong>:py torch中的模型用继承自<strong class="js iu">模块</strong>类的<strong class="js iu"> Python类</strong>来表示。<code class="fe nq nr ns nt b"><strong class="js iu"><em class="ms">__init__(self)</em></strong></code><em class="ms">:</em><strong class="js iu"><em class="ms"/></strong>定义了组成模型的不同部分——在我们的例子中，有两个参数，<strong class="js iu"> a </strong>和<strong class="js iu"> b </strong>。</li></ol><p id="9847" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">线性回归是一种非常常用的预测分析形式。它用于显示或预测两个变量之间的关系，方法是检查一组预测变量，看它们是否能成功预测因变量的结果。此外，通过帮助确定哪些变量特别是结果变量的重要预测因素。这是一个来自《走向数据科学》的线性回归模型的例子。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi nu"><img src="../Images/81a54ef0d9071b3112d9688a6e08ffdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3vlsEmfe4_Jn966ENJ6--w.png"/></div></div><p class="lh li gj gh gi lj lk bd b be z dk translated">图片来自丹尼尔·戈多伊/走向数据科学</p></figure><p id="9d11" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了训练一个模型，有两个初始化步骤<strong class="js iu">:</strong></p><p id="80bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">参数/权重的随机初始化(我们只有两个，<em class="ms"> a </em>和<em class="ms"> b </em> ) —第3行和第4行；</p><p id="fe3b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">超参数的初始化(在我们的例子中，只有<em class="ms">学习率</em>和<em class="ms">周期数</em> ) —第9行和第11行；</p><p id="83d4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">确保<em class="ms">始终初始化您的随机种子</em>，以确保结果的<strong class="js iu">再现性</strong>。</p><p id="04f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">对于每个时期</strong>，有<strong class="js iu">四个训练步骤</strong>:</p><p id="5c9b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">计算模型的预测—这是<strong class="js iu">正向传递</strong> —第15行；</p><p id="b188" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用<em class="ms">预测</em>和<em class="ms">标签</em>以及手头任务的适当<strong class="js iu">损失函数</strong>计算损失——第18行和第20行；</p><p id="3d49" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">计算每个参数的<strong class="js iu">梯度</strong>——第23行和第24行；</p><p id="563b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">更新</strong>参数—第27行和第28行</p><p id="ef62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在来看看使用PyTorch的众多好处之一。下面的代码创建了一个随机梯度下降优化器来更新a和b参数。由于优化器接受学习率和参数，它将简单地用<em class="ms"> step() </em>方法执行更新。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/c0d9aa5ff5abd88a9ee1b4357fcc0c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*kIkw6zXwQgHGhYyXzFjkCQ.png"/></div><p class="lh li gj gh gi lj lk bd b be z dk translated">图片来自丹尼尔·戈多伊/走向数据科学</p></figure><p id="0cfa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">戈多伊特区(2020年6月2日)。通过示例了解PyTorch:分步教程。检索自<a class="ae ll" rel="noopener" target="_blank" href="/understanding-pytorch-with-an-example-a-step-by-step-tutorial-81fc5f8c4e8e"><em class="ms">https://towardsdatascience . com/understanding-py torch-with-a-a-a-example-a-step-tutorial-81 fc 5 f 8 C4 E8 e</em></a></p></div><div class="ab cl ko kp hx kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="im in io ip iq"><h1 id="b586" class="lm ln it bd lo lp mw lr ls lt mx lv lw lx my lz ma mb mz md me mf na mh mi mj bi translated">结论</h1><p id="ae6f" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">虽然不使用PyTorch也能完成上述任务，但该库将为您提供更快、更直观的体验。这是可能的，因为PyTorch的框架开销很小。当与NVIDIA或英特尔MKL等加速库集成时，它可以快速处理小型和大型神经网络。除了速度更快和用户友好之外，由于为GPU编写的自定义内存分配器，它在内存使用方面非常高效。总的来说，这是一个非常有用的Python包</p><h2 id="8a64" class="nw ln it bd lo nx ny dn ls nz oa dp lw kb ob oc ma kf od oe me kj of og mi oh bi translated">参考资料:</h2><p id="e4d6" class="pw-post-body-paragraph jq jr it js b jt mk jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj mo kl km kn im bi translated">美国首都戈多伊(2020年6月2日)。通过示例了解PyTorch:分步教程。检索自<a class="ae ll" rel="noopener" target="_blank" href="/understanding-pytorch-with-an-example-a-step-by-step-tutorial-81fc5f8c4e8e"><em class="ms">https://towards data science . com/understanding-py torch-with-a-a-a-a-example-a-step-tutorial-81 fc 5 f 8 C4 E8 e</em></a></p><p id="e751" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ms">布朗利，J. (2019年12月5日)。NumPy机器学习张量的温和介绍。检索自</em><a class="ae ll" href="https://machinelearningmastery.com/introduction-to-tensors-for-machine-learning/" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://machine learning mastery . com/introduction-to-tensors-for-machine-learning/</em></a></p><p id="87bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ms">佩雷斯，C. E. (2019年3月1日)。PyTorch，动态计算图和模块化深度学习。检索自</em><a class="ae ll" href="https://medium.com/intuitionmachine/pytorch-dynamic-computational-graphs-and-modular-deep-learning-7e7f89f18d1" rel="noopener"><em class="ms">https://medium . com/intuition machine/py torch-dynamic-computational-graphs-and-modular-deep-learning-7e 7 f 89 f 18d 1</em></a></p><p id="9523" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ms">真正的蟒蛇。(2020年5月22日)。Python 3中的面向对象编程(OOP)。检索自</em><a class="ae ll" href="https://realpython.com/python3-object-oriented-programming/#what-is-object-oriented-programming-oop" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://real python . com/python 3-面向对象编程/# what-is-object-oriented-programming-OOP</em></a></p><p id="a6e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ms"> Shetty，s .，Shetty，s .，Gall，r .，Lobo，s .，Davis，v .，Sunith ShettyData Science。(2018年9月20日)。PyTorch是什么，它是如何工作的？检索自</em><a class="ae ll" href="https://hub.packtpub.com/what-is-pytorch-and-how-does-it-work/" rel="noopener ugc nofollow" target="_blank"><em class="ms">https://hub . packtpub . com/what-is-py torch-and-how-do-it-work/</em></a></p></div></div>    
</body>
</html>