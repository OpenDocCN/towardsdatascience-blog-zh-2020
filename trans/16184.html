<html>
<head>
<title>Using Word Vectors to Mathematically Find Words with Similar Meanings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用单词向量以数学方式找到意思相似的单词</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-word-vectors-to-mathematically-find-words-with-similar-meanings-fc9eadac3dbe?source=collection_archive---------32-----------------------#2020-11-07">https://towardsdatascience.com/using-word-vectors-to-mathematically-find-words-with-similar-meanings-fc9eadac3dbe?source=collection_archive---------32-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b1c0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="e1cd" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">学习使用词向量以编程方式计算文本的语义相似度</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/86277c26de18ca6784c1bf1ea147070e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LfRkN5boO_SjBi2cULwcgA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">卡尼·查拉科娃摄</p></figure><p id="ae04" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">简而言之，单词向量只不过是代表自然语言单词含义的一系列实数。这项技术是有用的NLP能力的重要使能器，使机器能够“理解”人类语言。本文讨论了如何使用单词向量以编程方式计算文本的语义相似性，例如，如果您需要根据文本所涵盖的主题对其进行分类，这将非常有用。它从一个概念视图和示例开始，然后说明如何使用spaCy(一个领先的用于NLP的Python库)来确定文本的语义相似性。</p><h1 id="fde5" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">词向量的概念</h1><p id="7103" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">所以，让我们先从概念上看一下单词向量，这样你就可以基本理解如何用数学方法计算以向量形式表示的单词之间的语义相似度。然后，您将查看spaCy的similarity()方法，该方法比较容器对象(Doc、Span、Token)的单词向量，以确定它们含义的接近程度。</p><p id="4a56" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在统计建模中，您将单词映射到反映单词语义相似性的实数向量。你可以把一个单词向量空间想象成一朵云，其中有相似意思的单词向量位于附近。例如，表示单词“apple”的向量应该更接近单词“pear”的向量，而不是单词“car”的向量。因为前两个指的是可食用的水果，而后者指的是四轮公路车辆。为了生成这些向量，你需要对这些单词的意思进行编码。事实上，有几种方法可以对意义进行编码。</p><h1 id="a0f7" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">用坐标定义意义</h1><p id="2f93" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">生成有意义的单词向量的一种方式是将现实世界中的对象或类别分配给单词向量的每个坐标。例如，假设您正在为以下单词生成单词向量:罗马、意大利、雅典和希腊。向量这个词应该在数学上反映出罗马是意大利的首都，并且与意大利有着雅典所没有的联系。同时，它们应该反映出雅典和罗马是首都城市，而希腊和意大利是国家。</p><p id="4196" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下图以矩阵的形式展示了这个向量空间的样子。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/55e712e90a58ce246f72fa3ad90faf5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*pFdPaXugMTgGhqm-J31maw.jpeg"/></div></figure><p id="6dae" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在这里，你在一个四维空间的坐标之间分配每个单词的含义，代表“国家”、“首都”、“希腊”和“意大利”等类别。在这个简化的例子中，坐标值可以是1或0，指示相应的单词是否属于该类别。</p><p id="8cfe" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">一旦你有了一个向量空间，其中的数字向量捕获了相应单词的含义，你就可以在这个向量空间上使用向量算术来洞察一个单词的含义。要找出雅典是哪个国家的首都，您可以使用以下等式，其中每个令牌代表其对应的向量，X是未知向量:</p><p id="7a46" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">意大利—罗马= X —雅典</p><p id="e30b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这个等式表达了一个类比，其中X代表单词vector，它与雅典的关系就像意大利与罗马的关系一样。为了解出X，你可以把等式改写成这样:</p><p id="ddd4" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">X =意大利—罗马+雅典</p><p id="8f61" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">首先，通过减去相应的向量元素，从向量意大利中减去向量罗马。然后你把结果向量和雅典向量相加。下图总结了这一计算。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi my"><img src="../Images/161f9961d167ce2d179b496dd215e49c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*pj8L-9Mn6pW1ZcLAzV5mpQ.jpeg"/></div></figure><p id="38ce" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">通过从代表意大利的单词vector中减去代表罗马的单词vector，然后加上代表雅典的单词vector，可以得到一个等于希腊的矢量。</p><h1 id="3151" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">用维度来表达意义</h1><p id="b26e" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">虽然您刚刚创建的向量空间只有四个类别，但是现实世界的向量空间可能需要成千上万个这样的类别。这种大小的向量空间对于大多数应用来说是不切实际的，因为它需要一个巨大的字嵌入矩阵。例如，如果您有10，000个类别和1，000，000个实体要编码，您将需要一个10，000 × 1，000，000的嵌入矩阵。</p><p id="5b7e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">减少嵌入矩阵大小的明显方法是减少向量空间中类别的数量。单词向量空间的实际实现不是使用坐标来表示所有类别，而是使用向量之间的距离来量化和分类语义相似性。各个维度通常没有固有的含义。相反，它们表示向量空间中的位置，向量之间的距离表示相应单词含义的相似性。要看一个真实向量空间的例子，你可以在<a class="ae mz" href="https://fasttext.cc/docs/en/english-vectors.html" rel="noopener ugc nofollow" target="_blank">https://fasttext.cc/docs/en/english-vectors.html</a>下载fastText单词向量库，它将单词的意思分布在一个300维的单词向量空间中。</p><h1 id="b273" class="ma mb iq bd mc md me mf mg mh mi mj mk kf ml kg mm ki mn kj mo kl mp km mq mr bi translated">空间相似性()方法</h1><p id="c2a1" class="pw-post-body-paragraph le lf iq lg b lh ms ka lj lk mt kd lm ln mu lp lq lr mv lt lu lv mw lx ly lz ij bi translated">在spaCy中，每种类型的容器对象都有一个相似性方法，允许您通过比较两个任意类型的容器对象的词向量来计算它们之间的语义相似性估计。为了计算跨度和文档的相似性(它们没有自己的词向量)，spaCy对它们包含的标记的词向量进行平均。</p><p id="728e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">即使两个容器对象不同，也可以计算这两个对象的语义相似度。例如，您可以将令牌对象与Span对象进行比较，将Span对象与Doc对象进行比较，等等。</p><p id="8225" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">以下示例计算Span对象与Doc对象的相似程度:</p><p id="e066" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">&gt; &gt; &gt; doc=nlp('我想要一个青苹果。')<br/></p><p id="f083" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这段代码计算句子“我想要一个青苹果”之间的语义相似度。短语“一个青苹果”也来源于这个句子。如您所见，计算出的相似度足够高，可以认为两个对象的内容是相似的(相似度的范围从0到1)。毫不奇怪，当您将一个对象与其自身进行比较时，similarity()方法返回1:</p><p id="ad38" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">&gt; &gt; &gt; doc . similarity(doc)<br/>1.0<br/>&gt;&gt;&gt;doc[2:5]。相似性(doc[2:5]) <br/> 1.0</p><blockquote class="na nb nc"><p id="3d39" class="le lf nd lg b lh li ka lj lk ll kd lm ne lo lp lq nf ls lt lu ng lw lx ly lz ij bi translated">注:文中使用的例子摘自我最近由No Starch出版社(<a class="ae mz" href="https://nostarch.com/" rel="noopener ugc nofollow" target="_blank">https://nostarch.com/</a>)出版的《用Python和spaCy(<a class="ae mz" href="https://nostarch.com/NLPPython" rel="noopener ugc nofollow" target="_blank">https://nostarch.com/NLPPython</a>)进行自然语言处理》一书。</p></blockquote></div></div>    
</body>
</html>