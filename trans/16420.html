<html>
<head>
<title>Practical Data Analysis Guide with Pandas: Direct Marketing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫实用数据分析指南:直接营销</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/practical-data-analysis-guide-with-pandas-direct-marketing-dfc2977a559d?source=collection_archive---------25-----------------------#2020-11-12">https://towardsdatascience.com/practical-data-analysis-guide-with-pandas-direct-marketing-dfc2977a559d?source=collection_archive---------25-----------------------#2020-11-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c757" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何洞察你的营销努力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8f97c230e5d8bb3945480b779471bfc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PsN3X17wvRHuKmgcdE6hw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">活动发起人</a>在<a class="ae ky" href="https://unsplash.com/s/photos/marketing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cc2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas为数据分析和操作提供了许多功能和方法。在本帖中，我们将使用熊猫来深入了解直销数据集。</p><p id="e06e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.kaggle.com/yoghurtpatil/direct-marketing" rel="noopener ugc nofollow" target="_blank">数据集</a>可在Kaggle上获得。它包含通过直邮完成的营销活动的相关数据。我们将研究这个数据集，并试图了解哪些客户可能会花更多的钱。</p><p id="1cb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从将数据集读入数据帧开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4beb" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="332c" class="ma mb it lw b gy mg md l me mf">df = pd.read_csv("/content/DirectMarketing.csv")<br/>print(df.shape)<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/ee27e7e7baeed21f03045ad161d47e16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhVGu_hSz6GCI8fDriXQfw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a768" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据由1000个观察值(即行)和10个特征(即列)组成。重点是“AmountSpent”列，它显示了客户到目前为止已经花了多少钱。</p><p id="dae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们开始分析之前，最好确保没有丢失值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="92bb" class="ma mb it lw b gy mc md l me mf">df.isna().sum()<br/>Age              0<br/>Gender           0<br/>OwnHome          0<br/>Married          0<br/>Location         0<br/>Salary           0<br/>Children         0<br/>History        303<br/>Catalogs         0<br/>AmountSpent      0<br/>dtype: int64</span></pre><p id="bb58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“历史”列包含303个缺失值。这些用于表示客户尚未购买。我们可以检查列中的其他值，然后决定如何处理缺少的值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dc0a" class="ma mb it lw b gy mc md l me mf">df.History.value_counts()<br/>High      255<br/>Low       230<br/>Medium    212<br/>Name: History, dtype: int64</span></pre><p id="de44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于这是一个分类列，我们可以用单词“Nothing”替换缺失的值，表示还没有购买。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="25ac" class="ma mb it lw b gy mc md l me mf">df.History.fillna("Nothing", inplace=True)</span><span id="0964" class="ma mb it lw b gy mg md l me mf">df.isna().sum().sum()<br/>0</span></pre></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="866a" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">花费的金额</h2><p id="648e" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们首先检查“AmountSpent”列的统计数据。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="88eb" class="ma mb it lw b gy mc md l me mf">print(f'The average money spent is {df.AmountSpent.mean()}. The median is {df.AmountSpent.median()}')</span><span id="04c9" class="ma mb it lw b gy mg md l me mf">The average money spent is 1216.77. The median is 962.0</span></pre><p id="638a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">平均值远高于中值，这表明该列不具有正态分布。存在高值的异常值。因此，我们期望“花费金额”列具有右偏分布。</p><p id="e56e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用直方图来检查一下。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9811" class="ma mb it lw b gy mc md l me mf">df['AmountSpent'].plot(kind='hist', figsize=(10,6))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ccdb5f6b8e01cbd38a7886e209b903d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*YjDYXXPCjgBSg2PEf9eptQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">花费金额柱状图(按作者分类的图片)</p></figure><p id="5071" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它与统计数据重叠。大多数观察值都在低位部分，少数异常值达到了高位。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="1a82" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">年龄</h2><p id="e7c2" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">年龄可能是一个重要的特征，因为直邮营销往往吸引老年人。groupby函数将为我们提供一个概览。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="77ed" class="ma mb it lw b gy mc md l me mf">df[['Age','AmountSpent']].groupby('Age').mean()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/e2a169fa8b41d84ef970fe88482fd14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*OzFrK_IaAEyYrvHe50v4nA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="1e9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">中老年人的平均消费金额比年轻人高得多。</p><p id="9d92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还想看看这场运动是否更侧重于老年人。我们可以检查发送到每个组的目录数量以及平均花费的金额。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6faf" class="ma mb it lw b gy mc md l me mf">df[['Age','Catalogs','AmountSpent']].groupby('Age').agg(['mean','count'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/7486e3a01281fa981bc838fe45599fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*RqSbIIFIrJ3X8StMBt2GwA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="bcf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计数显示了一个组中的观察次数。我们看到越来越多的中年人参与到这场运动中来。发送给年轻客户的平均目录数量略少于老年客户。</p><p id="6605" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所注意到的，我们可以通过向聚合函数传递一个列表来对组值应用多个聚合。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="178e" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">数值变量之间的相关性</h2><p id="a07b" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">在计算相关性之前，我将简单解释一下相关性对于变量的意义。</p><p id="db08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关性是每个变量的标准差对协方差的归一化。协方差是一种定量度量，表示两个变量的变化彼此匹配的程度。更简单地说，相关性和协方差表示值是否倾向于以相似的方式变化。</p><p id="2c35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">协方差的标准化消除了单位。因此，在正相关的情况下，相关值总是在0和1之间，在负相关的情况下，相关值总是在0和-1之间。</p><p id="8f16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了计算数值变量之间的相关性，我们将使用pandas的corr函数，并用热图可视化结果。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8c45" class="ma mb it lw b gy mc md l me mf">#importing visualization libraries<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="3983" class="ma mb it lw b gy mg md l me mf">plt.figure(figsize=(10,6))<br/>corr = df.corr()<br/>sns.heatmap(corr, annot=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/be4de8db1f1b9d7b7e0fe1f1aff110f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*OO_jo6LJ_WODxhf5JJWvFA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">热图(图片由作者提供)</p></figure><p id="8731" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">薪水和花费之间有很强的相关性。商品目录的数量也与消费金额成正相关。</p><p id="9f02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，孩子的数量和花费的数量有一个小的负相关。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="3049" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">儿童</h2><p id="dd38" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">相关矩阵显示，子女人数和花费金额之间呈负相关。因此，随着儿童数量的增加，我们预计支出会减少。</p><p id="9d1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也用groupby函数检查一下。我还将包括年龄栏。groupby函数接受多列，并为每组类别创建一个组。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ea99" class="ma mb it lw b gy mc md l me mf">df[['Age','Children','AmountSpent']]\<br/>.groupby(['Age','Children']).agg(['mean','count'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/c559623356a9f07277ae074aa8736dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*KxDm2sq1hxRoXd2h2aigUQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="87ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总的来说，平均花费随着孩子数量的增加而减少。不过也有一些例外。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="5988" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">性别与婚姻</h2><p id="9e32" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们将检查性别和婚姻列中的几个指标。groupby函数允许对不同的列应用不同的聚合函数。此外，我们可以重命名聚合的列。</p><p id="9148" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用这个例子会更清楚。我想创建基于性别和婚姻栏的小组。然后我会计算:</p><ul class=""><li id="6c0e" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">发送给每个组的平均目录数(平均值)</li><li id="52e1" class="nq nr it lb b lc nz lf oa li ob lm oc lq od lu nv nw nx ny bi translated">每组购买的总数量(总和)</li></ul><p id="eeb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还想适当地重命名这些列。下面是执行此操作的groupby语法:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ba63" class="ma mb it lw b gy mc md l me mf">df[['Gender','Married','AmountSpent','Catalogs']]\<br/>.groupby(['Gender','Married'])\<br/>.agg(<br/>    Average_number_of_catalogs = pd.NamedAgg('Catalogs','mean'),<br/>    Total_purchase_amount = pd.NamedAgg('AmountSpent','sum')<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/281273d778f3bdc87f68a7b7452a33fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*v050J3jd0fCxin3cs_LQAA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="760b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NamedAgg方法用于重命名列。更改列名的另一种方法是Pandas的重命名功能。</p><p id="00ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这家零售商绝对应该把重点放在已婚人士身上。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="f484" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">位置</h2><p id="dae7" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">位置也可能是一个重要的指标。让我们根据位置检查“花费金额”列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5b08" class="ma mb it lw b gy mc md l me mf">df[['Location','AmountSpent']].groupby('Location')\<br/>.agg(['mean','count','sum'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e4327dc142f715f1800ace8891b338b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*tTsv9fT2QDpmCdvnI2u_Ow.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="1270" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">住在附近的顾客数量是住在远处的顾客数量的两倍多。然而，他们比住在附近的顾客平均花费更多。</p><p id="1ffa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">零售商可能想多关注住在远处的人。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><h2 id="1068" class="ma mb it bd mp mq mr dn ms mt mu dp mv li mw mx my lm mz na nb lq nc nd ne nf bi translated">结论</h2><p id="078c" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li ni lk ll lm nj lo lp lq nk ls lt lu im bi translated">我们可以更深入地挖掘数据集，并试图获得更多的洞察力。我们还没有检查一些功能。然而，技术是非常相似的。</p><p id="4133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章的主要目的是介绍在数据探索中使用的不同技术和方法。当然，熊猫提供了更多的功能和方法。学习和掌握它们的最好方法是大量练习。</p><p id="1e05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我建议研究样本数据集，并尝试探索它们。有免费的资源可以让你找到样本数据集。例如，<a class="og oh ep" href="https://medium.com/u/451599b1142a?source=post_page-----dfc2977a559d--------------------------------" rel="noopener" target="_blank">杰夫·黑尔</a>在<a class="ae ky" rel="noopener" target="_blank" href="/the-top-10-best-places-to-find-datasets-8d3b4e31c442">这篇文章</a>中列出了10个寻找数据集的好地方。</p><p id="d395" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>