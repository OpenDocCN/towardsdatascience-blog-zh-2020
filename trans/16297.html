<html>
<head>
<title>Mastering Summary Statistics with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫掌握汇总统计</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-summary-statistics-with-pandas-d515e17756be?source=collection_archive---------15-----------------------#2020-11-10">https://towardsdatascience.com/mastering-summary-statistics-with-pandas-d515e17756be?source=collection_archive---------15-----------------------#2020-11-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c477" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Pandas库生成汇总统计数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e1429c024a1637beccd00f1bcd32814f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ahIzmK86mVHnXS9TdNa94w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@andrew" rel="noopener ugc nofollow" target="_blank">安德鲁·尼尔</a>在<a class="ae ky" href="https://www.pexels.com/photo/macbook-pro-on-brown-wooden-table-2312369/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="fd11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个python库，用于数据操作和统计分析。这是一个快速易用的开源库，支持多种数据操作任务。这些包括合并、重塑、争论、统计分析等等。在本帖中，我们将讨论如何使用Pandas库计算汇总统计数据。</p><p id="cfd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="b4b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们将探索网飞、Prime Video、Hulu和Disney Plus 数据集上的<em class="lv">电影。数据可以在<a class="ae ky" href="https://www.kaggle.com/ruchi798/movies-on-netflix-prime-video-hulu-and-disney" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</em></p><p id="9d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="4ea5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们将数据读入熊猫数据框:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5ac1" class="mb mc it lx b gy md me l mf mg">import pandas as pd <br/>pd.set_option('display.max_columns', None)<br/>pd.set_option('display.max_rows', None)<br/>df = pd.read_csv("MoviesOnStreamingPlatforms_updated.csv")</span></pre><p id="a10f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将打印该数据中可用的列:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="63d1" class="mb mc it lx b gy md me l mf mg">print(df.columns)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/83a732e211d5284d7fdae86379927680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nT3ETJPpEXnJg3nMY5o_ww.png"/></div></div></figure><p id="e58a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不需要“Unamed: 0”列，所以我们可以用“del”关键字删除它:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0191" class="mb mc it lx b gy md me l mf mg">del df['Unnamed: 0’]</span></pre><p id="c668" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们使用“head()”方法打印前五行数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ff28" class="mb mc it lx b gy md me l mf mg">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/0e10208c73a97fb1fcbd58cf023c8a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MaYmMwJ3WXJJ2xMxtG6QEg.png"/></div></div></figure><h2 id="9df1" class="mb mc it bd mj mk ml dn mm mn mo dp mp li mq mr ms lm mt mu mv lq mw mx my mz bi translated">计算平均值、标准差、中值、最大值和最小值</h2><p id="1739" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">我们要看的第一个方法是Pandas的“mean()”方法。让我们显示平均IMDb评级:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="a596" class="mb mc it lx b gy md me l mf mg">print("Mean IMDb Rating: ", df['IMDb'].mean())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/33fd127cca5826225d8220807e7cf2f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*07Tkx9qOkp3MeVO3DhsiXQ.png"/></div></figure><p id="9bb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用Numpy 'round()'方法将平均值四舍五入到最接近的十分之一:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="80d5" class="mb mc it lx b gy md me l mf mg">import numpy as np<br/>print("Mean IMDb: ", np.round(df['IMDb'].mean(), 1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c68f62772c8f255a93a17c5a47e6f914.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*5FEk2336ghIx0PmHHMEeng.png"/></div></figure><p id="4239" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以显示“IMDb”列的标准偏差、中值、最大值和最小值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3740" class="mb mc it lx b gy md me l mf mg">print("Standard Deviation in IMDb Rating: ", np.round(df['IMDb'].std()))<br/>print("Median IMDb Rating: ", np.round(df['IMDb'].median(), 1))<br/>print("Max IMDb Rating: ", df['IMDb'].max())<br/>print("Min IMDb Rating: ", df['IMDb'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/39b6a0c065334b12f1e61b88201b8c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*b48dn1aIt37lyOr_ZPVMJg.png"/></div></figure><p id="c99b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了方便起见，我们可以编写一个函数，给出任意数字列的汇总统计信息:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ef06" class="mb mc it lx b gy md me l mf mg">def get_statistics(column_name):<br/>    df_copy = df.copy()<br/>    print(f"Mean {column_name}: ", np.round(df_copy[column_name].mean(), 1))<br/>    print(f"Standard Deviation in {column_name}: ", np.round(df_copy[column_name].std()))<br/>    print(f"Median {column_name}: ", np.round(df_copy[column_name].median(), 1))<br/>    print(f"Max {column_name}: ", df_copy[column_name].max())<br/>    print(f"Min {column_name}: ", df_copy[column_name].min())</span></pre><p id="c44c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们用“IMDb”调用我们的函数，我们得到如下结果:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="4391" class="mb mc it lx b gy md me l mf mg">get_statistics('IMDb')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/46c18a6ea6bfc0daf139c9b914f15daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*AEBcSabd_r9b8Q7Fjp2FKA.png"/></div></figure><p id="254c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们调用“运行时”列中的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="e2f0" class="mb mc it lx b gy md me l mf mg">get_statistics('Runtime')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ad15904265d332062ff83ff7c20bdf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*-SVpCvNmrdOPY37HK4W-SQ.png"/></div></figure><p id="17cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们试试“烂番茄”专栏:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1d90" class="mb mc it lx b gy md me l mf mg">get_statistics('Rotten Tomatoes')</span></pre><p id="b051" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到以下错误:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/65ba84865d9da5054e87583d8d892ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3uBpgBRrWrQ-0ABHFzGrKQ.png"/></div></div></figure><p id="cf16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很明显我们需要分开处理这个案子。如果我们打印“烂番茄”值的前五行，我们会看到这些值是字符串:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3d75" class="mb mc it lx b gy md me l mf mg">print(df[‘Rotten Tomatoes’].head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/1fd002d5d2cee766ff9911a57aa6c11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*xp0iK94iqWu630cxtCTR4A.png"/></div></figure><p id="3300" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的函数中，我们可以检查“列名”输入是否为“烂番茄”。如果是，我们在计算汇总统计信息之前，删除“%”符号并将字符串转换为浮点型:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="73cf" class="mb mc it lx b gy md me l mf mg">def get_statistics(column_name):<br/>    df_copy = df.copy()<br/>    if column_name == 'Rotten Tomatoes':<br/>        df_copy[column_name] = df[column_name].str.rstrip('%')<br/>        df_copy[column_name] = df_copy[column_name].astype(float)<br/>        ...</span></pre><p id="5788" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以用“烂番茄”来调用我们的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1acb" class="mb mc it lx b gy md me l mf mg">get_statistics('Rotten Tomatoes')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3ed9ec8f34c8f3ac6fb1c6d841601316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*85OCvRLZtWhHACabVxrPBg.png"/></div></figure><h2 id="0841" class="mb mc it bd mj mk ml dn mm mn mo dp mp li mq mr ms lm mt mu mv lq mw mx my mz bi translated">使用“describe()”方法</h2><p id="9313" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">我们可以使用describe函数来生成上面的统计信息，并将其同时应用于多个列。它还提供了下限、中间值和上限。让我们将“describe()”方法应用于“IMDb”和“运行时”:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="518f" class="mb mc it lx b gy md me l mf mg">print(df[['IMDb', 'Runtime']].describe())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e3af274abd8a83b245150aba6ffc0fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*3ZK1A55I6HIEB-DUu5W3rA.png"/></div></figure><p id="000a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想在这些统计数据中包含“烂番茄”,我们需要像前面一样将其转换为浮点型:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="7ec1" class="mb mc it lx b gy md me l mf mg">df['Rotten Tomatoes'] = df['Rotten Tomatoes'].str.rstrip('%')<br/>df['Rotten Tomatoes'] = df['Rotten Tomatoes'].astype(float)<br/>print(df[['IMDb', 'Runtime', 'Rotten Tomatoes']].describe())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/aba51a4545b724fb208358c79df5a58f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d6utPLx8VYr1I7K-1SfQdQ.png"/></div></div></figure><h2 id="30a4" class="mb mc it bd mj mk ml dn mm mn mo dp mp li mq mr ms lm mt mu mv lq mw mx my mz bi translated">使用“groupby()”进行聚合</h2><p id="7bdc" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">假设我们想知道每个流派的平均运行时间。我们可以使用“groupby()”方法来计算这些统计数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0760" class="mb mc it lx b gy md me l mf mg">runtime_genre = df[["Genres", "Runtime"]].groupby("Genres").mean()<br/>print(runtime_genre.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/93707497b579d3c1857644aa4a23ab84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZMno1lcaoBjl-TeS-IMeg.png"/></div></div></figure><p id="7a05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以按“国家”来看平均“烂番茄”:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5434" class="mb mc it lx b gy md me l mf mg">rottentomatoes_country = df[["Country", "Rotten Tomatoes"]].groupby("Country").mean().dropna()<br/>print(rottentomatoes_country.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/4d7870a081fdedc63e53d5f493f78654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yyag7s-abpjKSBrtSLbUPg.png"/></div></div></figure><p id="3aa2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以编写一个函数，允许我们对任何分类列和数字列重复使用这个逻辑:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="dadb" class="mb mc it lx b gy md me l mf mg">def get_group_statistics(categorical, numerical):<br/>    group_df = df[[categorical, numerical]].groupby(categorical).mean().dropna()<br/>    print(group_df.head())</span></pre><p id="b9e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用“流派”和“运行时”来调用我们的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c774" class="mb mc it lx b gy md me l mf mg">get_group_statistics('Genres', 'Runtime')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/93707497b579d3c1857644aa4a23ab84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZMno1lcaoBjl-TeS-IMeg.png"/></div></div></figure><p id="00e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是我鼓励你自己动手处理数据和编写代码。</p><h2 id="c4ad" class="mb mc it bd mj mk ml dn mm mn mo dp mp li mq mr ms lm mt mu mv lq mw mx my mz bi translated">结论</h2><p id="2c97" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何使用Pandas库生成汇总统计数据。首先，我们讨论了如何使用pandas方法生成均值、中值、最大值、最小值和标准差。我们还实现了一个函数，该函数在给定一个数字列名的情况下生成这些统计信息。接下来，我们讨论了“describe()”方法，该方法允许我们为任何数字列生成除平均值、中值、最大值、最小值和标准偏差之外的百分位数。最后，我们展示了如何为分类列生成聚合统计信息。如果你有兴趣学习更多关于熊猫的数据操作、机器学习甚至只是python编程的一些基础知识，请查看<a class="ae ky" href="https://www.amazon.com/dp/B08N38XW2Q/ref=sr_1_1?dchild=1&amp;keywords=sadrach+python&amp;qid=1604966500&amp;s=books&amp;sr=1-1" rel="noopener ugc nofollow" target="_blank"><em class="lv">Python for Data Science and Machine Learning:Python编程、熊猫和Scikit-初学者学习教程</em> </a> <em class="lv">。我希望你觉得这篇文章有用/有趣。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/pandas_summary_statistics.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</em></p></div></div>    
</body>
</html>