<html>
<head>
<title>Towards machine learning — K Nearest Neighbour (KNN)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">走向机器学习——K近邻(KNN)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/towards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c?source=collection_archive---------29-----------------------#2020-10-02">https://towardsdatascience.com/towards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c?source=collection_archive---------29-----------------------#2020-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0fb7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">根据油耗和发动机大小对汽车进行简单的K近邻(KNN)分类。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/81232edffe36f13387d3c55973437def.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rhplqCjRonOSU6bL"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">纳亚尼·特谢拉在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="a32f" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">介绍</h2><p id="adcc" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">机器学习(ML)是当今一个非常流行的术语。我认为在网上过一天，不符合条件是不可能的。和我之前的许多人一样，我敢打赌，和我之后的许多人一样，不久前我在这个有趣的领域开始了我的旅程。</p><p id="732d" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">关于这个主题，有许多写得很好、很好的在线资源。我不是想发明新的轮子，我只是想分享我的观点，或者说我在学习密歇根大学<a class="ae kv" href="https://www.coursera.org/learn/python-machine-learning/home/welcome" rel="noopener ugc nofollow" target="_blank">的热门在线课程Python中的应用机器学习</a>时的想法。另外，我的目标是强调K最近邻法(KNN)的一些关键见解，我希望对初学者(比如我)有所帮助😊)从这种流行的机器学习方法入手的时候。</p><p id="902a" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">为了让事情更有趣一点，我使用了来自<a class="ae kv" href="https://github.com/udacity/AIPND/tree/master/Matplotlib/data" rel="noopener ugc nofollow" target="_blank"> Udacity </a>的燃油经济性数据集。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="f515" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简而言之，KNN</h2><p id="ef8a" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">KNN算法是一种监督最大似然算法，常用于分类和回归应用。KNN分类器是基于实例(记忆)的分类器，这意味着它们依赖于类别(输入)之间的相似特征，以便预测新的(独立的)输入或数据点的类别。一般来说，我们需要一个训练数据集，在这里我们的模型被训练来预测，我们在一个独立的数据集上评估模型性能，以检查准确性。</p><p id="5b40" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">KKN到底是如何运作的？好吧，假设我们有一个需要分类的数据集(数组)。查看下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c77f995dc1343a7d496b83134b2d5790.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*v6aIxq8sw6OCgWed7mUrDA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="f3c1" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">然后，在位置(50，40)添加一个新的数据点(棕色)。我们检查距离该新点最近的K个点(“邻居”)。我们假设K = 5。所以我们需要找到离新条目最近的5个点(棕色点)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/ab8e53dcaea1b22e4ecb6085a30f4497.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*liZE_5K6vK9HOqpvEvxwCQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:作者</p></figure><p id="bd2d" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">如果选择5，则根据欧几里德距离找到5个最近的点(浅紫色线)，我们可以看到5个点中有4个是红色的，因此我们的棕色点被分类到“红色”角。</p><p id="b915" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">K=5表示带有异常值的噪声模型和可能的错误标记数据(低K=1或K=2)之间的平衡，或导致拟合不足的大K，因此基本上，结果不太详细，或在最坏的情况下，所有东西都变成一个类。正确的K取决于数据集。大多数情况下，K是一个奇数，以避免随机决策，如果一个点距离两个已知类的距离相等。</p><p id="b350" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">足够的理论让我们开始实践吧！😊</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c85f" class="mz le iq bd lf na nb nc li nd ne nf ll jw ng jx lp jz nh ka lt kc ni kd lx nj bi translated">Python实现</h1><h2 id="2d2f" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">读取和检查数据</h2><p id="df88" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">首先我们将导入依赖项，在这种情况下，我们需要numpy、pandas、matplotlib和scikit-learn。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="adfb" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">我们还需要一些数据。在这个例子中，使用了来自Udacity的流行的汽车燃油经济性数据集。这是一个包含3929辆汽车基本信息的数据集，比如品牌、型号、年份、变速器类型、车型、汽缸数量、油耗、二氧化碳排放量等。</p><p id="1d91" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">在这里，我将举例说明如何使用KNN算法，根据气缸数量、排量、综合油耗和二氧化碳排放量，将未知车辆类别的汽车分类到适当的类别。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/a7eb82c68b04088f047456b000ec7bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D92NX7RTd_A_nA_CY5AnA.png"/></div></div></figure><p id="99f3" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">我们检查VClass列的唯一值，以获取数据集中的所有车辆类。我们有5节课。此外，我们创建了一个新列，其中包含用于绘图的类标签。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/e3f09354187ef86ebafb2a7301d4fa43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Mn---LfePbmy-sLVwFX5Q.png"/></div></div></figure><p id="b66b" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">由于我们的模型需要首先被训练，我们将把数据分成训练和测试数据(稍后用于评估)。为此，我们使用scikit-learn库中的train_test_split函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="8899" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">对于大型数据集(3929个条目)，我们不需要担心训练和/或测试规模。因此，函数的test_size参数为None (=0.25)，这意味着测试集包含25%的数据。</p><p id="ff93" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">检查数据总是好的做法。为此，使用了特征对图。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/5878ec09eac16b655f756aab3750d849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FqzzSy9hhLXbl9X5H7MY2Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">训练数据集的配对图</p></figure><p id="6c24" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">可以观察到一些有趣的模式。即随着气缸数量的增加，排量和CO2输出增加，而平均每加仑里程减少。此外，更大的燃料消耗会产生更多的二氧化碳。</p><p id="f268" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">观察数据的另一个好方法是3D绘图。这里，二氧化碳、气缸数和排量分别绘制在x、y和z轴上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/2c3f08d95c4b393fcbc99dd992645dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_PP_tICqgSXOB72Opy4ckQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">3D图—二氧化碳与气缸和排量的关系</p></figure><p id="5054" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">同样，我们可以观察到，气缸多、排量大的汽车往往会产生更多的二氧化碳。尽管如此，一些4缸或6缸的小型汽车也会产生大量的二氧化碳(可能是大功率输出的运动型汽车)。但总的来说，发动机越大，产生的二氧化碳就越多。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="c579" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">建立和测试模型</h2><p id="ad4d" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">首先，我们需要选择K个最近邻的数量。如前所述，对于这个例子，选择KNN= <strong class="mb ir"> 5 </strong>。</p><p id="33c0" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">然后对模型进行训练，显示精度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="9b23" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">模型的精度为<strong class="mb ir"> 0.4933 </strong>。理论上看起来不太好。但是对于我测试过的两辆车，这个模型给出了很好的预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/1b290beaa0bbf62fc8fbd959b8c7737b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*waKnAK0ZvWlhDgvgu4wQLw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/b38c5fdbf0e61368c9226ba31c25feaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YvPWkfspi8hfkXx8GFFJ8A.png"/></div></div></figure><p id="e1a2" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">福特嘉年华是“小型车”，宝马M5是“大型车”。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="03e7" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">精度随K不同而变化吗？</h2><p id="20c4" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">在这里，我们将检查是否改变最近邻K的数量可以改变我们的模型的准确性。为此，我们编写了一个简单的for循环。此外，random_state被改变，这导致不同的训练/测试分离组合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3dfd0da6efabca31b3c0a89510baedf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*h9bgrx95sTXEG9XMbcHJWg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机状态= 11</p></figure><p id="1adc" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">对于这个数据集和这个训练/测试分割，较大的K值导致较小的准确性。不同的训练/测试分割可能会产生不同的结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/0e6fb681092fcabf5e64f40269066783.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*ewrkumkmkSNaryNLatdNUg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机状态= 44</p></figure><p id="9007" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">有趣的是观察到训练集#44产生更大的最大和最小准确度。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="cc58" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不同的训练/测试比率会改变模型的准确性吗？</h2><p id="f1dd" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">最后但并非最不重要的是，我们将检查是否改变列车测试分割率可以增加我们的模型的准确性。首先，我们生成可能训练/测试比率的列表t。同样，K设置为5。然后创建一个循环，其中对于每个可能的t比率，运行200次模拟，并计算每个模拟的精度。然后计算每个比率500次运行的平均准确度，并绘制成散点图，以观察性能。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/4a21aae798fab36025d3ba4fa1c95caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*G6pzosG1BskRQIzu7xpJzw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机状态= 11</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/da82e89b7a985ec66525f95e997962af.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*Ki548gF24z_O9LHcyNBeJg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">随机状态= 44</p></figure><p id="f575" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">从图中可以看出，精度随着训练样本量的减少而降低。改变random_state在这里似乎没有影响，这是有意义的，因为我们对每个训练/测试比率运行500次模拟，然后计算平均精度。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h2 id="5e37" class="ld le iq bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h2><p id="59e7" class="pw-post-body-paragraph lz ma iq mb b mc md jr me mf mg ju mh lm mi mj mk lq ml mm mn lu mo mp mq mr ij bi translated">这里给出了一个KNN分类器在流行的汽车油耗数据集上的简短实现。首先，给出KNN方法的简要说明。然后，检查数据集以查看数据集中的一致性。然后，我们定义一个KNN分类器，K设置为5，这意味着一个新的数据点根据5个最近的邻居进行分类。</p><p id="c439" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">对于两个独立的测试示例，福特嘉年华和宝马M5，分类工作良好。此外，模型会针对不同的K值进行评估，对于这个特定的数据集，K值越小，模型越精确。将random_state更改为不同的值可以改变这种行为，但不会显著改变。</p><p id="a11e" class="pw-post-body-paragraph lz ma iq mb b mc ms jr me mf mt ju mh lm mu mj mk lq mv mm mn lu mw mp mq mr ij bi translated">此外，增加训练规模与测试规模的比率，应该会产生更好的结果。这里，由于大量模拟，更改random_state值的影响较小。</p></div></div>    
</body>
</html>