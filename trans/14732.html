<html>
<head>
<title>Analyzing World Stock Indices Performances with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python分析世界股票指数的表现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-world-stock-indices-performance-in-python-610df6a578f?source=collection_archive---------8-----------------------#2020-10-11">https://towardsdatascience.com/analyzing-world-stock-indices-performance-in-python-610df6a578f?source=collection_archive---------8-----------------------#2020-10-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d06eee26b9af7b2b4ca2b60b5058734f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iT5CO-L3Juiuei09"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1cb5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="lb">来自《走向数据科学》编辑的提示:</em> </strong> <em class="lb">虽然我们允许独立作者根据我们的</em> <a class="ae kc" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="lb">规则和指导方针</em> </a> <em class="lb">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae kc" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="lb">读者术语</em> </a> <em class="lb">。</em></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="5ebb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">股票指数是选定公司的列表，其平均价格(或加权平均)反映了股票市场。股票指数也可以反映它们所涵盖的某个行业或地区。它们也经常被称为衡量基金业绩的基准。与当前价格相比，股票指数更重要的部分是某个确定时刻的表现或价格变化，无论是前一天还是前三个月。</p><p id="e613" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文的后半部分将介绍如何用Python评估股票指数的表现。</p><h1 id="eb65" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">如何获取数据</h1><p id="fe80" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">与股票指数相关的数据可以从Yahoo！金融。在Python中，有一个流行的模块可以更容易地从Yahoo！金融。如果它还没有安装，您可以通过输入这段代码，然后导入所需的库/模块进行处理，将它安装到您的Jupyter笔记本中。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3bb3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，我们如何获取股票数据呢？因为这篇文章是分析世界主要指数的表现，下一步要做的是从Yahoo！财经网站。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="f7c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，这是从网站上摘下的列表的标题/开头内容:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/6ff8be54a6c0d782a0c238774a6a7fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nK_4pxvkVogr_Ren0j0-kA.png"/></div></div></figure><p id="013b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，对于每个股票指数，每行都有名称和符号。这些符号对于检索数据非常重要。现在，是时候为这些股票指数收集历史数据了。</p><p id="d5c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了收集每个股票指数的历史数据，首先，我们需要用symbol的参数调用Ticker模块。例如，如果我们想获得标准普尔500的历史数据，我们可以键入:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="925a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还需要定义数据检索的周期。应该获取日数据还是周数据？必须在“周期”参数中输入。还必须定义开始和结束日期。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="a15c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，将从2020年1月1日开始每天(“1d”)检索数据，直到2020年9月30日。参数中指定的结束日期将不包括在检索到的数据中(因此，只检索到前一天)</p><div class="mm mn mo mp gt ab cb"><figure class="mt jr mu mv mw mx my paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/7d7d779240c61e8084d9a759864ff846.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*8cy27Cfohgr4GMeu9bSSaA.png"/></div></figure><figure class="mt jr mz mv mw mx my paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/a7b9e543fc507e9e7f29d8c70dc51b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*EFpGxZK4EhfGmsScLtKClw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk na di nb nc translated">S&amp;P历史股票数据—左:数据的头/开始，右:数据的尾/结束</p></figure></div><p id="61d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在是时候收集<strong class="kf ir">所有</strong>股指的历史数据了。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">获取股票指数的历史数据</p></figure><div class="mm mn mo mp gt ab cb"><figure class="mt jr nd mv mw mx my paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/d1b8b7de49c8ee36a5a677eb0b54eeec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*Fnpxb5uq2iKEKJkw97Ffcg.png"/></div></figure><figure class="mt jr ne mv mw mx my paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/a367268c5611c72e4a0f5e44839c6e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*VY4ZvUS4vbPUlBVYbE9vUw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk nf di ng nc translated">世界主要股票指数历史数据—左:数据的开头/开头，右:数据的结尾/结尾</p></figure></div></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="4e80" class="lj lk iq bd ll lm nh lo lp lq ni ls lt lu nj lw lx ly nk ma mb mc nl me mf mg bi translated">一些预处理和数据分析</h1><p id="c0a9" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">在前面的部分中，我们已经成功收集了从2010年1月到2020年9月30日的世界主要股票指数的历史股票数据。现在，是时候为分析做一些预处理了。</p><p id="d062" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想做的第一步是按地区对每个指数进行分类。以下是我对该地区的定义:</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">区域索引</p></figure><p id="bbf8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，为该区域创建一个新列。</p><pre class="mm mn mo mp gt nm nn no np aw nq bi"><span id="a1cc" class="nr lk iq nn b gy ns nt l nu nv">def getRegion(ticker):<br/>    for k in region_idx.keys():<br/>        if ticker in region_idx[k]:<br/>            return k<br/>msi['region']= msi.ticker.apply(lambda x: getRegion(x))</span></pre><h2 id="f573" class="nr lk iq bd ll nw nx dn lp ny nz dp lt ko oa ob lx ks oc od mb kw oe of mf og bi translated">自2010年初以来的价格变化</h2><p id="af54" class="pw-post-body-paragraph kd ke iq kf b kg mh ki kj kk mi km kn ko mj kq kr ks mk ku kv kw ml ky kz la ij bi translated">由于股票价格是以不同的货币表示的，因此要想全面了解业绩，最好以相同的单位或指标来查看。现在，让我们来看看这些指数自2010年1月4日以来十年间的价格变化。变化将以百分比(%)表示。价格变化使用当天的收盘价(“收盘”)。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="6350" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的代码块中，定义了一个新函数来计算价格变化。然后，对于主数据集中的每一行，调用该函数来输出价格变化。</p><p id="ecf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，为了简化流程，让我们将数据集转换为tickers作为列，将行作为每个日期的价格变化。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="a509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，价格变化的新数据框架将如下所示:</p><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/e82f63250c1813a77b5b1c072c938560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d9y4aJQtkXLdj89uXtR7jQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">每个股票指数的价格变动至2010年1月4日</p></figure><p id="5d30" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是时候绘制这些价格变化了。对于这一部分，地块将在区域中。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/850a489de520abedc02340547db1ba53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8piYZIwjl_CDaCkvbGcy-w.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">基于2010年1月4日的价格变化</p></figure><p id="acfe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的图中可以看出，自2016年以来，美国的股票指数增长迅速。自2010年以来，纳斯达克股票价格已经上涨了5倍。其他美国股票指数，如标准普尔500、罗素2000指数和道琼斯30指数也上涨了股价，但表现不如纳斯达克。</p><p id="48c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其他地区的一些指数价格也上涨了1-2.5倍。日经225指数(日本)、S&amp;P/新西兰50指数(新西兰)、S&amp;P BSE SENSEX指数(印度)和德国DAX指数(德国)是各自地区指数中最赚钱的股票指数(如果你自2010年1月以来以某种方式投资了它们或一些反映它们的基金)。</p><p id="5231" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也不能不提所有这些股票指数都受到了新冠肺炎的影响。它们都在2020年初左右显著下降，但总体而言，大多数都在此后不断攀升。</p><p id="5759" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">短期至长期价格变化/回报</strong></p><p id="9a45" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们谈论股票时，通常我们会将当前价格与前几个月或前几年的历史价格进行比较。对于这一部分，我们将分析短期到长期的价格变化。</p><p id="ec79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了清楚和详细，我们比较的是同一天的数据，而不是之前的数据。所以，2020年9月30日的6M(六个月)是指2020年9月30日前6个月的那一天，也就是2020年3月30日。同一天的1Y(一年)表示2019年9月30日，以此类推。</p><p id="ad74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将数据集划分到2020年9月30日。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="baf2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，要得到历史价格，有点棘手。我们想要引用的日期(过去的日期)可能不是工作日。除此之外，每个国家的工作日也不尽相同。因此，为了解决这个问题，我们选择过去日期之前的最后一个工作日。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="272d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，让我们来看看之前一些决定性时刻的价格变化。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="29d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们画出这些股票指数的价格变化/回报。</p><figure class="mm mn mo mp gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="mm mn mo mp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/295bb651fbe15ac0f9f7702c41c13230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziuVMW5rtSIODSuPjpryTw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">世界主要股票指数的短期至长期回报/价格变化</p></figure><p id="d5aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参照上面的图表，所有主要股票指数在6个月的时间里都表现良好(价格上涨)。另一方面，在其他时期，这些指数的表现参差不齐。10年来，大多数股票指数都是盈利的，除了STI指数(但只是略有下降)。</p><p id="9f05" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总之，参考相同的图，一般来说，最持续盈利的股票指数是:</p><ul class=""><li id="ff8c" class="ok ol iq kf b kg kh kk kl ko om ks on kw oo la op oq or os bi translated">标准普尔500(美国)</li><li id="0e39" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">道琼斯300指数(美国)</li><li id="949d" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">纳斯达克(美国)</li><li id="1d2d" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">日经225(日本)</li><li id="9062" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">深证成分指数(中国)</li><li id="8d15" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">S&amp;P/新西兰50总指数(新西兰)</li><li id="7e9f" class="ok ol iq kf b kg ot kk ou ko ov ks ow kw ox la op oq or os bi translated">TSEC加权指数(台湾)</li></ul></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="aa18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请检查以下链接中的代码以供进一步参考:</p><div class="oy oz gp gr pa pb"><a href="https://github.com/intandeay/StockIndicesAnalysis" rel="noopener  ugc nofollow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd ir gy z fp pg fr fs ph fu fw ip bi translated">库存/库存指数分析</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">github.com</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp jw pb"/></div></div></a></div></div></div>    
</body>
</html>