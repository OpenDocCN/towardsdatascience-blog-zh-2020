<html>
<head>
<title>End to End Adaptation of ResNet in Google Colab — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Google Colab中ResNet的端到端改编—第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6?source=collection_archive---------32-----------------------#2020-10-10">https://towardsdatascience.com/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6?source=collection_archive---------32-----------------------#2020-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="9835" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/getting-started" rel="noopener" target="_blank">入门</a></h2><div class=""/><div class=""><h2 id="60fe" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">只需点击几下鼠标，就能训练出一个深度神经网络</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5e14775974b01b6dbcbee6d519d96377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8HSdBUWZvj7Vh8srAHdHw.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来自Unsplash.com,<a class="ae le" href="https://unsplash.com/@markusspiske" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a></p></figure><p id="d825" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我在这篇文章中提供的代码示例是几个小时的挫折和在互联网上四处搜寻的结果。</p><p id="d3fe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">当我第一次开始自学深度神经网络时，我想找到一些我可以随时下载、即插即用并运行的东西——<strong class="lh ja">，但这很难找到。</strong>(再次)借用杰瑞米·霍华德的话，我真的很欣赏他如何从几行代码开始，证明训练一个深度神经网络不应该是令人生畏的。我想用Google Colab做类似的事情。</p><p id="213b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">不涉及代码和硬件要求的细节</strong>，一开始，我真的很想体验一下训练需要多长时间，过程是什么样的，以及“端到端”网络的整个代码库是什么样的，它做了以下四件事:</p><ol class=""><li id="bde2" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">下载并建立了一个深度神经网络</li><li id="b8da" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">获取数据集并对其进行格式化以用于训练</li><li id="0609" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">训练神经网络并进行验证</li><li id="1c3d" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">准备好接受输入进行测试</li></ol><p id="321b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输入谷歌Colab。我就不多说了，除非给你这个:</p><p id="5ea8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><a class="ae le" href="https://colab.research.google.com/drive/1W5tU1X3w1uIY-R1HpQredT1vpiLGcDIQ?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja">猫&amp;狗分类器使用Resnet-18 </strong> </a></p><p id="68bd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">你不需要知道任何Python来运行这个</strong>，你只需要两样东西——1)一个谷歌账户，这样你就可以启动笔记本；2)一个<a class="ae le" href="https://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>账户。</p><p id="069b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这段代码下载了一个由成千上万张狗和猫的图像(标记为)组成的数据集，通过ResNet-18架构运行该数据集进行训练，一旦完成，它将为您提供一种轻松测试网络的方法。</p><p id="9b71" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们开始吧。</p><h1 id="ecd9" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">1.获取您的Kaggle API JSON</h1><p id="30be" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">首先，登录Kaggle，点击右上角的图标，进入“我的账户”。向下滚动到标题为“API”的部分，然后单击“创建新令牌”。这将下载一个名为“kaggle.json”的JSON文件(希望下载到您的下载文件夹中)。</p><h1 id="2687" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">2.启动笔记本</h1><p id="8071" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">查看下面的屏幕截图—确保在单击“更改运行时类型”时选择了GPU，然后单击“保存”。然后选择“全部运行”。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nm"><img src="../Images/811daf91c761a5e8534e9af151e89f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sx3pYr4ENEZYcV1OHPb3xA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Google Colab上的运行时菜单。作者上传</p></figure><h1 id="4c0b" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">3.上传您的Kaggle JSON</h1><p id="7d0d" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">我已经试着让这变得尽可能简单。向下滚动一点，注意到代码正在等待您上传您在步骤1中下载的JSON文件。</p><p id="af96" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">单击“选择文件”并选择您的kaggle.json文件。这将验证您的身份，以便您能够获取数据集。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nn"><img src="../Images/2a2462992f9ec5025df8fcd545cebf2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v48MYRYibYpmiLZeBG86DQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">代码正在等待您的Kaggle JSON文件。作者上传</p></figure><h1 id="9f52" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">4.向下滚动</h1><p id="6130" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">我这样说并不是开玩笑，但是一旦你上传了JSON文件，代码就开始快速移动，很可能已经超过了你在页面上的位置，并且很可能已经开始训练，看起来像这样:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi no"><img src="../Images/393e11d39301d2578f886e73f9990889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1MrLUrsUDAaj0N133BESNQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">模型训练正在进行中。作者上传</p></figure><p id="3ce1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将需要一点时间，但不会太多，它可能运行在一个高端GPU上，为这样的任务而构建。</p><p id="38ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">等待代码完成训练。它将输出这样一行:</p><pre class="kp kq kr ks gt np nq nr ns aw nt bi"><span id="a085" class="nu mq iq nq b gy nv nw l nx ny">‘Training complete in 4m 51s’<br/>Best val Acc: 0.989370</span></pre><h1 id="d34b" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">5.准备好一张狗或猫的照片了吗</h1><p id="2389" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">同样，与上面等待JSON文件的方式类似，代码现在正在等待您上传图片。由于它只在狗和猫身上进行训练，我建议从这些动物中挑选一只来测试一下。任何其他动物都可能提供异常但肯定不可靠的结果。</p><p id="bf19" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">单击“选择文件”选择您的图片。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nz"><img src="../Images/e1a8870ee0dfdd98331f47aee22e877e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWYHs_1FOMThJ4a_nqAngg.png"/></div></div></figure><p id="9cd8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我发现了一张很棒的猫的照片:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c74476c56b0b3b7176d746a5319046f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*RlLqGAgtRgPqLeZqj98h1w.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来源:Unsplash.com</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/277c1491118523e06f184fda67e0ae48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WwkZ1N2_vPgy9RgKCB7kUQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">成功！作者上传</p></figure><h1 id="f9bf" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">几个音符</h1><p id="c865" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">我<strong class="lh ja">肯定</strong>掩饰了上面代码的一些细节，因为我想向你展示这个极其复杂的过程是可以实现的。</p><p id="cb54" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Colab的美妙之处在于，你不需要快速的互联网连接，或高端GPU或大量的内存来了解深度神经网络的内部工作方式。</p><p id="3b9d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们在英特尔至强处理器和NVIDIA显卡上训练了上述模型(ResNet-18)。对于世界上的绝大多数人来说，这种硬件在本地是买不到的，因为它们的成本太高(几千美元)。</p><p id="25f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们用一个几乎1Gb大小的数据集训练了上面的模型，下载Colab服务器只需几秒钟。在本地运行所需的时间和带宽也不是世界上大多数人能够获得的。</p><p id="3210" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">自学深度神经网络不应该受到你面前的技术的阻碍，你也不应该在头脑中想象这是如何在硬件上完成的。</p><p id="ee1b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有了我提供的Colab笔记本，你可以用一台简单的电脑和最少的网络连接来运行它。</p><p id="95d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但这只是第一部分！我希望你能在接下来的几周内加入我，我们将按部就班地解开这段代码。</p><p id="06b1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">请在下面留下任何问题，我会尽力回答。</p><h1 id="bb28" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">参考</h1><p id="b3e3" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">[1] <a class="ae le" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html" rel="noopener ugc nofollow" target="_blank">深度学习用Pytorch </a>，2020年10月访问</p><p id="4600" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[2] <a class="ae le" href="https://pytorch.org/tutorials/beginner/blitz/neural_networks_tutorial.html" rel="noopener ugc nofollow" target="_blank">神经网络与Pytorch。【2020年10月访问</a></p><p id="10c7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">[3] <a class="ae le" href="https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html" rel="noopener ugc nofollow" target="_blank">计算机视觉的迁移学习。【2020年10月访问</a></p></div></div>    
</body>
</html>