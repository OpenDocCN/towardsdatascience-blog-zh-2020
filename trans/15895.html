<html>
<head>
<title>How to Send Beautiful Emails With Python — The Essential Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python发送漂亮的电子邮件——基本指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-send-beautiful-emails-with-python-the-essential-guide-a01d00c80cd0?source=collection_archive---------8-----------------------#2020-11-02">https://towardsdatascience.com/how-to-send-beautiful-emails-with-python-the-essential-guide-a01d00c80cd0?source=collection_archive---------8-----------------------#2020-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5841" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python发送带有附件的风格化电子邮件。给多个收件人。</h2></div><p id="da9f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过Python这样的编程语言发送邮件有很多用例。例如，您可能想要管理一个邮件列表而不支付月费，或者在生产代码中出现问题时使用它来通知您。今天，您将学习如何轻松地向多个收件人发送精美的电子邮件。包括附件。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/13dc7cab40dd5b7499810bcd0ea6a527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4ROi0BGDsucnL7Y7"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><a class="ae lu" href="https://unsplash.com/@brandomakesbranding?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">摄白兰度在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上制作品牌</a></p></figure><p id="4513" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为此，我们将使用Python的<code class="fe lv lw lx ly b">smtplib</code>。SMTP代表<em class="lz">简单邮件传输协议</em>，对于你们这些书呆子来说。这是一个简单的库，允许我们发送电子邮件。我们还将使用<code class="fe lv lw lx ly b">email</code>库进行格式化。两者都内置在Python中，所以不需要安装任何东西。</p><p id="fad2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你更喜欢视频，我为你准备了一份礼物:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="2df5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">今天的日程如下:</p><ul class=""><li id="af11" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld mh mi mj mk bi translated">Gmail设置</li><li id="d0cd" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">发送简单的邮件</li><li id="2957" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">向多个收件人发送电子邮件</li><li id="09e1" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">发送附件</li><li id="2f24" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">发送HTML格式的电子邮件</li><li id="ed0b" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">结论</li></ul><p id="fd96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">内容太多了，让我们开门见山吧。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="90a0" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">Gmail设置</h1><p id="accd" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">我假设你的Gmail账户已经启用了双重认证。如果没有，你应该。我们必须生成一个密码，Python脚本将使用该密码登录您的帐户并发送电子邮件。</p><p id="0fc6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个简单的步骤。只需点击<a class="ae lu" href="https://myaccount.google.com/apppasswords" rel="noopener ugc nofollow" target="_blank">这个网址</a>，你就会看到这样一个屏幕:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/9d4d04bf3278273c82c83b57dc29dbc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/0*Z1uzjdabU9dBJWpu.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="cc5b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，您不会看到“Python电子邮件”行。只需点击<em class="lz">选择应用</em>下拉菜单，然后点击<em class="lz">其他(自定义名称)</em>。输入一个名称(任意)，点击<em class="lz">生成</em>按钮。</p><p id="fe4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样！像这样的模态窗口将会弹出:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/9f1aa34065bc22e3d2f9e2e15067f629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/0*AnrRuXSq53wnndUl.jpg"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="b200" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只要把密码保存在安全的地方。</p><p id="dd5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，您可以打开代码编辑器(或笔记本)并创建一个Python文件。以下是电子邮件和密码的库导入和变量声明:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nw mb l"/></div></figure><p id="e4a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住— <code class="fe lv lw lx ly b">EMAIL_ADDRESS</code>变量应该包含您的实际电子邮件地址，而<code class="fe lv lw lx ly b">EMAIL_PASSWORD</code>应该包含几秒钟前生成的应用程序密码。有一种更健壮、更安全的方法可以做到这一点——使用环境变量，但这超出了本文的范围。</p><p id="b1f4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在可以发送您的第一封电子邮件了。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="1492" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">发送简单的邮件</h1><p id="8f9f" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">这是你期待已久的部分。发送电子邮件之前需要几个步骤，如下所示:</p><ol class=""><li id="eb18" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld nx mi mj mk bi translated">创建一个<code class="fe lv lw lx ly b">EmailMessage</code>类的实例</li><li id="f6e3" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld nx mi mj mk bi translated">指定从、<em class="lz">到</em>的<em class="lz">和<em class="lz">主题</em>——你猜哪个是干什么的</em></li><li id="e615" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld nx mi mj mk bi translated">设置电子邮件的内容，即邮件本身</li><li id="b34a" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld nx mi mj mk bi translated">使用<code class="fe lv lw lx ly b">smtplib</code>建立安全连接(SSL)并登录您的电子邮件帐户</li><li id="34d4" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld nx mi mj mk bi translated">发送电子邮件</li></ol><p id="be37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">听起来工作量很大，但归结起来不到十行代码。以下是片段:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nw mb l"/></div></figure><p id="87c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，我已经将从到<em class="lz">到</em>的<em class="lz">字段设置为相同的值。这不是你通常会做的事情，但对于测试来说是必不可少的。这是我几秒钟后收到的电子邮件:</em></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/026fab2908fd155833f44246c233cbab.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/0*IPQ2XhwQXNDA62Pe.jpg"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="8a6e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来让我们看看如何向多个收件人发送电子邮件。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="4178" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">向多个收件人发送电子邮件</h1><p id="4e2d" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">如果你理解了前一部分，你就会理解这一部分。你只需要改变一件事。</p><p id="c7f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe lv lw lx ly b">msg['To']</code>中，您将不得不指定一个电子邮件列表，而不是指定一个您想要发送到的电子邮件地址(和前面的例子一样)。</p><p id="fa23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nw mb l"/></div></figure><p id="d863" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你能看出区别吗？发送给多个收件人比预期的要容易，因为你不必手动遍历列表。让我们继续邮件附件。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="58ab" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">发送附件</h1><p id="ee7c" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">发送附件有点奇怪，直到你掌握了它的要点。你必须用Python的<code class="fe lv lw lx ly b">with open</code>语法打开每个附件，并使用<code class="fe lv lw lx ly b">EmailMessage</code>类中的<code class="fe lv lw lx ly b">add_attachment</code>方法来添加附件。</p><p id="d37e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下面的例子中，这个方法被用来发送一个PDF文档。代码如下:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nw mb l"/></div></figure><p id="3342" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我几秒钟后收到的电子邮件:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/05f485008c1e279245221b1dcb4a4b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/0*EZJJ41iezel4ugAa.jpg"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="3c02" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">厉害！接下来让我们看看如何创建定制的电子邮件！</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="35d9" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">发送HTML格式的电子邮件</h1><p id="6847" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">如果你打算发送纯文本的、无风格的或者丑陋的邮件，你可以从你的列表中划掉inbound。这就是HTML和CSS发挥作用的地方。</p><p id="dde1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就代码而言，这与上一节中的内容几乎相同。唯一不同的是邮件内容。这次您将使用来自<code class="fe lv lw lx ly b">EmailMessage</code>类的<code class="fe lv lw lx ly b">set_content</code>方法来编写HTML。CSS样式是内嵌设置的。</p><p id="ded1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是我在几分钟内设计出来的:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nw mb l"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/6f784d9af9452f27f563ab959997488a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*EwUyCJZoW3jpL36m.jpg"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="f57a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不是很好，但比我们以前的有所改善。这就足够了。让我们在下一部分总结一下。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="d1be" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">离别赠言</h1><p id="01bb" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">用Python发送电子邮件很容易。Gmail配置让你可以直接从你的机器上发送邮件，不需要上传任何东西到实时服务器上。如果你问我的话，我觉得这很好。几年前，当我第一次开始通过PHP发送电子邮件时，本地主机不是一个选项(根据我的经验)。</p><p id="c8b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你今天已经看到了一堆新概念——从发送电子邮件到前端技术。这仅仅够让你入门，而且网络上有很多更高级的指南。</p><p id="6338" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。</p><p id="1c1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lu" href="https://mailchi.mp/46a3d2989d9b/bdssubscribe" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">加入我的私人邮件列表，获取更多有用的见解。</strong>T3】</a></p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><p id="be1e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lz">喜欢这篇文章吗？成为</em> <a class="ae lu" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="lz">中等会员</em> </a> <em class="lz">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ob oc gp gr od oe"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">medium.com</p></div></div><div class="on l"><div class="oo l op oq or on os lo oe"/></div></div></a></div></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><p id="fa47" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lz">原载于2020年11月2日https://betterdatascience.com</em><a class="ae lu" href="https://betterdatascience.com/send-emails-with-python/" rel="noopener ugc nofollow" target="_blank"><em class="lz"/></a><em class="lz">。</em></p></div></div>    
</body>
</html>