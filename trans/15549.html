<html>
<head>
<title>AutoVIML: Automating Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AutoVIML:自动化机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/autoviml-automating-machine-learning-4792fee6ae1e?source=collection_archive---------39-----------------------#2020-10-26">https://towardsdatascience.com/autoviml-automating-machine-learning-4792fee6ae1e?source=collection_archive---------39-----------------------#2020-10-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be8e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为任何给定的数据集自动选择最佳的机器学习模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/be45d0f1ece6f1b755c9f5be8f53d1d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q9Iz9PPKgfo5chUI"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@fatosi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法托斯Bytyqi </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1c64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习提供了学习算法的优势，该算法随着经验自动改进。有“n”种机器学习算法和技术，通常，我们需要测试其中的大多数，以便为我们的数据集找到具有最高准确性的最佳预测模型。</p><p id="daa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数机器学习方法，如回归技术、分类技术和其他模型都是在Sklearn中定义的，但为了选择哪种技术最适合我们的问题陈述或数据集，我们需要尝试所有这些模型以及超参数调整，并找出性能最佳的模型。这需要花费大量的时间和精力，使用名为AutoVIML的python包可以减少这些时间和精力。</p><p id="57b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">AutoVIML是一个开源的python包，使机器学习变得容易。它所做的是，通过不同的机器学习模型呈现你的数据，并为给定的数据集找出精确度最高的最佳模型。无需对数据集进行预处理即可将其传递给AutoVIML。它会自动清理您的数据，帮助您对变量进行分类，执行特征约简，可以在单个模型中处理不同类型变量的数据，如文本、数字、日期等。</p><p id="24b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将了解如何使用AutoVIML来减少创建机器学习模型的时间和精力。我们将看到我们在AutoVIML中使用的不同参数，以及它们对我们的预测有什么变化。</p><h1 id="4aac" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">安装AutoVIML </strong></h1><p id="856e" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">像任何其他python库一样，我们将使用pip来安装autoviml。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c987" class="mx lw it mt b gy my mz l na nb">pip install autoviml</span></pre><h1 id="a6b1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">导入AutoVIML </strong></h1><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="9ad9" class="mx lw it mt b gy my mz l na nb">from autoviml.Auto_ViML import Auto_ViML</span></pre><h1 id="e280" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">加载数据集</strong></h1><p id="85fb" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了探索AutoVIML，您可以使用任何数据集，这里我将使用一个与心脏病相关的数据集，您可以从Kaggle下载。这个数据集包含不同的属性和目标变量。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="13fb" class="mx lw it mt b gy my mz l na nb">import pandas as pd<br/>df = pd.read_csv('heart_d.csv')<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/f19fd14f0d9ca9413eed700b404a69e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bgb3xyKxodaLoNNcWgBiqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用的数据集(来源:作者)</p></figure><p id="0841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们了解一下如何使用autoviml来使用这个数据集制作预测模型，以及AutoVIML中有哪些参数。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="3e42" class="mx lw it mt b gy my mz l na nb">#Basic Example with all parameters<br/>model, features, trainm, testm = Auto_ViML(<br/>    train,<br/>    target,<br/>    test,<br/>    sample_submission,<br/>    hyper_param="GS",<br/>    feature_reduction=True,<br/>    scoring_parameter="weighted-f1",<br/>    KMeans_Featurizer=False,<br/>    Boosting_Flag=False,<br/>    Binning_Flag=False,<br/>    Add_Poly=False,<br/>    Stacking_Flag=False,<br/>    Imbalanced_Flag=False,<br/>    verbose=0,<br/>)</span></pre><p id="2f0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我们可以清楚地看到如何使用AutoVIML创建模型，以及我们可以使用哪些参数。现在让我们详细讨论这些参数是什么。</p><ol class=""><li id="d33f" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">train:它应该包含数据集的位置，或者如果您已经将数据集加载到数据帧中，则应该包含数据帧的名称。在本文中，我们将它加载到名为“df”的数据帧中，因此我们将它设置为“df”。</li><li id="1f7f" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">target:它包含目标变量的名称。在我们的例子中，目标变量名是“TenYearCHD”。</li><li id="640b" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">test:它包含测试数据集。如果我们没有任何测试数据集，我们也可以像这样将其留空，以便将训练数据集拆分为训练和测试。</li><li id="4be9" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">sample_submission:我们将把它留空，这样它将在我们的本地目录中自动创建提交。</li><li id="8446" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">hyper_param:我们将随机搜索cv，因为它比网格搜索CV快3倍。我们需要将此设置为“RS”。</li><li id="3a81" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">feature_reduction:我们将把它设置为true，这样它将考虑到模型创建中最重要的预测变量。</li><li id="6432" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">scoring_parameter:您可以给出自己的评分参数，否则它将根据模型假设合适的参数。我们将在这里使用“加权f1”。</li><li id="620a" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">KMeans_featurizer:这对于线性分类器应该为真，对于XGboost或随机分类器应该为假，因为它会导致过度拟合。</li><li id="a450" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">boosting_flag:用于升压。这里我们将保持它为假。</li><li id="8e1d" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">宁滨_标志:默认情况下，它是假的，当我们想把顶部的数字变量转换成装箱的变量时，它可以被设置为真。</li><li id="1c66" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">add_poly:我们将它设置为false。</li><li id="1766" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">stacking_flag:默认为False。如果设置为True，将添加从另一个模型的预测中派生的附加要素。我们将保持它为假。</li><li id="883c" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">Imbalanced _ flag:如果设置为TRUE，它将检查数据不平衡，并将使用SMOTING技术消除数据不平衡。</li><li id="b954" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">Verbose:通常用于打印所执行的步骤。我们将它设置为3。</li></ol><p id="a040" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们将所有这些参数用于我们的数据集，并使用AutoVIML创建具有最高精度的最佳性能模型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="1c88" class="mx lw it mt b gy my mz l na nb">model, features, trainm, testm = Auto_ViML(<br/>    train=df,<br/>    target="TenYearCHD",<br/>    test="",<br/>    sample_submission="",<br/>    hyper_param="RS",<br/>    feature_reduction=True,<br/>    scoring_parameter="weighted-f1",<br/>    KMeans_Featurizer=False,<br/>    Boosting_Flag=True,<br/>    Binning_Flag=False,<br/>    Add_Poly=False,<br/>    Stacking_Flag=True,<br/>    Imbalanced_Flag=True,<br/>    verbose=3<br/>)</span></pre><p id="06c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们分析一下我们得到的输出。</p><ol class=""><li id="ae25" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">数据分析部分</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/cc4e59d787e5cc3e41f7d3dd20bae68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2qy8plr2ZReiGyFioR5e6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据分析(来源:作者)</p></figure><p id="e9c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.数据清理和特征选择</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/076399e591a9090b7231d87fec7a8e4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b2E8Zc4cTVnf3yD86hCHqw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据清理(来源:作者)</p></figure><p id="ef64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.数据平衡和模型创建</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/bc4ec5bd7e650aeed40c818bc94bd6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Wv2gdPs_f-eoOOAO1sr6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据平衡(来源:作者)</p></figure><p id="800a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.分类报告和混淆矩阵</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/36b9a7932fe5e25cc221a183fd1eb40b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*7QFBU_itdQH-yttcGO9Ajw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">困惑矩阵(来源:作者)</p></figure><p id="0fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.模型可视化</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/435034bf54b124e0ae089710430d8a16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sP42uwXd3Y0kn6lxShb0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型可视化(来源:作者)</p></figure><p id="9ecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.特征重要性和预测概率</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9b17d331e64defa63a34c965dad1c282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*a72Jp1TcKwv-GKWkULm-Wg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:作者</p></figure><p id="4fca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的集合中，我们看到了AutoVIML如何处理数据，清理数据，平衡结果变量，以及创建最佳模型和可视化以获得更好的理解。</p><p id="73ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您可以使用不同的数据集探索AutoVIML，并在对本文的回复中分享您的经验。AutoVIML是一种根据数据集创建最佳性能机器学习模型的简单方法。</p><h1 id="b3d6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="2680" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="nx">感谢</em> </strong> <em class="nx">的阅读！如果你想与我取得联系，请随时通过hmix13@gmail.com联系我或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="nx"> LinkedIn个人资料</em> </strong> </a> <em class="nx">。可以查看我的</em><a class="ae ky" href="https://github.com/hmix13" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="nx">Github</em></strong><em class="nx"/></a><em class="nx">简介针对不同的数据科学项目和包教程。还有，随意探索</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="nx">我的简介</em> </strong> </a> <em class="nx">，阅读我写过的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>