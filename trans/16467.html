<html>
<head>
<title>Cash Demand Forecasting for ATMs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动取款机现金需求预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cash-demand-forecasting-for-atms-6113dd45fb2d?source=collection_archive---------29-----------------------#2020-11-13">https://towardsdatascience.com/cash-demand-forecasting-for-atms-6113dd45fb2d?source=collection_archive---------29-----------------------#2020-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9105" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我努力为任何一款lvl的DS提供端到端的解决方案</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/d7cf86caf68cd4957d1855c82f8b9b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtNp8PtznxdHIJkak6TnXw.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><h2 id="1f54" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">介绍</h2><p id="35f9" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">在这个主题中，我想向您展示一个端到端的解决方案。两周前在明斯克有一场由白俄罗斯银行代表领导的黑客马拉松。总共有3个任务，其中一个必须解决。对我来说，自动取款机上的现金需求任务是最有趣的，我想分享一下我的解决方案。</p><h2 id="20ff" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">工作</h2><p id="2bc9" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">需要预测各种自动取款机的每日现金需求量。数据是匿名的，特定ATM的操作时间以小时为单位，位置靠近主要城市设施(地铁、大型购物中心、企业检查站等)。)以及它属于哪个类似的无名城市。还会有用户贡献的金额报告。应该注意的是，如果在足够长的一段时间内没有对给定自动柜员机的需求(目标变量为零)，那么，可能当时它由于这样或那样的原因而不工作。SMAPE将被用作度量标准。</p><h2 id="442f" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">目标</h2><p id="b6c1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">此任务的目标是预测在要求的日期需要存入自动柜员机的现金金额。</p><h2 id="4467" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">计划</h2><p id="12c0" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">解决这样一个问题的计划很简单:</p><ul class=""><li id="d2b7" class="mg mh iq lp b lq mi lt mj la mk le ml li mm mf mn mo mp mq bi translated">熊猫的EDA分析</li><li id="46e1" class="mg mh iq lp b lq mr lt ms la mt le mu li mv mf mn mo mp mq bi translated">数据编码</li><li id="f503" class="mg mh iq lp b lq mr lt ms la mt le mu li mv mf mn mo mp mq bi translated">RF (sklearn)模型和XGBoost模型</li><li id="f124" class="mg mh iq lp b lq mr lt ms la mt le mu li mv mf mn mo mp mq bi translated">自定义搜索参数</li><li id="36bc" class="mg mh iq lp b lq mr lt ms la mt le mu li mv mf mn mo mp mq bi translated">创建最终模型</li></ul><h2 id="4c8b" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">导入，设置</h2><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="a8cb" class="kr ks iq mx b gy nb nc l nd ne">import numpy as np<br/>import pandas as pd<br/>import pickle<br/>import warnings<br/>import xgboost as xgb</span><span id="48d5" class="kr ks iq mx b gy nf nc l nd ne">from sklearn.ensemble import RandomForestRegressor<br/>from sklearn.preprocessing import LabelEncoder</span><span id="04b4" class="kr ks iq mx b gy nf nc l nd ne">pd.set_option('max_columns', 105)<br/>warnings.filterwarnings("ignore", category=FutureWarning)<br/>warnings.filterwarnings("ignore", category=DeprecationWarning)</span></pre><h2 id="f57a" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak">了解数据</strong></h2><p id="83de" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">总共提供了3个数据集:每个自动柜员机的参考书、交易活动以及带有目标的数据集。但是，既然这种竞争的条件之一是对未来时期的预测，那么，相应地，我们将无法考虑并从交易活动中获得必要的信息。这会导致我们接受再培训，这并不好。因此，考虑剩下的2个数据集。</p><p id="8d9c" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">首先是一本参考书。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="06d0" class="kr ks iq mx b gy nb nc l nd ne">active_atms_lookup = pd.read_csv('active_atms_lookup.csv', delimiter=',')<br/>active_atms_lookup.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/739e68112d34481a7203b09355611168.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*rqmRqfvHZq3RM0lCaurFMA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="0069" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">我们看到的:只有4列，如自动柜员机的ID、类别、工作小时数和所在城市。</p><p id="803e" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">让我们检查一下是否有空值。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="3425" class="kr ks iq mx b gy nb nc l nd ne">active_atms_lookup.isna().sum()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/56ce7b1d3e32ac435929c33b1d13ef85.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*au4oDTbUD-56ffh0a90GIQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="df12" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">原来我们只有6台ATM的信息，但是我们不知道它们。让我们移除它们。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="25d1" class="kr ks iq mx b gy nb nc l nd ne">active_atms_lookup = active_atms_lookup[~active_atms_lookup['TID_anon'].isna()]</span></pre><p id="ced8" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">让我们试着从这个指南中分离出尽可能多的信息，以便它能帮助我们在将来改进我们的结果。在这种情况下，我们可以将小时数带入值[0；1]，我们立即通过LabelEncoder和Pandas编码器对分类特征进行编码。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="5f21" class="kr ks iq mx b gy nb nc l nd ne">active_atms_lookup['working_hours'] = active_atms_lookup['working_hours'] / 24</span><span id="ebb9" class="kr ks iq mx b gy nf nc l nd ne">active_atms_lookup["atm_category"] = active_atms_lookup["atm_category"].astype('category')<br/>active_atms_lookup["city_anon"] = active_atms_lookup["city_anon"].astype('category')</span><span id="8a75" class="kr ks iq mx b gy nf nc l nd ne">active_atms_lookup["atm_category"] = active_atms_lookup["atm_category"].cat.codes<br/>active_atms_lookup["city_anon"] = active_atms_lookup["city_anon"].cat.codes</span><span id="ca7a" class="kr ks iq mx b gy nf nc l nd ne">lb = LabelEncoder()<br/>active_atms_lookup['DEVICEID_anon_code'] = lb.fit_transform(active_atms_lookup['DEVICEID_anon'])</span><span id="a935" class="kr ks iq mx b gy nf nc l nd ne">filename = 'atm_encoder.sav'</span></pre><p id="c813" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">关键时刻-考虑一个带有目标变量的数据集。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="02cd" class="kr ks iq mx b gy nb nc l nd ne">train_target = pd.read_csv('train_target.csv', delimiter=';')<br/>train_target.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/fb4191908e72ccc5216099d8602f9157.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*A3Frb0UZOPlllixi-v5i_A.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="ac9c" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">让我们将每个自动柜员机的值分组，看看是否有负值或零值。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="959d" class="kr ks iq mx b gy nb nc l nd ne">train_target.groupby('DEVICEID_anon')['target'].sum().reset_index().sort_values('target')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/b955a2f808f49ff59a034a41be83466d.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*Idx70-RPDJHrVakFXWwYXw.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="e907" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">原来有这样的自动取款机。让我们移除它，在未来，为了形成预测，我们将移除它。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="1290" class="kr ks iq mx b gy nb nc l nd ne">train_target = train_target[train_target['DEVICEID_anon'] != 'ATM_615']</span></pre><p id="8b3b" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">现在，让我们结合我们的数据集，并做一些进一步的转换。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="e461" class="kr ks iq mx b gy nb nc l nd ne">train_target = train_target.merge(active_atms_lookup, on=['DEVICEID_anon'])<br/>train_target.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nn"><img src="../Images/1a1dcf738d46b0daa00f5a1dc16e5231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1OyQUm33VjHaL2LJXEVRg.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="db34" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">我们有个约会。我不想用这种形式寄它。让我们从中提取所有信息:日、月、年等。让我们进行一些额外的转换，例如选择十年、一个周末或一个工作日。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="4ce5" class="kr ks iq mx b gy nb nc l nd ne">train_target['POSTINGDATETIME'] = pd.to_datetime(train_target['POSTINGDATETIME'])</span><span id="a327" class="kr ks iq mx b gy nf nc l nd ne">train_target['HOUR'] = train_target['POSTINGDATETIME'].dt.hour<br/>train_target['DAYOFWEEK'] = train_target['POSTINGDATETIME'].dt.dayofweek<br/>train_target['QUARTER'] = train_target['POSTINGDATETIME'].dt.quarter<br/>train_target['MONTH'] = train_target['POSTINGDATETIME'].dt.month<br/>train_target['YEAR'] = train_target['POSTINGDATETIME'].dt.year<br/>train_target['DAYOFYEAR'] = train_target['POSTINGDATETIME'].dt.dayofyear<br/>train_target['DAYOFMONTH'] = train_target['POSTINGDATETIME'].dt.day<br/>train_target['NAME_WEEKOFYEAR'] = train_target['POSTINGDATETIME'].dt.day_name()<br/>train_target['WEEKOFYEAR'] = train_target['POSTINGDATETIME'].dt.weekofyear</span><span id="0bc5" class="kr ks iq mx b gy nf nc l nd ne">train_target['WORKDAY'] = train_target['NAME_WEEKOFYEAR'].apply(lambda x: 0 if x == 'Saturday' or x == 'Sunday' else 1)</span><span id="1214" class="kr ks iq mx b gy nf nc l nd ne">train_target.reset_index(inplace = True)<br/>train_target.drop(['index'] , axis = 1, inplace = True)</span><span id="8506" class="kr ks iq mx b gy nf nc l nd ne">train_target['POSTINGDATETIME'] = train_target['POSTINGDATETIME'].dt.strftime('%Y-%m-%d')</span><span id="e564" class="kr ks iq mx b gy nf nc l nd ne">train_target = train_target.drop(['NAME_WEEKOFYEAR'], axis = 1)</span><span id="d0d5" class="kr ks iq mx b gy nf nc l nd ne">train_target = train_target.replace([np.inf, -np.inf], np.nan)</span></pre><p id="048c" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">我们应该受到祝贺。我们会对这些数据做任何我们想做的事情。</p><h2 id="8da5" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">建模和评估</h2><p id="d4c7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">让我们从度量开始。在这项任务中，使用了STAPE度量。一方面，使用这个指标，你可以很容易地向企业解释这个或那个机器学习模型是如何表现的，这很好。另一方面，在我们有一个目标变量= 0的情况下，它会导致问题，因为我们以这样一种方式调整我们的算法，它猜测0而不是零值。</p><p id="d21e" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">SMAPE的公式是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/8a1d85e738969cce179425a359817b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*vu3Hvx1XWQsCZRr9G1jvow.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="08ed" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">这个公式的代码是:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="e699" class="kr ks iq mx b gy nb nc l nd ne">def smape(actual, predicted):<br/>    return 100/len(actual) * np.sum(2 * np.abs(predicted - actual) / (np.abs(actual) + np.abs(predicted)))</span></pre><p id="ecff" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">对于这个任务，我只选择了两个模型进行评估:梯度推进和决策树。为什么是他们？因为我测试了很多不同的，这2个显示了最好的结果。</p><p id="6124" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">但是我们也不会用我们的数据进行测试。为了不满足过度拟合的事实，我们将使用时间序列交叉验证。</p><p id="a7d3" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">先说梯度提升。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="7fbc" class="kr ks iq mx b gy nb nc l nd ne">data_for_modeling = train_target<br/>data_for_modeling['POSTINGDATETIME'] = pd.to_datetime(data_for_modeling['POSTINGDATETIME'])<br/>tscv = TimeBasedCV(train_period=360,<br/>                   test_period=60,<br/>                   freq='days')<br/>for train_index, test_index in tscv.split(data_for_modeling,<br/>                                          date_column='POSTINGDATETIME'):<br/>    print(train_index, test_index)</span><span id="7831" class="kr ks iq mx b gy nf nc l nd ne"># get number of splits<br/>tscv.get_n_splits()</span><span id="de6b" class="kr ks iq mx b gy nf nc l nd ne">#### Example- compute average test sets score: ####<br/>X = data_for_modeling[columns]<br/>y = data_for_modeling['target']<br/>from sklearn.linear_model import LinearRegression<br/>import numpy as np</span><span id="794f" class="kr ks iq mx b gy nf nc l nd ne">scores = []<br/>for train_index, test_index in tscv.split(X):</span><span id="742b" class="kr ks iq mx b gy nf nc l nd ne">data_train   = X.loc[train_index].drop('POSTINGDATETIME', axis=1)<br/>    target_train = y.loc[train_index]</span><span id="3327" class="kr ks iq mx b gy nf nc l nd ne">data_test    = X.loc[test_index].drop('POSTINGDATETIME', axis=1)<br/>    target_test  = y.loc[test_index]<br/>    <br/>    dtrain = xgb.DMatrix(data_train, label=target_train)<br/>    dvalid = xgb.DMatrix(data_test)</span><span id="ad04" class="kr ks iq mx b gy nf nc l nd ne"># if needed, do preprocessing here<br/>    watchlist = [(dtrain, 'train')]<br/>    <br/>    model = xgb.train(xgb_pars, dtrain, 500, watchlist, early_stopping_rounds=500,<br/>                  maximize=False, verbose_eval=15)<br/>    <br/>    preds = model.predict(dvalid)<br/>    <br/>    # accuracy for the current fold only    <br/>    r2score = smape(target_test, preds)<br/>    print('SMAPE is ' + str(r2score))</span><span id="2ca9" class="kr ks iq mx b gy nf nc l nd ne">scores.append(r2score)</span><span id="45b5" class="kr ks iq mx b gy nf nc l nd ne"># this is the average accuracy over all folds<br/>average_r2score = np.mean(scores)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c4767fcfb64fcddbb2b05b4373d3c11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*U1UTD_pSOrmJ30Dwrg3HXQ.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="5819" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">老实说，我期待更好的结果。而当它们在不同的时间间隔分歧这么大的时候，那我们以后就不用了。然后我们将重点放在决策树上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/744c82b566abcfed7f73c1868bac3ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*cSWKml00set1NnSYIrZaHg.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="853d" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">这样好多了:)<br/>但是我不认为这是建模的极限。因此，我们来调一下模型。</p><h2 id="b342" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">调谐</h2><p id="4046" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv la lw lx ly le lz ma mb li mc md me mf ij bi translated">众所周知的调优方法，如hoperopt和gridsearch，对于这样一个模型似乎并不十分重要。因此，我们将自己的调音称为“一步一步”。有什么意义？我们接受n个参数并开始迭代它们。一旦我们找到最好的，就采用+1或+2参数，以同样的方式进行。以此类推直到结束，直到参数用完。<br/>这样调音的一个例子:</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="2539" class="kr ks iq mx b gy nb nc l nd ne">def random_forest(n_estimators, max_depth):<br/>    result = []<br/>    for estimator in n_estimators:<br/>        for depth in max_depth:<br/>            wmaes_cv = []<br/>            for i in range(1,5):<br/>                print('k:', i, ', n_estimators:', estimator, ', max_depth:', depth)<br/>                x_train, x_test, y_train, y_test = train_test_split(X_train, Y_train, test_size=0.3)<br/>                RF = RandomForestRegressor(n_estimators=estimator, max_depth=depth)<br/>                RF.fit(x_train, y_train)<br/>                predicted = RF.predict(x_test)<br/>                wmaes_cv.append(smape(y_test, predicted))<br/>            print('SMAPE:', np.mean(wmaes_cv))<br/>            result.append({'Max_Depth': depth, 'Estimators': estimator, 'SMAPE': np.mean(wmaes_cv)})<br/>    return pd.DataFrame(result)</span><span id="aae6" class="kr ks iq mx b gy nf nc l nd ne">n_estimators = [56, 58, 60]<br/>max_depth = [25, 27, 30]</span><span id="a142" class="kr ks iq mx b gy nf nc l nd ne">random_forest(n_estimators, max_depth)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/60382741beb42da1c87701756b2ccfaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*egvvVVlOQ6g93Zb3umRGAA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="0898" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">找到最佳参数后，我们可以保存模型并使用它。</p><pre class="kg kh ki kj gt mw mx my mz aw na bi"><span id="c011" class="kr ks iq mx b gy nb nc l nd ne">import pickle</span><span id="643e" class="kr ks iq mx b gy nf nc l nd ne">filename = 'model_reg.pkl'<br/>pickle.dump(RF, open(filename, "wb"))</span></pre><h2 id="3490" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0291f5ed8f97d7e40632659dba4aacfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*jIUfDQxaQYrVEm0Zog5XPw.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="d24f" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">在独立的数据集上，这样的模型显示了相当好的结果。落后于对手的差距往往只有几分之一。</p><p id="368d" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">需求会受到许多其他因素的影响，这些因素可以从互联网上收集:假期、各种经济形势、政治、天气等。如果我们学会考虑到这一点，我们可以保证结果有时会有所改善。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d6792ac8911804e871af1a397fc4d1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/1*s9we52AQB69mF3UK8Y144w.gif"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Nikita Lazarionok的图片</p></figure><p id="023a" class="pw-post-body-paragraph ln lo iq lp b lq mi jr ls lt mj ju lv la ng lx ly le nh ma mb li ni md me mf ij bi translated">我希望这篇文章对一个初学数据的科学家来说非常有用，并且有所帮助。<br/>如果你喜欢这篇文章，请点赞:)</p></div></div>    
</body>
</html>