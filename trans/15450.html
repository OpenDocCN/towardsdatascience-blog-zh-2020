<html>
<head>
<title>How to Use SQL in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在熊猫中使用SQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-sql-in-pandas-62d8a0f6341?source=collection_archive---------5-----------------------#2020-10-24">https://towardsdatascience.com/how-to-use-sql-in-pandas-62d8a0f6341?source=collection_archive---------5-----------------------#2020-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="50c8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将另一项关系数据库技能添加到您的数据科学工具包中</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ab9552e6618d9d4d33a7d0173459a151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hA9mY_q6KqB9VhqN"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://images.unsplash.com/photo-1489875347897-49f64b51c1f8?ixlib=rb-1.2.1&amp;ixid=eyJhcHBfaWQiOjEyMDd9&amp;auto=format&amp;fit=crop&amp;w=800&amp;q=60" rel="noopener ugc nofollow" target="_blank">https://images . unsplash . com/photo-1489875347897-49 f 64 b 51 C1 f 8？IX lib = r b-1 . 2 . 1&amp;ixid = eyjhchbfawqiojeymdd 9&amp;auto = format&amp;fit = crop&amp;w = 800&amp;q = 60</a></p></figure><p id="1cd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您考虑熊猫数据帧的结构和来自SQL数据库的表的结构，它们的结构非常相似。它们都由数据点或值组成，每一行都有唯一的索引，每一列都有唯一的名称。因此，SQL允许您快速访问您正在处理的任何项目所需的特定信息。但是，非常相似的查询可以使用熊猫！在这篇博文中，我将向您展示如何做到这一点，并解释您需要哪个库来实现它。</p><h2 id="7895" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">。查询()</h2><p id="9cbc" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">使用SQL时，获取我们需要的信息叫做<strong class="ky ir">查询</strong>数据。在Pandas中，有一个内置的查询方法可以让您做完全相同的事情，它被称为<em class="mq">。查询()</em>。这既节省了时间，又使您的查询在代码中更加连贯，因为您不必使用切片语法。例如，一个使用<em class="mq">查询Pandas中数据的简单示例。query() </em>方法会是:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="85b9" class="ls lt iq ms b gy mw mx l my mz">query_df <strong class="ms ir">=</strong> df.query("Col_1 &gt; Col_2")</span></pre><p id="378f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">否则，如果您不使用此方法获取数据，而是使用切片语法，它看起来会像这样:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="7d63" class="ls lt iq ms b gy mw mx l my mz">query_df <strong class="ms ir">=</strong> df[df[df['Col_1'] <strong class="ms ir">&gt;</strong> df['Col_2']]]</span></pre><p id="596e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就像我说的，<em class="mq">。query() </em>方法让你的代码看起来更专业，更高效。我想注意的一件重要的事情是，如果/当你决定在你的Pandas查询中使用“and”或“or”时，你实际上不能使用单词“and”或“or”——你必须使用符号“and”(&amp;)和“or”(|)。下面是一个使用“&amp;”帮助澄清的示例:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e9c6" class="ls lt iq ms b gy mw mx l my mz">query_df <strong class="ms ir">=</strong> df.query("Col_1 &gt; Col_2 &amp; Col_2 &lt;= Col_3")</span></pre><h2 id="5448" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">pandasql库</h2><p id="dfaa" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">众所周知，使用SQL和/或其所有变体的能力是数据科学家在市场上最需要的工作技能之一，即使是在疫情时期。幸运的是，现在Python中有一个名为<em class="mq"> pandasql </em>的库，它允许您编写sql风格的语法来从Pandas DataFrames中收集数据！这对于希望练习SQL技能的有抱负的数据科学家和习惯于使用SQL风格的语法收集数据的有经验的数据科学家来说都是非常好的。要将它安装到您的计算机上，只需使用！pip安装:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="48e3" class="ls lt iq ms b gy mw mx l my mz">!pip install pandasql</span></pre><p id="1d1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，要将它导入到您的笔记本中，您需要从<em class="mq"> pandasql: </em>中导入一个<em class="mq"> sqldf </em>对象</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="2d01" class="ls lt iq ms b gy mw mx l my mz"><strong class="ms ir">from</strong> pandasql <strong class="ms ir">import</strong> sqldf</span></pre><p id="cea3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入所有内容后，编写一个快速的lambda函数是一个好主意，它可以使编写查询更容易。这样做的原因是，每次使用一个对象时，不必传入全局变量。下面是我所学的lambda函数，我用它取得了成功:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="567a" class="ls lt iq ms b gy mw mx l my mz">pysqldf <strong class="ms ir">=</strong> <strong class="ms ir">lambda</strong> q: sqldf(q, globals())</span></pre><p id="e2c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，每当你向<em class="mq"> pysqldf </em>传递一个查询时，全局变量将在lambda中传递，这样你就不必为每个使用的对象一遍又一遍地做这些了。</p><p id="7ba0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在您已经做好了一切准备，可以使用与SQL相同的语法查询数据帧中的数据了！下面是一个例子—这个查询将从一个df中返回前10个名字:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="bc38" class="ls lt iq ms b gy mw mx l my mz">q = """SELECT Name <br/>       FROM df <br/>       LIMIT 10;"""<br/><br/>names = pysqldf(q)<br/>names</span></pre><p id="e4cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查询的复杂性取决于您的需求和您作为数据科学家的技能。因此，如果你习惯使用SQL风格的语法，或者希望提高你的SQL语法技能，使用<em class="mq"> pandasql </em>可以是一个继续组织你的数据&amp;练习你的技能的好方法。感谢您的阅读！</p><p id="3f94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.linkedin.com/in/acusio-bivona-7a315818b/" rel="noopener ugc nofollow" target="_blank">领英</a></p></div></div>    
</body>
</html>