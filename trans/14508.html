<html>
<head>
<title>Narrowing the Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">缩小数据范围</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/narrowing-the-data-3adeb6e04b02?source=collection_archive---------41-----------------------#2020-10-06">https://towardsdatascience.com/narrowing-the-data-3adeb6e04b02?source=collection_archive---------41-----------------------#2020-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="950d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">缩小大型数据集范围的技术探索。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c57d88c88ff2ad9486156e9d341a948a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHm6_ONmSeDwzHoOEf-cEQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">阿什利·朱利斯在<a class="ae kv" href="https://unsplash.com/s/photos/blue-data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="20d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最近，我完成了一个项目，预测美国面临粮食不安全风险的社区。你可以在这里找到关于那个项目<a class="ae kv" href="https://www.melissa-anthony.com/help-in-a-snap" rel="noopener ugc nofollow" target="_blank">的信息，包括代码和一个PowerPoint演示。在那个项目中，我使用了美国农业部的政府数据集，名为SNAP QC数据。这些是超过40k条记录和800多个特性的大规模数据集，并附有解释特性的技术文档。我将对我如何缩小数据集进行技术分析。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="faca" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">什么是QC数据集？</h1><p id="d854" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">美国农业部的SNAP程序使用“质量控制”数据。这些是质量控制数据集，这意味着它们已经以某种方式被手工挑选出来，以纳入最终的数据集。不幸的是，这些精挑细选的标准每年都在变化，尽管变化并不剧烈。由于政府数据对于这些项目来说是如此庞大，统计学家们正试图实现一些“特征”,这些特征代表了对那些参与项目的人的外部影响。对于SNAP参与者，大量不完整的申请被排除在外，这导致这些数据集更能代表受益者，而不是所有申请该计划的人。此外，这些数据集是加权的。这些权重是由对各州的经济影响决定的。例如，如果一个州宣布进入紧急状态，参与者的权重就会降低，以减少异常值对整个数据集的影响。</p><h1 id="f26c" class="lz ma iq bd mb mc mw me mf mg mx mi mj jw my jx ml jz mz ka mn kc na kd mp mq bi translated">缩小数据范围:GIS</h1><p id="e438" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对2007-2008年数据的空间分析显示，与邻近县相比，这些县是异常值。这是在ESRI空间数据科学MOOC期间完成的。首先，构建了一个2D模型，它可以直观地显示一个县一年到下一年的变化。这是用ESRI的“2D时间序列分析”工具建立的。接下来，使用他们的“新兴热点分析”工具来显示从2007年到2008年在统计上与其周围邻居有显著差异的县。</p><p id="e520" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它通过“使用您提供的空间关系的<strong class="ky ir">概念化</strong>值来计算每个条柱的<a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/spatial-statistics/h-how-hot-spot-analysis-getis-ord-gi-spatial-stati.htm" rel="noopener ugc nofollow" target="_blank"> Getis-Ord Gi*统计</a> ( <a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/spatial-statistics/hot-spot-analysis.htm" rel="noopener ugc nofollow" target="_blank">热点分析</a>)来实现这一点。时空热点分析完成后，输入NetCDF立方体中的每个条柱都会添加相关的z值、p值和热点条柱分类。接下来，使用<a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/space-time-pattern-mining/learnmorecreatecube.htm#ESRI_SECTION1_F1EA94A3BA8940E0B56AB08A302D1C08" rel="noopener ugc nofollow" target="_blank"> Mann-Kendall趋势测试</a>评估这些热点和冷点趋势。使用数据得到的每个<a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/space-time-pattern-mining/emerginghotspots.htm#ESRI_USAGE_70F085D5839440D58C10E39343674812" rel="noopener ugc nofollow" target="_blank">位置的趋势z值和p值，以及每个条柱的热点z值和p值，</a><a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/space-time-pattern-mining/emerginghotspots.htm" rel="noopener ugc nofollow" target="_blank">新兴热点分析</a>工具对每个研究区域位置进行分类。—摘自工具上的<a class="ae kv" href="https://pro.arcgis.com/en/pro-app/tool-reference/space-time-pattern-mining/learnmoreemerging.htm" rel="noopener ugc nofollow" target="_blank"> ArcGIS Pro文档</a>。</p><p id="1a74" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果突出了新墨西哥州圣胡安的一个使用增加的热点。以及内布拉斯加州樱桃县的一个新兴冷点，那里的参与者减少了。由于QC快照数据来自州一级，无法按县过滤，我选择比较内布拉斯加州和新墨西哥州，以突出极端情况。我还想做一个10年的缺口分析，以反映2008年危机对面临粮食不安全风险的社区的影响。所以我最终得到了4个数据集:2007年新墨西哥州和内布拉斯加州，2017年新墨西哥州和内布拉斯加州。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/79da9762406852863d95288b5d0c1bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUnfer4P9JZAUq5RqyWjoA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由此产生的“新兴热点分析”图。(图片由作者提供)</p></figure><h1 id="04ea" class="lz ma iq bd mb mc mw me mf mg mx mi mj jw my jx ml jz mz ka mn kc na kd mp mq bi translated">缩小数据范围:高无效性</h1><p id="47e3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了进一步缩小数据范围，我选择移除100%为空的列，这意味着它们是不包含数据的要素。这些功能可能是为了在全国范围内使用而添加的，根本不符合内布拉斯加州或新墨西哥州申请人的任何用例。对于内布拉斯加州和新墨西哥州来说，这些列是不同的，从2007年到2017年，它们也是不同的列。简单地说，每个数据集中所有空值的列都被删除。</p><p id="0221" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我发现了一篇名为“<a class="ae kv" href="https://www.researchgate.net/publication/331726516_The_proportion_of_missing_data_should_not_be_used_to_guide_decisions_on_multiple_imputation" rel="noopener ugc nofollow" target="_blank">缺失数据的比例不应用于指导多重插补的决策</a>”的论文，该论文讨论了高无效性的潜在概念。这篇论文得出的结论是，如果没有足够的信息来真实地表现这些特征，从这些栏目中收集的信息的完整性就会受到威胁。作者测试并得出结论，数据的价值比缺失的信息量更重要。因此，我决定将这些数据集中的高空性定义为超过50%的记录被标记为空值的列。我做出这个假设是基于这样一个事实，即我在每个数据集中有大量的记录，这些记录至少有50%或更多的数据是原始的。然后我删除了那些高无效列。</p><p id="6e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，在使用预测模型之前，我必须考虑数据集中剩余的空值。因此，我使用sklearn的简单估算器来输入其余值的平均值。使用平均值是因为一旦去除了高无效性特征，它是原始数据的合理表示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/62c084204111496076e465536fe2bbd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Z3Ou3vCT57yokGDoNQq6w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">移除高nullity值的列后剩余的列数。(图片由作者提供)</p></figure><h1 id="1f72" class="lz ma iq bd mb mc mw me mf mg mx mi mj jw my jx ml jz mz ka mn kc na kd mp mq bi translated">缩小数据范围:相关性</h1><p id="e359" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我选择将我的模型作为监督模型运行，目标变量为“猫_ELIG”。这是一个将每个应用程序标记为“是”或“否”的字段，表示它们有资格获得SNAP优势。这在2007年还好，但在2017年，内布拉斯加州和新墨西哥州的所有申请都被接受。因此，与目标变量的相关性仅在使用2007年数据集时有效。为了进一步增加相关性的维度，我可以使用PCA(主成分分析)来运行2017年的数据，PCA最适合推断无监督数据之间的相关性(这意味着不定义目标变量，因为所有应用程序在2017年对“CAT_ELIG”都标记为“是”)。不过，我在这里的目的是在2007年，即最初的GIS热点分析年，找到统计上显著的相关性，并看看它们在2017年如何变化。</p><p id="a2fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">技术文件包括6个观察部分。我的最终数据集是每个部分的前5个相关特征，作为最终的列集。每个数据集都有非常相似的前5个相关要素，从新墨西哥州到内布拉斯加州只有一些差异。最终结果是32个特性+目标列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/606fa22c7ae1df570663ab4806ed589a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cW6qoWZXqikYWWvSw-FEZQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用2007年新墨西哥州数据集的每个类别的前5个相关性的示例。(图片由作者提供)</p></figure><h1 id="4d43" class="lz ma iq bd mb mc mw me mf mg mx mi mj jw my jx ml jz mz ka mn kc na kd mp mq bi translated"><strong class="ak"> <em class="ne">缩小数据:型号</em> </strong></h1><p id="2db5" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对于这一分析，我想要一个可解释的模型，以便更准确地描述是什么影响了粮食不安全。由于高度多重共线性的内在可能性，我需要在最终模型中降低这种风险。一篇名为“<a class="ae kv" href="https://www.researchgate.net/publication/344437400_Support_Vector_Machine_vs_Random_Forest_for_Remote_Sensing_Image_Classification_A_Meta-analysis_and_systematic_review" rel="noopener ugc nofollow" target="_blank">支持向量机与随机森林用于遥感图像分类:元分析和系统综述</a>的论文讨论了SVM自70年代以来一直存在，是机器学习的真正进步，但它受到相关特征的高度影响。然而，兰登森林在一些情况下胜过了SVM。由于随机森林使用bootstrap和要素采样，因此它可以同时处理行和列级别的数据集，从而大大降低多重共线性对结果的影响。最终，我选择了Random Forest来:</p><ol class=""><li id="8d24" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nk nl nm nn bi translated">帮助缓冲与其他功能相关的功能的影响。</li><li id="4340" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nk nl nm nn bi translated">这给了我一个更高的精度和更少的超参数调整，从而通过不使其成为“黑盒”模型来增加其系数的可解释性。</li></ol><p id="2d17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最终找到正确模型的一个好方法是对数据进行几次初始测试，并比较分数。这可以告诉你哪些数据处理得很好。在测试和训练集上比较交叉验证的分数，以查看数据中有多少差异。对于这个项目来说，重要的是在正面预测方面出错，不管它们是否正确。这是因为，低估有需要的领域比担心被标记为需要更多支持但并不需要支持的领域更危险。因此，回忆被用来显示做出了多少正面预测，而精确则显示了多少正面预测是正确的。数字越接近，预测模型就越准确。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/4a48d65aac1ce0fbe28055055a38aec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fS7c0W5TGXCkARwxbv8ZUw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片作者。</p></figure><p id="6554" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用带有随机森林、梯度推进和Bagging分类器的投票分类器来给出95%的交叉验证分数。</p><ul class=""><li id="0409" class="nf ng iq ky b kz la lc ld lf nh lj ni ln nj lr nu nl nm nn bi translated">出于上面给出的原因，我使用了随机森林。</li><li id="c5ee" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nu nl nm nn bi translated">通过平衡正精度来提高精度的梯度增强。</li><li id="0980" class="nf ng iq ky b kz no lc np lf nq lj nr ln ns lr nu nl nm nn bi translated">和精度分数的bagging分类器。</li></ul><h1 id="c048" class="lz ma iq bd mb mc mw me mf mg mx mi mj jw my jx ml jz mz ka mn kc na kd mp mq bi translated">最后的想法</h1><p id="55b3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">每个项目都是独一无二的。虽然在这种情况下选择可解释的模型减少了可以设置的超参数，但这使得特征选择成为提高准确性的少数方法之一。数据科学家是数据将讲述什么故事的最终决定者。有很多方法可以微调我用来缩小数据的步骤，但缩小特征的数量是至关重要的，因为高方差对准确性和解释非常不利。最终，数据科学家必须根据数据和手头项目的最佳表现做出决策。</p></div></div>    
</body>
</html>