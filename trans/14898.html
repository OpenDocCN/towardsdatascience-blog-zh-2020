<html>
<head>
<title>Intermittent Demand Forecasting with Deep Renewal Processes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有深度更新过程的间歇需求预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/intermittent-demand-forecasting-with-deep-renewal-processes-f152d3f59f35?source=collection_archive---------51-----------------------#2020-10-13">https://towardsdatascience.com/intermittent-demand-forecasting-with-deep-renewal-processes-f152d3f59f35?source=collection_archive---------51-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9da5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们面对现实吧。任何在零售、物流、电子商务等领域从事时间序列预测工作的人。肯定会诅咒那条从不表现的长尾巴。可怕的间歇时间序列使预测者的工作变得困难。这种麻烦使大多数标准预测技术变得不切实际，提出了关于度量标准、模型选择、模型集成等等的问题。更糟糕的是，可能会有这样的情况(比如在备件行业，出现间歇性模式的是流动缓慢但非常关键或高价值的项目。</p><h1 id="9cfd" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">注释</h1><p id="28f3" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Y - <em class="lo"> i </em>时间序列的第元素</p><p id="b3d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">n -时间序列的索引</p><p id="2386" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">i -非零需求指数</p><p id="33f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Qi -需求间隔，即两个非零需求之间的差距。</p><p id="3410" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Mi-非零需求点的需求规模。</p><h1 id="5e1b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">传统方法</h1><p id="f713" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">传统上，有一类算法采用稍微不同的路径来预测间歇时间序列。这组算法将间歇性需求分为两部分——需求规模和需求间隔——并分别建模。</p><h1 id="5bd8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">克罗斯顿</h1><p id="3168" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">克罗斯顿提议对<em class="lo"> M </em>和<em class="lo"> Q </em>分别应用单一指数平滑，如下所示:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/d56b604fbfe1539328fd16f16a5209b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/0*hgO_kj4_KsPzwyFx"/></div></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/e4e6593297a682931ab3024351f14e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/0*6gxRFtBDy3nA8ZyW"/></div></div></figure><p id="f8a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">得到这些估计后，最终预测，</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/7b7e3cc1f0b6c2a606e8ea02fa6b59e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:178/0*HhQP9AMIdOQyt-1-"/></div></figure><p id="fb6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个单步提前预测，如果我们必须扩展到多个时间步，我们将得到一个具有相同值的平面预测。</p><h1 id="93f8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">克罗斯顿</h1><p id="e217" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Syntetos和Boylan，2005年指出，Croston预测对间歇性需求有偏见，并提出用需求区间估计的β进行修正。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi md"><img src="../Images/11a79078ac0caaf39a2aedf4a9172ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/0*sh3Frf3PyQ9GKcTM"/></div></figure><h1 id="65ee" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">克罗斯顿(SBJ)</h1><p id="7191" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Shale、Boylan和Johnston (2006)得出了到达遵循泊松过程时的预期偏差。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi me"><img src="../Images/e8ac6d4333146cb985d0de2a2a27e203.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/0*RxmT_PvzFWoir1lO"/></div></figure><h1 id="4ae8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">作为更新流程的克罗斯顿预测</h1><p id="7ff7" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">更新过程是一个到达过程，其中到达间隔是正的、独立的和同分布的(IID)随机变量。这个公式概括了任意长时间的中毒过程。通常，在泊松过程中，需求区间是指数分布的。但是更新过程的内部需求时间是有限的。</p><p id="e979" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Turkmen等人2019年将Croston及其变体铸造到更新过程模具中。定义在正整数上的随机变量<em class="lo"> M </em>和<em class="lo"> Q </em>完全定义了Yn</p><h1 id="446b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">深度更新过程</h1><p id="7076" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">一旦克罗斯顿预测被视为一个更新过程，土库曼等人提出，估计他们使用一个单独的RNN为每个“需求规模”和“需求间隔”。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/d8c72815578e18618cdaa99fd16331ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/0*VSLKLVlq4dQhXBFu"/></div></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/648ca14e723ee6e3fb77897a8776c8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/0*7ZZ-gYoBcIoAzkaP"/></div></figure><p id="d940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在哪里</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mh"><img src="../Images/a22b32508bf3252fa13d92f6938ce124.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/0*mdQgRn8ApTxPEIzC"/></div></div></figure><p id="c6ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着我们有一个单一的RNN，它接受输入的是M<em class="lo">和Q<em class="lo">并把这些信息编码到一个编码器中(<em class="lo"> h </em>)。然后，我们在这个隐藏层的顶部放置两个独立的NN层，以估计<em class="lo"> M </em>和<em class="lo"> Q </em>的概率分布。对于<em class="lo"> M </em>和<em class="lo"> Q </em>而言，负二项分布是本文建议的选择。</em></em></p><h1 id="7f7d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">负二项分布</h1><p id="3364" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">负二项分布是一种离散的概率分布，通常用于对计数数据进行建模。例如，售出的SKU数量、访问网站的人数或呼叫中心接到的服务电话数量。</p><p id="b702" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该分布源自一系列的<a class="ae mi" href="https://en.wikipedia.org/wiki/Bernoulli_trial" rel="noopener ugc nofollow" target="_blank">伯努利试验</a>，即每个试验只有两种结果。一个经典的例子是掷硬币，可以是正面也可以是反面。所以成功的概率是<em class="lo"> p </em>失败的概率是<em class="lo"> 1-p </em>(在公平的抛硬币中，这是各0.5)。所以现在如果我们继续进行这个实验，直到我们看到<em class="lo"> r </em>成功，我们看到的失败次数将会是负二项分布。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/3ec8a652b13518fc8daa485b1faba6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:282/0*3t78oGEOS_NhkiSM"/></div></figure><p id="f3f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们应用这一点时，成功和失败的语义不一定成立，但重要的是只有两种结果。</p><h1 id="29be" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">网络体系结构</h1><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/adc6548504368cfadb46129df3807b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/0*bVyKLCRA3ygNlyHG"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><h1 id="634a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">我们的贡献</h1><p id="0b08" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">本文只讨论了提前一步的预测，这也是你会在很多间歇性需求预测文献中发现的。但在现实世界中，我们需要比这更长的时间来进行适当的规划。无论是Croston还是深度更新流程，我们生成n步提前预测的方式都是一样的，即需求规模(M)/需求间隔时间(Q)的平面预测。</p><p id="c639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了现有的Flat方法之外，我们还引入了两种新的输出解码方法——精确解码和混合解码。假设我们用预测长度5来训练模型。</p><p id="d0bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模式的原始输出将是:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/386f488fe5790964f477e403f7137a3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/0*-NgIBVPjQQRwshCF"/></div></figure><p id="44c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">平</strong></p><p id="052a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在平面解码下，我们将只选取第一组输出(M=22和Q=2 ),并生成一个单步超前预测，并对所有5个时间步长扩展相同的预测。</p><p id="71c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">确切的说</strong></p><p id="2550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">精确解码是一种更有把握的解码方式。在这里，我们预测需求规模为M的需求，每个内部需求时间为Q，并使预测的其余部分为零。</p><p id="a095" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">杂交</strong></p><p id="a2d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在混合解码中，我们将这两者结合起来生成预测，该预测还考虑了模型预期的长期变化。我们使用M/Q值进行预测，但我们会根据后续步骤更新M/Q值。例如，在我们的例子中，我们将预测前两个时间步的11(22/3 ),然后预测下一个时间步的33(33/1 ),依此类推。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/b81f6540714f01986590df27f4e62380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/0*RlX8hc8WKWg5Dweh"/></div></figure><h1 id="e710" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">履行</h1><p id="28b7" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我已经使用GluonTS实现了该算法，Glu onts是一个基于MXNet的神经时间序列预测框架。AWS实验室是开源项目的幕后支持者，亚马逊内部使用DeepAR等一些算法来进行预测。</p><h1 id="a31d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">实施的模型</h1><p id="6ea3" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">本文讨论了该模型的两个变体——离散时间DRP(深度更新过程)和连续时间DRP。在这个库中，我们只实现了离散时间DRP，因为它是更流行的用例。</p><h1 id="00af" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">如何安装？</h1><p id="41b2" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">该软件包上传到pypi上，可以通过以下方式安装:</p><pre class="lq lr ls lt gt mr ms mt mu aw mv bi"><span id="5b38" class="mw km iq ms b gy mx my l mz na">pip install deeprenewal</span></pre><p id="5165" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">推荐Python版本:3.6 </strong></p><p id="d76c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://github.com/manujosephv/deeprenewalprocess】源代码:<a class="ae mi" href="https://github.com/manujosephv/deeprenewalprocess" rel="noopener ugc nofollow" target="_blank"/></p><p id="d5c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你运行的是Windows，需要使用你的GPU(我推荐)，你需要先安装支持GPU的MXNet==1.6.0版本<a class="ae mi" href="https://mxnet.apache.org/versions/1.6.0/get_started?platform=windows&amp;language=python&amp;processor=gpu&amp;environ=pip&amp;" rel="noopener ugc nofollow" target="_blank"> MXNet官方安装页面</a></p><p id="16a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在安装GPU版本时遇到困难，你可以试试(取决于你的CUDA版本)</p><pre class="lq lr ls lt gt mr ms mt mu aw mv bi"><span id="9622" class="mw km iq ms b gy mx my l mz na">pip install mxnet-cu101==1.6.0 -f <a class="ae mi" href="https://dist.mxnet.io/python/all" rel="noopener ugc nofollow" target="_blank">https://dist.mxnet.io/python/all</a></span></pre><p id="df53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相关<a class="ae mi" href="https://github.com/apache/incubator-mxnet/issues/17719" rel="noopener ugc nofollow" target="_blank"> Github问题</a></p><h1 id="7796" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">使用</h1><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="229b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">examples文件夹中还有一个笔记本，展示了如何使用该模型。相关摘录如下:</p><figure class="lq lr ls lt gt lu"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h1 id="e47d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">论文的实验和结果</h1><p id="fe48" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">本文在两个数据集——零件数据集和UCI零售数据集上对模型进行了评估。对于概率预测的评估，他们使用分位数损失。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nd"><img src="../Images/68dd648dedf1a08fabe2b0884ac059a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mGCOYrPhEGA9xgZN"/></div></div></figure><p id="2e33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作者使用具有10个隐藏单元的单个隐藏层，并使用softplus激活将LSTM嵌入映射到分布参数。他们使用了全局RNN，即所有时间序列共享LSTM参数。他们评估了提前一步的预测。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/022a217af8206cde42f66a94f952e38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/0*q3oYAN67_SK5wEx2"/></div></figure><h1 id="974b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">我们的实验和贡献</h1><h1 id="9410" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">实验设置</h1><p id="872b" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们没有重建实验，而是扩大了范围。我们选择的数据集是UCI零售数据集，而不是提前一步预测，而是提前39天预测。这更符合现实世界的应用，在现实世界中，您需要不止一步的提前预测来进行计划。除了与Croston及其变体进行比较，我们还与ARIMA、ETS、NPTS和Deep AR进行了比较(这是本文中提到的后续步骤)。</p><h1 id="8da8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">资料组</h1><p id="9b2c" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><a class="ae mi" href="https://archive.ics.uci.edu/ml/datasets/online+retail" rel="noopener ugc nofollow" target="_blank"> UCI零售数据集</a>是一个交易数据集，包含一家总部位于英国的注册无店铺在线零售商在2010年1月12日至2011年9月12日之间发生的所有交易。该公司主要销售独特的适合各种场合的礼品。这家公司的许多客户都是批发商。</p><p id="05dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">栏目:</strong></p><ul class=""><li id="bdbe" class="nf ng iq jp b jq jr ju jv jy nh kc ni kg nj kk nk nl nm nn bi translated"><em class="lo">发票号</em>:发票号。名义上，分配给每笔交易的6位整数。如果此代码以字母“c”开头，则表示取消。</li><li id="3262" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">库存代码</em>:产品(物品)代码。名义上，一个5位数的整数，唯一分配给每个不同的产品。</li><li id="6247" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">描述</em>:产品(物品)名称。名义上。</li><li id="ec0e" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">数量</em>:每笔交易每种产品(物品)的数量。数字。</li><li id="9145" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">发票日期</em>:发票日期和时间。数字，每笔交易生成的日期和时间。</li><li id="9a7f" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">单价</em>:单价。数字，单位为英镑的产品价格。</li><li id="e991" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo"> CustomerID </em>:客户编号。名义上，一个唯一分配给每个客户的5位整数。</li><li id="cfce" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated"><em class="lo">国家</em>:国家名称。名义上，每个客户居住的国家的名称。</li></ul><p id="9e35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">预处理:</strong></p><ul class=""><li id="6d22" class="nf ng iq jp b jq jr ju jv jy nh kc ni kg nj kk nk nl nm nn bi translated">分组依据为<em class="lo">库存代码</em>、<em class="lo">国家</em>、<em class="lo">发票日期</em> - &gt;数量之和<em class="lo">单价</em>的平均值</li><li id="2bce" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated">用零填充以使时间序列连续</li><li id="9a3a" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated">将数量的下限值裁剪为0(去除负值)</li><li id="18ae" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated">仅采用长度超过52天的时间序列。</li><li id="2243" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated">列车测试拆分日期:<em class="lo">2011–11–01</em></li></ul><p id="0be4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">统计:</strong></p><ul class=""><li id="98bd" class="nf ng iq jp b jq jr ju jv jy nh kc ni kg nj kk nk nl nm nn bi translated">时间序列数:3828。过滤后:3671</li><li id="905f" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk nk nl nm nn bi translated">数量:平均值= 3.76，最大值= 12540，最小值= 0，中值= 0</li></ul><p id="a1a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">时间序列分割</strong></p><p id="2138" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用我们之前讨论过的相同的分割——间歇的、不规则的、平滑的和不稳定的——我将数据集分成四份。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nt"><img src="../Images/1e1214f9036f3e9fa9414aaeeddb64ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DRYNI1nj_BRycSdN"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nu"><img src="../Images/e00e58b296e55170f9b9d1f3c77051be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H8Cz0Fv2MXYcEQuP"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><p id="a509" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，数据集中几乎98%的时间序列是间歇的或不规则的，这对于我们的用例来说是完美的。</p><h1 id="dc0d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">结果</h1><h2 id="2c79" class="mw km iq bd kn nv nw dn kr nx ny dp kv jy nz oa kz kc ob oc ld kg od oe lh of bi translated">基线比较</h2><p id="b442" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我们选择的基线是克罗斯顿预测。我们还对克罗斯顿做了轻微的修改，即SBA和SBJ。因此，让我们首先针对这些基线进行比较，包括一步预测和n步预测。我们也将评估点预测(使用MSE、MAPE和MAAPE)和概率预测(使用分位数损失)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2b32f6ca3bc9cb2f01b719e60940e076.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/0*njivAD157y1tpYAM"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">1步超前点估计值(中值)</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi oh"><img src="../Images/b76857a3277e3c95c57c32cc2c56b12a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UrpHPSoqA6u1Vhon"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">领先一步概率预测</p></figure><p id="e4e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，DRP模型在点预测和概率预测方面都大大优于基线方法。</p><p id="f980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来看一下n步提前预测。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9e30a7c270f75e3f6b58c3aabbc507ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/0*pK1UBZZJk84SfqRR"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">n步超前点估计值(中值)</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi oj"><img src="../Images/d71ceeee45aa384cd870801b6a0ccfcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MBzdfzUO3iNLQbGm"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">超前n步概率预测</p></figure><p id="392e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们看到了一个不同的画面。在预测点上，克罗斯顿在MSE上做得更好。DRP在MAPE做得很好，但是我们知道MAPE倾向于预测不足，并且当我们观察间歇性需求模式时，它不太可靠。因此，从预测的角度来看，我不会说DRPs的长期预测优于Croston。我们注意到的是，在DRPs中，混合解码在MAPE和MSE方面都比平面解码好得多。</p><h2 id="4ea8" class="mw km iq bd kn nv nw dn kr nx ny dp kv jy nz oa kz kc ob oc ld kg od oe lh of bi translated">扩展比较</h2><p id="9188" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">为了进一步比较这些结果，让我们也包括来自其他流行预测技术的结果。我们在点估计稳定中加入了ETS和ARIMA，在概率预测稳定中加入了DeepAR和NPTS。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/988a2ce348c5be142e642e15b1fbdc73.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/0*s0oqTILhr1bpuGUF"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">1步超前点估计值(中值)</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ol"><img src="../Images/94b4979f3e72a21b53665d3b41b9a6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vzDcrjgv1KHEy9B3"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">领先一步概率预测</p></figure><p id="c140" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在MSE上，ETS占据了头把交椅，尽管在MAPE和MAAPE上，DRP保住了他们的位置。在概率预测方面，DeepAR有非常高的分位数损失，但当我们看加权分位数损失(按量加权)时，我们看到它出现在顶部位置。这可能是因为DeepAR在大部分时间预测为零(或接近零)，并且只预测大批量SKU中的良好数字。在所有三个分位数的损失中，NPTS似乎以微弱优势胜过DRPs。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a9b4639e1ef6140a8153777170e07962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/0*tdhfR5Pn0tGK9Z7M"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">n步超前点估计值(中值)</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi on"><img src="../Images/773e9aefd0cf3fb049b0ea8c7759a2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eiyhqhRDxMhNQYnN"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">超前n步概率预测</p></figure><p id="ecdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们看长期预测时，我们看到ARIMA和ETS在点估计(MSE)方面做得相当好。在概率方面，Deep AR扭转了这一局面，并成功成为最佳概率模型。</p><h2 id="b8c8" class="mw km iq bd kn nv nw dn kr nx ny dp kv jy nz oa kz kc ob oc ld kg od oe lh of bi translated">几个预测的例子</h2><p id="15cf" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><strong class="jp ir">间歇</strong></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/9682899b2d532912b92b3439f1940e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/0*uTOF1gxzj_PD2BBq"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi op"><img src="../Images/f72c994b2cc15e16952c12737abe7f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/0*MlX1CphyEiDjyhCH"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/e14cb29a12d1323466e7564f2d102762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/0*j8mvgeRYXrU2GfQG"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi or"><img src="../Images/a348c2b629445795d94e077fc6ee3853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/0*JonH4iYl57z8UXev"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi os"><img src="../Images/b95c4076795d8ee930f25b25aa49eedb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/0*sCtMgceuA5Dts6iB"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8c884ec90753dac5fc76b71e23be005a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/0*Y2yMh1xEBvWVGKWH"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><p id="b9a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">稳定(较少间歇)</strong></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/4e70276796e035bd7c570e99846555f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/0*_msgyBUyNozDj7iP"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/2c0e0bb71701764056fa8ebfc5d83ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/0*h6ejS5D4-EvljkRb"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/8f34d900a4342e6ecf73e3a2a3b79c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/0*svWFnisFqOiCeIhA"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c82d30a2e5dd2398a5b61f772deafdcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*pXYKuPd2YyLYeFA9"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">作者图片</p></figure><h1 id="a278" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">参考</h1><ol class=""><li id="f0af" class="nf ng iq jp b jq lj ju lk jy ox kc oy kg oz kk pa nl nm nn bi translated">阿里·卡内尔·土库曼，王渔洋，蒂姆·贾努斯考斯基。<a class="ae mi" href="https://arxiv.org/pdf/1911.10416.pdf" rel="noopener ugc nofollow" target="_blank">“具有深度更新过程的间歇性需求预测”</a>。arXiv:1911.10416 [cs。LG] (2019)</li><li id="5400" class="nf ng iq jp b jq no ju np jy nq kc nr kg ns kk pa nl nm nn bi translated"><a class="ae mi" href="https://www.statisticshowto.com/contact/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">斯蒂芬妮格伦</strong> </a>。《负二项实验/分布:定义，例子》摘自<a class="ae mi" href="https://www.statisticshowto.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">StatisticsHowTo.com</strong></a>:对我们其他人来说的基本统计！<a class="ae mi" href="https://www.statisticshowto.com/negative-binomial-experiment/" rel="noopener ugc nofollow" target="_blank">https://www . statistics show to . com/negative-binomial-experiment/</a></li></ol></div><div class="ab cl pb pc hu pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="ij ik il im in"><p id="8cc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lo">原载于2020年10月13日</em><a class="ae mi" href="https://deep-and-shallow.com/2020/10/13/intermittent-demand-forecasting-with-deep-renewal-processes/" rel="noopener ugc nofollow" target="_blank"><em class="lo">【http://deep-and-shallow.com】</em></a><em class="lo">。</em></p></div></div>    
</body>
</html>