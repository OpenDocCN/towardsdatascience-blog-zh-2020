<html>
<head>
<title>Data Uniformity in Data Science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学中的数据一致性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-uniformity-in-data-science-9bec114fbfae?source=collection_archive---------38-----------------------#2020-11-14">https://towardsdatascience.com/data-uniformity-in-data-science-9bec114fbfae?source=collection_archive---------38-----------------------#2020-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="376c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">处理熊猫最常见的一致性问题</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b0a6cb7143264673121b819a49723d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TDilUniYUpehIjAnTzyjUg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">图片由</strong> <a class="ae kz" href="https://pixabay.com/users/mwewering-185784/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1699137" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ky">马蒂亚斯</strong> </a> <strong class="bd ky">上</strong> <a class="ae kz" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1699137" rel="noopener ugc nofollow" target="_blank"> <strong class="bd ky"> Pixabay </strong> </a></p></figure><h2 id="6cf3" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">介绍</h2><p id="9d56" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">在我以前关于数据清理的文章中，我谈到了超出范围的值、不正确的数据类型、唯一性约束是如何成为常见问题的，如果不加以处理，会严重影响我们的分析。</p><p id="8efe" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">在本文中，我们将解决一个同样危险的问题，它同样会扭曲我们的分析，这就是<strong class="ly iu">单元一致性</strong>。</p><p id="0864" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">与一致性相关的问题有多种形式:</p><ul class=""><li id="d4d1" class="mu mv it ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">华氏和摄氏温度数据</li><li id="6bce" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">重量以千克和磅表示</li><li id="d30e" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">多种日期格式</li><li id="65cb" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">用不同货币表示的货币</li></ul><p id="5235" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">这些问题的出现有很多原因。例如，跨多个位置收集数据并合并到一个位置。这会导致上述问题。您必须知道如何处理一致性问题，以便进行准确的分析。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="223b" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">设置</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/38852ac8b6e7ccb25a2d5b3b9b0f8b79.png" data-original-src="https://miro.medium.com/v2/format:webp/1*9hb3C02Vh5lo6K107xLeNA.png"/></div></figure><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="979e" class="la lb it nt b gy nx ny l nz oa">people.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/028c5909350648c9384e8ae9052b67b5.png" data-original-src="https://miro.medium.com/v2/format:webp/1*v1sItSRsNz0xmdF_U7sKWg.png"/></div></figure><blockquote class="ob oc od"><p id="b897" class="lw lx oe ly b lz mp ju mb mc mq jx me of mr mg mh og ms mj mk oh mt mm mn mo im bi translated">本文使用的笔记本和数据可以在<a class="ae kz" href="https://www.kaggle.com/bextuychiev/data-uniformity-in-data-science" rel="noopener ugc nofollow" target="_blank">本</a> Kaggle笔记本或<a class="ae kz" href="https://github.com/BexTuychiev/medium_stories/tree/master/november_2020/uniformity" rel="noopener ugc nofollow" target="_blank">本</a> GitHub repo上找到。</p></blockquote><h2 id="9b7b" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">单位一致性</h2><p id="87e0" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">考虑之前导入的这个温度数据集。它以摄氏度为单位给出了3个月的日平均温度信息:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ed14" class="la lb it nt b gy nx ny l nz oa">temperatures.sample(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/7651bc333f8eff61ec2f5ff508d0511e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*PaSkHAfNOjYjrA26pHRgMQ.png"/></div></figure><p id="03e6" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">如果我们看指数48，除非发生重大气候事件，我们可以猜测值是以华氏温度给出的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/4cf66a3acae5e72bb30e98e52ecc92df.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*HKpEfezZ2Rtfeo4EY0LPyw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">图片由</strong> <a class="ae kz" href="https://medium.com/@ibexorigin" rel="noopener"> <strong class="bd ky">作者</strong> </a></p></figure><p id="1780" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">在这种情况下，使用散点图直观地发现它们:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/793860bcddd3d2f83c9ff5756b3e3fac.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HmMeei9B4PeArVz5xDnR2g.png"/></div></figure><p id="d4ae" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">散点图清楚地显示了华氏温度值。快速的谷歌搜索向我们展示了将华氏温度转换为摄氏温度的公式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/297d0871ccc15afb96df1d2ba740289c.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*EZ1wjtRGszJxlzFlZJde1A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">图片由</strong> <a class="ae kz" href="https://medium.com/@ibexorigin" rel="noopener"> <strong class="bd ky">作者</strong> </a></p></figure><p id="38ac" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">现在，我们将使用该等式将40以上的任何值转换为摄氏度:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="c2bf" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">我们可以通过两种方式检查转换是否成功。首先，用<code class="fe ok ol om nt b">assert</code>声明:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="700c" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">再次使用散点图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/de13242d5274050ef0a350d7505ad33c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*3eceh0K0jrmIqcI_NlXvAw.png"/></div></figure><p id="8f19" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">尽管这是一个简单的例子，但你的情况可能完全不同。有时，你可能甚至没有注意到数据海洋中的不一致。在寻找它们之前，你必须完全了解你的数据，并了解这些数据是如何收集的。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="7389" class="la lb it bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">日期一致性</h2><p id="71b1" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">另一个非常普遍的问题是日期一致性。不同的国家有不同的标准日期时间格式，当您有来自多个来源的数据时，您将不得不处理多种日期格式。在Python中，有3种主要的日期时间格式可供使用:</p><ul class=""><li id="19ed" class="mu mv it ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">25–12–2019--&gt;<strong class="ly iu">(% d-% m-% Y)</strong>-&gt;年，月，日</li><li id="e6ab" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">2020年10月31日-&gt; <strong class="ly iu"> (%c) </strong> - &gt;字面日期</li><li id="099f" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">12–25–2019--&gt;<strong class="ly iu">(% m-% d-% Y)</strong>-&gt;月，日，年</li></ul><p id="cb1d" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">当您使用<code class="fe ok ol om nt b">pandas</code>将数据加载到您的环境中时，它总是将日期作为<code class="fe ok ol om nt b">object</code>数据类型导入。在设置部分，我们导入了包含人的全名和生日的示例数据:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="afd6" class="la lb it nt b gy nx ny l nz oa">people.sample(5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl nr"><img src="../Images/fb53ed5bb5bb652aefbf831f33d1f3a4.png" data-original-src="https://miro.medium.com/v2/format:webp/1*0KoyuCGtYkAzaIBMHm6pKw.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="9a84" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><code class="fe ok ol om nt b">birthday</code>列用YY-MM-DD格式表示日期，但用字符串表示。将日期列转换为<code class="fe ok ol om nt b">datetime</code>对于执行分析有很多好处。我们将使用<code class="fe ok ol om nt b">pd.to_datetime()</code>功能将列转换为<code class="fe ok ol om nt b">datetime</code>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="9840" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">我们出错了！如果我们仔细看，错误说月份必须在1，2，…，12。这意味着，在数据的某个地方，有一个不一致的值阻止了函数的运行。<code class="fe ok ol om nt b">pd.to_datetime</code>对此类情况有一个很好的解决方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="46e6" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">这一次，我们没有出现任何错误。如果您将<code class="fe ok ol om nt b">infer_datetime_format</code>设置为<code class="fe ok ol om nt b">True</code>，<code class="fe ok ol om nt b">pandas</code>将根据第一个非NaN元素自动识别日期格式，并将其余部分转换为该格式。如果有任何值不适合转换，<code class="fe ok ol om nt b">errors</code>参数决定如何处理它们。如果设置为<code class="fe ok ol om nt b">coerce</code>，<code class="fe ok ol om nt b">pandas</code>将放置<code class="fe ok ol om nt b">NaT</code>为缺失的日期值。</p><p id="4e19" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">基于我们的假设，上面的代码行应该已经发现了日期不一致，并将<code class="fe ok ol om nt b">NaT</code>放入不一致的日期:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="77f9" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">有几种方法可以处理这种不一致:</p><ul class=""><li id="d81b" class="mu mv it ly b lz mp mc mq lj mw ln mx lr my mo mz na nb nc bi translated">转换为NA并进行相应处理</li><li id="0874" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">通过查看数据源推断格式，它是如何收集的</li><li id="fda3" class="mu mv it ly b lz nd mc ne lj nf ln ng lr nh mo mz na nb nc bi translated">通过查看其他日期来推断格式</li></ul><p id="7b58" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">如果你有许多不一致，将它们转换成<code class="fe ok ol om nt b">NaN</code>并不总是一个选项。您应该通过观察它们的模式和推断它们的格式来尝试提出定制的解决方案。</p><p id="5d1b" class="pw-post-body-paragraph lw lx it ly b lz mp ju mb mc mq jx me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">完成错误处理和转换后，最佳做法是将日期列转换为全局日期时间标准:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/a423cc47844a29db9dc6ac5b5ab58ad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*b5bPIMTCJTmDW4-mQoimgg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd ky">图片由</strong> <a class="ae kz" href="https://medium.com/@ibexorigin" rel="noopener"> <strong class="bd ky">作者</strong> </a></p></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="9224" class="oo lb it bd lc op oq or lf os ot ou li jz ov ka lm kc ow kd lq kf ox kg lu oy bi translated">如果你喜欢这篇文章，请分享并留下反馈。作为一名作家，你的支持对我来说意味着一切！</h1><p id="2a96" class="pw-post-body-paragraph lw lx it ly b lz ma ju mb mc md jx me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">阅读更多与主题相关的文章:</p><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/data-type-constraints-data-range-constraints-duplicate-data-with-pandas-44897a350b1e"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">掌握DS/ML中最耗时的任务，#1</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">处理常见的数据问题</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/master-the-most-hated-task-in-ds-ml-3b9779276d7c"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">掌握DS/ML中最讨厌的任务</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">用Pandas清理分类数据</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pr l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/fuzzywuzzy-fuzzy-string-matching-in-python-beginners-guide-9adc0edf4b35"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">FuzzyWuzzy:Python中的模糊字符串匹配，初学者指南</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">…以及在真实数据集上的动手实践</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="ps l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">认识熊猫最难的功能，第一部分</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">掌握pivot_table()、stack()、unstack()的时机和方式</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pt l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">来自Kagglers:DS和ML的最佳项目设置</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">来自顶级Kagglers的项目成功最佳实践的集合</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pu l pn po pp pl pq ks pc"/></div></div></a></div><div class="oz pa gp gr pb pc"><a rel="noopener follow" target="_blank" href="/deep-guide-into-styling-plots-delivering-effective-visuals-12e40107b380"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">我的情节糟透了。以下是我如何修复它们。</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">你的，在某种意义上，可能也是。</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">towardsdatascience.com</p></div></div><div class="pl l"><div class="pv l pn po pp pl pq ks pc"/></div></div></a></div></div></div>    
</body>
</html>