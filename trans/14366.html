<html>
<head>
<title>Easy Automated Feature Engineering For Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于机器学习模型的简单自动化特征工程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/easy-automated-feature-engineering-for-machine-learning-model-ea00c5059dd6?source=collection_archive---------24-----------------------#2020-10-03">https://towardsdatascience.com/easy-automated-feature-engineering-for-machine-learning-model-ea00c5059dd6?source=collection_archive---------24-----------------------#2020-10-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ef9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自动化模型开发的痛苦部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f04e559d5a6f116629150f31f2a0d38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BqlEJkcTlNHmL9K7"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@gohrhyyan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Goh Rhy Yan </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="f5ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，我们知道处理数据是我们的日常活动。从拉数据，分析数据，创建一个有用的机器学习模型。</p><p id="43e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然许多人认为创建机器学习模型很容易，但事实并非如此。人们可能认为我们只需要输入一些编码语言，瞧！机器学习模型做好了。</p><p id="bd68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它可能是这样工作的，但是这个模型有用吗，对业务问题有什么影响吗？大部分时间可能不是。这是因为现实生活中的数据是杂乱的，如果没有适当的测量，它将导致一个有缺陷的模型。</p><p id="cb94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">提高机器学习模型性能的一种行之有效的方法是从现有特征或<strong class="lb iu">特征工程</strong>中创建新特征。</p><p id="ac42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特征工程的概念很容易理解，因为这个想法是关于从现有的特征中创建新的特征。例如，我们有产品价格及其重量的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/64773988b7f756f5095e99272ccd4482.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*Lauyb-kAK6KXM_Q_uv0dxA.png"/></div></figure><p id="00ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这两个特性中，我们可以创建一个新的特性。比方说每克的产品价格。在这种情况下，我们需要将价格除以产品重量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/a66691272b9b9ce2b64d1d1923bd6d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*8-_0FqYtntzm0RIVIyUhrQ.png"/></div></figure><p id="e253" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就这样，我们得到了一个新的特性。这就是特征工程的概念。</p><p id="fbea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习模型的核心是数据，提高性能的方法是通过特征工程，尽管掌握特征工程需要很多技能。我们需要有创造力，了解商业领域。这肯定要花很多时间。</p><p id="023f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解决特征工程问题的局部部分，我们可以自动化时间任务特征工程过程。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="bc86" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">自动化特征工程</h1><p id="41bc" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">用于执行自动化特征工程的主要开源库之一是<strong class="lb iu"> Featuretools </strong>。它是一个库，旨在通过自动化过程来加快特征生成过程。</p><p id="74d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在Featuretools中，有三个我们应该知道的包的主要组件。它们是:</p><ul class=""><li id="4105" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">实体</li><li id="23af" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">深度特征综合(DFS)</li><li id="6b65" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">特征基元</li></ul><p id="c1c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解释在下面的文章中。</p><ul class=""><li id="6c07" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated"><strong class="lb iu">实体</strong>是Featuretools中熊猫数据框的表示。多个实体被称为一个<strong class="lb iu">实体集</strong>。</li><li id="272e" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><strong class="lb iu">深度特征合成</strong> (DFS)是Featuretools中的一种特征工程方法。这是用于从单个和多个数据框创建新要素的方法。</li><li id="161d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">DFS通过将<strong class="lb iu">特征原语</strong>应用于EntitySet中的实体关系来创建特征。特征基元是我们称之为手动生成特征的方法，例如，基元平均值是聚合级别的变量的平均值。</li></ul><p id="3126" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是足够的理论；我们可能会直接跳到工具的实际用途。为了做好准备，我们需要先安装库。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="702d" class="nu mf it nq b gy nv nw l nx ny">pip install featuretools</span></pre><p id="0ad6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，Featuretools最适合用于具有许多关系的多个数据集。在这种情况下，我会使用来自<a class="ae ky" href="https://www.kaggle.com/olistbr/brazilian-ecommerce" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的Olist Brazallian电子商务数据集。</p><p id="b442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据在CSV文件中，由许多数据组成。在这种情况下，我会选择一些数据作为例子。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="6a33" class="nu mf it nq b gy nv nw l nx ny">olist_items = pd.read_csv('olist_order_items_dataset.csv')<br/>olist_product = pd.read_csv('olist_products_dataset.csv')<br/>olist_customer = pd.read_csv('olist_customers_dataset.csv')<br/>olist_order = pd.read_csv('olist_orders_dataset.csv')</span></pre><p id="3468" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们简单看一下数据。首先，我们来看看olist_customer数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/c1f631379dda3e1f95035208a1f8f739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2OS0FBjbXVrnyMq2mdhxA.png"/></div></div></figure><p id="01e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到数据包含一个唯一的变量作为标识，名为“customer_id”。当我们想使用Featuretools时，这个变量是必要的，因为特征工程的实体将使用这个唯一的变量作为分组指示符。</p><p id="10ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看olist_order数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/c836d0240f258658b05f96f70a4b68bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SMrfKpUWcoQ42LR6fuaB9A.png"/></div></div></figure><p id="0791" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，olist_order数据包含“order_id”变量作为标识，还包含“customer_id”变量来指示是谁下的订单。</p><p id="ea24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于最后一个，我需要产品的数据和商品的订单号，但是因为它分散在两个数据集中，所以我将它合并成一个。我还会删除一些我们不需要的功能，并为标识重置索引。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="a623" class="nu mf it nq b gy nv nw l nx ny">olist_item_product = pd.merge(olist_items, olist_product, on = 'product_id')</span><span id="7589" class="nu mf it nq b gy ob nw l nx ny">olist_item_product.drop(['order_item_id', 'seller_id'], axis =1, inplace = True)</span><span id="97a2" class="nu mf it nq b gy ob nw l nx ny">olist_item_product.reset_index(inplace = True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/992bd34f766f68a868b3259dc325d6a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmJeuvEiydasp4wD3uEtgg.png"/></div></div></figure><p id="221d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了所有需要的数据集。让我们尝试使用Featuretools来实现特征工程的自动化。</p><p id="c435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要准备的是执行DFS的实体。那么，我们到底需要在实体中准备些什么呢？正如我之前提到的，实体是一种数据框表示。在实体的情况下，我们将准备一个包含实体名称和带有标识的数据帧的字典。</p><p id="4742" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">实体的例子解释如下。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="f19e" class="nu mf it nq b gy nv nw l nx ny">#We prepare the dictionary with the specification is<br/>#'name of the entity' : (dataframe, identification)</span><span id="f180" class="nu mf it nq b gy ob nw l nx ny">entities = {<br/>    "customer" : (olist_customer, 'customer_id'),<br/>    "order": (olist_order, 'order_id'),<br/>    'item_product':(olist_item_product, 'index')<br/>}</span></pre><p id="a2c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要指定实体之间的关系。当两个实体存在一对多关系时，我们称“一”实体为“父实体”，“多”实体为“子实体”。父子关系是这样定义的。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="2370" class="nu mf it nq b gy nv nw l nx ny">#The relationship are defined by the entitiy name and the variable identification<br/>(parent_entity, parent_variable, child_entity, child_variable)</span><span id="3890" class="nu mf it nq b gy ob nw l nx ny">#Example<br/>relationships = [<br/>('customer', 'customer_id', 'order', 'customer_id'), <br/>('order', 'order_id', 'item_product', 'order_id')<br/>]</span></pre><p id="6d6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，我用“customer_id”变量定义了“customer”实体和“order”实体之间的关系，这两个变量存在于两个数据集中。</p><p id="f130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是自动化特征工程的时候了。这很容易做到；你只需要按照下面的线。请注意，这个过程需要一些时间，因为数据集非常大。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="cec8" class="nu mf it nq b gy nv nw l nx ny">import featuretools as ft</span><span id="9f29" class="nu mf it nq b gy ob nw l nx ny">feature_matrix_customers, features_defs = ft.dfs(<br/>entities=entities,                                                 relationships=relationships,<br/>target_entity="customer")</span></pre><p id="a061" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的代码，我会解释一下。正如我之前解释的，创建自动化的方法是DFS。在这种情况下，DFS方法主要接受三个参数。它们是:</p><ul class=""><li id="b908" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">实体</li><li id="0614" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">人际关系</li><li id="988d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">实体目标</li></ul><p id="e99d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前两个参数是我们之前创建的，最后一个“实体目标”是聚合的分组。在下面的例子中，假设我们想要基于<strong class="lb iu">客户</strong>级别的特征工程。</p><p id="7e60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">流程完成后，我们可以看到，我们最终获得了许多基于客户聚合的新特性。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="f844" class="nu mf it nq b gy nv nw l nx ny">feature_matrix_customers.columns</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/3dc3cc569621780d83e66a9ebd20dfac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJr3nJ1tnkit0P8tE33nww.png"/></div></div></figure><p id="4565" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在上面的图片中看到的，由于自动化特征工程，我们现在有410个特征。</p><p id="cd2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对如何阅读一些列名感到好奇，我可以解释一下。以SUM(item_product.price)为例。此列表示它是item_product实体的价格与客户聚合级别的总和。所以，用一个更人性化的术语来说，就是顾客所购买的商品的总价。</p><p id="029f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步，当然是用我们刚刚产生的数据开发机器学习模型。虽然我们已经创建了这个功能，但它是否有用还需要更多的实验。重要的是，我们成功地自动化了模型开发的耗时方面。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="c12d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="864b" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">特征工程是开发机器学习模型的一个重要方面，因为它正在影响我们的机器学习模型。然而，这个过程可能需要很长时间。</p><p id="8988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们可以使用名为Featuretools的开源库来自动化我们的功能工程过程。</p><p id="dbdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Featuretools中我们需要记住的三个术语是实体、深度特征合成、特征基元。</p><p id="00c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想了解更多关于Featuretools的信息，你可以访问主页<a class="ae ky" href="https://www.featuretools.com/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="bd27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望有帮助！</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="d20d" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">如果你喜欢我的内容，并想获得更多关于数据或作为数据科学家的日常生活的深入知识，请考虑在这里订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">时事通讯。</a></h1><blockquote class="oe"><p id="80aa" class="of og it bd oh oi oj ok ol om on lu dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的推荐</a>订阅。</p></blockquote></div></div>    
</body>
</html>