<html>
<head>
<title>How to implement an Adam Optimizer from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从头开始实现Adam优化器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-implement-an-adam-optimizer-from-scratch-76e7b217f1cc?source=collection_archive---------5-----------------------#2020-11-06">https://towardsdatascience.com/how-to-implement-an-adam-optimizer-from-scratch-76e7b217f1cc?source=collection_archive---------5-----------------------#2020-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="dfe8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没你想的那么难！</p><p id="830d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TL；博士如果你想跳过教程。这里是我创作的<a class="ae kl" href="https://github.com/enochkan/building-from-scratch/blob/main/adam-optimizer-from-scratch.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</p><p id="4ee1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Adam是一种基于自适应矩估计优化随机目标函数的算法。Adam的更新规则是momentum和RMSProp优化器的组合。</p><p id="57c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">规则很简单。从头开始编写Adam代码，无需借助任何外部ML库，如PyTorch、Keras、Chainer或Tensorflow。只允许我们使用的库是<code class="fe km kn ko kp b">numpy</code>和<code class="fe km kn ko kp b">math</code>。</p><p id="4bc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">(っ^‿^)っ(っ^‿^)っ(っ^‿^)っ(っ^‿^)っ(っ^‿^)っ(っ^‿^)っ</p><h1 id="eb1e" class="kq kr iq bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">第一步:理解亚当是如何工作的</h1><p id="6ab1" class="pw-post-body-paragraph jn jo iq jp b jq lo js jt ju lp jw jx jy lq ka kb kc lr ke kf kg ls ki kj kk ij bi translated">学习亚当作品最简单的方法就是看吴恩达的<a class="ae kl" href="https://www.youtube.com/watch?v=JXQT_vxqwIs" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">视频</strong> </a>。或者，你可以阅读亚当的<a class="ae kl" href="https://arxiv.org/abs/1412.6980" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">原论文</strong> </a> <strong class="jp ir"> </strong>来更好地理解背后的动机和直觉。</p><p id="594e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">亚当依赖的两个值是<em class="lt"> β </em> ₁和<em class="lt"> β </em> ₂.<em class="lt"> β </em> ₁是一阶矩估计的速率的指数衰减，其文献值为0.9。β是二阶矩估计的指数衰减率，文献值为0.999。这两个文献值适用于大多数数据集。</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/0218ac877ab519bf56c8989d959f1d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/0*6O_S2dXrCVGAilM1.png"/></div><p class="mc md gj gh gi me mf bd b be z dk translated">使用参数β1和β2计算移动平均值</p></figure><p id="fedd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在给定的迭代<em class="lt"> t </em>上，我们可以根据参数<em class="lt"> β </em> ₁、<em class="lt"> β </em> ₂和梯度<em class="lt"> gt计算移动平均。</em>由于SGD和RMSProp等大多数依赖于移动平均值的算法都存在偏差，因此我们需要额外的步骤来纠正偏差。这被称为偏差校正步骤:</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/438883292ae9afe95796de8f72d6d6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:390/format:webp/0*F9hIO3J8_i2F0p3y.png"/></div><p class="mc md gj gh gi me mf bd b be z dk translated">移动平均线的偏差修正</p></figure><p id="138e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们可以根据计算出的移动平均值，以步长<em class="lt"> η </em>更新参数(权重和偏差):</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/1be39c8ce284b38d7a1aae9d276764f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/0*hFk5_b7oUqCCHZFa.png"/></div></figure><h1 id="6605" class="kq kr iq bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">步骤2:用Python实现Adam</h1><p id="eeec" class="pw-post-body-paragraph jn jo iq jp b jq lo js jt ju lp jw jx jy lq ka kb kc lr ke kf kg ls ki kj kk ij bi translated">总结一下，我们需要定义几个变量:一阶指数衰减<em class="lt"> β </em> ₁，二阶指数衰减<em class="lt"> β </em> ₂，步长<em class="lt"> η </em>和一个小值<em class="lt"> ε </em>防止零除。此外，我们将<code class="fe km kn ko kp b">m_dw</code>、<code class="fe km kn ko kp b">v_dw</code>、<code class="fe km kn ko kp b">m_db</code>和<code class="fe km kn ko kp b">v_db</code>定义为权重和偏差<code class="fe km kn ko kp b">dw</code>和<code class="fe km kn ko kp b">db</code>的梯度的前一时间步的均值和无中心方差。</p><figure class="lv lw lx ly gt lz"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="5040" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回想一下，Adam依赖于两个重要的矩:均值的一阶矩估计和方差的二阶矩估计。使用这些矩估计，我们可以在给定适当步长的情况下更新权重和偏差。</p><h1 id="24ad" class="kq kr iq bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">步骤3:测试实现</h1><p id="f0cf" class="pw-post-body-paragraph jn jo iq jp b jq lo js jt ju lp jw jx jy lq ka kb kc lr ke kf kg ls ki kj kk ij bi translated">为了测试我们的实现，我们首先需要定义一个损失函数及其各自的梯度函数。梯度函数可以通过简单地对损失函数求导来获得。例如:</p><figure class="lv lw lx ly gt lz"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="fc65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们还定义了一个额外的函数来检查收敛性，这是基于当达到收敛时权重不会改变的事实。最后，我们可以使用构建的Adam优化器迭代更新权重和偏差，并查看它们是否收敛:</p><figure class="lv lw lx ly gt lz"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="8574" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看结果，在750次迭代下达到收敛。大获成功！</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/5526901fdb115280f975052093069506.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*eycKK4jwNh10xdDjUSL-Dw.png"/></div></figure><p id="bcd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请随意查看我的其他故事和github项目。祝你今天开心！玩的开心！</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/16588f04e388eeaa60705f08bd1910b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-dv5F84rMxftNqte"/></div></div><p class="mc md gj gh gi me mf bd b be z dk translated">由<a class="ae kl" href="https://unsplash.com/@urielsc26?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">乌列尔SC </a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div></div>    
</body>
</html>