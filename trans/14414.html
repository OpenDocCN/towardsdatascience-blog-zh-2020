<html>
<head>
<title>Pandas-mapper API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫-mapper API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-mapper-api-2f93400d1dca?source=collection_archive---------39-----------------------#2020-10-04">https://towardsdatascience.com/pandas-mapper-api-2f93400d1dca?source=collection_archive---------39-----------------------#2020-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aea8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及它与应用功能有何不同</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35d8b49722a54a99619c8d3607c7b348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*es72simqdDZJY_wk.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@parktroopers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">公园巡警</a>在<a class="ae ky" href="https://unsplash.com/s/photos/community?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="47f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个非常强大和通用的Python数据分析库，它加速了数据科学项目的预处理步骤。它提供了许多在数据分析中非常有用的函数和方法。</p><p id="568c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然Pandas的内置功能能够执行高效的数据分析，但定制的库或API为Pandas增加了价值。在本帖中，我们将探索其中的一个，那就是<a class="ae ky" href="https://pypi.org/project/pandas-mapper/" rel="noopener ugc nofollow" target="_blank">熊猫测绘员</a>。</p><p id="3c9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从安装和导入开始。我们还需要进口熊猫，因为我们将在数据帧上工作。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="38be" class="ma mb it lw b gy mc md l me mf">pip install pandas-mapper</span><span id="033d" class="ma mb it lw b gy mg md l me mf">import pandas_mapper<br/>import pandas as pd</span></pre><p id="4511" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas-mapper根据转换映射数据帧中的值。不如先做个例题，再解释语法。</p><p id="25d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑以下数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/c82d9c172f7df93070f6a4041f9bd11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*79AyPoeB7fkviZ2MG81Dzg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="0a70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望创建一个列来指示“col_c”中的字符串包含大写字母和小写字母。除了“pandas”和“STATS”之外的所有行都符合我们的描述。下面是我们如何用熊猫制图仪来完成这项任务。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="963d" class="ma mb it lw b gy mc md l me mf">df.mapping([('col_c', 'not_mix', <br/>lambda row: row.isupper() | row.islower())])</span></pre><p id="2fc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦安装了pandas-mapper，我们就有了一个关于数据帧的新方法，即<strong class="lb iu">映射</strong>。</p><p id="7d1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个参数是元组列表，它依次包含源列、目标列和转换。</p><p id="5c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用<strong class="lb iu">映射</strong>时，定义的映射完成。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a175" class="ma mb it lw b gy mc md l me mf">df.mapping([('col_c', 'not_mix', <br/>lambda row: row.isupper() | row.islower())]).<strong class="lw iu">mapped</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/5366c55ec4cd69fad179aedf09e395dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*PD5cyvd744xr-_hSMjUwRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="70f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用映射返回的内容创建一个新列，或者使用inplace参数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9b3b" class="ma mb it lw b gy mc md l me mf">df.mapping([('col_c', 'not_mix', <br/>lambda row: row.isupper() | row.islower())], <strong class="lw iu">inplace=True</strong>).mapped</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/01c2706e141a118e63162979a46b2620.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*Vja0RlNd-9gTkujKcZgIvw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="243f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas-mapper也接受用户定义的函数作为转换。下面的代码块将获得相同的结果。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dc67" class="ma mb it lw b gy mc md l me mf">def not_mix(row):<br/>   if row.isupper() | row.islower():<br/>      return False<br/>   else:<br/>      return True</span><span id="8684" class="ma mb it lw b gy mg md l me mf">df.mapping([('col_c', 'mix_case', not_mix)], inplace=True).mapped</span></pre></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="f0cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">pandas-mapper和apply函数的主要区别在于错误处理。</p><p id="865f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑一种情况，其中一个字符串列包含数字，我们需要基于字符串进行转换。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/41eb5a71ba61daac27501d97363060e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*05Az3EUEMFkDR5Hxh9BUQw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6a63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们尝试进行与上一步相同的转换。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="70d2" class="ma mb it lw b gy mc md l me mf">mapper = df.mapping([('col_c', 'mix_case', not_mix)])</span><span id="43ab" class="ma mb it lw b gy mg md l me mf">df_transformed = mapper.mapped</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/077b5e59e9c691e8cb7e99c64700140e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*KAqum_Fh0gzgQEPyZxlqiw.png"/></div></figure><p id="3d44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们出错了。<strong class="lb iu"> on_error </strong>参数可用于处理此类错误。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7497" class="ma mb it lw b gy mc md l me mf">mapper = df.mapping([('col_c', 'mix_case', not_mix)], <strong class="lw iu">on_error</strong>='redirect')</span><span id="ddd0" class="ma mb it lw b gy mg md l me mf">df_transformed = mapper.mapped</span><span id="da94" class="ma mb it lw b gy mg md l me mf">df_transformed</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/4e2e5531bdf7fa5810fc556600bcd1ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*OFQo4IkkD-CR9x8LuTkh6g.png"/></div></figure><p id="2a61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任务在适当的行上完成。索引为4且不包含字符串的行保存在单独的数据帧中。我们可以使用<strong class="lb iu">错误</strong>方法来访问它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/35e89fa5eb6fc524fc99d6644cde2688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*NZj607YsHUCwwyxsG9P7tQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f8cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">到目前为止，我们一直致力于一对一的映射。Pandas-mapper还支持一对多和多对多映射。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="13c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">pandas的功能丰富了第三方软件包，通过展示不同的方法和视角来改进数据分析过程。</p><p id="47cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用熊猫完成一项任务几乎总是有多种方式。例如，我们在这篇文章中做的一些事情也可以使用列表理解或pandas自己的字符串操作来完成。但是，最好知道其他替代方案，以防需要。</p><p id="aebb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>