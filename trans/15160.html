<html>
<head>
<title>Analysis of US Elections from 1976 to 2010 with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫分析1976-2010年美国大选</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analysis-of-us-elections-from-1976-to-2010-with-pandas-6654cf69849d?source=collection_archive---------39-----------------------#2020-10-18">https://towardsdatascience.com/analysis-of-us-elections-from-1976-to-2010-with-pandas-6654cf69849d?source=collection_archive---------39-----------------------#2020-10-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2fd6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实践熊猫，同时提供对过去选举的宝贵见解。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3adfb56d6ceb6737be95c9c04a1a0563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9meZjVfvGg2qDJq3ZD4bzA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/s/photos/election?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@element5digital?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Element5数码</a>拍摄</p></figure><p id="72af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近在Kaggle上偶然发现了<a class="ae ky" href="https://www.kaggle.com/tunguz/us-elections-dataset" rel="noopener ugc nofollow" target="_blank">美国选举数据集</a>。由于我们正处于对2020年选举的激烈讨论中，我认为对历届美国总统选举进行分析是一个好主意。</p><p id="2e9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集包含从1976年到2020年的选举。我将从各种不同的角度处理这些数据，并试图对人们的投票方式有所了解。</p><p id="391c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用Pandas库进行数据分析和可视化，因此使用Pandas的功能和方法也是一个很好的实践。</p><p id="b64a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从导入库和将数据集读入Pandas数据帧开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="35b9" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="92eb" class="ma mb it lw b gy mg md l me mf">president = pd.read_csv("/content/president-1976-2016.csv")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/949412996ab65b26db9233fc3fd624ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zE-isX0lyFAyOy0v-Fvesw.png"/></div></div></figure><p id="e95f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一些用于分析的冗余列。我不确定state_fips、state_cen和state_ic代表什么，但它们可能是一个状态的指示器或唯一值。</p><p id="cd9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过检查和比较这些列中的值来确认。这三列有51个唯一值(每个州一个)。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7a96" class="ma mb it lw b gy mc md l me mf">president.state_fips.nunique()<br/>51</span></pre><p id="13cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于特定的状态，这些列中的值是相同的:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="150f" class="ma mb it lw b gy mc md l me mf">president[president.state == 'Alabama'][['state_fips','state_cen','state_ic']].value_counts()</span><span id="33bb" class="ma mb it lw b gy mg md l me mf">state_fips  state_cen  state_ic <br/>1           63         41          63 <br/>dtype: int64</span></pre><p id="15be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于数据集已经包含状态信息，这些列在分析中是多余的，因此可以删除。</p><p id="4be1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">office列只表明这是总统选举，因此它包含一个唯一的值(美国总统)。版本和注释列也没有用。</p><p id="b459" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用Pandas的drop功能来删除这些列。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8582" class="ma mb it lw b gy mc md l me mf">president.drop(['state_po', 'state_fips', 'state_cen', 'state_ic',<br/>'office', 'version', 'notes'], axis=1, inplace=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/ba012fcea938c29a2709ef031ac01c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJs3_uc6xhR2tN8LjGzn-w.png"/></div></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="d9c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们准备开始分析，我将分析分为三个部分:</p><ol class=""><li id="4aab" class="mq mr it lb b lc ld lf lg li ms lm mt lq mu lu mv mw mx my bi translated">一段时间内的投票总数</li><li id="6e24" class="mq mr it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">每位获胜者的得票率</li><li id="9845" class="mq mr it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">各缔约方的国别比较</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="0159" class="ne mb it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated"><strong class="ak">一段时间内的投票总数</strong></h1><p id="0aa4" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">我们首先要检查的是每次选举的票数。“totalvotes”列显示特定州的投票总数。因此，下面的代码将创建一个dataframe，其中包含每个州每次选举的总票数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5385" class="ma mb it lw b gy mc md l me mf">yearly_votes = president[['year','state','totalvotes']]\<br/>.groupby(['year','state']).mean().reset_index()</span><span id="c01e" class="ma mb it lw b gy mg md l me mf">yearly_votes.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/295f9359f93bda34a40a4e17a4609459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*wEtGTAZX3TAJ3BfOHz5D7g.png"/></div></figure><p id="6bd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对“year”列应用groupby函数，并对“totalvotes”列中的值求和，这将给出每次选举的总票数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="90a9" class="ma mb it lw b gy mc md l me mf">yearly_votes.groupby('year').sum()\<br/>.plot(figsize=(10,6), legend=False,</span><span id="65db" class="ma mb it lw b gy mg md l me mf">title='Total Number of Votes in US Presendial Elections')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4c0bb0858764c793e08457909faf5aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*BPSofBswE02-vmm96BRGMg.png"/></div></figure><p id="fcb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用了熊猫的绘图工具来绘制结果。它比使用Matplotlib的pyplot接口简单，但是对绘图的控制较少。</p><p id="825a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了1996年和2012年，参加投票的人数一直在稳步增加。这很可能是由于人口增长，因此更好的衡量标准是每百万人口的投票数(有资格投票)。粗略比较一下，从1970年(2.03亿)到2010年(3.08亿)，人口增长了约50%。因此，多年来，投票人数的比例大致保持不变。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="bca7" class="ne mb it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated"><strong class="ak">每位获胜者的得票率</strong></h1><p id="752f" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">有些选举非常接近，获胜者以微弱优势获胜。也有一些选举中获胜者以较大优势获胜。</p><p id="e1ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以计算出每个获胜者的得票率。我们将首先向我们的数据框架添加一个“winner”列。</p><p id="79bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_presidents_of_the_United_States" rel="noopener ugc nofollow" target="_blank">这个</a>维基百科页面包含了美国总统的名单。使用read_html函数可以很容易地将这些表读入pandas数据框架。它将网页中的表格转换成数据帧列表。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4b96" class="ma mb it lw b gy mc md l me mf">dfs = pd.read_html("https://en.wikipedia.org/wiki/List_of_presidents_of_the_United_States")</span><span id="b870" class="ma mb it lw b gy mg md l me mf">winners = dfs[1][['Election','President.1']]<br/>winners.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/52f56b15774899e391713ec0240d484c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*0wjVJbfPyA9Cw3mxWgy5Ow.png"/></div></figure><p id="b540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二个数据帧包含美国总统的名单。我们只需要1976年到2016年的选举数据。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4d84" class="ma mb it lw b gy mc md l me mf">winners = winners.iloc[-12:-1, :]<br/>winners.Election = winners.Election.astype('int64')<br/>winners.rename(columns={'President.1':'winner'}, inplace=True)</span><span id="3580" class="ma mb it lw b gy mg md l me mf">winners</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/697d7bba59f2cf8a5709c46f1b04c4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*8MAntnZkfwiE_WTcbVpPgw.png"/></div></figure><p id="efd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要和总统数据框中相同格式的名字。“吉米·卡特”需要格式化为“卡特，吉米”。我将使用pandas字符串操作来完成这项任务:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="68fd" class="ma mb it lw b gy mc md l me mf">first_name = winners.winner.str.rsplit(' ', n=1, expand=True)[0]<br/>last_name = winners.winner.str.rsplit(' ', n=1, expand=True)[1]<br/>winners.winner = last_name + ', ' + first_name</span><span id="e431" class="ma mb it lw b gy mg md l me mf">winners</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/a84aeb8aa816401d682b6c5f921f1503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*x44s70waIx74iC1A54gLAg.png"/></div></figure><p id="be09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要一些小的调整，以便总统的名字完全匹配。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0d26" class="ma mb it lw b gy mc md l me mf">winners.winner[73] = 'Bush, George H.W.'<br/>winners.winner[78] = 'Obama, Barack H.'<br/>winners.winner[79] = 'Obama, Barack H.'<br/>winners.winner[80] = 'Trump, Donald J.'</span></pre><p id="a7e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还将选举日期转换为整数，以便能够在下一步中使用merge函数。</p><p id="de02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以根据选举年份合并“总统”和“获胜者”数据帧。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="44cc" class="ma mb it lw b gy mc md l me mf">president = pd.merge(president, winners, left_on='year', right_on='Election')</span></pre><p id="51cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将过滤总统数据帧，只包括获胜者的投票。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="89c6" class="ma mb it lw b gy mc md l me mf">winner_votes = president[president.candidate == president.winner]</span><span id="9b2f" class="ma mb it lw b gy mg md l me mf">winner_votes.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/facef2c529a0dbe8551e8fc98a4a1e41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zb7Rn5988w2N3Zn6fd2BAA.png"/></div></div></figure><p id="07f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每一行都包含获胜者的票数和特定选举中特定州的总票数。一个简单的groupby函数将给出各个国家的值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="230b" class="ma mb it lw b gy mc md l me mf">total_votes = winner_votes[['year','winner','candidatevotes','totalvotes']]\<br/>.groupby(['year','winner']).sum()</span><span id="424b" class="ma mb it lw b gy mg md l me mf">total_votes</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/222715ed50f3a9d15b90f03d10b37f45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*ZrgtwpcXaqgqBonkdyu4-Q.png"/></div></figure><p id="2c71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过简单的数学运算计算出中奖者的比例，并对结果进行排序。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5c77" class="ma mb it lw b gy mc md l me mf">(total_votes.candidatevotes / total_votes.totalvotes)\<br/>.sort_values(ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/760e6e8d670947281dd91e9d00154ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*aqroSE-mcVrYnZxAMWYjAg.png"/></div></figure><p id="79a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">排名第一的是第二任期的罗纳德·里根。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="462e" class="ne mb it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated"><strong class="ak">各缔约方的国家比较</strong></h1><p id="5e46" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">如果你对政治感兴趣，你就会知道每个州更可能支持哪个政党。让我们也用数字来核对一下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/1ae8bc7f5a58a923fa003bd6873753e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PEjHn-0OGXqIPTvOJ8SKA.png"/></div></div></figure><p id="8576" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是获胜者投票数据框。我们将添加一个比率列，即候选人票数除以总票数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c436" class="ma mb it lw b gy mc md l me mf">winner_votes['ratio'] = winner_votes.candidatevotes / winner_votes.totalvotes</span></pre><p id="7d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们希望看到民主党和共和党的前十个州。下面的groupby操作将根据民主党的最高平均比率返回前十个州。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="99b5" class="ma mb it lw b gy mc md l me mf">winner_votes[winner_votes.party == 'democrat'][['state','ratio']]\<br/>.groupby('state').mean().sort_values(by='ratio', ascending=False)[:10]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/714e345ea0b104ec0074aa4d6d84b3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*kTOByMRr5hincb74SS4pug.png"/></div></figure><p id="863b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是共和党方面同样操作的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/89673b1eabcb2e2e4986368bace5c00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*wXUDImzlysPKKL4lyyoLHA.png"/></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><blockquote class="ok ol om"><p id="f051" class="kz la on lb b lc ld ju le lf lg jx lh oo lj lk ll op ln lo lp oq lr ls lt lu im bi translated">注:除非另有说明，所有图片均由作者创作。</p></blockquote></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="112c" class="ne mb it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated"><strong class="ak">结论</strong></h1><p id="d26c" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">我们分析了美国总统选举随时间推移的票数，每位总统在选票方面的优势，以及民主党和共和党在各州的选票。结果可能不会让你吃惊，尤其是如果你对政治感兴趣的话。</p><p id="8c21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章的另一个重点是练习如何在数据分析和操作中使用Pandas。我们在数据分析和处理方面做了大量的熊猫运算。</p><p id="401d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>