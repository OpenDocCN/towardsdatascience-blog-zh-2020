<html>
<head>
<title>Churn prediction with Spark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Spark进行客户流失预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/churn-prediction-with-spark-e16d96bbf147?source=collection_archive---------45-----------------------#2020-11-07">https://towardsdatascience.com/churn-prediction-with-spark-e16d96bbf147?source=collection_archive---------45-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="629f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">客户流失预测对于留住客户至关重要，也是成功的关键因素之一，因为它有助于企业在关键时刻主动向客户提供正确的优惠和折扣。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/51b4722df64e2c13a24a701f3b777ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bQAfCYXK0nEI_Fgd"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">兰迪·法特在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2a77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了Udacity的数据科学家Nanodegree的顶点项目，我试图为虚构的音乐流媒体服务Sparkify建立一个机器学习管道来进行流失预测。我为这个项目写的代码可以在这个<a class="ae kv" href="https://github.com/minhtuan2000/sparkify" rel="noopener ugc nofollow" target="_blank">资源库</a>中找到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/1bc63b45ae0402ec4661fe0b56444677.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*4ktLcTyuEJ0BjbNK.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由Udacity提供的Sparkify虚构徽标</p></figure><p id="d1e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Sparkify已经收集了一个关于其平台上成千上万独立用户活动的大型数据库。作为一项不断发展的服务，Sparkify将在未来继续产生更多的数据(当然，前提是它已经存在)。在这种情况下，Spark被证明是一个合适的工具，因为它提供了急需的可伸缩性。</p><h1 id="fc07" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">问题陈述</h1><p id="a8b3" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">Sparkify提供的大型数据集(~12GB)，包含用户活动的详细信息。具体来说，每一行代表一个用户活动，包括关于用户的基本信息(用户ID、名字、姓氏、性别、他们的订阅级别、他们是否登录过……)和关于活动性质的进一步信息(例如，活动的时间戳、他们访问的页面的名称，或者他们请求的艺术家、歌曲和歌曲长度的名称)。每个唯一用户可以在数据集中记录多个活动。</p><p id="7547" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">给定数据集，主要任务是清理数据(如果必要的话)，执行数据探索和分析，特征提取，最后，实现机器学习模型来对搅动的用户进行分类。理想情况下，当给定用户活动列表时，解决方案模型应该能够预测他们是否是搅动者(当然，不需要查看数据集中的取消事件)。</p><p id="47c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些模型是根据它们的F1分数而不是准确性进行评估的，因为在这种情况下，与平台上的用户总数相比，被搅动的用户数量很少，并且数据是不平衡的。</p><h1 id="85e5" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated"><strong class="ak">设置</strong></h1><p id="ffa8" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">对于这个项目，我在IBM Watson Studio上使用了<em class="mq"> Python 3.7 </em>和<em class="mq"> Spark 3.0.1 </em>，它提供了2个执行器:1个vCPU和4 GB RAM，以及一个驱动程序:1个vCPU和4 GB RAM，采用Lite计划。由于硬件容量的原因，我只处理了原始数据集(大约12GB)的一个子集(大约200MB)。</p><h1 id="0ac8" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">数据探索</h1><p id="b5d8" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">子数据集包含<strong class="ky ir"> 543705 </strong>个观察值，每个观察值代表属于<strong class="ky ir"> 448 </strong>个唯一用户之一的活动，以及<strong class="ky ir"> 18 </strong>个特征。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/2b74dce7c873670d8148f9b75919cb76.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*BEQYs5rkvyIri3K4BMoJYw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据模式—按作者分类的图像</p></figure><p id="0f41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">页面</strong>列特别有趣，因为它包含记录的用户活动类型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/164c90a876533f747fcdb8b2e3f6e99d.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*rggiRy_Xcmf0rYajBnY4Hg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">第<strong class="bd mt">页</strong>的独特价值—作者图片</p></figure><p id="4a38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，该列中没有丢失数据，NextSong 是最受欢迎的活动，这是可以理解的，因为Sparkify是一种音乐流媒体服务。</p><p id="1402" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而<strong class="ky ir">升级</strong>和<strong class="ky ir">降级</strong>的数量相对于<strong class="ky ir">提交升级</strong>、<strong class="ky ir">提交降级</strong>、<strong class="ky ir">取消</strong>、<strong class="ky ir">取消确认</strong>的数量，甚至是唯一用户的数量，都是巨大的。因此，我们可能会猜测<strong class="ky ir">升级</strong>和<strong class="ky ir">降级</strong>是用户可以选择升级或降级其订阅的页面，而不是这样做的实际事件。</p><h2 id="85d8" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">清理数据集</h2><p id="0c31" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">下一步是清理数据集。查看每列中缺失数据的数量，有两组:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b1eea69b6853916c1d008ae0c66cb517.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*QgRFFsrgdtuaqXeH8bUN-w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每列中缺失值的数量-按作者排序的图像</p></figure><ol class=""><li id="12b2" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">当且仅当<strong class="ky ir">页面</strong>类型为<strong class="ky ir">下一首歌曲时，<strong class="ky ir">艺术家</strong>、<strong class="ky ir">长度</strong>和<strong class="ky ir">歌曲</strong>不为空(包含一些值)。</strong></li><li id="172a" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir">名字</strong>、<strong class="ky ir">姓氏</strong>、<strong class="ky ir">性别</strong>、<strong class="ky ir">地点</strong>、<strong class="ky ir">注册</strong>和<strong class="ky ir">用户代理</strong>在用户未登录或未注册时缺失。事实上，<strong class="ky ir"> userId </strong>在这种情况下也会丢失，但是丢失的值被伪装成空字符串。然而，这些用户无法访问Sparkify的主要功能，因此，我们可以安全地删除所有这些观察。</li></ol><h2 id="2b09" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">定义流失</h2><p id="4d77" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">接下来，我使用<strong class="ky ir">取消</strong>和<strong class="ky ir">取消确认</strong>来定义客户流失。特别地，任何具有这些事件中的至少一个的用户被认为是被搅动的用户。我还检查了这些事件实际上是同时发生的，并且有<strong class="ky ir"> 99 </strong>个用户，大约是数据集中用户总数的<strong class="ky ir"> 22% </strong>。</p><h2 id="c3d7" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">可视化数据</h2><p id="1854" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在清理数据集和定义客户流失后，我用一些图表来回答我认为对客户流失预测和用户行为至关重要的4个问题。</p><p id="034c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">用户参与度和用户留存之间有什么关系？</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/083dd8ad85fde223bcbb6602f7140fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*THnqn1OovkYDfq9_CVhMyA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">每位用户的事件/互动总数-按作者分类的图片</p></figure><p id="3c67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，流失用户对服务的参与度略有下降。</p><p id="a5e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在此分析中，时间戳有用吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/fdedfa20867bb43178b8879d978a930f.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*zN0dxJB_YFsak_ozCqaF1Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d190da8c6556eae9674c6aaac01a2135.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*vUW3NBpoR2wZk1plGSxemg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="8854" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">绝对是的，用户群之间的上次交互和用户生存期明显不同。我们还可以注意到，长期用户对服务更忠诚。</p><p id="2761" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">免费用户会取消他们的服务吗？</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/bcfcbbfe62b30df86e7cf61a7c516bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*foGvSSZbN6bqlfZ0g1PzuA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="a824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，也是的。事实上，免费用户和付费用户的取消率大致相同。</p><p id="7cfd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">关于流失，用户活动能告诉我们什么？</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/9f494c46eb1a43895d68cd0277f1af7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DJinG-nXyqZ8V8TO02pw1w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="2d4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一般来说，被取消的用户竖起大拇指的<strong class="ky ir">少，下一首</strong>的<strong class="ky ir">少，加入播放列表</strong>的<strong class="ky ir">少，竖起大拇指<strong class="ky ir">的</strong>多，滚动广告</strong>多，降级<strong class="ky ir">的</strong>多。我们可以看到，总的来说，这些用户并没有像以前那样喜欢这项服务。</p><p id="396d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq">注意:记住</em> <strong class="ky ir"> <em class="mq">降级</em> </strong> <em class="mq">不是实际的账户降级事件，而可能是用户可以选择降级其账户的页面。</em></p><h1 id="d111" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">建模</h1><h2 id="eee9" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated"><strong class="ak">功能选择</strong></h2><p id="23ba" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我按照<strong class="ky ir">用户Id </strong>对数据集进行分组，并选择了我认为最相关的<strong class="ky ir"> 13 </strong>个特性:</p><ul class=""><li id="080e" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr oa nn no np bi translated"><em class="mq">交互总数</em></li><li id="b851" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">注册时间戳</em></li><li id="1663" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">上次交互时间戳</em></li><li id="318e" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">用户寿命</em></li><li id="d4bd" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">一生中的平均相互作用</em></li><li id="6a9f" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">等级(1表示付费，0表示免费)</em></li><li id="1b70" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">竖起大拇指的百分比</em></li><li id="1c98" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">拇指向下的百分比</em></li><li id="a9cd" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">回家的百分比</em></li><li id="4a3e" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">next song的百分比</em></li><li id="629b" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">添加到播放列表的百分比</em></li><li id="d6ef" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">滚动广告的百分比</em></li><li id="43f3" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq">降级百分比</em></li></ul><p id="9937" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，产生的数据集被分成训练和测试数据集(分别为90%和10%)。</p><h2 id="a908" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">建造管道</h2><p id="6aeb" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在获得训练和测试数据集后，我为两种不同的分类方法建立了三个机器学习管道:逻辑回归和随机森林。每个管道执行三个主要任务:</p><ul class=""><li id="6354" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr oa nn no np bi translated">根据PySpark输入模式的要求，将所选要素组装成矢量。</li><li id="6cb5" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated">对矢量进行标准化(缩放平均值为0，标准偏差为1)，将所有要素放在相似的尺度上。还有其他的缩放方法；然而，标准化对异常值是最稳健的。</li><li id="b3de" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated">执行网格搜索并使用F1分数选择最佳超参数。</li></ul><p id="cd18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">网格搜索中使用的超参数如下:</p><p id="3b48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<em class="mq">物流回收</em>:</p><ul class=""><li id="330a" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr oa nn no np bi translated"><em class="mq"> regParam: </em> [0.01，0.1]</li></ul><p id="75ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于<em class="mq"> RandomForestClassifier </em>:</p><ul class=""><li id="3507" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr oa nn no np bi translated"><em class="mq"> maxDepth(一棵树的最大深度)</em> : [12，30]</li><li id="75f0" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated"><em class="mq"> numTrees(树的总数)</em>:【20，100】</li></ul><h2 id="ce8a" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">结果</h2><p id="0942" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">最佳逻辑回归模型能够在训练数据集上达到F1得分<strong class="ky ir"> 0.868 </strong>，并且在测试数据集(F1得分0.912，准确度0.917)中正确预测36个用户中的33个，其中<em class="mq"> regParam=0.01 </em>。</p><p id="26ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了一个<em class="mq"> maxDepth </em> 12和<em class="mq"> numTrees </em> 100的随机森林，我能够在train数据集上取得更好的结果(F1得分= <strong class="ky ir"> 0.887 </strong>)。该模型在测试数据集上产生了相同的预测(36个中有33个正确，F1值为0.912，准确度为0.917)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ef8b1b5bd8959de738cfa2707e0251ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*pUbABjkT1bo7IJOuSA4Ggg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">两种方法在测试数据集上的预测结果—作者提供的图片</p></figure><p id="54b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，测试数据集上的这种性能并不意味着随机森林模型不好。仅包含36个用户的测试数据集根本不够大，无法用于有效地比较不同的模型。</p><p id="59cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我认为，在这种情况下，随机森林比逻辑回归更好，因为它可以对一系列数据进行分组(例如，流失用户的寿命通常在10亿到30亿'<em class="mq">时间单位'</em>)而逻辑回归只能根据与某个值(大于或小于该值)的比较对数据进行分类。为了用逻辑回归区分一系列数据，我们需要添加隐藏层，因此，使用深度学习。因此，我认为随机森林模型是一个更好的选择。</p><p id="5390" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，随机森林的一个优点是，我们可以通过查看特性的重要性来了解每个特性对结果的影响:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/122a3cdf34ee172db129e4227421859a.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*at1GeY2cVPoojYAWj6I_6A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="9b9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如在上面的数据可视化部分中所猜测的，用户订阅<strong class="ky ir">级别</strong>贡献不大，而<strong class="ky ir">最后一次交互</strong>和<strong class="ky ir">用户生命周期</strong>对模型的性能至关重要。因此，为了提高客户保持率，最简单和最有效的方法之一是针对最近不活跃的用户(<strong class="ky ir">上次互动</strong>的较低值)提供特殊优惠和折扣。这些折扣也可以在用户点击<strong class="ky ir">取消</strong>页面时提供。</p><h2 id="c260" class="mu lu iq bd lv mv mw dn lz mx my dp md lf mz na mf lj nb nc mh ln nd ne mj nf bi translated">可能的进一步改进</h2><ul class=""><li id="4f58" class="nh ni iq ky b kz ml lc mm lf od lj oe ln of lr oa nn no np bi translated">使用<strong class="ky ir"> last interaction </strong>可能不是最好的主意，因为我们可能想知道谁不喜欢Sparkify，甚至在他们想取消之前。相反，我们可以把目标人群锁定在约会少、<strong class="ky ir">否决</strong>、滚动广告<strong class="ky ir">、</strong>多、访问<strong class="ky ir">降级</strong>页面更频繁的人群。</li><li id="fd6d" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr oa nn no np bi translated">在这个项目中，我没有使用用户听过的<strong class="ky ir">艺人</strong>和<strong class="ky ir">歌曲</strong>，或者用户的<strong class="ky ir">地点</strong>和<strong class="ky ir">性别</strong>。这些特性可能对更好的模型有用。</li></ul><h1 id="75a5" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="d912" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">总之，我通过可视化和分析探索了数据集。我还清理、转换了数据，提取了Sparkify上关于用户的相关特征。根据这些特征，我使用逻辑回归和随机森林建立了不同的机器学习管道，并比较了结果。最佳随机森林模型在训练数据集上达到了0.887的F1分数，并且在测试数据集中对36个用户中的33个进行了正确分类。</p><p id="d77a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过这个项目，我学会了Spark，并能够将我的知识应用到实际问题中。我还以一个漂亮的顶点项目结束了我与Udacity上的数据科学家Nanodegree的旅程。</p></div></div>    
</body>
</html>