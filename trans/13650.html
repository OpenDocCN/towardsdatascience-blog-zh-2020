<html>
<head>
<title>DS Project: How to Predict Google Apps Rating?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DS项目:如何预测Google Apps评分？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ds-project-how-to-predict-google-apps-rating-618ebc77cad?source=collection_archive---------18-----------------------#2020-09-19">https://towardsdatascience.com/ds-project-how-to-predict-google-apps-rating-618ebc77cad?source=collection_archive---------18-----------------------#2020-09-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5cf6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过练习本练习，丰富您的数据科学知识。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bfc2663fd21b340413fc8c66a72cd304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5l1le5xCTeXv-v0t4A1SQ.png"/></div></div></figure><p id="3f36" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我与你分享我在分析和预测Google Apps评分方面的经验。这是我在数据科学面试中必须解决的测试之一。我必须指出，这是一种个人解决问题的方式，它可以帮助你得出自己的推理。</p><p id="db72" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与任何其他DS项目一样，我们从从<a class="ae lq" href="https://bit.ly/3mAnlYG" rel="noopener ugc nofollow" target="_blank">这里</a>下载数据文件开始。</p><p id="5c77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">你可以从</strong> <a class="ae lq" href="https://github.com/anasselhoud" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">这里</strong> </a> <strong class="kw iu">在我的Github上可视化这个项目的Jupyter笔记本，查看我在这个项目中使用的代码。</strong></p><p id="0bb0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">事不宜迟，我们走吧！</p><h1 id="1ee8" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">开始使用数据</h1><p id="7e98" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">第一步是数据预处理。我们根据数据的格式和类型清理、播放和转换所有元素和列。正如我们所看到的，我们的数据具有以下格式:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="2a29" class="mt ls it mp b gy mu mv l mw mx">apps = pd.read_csv('GooglePlayApp-ELHOUD.csv')<br/>apps.info()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/a97135abe00de8aea7b737588b63da11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HlANu2Ct5IHOIZy6zhhI2Q.png"/></div></div></figure><p id="19d2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据帧包含13个不同的列和8281行。列“<strong class="kw iu"> Rating </strong>”代表我们模型的Y向量:我们试图预测的内容。我们将“<strong class="kw iu">评级</strong>的不同值形象化:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="ec0d" class="mt ls it mp b gy mu mv l mw mx">apps['Rating'].value_counts()</span></pre><p id="038f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在可视化“<strong class="kw iu">评级</strong>的值时，我们注意到在我们的数据(19.0)中有一个<strong class="kw iu">不合理的评级</strong>。一般来说，应用程序的评级在0到5星之间。我们删除了这个值，以避免我们的模型出现偏差。如果我们认为这是一个打字错误，我们可以用1.9替换它，但由于我们无法确定，并且我们与数据所有者没有直接联系，所以最好将其删除。</p><p id="b158" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">之后，我们会检查所有重复的应用程序并删除它们:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="f661" class="mt ls it mp b gy mu mv l mw mx">print('Number of apps at the beginning:', len(apps))<br/>apps.drop_duplicates(subset='App', inplace=<strong class="mp iu">True</strong>) <br/>print('Number of apps after removing duplicates:', len(apps))</span></pre><p id="317e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我认为建议删除这三列(<strong class="kw iu">当前版本</strong>、<strong class="kw iu"> Android版本、</strong>和<strong class="kw iu">上次更新</strong>)，因为这三列对于我们的分析来说是不必要的，并且对评级没有直接影响(之后可视化相关性)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/24fd5611cb079aed4bab8e14cddf61d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0vJlCg_D7KhhdSrG"/></div></div></figure><p id="1689" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了使数据形象化，我们必须把它转换成数字。转换是通过替换所有的字符串并以不同的方式将它们转换成数字格式来完成的。在下图中，我们概括了所有的清洁、缩放和转换步骤。</p><p id="72ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我在下图中概括了所有的步骤:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/cd64ea4760eaef238d603987d6b08718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R5LpFhW7R5OkVnkS"/></div></div></figure><p id="40e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我使用的转换代码的所有部分都设置在我的Github库上。</p><h1 id="a327" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">数据可视化</h1><p id="c522" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">一旦我们完成了所有的转换，我们在开始时使用Seaborn可视化“<strong class="kw iu">应用评级</strong>的分布和“<strong class="kw iu">应用大小</strong>的分布。因此，让我们来看看它，检查是否正常，并尝试纠正它，否则:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="ba30" class="mt ls it mp b gy mu mv l mw mx">sns.distplot(apps['Rating'],fit=norm)<br/>print('- Total number of ratings:', len(apps['Rating']))<br/>print('- Mean of distribution of rating :', np.mean(apps['Rating']))<br/>print('- Standard deviation:', np.std(apps['Rating']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/5e3aaa628865df24cbaf0b665e12950f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsXAYPQbECJP1mrRDw1QJA.png"/></div></div></figure><p id="52b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们注意到数据集<strong class="kw iu">评级</strong>的“拟合度”从技术上讲并不符合均值为4.16、标准差为0.559的正态分布。这些信息将有助于以后定义和开发模型。让我们检查一下概率图:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="40ac" class="mt ls it mp b gy mu mv l mw mx"><strong class="mp iu">from</strong> <strong class="mp iu">scipy</strong> <strong class="mp iu">import</strong> stats fig = plt.figure() <br/>prob = stats.probplot(apps[‘Rating’], plot=plt)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/bc9bcef7a5ba396f7ac8576a211ff4fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1nKJ73sdGRX_xGcOQaPYg.png"/></div></div></figure><p id="be96" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以，肯定不正常:我们有偏斜。</p><p id="61a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我想做一些变换，以适应高斯分布。让我们对数据进行Box-Cox变换，看看会发生什么…<strong class="kw iu">Box-Cox变换</strong>表示如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/20cea19c61e2065eb0d8dc5f805344d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7j_WiaDJmcArMnXdduMSg.png"/></div></div></figure><p id="4106" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">之后，我们重新设想转型后“<strong class="kw iu">应用评分</strong>的分布情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/f0a94242467defc2e80f05a2f5e4b6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lIvBPAmaypRBuq6DdLorLA.png"/></div></div></figure><p id="ab77" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">更像高斯(正态)分布！我们将在这个项目的剩余部分使用这个转换。</p><p id="b745" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们想象不同的相关性。这是帮助我们选择模型重要特性的关键一步。相关矩阵如下所示:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="f929" class="mt ls it mp b gy mu mv l mw mx">apps.corr()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/10f1a7015534833940c6ac04374ebcfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCN7d4AtaSTE4Zm8SLJMJQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/b410e9be8c389099150e4d83e35b1b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgH6_GYqzapcPCiJ2zcF0Q.png"/></div></div></figure><p id="a3cd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">与相关性相关的一些备注:</strong></p><ul class=""><li id="3311" class="ng nh it kw b kx ky la lb ld ni lh nj ll nk lp nl nm nn no bi translated">很明显，安装数量与评论数量高度相关(k=0，59)。</li><li id="aa6b" class="ng nh it kw b kx np la nq ld nr lh ns ll nt lp nl nm nn no bi translated">价格越高，评级越低，相关系数为0.02。</li></ul><h1 id="15cd" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">预测模型</strong></h1><p id="f777" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我们建立了两个模型:</p><ul class=""><li id="c224" class="ng nh it kw b kx ky la lb ld ni lh nj ll nk lp nl nm nn no bi translated">随机森林回归量</li></ul><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="9124" class="mt ls it mp b gy mu mv l mw mx"><strong class="mp iu">from</strong> <strong class="mp iu">sklearn.ensemble</strong> <strong class="mp iu">import</strong> RandomForestRegressor<br/><strong class="mp iu">from</strong> <strong class="mp iu">sklearn.metrics</strong> <strong class="mp iu">import</strong> auc, accuracy_score, mean_absolute_error, mean_squared_error</span><span id="4a54" class="mt ls it mp b gy nu mv l mw mx">chosen_features = ['Reviews', 'Size', 'Installs', 'Type','Category', 'Price', 'Content Rating', 'Genres']<br/>X = apps[chosen_features]<br/>y= bcx_target <em class="nv">#transformed rating</em><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.33, random_state=10)</span><span id="6335" class="mt ls it mp b gy nu mv l mw mx">rf_reg = RandomForestRegressor()<br/>rf_reg.fit(X_train,y_train)<br/>y_rfpred = rf_reg.predict(X_test)</span></pre><p id="1c95" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于一个简单的RF回归器(带有转换后的评级)，我们得到:</p><ul class=""><li id="9e32" class="ng nh it kw b kx ky la lb ld ni lh nj ll nk lp nl nm nn no bi translated">均方差:0.269</li><li id="bd26" class="ng nh it kw b kx np la nq ld nr lh ns ll nt lp nl nm nn no bi translated">平均绝对误差:0.352</li></ul><p id="692d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下图中，我们可以更好地看到随机森林回归的实际和预测评级。：</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/813f64683b88c6810fefad145dbe81fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LqZhaQx2J8sMn97Tx-aN4w.png"/></div></div></figure><p id="e9ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们想象一下随机森林的估计数对MSE的影响:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="3aa0" class="mt ls it mp b gy mu mv l mw mx">estimators = np.arange(10, 500, 10)<br/>mse_list = []<br/><strong class="mp iu">for</strong> i <strong class="mp iu">in</strong> estimators:<br/>    rf_reg.set_params(n_estimators=i)<br/>    rf_reg.fit(X_train, y_train)<br/>    y_rfpred = rf_reg.predict(X_test)<br/>    mse_list.append(mean_squared_error(inv_boxcox(y_test,lam), inv_boxcox(y_rfpred,lam)))<br/>plt.figure(figsize=(10, 5))<br/>plt.xlabel("No. of Estimators")<br/>plt.ylabel("MSE")<br/>plt.title("Effect of Number of Estimators")<br/>plt.plot(estimators, mse_list)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/0685476977baa904ad360af3b25d4455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NwjKDMSNzxqQfsvX1GLQXQ.png"/></div></div></figure><p id="eeff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们得到了大约<strong class="kw iu"> 370 </strong>的一些估计量的最小均方误差。最低MSE大约等于<strong class="kw iu"> 0，2697 </strong>。</p><ul class=""><li id="35b3" class="ng nh it kw b kx ky la lb ld ni lh nj ll nk lp nl nm nn no bi translated">XGBoost回归器</li></ul><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="e690" class="mt ls it mp b gy mu mv l mw mx">y_xgpred = xgb_model.predict(X_test)<br/>mse=mean_squared_error(inv_boxcox(y_test,lam), inv_boxcox(y_xgpred,lam))<br/>print('Mean Squared Error:',mse)</span></pre><p id="02ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">XGboost的MSE近似等于<strong class="kw iu"> 0，2695 </strong>。</p><p id="a510" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在下图中，我们比较了两个模型(Random Forest和XGboost)的预测性能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/a49467dcda8e8a8324c3f067ceaa2d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CoOz0wzEktlCaXfr_bbmuA.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/d1b578a9c2e678583a5def37b721941a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_o-hkHnc5xEDZovzETINQ.png"/></div></div></figure><h1 id="c900" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">观点</h1><p id="19b3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">为了不使开发时间过长，我在这里停了下来。虽然，如果我想在这方面更进一步，我会尝试这两个想法:</p><ul class=""><li id="9fb1" class="ng nh it kw b kx ky la lb ld ni lh nj ll nk lp nl nm nn no bi translated">尝试一些神经网络模型(使用Keras)。我相信如果我们为这个问题选择了最好的架构，我们会得到好的结果。</li><li id="2a25" class="ng nh it kw b kx np la nq ld nr lh ns ll nt lp nl nm nn no bi translated">我还将着手处理数据集的第二部分，并应用NLP(自然语言处理)来根据用户的评论预测应用程序的评级(通过使用所有的NLP技术，如标记化、文本分段……)</li></ul><p id="358a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">我建议您查看我在这个项目中使用的代码，方法是从</strong> <a class="ae lq" href="https://github.com/anasselhoud" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">这里</strong> </a> <strong class="kw iu">在我的Github上可视化这个项目的Jupyter笔记本，并关注更多相关文章和项目。</strong></p></div></div>    
</body>
</html>