<html>
<head>
<title>Using Unsupervised Learning To Generate Artist Recommendations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用无监督学习生成艺术家推荐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-unsupervised-learning-to-generate-artist-recommendations-dd4fdba3b4fa?source=collection_archive---------30-----------------------#2020-10-31">https://towardsdatascience.com/using-unsupervised-learning-to-generate-artist-recommendations-dd4fdba3b4fa?source=collection_archive---------30-----------------------#2020-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="38d7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Scikit的最近邻Python学习者</h2></div><p id="1170" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将探索使用无监督的机器学习来使用Spotify的数据生成艺术家推荐。虽然有许多算法可以用于此目的，但这里考虑的是最近邻学习器，使用Python中的Scikit Learn实现。</p><p id="0bc0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们开始吧！</p><p id="46b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1。数据</strong></p><p id="1326" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将使用来自Spotify Web API的数据(可以在<a class="ae lb" href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks?select=data_by_artist.csv" rel="noopener ugc nofollow" target="_blank">这里</a>找到)。该数据集包含了从1921年到2020年的数据，涵盖了大约27000多位艺术家！</p><p id="33ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于每个艺术家来说，有几个领域可以描述他们的音乐:响度、听觉、舞蹈性、流行度等等。(关于这些意味着什么的细节可以在<a class="ae lb" href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-features/" rel="noopener ugc nofollow" target="_blank">这里</a>找到)。我们将只使用这些特征(没有其他信息，如艺术家属于哪个流派)来训练我们的模型，然后要求它为类似于我们指定的艺术家生成推荐。</p><p id="19b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。算法</strong></p><p id="0e75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然许多无监督学习算法可以用于这个问题，但我们将考虑一个最简单的算法——最近邻学习器。该算法本质上扫描n维空间(n是我们给模型的“特征”或特性的数量)来寻找最接近我们指定的点。例如，如果我们只给模型响度和流行度，并要求它推荐5位与Eminem相似的艺术家，它将浏览所有艺术家并找到响度和流行度值最相似的5位艺术家。<br/>形象化的一个有用方法是想象我们生成了一个散点图，响度在x轴上，流行度在y轴上。每个艺术家的x-y坐标可以被认为是他们的“地址”，我们的问题归结为找到“最近的邻居”(即在这个二维空间中离阿姆“距离”最小的艺术家)。这里我们将在11维空间中工作，但同样的原理也适用。<br/>幸运的是，我们不需要费心去弄清楚如何编写代码来实际实现这个算法，它已经为我们完成了，我们可以直接使用Python中的SciKit Learn包。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/a311c4d27f393ad3f9b58f7e8e1250d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRDZG8s7zqx3cbZmp-gXkg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">作者在二维平面图像中寻找“最近的邻居”</p></figure><p id="c7d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。流程</strong></p><p id="3fd1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们将数据加载到Python中。可以从<a class="ae lb" href="https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载csv格式的文件。</p><p id="674d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">二。然后，我们将决定应该将哪些“特性”或特征传递给模型。</p><p id="0469" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">三。这些特征中的一些可能具有偏斜分布。例如，大多数歌曲的“器乐性”值很低，这意味着我们有许多艺术家的器乐性得分接近0，但相比之下，少数艺术家的得分要高得多(见下图)。机器学习算法通常不能很好地处理这种分布，因为异常值会在数据中引入大量“噪声”。为了解决这个问题，我们将使用SciKit Learn的StandardScaler函数来缩放我们的数据，这将减少这些异常值对我们数据的影响。更多关于定标器的细节可以在<a class="ae lb" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ls"><img src="../Images/2ee45f42282b486f0a75c761da8150be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iep6La4EKfIqJ3PS.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">工具性显示了一个偏斜的分布:我们需要通过作者来修正这个图像</p></figure><p id="3a3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">四。在我们的数据被缩放后，我们准备好训练我们的模型。我们将数据传递给最近的邻居学习者(<a class="ae lb" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors" rel="noopener ugc nofollow" target="_blank">文档</a>)。虽然我们有机会调整该学员考虑的许多技术参数，但对于这个问题，我们将只让每个参数取默认值。我们将告诉我们的模型的唯一事情是我们想要多少推荐。</p><p id="1474" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">动词 （verb的缩写）就是这样！我们现在将要求我们的模型扫描所有27，000+位艺术家，并推荐与我们指定的艺术家相似的艺术家。</p><p id="a5e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们开始吧:</p><pre class="ld le lf lg gt lt lu lv lw aw lx bi"><span id="84d6" class="ly lz iq lu b gy ma mb l mc md">import pandas as pd<br/>import numpy as np</span><span id="5f1d" class="ly lz iq lu b gy me mb l mc md">data_artist = pd.read_csv('./Spotify/data_by_artist.csv') <em class="mf">#This is a datafram with 27621 rows (each row represents one artist) and 15 columns (each column has a unique feature)</em></span><span id="d720" class="ly lz iq lu b gy me mb l mc md"><em class="mf">## Let's see the 10 most popular artists according to Spotify's algorithm</em></span><span id="69a4" class="ly lz iq lu b gy me mb l mc md">data_artist.sort_values(by='popularity',ascending=False).head(10)['artists']</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mg"><img src="../Images/237b5bcdffd11fc2a1839d1ce9927337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3q2RWGUU_Byd3HvltiTtrQ.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">Spotify上最受欢迎的十位艺术家</p></figure><p id="53a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在将编写一个函数来准备数据、缩放数据、训练模型并生成建议:</p><pre class="ld le lf lg gt lt lu lv lw aw lx bi"><span id="3b1f" class="ly lz iq lu b gy ma mb l mc md">features= list(data_artist.columns[0:12]) # We select only the features we want to pass to the model<br/>df = data_artist[features]</span><span id="a3ed" class="ly lz iq lu b gy me mb l mc md">def getArtist_recommendations(data,artist,numArtists):<br/>    X = data.iloc[:,1:] #This contains all our features<br/>    Y = data.iloc[:,0] #This contains the name of the artists <br/>    from sklearn.preprocessing import StandardScaler<br/>    scaler = StandardScaler()<br/>    X_scaled = scaler.fit_transform(X) #We have now scaled our data to reduce the impact of outliers <br/>    <br/>    <br/>    from sklearn.neighbors import NearestNeighbors<br/>    recommender = NearestNeighbors(n_neighbors=numArtists+1).fit(X_scaled) #Training the model took a single line of code :)<br/>    distances, indices = recommender.kneighbors(X_scaled)<br/>    output = pd.DataFrame(indices)<br/>    output['Artist'] = Y<br/>    <br/>    recommendations = output.loc[output.Artist==artist,output.columns!='Artist']<br/>    Y[list(recommendations.values[0])][1:]<br/>    return(Y[list(recommendations.values[0])][1:])</span></pre><p id="0291" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！让我们测试一下模型的表现。我们将要求它推荐10位与阿姆、肯德里克·拉马尔和阿肯相似的艺术家。</p><pre class="ld le lf lg gt lt lu lv lw aw lx bi"><span id="0575" class="ly lz iq lu b gy ma mb l mc md">getArtist_recommendations(df,'Eminem',10)<br/>getArtist_recommendations(df,'Kendrick Lamar',10)<br/>getArtist_recommendations(df,'Akon',10)</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mh"><img src="../Images/40b9b2b74cc3a74422262520833088a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kt7VuF1RXm0slriujkHzew.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">推荐与阿姆相似的艺术家-作者图片</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mi"><img src="../Images/86cebb2eb63aac5874a277f24615d441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*asjsQtkhU5BWgI1S3dS2_w.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">推荐与Kendrick Lamar相似的艺术家-作者图片</p></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mj"><img src="../Images/8692e5c3cff92990069239fa5f79dc0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsbRjjbAAEpDAgjC_oIwlA.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">推荐与阿肯相似的艺术家-作者图片</p></figure><p id="f853" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快乐聆听:)</p></div></div>    
</body>
</html>