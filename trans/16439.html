<html>
<head>
<title>Using the Chi-Squared test for feature selection with implementation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用卡方检验进行特征选择和实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-the-chi-squared-test-for-feature-selection-with-implementation-b15a4dad93f1?source=collection_archive---------1-----------------------#2020-11-13">https://towardsdatascience.com/using-the-chi-squared-test-for-feature-selection-with-implementation-b15a4dad93f1?source=collection_archive---------1-----------------------#2020-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5e22" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">特征越少，解释模型就越容易</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/780586d47ec2e2d629e940a48f569fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_nxFIHRkYHSUFBgY"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@purzlbaum" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@purzlbaum</a></p></figure><p id="83d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们使用卡方问答方式来解决这个特征选择问题。如果你是一个视频爱好者，你可以看看我们在<a class="ae kv" href="https://youtu.be/hkDfi5j-6lM" rel="noopener ugc nofollow" target="_blank">同一个</a>的youtube讲座。</p><p id="79da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题1:什么是特性？</strong></p><p id="4ca0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于任何ML或DL问题，数据都是按行和列排列的。让我们以泰坦尼克号沉船问题为例。</p><ul class=""><li id="43b0" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">这些行由乘客的数据组成，实际上，每一行都由单个乘客的数据组成。这通常被称为<strong class="ky ir">实例、实体或观察。</strong></li><li id="af0c" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这些栏目描述了乘客的性别、年龄等。这些被称为<strong class="ky ir">特征或属性。</strong></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/c7f0bd5ff629d7a8606d829350b92038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JE9TU-3c6jYmkuO6msENOA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">泰坦尼克号的数据、观察、特征(Imag来源作者)</p></figure><p id="da52" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题2:有哪些不同类型的功能？</strong></p><p id="5d14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不涉及太多细节，让我们以上面的例子为例:</p><ul class=""><li id="105b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">年龄、费用、Pid是数字属性。但是，Pid不会泄露任何模式，因为它通常是连续或随机分配的。</li><li id="c7e2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">姓名、性别等。是分类属性(它们可以进一步分为名词性的和序数性的‘大小’,值有小、中、大之类)</li><li id="c3b7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">特殊类是具有两个可能值的分类变量或二元变量，如性别或幸存变量</li><li id="a3b7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在问题的上下文中，我们要预测的变量的值是因变量，而我们要确定的变量或特征称为自变量。</li></ul><p id="737f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题3:什么是特征选择？</strong></p><p id="1888" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在泰坦尼克号沉船数据集中，要解决的问题是给定乘客的特征，要确定乘客是否幸存(即，他是否能够接近船只)。所以，这是一个分类问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/836a1e02efd731cd90db8cb9ab0f8384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9rX6i9zPEpJ4b3dR"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:<a class="ae kv" href="https://unsplash.com/photos/MeGmdPNe36w" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/MeGmdPNe36w</a></p></figure><p id="9abb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果原始数据集有关于乘客的8个特征，并且分类模型带来大约90%的分类准确度，<strong class="ky ir">特征选择的目标是从8个特征中选择可能的3个或4个，并且仍然达到相似的准确度。</strong></p><p id="20c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题4:为什么选择功能？</strong></p><p id="41e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">具有较少的功能:</p><ul class=""><li id="2d00" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">这些模型更容易解释</li><li id="363d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">模型训练更快，模型所需的空间也更大</li></ul><p id="916d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题5:特征选择和卡方有什么联系？</strong></p><p id="4899" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">实际上，这不是卡方检验，而是假设检验。同样的典型设置是:</p><ul class=""><li id="92fd" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">H0:属性性别在乘客的生存中不起作用(特征不重要)</li><li id="a709" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">H1:属性性别在生存中扮演了一个角色(特征很重要)</li></ul><p id="b875" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">值得注意的是，这些技术被称为单变量技术，因为我们分别检查每个特征。</p><p id="a49d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi mh translated"><span class="l mi mj mk bm ml mm mn mo mp di"> C </span>当特征是分类的，目标变量是任何可以被认为是分类的时，使用卡方检验。<em class="mq">它衡量两个分类变量之间的关联程度。如果两者都是数字，我们可以使用皮尔森的积差相关，如果属性是数字，并且有两个类别，我们可以使用t检验，如果超过两个类别，我们可以使用ANOVA </em></p><p id="56e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们探讨性对生存状态的影响时，我们可以从一个简单的形象化开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/d44717af8d9b0fb278df36d222e3e433.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*IPCmMz7xqoDJYgfdzS7T3A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">泰坦尼克号生存状态对性别(图片来源:作者)</p></figure><p id="03b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的图像清楚地表明，两个班级的男女比例并不相同。假设检验是一种更正式的方式。卡方统计使用以下公式计算，其中“O”代表观察值或实际值，“E”代表期望值(如果这两个类别是独立的)。如果它们是独立的，这些O和E值将是接近的，并且如果它们有一些关联，那么卡方值将是高的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/18ba6c81b09cd19307b59052d3b93c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*LHNDN6xepe2oB_OIC38y0Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卡方公式(来源:作者)</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/5c69e20103cebad4e921b92e9be6afc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*dsceS-NHrkT0fIYWtE0rMg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">乘客性别对抗生存(来源:作者)</p></figure><p id="4d87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上表显示了乘客的性别与生存状态。这也被称为列联表。</p><ul class=""><li id="ad6d" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">如果他们是独立的，那么幸存和未幸存的男女比例应该是相同的。</li><li id="2399" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">幸存的比率为449/1313</li><li id="7ab0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如果没有依赖或关联，463 * 449/1313的女性应该存活，即158.13</li><li id="9030" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">这是独立状态下的预期计数</li><li id="6247" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">所有四种情况计算如下</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/2b2f7674df1e8c286f39dbe83e854849.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*dxAA-RQX3Y4wwsH___j69A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">卡方计算观察值与期望值(图片:作者)</p></figure><p id="72eb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些卡方统计由自由度调整，自由度随变量的级别数和类变量的级别数而变化。</p><p id="8dd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以注意到，在适当离散化之后，卡方也可以用于数值变量。</p><p id="09d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">问题6:如何实现相同？</strong></p><p id="c0b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入库</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="0fd2" class="na nb iq mw b gy nc nd l ne nf">from sklearn import datasets<br/>from sklearn.feature_selection import chi2<br/>from sklearn.feature_selection import SelectKBest</span></pre><p id="f790" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将对葡萄酒数据集进行特征选择</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/209ad40999342cd06853cfa0bdeed7ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DgJtqa7au9bdcsE7OoVB0A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://archive.ics.uci.edu/ml/datasets/wine" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/wine</a></p></figure><p id="2047" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看卡方得分</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="325b" class="na nb iq mw b gy nc nd l ne nf"># Loading wine data<br/>X,y=datasets.load_wine(return_X_y=True)<br/># k = 4 tells four top features to be selected<br/># Score function Chi2 tells the feature to be selected using Chi Square<br/>test = SelectKBest(score_func=chi2, k=4)<br/>fit = test.fit(X, y)<br/>fit.scores_</span></pre><p id="2cc8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它将按如下方式打印这些值</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="98f5" class="na nb iq mw b gy nc nd l ne nf">array([5.44549882e+00, 2.80686046e+01, 7.43380598e-01, 2.93836955e+01,4.50263809e+01, 1.56230759e+01, 6.33343081e+01, 1.81548480e+00,9.36828307e+00, 1.09016647e+02, 5.18253981e+00, 2.33898834e+01,1.65400671e+04])</span></pre><p id="b1cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果我们想选择前四个特性，我们可以简单地做以下事情</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="e9ec" class="na nb iq mw b gy nc nd l ne nf">X_new=test.fit_transform(X, y)</span></pre><p id="4714" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">尾注:</strong></p><p id="c31f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">卡方是用于分类的单变量特征选择的非常简单的工具。它没有考虑特征的相互作用。这最适合分类变量，因此在文本数据中应用广泛。</p><p id="94c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考资料:</p><p id="c782" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1]<a class="ae kv" href="https://youtu.be/hkDfi5j-6lM" rel="noopener ugc nofollow" target="_blank">https://youtu.be/hkDfi5j-6lM</a></p><p id="6a6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]<a class="ae kv" href="https://machinelearningmastery.com/feature-selection-machine-learning-python/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/feature-selection-machine-learning-python/</a></p><p id="ec08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]<a class="ae kv" href="https://www.kaggle.com/saptarsi/feature-selection-using-chi-square/" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/saptarsi/feature-selection-using-chi-square/</a></p></div></div>    
</body>
</html>