<html>
<head>
<title>Building a Data App with Streamlit in No Time</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Streamlit快速构建数据应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-data-app-with-streamlit-in-no-time-c5942c48abd?source=collection_archive---------36-----------------------#2020-11-03">https://towardsdatascience.com/building-a-data-app-with-streamlit-in-no-time-c5942c48abd?source=collection_archive---------36-----------------------#2020-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="99d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建股票价格应用程序的实用指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/306acc63fd6a09862f3f02bb1208a6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0fQjvgQe1DDHP4BqRi0skQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Streamlit数据应用程序(作者GIF)</p></figure><p id="ced8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="lu">注来自《走向数据科学》的编辑:</em> </strong> <em class="lu">虽然我们允许独立作者根据我们的</em> <a class="ae lv" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="lu">规则和指导方针</em> </a> <em class="lu">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae lv" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="lu">读者术语</em> </a> <em class="lu">。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="a271" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我开始我的数据科学之旅时，我对部署模型或创建web应用程序一无所知。我的数据科学世界被jupyter笔记本所束缚。</p><p id="4d17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">过了一段时间，我清楚地意识到我需要超越笔记本。无论我对数据做了什么，它都需要以某种方式转化为产品，以便其他人可以测试或使用它。从那时起，我开始学习部署模型和创建数据应用程序。</p><p id="5c13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">即使你创造了一个最先进的模型，当你坐在jupyter笔记本上时，它也不会创造任何价值。你可以创建一个出色的数据应用程序，但只有当其他人使用它时，它才有价值。</p><p id="2232" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，创建产品并维护它们是数据科学领域中非常关键的步骤。</p><p id="fc86" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Streamlit使将数据脚本转换成web应用程序变得相当容易。你不必有前端经验。你需要的只是Python。</p><p id="bf16" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我们将创建一个简单的股票价格数据应用程序。它将提取并展示基于一些用户输入的股票价格。</p><p id="6f67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用文本编辑器来编写脚本(我使用sublime)。确保您的计算机上安装了Python 3.6或更高版本。</p><p id="3d59" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要的依赖项可以通过pip从终端安装:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="25f4" class="mi mj it me b gy mk ml l mm mn">pip install streamlit<br/>pip install pandas<br/>pip install pandas-datareader<br/>pip install datetime</span></pre><p id="16dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始构建我们的应用程序。</p><p id="2bef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一步是导入依赖关系:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="cf51" class="mi mj it me b gy mk ml l mm mn">import pandas as pd<br/>import streamlit as st<br/>from pandas_datareader import data<br/>from datetime import datetime, timedelta</span></pre><p id="e78a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以为我们的应用程序显示一个标题:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="66e1" class="mi mj it me b gy mk ml l mm mn">st.title("Streamlit Stock Prices App")</span></pre><p id="13d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一步是检索数据。我们将使用pandas-datareader模块来获取股票价格数据。它需要三个输入，即股票名称、开始日期和结束日期。</p><p id="2f19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将要求用户输入这些参数。Streamlit提供了许多不同的方法来收集用户输入。</p><p id="8aa7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用text_input小部件向用户询问股票名称:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="65ab" class="mi mj it me b gy mk ml l mm mn">stock_name = st.text_input("Enter the stock name: \n")</span></pre><p id="233a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于开始和结束日期，我们将询问用户他们希望使用slider小部件查看多少天的数据。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="beaa" class="mi mj it me b gy mk ml l mm mn">option = st.slider("How many days of data would you like to see?",<br/>      1,60,1)</span></pre><p id="8c58" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数字参数是开始、结束和步长。</p><p id="a9f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些部件将出现在应用程序中，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/06021e224b171a31c5d2f16e885af653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTy4WIxBX0csVwFp5uisow.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="a637" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用datetime模块根据用户输入创建开始日期和结束日期。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="2272" class="mi mj it me b gy mk ml l mm mn">end = datetime.today().strftime('%Y-%m-%d')<br/>start = (datetime.today() - timedelta(option)).strftime('%Y-%m-%d')</span></pre><p id="05c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们把今天作为结束日期。通过回溯用户给定的天数来计算开始日期。例如，如果期权是20天，数据将显示过去20天的股票价格。</p><p id="1195" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一步是定义一个基于这些输入收集数据的函数。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="bbd2" class="mi mj it me b gy mk ml l mm mn">def load_data(stock, start_date, end_date):<br/>    df = data.DataReader(name=stock,<br/>                         start=start_date,<br/>                         end=end_date,<br/>                         data_source='yahoo')<br/>    return df</span></pre><p id="b1a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">load_data函数将创建一个pandas数据框架，其中包含基于给定输入的股票价格。</p><p id="86f5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们调用这个函数之前，我们将显示一个描述操作状态的文本。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="882b" class="mi mj it me b gy mk ml l mm mn">data_load_state = st.text("Loading data...")</span></pre><p id="0cfd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当应用程序处理数据时，用户会看到“正在加载数据…”。</p><p id="14ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下一步是调用函数并创建一个熊猫数据帧。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="a6f1" class="mi mj it me b gy mk ml l mm mn">df = load_data(stock=stock_name, start_date=start, end_date=end)<br/>df.sort_index(axis=0, inplace=True, ascending=False)</span></pre><p id="2847" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在将数据存储在数据帧中。我们有许多向用户显示数据的选项。Streamlit提供了大量图表。例如，显示价格随时间变化的折线图会很有用。</p><p id="e1b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们不局限于Streamlit提供的图表。我们甚至可以运行机器学习模型来预测接下来的日子。</p><p id="7ccb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为简单起见，我将显示数据帧和折线图:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="e3bc" class="mi mj it me b gy mk ml l mm mn">st.subheader(f'{stock_name} stock prices for the past {option} days')<br/>st.dataframe(df)</span><span id="0f8c" class="mi mj it me b gy mp ml l mm mn"><br/>chart_data = df[['Close']]<br/>st.subheader("Close Prices")<br/>st.line_chart(chart_data)</span></pre><p id="1fc9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">名字让它看起来很明显。我们使用st.dataframe()来显示数据帧，使用st.line_chart()来创建折线图。st.subheader()允许为显示的对象添加标题。</p><p id="0b85" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是在应用程序处理数据时更改显示文本的状态。您可能还记得，正文是“加载数据…”。下面的代码会将其更改为“数据已加载！”。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="d2b5" class="mi mj it me b gy mk ml l mm mn">data_load_state.text("Data loaded!")</span></pre><p id="8157" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是整个脚本的截图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/a298d05a0cd732a9efaf0134db9b7de4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dm0RxTfpAYu5OFNLdp6Kjw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="7e8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能已经注意到，我们在函数定义之前使用了“@st.cache”。它所做的是运行函数并将结果存储在本地缓存中。因此，如果使用完全相同的参数再次调用该函数，streamlit将从本地缓存中读取输出，而不是再次运行该函数。</p><p id="c834" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的剧本现在完成了。我们将把它作为python文件保存在当前工作目录中，然后使用命令行来运行脚本。命令是:</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="a68e" class="mi mj it me b gy mk ml l mm mn">streamlit run "file_name"</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/5b86380bfa8897d56eafbca3b8c480cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*0hmkl7ZjSIqdDE6VCQWZbg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="bad6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当streamlit执行脚本时，浏览器中将会打开一个新的选项卡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/54b8cabc71b0b41b84a20fb049e7cb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytjWI08z1IBuUbOSsKAqjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="5825" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的数据应用程序现在已经完成。请注意，它目前正在您的本地计算机上运行。因此，只有你可以试验这个应用程序。</p><p id="aa5b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下一篇文章的<a class="ae lv" href="https://sonery.medium.com/deploying-a-data-app-on-aws-for-free-f62e121c049e" rel="noopener">中，我将讲述如何在AWS EC2实例上运行应用程序。之后，你就可以和你的朋友分享你的应用了。</a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="d8f6" class="mt mj it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated"><strong class="ak">结论</strong></h1><p id="f34d" class="pw-post-body-paragraph ky kz it la b lb nk ju ld le nl jx lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">我们已经创建了一个简单的应用程序，做一个简单的任务。然而，创建复杂应用程序的过程非常相似。</p><p id="f798" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用streamlit最大的好处就是一切都是用Python完成的。大多数(如果不是全部)数据科学家都熟悉Python，因此他们适应Streamlit并不困难。</p><p id="5e69" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如同任何其他科目一样，熟能生巧。我建议先做简单的应用程序。然后，您可以稳步增加项目的复杂性。</p><p id="0f33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>