<html>
<head>
<title>Quick and Easy Deep Learning WebApp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">快速简单的深度学习WebApp</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quick-and-easy-deep-learning-webapp-762f92f19f46?source=collection_archive---------49-----------------------#2020-11-02">https://towardsdatascience.com/quick-and-easy-deep-learning-webapp-762f92f19f46?source=collection_archive---------49-----------------------#2020-11-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="464c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用fastai和streamlit训练和部署深度学习图像分类模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/37a2d1ccd53d1916c9b5e31b41585c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YtCDnDiNcxo5RF_6"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">锡德·巴拉钱德朗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fd81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你有没有想过在一个项目中使用深度学习，并以互动的方式展示你的成果？你想开始你的深度学习之旅，并作为一个工作应用快速看到你的结果吗？让我告诉你怎么做。</p><p id="c0b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Python部署小型数据驱动或机器学习应用程序的最简单方法之一是streamlit。Streamlit允许您只使用几行代码创建具有大量功能的web应用程序，我将在一分钟后演示。</p><div class="lv lw gp gr lx ly"><a href="https://www.streamlit.io/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">Streamlit -创建数据应用程序的最快方式</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">Streamlit是一个面向机器学习和数据科学团队的开源应用框架。在…中创建漂亮的数据应用程序</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.streamlit.io</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="f2d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在涵盖了部署部分，但机器或深度学习呢？如果你想深入学习，fast.ai是一个很好的起点。他们的MOOC，现在也是他们的书，特别是fastai图书馆，为你提供了开始深度学习之旅所需的一切。</p><div class="lv lw gp gr lx ly"><a href="https://www.fast.ai/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">主页</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">2020年10月20日更新:NumFOCUS已经向我道歉了。我接受他们的道歉。我不接受他们的断言，即“在…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.fast.ai</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm ks ly"/></div></div></a></div><p id="cc80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我想向您展示，使用最先进的深度学习模型，构建一个交互式分类WebApp有多快多容易。为此，我将从Kaggle获得<a class="ae ky" href="https://www.kaggle.com/gpiosenka/100-bird-species" rel="noopener ugc nofollow" target="_blank"> 225个鸟类物种数据集</a>，<br/>在其上训练一个深度学习模型，然后在streamlit应用程序中使用该模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/4e6424c192165244bff58a84828d50c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f7D2YbMN_j_Kfpfm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@dulceylima?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dulcey Lima </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5803" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我意识到，从技术上来说，对这么多鸟类进行分类并不是一件容易的事情，而且这个模型也远非完美，如果你想得到真正好的结果，你就必须更深入地研究。我只想给你提供一个分类应用教程，不使用MNIST，时尚MNIST，CIFAR-10或fastai MOOC已经使用的任何东西。本教程不是告诉你如何在Kaggle排行榜上获得鸟类图像分类的榜首。我更愿意向您展示如何以初学者友好的方式构建端到端的东西。</p><p id="e91f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一步是下载数据。<br/>数据集包含4个名为“合并”、“测试”、“训练”和“有效”的文件夹。在每个文件夹中，我们可以找到225个子文件夹，每个物种一个。文件夹名称稍后将提供标签。“合并”文件夹包含所有图像，所以对我们来说用处有限。</p><p id="9b76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们把重点放在我们任务的培训和验证文件夹上。</p><h1 id="4870" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">数据准备和模型培训</h1><p id="de5e" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">下一步是加载我们的数据，预处理它并训练我们的模型。如果你是一个初学者，这听起来可能很多，可能令人不知所措，但是fastai让它变得出奇的简单。</p><p id="31e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先导入fastai.vision.all包。请注意，我这里用的是<code class="fe nm nn no np b">import *</code>。我知道这可能产生的问题，<strong class="lb iu">我不建议将它用于jupyter笔记本之外的任何探索和实验。一旦我们探索、训练并保存了模型，我们将不会在WebApp文件中再次使用这种导入。</strong></p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="4281" class="nu mq it np b gy nv nw l nx ny">from fastai.vision.all import *</span><span id="5921" class="nu mq it np b gy nz nw l nx ny">#set the path where our data can be found<br/>path = Path("D:/datasets/birds/archive (2)")</span><span id="bce1" class="nu mq it np b gy nz nw l nx ny">#check if the path is working by extracting one image<br/>im = Image.open(path / "train/CROW/001.jpg")<br/>im.to_thumb(224,224) #this should display your image</span></pre><p id="8693" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以构建一个数据块和数据加载器，以我们的模型可以处理的方式加载数据。在fastai中，这是通过DataBlock类和dataloaders完成的。<code class="fe nm nn no np b">GrandparentSplitter()</code>告诉数据块对训练集使用“train”中的所有文件，对验证集使用“valid”中的所有文件。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="99f2" class="nu mq it np b gy nv nw l nx ny">birds = DataBlock(<br/>        blocks = (ImageBlock,CategoryBlock),<br/>        get_items = get_image_files,<br/>        splitter = GrandparentSplitter(train_name = "train", valid_name = "valid"),<br/>        get_y = parent_label, #get labels from folder names<br/>        item_tfms = Resize(224) #resize images to 224x224<br/>)</span><span id="c5dd" class="nu mq it np b gy nz nw l nx ny">#use a dataloader to get the images<br/>dls = birds.dataloaders(path)</span></pre><p id="08f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将是检查一切是否如预期进行的好时机。我们将查看验证和训练数据的前10张图片，看看是否所有内容都已正确加载。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="635e" class="nu mq it np b gy nv nw l nx ny">dls.valid.show_batch(max_n = 10, nrows = 2)</span><span id="f00b" class="nu mq it np b gy nz nw l nx ny">dls.train.show_batch(max_n = 10, nrows = 2)</span></pre><p id="61b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的输出应该如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/fafdfd4ddbaca84b8d88e43e86f01c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zp2N9wKImIWIbnz-2sRIsQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者。</p></figure><p id="d129" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，训练数据已经被混洗用于训练，而验证数据没有，也不需要被混洗。</p><p id="ed60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的分类器将不得不在真实环境中处理的大多数图片都不会是配得上国家地理特征的完美图像(例如，当有人想使用你的应用程序来找出他们拍了哪只鸟的照片时)。因此，我们应该对数据进行一些转换。使用<code class="fe nm nn no np b">birds.new()</code>,我们可以添加新的图像或转换后的图像。使用<code class="fe nm nn no np b">RandomResizedCrop</code>我们可以添加从原始图片中随机裁剪的图片，使用<code class="fe nm nn no np b">batch_tfms = aug_transforms()</code>我们可以为整批图片添加变换，这些变换是一些有用的标准图像增强，如改变亮度、倾斜、拉伸和挤压图片。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="f5de" class="nu mq it np b gy nv nw l nx ny">birds = birds.new(<br/>        item_tfms = RandomResizedCrop(224, min_scale = 0.5),<br/>        batch_tfms = aug_transforms())</span><span id="d706" class="nu mq it np b gy nz nw l nx ny">#we again load the data <br/>#I set num_workers = 0 in order to run the torch code on my local #machine, this may not be necessary for you<br/>dls = birds.dataloaders(path, num_workers = 0)</span><span id="040e" class="nu mq it np b gy nz nw l nx ny">#look at some of the transformations<br/>dls.train.show_batch(max_n = 15, nrows = 3, unique = True)</span></pre><p id="0f7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中一些图片可能看起来有点奇怪，但你也可以找到一些“还可以，但远非理想”的图片，这些图片可能类似于你的WebApp用户稍后上传的内容。</p><p id="6a66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，我们有了数据，我们对它进行了一些预处理。是时候选择一个模型并训练它了。</p><p id="bcfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Fastai非常强调使用预训练的模型并对其进行微调。这通常比从头开始训练更好更快地得到结果。这里我们将使用在ImageNet数据集上预先训练的ResNet34。因此，我们的模型已经“看到”了图片，也“知道”了一只鸟的样子。我们可以利用这一点，对模型进行微调，对不同种类的鸟类进行分类。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="3acb" class="nu mq it np b gy nv nw l nx ny">learn = cnn_learner(dls, resnet34, metrics=error_rate).to_fp16() <br/>#to_fp16() works well for my local system, might not be necessary for you</span><span id="9f46" class="nu mq it np b gy nz nw l nx ny">#lets train and tune the model for 5 epochs<br/>learn.fine_tune(5)</span></pre><p id="26da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关<code class="fe nm nn no np b">fine_tune()</code>方法的深入解释，请参见<a class="ae ky" href="https://docs.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fastai </a>文档。</p><p id="e28c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦模型被训练，我们可以检查它犯了哪种错误，查看它在训练时间内的损失，当然也可以使用测试集来查看它在新数据上的表现。你绝对应该做所有这些事情。如果你不知道怎么做，可以查看fast.ai教程或MOOC。</p><p id="335c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，我在这里不讨论这些步骤，因为主要的焦点不是模型训练和评估，而是展示如何创建一个工作的应用程序。</p><p id="951f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个模型做得很好。对我来说，错误率(在验证集上)是0.02，这相当于98%的准确率。请注意，准确性并不总是最好的指标，如果你想训练一个模型，你应该研究更多的指标。</p><p id="16eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候保存我们的模型并进入下一个阶段了:构建WebApp。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="677e" class="nu mq it np b gy nv nw l nx ny">learn.export(fname = "first_model.pkl")</span></pre><p id="a036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能应该找到一个更有意义的名称，尤其是如果您有多个模型的话。</p><h1 id="494c" class="mp mq it bd mr ms mt mu mv mw mx my mz jz na ka nb kc nc kd nd kf ne kg nf ng bi translated">Streamlit应用</h1><p id="8275" class="pw-post-body-paragraph kz la it lb b lc nh ju le lf ni jx lh li nj lk ll lm nk lo lp lq nl ls lt lu im bi translated">我们将使用如上所述的streamlit。要在本地托管您的应用程序，请打开您的终端或命令/anaconda提示符，导航到您的Python文件所在的目录并键入<code class="fe nm nn no np b">streamlit run {your_file_name}.py</code>。</p><p id="0797" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用程序应该在localhost:8501下可用。</p><p id="83f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将需要streamlit，numpy，PIL和fastai.vision来运行一切。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="ae28" class="nu mq it np b gy nv nw l nx ny">import streamlit as st<br/>import numpy as np<br/>from PIL import Image<br/>from fastai.vision.all import load_learner, Path</span></pre><p id="9012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的应用程序的开始应该有标题。在streamlit中，这就像输入<code class="fe nm nn no np b">st.title("Your chosen title")</code>一样简单</p><p id="c575" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的应用程序的下一部分是文件上传，这是快速和方便的:<code class="fe nm nn no np b">uploaded_file = st.file_uploader("Choose an image...", type="jpg")</code></p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="9473" class="nu mq it np b gy nv nw l nx ny">st.title("Upload + Classification Example")</span><span id="2bf8" class="nu mq it np b gy nz nw l nx ny">uploaded_file = st.file_uploader("Choose an image...", type="jpg") #file upload</span></pre><p id="1993" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在基本上已经完成了应用程序的第一个状态，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/7b7d89351761b49005a62699226fb7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l19eKcKmT82H17Q93l7q3A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b16e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了整合我们的分类，我们首先需要加载模型。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="6569" class="nu mq it np b gy nv nw l nx ny">learn_inf = load_learner(Path("first_model.pkl"))#load trained model</span></pre><p id="5e1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们对图像进行分类，并创建一些输出。</p><p id="f959" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码检查是否有上传的文件，一旦是，图像文件被转换，以便让我们的模型使用<code class="fe nm nn no np b">.predict()</code>方法预测它的标签。</p><p id="3c5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们有了一个预测，我们就用使用标准降价格式的<code class="fe nm nn no np b">st.write()</code>为我们的用户创建一些输出。我还添加了一个小的if语句，以获得更好的语法。</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="4b82" class="nu mq it np b gy nv nw l nx ny">#classification<br/>if uploaded_file is not None:<br/>    #image transformation and prediciton<br/>    img = Image.open(uploaded_file)<br/>    st.image(img, caption='Your Image.', use_column_width=True)<br/>    image = np.asarray(img)<br/>    label = learn_inf.predict(image) <br/>    #label[0] accesses the actual label string<br/>    #output display<br/>    st.write("")<br/>    st.write("Classifying...")<br/>    #check for vowels in the names for correct grammar<br/>    if label[0][0] in "AEIOU":<br/>        st.write("## This looks like an")<br/>    else:<br/>        st.write("## This looks like a")<br/>    #our labels are in capital letters only<br/>    st.title(label[0].lower().title())</span></pre><p id="42b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上传图片后，WebApp看起来应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/a58479b8ff891f2b2b4b8e31728d3e5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Znc2jUbi8tyzDdJH5bXARg.png"/></div></div></figure><p id="a556" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在我们有了一个使用我们深度学习模型的正常运行的本地WebApp！比用笔记本阅读要酷多了！</p><p id="5c85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以部署它，但是你可能需要做一些改变，关于GPU的使用等等。</p><p id="7316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是应用程序的完整代码:</p><pre class="kj kk kl km gt nq np nr ns aw nt bi"><span id="c366" class="nu mq it np b gy nv nw l nx ny">###imports<br/>import streamlit as st<br/>import numpy as np<br/>from PIL import Image<br/>from fastai.vision.all import load_learner, Path</span><span id="f42a" class="nu mq it np b gy nz nw l nx ny">## You may need these to deploy your model on e.g. heroku if you are coming from a windows machine<br/>#import pathlib<br/>#temp = pathlib.WindowsPath<br/>#pathlib.WindowsPath = pathlib.PosixPath</span><span id="6497" class="nu mq it np b gy nz nw l nx ny">###App<br/>##file upload and model loading<br/>st.title("Upload + Classification Example")</span><span id="888f" class="nu mq it np b gy nz nw l nx ny">uploaded_file = st.file_uploader("Choose an image...", type="jpg") #file upload</span><span id="88f1" class="nu mq it np b gy nz nw l nx ny">learn_inf = load_learner(Path("first_model.pkl"))#load trained model</span><span id="46f0" class="nu mq it np b gy nz nw l nx ny">#learn_inf.model.cpu() # use this if you want to deploy the model somewhere without using a GPU, you may need pytorch cpu</span><span id="adcb" class="nu mq it np b gy nz nw l nx ny">##classification<br/>if uploaded_file is not None:<br/>    #image transformation and prediction<br/>    img = Image.open(uploaded_file)<br/>    st.image(img, caption='Your Image.', use_column_width=True)<br/>    image = np.asarray(img)<br/>    label = learn_inf.predict(image)<br/>    #label[0] accesses the actual label string<br/>    #output display<br/>    st.write("")<br/>    st.write("Classifying...")<br/>    #check for vowels in the names for correct grammar<br/>    if label[0][0] in "AEIOU":<br/>        st.write("## This looks like an")<br/>    else:<br/>        st.write("## This looks like a")<br/>    #our labels are in capital letters only<br/>    st.title(label[0].lower().title())</span></pre><p id="2b65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你现在知道如何构建一个基于深度学习的图像分类App了吧！</p><p id="a348" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit提供了许多功能，您可以添加更多功能或显示更多数据，或者稍微改变布局，进行实验和探索。Fastai还提供了大量的功能，我建议您也去探索一下。</p><p id="827e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这篇文章对您有所帮助，现在我请求您:</p><p id="b43d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">探索、实验、构建您自己的应用并展示您所学到的知识！</strong></p><p id="2842" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">-梅林</p></div></div>    
</body>
</html>