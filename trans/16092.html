<html>
<head>
<title>Keep your mLab MongoDB Instance: Detaching From Heroku.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保留您的mLab MongoDB实例:从Heroku分离。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/keeping-your-mlab-mongodbs-detaching-from-heroku-173b5c97c715?source=collection_archive---------32-----------------------#2020-11-05">https://towardsdatascience.com/keeping-your-mlab-mongodbs-detaching-from-heroku-173b5c97c715?source=collection_archive---------32-----------------------#2020-11-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="1bd7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="b9e2" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">如何在2020年11月10日通过从Heroku分离mLab来保存你的数据不被删除。</h2></div><p id="53b6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln"> By: </em> <a class="ae lo" href="https://www.linkedin.com/in/edkrueger/" rel="noopener ugc nofollow" target="_blank"> <em class="ln">爱德华克鲁格</em> </a> <em class="ln">和</em> <a class="ae lo" href="https://www.linkedin.com/in/douglas-franklin-1a3a2aa3/" rel="noopener ugc nofollow" target="_blank"> <em class="ln">道格拉斯富兰克林</em> </a> <em class="ln">。</em></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/0cb0bf72443fb4509ec25c6d8a5e0d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHYoiTn9FaM51AdnxWDE4w.jpeg"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated">约翰·巴克利普在Unsplash上拍摄的照片</p></figure><p id="cee2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您使用mLab托管的MongoDB实例作为Heroku附加组件，请花些时间通过分离它来迁移它。分离不需要迁移或对应用程序代码进行任何更改，您的环境变量将保持不变。你仍然需要在2021年1月12日之前迁移，那时mLab作为一个整体关闭并终止所有实例。</p><p id="eed1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是因为MongoDB在2018年收购了mLab，并已决定结束服务，以让用户将数据库迁移到MongoDB Atlas。</p><p id="6f09" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们在2020年7月10日首次发送的电子邮件中收到了这一通知。邮件称，2020年11月10日之后，Heroku将不再支持mLab插件。这将导致任何依赖mLab的应用程序无法运行，并删除存储在mLab上的所有数据。</p><p id="a8fc" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">以下是这封邮件的副本:</p><blockquote class="mf mg mh"><p id="430f" class="kr ks ln kt b ku kv kd kw kx ky kg kz mi lb lc ld mj lf lg lh mk lj lk ll lm im bi translated">亲爱的Heroku客户:</p><p id="12a6" class="kr ks ln kt b ku kv kd kw kx ky kg kz mi lb lc ld mj lf lg lh mk lj lk ll lm im bi translated">我们发现您是以下安装了mLab MongoDB附加组件的应用程序的所有者或合作者。请注意，这可能是部分列表。</p><p id="f8dd" class="kr ks ln kt b ku kv kd kw kx ky kg kz mi lb lc ld mj lf lg lh mk lj lk ll lm im bi translated">弗拉斯克-皮蒙戈</p><p id="6a69" class="kr ks ln kt b ku kv kd kw kx ky kg kz mi lb lc ld mj lf lg lh mk lj lk ll lm im bi translated">mLab团队已选择停止此附加组件。<strong class="kt jd">mLab MongoDB插件将于2020年11月10日从所有Heroku应用中移除</strong>。</p></blockquote><p id="dba1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有许多解决方案可以让我们的软件在云中运行。最简单的是我们将在本文中深入研究的，从Heroku附加组件中分离我们的mLab帐户。我们可以稍后处理迁移，并将写一篇包含一些选项的文章。我们会在准备好的时候更新文章。</p><h1 id="4974" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated">指南:从Heroku分离mLab</h1><p id="792f" class="pw-post-body-paragraph kr ks it kt b ku nd kd kw kx ne kg kz la nf lc ld le ng lg lh li nh lk ll lm im bi translated"><strong class="kt jd">步骤1:登录mLab并进入确认屏幕。先别确认！</strong></p><p id="ab24" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在Heroku上，查看您想要修改的应用程序，然后单击mLab插件。这应该会带你到mLab的网站。单击帐户。在这里你可以找到右上角的“脱离Heroku”按钮。这将使您进入下面看到的协议页面。先别确认！</p><p id="f7f3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">请注意这里的三个要点:</p><ol class=""><li id="c95b" class="ni nj it kt b ku kv kx ky la nk le nl li nm lm nn no np nq bi translated">你仍然需要在2021年1月21日之前迁移到MongoDB atlas。换句话说，这种分离是暂时的，我们将在明年一月迁移。</li><li id="d680" class="ni nj it kt b ku nr kx ns la nt le nu li nv lm nn no np nq bi translated">您的电子邮件地址将成为mLab的管理员帐户，您可以通过电子邮件重置密码来重置您的密码。不幸的是，事实并非如此。在写这篇文章的时候，重置邮件里的URL把你带到了一个非功能性的页面。</li><li id="7434" class="ni nj it kt b ku nr kx ns la nt le nu li nv lm nn no np nq bi translated">其次，当您从Heroku分离时，您的Heroku配置变量可能会被自动删除。<strong class="kt jd">在你完成这个过程之前，</strong>确保你的应用不依赖于任何<code class="fe nw nx ny nz b">MONGO*_URI</code>变量，如果需要的话保存它们。您可能需要重置它们。</li></ol><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi oa"><img src="../Images/6624c621599ef95c1aebd0fa93668b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ehbhMsn0JPbAbVvxFurMJg.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated">协议页面</p></figure><p id="021b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">第二步:从你的Heroku配置变量中获取URI并保存它</strong></p><p id="83ba" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">要检查您的应用程序对<code class="fe nw nx ny nz b">MONGO*_URI</code>变量<strong class="kt jd">，</strong>的使用情况，请转到Heroku.com，然后转到您的应用程序，再转到设置，然后检查您的配置变量。在我们的例子中，我们发现了<code class="fe nw nx ny nz b">MONGODB_URI</code>。然后，我们将变量保存在一个文本文件中，以便与我们的mLab用户名和部署标识符(位于复选框页面的底部)一起妥善保管。将这些数据保存在文本文件中可以作为备份，以防在此过程中丢失。</p><p id="e3f7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是加倍重要的，因为如果你有同样的问题，密码重置我做的，你也可能无法登录到您的mLab管理面板发现URI。您将需要这些信息来保持您的应用程序正常工作，并在将来进行迁移。</p><p id="cd3c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">步骤3:完成mLab的分离，接受条款</strong></p><p id="cc15" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">回到我们在第一步中找到的确认页面。这一次，继续接受条款并确认。</p><p id="5be5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，您的mLab帐户不再与mLab Heroku附加组件相关联。</p><p id="f095" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">单击分离后，可能需要一段时间才能在Heroku端删除配置变量。现在是从我们的Heroku项目中删除附加组件的好时机。</p><p id="5a64" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">不要注销mLab，因为您可能无法重新登录。</p><p id="c460" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">步骤4:删除Heroku端的mLab插件</strong></p><p id="738d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为此，请单击应用下的“配置加载项”。然后单击mLab横幅最右侧的下拉菜单，并选择删除附加组件。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ob"><img src="../Images/b06afaec7927cc226504ec9af5d153b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKoWErYgFIAfG6mLgaN8Ow.png"/></div></div><p class="mb mc gj gh gi md me bd b be z dk translated">从Heroku删除mLab MongoDB</p></figure><p id="c8dc" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">确认附加组件删除并将其移除。</p><p id="2b97" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">步骤5:仔细检查连接字符串在mLab端没有改变，如果它被删除，则获取保存的URI并将其设置为Heroku配置变量</strong></p><p id="82b7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们回到mLab，看看连接字符串在mLab方面是否仍然有效。这可以在home →MongoDB Deployments下看到。选择数据库并查看字符串。它与你保存在文本文件中的匹配吗？如果是这样的话，你不需要做任何事情。如果已经更改，请确保在Heroku config vars下更新该变量。</p><p id="d8a1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">第六步:重新部署应用</strong></p><p id="8872" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">接下来，您将在Heroku上重新部署应用程序。您应该能够通过应用程序访问您的数据库，并通过分离看到持久化的数据。</p><h1 id="183e" class="ml mm it bd mn mo mp mq mr ms mt mu mv ki mw kj mx kl my km mz ko na kp nb nc bi translated"><strong class="ak">大功告成！</strong></h1><p id="9c7f" class="pw-post-body-paragraph kr ks it kt b ku nd kd kw kx ne kg kz la nf lc ld le ng lg lh li nh lk ll lm im bi translated">再一次，这是保持你的数据库在2020年11月10日之后的十分钟快速修复。我们将在后面的文章中进一步研究迁移选项。</p></div></div>    
</body>
</html>