<html>
<head>
<title>Spatial Interpolation With Kernels</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">核空间插值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/spatial-interpolation-with-kernels-cf3616487714?source=collection_archive---------56-----------------------#2020-10-02">https://towardsdatascience.com/spatial-interpolation-with-kernels-cf3616487714?source=collection_archive---------56-----------------------#2020-10-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1c86" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">估算地理区域空气质量的个例研究</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/25c3912c61f2afab67768164c4ab1f57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HmHjIS41Kbi3CHUCBioafw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马丁·桑切斯在<a class="ae ky" href="https://unsplash.com/s/photos/heat-map?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f5f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加州最近火了。实际上是火。火产生烟。有很多。</p><p id="845e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显示不同地区空气质量的热图显然是有用的。构建这样一个热图的建模问题是什么？说真的，创业者都在琢磨这个问题[1]。</p><p id="0b0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有空气质量传感器。但不是所有地方。我们希望通过附近传感器的测量来估计稀疏覆盖区域的空气质量。我们称之为<em class="lv">空间插值</em>。</p><p id="d797" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有测量误差。传感器质量不一。昂贵的传感器更精确，但也更少。所以他们的报道很少。廉价的传感器要丰富得多。然而，不太准确。</p><p id="77aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这些权衡，我们应该结合所有数据(在足够接近的范围内)，而不是选择一些数据。考虑到传感器位置及其变化的误差率。</p><p id="efc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也可能有异常读数。传感器有时会返回奇怪的结果。或者生病，甚至死亡。它们还会产生有偏差的结果，即那些始终不符合要求的结果。</p><p id="a0bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">异常需要检测，以便可以丢弃它们。偏差需要估计，这样才能被纠正。同一传感器频繁出现异常是故障的症状。</p><p id="f0ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些都很有趣，对吧？也很有用。空间插值也适用于温度、风速、降雨量、湿度等。</p><p id="81ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吃吧。</p><p id="5920" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">问题陈述</strong></p><p id="ef4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的传感器位于<em class="lv"> n </em>点(<em class="lv"> x </em> 1、<em class="lv"> y </em> 1)、…、(<em class="lv"> xn </em>、<em class="lv"> yn </em>)。我们将把任何这样的点称为ij。位置<em class="lv"> ij </em>的传感器发出读数<em class="lv"> Sij </em>。我们将此读数视为该位置未知真值的讹误版本。我们试图从这些读数中估计该区域中每一点(<em class="lv"> x </em>，<em class="lv"> y </em>)的<em class="lv"> Txy </em>。</p><p id="e6cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>:假设我们在旧金山湾区有两个传感器。一个在旧金山，另一个在圣何塞。我们感兴趣的是估计两者之间的空气质量。(当然，我们只有两个传感器，所以我们的估计可能不会很大。)</p><p id="d2c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以把这想象成一维空间插值。估计连接旧金山和圣何塞的线路的空气质量。</p><p id="abf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">内核</strong>:现在我们来讨论内核。在每个装有传感器的位置<em class="lv"> ij </em>，我们附加一个内核<em class="lv"> Kij </em>。<em class="lv"> Kij </em>衡量读数<em class="lv"> Sij </em>对<em class="lv"> ij </em>附近位置的影响。这种影响随着距离的增加而减弱。形式上，我们将这个权重表示为<em class="lv"> K </em> (d( <em class="lv"> xy </em>，<em class="lv"> ij </em>))。这里<em class="lv"> d </em> ( <em class="lv"> xy </em>，<em class="lv"> ij </em>)表示<em class="lv"> xy </em>和<em class="lv"> ij </em>之间的距离。K( <em class="lv"> d </em>)随<em class="lv"> d </em>减小，<em class="lv"> K </em> (0)为1。对于<em class="lv"> K </em> ( <em class="lv"> d </em>)的自然选择是e^- <em class="lv"> ad </em>，其中<em class="lv"> a </em>是控制影响随距离衰减的速率的参数。</p><p id="9fc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>:在我们的SF-SJ示例中，假设我们将内核<em class="lv"> K </em> ( <em class="lv"> d </em>)设置为1/(a* <em class="lv"> d </em> +1)，其中<em class="lv"> d </em>的单位是英里。考虑<em class="lv"> a </em> = 1。SF中读数的影响在离SF一英里处为=50%,在离SF两英里处为=25%。</p><p id="4823" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为什么是这个内核函数，为什么<em class="lv"> a </em> =1而不是其他选择？我们很快就会看到，插值对我们在这里做出的决定并不特别敏感。</p><p id="7c90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第一插补器</strong></p><p id="3a7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑任何一点<em class="lv"> xy </em>。考虑在位于<em class="lv"> xy </em>附近的传感器处测量的AQIs { <em class="lv"> Sij </em> }。这些测量值的加权平均值是对<em class="lv"> xy </em>处AQI的良好估计。越靠近<em class="lv"> xy </em>的传感器对估计的影响越大。</p><p id="2267" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更正式地说</p><p id="e994" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">s</em>^<em class="lv">xy</em>=<em class="lv">sum</em>_<em class="lv">ij pij</em>(<em class="lv">xy</em>)<em class="lv">* sij</em></p><p id="3101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在哪里</p><p id="0b60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">pij</em>(<em class="lv">xy</em>)<em class="lv">= K</em>(<em class="lv">d</em>(<em class="lv">ij</em>，<em class="lv">xy</em>)/<em class="lv">sum _ I ' j ' K(d(I ' j '，xy </em>))</p><p id="02d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的<em class="lv"> S </em> ^ <em class="lv"> xy </em>表示以这种方式在<em class="lv"> xy </em>获得的强度估计值。</p><p id="a72b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>:考虑我们的SF-SJ示例，使用我们之前选择的内核函数。假设SF和SJ相距50英里。考虑两者之间的一个点，我们称之为圣马特奥(SM)。我们想从SF和SJ读数中估计SM的AQI，我们将分别取160和180 AQI。(AQI是“空气质量指数”的简称。)</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3636" class="mb mc it lx b gy md me l mf mg">K(SM,SF) = K(SM,SJ) = 1/(25+1)=1/26</span></pre><p id="740c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由此，我们得到</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="6af1" class="mb mc it lx b gy md me l mf mg">pSF(SM) = pSJ(SM) = ½</span></pre><p id="d7c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以我们估计SM的AQI是170，160和180的平均值。</p><p id="1ae7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个例子也揭示了插值对核函数的选择及其参数并不像我们想象的那样敏感。重要的是从核函数值中得到的概率<em class="lv"> pij </em>，而不是这些值本身。只要核函数帮助我们估计<em class="lv">相对</em>对各个附近传感器的读数对插值的影响，我们就很好。</p><p id="c5ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">整合领域知识</strong></p><p id="60ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们对各种传感器有所了解。我们可能知道传感器的价格或品牌。根据这些信息，我们也许能够估计它的错误率。更好的是，错误率可能已经从测试中估计出来了。销售优质传感器的公司倾向于这样做，以突出他们的价值主张。</p><p id="3bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一个简单的启发式扩展<em class="lv"> pij </em>来利用这个知识。</p><p id="c5eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">pij = K</em>(<em class="lv">d</em>(<em class="lv">ij</em>，<em class="lv">xy</em>)*<strong class="lb iu"><em class="lv">wij</em></strong></p><p id="0707" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的<em class="lv"> wij </em>是一个正权重，表示位置<em class="lv"> ij </em>处传感器的质量。更高的价值等同于更高的质量。</p><p id="fcc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样一来，低质量的传感器对^的影响要小于高质量的传感器。也就是说，在附近位置给出相似读数的多个低质量传感器的累积影响就好像有一个具有相似读数的高质量传感器。这是所希望的。</p><p id="d087" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">例</strong>:假设我们设wSF = 2，wSJ = 1。我们对旧金山传感器的信任度是圣何塞传感器的两倍。这将概率修改为pSF(SM) = ⅔，pSJ(SM) = ⅓.因此，我们在SM的AQI估计值约为166，更接近SF的读数。</p><p id="0bb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">应对异常读数</strong></p><p id="f075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">传感器有时会给出异常读数。根据定义，这样的读数可能“超出图表范围”如果不加检查，它们可能会严重扭曲其邻域内的插值。显然，我们应该检测异常读数，并忽略它们。</p><p id="e3ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们将在<em class="lv"> pij </em>中添加一个新术语:</p><p id="ba23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">pij = K</em>(<em class="lv">d</em>(<em class="lv">ij</em>，<em class="lv">xy</em>)*<em class="lv">wij</em>*<strong class="lb iu"><em class="lv">AIJ</em></strong></p><p id="6864" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里<em class="lv"> aij </em>是一个异常折扣权重。如果传感器的读数被认为是正常的，其值接近1，如果被认为是异常的，其值接近0。</p><p id="8b35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">怎么才能估算出<em class="lv"> aij </em>？基本想法很简单。如果大多数邻近的传感器具有相似的读数，并且与<em class="lv"> ij </em>的读数相差很大，则<em class="lv"> ij </em>的读数可能是异常的。</p><p id="2a60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更详细地说，使用前面描述的公式，基于相邻传感器的读数，获得该传感器的<em class="lv"> S </em> ^ <em class="lv"> ij </em>。一定要排除<em class="lv"> ij </em>本身对这个公式的贡献。比较<em class="lv"> S </em> ^ <em class="lv"> ij </em>和<em class="lv"> Sij </em>。如果两者相距甚远，那么<em class="lv"> ij </em>处的读数可能是异常的。</p><p id="efb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到相邻传感器读数的可变性，这可以进一步增强。相邻传感器的读数越相似，该传感器(其读数显著不同)异常的可信度就越高。</p><p id="5970" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有趣的是，这里的建模类似于[3]中描述的建模，特别是去噪图像。在这一点上，这里描述的两层结构很有意思。</p><p id="bb6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>:让我们在SF-SJ示例中添加一个新的传感器，位于SM，两者之间。同样，让我们回到同样信任SF和SJ传感器。</p><p id="63f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设SM的传感器读数为5 AQI，而SF和SJ的读数分别为180和160 AQI。根据SF和SJ读数，SM的AQI估计值为170。170和5很不一样。这就对SM读数提出了质疑。</p><p id="44fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">鉴于此，当从三个传感器估计SF和SJ之间某处的AQI时(比如在Palo Alto ),我们可能想要丢弃SM传感器的读数。</p><p id="5b48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">检测时间变化</strong></p><p id="e79b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">传感器可能在一段时间内一直报告相似的读数，然后突然报告非常不同的读数。出事了。如果附近的传感器没有同时报告突变，则无论发生什么都可能是该传感器本地发生的。</p><p id="3170" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这样的时间信息和空间信息，我们通常可以增加读数异常的推断的可信度。</p><p id="210b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例</strong>:考虑我们在SF、SM和SJ的三个传感器。假设我们在过去5个小时内每小时测量一次他们的读数，结果如下:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c7bb" class="mb mc it lx b gy md me l mf mg">Hour         1   2   3   4   5<br/>SF reading  159 163 161 166 157<br/>SM reading  170 168 174 169   <strong class="lx iu">5<br/></strong>SJ reading  181 178 172 178 182</span></pre><p id="a798" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，通过查看三个传感器在整个持续时间内的读数(不仅仅是在第5小时)，我们可以更有把握地说，粗体显示的读数是异常的。</p><p id="1317" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种时间信息还可以帮助评估传感器是否有偏差。考虑上述例子的一个变体。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8f25" class="mb mc it lx b gy md me l mf mg">Hour         1   2   3   4   5<br/>SF reading  159 163 161 166 157<br/><strong class="lx iu">SM reading  129 121 125 122 124<br/></strong>SJ reading  181 178 172 178 182</span></pre><p id="330c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要么是SM传感器有偏差，要么是SM中确实存在其他问题，导致SM中的读数始终低于SF和SJ中的读数。不管怎样，知道这一点很好。</p><p id="9163" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">延伸阅读</strong></p><ol class=""><li id="111a" class="mh mi it lb b lc ld lf lg li mj lm mk lq ml lu mm mn mo mp bi translated"><a class="ae ky" href="https://support.iqair.com/en/articles/3405643-how-accurate-is-airvisual-s-air-quality-data" rel="noopener ugc nofollow" target="_blank">air visual的空气质量数据有多准确？|空中视觉支持中心</a></li><li id="2fa2" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu mm mn mo mp bi translated"><a class="ae ky" href="http://fatra.cnr.ncsu.edu/~hmitaso/gmslab/papers/mitas_mitasova_1999_2005.pdf" rel="noopener ugc nofollow" target="_blank">空间插值</a></li><li id="285a" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu mm mn mo mp bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/markov-random-fields-and-image-processing-20fb4cf7e10d">马尔可夫随机场和图像处理|作者Arun ja gota | 2020年8月</a></li></ol></div></div>    
</body>
</html>