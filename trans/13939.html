<html>
<head>
<title>Linear Algebra In C++ With XTensor Is Just Like Numpy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有XTensor的C++中的线性代数就像Numpy</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-algebra-in-c-with-xtensor-is-just-like-numpy-1a6b1ee00736?source=collection_archive---------18-----------------------#2020-09-25">https://towardsdatascience.com/linear-algebra-in-c-with-xtensor-is-just-like-numpy-1a6b1ee00736?source=collection_archive---------18-----------------------#2020-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a448" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用张量库快速浏览C++中的代数运算</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e13f0d55305a59bde8c5560d63cd2c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VvE1vu_wUw7apTURZNcjWQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><h1 id="926b" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><blockquote class="lq"><p id="a22c" class="lr ls it bd lt lu lv lw lx ly lz ma dk translated"><a class="ae mb" href="https://github.com/emmettgb/Emmetts-DS-NoteBooks/blob/master/C++/Introduction%20To%20Tensor.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a></p></blockquote><p id="be9c" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk ml mm mn mo mp mq mr ms mt mu mv mw ma im bi translated">对科学计算和数据科学非常重要的一个概念是在给定的编程语言中操作、创建和利用矩阵作为类型的能力。对于Python，数据科学家使用Numpy库，它提供了一种奇妙且易于理解的方法来在Python内部创建和操作矩阵。对于Julia来说，矩阵和向量的概念从语言一开始就包含在内。对于C++，有一个很棒的新兴库叫做XTensor。</p><p id="b709" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">XTensor是一个C++库，它允许程序员使用与Numpy语法相似的矩阵和数组。与Numpy的相似之处是XTensor的真正优势，因为两者之间的转换可以相对容易地完成。为了使用XTensor，您当然需要安装它。幸运的是，对于数据科学家来说，这可以在您的环境中通过Conda包管理器轻松完成</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="8b9c" class="nh kz it nd b gy ni nj l nk nl">conda install -c conda-forge xtensor</span></pre><p id="ffe3" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">或者，如果您使用的是Debian或基于Debian的Linux发行版，可以通过Apt软件包管理器获得XTensor:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="e9ae" class="nh kz it nd b gy ni nj l nk nl">sudo apt-get install xtensor-dev</span></pre><p id="cb33" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">最后但同样重要的是，如果您在FreeBSD或另一个类似Unix的操作系统上，并且有适当的基本构建头文件，您总是可以从源代码构建:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="b6f2" class="nh kz it nd b gy ni nj l nk nl">cmake -DCMAKE_INSTALL_PREFIX=path_to_prefix ..<br/>make install</span></pre><p id="51c7" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">或者，对于Windows用户:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="e64c" class="nh kz it nd b gy ni nj l nk nl">mkdir build<br/>cd build<br/>cmake -G "NMake Makefiles" -DCMAKE_INSTALL_PREFIX=path_to_prefix ..<br/>nmake<br/>nmake install</span></pre></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="6845" class="ky kz it bd la lb nt ld le lf nu lh li jz nv ka lk kc nw kd lm kf nx kg lo lp bi translated">基本矩阵</h1><p id="f302" class="pw-post-body-paragraph mc md it me b mf ny ju mh mi nz jx mk ml oa mn mo mp ob mr ms mt oc mv mw ma im bi translated">如果您是Python和Numpy用户，那么您很幸运使用了XTensor。这里有一个绝对无价的XTensor数字备忘单的链接，你可以用它来应用你的数字熟悉度:</p><div class="od oe gp gr of og"><a href="https://xtensor.readthedocs.io/en/latest/numpy.html" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">从numpy到xtensor - xtensor文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">惰性辅助函数返回张量表达式。返回类型不包含任何值，而是在访问或…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">xtensor.readthedocs.io</p></div></div></div></a></div><p id="efdd" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">对于基于Python的数据科学家和最终用户来说，这将使从Numpy到XTensor的过渡变得极其简单和流畅。安装XTensor后，您可以编译并执行以下代码，以确保头文件现在就在您的机器上:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="b87e" class="nh kz it nd b gy ni nj l nk nl">#include &lt;iostream&gt;<br/>// Base Arrays:<br/>#include "xtensor/xarray.hpp"<br/>// XTensor IO:<br/>#include "xtensor/xio.hpp"<br/>// XTensor View:<br/>#include "xtensor/xview.hpp"<br/>int main()<br/>{<br/>return 0;<br/>}</span></pre><p id="9dde" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">如果编译和运行该代码时什么都没有发生，那么</p><blockquote class="lq"><p id="f97f" class="lr ls it bd lt lu lv lw lx ly lz ma dk translated">恭喜你！</p></blockquote><p id="8ad2" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk ml mm mn mo mp mq mr ms mt mu mv mw ma im bi translated">您的安装成功，XTensor现在在您的机器上可用。如果输出是一个错误，您很可能需要尝试不同的安装方法，或者从源代码构建。当然，需要确保的另一件重要事情是，您处于安装了XTensor的Conda环境中。</p><p id="36d6" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">接下来，我们当然会通过添加我们在那个小测试中添加的内容来开始我们的新代码。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="69df" class="nh kz it nd b gy ni nj l nk nl">#include &lt;iostream&gt;<br/>// Base Arrays:<br/>#include "xtensor/xarray.hpp"<br/>// XTensor IO:<br/>#include "xtensor/xio.hpp"<br/>// XTensor View:<br/>#include "xtensor/xview.hpp"</span></pre><p id="edd4" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">包含这些头文件将给我们一个新的名称空间xt。首先，为了创建一个矩阵，我们将使用xt名称空间中的xarray对象模板。对于这个例子，我们将有一个充满整数的矩阵，所以每当我们创建新对象时，我们将提供“int”参数。我把它命名为array，我们会把一些整数放进去。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="df46" class="nh kz it nd b gy ni nj l nk nl">xt::xarray&lt;int&gt;array<br/>({{500, 500, 300}, {500, 600, 800}})</span></pre><p id="caae" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">有两种不同类型的x传感器矩阵:</p><ul class=""><li id="302c" class="op oq it me b mf mx mi my ml or mp os mt ot ma ou ov ow ox bi translated">xarray设置了<strong class="me iu">动态</strong>维的矩阵。</li><li id="90b7" class="op oq it me b mf oy mi oz ml pa mp pb mt pc ma ou ov ow ox bi translated">x tensor——具有<strong class="me iu">静态</strong>维度集的矩阵。</li></ul><p id="8611" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">接下来，如果我们在笔记本中，那么我们可以简单地输入“array”来显示我们的新矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/5a65daa8d40b82d9773149f9dbf16b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*GZbdk86Yi_p4H-SLaZk7Uw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="de7b" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">或者，如果您正在编译和执行代码，那么您将需要使用cout并将这些代码放入main()函数中。在本例中，我不打算这样做，因为我是在笔记本中工作，但下面是您应该如何构建此代码，例如:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="21da" class="nh kz it nd b gy ni nj l nk nl">#include &lt;iostream&gt;<br/>// Base Arrays:<br/>#include "xtensor/xarray.hpp"<br/>// XTensor IO:<br/>#include "xtensor/xio.hpp"<br/>// XTensor View:<br/>#include "xtensor/xview.hpp"<br/>int main()<br/>{<br/>    xt::xarray&lt;int&gt;array<br/>({{500, 500, 300}, {500, 600, 800}});<br/>    std::cout &lt;&lt; array;<br/>}</span></pre><p id="4efc" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">在某些情况下，你也可以这样做:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="c7da" class="nh kz it nd b gy ni nj l nk nl">std::cout &lt;&lt; array;</span></pre><p id="fd71" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">这就是包含iostream off the bat将派上用场的地方，即使您正在笔记本上工作。</p><p id="10f8" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">我们可以使用shape()函数重塑新数组，它是array对象的子对象。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="01b5" class="nh kz it nd b gy ni nj l nk nl">array.reshape({3, 2})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/9417c871dacf66c2983ce90f67e4356f.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*zsJ8AxvgMPUEn7NLtRS_dQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="e910" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">我们也可以将一个新类型投射到数组的所有dim中。这是很有用的，例如，如果我们想要计算小数部分，但最初创建了一个充满整数的矩阵。我们可以使用cast函数来实现这一点，该函数在xt名称空间中。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="ff52" class="nh kz it nd b gy ni nj l nk nl">xt::cast&lt;double&gt;(array)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/47ca17b53b5fcdba061f26c9abba004b.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*Li4JNldhmgz9sIRfGldC3A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="fef8" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">我们还可以使用所有典型的Numpy初始化器/生成器来创建新矩阵。机器学习中常用的一个非常有用的版本是np.zeroes()。在xtensor中，相当于XT名称空间中的零，这当然是一个从我们的常规xarray继承的对象。注意，它是从xarray而不是xtensor继承的，所以我们新发现的矩阵<strong class="me iu">的维度将是可变的</strong>。</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="d071" class="nh kz it nd b gy ni nj l nk nl">xt::zeros&lt;double&gt;({3, 4})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/11a3a731fa98b55cdd99e71eec6ac4ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*wMAgJGRPVkG4eTjdj7MzeA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="7712" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">这也适用于Numpy中的其他生成器，比如eye、ones和其他许多生成器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/76de6a9a750d6c61da668559635e4525.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*7S6zftOOx2TXd5CwclS7VA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="6f71" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">当然，我们也可以像使用Numpy一样索引数组。一个微小的区别是圆括号用于调用索引，而不是方括号。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/51e0c39c11616be53e90d22147bde145.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*hrAlnLSAHiNRwVt1O5eAMQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="b25c" class="ky kz it bd la lb nt ld le lf nu lh li jz nv ka lk kc nw kd lm kf nx kg lo lp bi translated">操作</h1><p id="e731" class="pw-post-body-paragraph mc md it me b mf ny ju mh mi nz jx mk ml oa mn mo mp ob mr ms mt oc mv mw ma im bi translated">虽然能够访问生成器和创建矩阵是件好事，但是XTensor当然不仅仅是等同于Numpy。我们基本上可以完成Numpy中任何可用的操作，比如将两个矩阵连接在一起:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="b7e8" class="nh kz it nd b gy ni nj l nk nl">// Our second array<br/>xt::xarray&lt;int&gt;arraytwo<br/>({{500, 500, 300}, {500, 600, 800}})</span><span id="9e60" class="nh kz it nd b gy pj nj l nk nl">// Reshape it to fit first array's dimensions<br/>arraytwo.reshape({3, 2})</span><span id="78a2" class="nh kz it nd b gy pj nj l nk nl">// Concatenate it to the first array<br/>xt::concatenate(xtuple(array, arraytwo))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/518b08a70870995961f0b39fe8628356.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*1iCkrY3cTpZaHTrBksKjDw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="f74f" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">我们也可以挤压，例如:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="3c38" class="nh kz it nd b gy ni nj l nk nl">xt::squeeze(array)</span></pre><p id="e2cf" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">我们还可以访问您可能需要对矩阵执行的标准运算，例如求和:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="cc2c" class="nh kz it nd b gy ni nj l nk nl">xt::sum(array, {0, 1})<br/>//      ^^ Array  ^^^ Axis</span></pre><p id="99ef" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">平均:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="e1ba" class="nh kz it nd b gy ni nj l nk nl">xt::mean(array)</span></pre><p id="f066" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">和标准:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="5247" class="nh kz it nd b gy ni nj l nk nl">xt::stddev(array, {0,1})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/5c24b2d25df93e8582e90128b5ffc793.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*ZCrpcYdv1pNsEEQdi0ldeQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="7813" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">此外，我们可以访问线性代数运算，例如点。要访问这些，您需要访问linalg名称空间，它存储在xt名称空间中，如下所示:</p><pre class="kj kk kl km gt nc nd ne nf aw ng bi"><span id="dd84" class="nh kz it nd b gy ni nj l nk nl">xt::linalg::dot(array, arraytwo)</span></pre><p id="dbda" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">为了获得这个名称空间，您可能还需要使用XTensor-blas。</p><div class="od oe gp gr of og"><a href="https://github.com/xtensor-stack/xtensor-blas" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">xtensor-stack/xtensor-blas</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">xtensor-blas是xtensor库的扩展，通过cxxblas和…提供blas和LAPACK库的绑定。</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">github.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ks og"/></div></div></a></div></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><h1 id="53d8" class="ky kz it bd la lb nt ld le lf nu lh li jz nv ka lk kc nw kd lm kf nx kg lo lp bi translated">结论</h1><p id="d2b8" class="pw-post-body-paragraph mc md it me b mf ny ju mh mi nz jx mk ml oa mn mo mp ob mr ms mt oc mv mw ma im bi translated">XTensor是一个非常棒的工具，它将Numpy的易用性和标准化带到了C++的前沿，用于科学计算和处理矩阵。一般来说，C++是一种很好的语言，因为它的可靠性——在这一点上已经有几十年的历史了，并且在它的生命周期中得到了很好的使用。</p><p id="b63b" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw ma im bi translated">此外，我认为XTensor为有兴趣在数据科学和统计应用程序中使用C++的数据科学家创造了一个很好的出口。如果没有别的，XTensor就是一个非常酷的库，它有可能在Python用户和C++用户之间架起一座桥梁。</p></div></div>    
</body>
</html>