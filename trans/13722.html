<html>
<head>
<title>Use Python to Automate Your Excel Work!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python来自动化您的Excel工作！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-python-to-automate-your-excel-work-c16b6e5ab58e?source=collection_archive---------12-----------------------#2020-09-21">https://towardsdatascience.com/use-python-to-automate-your-excel-work-c16b6e5ab58e?source=collection_archive---------12-----------------------#2020-09-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2be5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自动化那些讨厌的Excel报表！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b86f55911e30a79786aeebd9cc52c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1zsmhrYt2c7tUSZw"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡洛斯·穆扎</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ccf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，你将学习如何自动化一些常见的、乏味的Excel任务。</p><p id="3d71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很有可能，你无法逃避Excel(而且你不完全逃避可能是好的！).学习如何使使用应用程序更容易，以及如何自动化重复的任务，是一项重要的技能！</p><p id="9eda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在接下来的几分钟里，您将学习如何组合来自多个工作表的数据，基于这些数据创建汇总统计数据，以及创建有用的可视化效果。<strong class="lb iu">几行代码就搞定了！</strong></p><p id="251d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从导入熊猫库开始。如果你不熟悉这个图书馆，可以看看我在YouTube上的<a class="ae ky" href="https://www.youtube.com/playlist?list=PLYt6YwKmonu0x8oI_tLT_vaOFzRU64ptK" rel="noopener ugc nofollow" target="_blank">熊猫介绍系列</a>！</p><p id="796c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经为本教程创建了一个文件，其中包括三个工作表，涵盖了三个不同月份的数据。你可以在这里下载文件<a class="ae ky" href="https://github.com/datagy/mediumdata/raw/master/exceltopandas.xlsx" rel="noopener ugc nofollow" target="_blank"/>，或者使用URL将文件直接导入熊猫数据框架。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="d20d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第一段代码中，您已经导入了Pandas库(并给它分配了别名<code class="fe lx ly lz ma b">pd</code>)。然后，您将Excel文件分配给一个Excel file对象。最后，您打印出了文件中所有工作表的名称，但是使用了<code class="fe lx ly lz ma b">.sheet_names</code>属性。</p><p id="cca3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在您已经知道文件中包含哪些工作表，让我们实际创建所有数据的数据框架。</p><p id="2242" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这种方法而不是列出工作表名称的最大好处是，随着月份被添加到文件中，列表不需要修改！</p><p id="b14c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先创建一个dataframe对象，并添加额外的数据文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="93d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，首先创建了一个空的dataframe对象。然后使用for循环遍历Excel工作簿中的每个工作表，生成一个包含数据的临时dataframe(跳过前三行)，并将每一项追加到dataframe <code class="fe lx ly lz ma b">df</code>。最后，您使用<code class="fe lx ly lz ma b">.head()</code>方法打印了前五个记录。</p><p id="47ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者，如果您想将数据组合在一行中，您可以编写以下代码，该代码使用熊猫<code class="fe lx ly lz ma b">.concat()</code>函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h1 id="6914" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">分析您的数据</h1><p id="a2ab" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">现在你已经合并了数据，让我们对此进行一些分析。</p><p id="db7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设，您被要求查看不同月份按类型和地区划分的每笔销售的总价值。</p><p id="9e7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用Pandas `.pivot_table()`函数来实现这一点，我在这个YouTube视频中已经详细介绍过了:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my lw l"/></div></figure><p id="e895" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个熊猫数据透视表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="d915" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面，您已经创建了一个包含两个索引(月份和类型)的数据透视表。月份是使用熊猫生成的。<code class="fe lx ly lz ma b">dt</code>访问器，以整数形式返回月份，其中1等于一月。这些柱子是由区域组成的。</p><h1 id="f53d" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">可视化您的数据</h1><p id="cca0" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">最后，让我们创建一些数据的可视化。</p><p id="46c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也许您想要创建一个图表，用堆叠的柱形图来显示数据。</p><p id="386f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用Pandas中的matplotlib集成来生成这个图表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="32ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会生成下图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bbfd7ec1d250a4b1d2b5312f3f3187a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*HiZZnqR6Hhn2pSo1UVhe3w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Nik Piepenbreier</p></figure><h1 id="c792" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论</h1><p id="021c" class="pw-post-body-paragraph kz la it lb b lc mt ju le lf mu jx lh li mv lk ll lm mw lo lp lq mx ls lt lu im bi translated">在这篇文章中，您学习了如何从多个Excel工作表中的数据创建一个熊猫数据框架。您学习了如何快速分析数据并创建数据的可视化。</p><p id="8785" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看我的其他帖子或者在<a class="ae ky" href="https://www.youtube.com/channel/UCm7fT9_IdCDbeBXjAwL9IIg?view_as=subscriber" rel="noopener ugc nofollow" target="_blank"> YouTube </a>上订阅我的常用技巧！</p></div></div>    
</body>
</html>