<html>
<head>
<title>Forecasting web traffic with Python and Google Analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和Google Analytics预测网络流量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/forecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f?source=collection_archive---------15-----------------------#2020-10-15">https://towardsdatascience.com/forecasting-web-traffic-with-python-and-google-analytics-fb066659ae8f?source=collection_archive---------15-----------------------#2020-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="d43d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="aec2" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">向业务经理展示未来:一步一步地创建web流量的时间序列预测，绘制成GIF图。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/329bab774eb4db78a90646b53b70b907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j8LjgYr1r1xPrJkr.gif"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">最终的结果是:一个美丽的图表描绘了我的12月份的交通会有多糟糕。</p></figure><p id="a20c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">SolarPanelCompany决定雇佣他们的第一个数据科学家:我。我对从零开始构建一切的挑战感到非常兴奋。我的目标是获得第一场速战速决的胜利，向车队展示我的价值。</p><p id="5636" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">第一周，一位营销经理惊慌失措地来到你的办公桌前:“你看！”他指着笔记本电脑的屏幕说，“在谷歌分析上，我看到我们的流量在上个月下降了！你的预测数据学习材料能做些什么来拯救企业吗？”。</p><p id="4244" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">“好吧，”我想“这不是真正的问题。”所以我换了一种说法:“你是在要求我证明我们是有下降趋势，还是只是季节性效应？”。他茫然地凝视着。“你是在问我，我们什么时候能希望它回升？—是的！正是如此！我明天和市场总监有个会议。我让你在那上面工作！”</p><p id="bfee" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果这种情况发生在你身上，或者如果你想创建自己的网站流量的可视化预测，你就在正确的页面上！下面是<strong class="lg ja">的一步一步的指导</strong>，根据你的谷歌分析数据预测你网站的访客数量，作为奖励，让它成为商业人士喜欢的GIF。简而言之，我们将使用Prophet包创建一个时间序列模型。</p><p id="ad4b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">本指南包括3个步骤:</p><ol class=""><li id="f36f" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz mf mg mh mi bi translated">用Python调用您的Google Analytics API数据</li><li id="8283" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">使用Prophet构建您的模型</li><li id="fdc8" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz mf mg mh mi bi translated">制作你的预测的GIF图(因为它很有趣)</li></ol><h1 id="4cad" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">1.连接到您的Google Analytics API</h1><p id="83bf" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated"><em class="nl">这一步需要:谷歌分析帐户的管理员权限</em>。<em class="nl">如果你没有，你可以用一个</em> <a class="ae nm" href="https://support.google.com/analytics/answer/6367342?hl=en" rel="noopener ugc nofollow" target="_blank"> <em class="nl">演示谷歌分析账号</em> </a> <em class="nl">然后简单的导入csv格式的数据。</em></p><p id="a38c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这不是一个容易的步骤，但是Google创建了很多文档来帮助你完成。我将在这里提出一步一步的指南来获取流量。如果你对其他指标感兴趣(比如目标、浏览量等。)你需要看一看内容广泛的官方<a class="ae nm" href="https://developers.google.com/analytics/devguides/config/mgmt/v3" rel="noopener ugc nofollow" target="_blank"> Google的管理API文档</a>。</p><p id="aea8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们导入我们的包:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="579d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">第一个包裹是我们永远的朋友熊猫。最后两个包来自Google，允许您调用Google Analytics API。</p><p id="2a1c" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你还没有访问Google API的权限，你需要在你这边激活它。下面的视频解释了这样做的所有步骤。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="np no l"/></div></figure><p id="07a3" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">所以让我们开始开心吧。我们的第一段代码是调用键和右视图。请注意，您可以在谷歌分析账户的“设置&gt;查看”中找到查看次数</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="27bd" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在上面的部分中，第一行没有改变，但是第二行和第三行必须用你自己的访问键来改变。</p><p id="197e" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在我们将使用Google API文档中的代码。如果你不完全理解，没关系:如果你适当地修改了上面的段落，复制粘贴就可以了。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="c587" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们可以看到上面提到的“度量标准”。在我这边，因为我想做一个时间序列，所以我只关心流量维度，但也导入页面视图供以后分析。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="ebaf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这些代码块是谷歌为愿意获取他们数据的人提供的标准代码。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/814220ba5d98cd0feaaf6db4e76765be.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/0*yUzRcnnvt7EspsaM.png"/></div></figure><p id="7c43" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">好了，现在你的数据在数据框中了。恭喜你！你成功调用了Google API，第一步就实现了。</p><h1 id="3102" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">2.预测你的网络流量</h1><p id="fa4c" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">所以我们有数据。这已经花了一些时间，但现在是有趣的部分:预测SolarPanelCompany的网络流量。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/9b767a444c2da30ae427f8f702e7c254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LrmEWlpZ5BWCIm6N"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">迈克尔·威尔森在<a class="ae nm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="94fe" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了开始预测谷歌分析流量，我们需要开始导入我们的包。我们将在这里使用脸书的先知。这个伟大的工具非常容易使用，因为它使用了与软件包scikit相同的语法。脸书自己使用他们所有的时间序列预测，无论是网络流量或其他。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="9cdb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">让我们先探索一下，并检查我们的数据是如何做的。一个简单的情节就完成了任务。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/e17e6de59a1b3ae0d678af54ee0b84f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MuxDZPabURgxBA6R.png"/></div></div></figure><p id="717b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们已经可以在数据中看到很强的季节性。的确，这是关于太阳能电池板的数据。因此，季节性是可以预料的:随着阳光越来越强烈，它从2月到7月平稳生长。然后，到了八月，人们知道享受阳光已经太晚了，队伍就下降了。</p><p id="1317" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">回到我们的代码，让我们看看先知说了什么。脸书的先知要求你改变你的两个专栏的名字:</p><ul class=""><li id="e246" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz nt mg mh mi bi translated"><strong class="lg ja">值</strong>列需要称为<strong class="lg ja">‘y’</strong></li><li id="2788" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated"><strong class="lg ja">时间戳</strong>需要是<strong class="lg ja">‘ds’</strong>并且是一个日期时间变量。</li></ul><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/3b4fa0424ee389a0c5651dffcc22f1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/0*3qRrUtXh_1i7tuJ8.png"/></div></figure><h2 id="08cb" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.1缺失数据</h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/e89769db2d17279af2eb560f69e06f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jAgBb6RcE6KEfbfa.png"/></div></div></figure><p id="7a9f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">尽管脸书声称Prophet对缺失数据和异常值有很好的抵抗力，但去掉它们也未尝不可。尤其是在我们这种情况下:假设网站的跟踪崩溃了一两天，你不希望这个影响。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8970" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你有一些丢失的数据，就像我一样，你将把它们输入到一个新的数据框架中。您还需要给它赋值。我个人用的是7天均线。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8ac7" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">然后我们把框架连接在一起，放上一个盖子和一个地板。楼层是“0 ”,因为你知道你不会有负流量。另一方面，cap纯粹是“人在回路中”的工作，所以基于你的良好判断。这个顶部和底部将有助于创建模型的边界。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><h2 id="3f28" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.2 EDA</h2><p id="9369" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">那会很快，因为我们没有那么多的功能；只有观察本身的价值。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/4490292cd22e3c55fa5e0cf93411341c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lZyAojcmeLcxTm0J.png"/></div></div></figure><p id="d627" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们看到，丢失的数据中不再有离群值，我们可以继续保留。</p><h2 id="07fb" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.3预测我们的网络流量:培训</h2><p id="33ca" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">用Prophet训练模型真的很简单。该团队复制了scikit软件包所使用的机制:。fit()和。预测()</p><h2 id="2112" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">创建模型</h2><p id="32e4" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">所以首先我们创建模型。有许多变化可以添加。下面我会解释我的选择。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><ul class=""><li id="1428" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz nt mg mh mi bi translated">Changepoint_prior_scale:应对欠拟合。增加使趋势更加灵活(因此在视觉上扩大了终端漏斗)</li><li id="e9ef" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated">Changepoint_range:默认情况下，Prophet只改变前80%数据的趋势斜率。我在这里将它设置为0.9，以包含90%的数据。</li><li id="c2a1" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated">季节性模式= '乘法'作为参数，因为季节性的影响越来越大。我们清楚地看到，我们的业务正在呈倍增趋势增长，而不是呈线性增长。</li><li id="ddd5" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated">每年.季节性= 20。它是10，但我想要更多。这个数字代表<a class="ae nm" href="https://en.wikipedia.org/wiki/Fourier_transform" rel="noopener ugc nofollow" target="_blank">傅立叶级数</a>。</li></ul><p id="3b33" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">如果你想在不同的标准下改编你的模型，我推荐看看<a class="ae nm" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书的先知Github。</a></p><h2 id="d2ef" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.3.2构建预测时间戳集合。</h2><p id="1b6d" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">到目前为止，我们已经根据以前的数据训练了我们的模型。为了预测未来的web流量，我们首先需要创建未来的时间戳。在这里我将创造60天，也就是未来的两个月。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><h2 id="00c8" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.3.3预测未来</h2><p id="a33a" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">开始了。在接下来的两行中，我们将通过Google Analytics预测我们的网站流量。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/1f43c7e3aed11a5c6a7baace196dc946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5PWGA7VS1KL9-a0y.png"/></div></div></figure><p id="9c2a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">瞧！11月和12月可以看到我的交通跳崖之美。</p><h2 id="0b19" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">分析组件</h2><p id="e331" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">现在Prophet有了另一个伟大的功能:它可以在一个图形中显示不同的组件。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/f0cc5b585a968a1bcf23bcf1a3f1b4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*XZgiH1LP0puoxOQH.png"/></div></figure><p id="a88f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">已经有了一些有趣的结论:</p><ul class=""><li id="fbeb" class="ma mb iq lg b lh li lk ll ln mc lr md lv me lz nt mg mh mi bi translated">总趋势是下降。要知道，我的增长是成倍增长的，因此2020年秋季将趋势大幅向下推。</li><li id="3ded" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated">每周趋势:周四到周六是最糟糕的时刻。如果我想做广告，周日是个好时机。</li><li id="7a56" class="ma mb iq lg b lh mj lk mk ln ml lr mm lv mn lz nt mg mh mi bi translated">年度:非常有见地。我们可以在八月一日看到顶峰。另外，我们可以看到圣诞节搜索并没有带来多少收入。所以硕果累累的时期是4月到10月底。</li></ul><p id="0ebf" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这已经是一些很好的见解，我可以反馈给营销经理。我不仅可以建议他们应该花更多的广告预算，而且我还可以确认，是的，看到我们的流量下降是正常的。而且要到二月份才会恢复。</p><p id="39eb" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">同样有趣的是将总体趋势与数据进行比较。我们可以在这里看到趋势的变化。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/a78bd455bce4d0eaadbd6ad1e1c34365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/0*JyYEfScCvHg2GrD_.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">红线横线是趋势。红色虚线是趋势改变的点。</p></figure><h2 id="4310" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">2.4测试模型</h2><p id="bffa" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">太好了，现在我们已经完成了预测谷歌分析流量的大部分工作。但作为严谨的数据科学家，我们也想测试模型。</p><p id="834a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">时间序列的测试与传统模型略有不同。我们需要使用滚动窗口:滚动窗口意味着使用60天的数据，并评估它对未来30天数据的预测能力。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/d11fc5bea5c487397662cb7e48307211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/0*3H08dtqseals746m.png"/></div></figure><p id="bfce" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">例如，在上面的图表中，红色部分用于预测绿色部分。在交叉验证后，红色部分将向前移动，以适应下一个60天，并再次预测下一个30天。这就是滚动窗户的概念。关于滚动窗口的文章<a class="ae nm" href="https://medium.com/making-sense-of-data/time-series-next-value-prediction-using-regression-over-a-rolling-window-228f0acae363" rel="noopener">已经够多了，所以我就不再赘述了。</a></p><p id="b23a" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">就编码而言，它是这样写:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fc525716eefebddd95641e0c0c2d6c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/0*2FoixgNYn_PpzU1h.png"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b6bb0377b3eff4b1737697120654586c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*_ujBxwRxzgqOenBB.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">RMSE在地平线上密谋</p></figure><p id="288f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们在这里。我们现在有了白天地平线上的RMSE。我们可以看到，视野越远，误差越大。</p><p id="148d" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">现在为了你自己的工作，你可以玩模型的超参数来试着把这个推下去。因为我们使用这个图表是为了营销目的，而不是为了工程目的，这样的RMSE已经足够好了。</p><h2 id="f8cd" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">3.形象化</h2><p id="df4c" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">所以在第一部分，我获取了我的数据，在第二部分，我创建了模型。现在，是时候让它变得更好，让营销经理和CMO对此感到兴奋了。人类真理:有令人愉快的东西看会使它更有价值，所以是时候让我的工作有价值了。</p><p id="3889" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">纯粹为了吸引注意力，我创造了一个GIF图片。这种动画真的可以吸引人们的注意力，从而引起利益相关者对我的项目的兴趣。</p><h2 id="c929" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">3.1数据绘图</h2><p id="56cd" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">让我们从导入包开始:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="bbb8" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们希望它朗朗上口，所以我们将直接从一个时尚的元素开始:深色背景。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi on"><img src="../Images/ef90b8f4a055b717e50252fffa0622e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/0*k8Ll2a04Ie-jAA3o.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">黑色背景上的网络流量数据</p></figure><p id="ae53" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">非常好的效果。现在让我们画出我们的预测。</p><h2 id="5b6f" class="nv mp iq bd mq nw nx dn mu ny nz dp my ln oa ob na lr oc od nc lv oe of ne iw bi translated">3.2将预测绘制成GIF</h2><p id="e5a7" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">我们首先需要创建一个包含数据和预测的数据框架。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="0edc" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">好了，这是容易的部分，现在我们将有大块来创建我们的GIF。要在这里继续，一定要安装PillowWriter或Imagemagick，它们可以将你的图像转换成GIF格式。</p><p id="8f3f" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">经典的<em class="nl"> fig，ax </em> matplotlib操作的不同之处在于，我们需要创建函数来为图表制作动画。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/bb0ef33e2ffb87e54a5335d1bc63d383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CHhERBPfiUJJDJo1.gif"/></div></div></figure><p id="7114" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">ax.clear()操作超级重要。如果你像我一样没有把它放进去，动画会在之前的图形上创建一个新的图形。不可怕，除非..每个新图都有一种新的颜色。最终的动画将是一个快速闪烁的图形，每四分之一秒改变一次颜色。足以杀死癫痫患者。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oo"><img src="../Images/5c1745ec1d5e5263e05ddd99d008700c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ff1IvQNkks2hLWk4.gif"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">一个艺术上的失败:我丢失了90%的数据，创建了一个“派对”图，让人看了恶心。</p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="3459" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">请注意，如果您在笔记本中工作，您将不会在图表中看到动画。你必须下载创建的“animation_video.gif”才能真正看到动画。</p><p id="284b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">你在这里，为你的长时间工作感到自豪，并准备好用你令人惊叹的动画震撼舞台。你现在可以知道你的企业的未来是什么样子了！</p><h1 id="16c0" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">结论</h1><p id="6104" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">从Google Analytics API获取数据后，我可以在GIF中绘制未来网络流量的时间序列。</p><p id="6f8b" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这个视觉上吸引人的结果帮助营销经理和CMO明白，是的，如果流量在冬天下降是正常的。是的，它会在春天重新生长，那时太阳会回来，人们会考虑太阳能投资。</p><p id="3313" class="pw-post-body-paragraph le lf iq lg b lh li ka lj lk ll kd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">猜猜哪家公司开始加大对其数据团队的投资。</p></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><h1 id="cbe0" class="mo mp iq bd mq mr ow mt mu mv ox mx my kf oy kg na ki oz kj nc kl pa km ne nf bi translated">更进一步</h1><p id="58ec" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">你的业务经理不明白预测是如何工作的，也不明白你是如何工作的？你可能对<a class="ae nm" href="https://medium.com/@arthur.s.moreau/how-to-explain-predictive-modeling-to-business-managers-ed9a0b3a9ebf" rel="noopener">如何向经理们解释预测建模</a>感兴趣</p><h1 id="be20" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">附录</h1><p id="6cf8" class="pw-post-body-paragraph le lf iq lg b lh ng ka lj lk nh kd lm ln ni lp lq lr nj lt lu lv nk lx ly lz ij bi translated">Jupyter笔记本:<a class="ae nm" href="https://github.com/ArthurMro/Prediction_marketing/blob/master/Prophet_GA_cs_info.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Arthur mro/Prediction _ marketing/blob/master/Prophet _ GA _ cs _ info . ipynb</a></p></div></div>    
</body>
</html>