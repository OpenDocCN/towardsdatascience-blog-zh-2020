<html>
<head>
<title>Performance Metrics: Receiver Operating Characteristic (ROC)- Area Under Curve (AUC)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">性能指标:受试者操作特征(ROC)-曲线下面积(AUC)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/performance-metrics-receiver-operating-characteristic-roc-area-under-curve-auc-79d6d5b0b977?source=collection_archive---------36-----------------------#2020-09-21">https://towardsdatascience.com/performance-metrics-receiver-operating-characteristic-roc-area-under-curve-auc-79d6d5b0b977?source=collection_archive---------36-----------------------#2020-09-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b922" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过示例了解ROC-AUC性能指标</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d1212aa1365670b6be079484b920e970.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvX5H2x_urnYKNS6_PCUnA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自Unsplash的Issac Smith</p></figure><h2 id="7c79" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">受试者工作特征曲线</h2><p id="d980" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">接收器工作特性(ROC)曲线明确用于二元分类。但是，它可以扩展为多类分类。</p><p id="274b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在二元分类中，当一个模型给出概率得分作为输出时，我们用0.5作为最简单模型的阈值。如果查询点的概率大于0.5，则模型会将其分类为第1类(即肯定的)，否则为第0类(否定的)。为了衡量模型的性能，我们可以使用准确度、混淆矩阵、精确度、召回率和F1分数。</p><p id="dbe7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">这里出现的一个问题是，使用0.5作为阈值会给每个模型带来显著的结果吗？</strong></p><p id="d071" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">否</strong></p><p id="1938" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">选择产生显著结果的阈值取决于具体问题。例如，在癌症检测问题中，如果我们保持低阈值，模型将会预测更多的人为阳性。此外，如果我们设置一个高得令人难以置信的阈值，就有可能遗漏实际患者。</p><p id="700a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">我们应该如何决定合适的阈值？</strong></p><p id="1804" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> ROC </strong>是一种可以给出最佳阈值的技术。</p><p id="166f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">让我们举一个微不足道的例子</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ab9bf2c1e50193d8ef5e9f8e45fec4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*3xfFkRl4MM9v3XUDLqsvVQ.png"/></div></figure><h2 id="0964" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步伐</h2><ol class=""><li id="5107" class="mu mv it lx b ly lz mb mc li mw lm mx lq my mn mz na nb nc bi translated">将唯一概率分数(按降序)作为阈值，并预测类别标签。如果我们有k个唯一的概率得分，就会有k个阈值。</li><li id="ccdb" class="mu mv it lx b ly nd mb ne li nf lm ng lq nh mn mz na nb nc bi translated">对于每个阈值，我们测量所有查询点的类别标签。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/e90eb05d5d997994c575db66887345d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqZikpkrt6WnogCzVClHsQ.png"/></div></div></figure><p id="5728" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">对于每个预测，我们计算真阳性率(TPR)和假阳性率(FPR)。<br/>我们来看混淆矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6e99244ba21e3755f83f9ddbce2311c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*UsOWxGhFMhkfkFZivPFlpQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">混淆矩阵</p></figure><p id="d0f5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">真阳性率衡量实际阳性总数中的真阳性(真阳性(TP) +假阴性(FN))。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/48821cee9bbe57707fc77caa6a1ce898.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*aqbh4isAUSC7NqFPyIhtaw.png"/></div></figure><p id="3354" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">假阴性率衡量实际阴性总数中的假阳性(真阴性(TN) +假阳性(FP))。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/f9cd4bce208718306b8b9eba47304f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*1M0ISCcQrtPdck770foyCw.png"/></div></figure><p id="9fa3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果我们有k个唯一的概率得分，我们将有k个不同的预测。因此，我们将有k对(TPR，FPR)。<br/>在上面的例子中，我们有5个预测，所以会有5个TPR，FPR对。</p><p id="3a1f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测1(阈值= 0.95) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/1e615b96bc43b8802d85f16e9504d896.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*vIVyQxpYBpIdDHipBtr4KA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测1的混淆矩阵(阈值= 0.95)</p></figure><p id="4e0d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">TP R1 = 1/(1+2)= 1/3<br/>FP R1 = 0/2 = 0</p><p id="e3f1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测2(阈值=0.92) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a6b43e282521ea40f7a53ae6426e585c.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*Vm-jZFMzwJRwrcMdJdtMAw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测2的混淆矩阵(阈值= 0.92)</p></figure><p id="82f5" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">TPR 2 = 2/(2+1)= 2/3<br/>FPR 2 = 0/2 = 0</p><p id="1147" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测3(阈值= 0.7) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9aec80c02018bea708336751d5300c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*ydF5bk-F-F66Kd9bBW_j3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测3的混淆矩阵(阈值= 0.7)</p></figure><p id="7aa4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">TPR3 = 3/3 = 1 <br/> FPR3 = 0/2 = 0</p><p id="8c45" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测4(阈值= 0.6) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/64a765231843e8a36208de8e8f10a82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*fxnYGxmRJjxiBIUhlH4ORA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测4的混淆矩阵(阈值= 0.6)</p></figure><p id="0aa4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">TP R4 = 3/3 = 1<br/>FP R4 = 1/(1+1)= 1/2</p><p id="95bf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu">预测5(阈值= 0.46) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9858b46fc44006c89ca5711da4494866.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*HPBGDf8b_zkvtTeaqCnNhw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">预测5的混淆矩阵(阈值= 0.46)</p></figure><p id="ecdb" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">TPR5 = 3/3 = 1 <br/> FPR5 = 2/2 = 1</p><p id="f060" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">3.绘制FPR对TPR曲线，y轴为TPR，x轴为FPR。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/f67ffa203938dc87ab6b182b892abb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aG2SZOBrCY8ALe0LNVYLfw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有5个(FPR，TPR)对的ROC曲线。括号中的数字表示预测数。</p></figure><p id="4eb1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">蓝线显示了随机模型，这意味着模型给出了随机输出(无法对查询点进行分类)。<strong class="lx iu">适当的阈值将是TPR最大的点</strong> <strong class="lx iu">和FPR最小的点</strong>，因为我们希望真阳性和真阴性多于假阳性和假阴性。</p><p id="dd51" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">对于我们的示例，最佳阈值将是<strong class="lx iu">预测3，</strong>，即<strong class="lx iu"> 0.70 </strong>。</p><h2 id="73d3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">罗马纪元</h2><p id="dea5" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">TPR-FPR曲线下的面积将给出模型有效性的概念。AUC分数越高，模型越好。<strong class="lx iu"> AUC分数用于比较不同的模型</strong>。</p><p id="0983" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">AUC的最大值可以是1。<strong class="lx iu">为什么？</strong></p><p id="8fed" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">因为TPR和FPR的最大值分别是1。所以，最大面积是1。</p><p id="b640" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">分类器正确地预测了这两个类别。在上面的例子中，我们有一个完美的分类器，因为橙色曲线下的面积是1。</p><p id="1293" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">如果<strong class="lx iu"> AUC =0.5 </strong>我们可以推断出什么？</p><p id="de12" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这意味着分类器不能将两个类分开。该模型给出随机输出。</p><p id="a5da" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">从<strong class="lx iu"> AUC &lt; 0.5 </strong>可以推断出什么？</p><p id="26ad" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这意味着模型预测了相反的值，即实际的阳性标签被预测为阴性，反之亦然。</p><p id="3842" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">下图显示了两个模型。<strong class="lx iu">我们如何决定哪一个更好？</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/255f4bf7b0bef43516affbd73d0dd7e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5hLRkAfX46CygTvMkUOgA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两个模型的ROC曲线</p></figure><p id="8256" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">模型2的曲线下面积(AUC)大于模型1。因此，<strong class="lx iu">模型2是比模型1 </strong>更好的分类器。</p><p id="8436" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">AUC分数的一个<strong class="lx iu">限制</strong>是它们对不平衡的数据<strong class="lx iu">敏感。</strong>如果模型是哑的，AUC分数可以很高。</p><h1 id="bf34" class="nt la it bd lb nu nv nw le nx ny nz lh jz oa ka ll kc ob kd lp kf oc kg lt od bi translated">结论</h1><p id="f259" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><strong class="lx iu">接收器工作特性(ROC) </strong>曲线用于确定模型的适当阈值，其给出概率得分作为二进制分类的输出。<strong class="lx iu">曲线下面积(AUC) </strong>分数用于比较不同模型。但是，它们会受到不平衡数据集的影响。</p><p id="900f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">感谢阅读！</p></div></div>    
</body>
</html>