<html>
<head>
<title>Difference between apply() and transform() in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas中应用()和转换()的区别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/difference-between-apply-and-transform-in-pandas-242e5cf32705?source=collection_archive---------4-----------------------#2020-09-21">https://towardsdatascience.com/difference-between-apply-and-transform-in-pandas-242e5cf32705?source=collection_archive---------4-----------------------#2020-09-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d808" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一些最有用的熊猫把戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7e28fdad640a13f4c3b4681d226789b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vy28P0nC0D3GWOTkIIhj_w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@billow926?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">翻滚926 </a>上的<a class="ae ky" href="https://unsplash.com/s/photos/kongfu-panda?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">退溅</a></p></figure><p id="e760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas是一个令人惊叹的库，它包含大量用于操作数据的内置函数。在寻找应用自定义函数时，您可能会对以下两种选择感到困惑:</p><ul class=""><li id="39f6" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe me mf mg mh b">apply(<em class="mi">func, axis=0</em>)</code>:沿数据帧的一个轴调用函数<code class="fe me mf mg mh b"><em class="mi">func</em></code>。它返回沿给定轴应用<code class="fe me mf mg mh b"><em class="mi">func</em></code>的结果。</li><li id="09e0" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated"><code class="fe me mf mg mh b">transform(<em class="mi">func, axis=0</em>)</code>:调用<strong class="lb iu"> <em class="mi"> self </em> </strong>上的函数<code class="fe me mf mg mh b"><em class="mi">func</em></code>，产生一个带有变换值的数据帧。它返回一个与<strong class="lb iu"> <em class="mi">自身</em> </strong>长度相同的DataFrame。</li></ul><p id="d2d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们采用相同的论点<code class="fe me mf mg mh b"><em class="mi">func</em></code>和<code class="fe me mf mg mh b">axis</code>。两者都沿着给定数据帧的轴调用<code class="fe me mf mg mh b"><em class="mi">func</em></code>。那么区别在哪里呢？你如何选择一个而不是另一个？</p><p id="f4c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将介绍以下用法，并讨论它们的区别:</p><ol class=""><li id="a652" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mo mb mc md bi translated">操纵值</li><li id="633e" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu mo mb mc md bi translated">结合<code class="fe me mf mg mh b">groupby()</code>结果</li></ol><p id="1e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">源代码请查看我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/014-pandas-apply-vs-transform/pandas-apply-vs-transform.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>。</p><p id="61b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不熟悉以下文章，请查看它们:</p><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/when-to-use-pandas-transform-function-df8861aa0dcf"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd iu gy z fp mx fr fs my fu fw is bi translated">何时使用Pandas transform()函数</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">一些最有用的熊猫把戏</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ks ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/introduction-to-pandas-apply-applymap-and-map-5d3e044e93ff"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd iu gy z fp mx fr fs my fu fw is bi translated">熊猫应用简介，应用地图和地图</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">一个直观的熊猫教程，介绍如何使用apply()和applymap()应用一个函数，以及如何替换值…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nh l nd ne nf nb ng ks ms"/></div></div></a></div></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="1cb0" class="np nq it bd nr ns nt nu nv nw nx ny nz jz oa ka ob kc oc kd od kf oe kg of og bi translated">1.操纵值</h1><p id="f5e3" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都可以用来操作数值。让我们借助一些例子来看看它们是如何工作的。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="193d" class="oq nq it mh b gy or os l ot ou">df = pd.DataFrame({'A': [1,2,3], 'B': [10,20,30] })</span><span id="7ef8" class="oq nq it mh b gy ov os l ot ou"><strong class="mh iu">def plus_10(x):<br/>    return x+10</strong></span></pre><h2 id="90fd" class="oq nq it bd nr ow ox dn nv oy oz dp nz li pa pb ob lm pc pd od lq pe pf of pg bi translated">对于整个数据帧</h2><p id="d25a" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都可用于操作整个数据帧。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="43d1" class="oq nq it mh b gy or os l ot ou">df.<strong class="mh iu">apply(plus_10)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/47d2f8914dfc5ccd3ef24e9c01b9d99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*6u4fx12DTHwpwWxW0P-NYg.png"/></div></figure><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="6c08" class="oq nq it mh b gy or os l ot ou">df.<strong class="mh iu">transform(plus_10)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/47d2f8914dfc5ccd3ef24e9c01b9d99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*6u4fx12DTHwpwWxW0P-NYg.png"/></div></figure><p id="b020" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都支持lambda表达式，下面是lambda的等价表达式:</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="7f2e" class="oq nq it mh b gy or os l ot ou">df.<strong class="mh iu">apply(lambda x: x+10)</strong></span><span id="326e" class="oq nq it mh b gy ov os l ot ou">df.<strong class="mh iu">transform(lambda x: x+10)</strong></span></pre><h2 id="ef72" class="oq nq it bd nr ow ox dn nv oy oz dp nz li pa pb ob lm pc pd od lq pe pf of pg bi translated"><strong class="ak">为单列</strong></h2><p id="3a2c" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都可以用于操作单个列</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="028e" class="oq nq it mh b gy or os l ot ou">df['B_ap'] = df['B'].<strong class="mh iu">apply(plus_10)</strong><br/># The lambda equivalent<br/>df['B_ap'] = df['B'].<strong class="mh iu">apply(lambda x: x+10)</strong></span><span id="8290" class="oq nq it mh b gy ov os l ot ou">df['B_tr'] = df['B'].<strong class="mh iu">transform(plus_10)</strong><br/># The lambda equivalent<br/>df['B_tr'] = df['B'].<strong class="mh iu">transform(lambda x: x+10)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/733b698c018060a375a34e9c9a53fdc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*fRS5bJ5bojndHz_M9fnnyQ.png"/></div></figure><h2 id="24f7" class="oq nq it bd nr ow ox dn nv oy oz dp nz li pa pb ob lm pc pd od lq pe pf of pg bi translated">有什么区别？</h2><p id="10ae" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">以下是三个主要区别</p><ul class=""><li id="fa58" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe me mf mg mh b">transform()</code>(1)使用函数、字符串函数、函数列表和字典。但是，<code class="fe me mf mg mh b">apply()</code>只允许与函数一起使用。</li><li id="f737" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated">②<code class="fe me mf mg mh b">transform()</code>不能产生聚合结果。</li><li id="e907" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated">(3) <code class="fe me mf mg mh b">apply()</code>一次处理多个系列。但是，<code class="fe me mf mg mh b">transform()</code>一次只允许处理单个系列。</li></ul><p id="9b58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们借助一些例子来看看它们。</p><p id="4b48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> (1) </strong> <code class="fe me mf mg mh b"><strong class="lb iu">transform()</strong></code> <strong class="lb iu">作用于函数，一个字符串函数，一个函数列表，一个字典。但是，</strong> <code class="fe me mf mg mh b"><strong class="lb iu">apply()</strong></code> <strong class="lb iu">只允许有一个功能。</strong></p><p id="8b44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于<code class="fe me mf mg mh b">transform()</code>，我们可以将任何有效的熊猫字符串函数传递给<code class="fe me mf mg mh b">func</code></p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="aa07" class="oq nq it mh b gy or os l ot ou">df.transform(<strong class="mh iu">'sqrt'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/9b068a0a9ca2748db033dc61d174e73a.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*K1yptPw_uaC9arprwvyvYg.png"/></div></figure><p id="79c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">func</code>可以是函数列表，例如NumPy中的<code class="fe me mf mg mh b">sqrt</code>和<code class="fe me mf mg mh b">exp</code>:</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="297d" class="oq nq it mh b gy or os l ot ou">df.transform(<strong class="mh iu">[np.sqrt, np.exp]</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/373eaf066588ec6b08cd3c75abf10908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*QlWmP2KFJnmMQo-0bTNkQg.png"/></div></figure><p id="cdcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">func</code>可以是轴标签的字典- &gt;函数。例如</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="0510" class="oq nq it mh b gy or os l ot ou">df.transform(<strong class="mh iu">{<br/>    'A': np.sqrt,<br/>    'B': np.exp,<br/>}</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/fcbf92390edab255656a7d53f3f98cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*pjpxHxl99xv5_cfUQE9iqA.png"/></div></figure><p id="f56f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> (2) </strong> <code class="fe me mf mg mh b"><strong class="lb iu">transform()</strong></code> <strong class="lb iu">不能产生聚合结果。</strong></p><p id="7e19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe me mf mg mh b">apply()</code>来产生聚合结果，例如，总和</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="8a1c" class="oq nq it mh b gy or os l ot ou">df.<strong class="mh iu">apply(lambda x:x.sum())</strong></span><span id="4f71" class="oq nq it mh b gy ov os l ot ou">A     6<br/>B    60<br/>dtype: int64</span></pre><p id="7d2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当我们试图用<code class="fe me mf mg mh b">transform()</code>做同样的事情时，我们将得到一个<strong class="lb iu">值错误</strong>。我们遇到这个问题是因为<code class="fe me mf mg mh b">transform()</code>的输出必须是与<strong class="lb iu"> <em class="mi">自身</em> </strong>长度相同的数据帧。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="26dc" class="oq nq it mh b gy or os l ot ou">df.<strong class="mh iu">transform(lambda x:x.sum())</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/ea5987648d03be4ac9e790305a8237cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guSBIMRP7qJn5ADG8lKfnw.png"/></div></div></figure><p id="93a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> (3) </strong> <code class="fe me mf mg mh b"><strong class="lb iu">apply()</strong></code> <strong class="lb iu">一次处理多个系列的作品。但是，</strong> <code class="fe me mf mg mh b"><strong class="lb iu">transform()</strong></code> <strong class="lb iu">一次只允许处理单个系列。</strong></p><p id="2a00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示这一点，让我们创建一个一次处理2个系列的函数。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="0624" class="oq nq it mh b gy or os l ot ou">def subtract_two(x):<br/>    return x['B'] - x['A']</span></pre><p id="02e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>与<code class="fe me mf mg mh b">subtract_two</code>和<code class="fe me mf mg mh b">axis=1</code>完美配合</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="0db3" class="oq nq it mh b gy or os l ot ou">df.apply(<strong class="mh iu">subtract_two, axis=1</strong>)</span><span id="75cf" class="oq nq it mh b gy ov os l ot ou">0     9<br/>1    18<br/>2    27<br/>dtype: int64</span></pre><p id="e09c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当我们试图用<code class="fe me mf mg mh b">transform()</code>做同样的事情时，我们得到了一个<strong class="lb iu">值错误</strong>。这是因为<code class="fe me mf mg mh b">transform()</code> <strong class="lb iu">一次只允许处理一个系列。</strong></p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="967d" class="oq nq it mh b gy or os l ot ou"># Getting error when trying the same with transform<br/>df.<strong class="mh iu">transform(subtract_two, axis=1)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/252c9d24e0823351a9b7e85af82f029d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1b61kvijmR2EMj7K11axYg.png"/></div></div></figure><p id="5e4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当使用lambda表达式时，我们会得到相同的结果</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="2b96" class="oq nq it mh b gy or os l ot ou"># It is working<br/>df.apply(<strong class="mh iu">lambda x: x['B'] - x['A'], axis=1</strong>)</span><span id="ac1e" class="oq nq it mh b gy ov os l ot ou"># Getting same error<br/>df.transform(<strong class="mh iu">lambda x: x['B'] - x['A'], axis=1</strong>)</span></pre><h1 id="22f5" class="np nq it bd nr ns po nu nv nw pp ny nz jz pq ka ob kc pr kd od kf ps kg of og bi translated">2.结合<code class="fe me mf mg mh b">groupby()</code></h1><p id="cf32" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都可以与<code class="fe me mf mg mh b">groupby()</code>配合使用。而且事实上，这是<code class="fe me mf mg mh b">transform()</code>最引人注目的用法之一。更多详情，请查看以下文章中的<strong class="lb iu">“结合</strong> <code class="fe me mf mg mh b"><strong class="lb iu">groupby()</strong></code> <strong class="lb iu">结果”</strong>:</p><div class="mp mq gp gr mr ms"><a rel="noopener follow" target="_blank" href="/when-to-use-pandas-transform-function-df8861aa0dcf"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd iu gy z fp mx fr fs my fu fw is bi translated">何时使用Pandas transform()函数</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">一些最有用的熊猫把戏</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ks ms"/></div></div></a></div><p id="47d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是与<code class="fe me mf mg mh b">groupby()</code>结合使用时的两个区别</p><ul class=""><li id="abfb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">(1) <code class="fe me mf mg mh b">transform()</code>返回与输入长度相同的数据帧</li><li id="8e90" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated">(2) <code class="fe me mf mg mh b"> apply()</code>一次处理多个系列。但是，<code class="fe me mf mg mh b">transform()</code>一次只允许处理单个系列。</li></ul><p id="5d91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个数据框架，并通过一些示例来展示其区别</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="7d0f" class="oq nq it mh b gy or os l ot ou">df = pd.DataFrame({<br/>    'key': ['a','b','c'] * 4,<br/>    'A': np.arange(12),<br/>    'B': [1,2,3] * 4,<br/>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/b5742af5ce886c16545afe4d243fd104.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*CSm8EFrEtfKg7wTD1AOuog.png"/></div></figure><p id="05cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上例中，可以通过<strong class="lb iu"> <em class="mi">键</em> </strong>将数据分成三组。</p><p id="54bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> (1) </strong> <code class="fe me mf mg mh b"><strong class="lb iu">transform()</strong></code> <strong class="lb iu">返回一个与输入</strong>长度相同的序列</p><p id="b2f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示这一点，让我们创建一个函数来产生一个聚合结果。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="5c55" class="oq nq it mh b gy or os l ot ou"><strong class="mh iu"># Aggregating the sum of the given Series<br/>def group_sum(x):<br/>    return x.sum()</strong></span></pre><p id="42f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于<code class="fe me mf mg mh b">apply()</code>，它为每组返回一个值，输出形状为<code class="fe me mf mg mh b">(num_of_groups, 1)</code>。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="23cf" class="oq nq it mh b gy or os l ot ou">gr_data_ap = df.groupby('key')['A']<strong class="mh iu">.apply(group_sum)</strong><br/>gr_data_ap</span><span id="e9b2" class="oq nq it mh b gy ov os l ot ou"><strong class="mh iu">key<br/>a     9<br/>b    12<br/>c    15</strong><br/>Name: A, dtype: int64</span></pre><p id="6a09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于<code class="fe me mf mg mh b">transform()</code>，它返回一个与给定数据帧长度相同的序列，输出形状为<code class="fe me mf mg mh b">(len(df), 1)</code></p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="da02" class="oq nq it mh b gy or os l ot ou">gr_data_tr = df.groupby('key')['A']<strong class="mh iu">.transform(group_sum)</strong><br/>gr_data_tr</span><span id="8a43" class="oq nq it mh b gy ov os l ot ou"><strong class="mh iu">0     9<br/>1    12<br/>2    15<br/>3     9<br/>4    12<br/>5    15<br/>6     9<br/>7    12<br/>8    15</strong><br/>Name: A, dtype: int64</span></pre><p id="18f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> (2) </strong> <code class="fe me mf mg mh b"><strong class="lb iu">apply()</strong></code> <strong class="lb iu">一次处理多个系列。但是</strong> <code class="fe me mf mg mh b"><strong class="lb iu">transform()</strong></code> <strong class="lb iu">一次只允许处理单个系列。</strong></p><p id="2b88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这和我们在<strong class="lb iu"> 1中提到的区别是一样的。操作值</strong>，我们只是不需要在一个<code class="fe me mf mg mh b">groupby()</code>结果上指定参数<code class="fe me mf mg mh b">axis</code>。</p><p id="0542" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示这一点，让我们创建一个一次处理2个系列的函数。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="9ddd" class="oq nq it mh b gy or os l ot ou">def subtract_two(x):<br/>    return x['B'] - x['A']</span></pre><p id="9ad7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe me mf mg mh b">apply()</code>一次处理多个系列。</p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="27af" class="oq nq it mh b gy or os l ot ou">df.groupby('key')<strong class="mh iu">.apply(subtract_two)</strong></span><span id="c88f" class="oq nq it mh b gy ov os l ot ou"><strong class="mh iu">key   <br/>a    0    1<br/>     3   -2<br/>     6   -5<br/>b    1    1<br/>     4   -2<br/>     7   -5<br/>c    2    1<br/>     5   -2<br/>     8   -5</strong><br/>dtype: int64</span></pre><p id="a35a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当我们用<code class="fe me mf mg mh b">transform()</code>尝试同样的方法时，我们得到了一个<strong class="lb iu">键错误</strong></p><pre class="kj kk kl km gt om mh on oo aw op bi"><span id="4eae" class="oq nq it mh b gy or os l ot ou">df.groupby('key')<strong class="mh iu">.transform(subtract_two)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/d414679970ebefa54b2e883da3c6c4ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*acT0JXRcYES0z5iWC6qULw.png"/></div></div></figure><h1 id="792c" class="np nq it bd nr ns po nu nv nw pp ny nz jz pq ka ob kc pr kd od kf ps kg of og bi translated">摘要</h1><p id="3029" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">最后，这里是一个总结</p><p id="cd00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于操作值，<code class="fe me mf mg mh b">apply()</code>和<code class="fe me mf mg mh b">transform()</code>都可以用来操作整个数据帧或任何特定的列。但是有三个不同之处</p><ol class=""><li id="8327" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mo mb mc md bi translated"><code class="fe me mf mg mh b">transform()</code>可以接受一个函数、一个字符串函数、一个函数列表和一个字典。然而，<code class="fe me mf mg mh b">apply()</code>只允许一个函数。</li><li id="e7ee" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu mo mb mc md bi translated"><code class="fe me mf mg mh b">transform()</code>无法产生汇总结果</li><li id="ddf0" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu mo mb mc md bi translated"><code class="fe me mf mg mh b">apply()</code>一次处理多个系列。但是，<code class="fe me mf mg mh b">transform()</code>一次只允许处理单个系列。</li></ol><p id="3aa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用于与<code class="fe me mf mg mh b">groupby()</code>一起工作</p><ol class=""><li id="77ab" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu mo mb mc md bi translated"><code class="fe me mf mg mh b">transform()</code>返回与输入长度相同的序列</li><li id="a4dc" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu mo mb mc md bi translated"><code class="fe me mf mg mh b">apply()</code>一次处理多个系列。但是，<code class="fe me mf mg mh b">transform()</code>一次只允许处理单个系列。</li></ol><h1 id="8afa" class="np nq it bd nr ns po nu nv nw pp ny nz jz pq ka ob kc pr kd od kf ps kg of og bi translated">好了</h1><p id="58d3" class="pw-post-body-paragraph kz la it lb b lc oh ju le lf oi jx lh li oj lk ll lm ok lo lp lq ol ls lt lu im bi translated">感谢阅读。</p><p id="b010" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请在我的Github 上查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/014-pandas-apply-vs-transform/pandas-apply-vs-transform.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本的源代码。</a></p><p id="5b4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对机器学习的实用方面感兴趣，请继续关注。</p><h2 id="d70a" class="oq nq it bd nr ow ox dn nv oy oz dp nz li pa pb ob lm pc pd od lq pe pf of pg bi translated">你可能会对我的其他一些熊猫文章感兴趣:</h2><ul class=""><li id="c27c" class="lv lw it lb b lc oh lf oi li pv lm pw lq px lu ma mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/when-to-use-pandas-transform-function-df8861aa0dcf">何时使用熊猫变换()函数</a></li><li id="94c0" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac" rel="noopener">使用熊猫方法链接提高代码可读性</a></li><li id="6ca9" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/working-with-datetime-in-pandas-dataframe-663f7af6c587">在Pandas数据帧中处理日期时间</a></li><li id="d64f" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3" rel="noopener">熊猫阅读_csv()你应该知道的招数</a></li><li id="2850" class="lv lw it lb b lc mj lf mk li ml lm mm lq mn lu ma mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e">你应该知道的用Pandas read_csv() </a>解析日期列的4个技巧</li></ul><p id="f306" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多可以从我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github </a>中找到</p></div></div>    
</body>
</html>