<html>
<head>
<title>How To Prepare Your Data for Your Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何为机器学习模型准备数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-prepare-your-data-for-your-machine-learning-model-b4c9fd4e7ea?source=collection_archive---------18-----------------------#2020-09-22">https://towardsdatascience.com/how-to-prepare-your-data-for-your-machine-learning-model-b4c9fd4e7ea?source=collection_archive---------18-----------------------#2020-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5f4e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数据准备分步指南</h2></div><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="ab gu cl kn"><img src="../Images/69c660379a02398c5323abd0d0dc1379.png" data-original-src="https://miro.medium.com/v2/format:webp/1*8gzZb15V9UrNxvsRqeisRQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">由故事创建的数据向量—<a class="ae ku" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">www.freepik.com</a></p></figure><h1 id="4d5a" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">目录</h1><ol class=""><li id="99ec" class="ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">介绍</li><li id="29ce" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">什么是数据准备</li><li id="f9d9" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">探索性数据分析</li><li id="dcc2" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">数据预处理</li><li id="3368" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">数据分割</li></ol></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="9144" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">介绍</h1><p id="3ffd" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">在我们进入这个话题之前，我想澄清一点，数据准备没有严格的流程。准备一组数据的方式很可能与准备另一组数据的方式不同。因此，本指南旨在提供一个总体指南，供您在准备任何特定数据集时参考。</p><p id="d6f7" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">在我们进入指南之前，我应该先回顾一下什么是数据准备…</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="8e08" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">什么是数据准备？</h1><p id="e2ab" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">数据准备是机器学习生命周期中数据收集之后的步骤，它是清理和转换您收集的原始数据的过程。通过这样做，在对数据进行分析和建模时，您会轻松得多。</p><p id="f2b9" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">我将在本文中介绍数据准备的三个主要部分:</p><ol class=""><li id="d0da" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma mb mc md me bi translated">探索性数据分析</li><li id="bbe2" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">数据预处理</li><li id="928e" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated">数据分割</li></ol></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ff74" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">1.探索性数据分析</h1><p id="f826" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">探索性数据分析，简称EDA，听起来就是探索你的数据。在这一步中，您只是简单地了解您正在处理的数据。在现实世界中，数据集不像Kaggle数据集那样干净或直观。</p><p id="8b56" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">您对正在处理的数据探索和理解得越多，数据预处理就越容易。</p><p id="49a3" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">以下是您在此步骤中应该考虑的事项列表:</p><h2 id="1ce6" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征和目标变量</h2><p id="b7a9" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">确定什么是特征(输入)变量，什么是目标变量。不要担心确定什么是<strong class="lp iu">最终</strong>输入变量，但要确保你能识别这两种类型的变量。</p><h2 id="9c27" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">数据类型</h2><p id="7dda" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">弄清楚你在处理什么类型的数据。它们是绝对的，数字的，还是都不是？这对于目标变量尤其重要，因为数据类型将缩小您可能想要使用的机器学习模型的范围。像<strong class="lp iu"> df.describe() </strong>和<strong class="lp iu"> df.dtypes </strong>这样的熊猫函数在这里很有用。</p><h2 id="80cd" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">检查异常值</h2><p id="737b" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">一个<strong class="lp iu">异常值</strong>是一个明显不同于其他观察值的数据点。在这一步中，您需要识别异常值，并尝试理解它们出现在数据中的原因。根据它们出现在数据中的原因，您可以决定将其从数据集中移除或保留。有几种方法可以识别异常值:</p><ol class=""><li id="f1d9" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma mb mc md me bi translated"><strong class="lp iu"> Z值/标准偏差</strong>:如果我们知道一个数据集中99.7%的数据位于三个标准偏差之内，那么我们可以计算一个标准偏差的大小，乘以3，并确定超出该范围的数据点。同样，我们可以计算给定点的z分数，如果它等于+/- 3，那么它就是异常值。<em class="od">注意:使用这种方法时需要考虑一些意外情况；数据必须是正态分布的，这不适用于小数据集，并且太多异常值的存在会影响z值。</em></li><li id="fa73" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated"><strong class="lp iu">四分位距(IQR) </strong> : IQR，用于构建箱线图的概念，也可用于识别异常值。IQR等于第三个四分位数和第一个四分位数之差。然后，如果一个点小于Q1-1.5 * IRQ或大于Q3 + 1.5*IQR，则可以确定该点是否为异常值。这达到大约2.698个标准偏差。</li></ol><h2 id="22f6" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">提问</h2><p id="5e10" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">毫无疑问，你很可能会对你正在处理的数据有疑问，<strong class="lp iu">尤其是</strong>对于你领域知识之外的数据集。例如，Kaggle有一个关于NFL分析和伤病的比赛，我必须做一些研究，了解不同的位置是什么，以及他们的功能对团队有什么作用。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="35a9" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">2.数据预处理</h1><p id="f744" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">一旦您理解了您的数据，作为一名数据科学家，您的大部分时间都花在这一步上，即数据预处理。这是你花时间操纵数据，以便它可以被正确建模的时候。就像我之前说的，没有通用的方法来解决这个问题。然而，有一些重要的事情你应该考虑，我们将在下面讨论。</p><h2 id="16d6" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征插补</h2><p id="6025" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">特征插补是填补缺失值的过程。这很重要，因为当数据集中有缺失数据时，大多数机器学习模型都不起作用。</p><p id="1b9d" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">我想写这个指南的主要原因之一就是为了这个步骤。许多文章说你应该默认用平均值填充缺失值或者简单地删除行，而<strong class="lp iu">这不一定是真的</strong>。</p><p id="a651" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">理想情况下，您希望选择最有意义的方法—例如，如果您正在对人们的年龄和收入进行建模，那么一个14岁的孩子获得全国平均工资就没有意义。</p><p id="1519" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">总的来说，有几种方法可以处理缺失值:</p><ul class=""><li id="14a1" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma oe mc md me bi translated"><strong class="lp iu">单值插补</strong>:用列的平均值、中值或众数替换缺失值</li><li id="466f" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><strong class="lp iu">多值插补:</strong>对有缺失数据的要素进行建模，并用模型发现的内容输入缺失数据。</li><li id="37e2" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><strong class="lp iu">K-最近邻:</strong>用另一个相似样本的值填充数据</li><li id="477d" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><strong class="lp iu">删除该行:</strong>这不是一种插补技术，但当样本量非常大时，如果你能负担得起，这种方法也是可行的。</li><li id="2a33" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated">其他包括:随机插补、移动窗口、最频繁等…</li></ul><h2 id="9532" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征编码</h2><p id="04da" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">特征编码是将值(即字符串)转化为数字的过程。这是因为机器学习模型要求所有值都是数字。</p><p id="9c8b" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">有几种方法可以解决这个问题:</p><ol class=""><li id="08c4" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma mb mc md me bi translated"><strong class="lp iu">标签编码:</strong>标签编码只是将一个特征的非数值转换成数值，不管这个特征是不是序数。例如，如果名为car_colour的要素具有红色、绿色和蓝色的不同值，那么标注编码会将这些值分别转换为1、2和3。使用这种方法时要小心，因为虽然有些ML模型能够理解编码，但有些却不能。</li><li id="284c" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated"><strong class="lp iu">一热编码(又名。get_dummies): </strong>一种热编码的工作原理是为给定特征的每个非数值创建一个二进制特征(1，0)。再次使用上面的例子，如果我们有一个名为car_colour的特征，那么一个热编码将创建三个名为car_colour_red、car_colour_green、car_colour_blue的特征，并且将有一个1或0来指示它是否存在。</li></ol><h2 id="966f" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征标准化</h2><p id="ea64" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">当数值处于不同的尺度时，例如，以厘米为单位的身高和以磅为单位的体重，大多数机器学习算法都表现不佳。k-最近邻算法是不同比例的要素不能很好工作的主要例子。因此，规范化或标准化数据有助于解决这个问题。</p><ul class=""><li id="4243" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma oe mc md me bi translated"><strong class="lp iu">特征标准化</strong>重新调整数值，使其在[0，1]/的范围内</li><li id="f191" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><strong class="lp iu">特征标准化</strong>重新调整数据，使平均值为0，标准差为1。</li></ul><h2 id="b8ec" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征工程</h2><p id="8202" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">特征工程是将原始数据转化为更好地代表人们试图解决的潜在问题的特征的过程。这一步没有具体的方法，但你可以考虑以下几点:</p><ul class=""><li id="60ef" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma oe mc md me bi translated">转换日期时间变量以仅提取星期几、月份等…</li><li id="e4ea" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated">为变量创建容器或桶。(例如，对于高度变量，可以有100-149厘米、150-199厘米、200-249厘米等。)</li><li id="1e3e" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated">组合多个要素和/或值以创建一个新要素和/或值。例如，泰坦尼克号挑战最准确的模型之一设计了一个新的变量，称为“是女人还是孩子”，如果这个人是女人或孩子，这个变量为真，否则为假。</li></ul><h2 id="4908" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特征选择</h2><p id="4d6c" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">接下来是要素选择，即选择数据集最相关/最有价值的要素。我喜欢使用一些方法来帮助您选择功能:</p><ul class=""><li id="170b" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma oe mc md me bi translated"><strong class="lp iu">特性重要性:</strong>像random forests或XGBoost这样的算法允许您确定哪些特性在预测目标变量的值时是最“重要”的。通过快速创建其中一个模型并进行特征重要性分析，您将了解哪些变量比其他变量更有用。</li><li id="c2ce" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><strong class="lp iu">降维</strong>:最常见的降维技术之一，主成分分析(PCA)取大量特征，利用线性代数将其降维为较少的特征。</li></ul><h2 id="1b23" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">处理数据失衡</h2><p id="96b9" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">你要考虑的另一件事是数据不平衡。例如，如果一个类别有5，000个示例(例如，非欺诈性的)，但另一个类别只有50个示例(例如，欺诈性的)，那么您需要考虑以下几件事情之一:</p><ul class=""><li id="a872" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma oe mc md me bi translated">收集更多的数据——这总是对你有利的，但是通常是不可能的或者太贵了。</li><li id="6b07" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated">您可以使用scikit-learn-contrib Python包对数据进行过采样或欠采样。</li></ul></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="2edd" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">3.数据分割</h1><p id="7b74" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">最后是分割你的数据。我将给出一个非常通用的框架，你可以在这里使用，这是普遍同意的。</p><p id="34a5" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">通常，您会希望将数据分成三组:</p><ol class=""><li id="9154" class="ln lo it lp b lq nj ls nk lu no lw np ly nq ma mb mc md me bi translated"><strong class="lp iu">训练集</strong>(70–80%):这是模型学习的内容</li><li id="50ac" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated"><strong class="lp iu">验证集</strong>(10–15%):模型的超参数在这个集上进行调整</li><li id="c635" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma mb mc md me bi translated"><strong class="lp iu">测试集</strong>(10–15%):最后，在此基础上评估模型的最终性能。如果你已经准备好了正确的数据，测试集<strong class="lp iu">的结果应该</strong>给出一个模型在真实世界中表现的很好的指示。</li></ol></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="0fa4" class="kv kw it bd kx ky mr la lb lc ms le lf jz mt ka lh kc mu kd lj kf mv kg ll lm bi translated">感谢阅读！</h1><p id="2987" class="pw-post-body-paragraph mw mx it lp b lq lr ju my ls lt jx mz lu na nb nc lw nd ne nf ly ng nh ni ma im bi translated">我希望你已经从中学到了一些东西。通过阅读本文，您现在应该对数据准备有了一个大致的了解。需要考虑的事情很多，但是有这样的资源提醒你总是有帮助的。</p><p id="b79c" class="pw-post-body-paragraph mw mx it lp b lq nj ju my ls nk jx mz lu nl nb nc lw nm ne nf ly nn nh ni ma im bi translated">如果您遵循这些步骤并牢记这些事情，您一定会更好地准备您的数据，并且您最终能够开发一个更准确的模型！</p><h2 id="fb3c" class="nr kw it bd kx ns nt dn lb nu nv dp lf lu nw nx lh lw ny nz lj ly oa ob ll oc bi translated">特伦斯·申</h2><ul class=""><li id="ff20" class="ln lo it lp b lq lr ls lt lu lv lw lx ly lz ma oe mc md me bi translated"><em class="od">查看</em> <a class="ae ku" href="https://docs.google.com/document/d/1UV6pvCi9du37cYAcKNtuj-2rkCfbt7kBJieYhSRuwHw/edit#heading=h.m63uwvt9w358" rel="noopener ugc nofollow" target="_blank"> <em class="od">我的免费数据科学资源</em> </a> <em class="od">每周都有新资料！</em></li><li id="c4a9" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><em class="od">如果你喜欢这个，</em> <a class="ae ku" href="https://medium.com/@terenceshin" rel="noopener"> <em class="od">跟我上媒</em> </a> <em class="od">了解更多</em></li><li id="7f41" class="ln lo it lp b lq mf ls mg lu mh lw mi ly mj ma oe mc md me bi translated"><em class="od">我们连线上</em><a class="ae ku" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank"><em class="od">LinkedIn</em></a></li></ul></div></div>    
</body>
</html>