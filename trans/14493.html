<html>
<head>
<title>DASK: A Guide to Process Large Datasets using Parallelization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">DASK:使用并行化处理大型数据集的指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dask-a-guide-to-process-large-datasets-using-parallelization-c5554889abdb?source=collection_archive---------26-----------------------#2020-10-06">https://towardsdatascience.com/dask-a-guide-to-process-large-datasets-using-parallelization-c5554889abdb?source=collection_archive---------26-----------------------#2020-10-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4e66" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/making-sense-of-big-data" rel="noopener" target="_blank">理解大数据</a>、<a class="ae ep" href="https://medium.com/towards-artificial-intelligence/how-to-build-a-data-science-portfolio-that-can-get-you-a-job-9f8d113739b3" rel="noopener">数据科学</a>、<a class="ae ep" rel="noopener" target="_blank" href="/how-to-learn-data-science-from-beginners-to-masters-in-just-1-year-my-personal-experience-6152bedd8157">机器学习</a></h2><div class=""/><div class=""><h2 id="e934" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">Numpy、Pandas和Scikit-Learn框架中大数据并行计算的简单数据分析解决方案</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/ab0c64f08345be0d3cc8a9b9874d25fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhuwE1Emvy-N66NPjgiCCg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">托马斯·詹森在<a class="ae lh" href="https://unsplash.com/s/photos/motherboard?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="a272" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">介绍</h2><p id="8ad1" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">如果您正在处理大量数据，并且您担心Pandas的数据框架无法加载它或者NumPy数组卡在中间，您甚至需要一个更好的并行化解决方案来处理您的数据和训练机器学习模型，那么dask为这个问题提供了一个解决方案。在深入研究之前，让我们看看dask到底是什么？</p><p id="07fd" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">在潜入深海之前，你听说过懒惰装载吗？了解Vaex如何主导加载大型数据集的市场。</p><div class="nb nc gp gr nd ne"><a rel="noopener follow" target="_blank" href="/now-load-huge-datasets-within-a-second-using-lazy-computation-in-python-2698bdb02250"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">现在，使用惰性计算在一秒钟内加载巨大的数据集😴用Python？</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">厌倦了用熊猫加载数据集…了解Vaex如何帮助在几秒钟内加载大量数据…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">towardsdatascience.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns lb ne"/></div></div></a></div></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="f88c" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">dask是什么？</h2><p id="e40b" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated"><a class="ae lh" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> Dask </a>是一个极其高效的开源项目，它使用现有的Python Apis和知识结构，使得在Numpy、Pandas、Scikit-learn之间进行修改成为它们的Dask支持的对等物变得简单。此外，Dask的调度程序可以扩展到千节点集群，其算法在全球<strong class="mf jd"> </strong>内<strong class="mf jd"/><strong class="mf jd"/>最重要的<strong class="mf jd">台</strong>号<strong class="mf jd"> </strong>超级计算机上进行测试。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/7e8529afb759bb938ac081923172d8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MXtMfGFLYzdcPZuY9z7UcQ.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:使用<a class="ae lh" href="https://dask.org/" rel="noopener ugc nofollow" target="_blank"> Dask并行化</a>扩展到集群</p></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="fbbc" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">装置</h2><p id="cd53" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">quality是预装在您的Anaconda中的，但是对于pip，您可以使用以下命令获得完整的版本:</p><p id="a96c" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">Dask的Conda安装:</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="97fa" class="li lj it oc b gy og oh l oi oj">!conda install dask</span></pre><p id="2cae" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">Dask的pip安装:</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="c10a" class="li lj it oc b gy og oh l oi oj">!pip install “dask[complete]”</span></pre></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="d740" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">达斯克是做什么的？</h2><p id="0022" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">Dask有助于并行化阵列、数据帧和机器学习，以处理大量数据，例如:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/df69367ff0345ba926d9e7f0ace251fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JdxatB1UnVb78k_J5S3w6g.jpeg"/></div></div></figure><p id="a496" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd">数组</strong>:并行化的Numpy</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/f3cd64eb0cb8b89cb1c20035fe744f5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XY10ZtpoC4hyd7L6-gOL6g.png"/></div></div></figure><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="23cf" class="li lj it oc b gy og oh l oi oj"># Arrays implement the Numpy API</span><span id="fcce" class="li lj it oc b gy om oh l oi oj">import dask.array as da<br/>x = da.random.random(size=(10000, 10000), chunks=(1000, 1000))<br/>x + x.T - x.mean(axis=0)</span></pre><p id="470f" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd">数据帧</strong>:平行熊猫</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi on"><img src="../Images/7fc562d3ec904c7ae349b688aa87668a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*-CNF7Q08WzZrhGVv7DxE_A.png"/></div></figure><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="090f" class="li lj it oc b gy og oh l oi oj"># Dataframes implement the Pandas API</span><span id="7e74" class="li lj it oc b gy om oh l oi oj">import dask.dataframe as dd<br/>df = dd.read_csv('financial_dataset.csv')<br/>df.groupby(df.amount).balance.sum()</span></pre><p id="535c" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd">机器</strong> <strong class="mf jd">学习</strong>:并行化Scikit-Learn</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/9576a826bd339587211e79c9d938272e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSMwcKnMGOVwpFYBCuGdXQ.png"/></div></div></figure><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="2792" class="li lj it oc b gy og oh l oi oj"># Dask-ML implements the Scikit-Learn API</span><span id="895d" class="li lj it oc b gy om oh l oi oj">from dask_ml.linear_model import LogisticRegression<br/>lr = LogisticRegression()<br/>lr.fit(train, test)</span></pre></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="a1e2" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">Dask中的数据帧</h2><p id="b525" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">大多数Dask API与Pandas API非常相似，因此您可以使用非常相似的命令直接使用Dusk中Pandas的数据帧。要生成一个离散的数据帧，您可以像以前调用Pandas一样简单地调用`<strong class="mf jd"> read_csv() </strong>`方法，或者轻松地将Pandas数据帧转换成Dask数据帧。</p><pre class="ks kt ku kv gt ob oc od oe aw of bi"><span id="9a52" class="li lj it oc b gy og oh l oi oj">import dask.dataframe as ddf<br/>dd = ddf.from_pandas(df, npartitions=N)</span></pre></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="a154" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">基准数据框架:熊猫vs达斯克</h2><p id="c24a" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">对于下面的基准测试，所用的机器具有标准的4核处理器，该处理器在测试两种框架时保持标准。</p><p id="5301" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">我做了一个非常简单而有趣的基准测试，来展示Dask DataFrame与传统的Pandas DataFrame相比，从一个包含500万条记录的. csv文件中读取数据集的速度有多快。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/5499bdeceadb792bb7d482fa3798ff26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*t8RqRaCi9EsyVZxgPRyZCw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">为读取CSV数据帧对Pandas和Dask进行基准测试</p></figure><p id="ab33" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd"> <em class="oq">结果</em> </strong>:读取一个大小超过<strong class="mf jd"> 600MB </strong>的<strong class="mf jd"> 5M </strong>数据文件，Pandas DataFrame大约需要<strong class="mf jd"> 6.2秒</strong>，而Dask DataFrame由于其令人印象深刻的并行化能力，执行同样的任务所需的时间远少于<strong class="mf jd">秒</strong>。</p><p id="e574" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd"> <em class="oq">注</em> </strong>:这个测试是在一个小数据集上进行的，但是随着数据量的增加，读取数据的时间差会成倍增加。</p><p id="5eef" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">您可以使用下面的代码来改变更大数据集的基准测试。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="or os l"/></div></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="ee0e" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">基准阵列:Numpy与Dask</h2><p id="c121" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">在这个基准测试中，我使用Numpy数组和Dask数组生成了一个<strong class="mf jd">1万亿</strong>大小的随机数数组。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/5a4190ccd8dbc15a83bd04f01de4812c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*9cjQcTyaQ9jrcf1T_VQWVQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">创建阵列的基准测试Pandas vs Dask</p></figure><p id="29eb" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd"> <em class="oq">结果</em> </strong>:正如所料，结果非常明显，因为Numpy数组的计算时间不到<strong class="mf jd"> 8秒</strong>，而Dask数组的计算时间<strong class="mf jd">可以忽略不计</strong>！</p><p id="50f6" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">您可以使用下面的代码尝试相同的基准测试</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="or os l"/></div></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="d0a3" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">关键要点</h2><p id="4a78" class="pw-post-body-paragraph md me it mf b mg mh kd mi mj mk kg ml lr mm mn mo lv mp mq mr lz ms mt mu mv im bi translated">Dask有助于更快地进行数据分析，因为它并行化了现有的框架，如Pandas、Numpy、Scikit-Learn，并使用机器CPU的全部潜力并行处理数据。你可以在这里尝试Dask <a class="ae lh" href="https://docs.dask.org/en/latest" rel="noopener ugc nofollow" target="_blank">的惊人功能</a>。</p><p id="3785" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated">延迟加载与并行处理的结合确实是一个致命的组合，可以帮助您在任何需要的时候利用系统的全部潜力，要了解更多信息，您可以阅读<a class="ae lh" rel="noopener" target="_blank" href="/now-load-huge-datasets-within-a-second-using-lazy-computation-in-python-2698bdb02250">这篇关于Vaex </a>的文章。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="ad55" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">数据科学家的进一步阅读:</h2><div class="nb nc gp gr nd ne"><a href="https://medium.com/towards-artificial-intelligence/how-to-evaluate-machine-learning-model-performance-in-python-135b4ae27f7e" rel="noopener follow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">如何评价Python中机器学习模型性能？</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">一个实用的方法来计算模型的性能和在Python中的实现，涵盖了所有数学…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">medium.com</p></div></div><div class="nn l"><div class="ou l np nq nr nn ns lb ne"/></div></div></a></div><div class="nb nc gp gr nd ne"><a rel="noopener follow" target="_blank" href="/how-to-learn-data-science-from-beginners-to-masters-in-just-1-year-my-personal-experience-6152bedd8157"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jd gy z fp nj fr fs nk fu fw jc bi translated">如何在短短1年内把数据科学从初学者学到大师(我的亲身经历)</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">随着时间的推移，我的从初学者到大师学习数据科学的清单的完整汇编只需要一年时间…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">towardsdatascience.com</p></div></div><div class="nn l"><div class="ov l np nq nr nn ns lb ne"/></div></div></a></div><p id="9c5b" class="pw-post-body-paragraph md me it mf b mg mw kd mi mj mx kg ml lr my mn mo lv mz mq mr lz na mt mu mv im bi translated"><strong class="mf jd">谢谢！</strong></p></div></div>    
</body>
</html>