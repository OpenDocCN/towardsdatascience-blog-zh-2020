<html>
<head>
<title>How to Save a Losing Trading Strategy? (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何挽救亏损的交易策略？(第一部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/step-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e?source=collection_archive---------22-----------------------#2020-10-22">https://towardsdatascience.com/step-by-step-forex-trading-strategy-optimisation-part-1-b1516753b42e?source=collection_archive---------22-----------------------#2020-10-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="557c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一步一步的教程来拯救一个看似有希望的交易策略</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e83899b242e13449c9e359616bd55156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nghQhadw6vpYYOQx"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戴维·冯迪马尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9d92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">来自《走向数据科学》编辑的提示:</em> </strong> <em class="lv">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="lv">规则和指导方针</em> </a> <em class="lv">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="lv">读者术语</em> </a> <em class="lv">。</em></p><p id="f3aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些天网上外汇交易大师的数量之多，让我无法在YouTube上推荐。获得兰博基尼金像奖有那么容易吗？在这篇博客中，我将讲述我是如何优化一个很好的老式均线交叉策略的，这个策略在我的案例中肯定是行不通的，并试图使它成为一个有利可图的策略。在开始优化我们的策略之前，我们将从创建我们的交易系统开始，获取我们需要的数据，定义我们的进场逻辑，评估表现。事不宜迟，让我们一头扎进去；当然，在我注意到之前，我的蓝宝已经在去我车库的路上了(除了我甚至没有车库)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/c5d55e728a11277f64cc0ae8b332e41e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*nVqUIU3KcJeCJhwuR4cbgA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://9gag.com/gag/aExGAnx" rel="noopener ugc nofollow" target="_blank"> 9GAG </a></p></figure><p id="69d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">免责声明:我目前没有用这个策略交易，这个博客也不是一个财务建议。请自担风险使用。</p><h1 id="e2f9" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">系统交易</h1><p id="64a3" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">交易系统，一个听起来非常花哨和复杂的词，实际上只不过是一套精确的规则，可以自动定义进场和出场逻辑，所有这些都不需要任何人为的努力。由于规则集的精确本质，系统测试可以用历史数据集进行可靠的测试，<em class="lv">也称为回溯测试</em>。通过观察统计上有代表性的和重复的过去的行为，我们就能够估计系统交易策略盈利的信心水平。</p><p id="4d01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">交易系统通常由几个部分组成:</p><ol class=""><li id="40d3" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated"><strong class="lb iu">数据连接:</strong>数据为王。没有数据，我们就无法制定和评估战略。我们最多只能猜测。根据你的交易策略，你也许可以使用每日数据，这些数据可以从https://www.investing.com/的<a class="ae ky" href="https://www.investing.com/" rel="noopener ugc nofollow" target="_blank">网站免费获得。如果你正在做日内交易，就像我打算在这个系列的博客中做的那样，你肯定需要更精细的数据。为此，您需要从OANDA、Interactive Brokers等经纪人那里获取数据。</a></li><li id="340d" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu">特征工程:</strong>众所周知，金融时间序列是异方差的(基础数据方差变化的统计说法)。因此，价格时间序列本身无法提供稳健的进入和退出逻辑。特征工程是为以后定义进入和退出逻辑而生成附加特征的过程。这些特征的例子可以是移动平均线、指数移动平均线等。</li><li id="4440" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu">进入信号&amp;条件:</strong>信号和条件非常相似，但概念不同。以MACD交叉为例，每当线交叉，这将是一个进入信号。然而，只有在所有条件都满足的情况下才会开仓，也就是说，价格需要高于200周期移动平均线才能确认趋势。</li><li id="b2b4" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu">出舱信号&amp;条件:</strong>如果出舱为我们登陆月球创造了机会，出舱则确保我们的飞船足够稳定，能够持续整个旅程。好吧，也许这不是一个好的比喻，但好的退出逻辑可以救我们的小命。当趋势失去动力时，它锁定利润；在任何亏损的交易让我们损失惨重之前，它减少了我们的损失。说到退出逻辑，一般有四个不同的概念:(1)止损，(2)跟踪止损，(3)止盈，(4)进场时间。</li></ol><h1 id="e195" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">数据采集</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/2d912a89fb0dadb8ea2500e9bc8340c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*ODWr0edR8WzxRgKbnJ9t-Q.png"/></div></figure><p id="8137" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理论上，交易系统可以在任何市场或具有内在货币价值的流动商品上发展。在这篇博文中，我们将使用GBP。美元作为我们的基础资产。我们从OANDA v20 API获取了从2014年1月到2020年9月大约6年的30分钟分笔成交点数据。这个过程实际上很简单:(1)在OANDA创建一个练习帐户，(2)在这里生成一个访问令牌(当然要安全地存储它)，以及(3)按照Vladimir这里的指示操作。或者，您也可以从backtrader获取数据，我将在另一篇博客文章中介绍这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/8ab239764c092d4bc44aec84d68c47a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MeHsYZ7pPYqiJeXnQxa-OA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们从OANDA下载的数据集的收盘价</p></figure><h1 id="5baf" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">初始交易策略</h1><p id="70d3" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">既然我们已经对数据进行了分类，是时候制定我们的策略了。这次我们要用均线交叉。但是为了增加趣味，我们将使用三角移动平均线(TMA ),而不是简单的移动平均线(SMA)。众所周知，SMA非常容易受到异常值的影响。另一方面，TMA是更平滑的趋势线。虽然平滑的移动平均线会增加价格运动和信号之间的滞后，但它也最小化了假突破的风险，因为趋势会在进场信号到来之前得到更好的确认。那么，我们如何计算这个TMA呢？一个n周期TMA其实只是过去n个n周期SMA的平均值。听起来像是绕口令，但让我加入一些数学公式来描绘这幅图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/3a453804cdcae0f2d0ff095f6013b850.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/1*C_3Uk_a6dZeCNZf1QpO1Mg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">n周期简单移动平均线</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/133c37673649d1281aee9d5a8499364a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/1*eTSuumwCq33-qumz78cxvg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">n周期三角形移动平均线</p></figure><p id="c344" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，TMA和SMA之间有几个关键区别:</p><ol class=""><li id="f459" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">TMA是平均值的平均值；而SMA是平均值；</li><li id="8cac" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">TMA对价格变化的反应比SMA慢；</li><li id="6724" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">TMA有时可以让你在一个趋势中停留更长时间，产生更大的利润；另一方面也是如此。</li></ol><p id="aa82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为我们的30分钟数据集创建两个TMA序列，周期分别为3和30。现在，我们可以随机选择周期，并逐步优化它们，直到我们达到最优。</p><pre class="kj kk kl km gt nm nn no np aw nq bi"><span id="fde4" class="nr ly it nn b gy ns nt l nu nv">df['fast_tma'] = df['Close'].rolling(3).mean().rolling(3).mean()<br/>df['slow_tma'] = df['Close'].rolling(30).mean().rolling(30).mean()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/0d56b498093dbed976e0f579497d2f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9rKavS2_DhZTw0HpfYApQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">英镑的收盘价。2014年1月5日至2014年1月10日的美元，含3期TMA和30期TMA</p></figure><p id="21ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从简单的交易逻辑开始，慢慢增加复杂性，这通常是个好主意。通过这种方式，我们可以在调整交易策略之前更好地理解交易策略的行为和潜力。首先，让我们只定义进场信号，并在相反的信号产生时退出:</p><ul class=""><li id="5f30" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu nx na nb nc bi translated">多头进场:当(1)快速TMA已经穿过慢速TMA上方，并且(2)当前价格位于交叉杆的高点时，1手的未平仓头寸</li><li id="041e" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu nx na nb nc bi translated">短线进场:当(1)快速TMA已经穿过慢速TMA下方，并且(2)当前价格处于交叉杆的低点时，开仓1手</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/47f91c653a052b6894ec46a778faa718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVGvArKaVxiyuCBCiuBDHg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第一个信号的假突破；价格跌破交叉杆低点后的短线进场</p></figure><p id="3fdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不在交叉点处进场的直觉是测试趋势，让回撤更接近较慢的TMA系列，潜在地筛选假突破，只和长期趋势交易。如上图所示，2014年1月3日上午有一个多头设置，但由于达到了多头进场价格，该设置从未被触发。假突破后很快出现下跌趋势，当价格跌破交叉杆的低价时，就会触发空头设置。</p><h1 id="55dc" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">评估和滑动</h1><p id="43e2" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">有了初步的策略，让我们来看看性能。我们将使用2014年1月1日至2019年12月31日的数据进行评估(即样本内数据)，并在我们完成战略优化后，将2020年的精彩数据用于未来分析(样本外数据)。重要的是，我们从我们的回溯测试中保留一个前进集，以避免过度拟合，并增强我们最终策略的健壮性。相反，如果我们拥有样本数据集中的所有数据，我们就可以针对整个数据集中的每个趋势变化优化我们的时间策略。虽然这可以提供惊人的评估结果，但这绝不是现实的，因为精确的模式不会重复。这种在未来未知数据中策略表现的显著恶化被称为过度拟合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/a330ef8ad5f82fed204bfa3e57aeecfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W76qvtlM-FrmHrHSfQ9VBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们对样本内和样本外数据集的划分</p></figure><p id="edf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将初始交易策略应用于样本内数据集，假设我们交易1手英镑。每输入一个美元(即100，000单位的货币)，我们将得到以下数字:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/f31f4f72f8b8096e371296d0e4c2d46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWMo5PPlvVbAKM02ksz3LQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">6年内利润超过17，000美元。我们已经在去月球的路上了吗？</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/3be5468267c94d73c3f97beb4b08342e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I96JhHt52WrvZrptFT39OA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">振作起来，我们要在水下潜水900天。我们能屏住呼吸那么久吗？</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/db0f32e99d43d8037bca4f2b3bfe8ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*5er-0L7J_5Low4BsAMIlZg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">甜蜜黑暗主题中我们战略的关键人物</p></figure><p id="333b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，这种交易策略似乎已经相当可行了。然而，如果我们更多地关注水下图表，它显示了我们距离峰值股本的百分比有多低，我们可以注意到该策略有一个相对较长的复苏周期，最长的一个周期跨越2.5年。想象一下，处于负面情绪中，两年多都没有恢复，这听起来肯定不像是最有趣的过山车。如果我们接着研究表格中的一些交易数据，似乎会对我们的诊断有更多的见解:</p><ol class=""><li id="afd8" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated"><strong class="lb iu">利润百分比&amp;平均值。成功交易中的棒线</strong>:盈利百分比计算为所有盈利交易的百分比，而平均值。成功交易中的棒线是根据我们的成功头寸在市场中的30分钟棒线的平均数计算的。由于平均获利棒线几乎是相反棒线的4倍，我们可以说这个策略在长期趋势中运作良好。这也解释了为什么长期趋势之间的周期波动更大，因此对于我们的趋势跟踪策略来说，这也解释了为什么成功率相对较低。话虽如此，如果我们的风险管理做得好，低胜率仍然是合理的。</li><li id="ad72" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu">利润系数</strong>:计算为毛利润对毛亏损的绝对值。所以，越高越好；与此同时，利润系数低于1是一个大禁忌。正如我们在表中看到的，当进入多头头寸时，我们的策略相当糟糕。公平地说，可怜的英镑正在贬值，所以趋势对我们不利。但是，这仍然暗示了我们可以将外部进入信号收紧一点，以避免误报。</li><li id="f520" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated"><strong class="lb iu">比率平均值。赢:平均。损耗</strong>:以Avg的绝对值计算。在平均值上赢得交易。成功交易，可以作为我们回报风险比的代表。能够以超过2的比率盈利并不太坏，因为这意味着我们可以承受每赢一笔交易就输两笔交易。鉴于我们甚至没有优化任何止损或获利策略，这个数字预计会增加。</li></ol><p id="963d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了初步的诊断，是时候加入一些现实的东西了，也就是佣金和滑点。这些基本上分别是，经纪的零花钱和网络延迟的补偿。如果我们总共支付3点的费用(0.5的佣金和2.5的滑点)，那么之前50美元的利润交易将变成仅仅20美元的利润，但是，嘿，20美元就是20美元！玩笑归玩笑，让我们来看看我们更真实的权益曲线、水下图表和其他汇总统计数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/debebc827436df8522aa4b607f9b9313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L1zPs_BPpIB56fZR8yy4Yg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">残酷的现实打在我们的脸上。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5255ec1eaddad444e2b5d03f316a1929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*paq3Lc-V7HhpBoVGdNWP7g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哎唷…用这种策略，我们永远不会在真正的市场中获利…</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/6f3100434809875d441cd12f377ba117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*78_IQoC_QtMz5yu6av_t6w.png"/></div></figure><p id="cb0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">老实说，这些数字看起来很可怕。但是，不要对自己(自己)太苛刻，如果市场这么好打，巴菲特就不会是这样的传奇。另外，我们只选择了两个任意的输入参数，没有止损，也没有获利。</p><h1 id="be0c" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">步骤1:优化输入参数</h1><p id="82e0" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">为了挽救我们糟糕的策略，我们必须首先为TMAs找到一组更可行的参数。在下图中，我们使用快速TMA周期和慢速TMA周期的不同组合重新运行了回溯测试。如果我们的快速TMA周期为1，慢速TMA周期超过50，看起来这个策略实际上是有利可图的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/cc209d435139b8cd385d9acdfb069b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*XggVfQeWAnVvgxYJQsPPwg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不同TMA参数组合的性能</p></figure><p id="4882" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确定了最佳参数的大致区域后，让我们进行更精细的网格搜索。从下图可以看出，当快速TMA的周期为1，慢速TMA的周期为62时，该策略表现最佳。但是请注意，样本内数据的最佳性能并不意味着样本外数据的最佳性能。当谈到优化策略时，最好有一个更稳定的策略，而不是一个对样本数据来说可能过拟合的策略。经验丰富交易系统开发人员默里·鲁杰罗曾经说过:</p><blockquote class="og"><p id="65fc" class="oh oi it bd oj ok ol om on oo op lu dk translated">如果你不喜欢相邻的数字，你就有问题了，因为很可能你会得到相邻的一组参数的结果。</p></blockquote><p id="c6af" class="pw-post-body-paragraph kz la it lb b lc oq ju le lf or jx lh li os lk ll lm ot lo lp lq ou ls lt lu im bi translated">因此，我们不选择慢TMA周期为62，而是选择65，其中相邻参数具有相似的利润。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/c0751ce28ee20e113a822a86a3a2b032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_2bhl4wj7YQ-QOuYR73ew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">跳过高峰，走向稳定的高原</p></figure><p id="869c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参数排序后，即使考虑了3个点的滑点和费用，我们的策略仍然盈利，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/f9caf686a5b625443143ef11b8a33da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3nr0d554RZETkndkgRR9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">现在，我们又在谈论绿色了</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/29ed17c3dd1e69de3c190611476ee61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Atwo07jyQ8AeRKOJbCAGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">哦，不太好，超过3年的下降</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3d4d15bd62bcc8044d40825a02e9470e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*RZ4jSjwB40PUxycFpqDNgg.png"/></div></figure><p id="18a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从红色到绿色，这是一个非常大的进步。看看这些数字，我们可以看到，通过增加慢速TMA的周期数，赢仓的平均棒线数增加了50%以上，这与拥有更慢的慢速TMA来捕捉更长趋势的直觉相符。我们还可以看到，我们的风险回报比从2.11增加到了3.88。另一个亮点是我们的最大提取比例将从40%降至约14%。然而，我们的策略仍远未达到可交易的水平，其最长提款期为1167天。</p><h1 id="8fd4" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">第二步:优化进入时间</h1><p id="203d" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">由于外汇市场昼夜不停地运转，在一天的不同时间有不同的参与者，从APAC到欧洲，然后到美洲，再回到APAC。这就带来了一个问题，什么时候进入英镑是最好的？美元市场。众所周知，这一对的大部分货量来自欧洲和美洲。如果我们能为进场信号找到一个最佳的时间滤波器，我们也许能驾驭这些大交易量驱动的趋势。让我们看看，如果我们对进场信号应用4小时窗口滤波器，我们的策略表现如何。(例如，09:30意味着仅允许从09:30到13:30的进入信号)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/fedfa003f90a722470e54f5ae6a0c317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyvaHyQ0GKpHdTo23I5Clw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">再说一遍，让我们跳过高峰，走向稳定的高原</p></figure><p id="a107" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，尽管从05:00 GMT到09:00 GMT的进入信号为我们提供了样本内数据的最佳性能，但我们宁愿选择更稳定的选择。在这种情况下，我们的选择将是13:00–17:00，相邻参数显示类似的利润。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/d3d55574b337a58902318b7689f65c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFtOtaS8lUJ0C-2Ou5f_3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">PNL变得更加稳定</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/549cd888817c41d39c936e6ddd620aaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwG0n5B4cUGAQUryQNSzZQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们仍然需要在超过2.5年的时间里削减开支</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/39b56dea1e909fe04c563c4556e241e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*8999ntjReK7Ci41Pz9efVw.png"/></div></figure><p id="ed68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过将条目限制在13:00 GMT到17:00 GMT，我们已经将最大提款百分比降低到大约10%，提款期减少到大约980天。仔细观察这些数字，我们可以看到进场限制正在帮助我们做多，平均净利润从每手-8美元增加到每手+22美元，同时损害了短期表现。这可能意味着我们需要开发另一种策略来优化短期性能。</p><h1 id="fea0" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">结论(迄今为止)</h1><p id="316b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在这篇博客中，我们已经讲述了如何开发一个简单的TMA交叉交易策略，这个策略在理论上看起来是有利可图的，直到我们把3点的佣金和滑点计算在内。通过优化TMA参数和进场时间窗口，我们挽救了这个看起来很糟糕的策略，并使其再次盈利。以下是一些高水平的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/2540aa114052d02c264aa7cdc5333b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*InhWNCjUhXiKVlzoLzcjrQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/ce811a75749d39a2a55444c2e1f8ad53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOzlrwCqz6O_LsJMXzV4xQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/e977da981bfd5613c7adf24ab868e93e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88NjSUU00PZ2hbYnQbhdvA.png"/></div></div></figure><p id="a8f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过优化我们看似无望的战略，我们成功做到了:</p><ol class=""><li id="07e8" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">提高我们战略的利润系数，</li><li id="dc64" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">提高我们的回报风险比，</li><li id="b2fb" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">提高策略进入长期趋势的能力</li><li id="4b2c" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">降低最大提取百分比，以及</li><li id="51fd" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">缩短最大提款期</li></ol><p id="cbd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，这一战略还远未准备好部署。我们仍有超过2.5年的缩减期，6年的总利润为18.57%，因此我们仍有很大的改进空间。在本系列的后续部分中，我们将继续在以下几个方面改进这一策略:</p><ol class=""><li id="8ebc" class="mu mv it lb b lc ld lf lg li mw lm mx lq my lu mz na nb nc bi translated">带止损和跟踪止损逻辑的风险管理</li><li id="4ab1" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">基于获利逻辑的风险管理</li><li id="7d92" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">蒙特卡罗法分析</li><li id="b956" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">向前分析</li><li id="7684" class="mu mv it lb b lc nd lf ne li nf lm ng lq nh lu mz na nb nc bi translated">更多</li></ol><div class="pb pc gp gr pd pe"><a href="https://medium.com/datadriveninvestor/how-to-save-a-losing-trading-strategy-part-2-8d4f713068eb" rel="noopener follow" target="_blank"><div class="pf ab fo"><div class="pg ab ph cl cj pi"><h2 class="bd iu gy z fp pj fr fs pk fu fw is bi translated">如何挽救亏损的交易策略(第二部分)</h2><div class="pl l"><h3 class="bd b gy z fp pj fr fs pk fu fw dk translated">通过风险管理改进交易策略的逐步指南</h3></div><div class="pm l"><p class="bd b dl z fp pj fr fs pk fu fw dk translated">medium.com</p></div></div><div class="pn l"><div class="po l pp pq pr pn ps ks pe"/></div></div></a></div><h1 id="93f5" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">放弃</h1><p id="eb2a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">本报告中表达的想法和观点仅代表我个人，不一定代表我公司的观点。本报告旨在提供教育，不应被理解为个人投资建议，也不应被理解为购买、出售或持有任何证券或采取任何投资策略的建议。</p></div><div class="ab cl pt pu hx pv" role="separator"><span class="pw bw bk px py pz"/><span class="pw bw bk px py pz"/><span class="pw bw bk px py"/></div><div class="im in io ip iq"><p id="d0df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">参考文献</em></p><p id="be3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">柯林斯(2004年)。<a class="ae ky" href="https://amzn.to/35EDncj" rel="noopener ugc nofollow" target="_blank"><em class="lv"/></a>。瓦森多夫联合公司。</p><p id="7a84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Tomasini，e .，&amp; Jaekle，U. (2019年)。交易系统第二版:系统开发和投资组合优化的新方法。)。哈里曼之家。</p></div><div class="ab cl pt pu hx pv" role="separator"><span class="pw bw bk px py pz"/><span class="pw bw bk px py pz"/><span class="pw bw bk px py"/></div><div class="im in io ip iq"><h1 id="53e9" class="lx ly it bd lz ma qa mc md me qb mg mh jz qc ka mj kc qd kd ml kf qe kg mn mo bi translated">在你走之前…</h1><p id="e385" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">感谢你加入我的第一个媒体博客。让我知道你在评论中的想法，以及这篇文章如何改进。如果你能通过embed affiliate链接获得书籍以支持该系列，我们将非常感激。暂时，保持坚强，继续相信我们的蓝宝就在眼前；我们将在博客的下一部分继续这个旅程。</p><p id="3dc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再见！</p></div></div>    
</body>
</html>