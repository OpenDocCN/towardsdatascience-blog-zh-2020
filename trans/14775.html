<html>
<head>
<title>Training models with a progress bar</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带进度条的培训模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-models-with-a-progress-a-bar-2b664de3e13e?source=collection_archive---------7-----------------------#2020-10-12">https://towardsdatascience.com/training-models-with-a-progress-a-bar-2b664de3e13e?source=collection_archive---------7-----------------------#2020-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5637" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何跟踪您的ML实验的进展</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/843dd9e57a1526a04a3de4ace6b29bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ke7OyUOkKRsCK_pKRjc5gw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@mike-468229?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kw">迈克</strong> </a>发自<a class="ae kv" href="https://www.pexels.com/photo/brown-hourglass-on-brown-wooden-table-1178684/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kw">派克斯</strong> </a></p></figure><p id="0c6e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe lt lu lv lw b">tqdm</code>是一个用于添加进度条的Python库。它允许您配置并显示一个进度条，其中包含您想要跟踪的指标。其易用性和多功能性使其成为跟踪机器学习实验的完美选择。</p><p id="4133" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我将本教程分为两部分。我将首先介绍<code class="fe lt lu lv lw b">tqdm,</code>，然后展示一个机器学习的例子。对于本文中的每个代码片段，我们将从Python的<code class="fe lt lu lv lw b">time</code>库中导入<code class="fe lt lu lv lw b">sleep</code>函数，因为它将让我们减慢程序速度以查看进度条更新。</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="9bfd" class="mb mc iq lw b gy md me l mf mg">from time import sleep</span></pre><h1 id="ff75" class="mh mc iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">Tqdm</h1><p id="8da7" class="pw-post-body-paragraph kx ky iq kz b la my jr lc ld mz ju lf lg na li lj lk nb lm ln lo nc lq lr ls ij bi translated">可以用<code class="fe lt lu lv lw b">pip install tqdm</code>安装tqdm。这个库附带了各种迭代器，每个迭代器都有我将要介绍的特定用途。</p><p id="9716" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe lt lu lv lw b">tqdm</code>是默认的迭代器。它接受一个迭代器对象作为参数，并在遍历该对象时显示一个进度条。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1afc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">输出是</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="f3c6" class="mb mc iq lw b gy md me l mf mg">100%|█████████████████████████████████| 5/5 [00:00&lt;00:00, 9.90it/s]</span></pre><p id="495f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">您可以看到带有<code class="fe lt lu lv lw b">9.90it/s</code>的漂亮输出，意味着每秒9.90次迭代的平均速度。迭代的“it”可以被配置成其他的东西，这就是我们将在下一个例子中看到的。</p><p id="26de" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe lt lu lv lw b">trange</code>遵循与Python中的<code class="fe lt lu lv lw b">range</code>相同的模板。例如，给<code class="fe lt lu lv lw b">trange</code>迭代次数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="975d" class="mb mc iq lw b gy md me l mf mg">Proving P=NP: 100%|████████████| 20/20 [00:02&lt;00:00, 9.91carrots/s]</span></pre><p id="25d2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个例子中，你可以看到我们添加了一个(笑话)描述，描述了我们正在做的事情以及每次迭代的单元。</p><h1 id="bfb5" class="mh mc iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">在执行过程中更新进度栏</h1><p id="79da" class="pw-post-body-paragraph kx ky iq kz b la my jr lc ld mz ju lf lg na li lj lk nb lm ln lo nc lq lr ls ij bi translated"><code class="fe lt lu lv lw b">tqdm</code>有两个方法可以更新进度条中显示的内容。</p><p id="31ba" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">要使用这些方法，我们需要将<code class="fe lt lu lv lw b">tqdm</code>迭代器实例赋给一个变量。这可以通过Python中的<code class="fe lt lu lv lw b">=</code>操作符或<code class="fe lt lu lv lw b">with</code>关键字来完成。</p><p id="3acb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">例如，我们可以用数字<code class="fe lt lu lv lw b">i</code>的除数列表来更新后缀。让我们用这个函数来得到除数的列表</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="d061" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是我们带有进度条的代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b383" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你觉得自己是一个杰出的Python程序员，你可以像这样使用<code class="fe lt lu lv lw b">with</code>关键字</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1d3c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">使用<code class="fe lt lu lv lw b">with</code>会自动调用块末尾的<code class="fe lt lu lv lw b">pbar.close()</code>。</p><p id="112d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这里是显示在<code class="fe lt lu lv lw b">i=6</code>的状态。</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="02ed" class="mb mc iq lw b gy md me l mf mg">Testing even number 6: 70%|██████████████▋ | 7/10 [00:03&lt;00:01, 1.76carrots/s, divisors=[1, 2, 3]]</span></pre><h1 id="5b75" class="mh mc iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">跟踪损失和准确性</h1><p id="2dca" class="pw-post-body-paragraph kx ky iq kz b la my jr lc ld mz ju lf lg na li lj lk nb lm ln lo nc lq lr ls ij bi translated">在本节中，我们使用PyTorch编写的神经网络，并使用<code class="fe lt lu lv lw b">tqdm</code>对其进行训练，以显示损失和准确性。这是模型</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c3ef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是一个简单的感知器模型，我们可以用它来处理和分类MNIST数据集中的数字图像。以下加载MNIST数据集的代码灵感来自于<a class="ae kv" href="https://github.com/pytorch/examples/blob/master/mnist/main.py" rel="noopener ugc nofollow" target="_blank"> PyTorch示例</a>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="e8f3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们刚刚加载了数据，定义了模型和设置，现在可以运行训练实验了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="b789" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我再次使用<code class="fe lt lu lv lw b">sleep</code>功能暂停程序，这样我们就可以看到进度条的更新。正如你所看到的，我们只是应用了我们之前在这里学到的东西，特别是用<code class="fe lt lu lv lw b">tepoch.set_postfix</code>和<code class="fe lt lu lv lw b">tepoch.set_description</code>让你更新进度条显示的信息。下面是程序运行时的输出截图</p><pre class="kg kh ki kj gt lx lw ly lz aw ma bi"><span id="0953" class="mb mc iq lw b gy md me l mf mg">Epoch 1: 15%|▉ | 142/937 [00:16&lt;01:32, 8.56batch/s, accuracy=89.1, loss=0.341]</span></pre><p id="30c5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这给了我们如何在实际中使用<code class="fe lt lu lv lw b">tqdm</code>的想法。</p><h1 id="e9ae" class="mh mc iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="3c8a" class="pw-post-body-paragraph kx ky iq kz b la my jr lc ld mz ju lf lg na li lj lk nb lm ln lo nc lq lr ls ij bi translated">你可以用<code class="fe lt lu lv lw b">tqdm</code>实现更多，比如让它适应Jupyter笔记本，精细配置进度条更新或嵌套进度条，所以我推荐你阅读文档了解更多:<a class="ae kv" href="https://github.com/tqdm/tqdm" rel="noopener ugc nofollow" target="_blank">https://github.com/tqdm/tqdm</a></p><p id="bcc8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">感谢您的阅读！</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="bbb0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="nm">原载于2020年10月12日</em><a class="ae kv" href="https://adamoudad.github.io/posts/progress_bar_with_tqdm/" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://adamoudad . github . io</em></a><em class="nm">。</em></p></div></div>    
</body>
</html>