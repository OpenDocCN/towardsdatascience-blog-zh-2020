<html>
<head>
<title>How to build a Streamlit UI to Analyze Different Classifiers on the Wine, Iris and Breast Cancer Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何构建一个Streamlit UI来分析葡萄酒、虹膜和乳腺癌数据集上的不同分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-streamlit-ui-to-analyze-different-classifiers-on-the-wine-iris-and-breast-cancer-25c03c482a27?source=collection_archive---------18-----------------------#2020-11-08">https://towardsdatascience.com/how-to-build-a-streamlit-ui-to-analyze-different-classifiers-on-the-wine-iris-and-breast-cancer-25c03c482a27?source=collection_archive---------18-----------------------#2020-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cba7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们使用Streamlit和sklearn构建一个web应用程序</h2></div><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/bdad5e2b4f7e24f1535e601a97325f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*v34NEi6c1hHHbfeO-v82cg.gif"/></div></div><p class="lc ld gj gh gi le lf bd b be z dk translated">作者的屏幕截图</p></figure><p id="556d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在本教程中，我们将使用三个数据集(虹膜、乳腺癌、葡萄酒)</p><p id="10b0" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将使用3种不同的模型(KNN，SVM，随机森林)进行分类，并让用户能够设置一些参数。</p><h1 id="b62e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">安装并导入必要的库</h1><h2 id="f81c" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">设置虚拟环境</h2><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="26ab" class="mu md it nh b gy nl nm l nn no">pip install virtualenv  /* Install virtual environment */<br/>virtualenv venv         /* Create a virtual environment */<br/>venv/Scripts/activate   /* Activate the virtual environment */</span></pre><h2 id="e9cd" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">安装库</h2><p id="e6be" class="pw-post-body-paragraph lg lh it li b lj np ju ll lm nq jx lo lp nr lr ls lt ns lv lw lx nt lz ma mb im bi translated">安装库之前，请确保您的虚拟环境已激活</p><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="7ef5" class="mu md it nh b gy nl nm l nn no">pip install streamlit, seaborn, scikit-learn</span></pre><h2 id="e0e8" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">导入库</h2><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="e001" class="mu md it nh b gy nl nm l nn no">import streamlit as st<br/>from sklearn.datasets import load_wine, load_breast_cancer, load_iris<br/>from  sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.svm import SVC<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.decomposition import PCA<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import pandas as pd</span></pre><p id="9ab9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们导入streamlit，来自sklearn的数据集，来自sklearn的各种模型，制作我们的地块和熊猫所需的库。</p><h1 id="c5c1" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">助手功能</h1><h2 id="cb77" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">函数来获取数据集</h2><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="a8a7" class="mu md it nh b gy nl nm l nn no">def return_data(dataset):<br/>    if dataset == 'Wine':<br/>        data = load_wine()<br/>    elif dataset == 'Iris':<br/>        data = load_iris()<br/>    else:<br/>        data = load_breast_cancer()<br/>    df = pd.DataFrame(data.data, columns=data.feature_names , index=None)<br/>    df['Type'] = data.target<br/>    X_train, X_test, y_train, y_test = train_test_split(data.data, data.target, random_state=1, test_size=0.2)<br/>    return X_train, X_test, y_train, y_test,df,data.target_names</span></pre><ul class=""><li id="d5be" class="nu nv it li b lj lk lm ln lp nw lt nx lx ny mb nz oa ob oc bi translated">该函数接受一个字符串，该字符串包含用户选择的数据集的名称</li><li id="c830" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">它加载相关的数据集</li><li id="51fd" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">我们创建了一个可以在UI中显示的数据帧</li><li id="d2a1" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">我们使用sklearn的<strong class="li iu"> train_test_split() </strong>来创建训练集和测试集</li><li id="094e" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">该函数返回训练集、测试集、数据帧和目标类</li></ul><h2 id="0a66" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">函数返回模型</h2><p id="4992" class="pw-post-body-paragraph lg lh it li b lj np ju ll lm nq jx lo lp nr lr ls lt ns lv lw lx nt lz ma mb im bi translated">我们将使用streamlit的<strong class="li iu">滑块</strong>组件从用户那里获取参数输入。</p><p id="ca71" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu"> st.sidebar.slider(label = ' '，min_value = 1，max_value = 100) </strong>在侧边栏中创建一个滑块。</p><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="8603" class="mu md it nh b gy nl nm l nn no">def getClassifier(classifier):<br/>    if classifier == 'SVM':<br/>        c = st.sidebar.slider(label='Chose value of C' , min_value=0.0001, max_value=10.0)<br/>        model = SVC(C=c)<br/>    elif classifier == 'KNN':<br/>        neighbors = st.sidebar.slider(label='Chose Number of Neighbors',min_value=1,max_value=20)<br/>        model = KNeighborsClassifier(n_neighbors = neighbors)<br/>    else:<br/>        max_depth = st.sidebar.slider('max_depth', 2, 10)<br/>        n_estimators = st.sidebar.slider('n_estimators', 1, 100)<br/>        model = RandomForestClassifier(max_depth = max_depth , n_estimators= n_estimators,random_state= 1)<br/>    return model</span></pre><ul class=""><li id="d70b" class="nu nv it li b lj lk lm ln lp nw lt nx lx ny mb nz oa ob oc bi translated">和前面的函数一样，这个函数接受一个参数，这个参数是一个包含模型名称的字符串。</li><li id="2da9" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">基于所选的模型，我们要求用户给出参数值。</li><li id="aa6d" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">对于SVM，我们将C参数作为用户的输入</li><li id="e5c3" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">对于KNN，我们在进行预测时考虑模型的最近邻居的数量</li><li id="d3f2" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">对于随机森林，我们取决策树的数目和决策树的最大深度</li><li id="3d25" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">然后，我们创建模型的实例并返回模型</li></ul><h2 id="fbd2" class="mu md it bd me mv mw dn mi mx my dp mm lp mz na mo lt nb nc mq lx nd ne ms nf bi translated">PCA的功能</h2><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="51c8" class="mu md it nh b gy nl nm l nn no">def getPCA(df):<br/>    pca = PCA(n_components=3)<br/>    result = pca.fit_transform(df.loc[:,df.columns != 'Type'])<br/>    df['pca-1'] = result[:, 0]<br/>    df['pca-2'] = result[:, 1]<br/>    df['pca-3'] = result[:, 2]<br/>    return df</span></pre><p id="ca2d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们用的是sklearn的PCA。我们将3个组件添加到数据帧中并返回它。</p><h1 id="cd27" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">构建用户界面</h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oi"><img src="../Images/4bb67e8a8b35611684d27e0c451255ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODGScFRMZtqtammHMi5NvQ.jpeg"/></div></div><p class="lc ld gj gh gi le lf bd b be z dk translated">作者截图</p></figure><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="7c09" class="mu md it nh b gy nl nm l nn no"># Title<br/>st.title("Classifiers in Action")<br/><br/># Description<br/>st.text("Chose a Dataset and a Classifier in the sidebar. Input your values and get a prediction")<br/><br/>#sidebar<br/>sideBar = st.sidebar<br/>dataset = sideBar.selectbox('Which Dataset do you want to use?',('Wine' , 'Breast Cancer' , 'Iris'))<br/>classifier = sideBar.selectbox('Which Classifier do you want to use?',('SVM' , 'KNN' , 'Random Forest'))</span></pre><p id="84c2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们使用streamlit的<strong class="li iu"> selectbox </strong>组件创建一个下拉菜单，供用户选择数据集和模型</p><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="95d7" class="mu md it nh b gy nl nm l nn no"># Get Data<br/>X_train, X_test, y_train, y_test, df , classes= return_data(dataset)<br/>st.dataframe(df.sample(n = 5 , random_state = 1))<br/>st.subheader("Classes")<br/>for idx, value in enumerate(classes):<br/>    st.text('{}: {}'.format(idx , value))</span></pre><ul class=""><li id="b2f4" class="nu nv it li b lj lk lm ln lp nw lt nx lx ny mb nz oa ob oc bi translated">我们使用助手函数来获取数据</li><li id="71d5" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">我们使用streamlit的<strong class="li iu"> dataframe </strong>组件来显示数据集的一个示例</li><li id="2767" class="nu nv it li b lj od lm oe lp of lt og lx oh mb nz oa ob oc bi translated">我们还使用helper函数返回的最后一个变量来显示这些类</li></ul><p id="510b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们将使用seaborn和matplotlib在2d和3d中可视化PCA。</p><p id="d44d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">streamlit的<strong class="li iu"> pyplot </strong>组件接受一个图形作为参数，并在UI中显示该图形。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oj"><img src="../Images/615e11ce7b6767f147bcd67a06687392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eXC7-bQx-mK-RZTyDxxX9w.jpeg"/></div></div><p class="lc ld gj gh gi le lf bd b be z dk translated">作者截图</p></figure><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="7c1b" class="mu md it nh b gy nl nm l nn no"># 2-D PCA<br/>df = getPCA(df)<br/>fig = plt.figure(figsize=(16,10))<br/>sns.scatterplot(<br/>    x="pca-1", y="pca-2",<br/>    hue="Type",<br/>    palette=sns.color_palette("hls", len(classes)),<br/>    data=df,<br/>    legend="full"<br/>)<br/>plt.xlabel('PCA One')<br/>plt.ylabel('PCA Two')<br/>plt.title("2-D PCA Visualization")<br/>st.pyplot(fig)</span></pre><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ok"><img src="../Images/f9bc739ced4671801680358f96c24e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1GJNmtHRrRiloko4FpQpg.jpeg"/></div></div><p class="lc ld gj gh gi le lf bd b be z dk translated">作者截图</p></figure><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="7182" class="mu md it nh b gy nl nm l nn no">#3-D PCA<br/>fig2 = plt.figure(figsize=(16,10)).gca(projection='3d')<br/>fig2.scatter(<br/>    xs=df["pca-1"],<br/>    ys=df["pca-2"],<br/>    zs=df["pca-3"],<br/>    c=df["Type"],<br/>)<br/>fig2.set_xlabel('pca-one')<br/>fig2.set_ylabel('pca-two')<br/>fig2.set_zlabel('pca-three')<br/>st.pyplot(fig2.get_figure())</span></pre><p id="da19" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后，我们将对模型进行训练，并得到训练、测试的准确率分数。</p><pre class="kr ks kt ku gt ng nh ni nj aw nk bi"><span id="b8e8" class="mu md it nh b gy nl nm l nn no"># Train Model<br/>model = getClassifier(classifier)<br/>model.fit(X_train, y_train)<br/>test_score = round(model.score(X_test, y_test), 2)<br/>train_score = round(model.score(X_train, y_train), 2)<br/><br/>st.subheader('Train Score: {}'.format(train_score))<br/>st.subheader('Test Score: {}'.format(test_score))</span></pre><blockquote class="ol"><p id="10ab" class="om on it bd oo op oq or os ot ou mb dk translated">你已经成功地建立了一个项目，你可以展示你的投资组合👏 👏 👏</p></blockquote></div><div class="ab cl ov ow hx ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="im in io ip iq"><p id="ac9f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我最近用WordPress创建了一个博客，如果你能看看的话，我会很高兴的😃</p><div class="pc pd gp gr pe pf"><a href="https://realpythonproject.com/" rel="noopener  ugc nofollow" target="_blank"><div class="pg ab fo"><div class="ph ab pi cl cj pj"><h2 class="bd iu gy z fp pk fr fs pl fu fw is bi translated">Python项目教程-使用这些Python项目教程改进您的简历/作品集。</h2><div class="pm l"><h3 class="bd b gy z fp pk fr fs pl fu fw dk translated">使用Streamlit共享部署您的机器学习Web应用程序在我以前的文章中，我谈到过构建一个…</h3></div><div class="pn l"><p class="bd b dl z fp pk fr fs pl fu fw dk translated">realpythonproject.com</p></div></div></div></a></div><p id="826f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在LinkedIn上与我联系</p><div class="pc pd gp gr pe pf"><a href="https://www.linkedin.com/in/rahulbanerjee2699/" rel="noopener  ugc nofollow" target="_blank"><div class="pg ab fo"><div class="ph ab pi cl cj pj"><h2 class="bd iu gy z fp pk fr fs pl fu fw is bi translated">Rahul baner JEE——产品工程实习生——EY | LinkedIn</h2><div class="pm l"><h3 class="bd b gy z fp pk fr fs pl fu fw dk translated">查看Rahul Banerjee在世界上最大的职业社区LinkedIn上的个人资料。拉胡尔有4个工作列在他们的…</h3></div><div class="pn l"><p class="bd b dl z fp pk fr fs pl fu fw dk translated">www.linkedin.com</p></div></div><div class="po l"><div class="pp l pq pr ps po pt la pf"/></div></div></a></div><p id="3901" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在Twitter上与我联系</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="pu pv l"/></div></figure></div></div>    
</body>
</html>