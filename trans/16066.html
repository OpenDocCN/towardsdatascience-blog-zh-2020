<html>
<head>
<title>How to Use Python and MissForest Algorithm to Impute Missing Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python和MissForest算法估算缺失数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-python-and-missforest-algorithm-to-impute-missing-data-ed45eb47cb9a?source=collection_archive---------6-----------------------#2020-11-05">https://towardsdatascience.com/how-to-use-python-and-missforest-algorithm-to-impute-missing-data-ed45eb47cb9a?source=collection_archive---------6-----------------------#2020-11-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d91b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用随机森林处理丢失数据的分步指南</h2></div><p id="b37c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">缺失值填补是数据科学和机器学习中的一个古老问题。技术从简单的均值/中值插补发展到基于机器学习的更复杂的方法。方法选择对最终结果有多大影响？事实证明，<strong class="kk iu">很多</strong>。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/a3b930bfc93c33a4c3440d49e1514484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Zk_bHXqhMjZv_COc.jpg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">由<a class="ae lu" href="https://unsplash.com/@ryoji__iwata?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">岩田良治</a>在<a class="ae lu" href="https://unsplash.com/s/photos/puzzle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a0a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你更喜欢视频，这里也有适合你的东西:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="lv lw l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">缺失森林视频的缺失数据填补</p></figure><p id="21cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们弄清楚一些事情——缺失值插补通常是特定于域的。例如，由于客户没有使用某些服务，数据集可能包含缺失值，因此插补是错误的做法。</p><p id="4c53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，像均值/中值/众数插补这样的简单技术通常效果不佳。原因很容易解释。<strong class="kk iu">极值</strong>会影响数据集中的平均值，尤其是平均值。此外，用相同的值填充10%或更多的数据听起来不太妙，至少对于连续变量来说是这样。</p><p id="64fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的结构如下:</p><ul class=""><li id="b7ac" class="lx ly it kk b kl km ko kp kr lz kv ma kz mb ld mc md me mf bi translated">KNN插补的问题</li><li id="156d" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">什么是MissForest？</li><li id="b11e" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">实践中的失误</li><li id="29de" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">错误森林评估</li><li id="d8ed" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">结论</li></ul></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="4c33" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">KNN插补的问题</h1><p id="b930" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">甚至一些基于机器学习的插补技术也有问题。例如，KNN插补法是简单平均插补法的一个很好的开端，但也带来了一些问题:</p><ul class=""><li id="4631" class="lx ly it kk b kl km ko kp kr lz kv ma kz mb ld mc md me mf bi translated">您需要为K选择一个值——这对于小型数据集来说不成问题</li><li id="5fa9" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">对异常值很敏感，因为它使用表面下的欧几里得距离</li><li id="fcb4" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">不能应用于分类数据，因为需要某种形式的数字表示转换</li><li id="2f49" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">可能<strong class="kk iu">计算量很大</strong>，但这取决于数据集的大小</li></ul><p id="42d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要误解我的意思，我会选择KNN估算法，而不是简单的平均值，但仍然有更好的方法。如果你想了解更多关于这个话题的信息，这里有我最近的一篇文章:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/missing-value-imputation-with-python-and-k-nearest-neighbors-308e7abd273d"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">如何用Python和KNN处理缺失数据</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">使用机器学习算法处理缺失数据</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og lo ns"/></div></div></a></div></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="ceca" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">什么是MissForest？</h1><p id="d487" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">MissForest是一种基于机器学习的插补技术。它使用随机森林算法来完成任务。它基于迭代方法，并且在每次迭代中生成的预测更好。你可以在下面阅读更多关于算法的理论，因为<a class="ae lu" href="https://medium.com/@andre_ye" rel="noopener"> Andre Ye </a>做了很好的解释和漂亮的视觉效果:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/missforest-the-best-missing-data-imputation-algorithm-4d01182aed3"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">MissForest:最佳缺失数据插补算法？</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">告别KNN-估算</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og lo ns"/></div></div></a></div><p id="302b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章更多的是针对<strong class="kk iu">的实际应用</strong>，所以我们不会过多的钻研理论。总的来说，误盗非常好，因为:</p><ul class=""><li id="43bd" class="lx ly it kk b kl km ko kp kr lz kv ma kz mb ld mc md me mf bi translated">不需要大量的数据准备，因为随机森林算法可以确定哪些特征是重要的</li><li id="3d8f" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">不需要任何调整—就像K-最近邻中的K</li><li id="3054" class="lx ly it kk b kl mg ko mh kr mi kv mj kz mk ld mc md me mf bi translated">不关心分类数据类型—随机森林知道如何处理它们</li></ul><p id="ac72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将深入研究一个实际的例子。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="6728" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">实践中的失误</h1><p id="d57a" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">我们将使用<a class="ae lu" href="https://gist.githubusercontent.com/curran/a08a1080b88344b0c8a7/raw/0e7a9b0a5d22642a06d3d5b9bcbad9890c8ee534/iris.csv" rel="noopener ugc nofollow" target="_blank">虹膜数据集</a>进行实践部分。数据集不包含任何缺失值，但这是关键所在。我们将随机产生缺失值，因此我们可以稍后评估MissForest算法的性能。</p><p id="9a8c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我忘记之前，请从终端执行<code class="fe oi oj ok ol b">pip install missingpy</code>来安装所需的库。</p><p id="a8ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太好了！接下来，让我们导入Numpy和Pandas，并读入提到的Iris数据集。我们还将制作数据集的<strong class="kk iu">副本</strong>,以便稍后我们可以使用真实值进行评估:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="om lw l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">代码片段1 —导入和数据集加载</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi on"><img src="../Images/bbf9070774718ed6af7e89c37febb395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2GhvxsAn-qZ02LbweJf9g.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="ca8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，现在让我们制作两个唯一随机数列表，范围从零到虹膜数据集的长度。通过一些熊猫操作，我们将根据随机生成的索引位置，用NaNs替换<code class="fe oi oj ok ol b">sepal_length</code>和<code class="fe oi oj ok ol b">petal_width</code>的值:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="om lw l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">代码片段2 —缺失数据生成</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/50fb5e6d83900445eabcbf12bd1029d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*URvXyAbg8XVRGHGFlKantA.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="81e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，<code class="fe oi oj ok ol b">petal_width</code>只包含14个缺失值。这是因为随机化过程产生了两个相同的随机数。这不会给我们带来任何问题，因为最终缺失值的数量是任意的。</p><p id="f865" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是，嗯，进行插补。我们还必须从图片中移除<strong class="kk iu">目标变量</strong>。方法如下:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="om lw l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">代码片段3—缺失数据插补</p></figure><p id="28dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就是这样—缺失值现在被估算！</p><p id="9dbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是我们如何评价这该死的东西呢？这是我们接下来要回答的问题。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="e8be" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">错误森林评估</h1><p id="a3af" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">为了执行评估，我们将使用我们拷贝的、未接触的数据集。我们将添加两个额外的列，表示来自MissForest算法的估算列——都用于<code class="fe oi oj ok ol b">sepal_length</code>和<code class="fe oi oj ok ol b">petal_width</code>。</p><p id="4329" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们将创建一个新的<strong class="kk iu">数据集</strong>，只包含这两列——原始状态和估算状态。最后，我们将计算绝对误差，以便进一步检查。</p><p id="4758" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="om lw l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">代码片段4 — MissForest评估</p></figure><p id="a467" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如您所见，代码的最后一行只选择了进行插补的行。让我们来看看:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi op"><img src="../Images/6b7cca00f0adbc3afa65c466ce79f728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TbQ3XrTR4aOUsKDsvYS5Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片</p></figure><p id="edf7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有的绝对误差都很小，在原始平均值的一个标准偏差之内。如果不考虑增加的小数位，估算值看起来很自然。如果需要，可以很容易地修复。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="9631" class="ms mt it bd mu mv mw mx my mz na nb nc jz nd ka ne kc nf kd ng kf nh kg ni nj bi translated">离别赠言</h1><p id="a8c8" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">这是一篇关于用机器学习方法进行缺失值插补的简短扼要的文章。你已经了解了为什么机器学习在这个领域优于简单的平均水平，以及为什么MissForest优于KNN imputr。</p><p id="eebb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这对你来说是一本好书。保重。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="1d30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="oq">喜欢这篇文章吗？成为</em> <a class="ae lu" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="oq">中等会员</em> </a> <em class="oq">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="np nq gp gr nr ns"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">medium.com</p></div></div><div class="ob l"><div class="or l od oe of ob og lo ns"/></div></div></a></div></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="9b9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="oq">原载于2020年11月5日https://betterdatascience.com</em><a class="ae lu" href="https://betterdatascience.com/python-missforest-algorithm/" rel="noopener ugc nofollow" target="_blank"><em class="oq"/></a><em class="oq">。</em></p></div></div>    
</body>
</html>