<html>
<head>
<title>Building a simple Python application with Google Trends</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Google Trends构建简单的Python应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-simple-python-application-with-google-trends-9ece746cbd2f?source=collection_archive---------12-----------------------#2020-10-03">https://towardsdatascience.com/building-a-simple-python-application-with-google-trends-9ece746cbd2f?source=collection_archive---------12-----------------------#2020-10-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/30cdc8faf5355cb45e298ca475e361e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3gm9WbitshYH9KEP"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@mjessier?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米利安·耶西耶</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="a989" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">我将演示如何用Python编程语言处理Google trends数据和Excel文件。</h2></div><p id="a51c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated">xcel是微软的一款产品，在专业环境、教育和个人工作流程中非常常用。如果您作为Python程序员遇到这个应用程序，应该不会感到惊讶。根据您正在编程的内容，了解更多关于如何在Python中与excel文件交互的信息可能会很方便。</p><p id="08cb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">谷歌趋势跟踪谷歌搜索引擎的搜索分析。我们将使用一个名为<code class="fe md me mf mg b">pytrends</code>的非官方API来获取这个项目所需的数据。</p><p id="3d33" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将从Google Trends获取关键字数据，然后在Microsoft Excel中显示这些数据。我将使用<code class="fe md me mf mg b">tkinter</code>模块给用户一个漂亮的GUI(图形用户界面)来输入搜索词。我将在这个项目中使用PyCharm Professional。</p><div class="is it gp gr iu mh"><a href="https://www.jetbrains.com/pycharm/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">py charm:JetBrains为专业开发人员提供的Python IDE</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">在PyCharm处理日常事务时节省时间。专注于更大的事情，拥抱以键盘为中心的方法…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.jetbrains.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://www.microsoft.com/en-us/microsoft-365/excel" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Microsoft Excel Online，电子表格软件，免费试用</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">订阅了Microsoft 365的Microsoft Excel是Excel的最新版本。之前的版本包括Excel 2016…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.microsoft.com</p></div></div><div class="mq l"><div class="mw l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://pypi.org/project/pytrends/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">pytrends</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">谷歌趋势的非官方API允许从谷歌趋势自动下载报告的简单界面。只有…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">pypi.org</p></div></div><div class="mq l"><div class="mx l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://docs.python.org/3/library/tkinter.html" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Tcl/Tk - Python 3.8.6文档的tkinter - Python接口</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">源代码:Lib/tkinter/__init__。py包(“Tk接口”)是Tk GUI的标准Python接口…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">docs.python.org</p></div></div></div></a></div><div class="is it gp gr iu mh"><a href="https://pandas.pydata.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">熊猫</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">pandas是一个快速、强大、灵活且易于使用的开源数据分析和操作工具，构建于…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">pandas.pydata.org</p></div></div><div class="mq l"><div class="my l ms mt mu mq mv ja mh"/></div></div></a></div><p id="db3d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您是Python新手，我建议您阅读我写的一些其他文章，以获得本教程所需的基础知识。</p><div class="is it gp gr iu mh"><a href="https://medium.com/python-in-plain-english/a-brief-history-of-the-python-programming-language-4661fcd48a04" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Python编程语言的简史</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">Python编程语言是一种通用的编程语言，它已经在主流编程语言中占有一席之地</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="mz l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://medium.com/python-in-plain-english/python-basic-overview-76907771db60" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Python基本概述</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">Python有许多独特的特性，这些特性帮助它成为现在的样子。这些功能包括:</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="na l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://medium.com/python-in-plain-english/python-beginners-reference-guide-3c5349b87b2" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Python初学者完全参考指南</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">Python是一种很好的初学者语言，但也适合高级用户。我将深入核心…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="nb l ms mt mu mq mv ja mh"/></div></div></a></div><div class="is it gp gr iu mh"><a href="https://medium.com/analytics-vidhya/the-best-ides-and-text-editors-for-python-872ff1176c92" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd jk gy z fp mm fr fs mn fu fw ji bi translated">Python的最佳ide和文本编辑器</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">我无法告诉你正确的IDE(集成开发环境)对任何编程项目有多重要。只是…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="nc l ms mt mu mq mv ja mh"/></div></div></a></div><p id="85d7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我将在这里包含我的GitHub资源库。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="8c5d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们将构建一个Python应用程序，它将用户输入的一个单词作为输入，并以excel文件的报告格式输出相关的Google关键字建议，为了用户的方便，该文件会自动弹出。</p><p id="07c1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好的，首先我要在PyCharm开始一个新项目。我还将使用文件<code class="fe md me mf mg b">keywords.xlsx</code>和<code class="fe md me mf mg b">logo_image.png</code>。这些文件可以在我的GitHub Repo中找到。我将使用标准的Python虚拟环境。如前所述，我将使用<code class="fe md me mf mg b">pytrends</code>非官方API。记住现在安装项目的所有包依赖项。</p><p id="0908" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我会做我的进口。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="903d" class="ns nt jj mg b gy nu nv l nw nx">from pytrends.request import TrendReq<br/>import pandas as pd<br/>from tkinter import *<br/>import os</span></pre><p id="e2f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我将想要建立一个类。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="9bb8" class="ns nt jj mg b gy nu nv l nw nx"># create class<br/>class MyKeywordApp():<br/>    def __init__(self):</span></pre><p id="eb62" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我来定义<code class="fe md me mf mg b">newWindow()</code>方法。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="bfd2" class="ns nt jj mg b gy nu nv l nw nx">def newWindow(self):<br/>    # define your window<br/>    root = Tk()<br/>    root.geometry("400x100")<br/>    root.resizable(False, False)<br/>    root.title("Keyword Application")<br/><br/>    # add logo image<br/>    p1 = PhotoImage(file='logo_image.png')<br/>    root.iconphoto(False, p1)<br/><br/>    # add labels<br/>    label1 = Label(text='Input a Keyword')<br/>    label1.pack()<br/>    canvas1 = Canvas(root)<br/>    canvas1.pack()<br/>    entry1 = Entry(root)<br/>    canvas1.create_window(200, 20, window=entry1)</span></pre><p id="ba93" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我将定义嵌套在<code class="fe md me mf mg b">newWindow()</code>方法中的<code class="fe md me mf mg b">excelWriter()</code>方法。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="00d1" class="ns nt jj mg b gy nu nv l nw nx">def excelWriter():<br/>    # get the user-input variable<br/>    x1 = entry1.get()<br/>    canvas1.create_window(200, 210)<br/><br/>    # get our Google Trends data<br/>    pytrend = TrendReq()<br/>    kws = pytrend.suggestions(keyword=x1)<br/>    df = pd.DataFrame(kws)<br/>    df = df.drop(columns='mid')<br/><br/>    # create excel writer object<br/>    writer = pd.ExcelWriter('keywords.xlsx')<br/>    df.to_excel(writer)<br/>    writer.save()<br/><br/>    # open your excel file<br/>    os.system("keywords.xlsx")<br/>    print(df)</span></pre><p id="e162" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">之后，当在嵌套的<code class="fe md me mf mg b">excelWriter()</code>方法之后调用<code class="fe md me mf mg b">Button()</code>时，我定义了按钮并通过<code class="fe md me mf mg b">command=</code>参数将其链接到<code class="fe md me mf mg b">excelWriter()</code>方法，但仍然在<code class="fe md me mf mg b">newWindow()</code>方法内。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="3e0e" class="ns nt jj mg b gy nu nv l nw nx"># add button and run loop<br/>button1 = Button(canvas1, text='Run Report', command=excelWriter)<br/>canvas1.create_window(200, 50, window=button1)<br/>root.mainloop()</span></pre><p id="19e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们回到类代码开头的<code class="fe md me mf mg b">__init__()</code>函数中，调用<code class="fe md me mf mg b">newWindow()</code>方法。记住使用关键字self来正确引用方法。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="f383" class="ns nt jj mg b gy nu nv l nw nx">self.newWindow()</span></pre><p id="fcf3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要完成程序，在全局范围内的代码末尾(不属于任何代码块)调用<code class="fe md me mf mg b">MyKeywordApp()</code>类。</p><pre class="nk nl nm nn gt no mg np nq aw nr bi"><span id="68e1" class="ns nt jj mg b gy nu nv l nw nx"># call class<br/>MyKeywordApp()</span></pre><p id="0258" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就是这样。如果您运行该应用程序，它会弹出一个如下所示的窗口:</p><figure class="nk nl nm nn gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/c5a693e8089862ca6c5a5744c35f2cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*7Sl-eJw6tGRhs6-hXreymw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">关键词程序窗口</p></figure><p id="0a3c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只需输入一个单词，点击<em class="nz">运行报告</em>按钮提交即可。将打开一个excel文件，其中包含Google以报告格式为该搜索词建议的关键字。</p><figure class="nk nl nm nn gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/197cd90b05581db9f9e2aa33f8a69a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djHAvOalQLn_iOaaD7XnAA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Excel关键字报表(keywords.xlsx)</p></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="c3e6" class="ob nt jj bd oc od oe of og oh oi oj ok kp ol kq om ks on kt oo kv op kw oq or bi translated">结论</h1><p id="a72b" class="pw-post-body-paragraph ky kz jj la b lb os kk ld le ot kn lg lh ou lj lk ll ov ln lo lp ow lr ls lt im bi translated">这是一个介绍性的演练，目的是开始使用Python项目，包括<em class="nz"> Microsoft Excel </em>、<em class="nz"> Google Trends </em>和<em class="nz"> tkinter </em>。感谢您的阅读，我希望这有助于任何人开始这样的项目。如果您有任何意见、问题或更正，我鼓励您在下面的回复部分发表。感谢您的阅读和快乐编码！</p><h2 id="de2d" class="ns nt jj bd oc ox oy dn og oz pa dp ok lh pb pc om ll pd pe oo lp pf pg oq ph bi translated">应用程序图像源</h2><p id="ac43" class="pw-post-body-paragraph ky kz jj la b lb os kk ld le ot kn lg lh ou lj lk ll ov ln lo lp ow lr ls lt im bi translated">作者:openclippart-Vectors</p><p id="3abd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://pixabay.com/vectors/chat-key-keyboard-1294339/" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/vectors/chat-key-keyboard-1294339/</a></p></div></div>    
</body>
</html>