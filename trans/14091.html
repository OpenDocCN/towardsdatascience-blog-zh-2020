<html>
<head>
<title>5 Useful Tips For Exploratory Data Analysis Using Pandas in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的Pandas进行探索性数据分析的5个有用技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-useful-tips-for-exploratory-data-analysis-using-pandas-in-python-7c05808c9408?source=collection_archive---------31-----------------------#2020-09-28">https://towardsdatascience.com/5-useful-tips-for-exploratory-data-analysis-using-pandas-in-python-7c05808c9408?source=collection_archive---------31-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5c06ce358a90edc2b7d38891876ce554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dypneAORh7lyPiH5OL9q4g.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/users/Pexels-2286921/" rel="noopener ugc nofollow" target="_blank">派克斯</a>在<a class="ae jg" href="https://pixabay.com/photos/camping-constellation-cosmos-dark-1845906/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="fb9f" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">测量缺失数据、要素选择、展平数据框和聚合的提示</h2></div><p id="9b9a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们开始一项新的数据分析、数据挖掘、数据科学或机器学习工作时，通常会从EDA(探索性数据分析)开始分析数据。这通常是因为</p><ul class=""><li id="50a3" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">我们还不知道数据集(它看起来怎么样)</li><li id="f90e" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">需要衡量数据质量</li><li id="4324" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">需要知道我们应该如何清理数据</li><li id="cee3" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">需要一些关于数据的见解。有时，我们可能没有明确的目标来处理数据集。</li></ul><p id="fbfe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你是Python用户，我打赌你会用熊猫来完成大部分工作。在本文中，我将分享一些有用的代码片段，这些代码片段是我在EDA阶段留给自己使用的。通过保存这些有用的代码片段，我节省了大量时间，因为我将通过这些“模板”运行我获得的每个新数据集，以便找到一些关于数据的有用见解。所以，我不需要每次都去想该怎么做。</p><h1 id="681b" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">1.计算数据缺失百分比</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/d73523e604d738b1c69f6f9779036ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXHY384qIn32zW0aK4XFBg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://pixabay.com/users/Alexas_Fotos-686414/" rel="noopener ugc nofollow" target="_blank"> Alexas_Fotos </a>在<a class="ae jg" href="https://pixabay.com/photos/bear-teddy-lonely-love-longing-5121560/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄</p></figure><p id="fb78" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">关于数据集，我们需要知道的最重要的事情之一是是否有一些缺失的数据。如果有，他们错过了多少。请看下面的函数。</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d148" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该函数将常规数据框作为参数，并将返回包含两列的数据框:</p><ul class=""><li id="ce23" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">列名(原始数据框)</li><li id="12ae" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">缺失百分比</li></ul><p id="ab1b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想法是这样的</p><ol class=""><li id="c0b7" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt ng ma mb mc bi translated"><code class="fe nh ni nj nk b">df.isnull()</code>将生成一个与原始数据框形状相同的数据框，但所有像元的值将为布尔类型，其中True表示像元值缺失。</li><li id="6e65" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated"><code class="fe nh ni nj nk b">df.sum()</code>将垂直求和数据帧，其中“真”将被视为1，“假”将被视为0。因此，我们将有一个Pandas系列，其中列名作为索引，缺失值的数量作为值。</li><li id="0dad" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">将缺失值除以数据帧的行数<code class="fe nh ni nj nk b">df.shape[0]</code>将得出缺失百分比。</li><li id="793a" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">为了更好地展示，将系列转换回熊猫数据框。</li><li id="0e20" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">将结果四舍五入到两位小数。</li><li id="e793" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">重命名缺失百分比数据框的列。</li><li id="d8c1" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">分类并输出</li></ol><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/863caceb10c9af7f67c6bf22427b8c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*1SzzxQ-EhVOGbfeF_rk1JA.png"/></div></figure><p id="6588" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的例子使用了著名的泰坦尼克号数据集，它可以来自这里:</p><div class="is it gp gr iu nm"><a href="https://www.kaggle.com/c/titanic/data?select=train.csv" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jk gy z fp nr fr fs ns fu fw ji bi translated">泰坦尼克号:机器从灾难中学习</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">从这里开始！预测泰坦尼克号上的生存并熟悉ML基础知识</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">www.kaggle.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ja nm"/></div></div></a></div><h1 id="4942" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">2.获取每组中具有最大值的行</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/58a04b1f78387f97a13c312a85bc9f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Exz_26NkhSt3G66pFfCYnQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://pixabay.com/users/aL3x92-2790876/" rel="noopener ugc nofollow" target="_blank"> aL3x92 </a>在<a class="ae jg" href="https://pixabay.com/photos/darts-dart-board-arrows-target-3895861/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄</p></figure><p id="90de" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时，我们可能希望获得数据框的每组中具有最大值的行。这里有一个函数可以帮忙。</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="6749" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它有4个参数，分别是数据框、需要分组的列名、值的列名以及是否有“tie for the first”。</p><p id="0b84" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们按如下方式查看数据框:</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="0be0" class="of mj jj nk b gy og oh l oi oj">df = pd.DataFrame({'Category':['a','a','b','b','b','c'], 'Value':[3,2,5,8,8,6]})</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/45b9c44533fc8832c7824eb0609bd62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sPd0xaFJLrcswuq4OMNuA.png"/></div></div></figure><p id="01cc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可以看到，我们这里有3组“a”、“b”和“c”。对于组“b ”,有两行具有相同的值“8”并且都是最大值。在这种情况下，如果<code class="fe nh ni nj nk b">tie_for_first</code>是<code class="fe nh ni nj nk b">False</code>，只有值为“8”的第一行将被保留，而如果是<code class="fe nh ni nj nk b">True</code>，这两行都将被保留，因为有一个“平局”。</p><p id="9d95" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">步骤如下:</p><ol class=""><li id="9532" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt ng ma mb mc bi translated">决定我们应该使用哪种排名方法。即“min”或“first”。请参考下面的官方文档，了解更多关于<code class="fe nh ni nj nk b">rank()</code>方法的信息。</li><li id="4c72" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">使用给定的列对数据框进行分组，并根据值列对组进行排名。</li><li id="4c71" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">仅用<code class="fe nh ni nj nk b">rank == 1</code>过滤数据帧。</li><li id="ff33" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">删除临时使用的“rank”列，然后返回数据帧。</li></ol><div class="is it gp gr iu nm"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rank.html" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jk gy z fp nr fr fs ns fu fw ji bi translated">熊猫。DataFrame.rank — pandas 1.1.2文档</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">编辑描述</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">pandas.pydata.org</p></div></div></div></a></div><p id="f21a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是对前一个数据框运行的示例。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/5a5558fd5a7afe4a6085671f92d9b13d.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*U8fQ3lLAksHoL-QLa7spVA.png"/></div></figure><h1 id="4fe4" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">3.基于数据类型选择数据框列</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/d41dac63a7079b1cb616cedb5dfaedbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaCTxLHRtfuG2CdR6I5B4w.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://pixabay.com/users/UliSchu-1993560/" rel="noopener ugc nofollow" target="_blank"> UliSchu </a>在<a class="ae jg" href="https://pixabay.com/photos/organization-register-folder-files-1205171/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄的照片</p></figure><p id="c600" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们的数据框中有许多列时，选择列(要素)就成了一项棘手的任务。根据我的经验，这经常发生在我身上。例如，有一次我在为一个有数百台发电机的电网数据集做EDA。我想做的是选择这些生成器数据并旋转表格。然而，也有许多其他列。在这种情况下，<code class="fe nh ni nj nk b">select_dtypes()</code>功能帮助很大。</p><p id="6e22" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再次使用第一节中已经使用过的Titanic数据集。我们可以使用<code class="fe nh ni nj nk b">df.info()</code>来获得数据集的图片。注意<code class="fe nh ni nj nk b">Dtype</code>栏。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="d489" class="of mj jj nk b gy og oh l oi oj">df = pd.read_csv('train.csv')<br/>df.info()</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/ebc20aea00c095f8792769c4e869f380.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*j29S2MAmFOaiAffykeWFXw.png"/></div></figure><p id="807c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如截图所示，有2个浮点数列，5个整数列和5个字符串列。当然，对于这样的数据集，我们不必使用<code class="fe nh ni nj nk b">select_detypes()</code>，因为它们并不太多，但是仅仅作为一个例子使用也是很好的。</p><p id="71be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">比方说，我们想要所有的字符串列(对象类型):</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="b59d" class="of mj jj nk b gy og oh l oi oj">df.select_dtypes(include=['object'])</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/5a3bc3d7f5c26649926449f3f547a50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qm8D0MrHL0bJ6haILmhgcw.png"/></div></div></figure><p id="f2fa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我们正在使用<code class="fe nh ni nj nk b">select_dtypes()</code>函数的<code class="fe nh ni nj nk b">include</code>参数。在某些情况下，我们可能希望使用<code class="fe nh ni nj nk b">exclude</code>参数来删除某些类型的列，而保留所有其他类型的列。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="7a37" class="of mj jj nk b gy og oh l oi oj">df.select_dtypes(exclude=['object'])</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/780a85a4eba9b8a2ec86b1d3ae64bf24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*z59-gd-Pxs_bYccmvxKCdA.png"/></div></figure><p id="bafc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的例子中，我们选择了所有非字符串类型的列。</p><p id="cff3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事实上，您可能已经注意到，<code class="fe nh ni nj nk b">include</code>和<code class="fe nh ni nj nk b">exclude</code>参数都采用了列表参数。是的，我们可以包含或排除多种类型的列。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="c8e7" class="of mj jj nk b gy og oh l oi oj">df.select_dtypes(include=['int', 'float'])</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/2683864fdf2258ab93b8161cfac34727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*GleHTEYJsfHjv-Kzqi19uw.png"/></div></figure><p id="bba7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的例子中，我们已经选择了整数和浮点数类型的列，这对于只选择数据集的数字特征是非常方便的。</p><p id="fb39" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，事实上，有一种更简单的方法。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="4d39" class="of mj jj nk b gy og oh l oi oj">df.select_dtypes(include=['number'])</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/4642d45acd11690ada1f73766903957b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*sFjtWN9rLr1Fw92_sx1YWA.png"/></div></figure><p id="c104" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">是的，这两种类型都是数字，所以我们可以说我们想要“数字”。如果您对支持的其他类型感兴趣，请查看官方文档。</p><div class="is it gp gr iu nm"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.select_dtypes.html" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jk gy z fp nr fr fs ns fu fw ji bi translated">熊猫。data frame . select _ dtypes—pandas 1 . 1 . 2文档</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">编辑描述</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">pandas.pydata.org</p></div></div></div></a></div><h1 id="8843" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">4.水平分解数据框中的数组</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/d6bcdd4195c58d50cc53ce83ac86bf1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*joNQf6PFFVLJo9_DbE0PeA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://pixabay.com/users/adymyabya-2066528/" rel="noopener ugc nofollow" target="_blank"> adymyabya </a>在<a class="ae jg" href="https://pixabay.com/photos/magnifying-glass-map-geography-1277578/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄</p></figure><p id="1fa9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有时，我们拥有的数据集可能并不平坦。换句话说，可能有一些列具有列表/数组类型。通常，使用<code class="fe nh ni nj nk b">explode()</code>函数很容易分解数据框中的列表或数组列。但是，有时我们不想将它们分解成多行。相反，我们希望将它们扩展到更多的列中。</p><p id="ffb0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看下面的例子。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="2686" class="of mj jj nk b gy og oh l oi oj">df = pd.DataFrame({'cate':['a','b','c'],'values':[[10,20], [20,30], [30,40]]})</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/85e9ebe623d153a4bebb6bedd72a0751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*gGWYBEVD8rUjdnD7IdiS2w.png"/></div></div></figure><p id="5018" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想要扩展“values”列的每个数组中的两个值，我们可以简单地如下操作。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="d59d" class="of mj jj nk b gy og oh l oi oj">df['values'].apply(pd.Series)</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d478b77fc03564303050c524b0131b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*mFcRmGhqlW21xN82DKEvRQ.png"/></div></figure><p id="0b8b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，大多数时候我们可能希望将其合并回原始数据框。这是给你的全部功能。</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="bf48" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该函数有3个参数:数据框、要展开的列的名称以及展开的新列的列名列表(可选)。</p><p id="ae29" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些步骤是:</p><ol class=""><li id="dd6b" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt ng ma mb mc bi translated">使用目标列分割数据框，并通过Pandas系列扩展列表/数组。</li><li id="172b" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">将扩展列的新数据框与原始数据框连接起来。</li><li id="a324" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">删除已展开的原始列。</li><li id="30d0" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt ng ma mb mc bi translated">如果传入了新列名的列表，请重命名这些列。</li></ol><p id="34a9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们对上面显示的样本数据框应用该函数，结果如下。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/45b11cdb76da861e7294e1ab56ce5654.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*yoFtHzBE3f8qOCymk37XAQ.png"/></div></figure><h1 id="7716" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">5.跨列聚合</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/8cce566782b3e97d9d653f76d93a823f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixz1BoQmqYSR9PQwBv2V6Q.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/users/congerdesign-509903/" rel="noopener ugc nofollow" target="_blank">康格设计</a>在<a class="ae jg" href="https://pixabay.com/photos/cinnamon-stars-cinnamon-sticks-2991174/" rel="noopener ugc nofollow" target="_blank">皮克斯贝</a>拍摄的照片</p></figure><p id="52f2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">聚合熊猫数据帧以获得某项数据的总和或平均值是很常见的。但是，有时我们可能希望跨列进行聚合。让我通过制作如下示例数据框来演示这个问题。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="6fd8" class="of mj jj nk b gy og oh l oi oj">np.random.seed(0)<br/>assessment = pd.DataFrame(<br/>    np.random.normal(loc=70, scale=10, size=5*4).reshape(5, -1),<br/>    columns=['Term 1 Math', 'Term 2 Math', 'Term 1 English', 'Term 2 English'],<br/>    index=['Alice', 'Bob', 'Chris', 'David', 'Emily']<br/>).astype(int)</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/20b60f89b0eb3c4cf60abf2c7347d5c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*DCqUaEJMfLHPoZgCgONBOA.png"/></div></figure><p id="a5d8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个数据框架中，我们有两个学期的学生考试成绩。假设我们想要平均每个学生每门学科的成绩。换句话说，我们想分别得到数学科目和英语科目的平均分。</p><p id="4755" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我知道，用第一列加第二列再除以2，然后对第三列和第四列做同样的事情，并不是太难。最后，重命名这些列。肯定有更简洁的方法可以做到这一点。参见下面的代码。</p><pre class="na nb nc nd gt ob nk oc od aw oe bi"><span id="03a2" class="of mj jj nk b gy og oh l oi oj">mapping = {<br/>    'Term 1 Math':'Math', <br/>    'Term 2 Math':'Math', <br/>    'Term 1 English':'English',<br/>    'Term 2 English':'English'<br/>}<br/>agg_results = assessment.groupby(mapping, axis=1)<br/>agg_results.mean()</span></pre><p id="0dae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你知道<code class="fe nh ni nj nk b">groupby()</code>方法也需要字典吗？字典将帮助函数将列分组到不同的类别中。然后，我们可以合计每个类别(数学和英语)的值。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/1cfbe88f1c361256c48189af984ffea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*tYkmz7OENIX-ZO0Sft-b9Q.png"/></div></figure><h1 id="a5a4" class="mi mj jj bd mk ml mm mn mo mp mq mr ms kp mt kq mu ks mv kt mw kv mx kw my mz bi translated">摘要</h1><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0fc91f4ff3b358ecccdde18ccc9b3850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KnIM62Q9JHeyKhQQ3lrT0g.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/users/Shutterbug75-2077322/" rel="noopener ugc nofollow" target="_blank"> Shutterbug75 </a>在<a class="ae jg" href="https://pixabay.com/photos/artistic-arts-blue-business-1238606/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄的照片</p></figure><p id="86a7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我分享了一些我在EDA活动中经常使用的技巧。我想说你可能不需要使用它们来实现大部分的功能或实现。然而，如果你以前从未这样使用过熊猫，我建议你理解它们。有时，它们可以在我们的数据分析工作中节省大量时间。</p><div class="is it gp gr iu nm"><a href="https://medium.com/@qiuyujx/membership" rel="noopener follow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jk gy z fp nr fr fs ns fu fw ji bi translated">通过我的推荐链接加入Medium克里斯托弗·陶</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">medium.com</p></div></div><div class="nv l"><div class="ow l nx ny nz nv oa ja nm"/></div></div></a></div><p id="6c88" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你觉得我的文章有帮助，请考虑加入Medium会员来支持我和成千上万的其他作者！(点击上面的链接)</p></div></div>    
</body>
</html>