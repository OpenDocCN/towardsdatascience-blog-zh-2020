<html>
<head>
<title>Practical Machine Learning Basics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实用机器学习基础</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/practical-machine-learning-basics-5d81a22f188?source=collection_archive---------21-----------------------#2020-09-27">https://towardsdatascience.com/practical-machine-learning-basics-5d81a22f188?source=collection_archive---------21-----------------------#2020-09-27</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="d47b" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">我第一次探索机器学习是在Kaggle上用泰坦尼克号比赛</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/fcfd21a8bd102eb996627a256bd586d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*buaExCUvqxi6Mf1VeiQNgw.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">路易斯&amp;萝拉，泰坦尼克号灾难的幸存者(照片来自<a class="ae kz" href="https://www.loc.gov/item/2014691309/" rel="noopener ugc nofollow" target="_blank">国会图书馆印刷品和照片</a>，没有已知的出版限制)</p></figure><p id="04e8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这篇文章描述了我在<a class="ae kz" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上参加泰坦尼克号机器学习竞赛的尝试。我一直在尝试研究机器学习，但从未达到能够解决现实世界问题的程度。但是在我看了两本新发行的关于实用AI的书之后，我有足够的信心参加泰坦尼克号比赛。</p><p id="2602" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">文章的第一部分描述了如何准备数据。第二部分展示了我如何使用支持向量机(SVM)。我用SVM创造了一个模型来预测泰坦尼克号乘客的生存。</p><p id="edf9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该模型的得分为0.779907，这使我进入了比赛的前28%。我对结果非常满意。你可以在Github 中找到一个带有解决方案和文档<a class="ae kz" href="https://github.com/PatrickKalkman/Kaggle/blob/master/Titanic/Kaggle_Titanic.ipynb" rel="noopener ugc nofollow" target="_blank">的Jupiter笔记本。</a></p><h1 id="ce3e" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">介绍</h1><p id="6809" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">以前，我曾试图通过阅读书籍和参加在线课程来学习人工智能。我从未走远。这些书籍和在线课程大多过于理论化。</p><p id="8182" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在过去的几个月里，我再次尝试用机器学习和人工智能来思考问题。原因是我订了两本关于机器和深度学习的新书。这些书包括许多实用知识和例子。</p><p id="7f84" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我看到一条推文提到了这本书<em class="mt">《fastai和PyTorch的程序员深度学习:没有博士学位的ai应用》</em>。这个标题引起了我的注意，因为它明确针对程序员。向我推荐的另一本书是“<em class="mt">用Scikit-Learn、Keras和TensorFlow进行动手机器学习。”</em></p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mu"><img src="../Images/67d5e45edaddad862b2040c0b41c7b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHieFDn5F57Hjc07EkWiQw.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/" rel="noopener ugc nofollow" target="_blank">使用Scikit-Learn、Keras和TensorFlow进行机器实践学习，第二版，作者Aurélien Géron </a>和<a class="ae kz" href="https://www.oreilly.com/library/view/deep-learning-for/9781492045519/" rel="noopener ugc nofollow" target="_blank">深度学习，作者fastai和PyTorch，作者杰瑞米·霍华德和西尔万·古格</a></p></figure><h2 id="f39e" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated"><strong class="ak">用fastai为编码人员进行深度学习&amp; PyTorch </strong></h2><p id="5f01" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">这本书和我看的过去的机器学习书不一样。从一开始就直接展示了深度学习的真实实用代码示例。作为一名程序员，源代码有助于我理解这些概念。</p><p id="a5a7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">两位作者还提供与该书内容相同的视频讲座。这些视频讲座是免费的。除此之外，还有一个提问和讨论的论坛。</p><h2 id="2215" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated"><em class="nh">使用Scikit-Learn、Keras和TensorFlow进行机器实践学习</em></h2><p id="85c3" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">这也是一本实用的书。它展示了许多实际的例子。这本书使用了Scikit-Learn、Keras和Tensorflow等机器学习策略。很多人用这本书来准备<a class="ae kz" href="https://www.tensorflow.org/certificate" rel="noopener ugc nofollow" target="_blank"> TensorFlow开发者认证</a>。</p><p id="8fa8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我浏览了两本书中的各种例子。这既有趣又有启发性。但对我来说，真正的挑战是看我能否从头到尾独立解决一个真正的问题。</p><p id="5ce6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">两本书都提到<a class="ae kz" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>是有趣的数据集和机器学习问题的来源。</p><h1 id="5af6" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">卡格尔</h1><p id="9b21" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">Kaggle是一个由数据科学家和机器学习实践者组成的在线社区。Kaggle是谷歌的子公司。</p><p id="568d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Kaggle允许您搜索和发布数据集，探索和建立模型。您可以在基于web的环境中做到这一点。Kaggle还提供有真题的机器学习竞赛，并为游戏的获胜者提供奖品。</p><p id="d105" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，如果我可以参加一个比赛，并且能够使用我当前的机器学习知识来创建一个提交内容，那该有多酷？</p><p id="fa18" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Kaggle上有一个名为“泰坦尼克号:机器从灾难中学习”的比赛。这是一个帮助用户熟悉Kaggle平台如何工作的比赛。</p><p id="f56e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这听起来对我来说是开始和实验机器学习的完美竞争。</p><h1 id="8ed6" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">泰坦尼克号:机器从灾难中学习</h1><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ni"><img src="../Images/0ccf42ce528441e55ff5d99e51c9fc3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPpvEulF6HT2l8fshu0DzA.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">图为1912年4月11日在科布港拍摄的泰坦尼克号(图片来自<a class="ae kz" href="https://commons.wikimedia.org/wiki/File:Titanic-Cobh-Harbour-1912.JPG" rel="noopener ugc nofollow" target="_blank">维基共享资源</a>，版权已过期)</p></figure><p id="4145" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">1912年4月15日，泰坦尼克号在撞上冰山后的第一次航行中沉没。机上2224名乘客中有1500多名乘客因此死亡。虽然幸存有一些运气成分，但似乎某些群体比其他群体更有可能幸存。</p><p id="7854" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><em class="mt">泰坦尼克号比赛的目标是创造一个可以预测哪些乘客在灾难中幸存的模块。</em></p><p id="74a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">竞赛提供了两个数据集。具有乘客数据的训练集，例如姓名、年龄、性别、状态以及乘客是否幸存。</p><p id="73e2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第二组包含相同的数据，但没有生存符号。你必须把第二组测试返回给Kaggle，并附上你对乘客是否幸存的预测。</p><p id="1805" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在建立机器学习模型之前，我们必须回答的第一个问题是，我们将使用什么类型的机器学习？</p><h1 id="2b69" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">用什么类型的机器学习？</h1><p id="1b15" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">我还不知道如何回答这个问题。即便如此，我知道我们首先需要确定这是一个回归还是分类的问题。这有助于我们选择合适的机器学习方法。</p><p id="eb0a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">分类模型试图从一组离散的可能性中进行预测。回归模型试图陈述一个或多个数字量。</p><p id="b0bf" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们需要预测一名乘客是否幸存。这在我听来是一个分类问题。所以我们需要一个机器学习类型，可以创建这样的分类模型。</p><p id="f8e4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我对这个问题的了解还不足以选择最佳的机器学习策略。但我知道如何建立分类模型——例如，使用逻辑回归或支持向量机。</p><p id="4c99" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我决定使用支持向量机(SVM)。</p><h1 id="372b" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">为机器学习准备训练数据</h1><p id="481e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在阅读书籍和Kaggle论坛时，我了解到在你可以创建机器学习模型之前，你必须准备数据集。为了准备数据，我遵循了以下五个步骤。</p><ol class=""><li id="c288" class="nj nk iu lc b ld le lg lh lj nl ln nm lr nn lv no np nq nr bi translated">加载数据</li><li id="b90d" class="nj nk iu lc b ld ns lg nt lj nu ln nv lr nw lv no np nq nr bi translated">将文本值转换为数字</li><li id="55bd" class="nj nk iu lc b ld ns lg nt lj nu ln nv lr nw lv no np nq nr bi translated">使用相关性选择相关参数</li><li id="e073" class="nj nk iu lc b ld ns lg nt lj nu ln nv lr nw lv no np nq nr bi translated">删除或填充缺少的值</li><li id="a055" class="nj nk iu lc b ld ns lg nt lj nu ln nv lr nw lv no np nq nr bi translated">移除异常值</li></ol><h2 id="0930" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated">1.加载泰坦尼克号乘客数据</h2><p id="c817" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">为了加载和操作数据，我使用pandas库。Pandas提供数据结构和操作来控制数字表和时间序列。</p><p id="12ea" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我从Kaggle下载了<code class="fe nx ny nz oa b">train.csv </code>和<code class="fe nx ny nz oa b">test.csv</code>,并将它们存储在一个文件夹datasets中。熊猫提供了方便的方法来读取CSV文件。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用pandas加载数据</p></figure><p id="e947" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当您执行这个Python脚本时，它会加载数据并显示训练数据集的前五行。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">训练数据集中的前五行数据</p></figure><p id="9440" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面是Kaggle给出的每个字段的描述。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">训练集中数据的说明</p></figure><h2 id="d2e5" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated">2.将文本转换为数字</h2><p id="8f26" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">为了能够在机器学习策略中使用这些字段，我们必须将它们转换为数字。此外，为了能够计算字段之间的相关性，字段必须是数字。</p><p id="925e" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">列中的值应该是数字，以便能够计算相关性。除此之外，大多数机器学习算法更喜欢与数字打交道。因此，我们需要将性别和着手列转换为数字。</p><p id="8403" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">Scikit-Learn库包含一个名为<code class="fe nx ny nz oa b">OrdinalEncoder</code>的类，可以用于这个目的。下面的代码展示了如何将<code class="fe nx ny nz oa b">Sex</code>列转换成数字。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用OrdinalEncoder将性别列转换为数字</p></figure><p id="c0a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">同样，我也将<code class="fe nx ny nz oa b">Embarked</code>列转换为数字。</p><h2 id="0dc5" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated">3.通过相关性选择相关参数</h2><p id="9a3a" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">在我开始删除记录或添加缺失值之前，我想知道哪些值最有可能影响乘客的生存。有些字段可能是显而易见的，如性别列。由于“妇女和儿童优先”的行为准则，性别栏是乘客生存机会的一个很好的指示器。</p><p id="2329" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">但我想有一个更具战略性的方法来确定这一点。您可以使用数据框的<code class="fe nx ny nz oa b">corr()</code>方法计算幸存列和其他列之间的相关性。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">计算相关矩阵</p></figure><p id="3114" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这导致下面的相关矩阵。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">不同列和幸存列之间的关联</p></figure><p id="084d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们看到<code class="fe nx ny nz oa b">Sexenc</code>列，正如预期的那样，与存活有最强的相关性。列<code class="fe nx ny nz oa b">Pclass</code>、<code class="fe nx ny nz oa b">Fare</code>、<code class="fe nx ny nz oa b">Embarkedenc</code>也有不错的关联。其余列之间的相关性很小。因此，我从训练集中删除了这些列，因为它们对机器学习模型没有影响或影响很小。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="f9ca" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用数据框上的<code class="fe nx ny nz oa b">drop</code>方法可以轻松删除列。</p><h2 id="95fc" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated">4.删除或添加缺少的值</h2><p id="d642" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">加载数据后，我们可以调查训练集中是否有数据缺失。用方法<code class="fe nx ny nz oa b">read_csv</code>我们创建了一个名为titanic的数据帧。</p><p id="7e3a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">这个数据框有一个名为<code class="fe nx ny nz oa b">isna()</code>的方法，它创建一个与数据框大小相同的二维数组。数组中填充了布尔值，这些值指示原始数据框中的值是否不可用(an)。通过将<code class="fe nx ny nz oa b">isna</code>与<code class="fe nx ny nz oa b">sum</code>、<code class="fe nx ny nz oa b">titanic.isna().sum()</code>结合起来，我们可以很好地了解数据帧中有多少缺失值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="9804" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们看到在<code class="fe nx ny nz oa b">Age</code>列中缺少177条记录，在<code class="fe nx ny nz oa b">Cabin</code>列中缺少687条记录，在<code class="fe nx ny nz oa b">Embarked</code>中缺少两条记录。添加缺失值有几种可能性。您可以删除缺少值的记录。您还可以添加缺少的值。例如，使用<code class="fe nx ny nz oa b">Age</code>，您可以计算平均值或中值，并将其添加到缺失值中。</p><p id="7fa6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">当你查看机器学习预测的结果时，你可以评估什么表现最好。</p><p id="99c8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我决定从用平均值填充缺失的年龄值开始。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="32e6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我决定用最常见的值来填充<code class="fe nx ny nz oa b">Embarked</code>中缺失的两个值。使用行<code class="fe nx ny nz oa b">titanic[‘Embarked’].value_counts()</code>，您可以获得列内值的概述。该命令产生了以下输出。</p><pre class="kk kl km kn gu od oa oe of aw og bi"><span id="21d7" class="mv lx iu oa b gz oh oi l oj ok">S    644<br/>C    168<br/>Q     77</span></pre><p id="424f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们看到S (Southhampton)是最常见的值。所以我们可以使用<code class="fe nx ny nz oa b">fillna</code>方法来填充缺失的两个值。</p><p id="d202" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><code class="fe nx ny nz oa b">titanic[“Embarked”] = titanic[“Embarked”].fillna(‘S’)</code></p><p id="8bc8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><strong class="lc iv">机舱立柱</strong></p><p id="ede9" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">尽管Cabin列中缺少许多值，但您仍然可以从中提取相关信息。B96、G6、C23、E101等舱号的第一个字母表示舱的甲板。</p><p id="8842" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在我看来，甲板是重要的信息，因为下层甲板上的乘客生还的可能性较低。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ol"><img src="../Images/0d7053e8c8e5ebaa1d4dce74b900f158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eziCGh07ijgRMR3XNmCjag.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">RMS <em class="nh">泰坦尼克号</em>的剖面图，船中部(1917)，(图片来自<a class="ae kz" href="https://commons.wikimedia.org/wiki/File:Titanic_cutaway_diagram.png" rel="noopener ugc nofollow" target="_blank">维基共享</a>，C <em class="nh">版权已过期</em>)</p></figure><p id="7f06" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以使用下面的语句<code class="fe nx ny nz oa b">titanic[‘Deck’] = titanic[‘Cabin’].str[:1]</code>创建一个名为Deck的新列。请注意，我们还必须将该列转换为数字，就像我们之前看到的那样。</p><p id="71a7" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">通过使用领域知识在数据中引入新特征被称为<strong class="lc iv">特征工程</strong>。</p><h2 id="ab47" class="mv lx iu bd ly mw mx dn mc my mz dp mg lj na nb mi ln nc nd mk lr ne nf mm ng bi translated">5.移除异常值</h2><p id="c02e" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">数据准备的最后一步是识别和剔除异常值。异常值是超出预期的极端值，与其他数据不同。通常，机器学习模型可以通过移除这些异常值来改进。</p><p id="f4d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">有多种方法可以检测和移除异常值。我使用<code class="fe nx ny nz oa b">quantile</code>方法来检测并删除高于99%或低于1%的数据值。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">使用quantile()检测和移除异常值</p></figure><p id="6205" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">您必须小心移除异常值，因为您无法确定这些值是否确实是错误的。我试图建立有离群值和无离群值的机器学习模型，并查看模型的性能是提高还是下降。</p><p id="f116" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">随着数据的清理，离群值的移除，以及缺失值的填充，我们最终可以开始训练机器学习模型。</p><h1 id="4248" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">创建和训练支持向量机(SVM)</h1><p id="3331" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">如前所述，我为机器学习策略选择了SVM。Scikit-Learn库包含一个SVM的实现。</p><p id="1738" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在将数据输入SVM之前，我们还需要做一件事，<strong class="lc iv">特征缩放</strong>。当数字输入特征具有不同的尺度时，大多数机器学习算法表现不佳。泰坦尼克号的数据就是这种情况。</p><p id="8879" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们使用Scikit-Learn的<code class="fe nx ny nz oa b">scale()</code>函数来缩放数据。“缩放”是一种快速简便的值缩放方法，通过这种方法，所有要素都以零为中心，并且具有相同顺序的方差。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="8839" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我做的另一件事是在第三行将训练集分成训练集和测试集。这允许我们使用测试集来验证训练模型的性能。</p><p id="a5d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在第七行，我们在Scikit-Learn中创建了名为SVC的SVM。使用第八行中的<code class="fe nx ny nz oa b">fit</code>方法执行模型的实际训练。</p><p id="b560" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">为了评估模型的性能，我们使用Scikit-Learn的<code class="fe nx ny nz oa b">plot_confusion_matrix</code>函数创建了一个混淆矩阵。混淆矩阵函数使用测试集来可视化性能。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj om"><img src="../Images/c18b37fe161705536ba0a6ecdecb4e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cd8FNBjvMFG3OINCOtXyBQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">SVM的困惑矩阵，图片由作者提供</p></figure><p id="1715" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">该矩阵表明模型正确预测了123名乘客的生存(黄色)。此外，该模型正确预测了62名乘客，他们没有生存(蒂尔)。另一方面，模型错误地预测27名乘客幸存，而他们没有(蓝色)。此外，它错误地预测了11名乘客没有幸存，而他们实际上幸存了下来(紫色)。</p><p id="cfb1" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因此，我们的模型是可行的，但并不完美。</p><h1 id="9ebc" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">预测测试集的生存并提交给Kaggle</h1><p id="e8a0" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">比赛的最后一部分是使用经过训练的模型，使用Kaggle的测试集来预测乘客的存活率。与训练集一样，测试集也需要清理。</p><p id="6f5d" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">因为我创建了加载和清理数据的函数，所以这就像用测试集调用函数一样简单。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="ob oc l"/></div></figure><p id="72a2" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在第七行中，先前训练的SVM用于预测测试集中乘客的存活率。剩下的代码是将结果转换成可用于提交给Kaggle的格式。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj on"><img src="../Images/ff7fd252570346f89a4be7c2ff6eeb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YChGGhZhlWbyD_5lY_Jm0Q.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">泰坦尼克号排行榜截图，图片由作者提供</p></figure><p id="b20c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">完整的木星笔记本可以在Github的这里<a class="ae kz" href="https://github.com/PatrickKalkman/Kaggle/blob/master/Titanic/Kaggle_Titanic.ipynb" rel="noopener ugc nofollow" target="_blank">找到。</a></p><h1 id="6281" class="lw lx iu bd ly lz ma mb mc md me mf mg ka mh kb mi kd mj ke mk kg ml kh mm mn bi translated">结论</h1><p id="8740" class="pw-post-body-paragraph la lb iu lc b ld mo jv lf lg mp jy li lj mq ll lm ln mr lp lq lr ms lt lu lv in bi translated">《程序员的深度学习》和《动手机器学习》这本书实际上解释了机器学习。它们包含许多展示如何解决真实世界机器学习问题的示例。</p><p id="0057" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">使用机器学习解决问题的最重要的部分是准备数据，以便机器学习算法可以使用它。我查看了数据集中字段之间的相关性，以确定保留哪些字段。这些值的中值替换了缺失的值。我们将非数字字段转换为数字，以便在机器学习中使用它们。</p><p id="7ce4" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在这两本书的帮助下，我参加了Kaggle泰坦尼克号比赛，获得了0.779907的分数。我会继续学习这两本书，并努力提高我的分数。</p><p id="9af8" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我将参加的下一个Kaggle竞赛是<a class="ae kz" href="https://www.kaggle.com/c/digit-recognizer" rel="noopener ugc nofollow" target="_blank">数字识别器</a>。这使用MNIST(“修改后的国家标准与技术研究所”)数据集。这是计算机视觉事实上的“hello world”数据集。</p><p id="8436" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>