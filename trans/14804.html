<html>
<head>
<title>Text Classification using Word Similarity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于词语相似度的文本分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/text-classification-using-word-similarity-2f0c5fc9f365?source=collection_archive---------36-----------------------#2020-10-12">https://towardsdatascience.com/text-classification-using-word-similarity-2f0c5fc9f365?source=collection_archive---------36-----------------------#2020-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/f3393a7eabbe824f74340cc73d77e40c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YbM1SSUqznl2Bi6D"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">尼克·舒利亚欣在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="7209" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph">NLP / NLTK Wordnet /文本分类</h2><div class=""/><div class=""><h2 id="307b" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">利用数据科学发现FCA的弱势客户</h2></div><h1 id="ca96" class="le lf jg bd lg lh li lj lk ll lm ln lo kv lp kw lq ky lr kz ls lb lt lc lu lv bi translated">背景</h1><p id="5ff2" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">英国金融服务监管机构FCA在其<a class="ae jd" href="https://www.fca.org.uk/publication/business-plans/business-plan-2020-21.pdf" rel="noopener ugc nofollow" target="_blank"> 2020/21商业计划</a>中关注的一个关键领域是公平对待银行客户。继去年夏天的初步磋商后，他们最近更新了指南，以更好地阐明漏洞的驱动因素:</p><blockquote class="ms mt mu"><p id="5840" class="lw lx mv ly b lz mw kq mb mc mx kt me my mz mh mi na nb ml mm nc nd mp mq mr ij bi translated">我们已经确定了4个可能增加漏洞风险的关键驱动因素。它们是:<br/> - <strong class="ly jq">健康</strong>-影响执行日常任务能力的残疾或疾病。<br/> - <strong class="ly jq">生活事件</strong> —重大生活事件，如丧亲、失业或关系破裂<br/> - <strong class="ly jq">复原力</strong> —承受财务或情感冲击的能力低<br/> - <strong class="ly jq">能力</strong> —对财务知识或理财信心(财务能力)低，以及其他相关领域的能力低，如读写能力或数字技能</p></blockquote><p id="255a" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">随着与COVID相关的疾病和失业为这些驱动因素的蓬勃发展创造了肥沃的土壤，我想看看数据科学家如何帮助银行识别此类漏洞，以便他们能够更主动地提供支持服务。</p><p id="33fb" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">我想象了一份客户和银行之间的电话对话，或者与聊天机器人或客户服务代理的打字对话。并期待NLP技术来帮助自动检测这些驱动程序。</p><p id="174e" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated"><strong class="ly jq">潜在策略:</strong> <br/> <strong class="ly jq"> 1。单词相似度:</strong>扫描文本段落中的关键词(例如休假)或它们的同义词。<br/>2<strong class="ly jq">2。从标记的例子中导出n-gram特征，并使用该模型对未来的文本进行分类。</strong></p><p id="2460" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">鉴于缺乏训练数据，我们采用策略1。</p><h1 id="8951" class="le lf jg bd lg lh li lj lk ll lm ln lo kv lp kw lq ky lr kz ls lb lt lc lu lv bi translated">履行</h1><h2 id="8c5c" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">1.规范化漏洞驱动因素</h2><p id="5283" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">首先，我们将漏洞的4个驱动因素分解成一个更长的不同类别的列表，然后我们可以在文本中明确地搜索:<br/> 1。死亡，<br/> 2。冗余，<br/> 3。疾病，<br/>等…</p><h2 id="b1d2" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">2.为NLTK Wordnet翻译类别</h2><p id="f681" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">由于我们将使用NLTK中可用的相似性评分器，我们需要将这些类别翻译成Wordnet (NLTK的词汇数据库/字典)中描述的正确定义。为此，我们可以使用一个简单的函数，给出该单词的同义词列表及其定义:</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">word_scorer</p></figure><p id="e9f2" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">哪个for<strong class="ly jq">word _ scorer(‘冗余’)</strong>会输出:</p><pre class="np nq nr ns gt nv nw nx ny aw nz bi"><span id="0668" class="ne lf jg nw b gy oa ob l oc od">[('redundancy.n.01',<br/>  'repetition of messages to reduce the probability of errors in transmission'),<br/> ('redundancy.n.02', 'the attribute of being superfluous and unneeded'),<br/> ('redundancy.n.03',<br/>  '(electronics) a system design that duplicates components to provide alternatives in case one component fails'),<br/> ('redundancy.n.04', 'repetition of an act needlessly')]</span></pre><p id="2abf" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">并因此帮助我们创建我们将搜索的主题字典(这里的关键字是用户友好的主题，值是Wordnet友好的表示):</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">主题_词典</p></figure><h2 id="be96" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">3.标记段落</h2><p id="09f6" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">这里有一段话我们可能想分析一下(显然是关于冗余的):</p><blockquote class="ms mt mu"><p id="1ca6" class="lw lx mv ly b lz mw kq mb mc mx kt me my mz mh mi na nb ml mm nc nd mp mq mr ij bi translated">我在一个县议会的成人学习部门工作，我的工作由政府拨款支付。当资金用完的时候，财政年度已经过了一半，突然没钱给我发工资了。我被叫去和其他四个人(他们的工作也依赖于资金)开会，这个消息告诉了我们。在裁员最终确定之前，将有12周的咨询期。我们可以选择拿着遣散费走人，或者我们可以在议会的另一个部门找份工作。如果我们拒绝提供给我们的工作，我们可能会失去裁员协议。</p></blockquote><p id="1f1c" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">我们将对其进行标记，这样我们就可以遍历单词标记列表</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">删除停用词并标记文本</p></figure><h2 id="17e1" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">4.根据单个主题给文章打分</h2><p id="52a7" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">我们将按照以下步骤实现一个函数:</p><ul class=""><li id="bfed" class="oe of jg ly b lz mw mc mx mf og mj oh mn oi mr oj ok ol om bi translated">遍历文章中的单词标记，将每个单词输入wordnet.synsets()以列出单词的所有可能用法(例如，参见上面列出的单词“redundancy”的可能用法)</li><li id="be65" class="oe of jg ly b lz on mc oo mf op mj oq mn or mr oj ok ol om bi translated">遍历单词的同义词集，并比较它们与感兴趣的主题的高度相似性(我们将使用<a class="ae jd" href="https://www.geeksforgeeks.org/nlp-wupalmer-wordnet-similarity/" rel="noopener ugc nofollow" target="_blank"> wup_similarity </a>)。</li><li id="cd4e" class="oe of jg ly b lz on mc oo mf op mj oq mn or mr oj ok ol om bi translated">如果这个词的任何可能用法与主题有很高的相似度(大于我们定义的相似度阈值)，我们说这个主题已经被提及，然后我们继续下一个词。</li><li id="dc28" class="oe of jg ly b lz on mc oo mf op mj oq mn or mr oj ok ol om bi translated">我们还可以添加return_hits选项，这将使我们能够报告哪些单词触发了相似性阈值。</li></ul><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="014e" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">5.对照整个主题词典给文章打分</h2><p id="6401" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">然后，我们可以重用函数来遍历主题字典中的每个主题:</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="59c2" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">因此计算该段落与每个主题相似度，并返回被认为相似的单词。</p><p id="ae7a" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">将这些函数打包到一个名为synonym.py的模块中后，运行最后一个函数就很简单了:</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">运行multi_topic_scorer</p></figure><p id="ca79" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">它输出下面的结果字典，我们可以看到冗余的主题在文章中被提到了3次，每次都是因为提到了单词“redundancy ”,尽管它可能是任何其他类似的单词或相似的单词，如果被使用的话，可能会增加分数:</p><pre class="np nq nr ns gt nv nw nx ny aw nz bi"><span id="4e0c" class="ne lf jg nw b gy oa ob l oc od"><br/>{'disability': (0, []),<br/> 'death': (0, []),<br/> 'health problems': (0, []),<br/> 'being a carer': (0, []),<br/> 'living alone': (0, []),<br/> 'job loss (fired)': (0, []),<br/> 'job loss (redundancy)': (3, ['redundancy', 'redundancy', 'redundancy']),<br/> 'job loss (furlough)': (0, [])}</span></pre><h2 id="717c" class="ne lf jg bd lg nf ng dn lk nh ni dp lo mf nj nk lq mj nl nm ls mn nn no lu jm bi translated">6.检查结果</h2><p id="af6a" class="pw-post-body-paragraph lw lx jg ly b lz ma kq mb mc md kt me mf mg mh mi mj mk ml mm mn mo mp mq mr ij bi translated">我们还可以使用我们之前提到的word_scorer来比较上面列出的单词(在这种情况下，它只是“冗余”)与主题的wordnet定义(即。redundancy . n . 02′)，以查看“冗余”一词的哪种用法被认为是相似的</p><figure class="np nq nr ns gt is"><div class="bz fp l di"><div class="nt nu l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">带有相似性得分的word_scorer</p></figure><pre class="np nq nr ns gt nv nw nx ny aw nz bi"><span id="a462" class="ne lf jg nw b gy oa ob l oc od">[('redundancy.n.01',<br/>  'repetition of messages to reduce the probability of errors in transmission',<br/>  0.25),<br/> ('redundancy.n.02', 'the attribute of being superfluous and unneeded', 1.0),<br/> ('redundancy.n.03',<br/>  '(electronics) a system design that duplicates components to provide alternatives in case one component fails',<br/>  0.2222222222222222),<br/> ('redundancy.n.04', 'repetition of an act needlessly', 0.2222222222222222)]</span></pre><p id="9da4" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">返回的相似性分数指向第二个条目(本身),所以在这种情况下，这是一个多余的测试，但是在一个单词被列为不期望的相似的情况下，运行这个测试可以发现该单词的哪个用法被确切地认为是相似的。</p><h1 id="3556" class="le lf jg bd lg lh li lj lk ll lm ln lo kv lp kw lq ky lr kz ls lb lt lc lu lv bi translated">结论</h1><ul class=""><li id="2af1" class="oe of jg ly b lz ma mc md mf os mj ot mn ou mr oj ok ol om bi translated">我们已经创建了一个简单的脚本，它能够根据预先定义的感兴趣的主题对一段文本进行分类(在本例中:银行的脆弱客户)。</li><li id="8059" class="oe of jg ly b lz on mc oo mf op mj oq mn or mr oj ok ol om bi translated">这种方法不需要带标签的训练数据，因为我们正在计算预先计算的词向量之间的相似性得分。</li><li id="638a" class="oe of jg ly b lz on mc oo mf op mj oq mn or mr oj ok ol om bi translated">这种方法还能够执行多标签文本分类，其中一段文本(甚至该文本中的每个单词)可以潜在地分配给多个主题，如果它们足够相似的话。这对于识别具有多个漏洞的客户非常重要。</li></ul><p id="d124" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">总而言之:简单、优雅、灵活的解决方案！</p><p id="975c" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">GitHub回购包含在下面，欢迎任何反馈。</p><div class="ip iq gp gr ir ov"><a href="https://github.com/noahberhe/Vulnerable-Customers" rel="noopener  ugc nofollow" target="_blank"><div class="ow ab fo"><div class="ox ab oy cl cj oz"><h2 class="bd jq gy z fp pa fr fs pb fu fw jp bi translated">Noah berhe/弱势客户</h2><div class="pc l"><h3 class="bd b gy z fp pa fr fs pb fu fw dk translated">根据FCA指南4漏洞的关键驱动因素:健康状况，NLP如何用于识别易受攻击的客户</h3></div><div class="pd l"><p class="bd b dl z fp pa fr fs pb fu fw dk translated">github.com</p></div></div><div class="pe l"><div class="pf l pg ph pi pe pj ix ov"/></div></div></a></div><p id="e334" class="pw-post-body-paragraph lw lx jg ly b lz mw kq mb mc mx kt me mf mz mh mi mj nb ml mm mn nd mp mq mr ij bi translated">…感谢您的阅读！</p></div></div>    
</body>
</html>