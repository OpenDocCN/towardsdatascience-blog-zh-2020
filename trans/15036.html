<html>
<head>
<title>A Guide to A/B Testing — How to Formulate, Design and Interpret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">A/B测试指南——如何制定、设计和解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-guide-to-a-b-testing-how-to-formulate-design-and-interpret-f820cc62e21a?source=collection_archive---------8-----------------------#2020-10-16">https://towardsdatascience.com/a-guide-to-a-b-testing-how-to-formulate-design-and-interpret-f820cc62e21a?source=collection_archive---------8-----------------------#2020-10-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ddcd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用Python实现</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a5410381fa2914baeb15a50b0f811e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPQfoucDs3HFadwbA_9xZQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/concrete-road-between-trees-1563356/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="8ff8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网络世界给了我们一个很好的机会来进行实验和科学地评估不同的想法。由于这些实验是数据驱动的，没有为直觉或直觉提供空间，我们可以在变化及其对用户行为的影响之间建立因果关系。利用这些实验，许多组织可以通过避免所谓的<a class="ae ky" href="https://www.forbes.com/sites/bernardmarr/2017/10/26/data-driven-decision-making-beware-of-the-hippo-effect/" rel="noopener ugc nofollow" target="_blank">河马效应</a>来了解他们客户的喜好和偏好😅</p><p id="e4ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">A/B测试是测试新产品或新功能的常用方法，尤其是在用户界面、营销和电子商务方面。A/B测试的主要原理是将用户分成两组；向<strong class="lb iu">控制组</strong>展示现有产品或功能，向<strong class="lb iu">实验组展示新产品或功能。</strong>最后，评估两组用户的不同反应，决定哪个版本更好。尽管A/B测试是在线业务的常见做法，但从建立实验到正确解释结果，很多事情很容易出错。</p><p id="92b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将发现如何设计一个健壮的A/B测试，为您提供可重复的结果，A/B测试中需要额外注意的主要陷阱是什么，以及如何解释结果。</p><p id="f41e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在我的GitHub上查看<a class="ae ky" href="https://github.com/Idilismiguzel/data_analysis/blob/main/ab_testing/AB_testing.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>以获得完整的分析。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mc"><img src="../Images/d361bab2a9e1d00b41b9b764ff13baeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hr5Y6fMH1ObZPGcmxulCsg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/fGXh4-axxHA" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="1c1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在深入探讨A/B测试之前，我们先来回答以下问题。</p><h2 id="80b7" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated"><strong class="ak"> 1。可以考什么？</strong></h2><p id="8955" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">可见和不可见的变化都可以用A/B测试来测试。<strong class="lb iu">可见变化</strong>的例子可以是用户界面的新增内容、设计和布局的变化或标题信息。一个非常受欢迎的例子是<a class="ae ky" href="https://www.nytimes.com/2009/03/01/business/01marissa.html" rel="noopener ugc nofollow" target="_blank">谷歌的</a> 41(是，不是2)种不同蓝色阴影实验，他们随机向每2.5%的用户展示一种蓝色阴影，以了解哪种颜色阴影赢得更多点击。<strong class="lb iu">不可见变化</strong>的例子可以是页面加载时间或测试不同的推荐算法。一个流行的例子是<a class="ae ky" href="http://radar.oreilly.com/2008/08/radar-theme-web-ops.html" rel="noopener ugc nofollow" target="_blank">亚马逊的</a> A/B测试显示，页面加载时间每增加100毫秒，销售额就会下降1%。</p><h2 id="0321" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated"><strong class="ak"> 2。什么不能考？</strong></h2><p id="187c" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">新体验不适合实施A/B测试。因为一个新的体验可以表现出<a class="ae ky" href="https://en.wiktionary.org/wiki/change_aversion" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">厌恶变化</strong> </a>的行为，用户不喜欢变化，更喜欢坚持旧版本，或者它可以表现出<a class="ae ky" href="https://en.wikipedia.org/wiki/Novelty_effect" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">新奇效果</strong> </a> <strong class="lb iu"> </strong>用户感到非常兴奋，想要测试出一切。在这两种情况下，定义比较的基线和决定测试的持续时间是困难的。</p><h2 id="8dc6" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated"><strong class="ak"> 3。我们如何选择指标？</strong></h2><p id="966f" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">度量选择需要同时考虑灵敏度和稳健性。<strong class="lb iu">敏感性</strong>意味着指标应该能够捕捉到变化，而<strong class="lb iu">稳健性</strong>意味着指标不应该因为不相关的影响而改变太多。例如，大多数情况下，如果指标是一个“平均值”，那么它对异常值很敏感，但不够稳健。如果指标是“中值”，那么它是稳健的，但对小组变化不敏感。</p><p id="d121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了在度量选择中考虑灵敏度和鲁棒性，我们可以在创建控制和实验样本时应用过滤和分割。过滤和细分可以基于用户人口统计(即年龄、性别)、平台语言、互联网浏览器、设备类型(即iOS或Android)、群组等。</p><h2 id="5844" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">4.管道是什么？</h2><ul class=""><li id="63e1" class="nb nc it lb b lc mw lf mx li nd lm ne lq nf lu ng nh ni nj bi translated">阐明假设</li><li id="fc7c" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">设计实验</li><li id="bd24" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">收集数据</li><li id="a45a" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">推论/结论</li></ul><p id="28f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">A/B测试的过程始于一个假设。基线假设，或者换句话说，<strong class="lb iu">零假设</strong>，假设处理是相等的，并且由于偶然性，对照组和实验组之间的任何差异是<em class="np">。<strong class="lb iu">替代假设</strong>假设零假设是错误的，控制组和实验组的结果比随机产生的结果更加不同。A/B检验旨在以这样一种方式检验假设，即两组之间观察到的差异应该是由于随机的机会或由于两组之间的真实差异。提出假设后，我们收集数据并得出结论。<strong class="lb iu">结果的推断</strong>反映了应用从实验样本中得出的结论的意图，这些结论适用于整个群体。</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="274c" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">让我们看一个例子...</h2><p id="2fea" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">假设您正在运行一个UI实验，想要了解初始布局和新布局的转换率之间的差异。(假设您想了解将“购买”按钮的颜色从红色改为蓝色的影响🔴🔵)</p><p id="c073" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个实验中，零假设假设转换率相等，如果有差异，这只是由于<em class="np">的机会因素</em>。相比之下，另一个假设假设转换率之间存在统计学上的显著差异。</p><blockquote class="nq"><p id="ec4d" class="nr ns it bd nt nu nv nw nx ny nz lu dk translated">零假设-&gt; Ho : CR_red = CR_blue</p><p id="ad6e" class="nr ns it bd nt nu nv nw nx ny nz lu dk translated">另类假设-&gt; H1 : CR_red ≠ CR_blue</p></blockquote><p id="9834" class="pw-post-body-paragraph kz la it lb b lc oa ju le lf ob jx lh li oc lk ll lm od lo lp lq oe ls lt lu im bi translated">在制定假设并进行实验后，我们在<a class="ae ky" href="https://en.wikipedia.org/wiki/Contingency_table" rel="noopener ugc nofollow" target="_blank">列联表</a>中收集了以下数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/a3758a7b6fbf9ff2be5f666feb1b2430.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*WQiErESYFJNELzYsnxnKIA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">《出埃及记》测试结果:控制组(CG)看到初始布局，实验组(EG)看到新的布局</p></figure><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="d368" class="md me it oh b gy ol om l on oo">The conversion rate of CG is: 150/150+23567 = 0.632%</span><span id="14f9" class="md me it oh b gy op om l on oo">The conversion rate of EG is: 165/165+23230 = 0.692%</span><span id="6fda" class="md me it oh b gy op om l on oo">From these conversion rates, we can calculate the relative uplift between conversion rates: (0.692%-0.632%)/0.632% = 9.50%</span></pre><p id="2460" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面截取的代码中可以看出，改变布局将转换率提高了0.06个百分点。但这是偶然的还是彩色change❔的成功</p><p id="b2a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过以下两种方式来分析结果:</p><h2 id="5871" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated"><strong class="ak"> 1。应用统计假设检验</strong></h2><p id="e270" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">使用统计显著性检验，我们可以衡量收集的数据是否显示了比可能产生的结果更极端的结果。如果结果超出了机会变异，那么它在统计上是显著的<em class="np">。</em>在本例中，我们有偶然性数据格式的分类变量，它们遵循<a class="ae ky" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank">伯努利分布</a>。伯努利分布有一个概率为1，一个概率为0。在我们的示例中，转化率=1，无转化率=0。考虑到我们使用转换率作为度量，这是一个遵循伯努利分布的分类变量，我们将使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Chi-squared_test" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">卡方检验</strong> </a> <strong class="lb iu"> </strong>来解释结果。</p><p id="999d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">卡方检验假设分类变量的观察频率与预期频率匹配。它计算具有卡方分布的检验统计量(Chi ),如果预期频率和观察频率相同，则解释为拒绝或未能拒绝零假设。在本文中，我们将使用<code class="fe oq or os oh b">scipy.stats</code>包来实现统计功能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/ed5832cad4ed3f98af85ccff230c8235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*GdB36AvvPUdZap55sYOHsA.png"/></div></figure><p id="f1b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">卡方分布的<a class="ae ky" href="https://en.wikipedia.org/wiki/Chi-square_distribution" rel="noopener ugc nofollow" target="_blank">概率密度函数</a>随<strong class="lb iu">自由度(df) </strong>变化，自由度(df)取决于列联表的大小，在本例中计算为<code class="fe oq or os oh b">df=(#rows-1)*(#columns-1)</code>df = 1。</p><p id="2147" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Python解释测试结果我们需要知道的关键术语是<a class="ae ky" href="https://en.wikipedia.org/wiki/P-value" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> p值</strong> </a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Statistical_significance" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> alpha </strong> </a> <strong class="lb iu">。</strong> P值是在假设零假设正确的情况下，获得至少与实际观察到的结果一样极端的检验结果的概率。p值是测试的结果之一。Alpha也称为统计显著性水平，是犯<strong class="lb iu">I型错误</strong>的概率(拒绝实际为真的零假设)。犯第二类错误(当零假设实际上为假时，未能拒绝零假设)的概率被称为beta，但这超出了本文的范围。一般来说，α取0.05，表示当没有实际差异时，得出组间存在差异的风险为5%。</p><p id="4b0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就p值和选定的显著性水平(α)而言，测试可解释如下:</p><ul class=""><li id="fa8b" class="nb nc it lb b lc ld lf lg li ou lm ov lq ow lu ng nh ni nj bi translated"><strong class="lb iu">如果p值&lt;=α</strong>:显著结果，拒绝零假设</li><li id="2c1d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><strong class="lb iu">如果p值&gt;α</strong>:不是显著结果，不要拒绝零假设</li></ul><p id="1c83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以通过使用测试统计和临界值来解释测试结果:</p><ul class=""><li id="8afb" class="nb nc it lb b lc ld lf lg li ou lm ov lq ow lu ng nh ni nj bi translated"><strong class="lb iu">如果检验统计量&gt; =临界值</strong>:显著结果，拒绝零假设</li><li id="cc13" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated"><strong class="lb iu">如果检验统计量&lt;临界值</strong>:没有显著结果，不要拒绝零假设</li></ul><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="282c" class="md me it oh b gy ol om l on oo">### chi2 test on contingency table<br/>print(table)<br/>alpha = 0.05<br/>stat, p, dof, expected = stats.chi2_contingency(table)</span><span id="1c5b" class="md me it oh b gy op om l on oo">### interpret p-value<br/>print('significance=%.3f, p=%.3f' % (alpha, p))<br/>if p &lt;= alpha:<br/>    print('Reject null hypothesis)')<br/>else:<br/>    print('Do not reject null hypothesis')<br/>    <br/>### interpret test-statistic<br/>prob = 1 - alpha<br/>critical = stats.chi2.ppf(prob, dof)<br/>print('probability=%.3f, critical=%.3f, stat=%.3f' % (prob, critical, stat))<br/>if abs(stat) &gt;= critical:<br/>    print('Reject null hypothesis)')<br/>else:<br/>    print('Do not reject null hypothesis')</span></pre><blockquote class="ox oy oz"><p id="70d5" class="kz la np lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">[[150 23717]<br/>【165 23395]]<br/>显著性=0.050，p=0.365 <br/>不拒绝零假设<br/>概率=0.950，临界=3.841，统计=0.822 <br/>不拒绝零假设</p></blockquote><p id="eaec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从结果中可以看出，我们没有拒绝零假设，换句话说，转换率之间的正相对差异并不显著。</p><h2 id="86aa" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated"><strong class="ak"> 2。执行排列测试</strong></h2><p id="c327" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">排列测试是我最喜欢的技术之一，因为它不要求数据是数字或二进制的，样本大小可以相似或不同。此外，不需要关于正态分布数据的假设。</p><p id="1c1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">置换意味着改变一组值的顺序，置换测试所做的是组合两组的结果，并通过从组合的组中随机抽取组(等于实验组的样本大小)并分析它们彼此之间的差异来测试零假设。用户决定多少次，测试就重复做多少次(比如说1000次)。最后，用户应该将实验组和对照组之间观察到的差异与置换差异集进行比较。如果观察到的差异位于置换差异的集合内，我们不拒绝零假设。但是，如果观察到的差异位于最大排列分布之外，我们拒绝零假设，并得出结论，因为A/B测试结果在统计上是显著的，而不是由于偶然。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="4921" class="md me it oh b gy ol om l on oo">### Function to perform permutation test<br/>def perm_func(x, nA, nB):<br/>   n = nA + nB<br/>   id_B = set(random.sample(range(n), nB))<br/>   id_A = set(range(n)) — id_B<br/>   return x.loc[idx_B].mean() — x.loc[id_A].mean()</span><span id="9285" class="md me it oh b gy op om l on oo">### Observed difference from experiment<br/>obs_pct_diff = 100 * (150 / 23717–165 / 23395)</span><span id="1f24" class="md me it oh b gy op om l on oo">### Aggregated conversion set<br/>conversion = [0] * 46797<br/>conversion.extend([1] * 315)<br/>conversion = pd.Series(conversion)</span><span id="f71d" class="md me it oh b gy op om l on oo">### Permutation test<br/>perm_diffs = [100 * perm_fun(conversion, 23717, 23395)<br/>    for i in range(1000)]</span><span id="29ee" class="md me it oh b gy op om l on oo">### Probability<br/>print(np.mean([diff &gt; obs_pct_diff for diff in perm_diffs]))</span></pre><blockquote class="ox oy oz"><p id="2575" class="kz la np lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi">0.823</p></blockquote><p id="2b9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个结果告诉我们，大约82%的情况下，我们会随机得出实验结果。</p><p id="5580" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们可以绘制排列测试差异的直方图，并突出显示观察到的差异所在。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="bd4c" class="md me it oh b gy ol om l on oo">fig, ax = plt.subplots(figsize=(5, 5))<br/>ax.hist(perm_diffs, rwidth=0.9)<br/>ax.axvline(x=obs_pct_diff, lw=2)<br/>ax.text(-0.18, 200, ‘Observed\ndifference’, bbox={‘facecolor’:’white’})<br/>ax.set_xlabel(‘Conversion rate (in percentage)’)<br/>ax.set_ylabel(‘Frequency’)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/977c5f808695f0b69cbcea332bd93d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ieq5-s094eZFg7Wb-pmXHw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有观察到的差异线的置换差异直方图</p></figure><p id="8720" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如图所示，观察到的差异位于大多数置换差异内，支持卡方检验的“不拒绝零假设”结果。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="5e77" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">让我们看另一个例子..</h2><p id="fcf6" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">假设我们使用平均会话时间作为度量来分析A/B测试的结果。我们的目标是了解页面的新设计是否会引起用户更多的关注，并增加他们在页面上的停留时间。<br/>代表不同用户id的前几行如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/40c94b4b156694cea4f75879e477c0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:252/format:webp/1*yD40mBaZe25wWbIVPHl3Zg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据样本</p></figure><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="8f70" class="md me it oh b gy ol om l on oo">### Average difference between control and test samples<br/>mean_cont = np.mean(data[data["Page"] == "Old design"]["Time"])<br/>mean_exp = np.mean(data[data["Page"] == "New design"]["Time"])<br/>mean_diff = mean_exp - mean_cont<br/>print(f"Average difference between experiment and control samples is: {mean_diff}")</span><span id="532c" class="md me it oh b gy op om l on oo">### Boxplots<br/>sns.boxplot(x=data["Page"], y=data["Time"], width=0.4)</span></pre><blockquote class="ox oy oz"><p id="0e62" class="kz la np lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">实验样品和对照样品之间的平均差异为:22.85</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/17363d07507e9043201b78325082ec18.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*-VC03LBo6tL_Bu5-Kx9r6A.png"/></div></figure><p id="f0ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们将从以下两个方面分析结果:</p><h2 id="02fb" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">1.应用统计假设检验</h2><p id="adfd" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在本例中，我们将使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Student%27s_t-test" rel="noopener ugc nofollow" target="_blank">t-检验(或学生的t-检验)</a>，因为我们有数字数据。t-检验是最常用的统计检验之一，在这种检验中，检验统计量在零假设下遵循学生的<em class="np"> t </em>分布。在样本量较小且总体标准偏差未知的情况下，估计正态分布总体的均值时使用t分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/960f87150d6ce1299204f36306147492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ecgMUD2ClhrNzGglTRfEAg.png"/></div></figure><p id="5a85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">t分布像正态分布一样呈对称的钟形，但尾部更厚更长，这意味着它更容易产生远离平均值的值。如图所示，样本量越大，t分布就越正常。</p><p id="e5b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此分析中，我们将使用<code class="fe oq or os oh b">scipy.stats.mstats.ttest_ind</code>来计算两个独立样本平均值的t检验。这是对两个独立样本具有(预期的)相同平均值的零假设的双边检验。作为参数，我们必须设置<code class="fe oq or os oh b">equal_var=False</code>来执行Welch的t-检验，该检验不假设控制样本和实验样本之间的总体方差相等。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="1a11" class="md me it oh b gy ol om l on oo">### t-Test on the data<br/>test_res = stats.ttest_ind(data[data.Page ==  "Old design"]["Time"], <br/>                      data[data.Page == "New design"]["Time"],<br/>                      equal_var=False)<br/>print(f'p-value for single sided test: {test_res.pvalue / 2:.4f}')<br/>if test_res.pvalue &lt;= alpha:<br/>    print('Reject null hypothesis)')<br/>else:<br/>    print('Do not reject null hypothesis')</span></pre><blockquote class="ox oy oz"><p id="1492" class="kz la np lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">单侧检验的p值:0.1020 <br/>不要拒绝零假设</p></blockquote><p id="7844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从结果中可以看出，我们没有拒绝零假设，这意味着实验样本和对照样本之间的正平均差异不显著。</p><p id="669d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。执行排列测试</strong></p><p id="b1a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在前面的例子中所做的，我们可以通过迭代1000次来执行排列测试。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="d4e6" class="md me it oh b gy ol om l on oo">nA = data[data.Page == 'Old design'].shape[0]<br/>nB = data[data.Page == 'New design'].shape[0]</span><span id="e8d2" class="md me it oh b gy op om l on oo">perm_diffs = [perm_fun(data.Time, nA, nB) for _ in range(1000)]</span><span id="c232" class="md me it oh b gy op om l on oo">larger=[i for i in perm_diffs if i &gt; mean_exp-mean_cont]<br/>print(len(larger)/len(perm_diffs))</span></pre><blockquote class="ox oy oz"><p id="fb3a" class="kz la np lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi">0.102</p></blockquote><p id="1e69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个结果告诉我们，大约有10%的时间，我们会随机地得到实验结果。</p><pre class="kj kk kl km gt og oh oi oj aw ok bi"><span id="8425" class="md me it oh b gy ol om l on oo">fig, ax = plt.subplots(figsize=(8, 6))<br/>ax.hist(perm_diffs, rwidth=0.9)<br/>ax.axvline(x = mean_exp — mean_cont, color=’black’, lw=2)<br/>ax.text(25, 190, ‘Observed\ndifference’, bbox={‘facecolor’:’white’})<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/8e6c073be16d649453817a0fa8b8c8db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*zm-8aJwCy8dzwqIDJu7UHQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有观察到的差异线的置换差异直方图</p></figure><p id="485b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如图所示，观察到的差异位于大多数置换差异内，支持t检验的“不拒绝零假设”结果。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="7648" class="md me it bd mf mg mh dn mi mj mk dp ml li mm mn mo lm mp mq mr lq ms mt mu mv bi translated">奖金</h2><ol class=""><li id="2506" class="nb nc it lb b lc mw lf mx li nd lm ne lq nf lu pf nh ni nj bi translated">为了设计一个稳健的实验，强烈建议确定<strong class="lb iu">不变检查</strong>的指标。这些度量标准不应该在控制组和实验组之间改变，并且可以用于健全性检查。</li><li id="ddbc" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu pf nh ni nj bi translated">在A/B检验中，重要的是确定代表总体的实验组和对照组的样本量。在这样做的时候，我们需要注意两点:<strong class="lb iu">随机性</strong>和<strong class="lb iu">代表性</strong>。样本的随机性是达到无偏结果的必要条件，代表性是捕捉所有不同用户行为的必要条件。</li><li id="2da4" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu pf nh ni nj bi translated"><a class="ae ky" href="https://www.evanmiller.org/ab-testing/sample-size.html" rel="noopener ugc nofollow" target="_blank">在线工具</a>可用于计算实验所需的<strong class="lb iu">最小样本量</strong>。</li><li id="8902" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu pf nh ni nj bi translated">在运行实验之前，最好确定<strong class="lb iu">期望升程值</strong>。有时，即使测试结果在统计上有意义，也可能没有实际意义。如果变革不能带来预期的提升，组织可能不喜欢执行变革。</li><li id="935d" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu pf nh ni nj bi translated">如果您正在处理一个样本数据集，但您希望了解人口行为，您可以在分析中包含<strong class="lb iu">重采样方法</strong>。你可以阅读我的文章<a class="ae ky" rel="noopener" target="_blank" href="/resampling-methods-for-inference-analysis-e75fecfefcb2">推论分析的重采样方法</a>(附后)了解更多⚡</li></ol><div class="pg ph gp gr pi pj"><a rel="noopener follow" target="_blank" href="/resampling-methods-for-inference-analysis-e75fecfefcb2"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd iu gy z fp po fr fs pp fu fw is bi translated">推理分析的重采样方法</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">当你有一个样本，但你想了解人口</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">towardsdatascience.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px ks pj"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="95c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢阅读这篇文章，并发现它很有用！</p><p id="782f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="np">如果你喜欢这篇文章，你可以</em><strong class="lb iu"><em class="np"/></strong><a class="ae ky" href="https://medium.com/@idilismiguzel" rel="noopener"><strong class="lb iu"><em class="np">在这里阅读我的其他文章</em></strong></a><strong class="lb iu"><em class="np"/></strong><em class="np">和</em> <a class="ae ky" href="http://medium.com/@idilismiguzel/follow" rel="noopener"> <strong class="lb iu"> <em class="np">关注我上媒</em></strong></a><strong class="lb iu"><em class="np"/></strong>如果您有任何问题或建议，请告诉我。✨</p><p id="430a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢这篇文章吗？ <a class="ae ky" href="https://idilismiguzel.medium.com/membership" rel="noopener"> <strong class="lb iu">成为会员求更！</strong> </a></p></div></div>    
</body>
</html>