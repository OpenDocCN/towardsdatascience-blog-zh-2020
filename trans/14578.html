<html>
<head>
<title>Python Pandas Iterating a DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python熊猫迭代数据帧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-pandas-iterating-a-dataframe-eb7ce7db62f8?source=collection_archive---------5-----------------------#2020-10-08">https://towardsdatascience.com/python-pandas-iterating-a-dataframe-eb7ce7db62f8?source=collection_archive---------5-----------------------#2020-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="04fb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解使用Python迭代熊猫数据帧的不同方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4f5f6831e37d3cbe7a434db16300d0b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lGBoUgbwmZBKrhgs"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@maicol_santos?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Maicol Santos </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="8ed1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="65d3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">作为一名数据科学家，我们有时会遇到低质量的数据。为了取得成功，我们需要能够在任何分析之前有效地管理数据质量问题。谢天谢地，有几个强大的开源库，我们可以利用它们来有效地处理数据，比如<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/index.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>。今天我们将看看我们可以循环访问一个<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html" rel="noopener ugc nofollow" target="_blank">数据帧</a>并访问其值的不同方法。迭代数据帧可以被合并到初始探索性数据分析之后的步骤中，以开始清理原始数据。</p><h1 id="91a2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">入门指南</h1><h2 id="b1c3" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">熊猫是什么？</h2><p id="98a1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于那些刚接触数据科学或不熟悉Pandas的人来说，Pandas是一个用Python编写的开源库。它提供了易于使用的现成功能来接收和分析关系数据。Pandas支持多种文件类型的消费，例如CSV、Excel、JSON、XML、HTML和SQL等等。</p><h2 id="9639" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">安装熊猫</h2><p id="ebd2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">安装Pandas最简单的方法是使用<a class="ae ky" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>，它通过在终端运行命令<code class="fe mz na nb nc b">pip install pandas</code>使用<code class="fe mz na nb nc b">pip</code>从源代码安装Pandas。具体操作系统的详细安装说明可以在Pandas <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html" rel="noopener ugc nofollow" target="_blank">入门</a>页面上找到，或者如果您正在使用<a class="ae ky" href="https://www.jetbrains.com/pycharm/" rel="noopener ugc nofollow" target="_blank"> PyCharm </a>说明可以在<a class="ae ky" rel="noopener" target="_blank" href="/learning-pandas-profiling-fc533336edc7">学习Pandas Profiling </a>中找到。</p><h2 id="0d38" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">熊猫数据框</h2><p id="eb1d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于大多数人来说，Pandas将数据收集到两个对象中的一个:</p><ul class=""><li id="9b9e" class="nd ne it lt b lu nf lx ng ma nh me ni mi nj mm nk nl nm nn bi translated"><strong class="lt iu">系列</strong>:系列是一维<a class="ae ky" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html" rel="noopener ugc nofollow" target="_blank"> ndarry </a>对象。</li><li id="08b2" class="nd ne it lt b lu no lx np ma nq me nr mi ns mm nk nl nm nn bi translated"><strong class="lt iu">数据帧</strong>:数据帧是一个二维数据结构，包含带标签的行和列。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示系列和数据帧的构造函数的Python代码片段。</p></figure><h1 id="4895" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">迭代数据帧</h1><p id="d59e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于本例，我们已经创建了一个带有明确命名的行和列的DataFrame，以帮助您入门并演示数据结构。通常，我们只命名列，并允许行索引自动生成一个数值范围。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码片段将生成一个3列5行的熊猫数据帧。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/14250c2fcbf884b1862c6025ec5ed6c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*rFG7I1H77xCpIChdlEyI7Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">控制台输出显示了上述Python代码片段的结果。</p></figure><p id="ef43" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">执行完Python代码片段后，您应该会收到类似上面的输出。在这里，您可以清楚地看到Pandas DataFrame对象是如何使用一系列行和列来构造的。</p><h2 id="2917" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">DataFrame.iterrows()</h2><p id="07e4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">遍历数据帧的第一种方法是使用Pandas <code class="fe mz na nb nc b">.iterrows()</code>，它使用索引行对遍历数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">展示如何使用熊猫的Python片段。iterrows()内置函数。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/a571924712cc0c4470466d1b82f5e889.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*52fILj8S7N8wm-k0ewFnxg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">控制台输出显示了使用。iterrows()。</p></figure><p id="2c1c" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">在DataFrame上调用了<code class="fe mz na nb nc b">.iterrows()</code>之后，我们就可以访问作为行标签的<code class="fe mz na nb nc b">index</code>和代表行本身值的序列<code class="fe mz na nb nc b">row</code>。上面的代码片段利用了<code class="fe mz na nb nc b">Series.values</code>,它为被引用的行返回每列中所有值的n数组。</p><p id="1069" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">在<code class="fe mz na nb nc b">.iterrows()</code>中，<code class="fe mz na nb nc b">row</code>变量是Series类型，这意味着我们可以通过数据帧的指定列来访问值。例如，如果我们只对<code class="fe mz na nb nc b">column_a</code>感兴趣，我们可以使用下面的代码片段只返回那些值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码片段显示了如何在使用？iterrows()。</p></figure><p id="5e78" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">上面的代码片段还演示了一种通过<code class="fe mz na nb nc b">row.get('column_name', default_value)</code>而不是<code class="fe mz na nb nc b">row['column_name']</code>来检查行中的列的更安全的方法。如果我们在寻找一个不存在的列,<code class="fe mz na nb nc b">row['column_name']</code>会引发一个<code class="fe mz na nb nc b">KeyError</code>异常。</p><h2 id="dea3" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">DataFrame.itertuples()</h2><p id="792c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">迭代数据帧的下一个方法是<code class="fe mz na nb nc b">.itertuples()</code>，它返回一个迭代器，包含代表列名和值的名称元组。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示熊猫语法的Python片段。itertuples()内置函数。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/d9028d3e6aa056cd819eae1ff1c95fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*qqKCyWoBuzJwHld0b9L_FQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示调用结果的控制台输出。数据帧上的itertuples()。</p></figure><p id="b3a1" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">这个方法仍然提供了通过语法<code class="fe mz na nb nc b">row.column_name</code>隔离单个列的能力。如果我们只需要返回一个元组，我们可以将<code class="fe mz na nb nc b">name=None</code>和<code class="fe mz na nb nc b">index=False</code>传递给<code class="fe mz na nb nc b">.intertuples()</code>，这将从每一行中删除指定的列和索引。</p><h1 id="d28c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">最佳实践</h1><p id="8c67" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">虽然能够使用<code class="fe mz na nb nc b">.iterrows()</code>和<code class="fe mz na nb nc b">.itertuples()</code>迭代数据帧很方便，但一般来说，建议不要这样做，因为对于较大的数据帧，性能会很慢。通常，当人们想要迭代一个数据帧时，需要添加一个计算列或者重新格式化一个现有的列。Pandas通过其内置函数<code class="fe mz na nb nc b">.apply()</code>提供这种类型的功能。<code class="fe mz na nb nc b">.apply()</code>函数为更新数据帧提供了更有效的方法。<a class="ae ky" rel="noopener" target="_blank" href="/pandas-apply-for-power-users-f44d0e0025ce">熊猫申请权力用户</a>深入了解熊猫<code class="fe mz na nb nc b">.apply()</code>。</p><h1 id="70be" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="f1cc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Pandas提供了几种方法，我们作为数据科学家可以使用这些方法来迭代数据帧，比如<code class="fe mz na nb nc b">.iterrows()</code>和<code class="fe mz na nb nc b">.itertuples()</code>。<code class="fe mz na nb nc b">.iterrows()</code>和<code class="fe mz na nb nc b">.itertuples()</code>都提供了强大的安全方法来访问数据帧行值。虽然许多具有编程背景的新数据科学家可能倾向于熟悉数据帧上的循环，但Pandas通过内置的apply函数提供了一种更有效的方法。</p><p id="69b3" class="pw-post-body-paragraph lr ls it lt b lu nf ju lw lx ng jx lz ma nw mc md me nx mg mh mi ny mk ml mm im bi translated">感谢您花时间阅读我们的故事，我们希望您发现它有价值！</p></div></div>    
</body>
</html>