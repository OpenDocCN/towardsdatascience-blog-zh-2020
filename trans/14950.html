<html>
<head>
<title>Elo Merchant Category Recommendation — An Machine Learning Case Study</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Elo商家类别推荐——机器学习案例研究</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/elo-merchant-category-recommendation-a-case-study-33e84b8465c7?source=collection_archive---------28-----------------------#2020-10-14">https://towardsdatascience.com/elo-merchant-category-recommendation-a-case-study-33e84b8465c7?source=collection_archive---------28-----------------------#2020-10-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/c5618d1b4e79f24ed191ac7fa2bc109c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwh4ElgPDfTIF0AfGxrdxQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://unsplash.com/photos/1K6IQsQbizI?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink" rel="noopener ugc nofollow" target="_blank">弗雷姆基·查马基</a>拍摄</p></figure><div class=""/><p id="6f85" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在当今的现代，机器学习几乎涉及到我们生活的方方面面。从提供电影和产品推荐这样简单的事情到利用商业数据为组织推断和做出商业决策这样复杂的事情，机器学习和人工智能在过去几十年里已经走过了漫长的道路。今天，我将讨论一个关于Elo Merchant类别推荐的例子——一个我喜欢从事的机器学习(ML)案例研究。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="c881" class="li lj jg bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">案例研究概述:</h1><p id="e68b" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">案例研究方法分为以下步骤:</p><ul class=""><li id="1d3b" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">商业问题</li><li id="d653" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">ML问题公式化</li><li id="979b" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">探索性数据分析</li><li id="1ec8" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">特征工程</li><li id="c27b" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">特征关联和特征选择</li><li id="8e26" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">回归模型</li><li id="c077" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">结论和结果</li></ul></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="8822" class="li lj jg bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">商业问题</h1><p id="74a8" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">Elo是巴西最大的支付品牌之一。它们为用户提供餐馆推荐以及基于用户的信用卡提供商和餐馆偏好的折扣。Elo与各种品牌建立了合作关系，为用户提供来自不同商家的促销和折扣。</p><p id="1087" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们手头的问题是找出这些促销对商家以及用户(顾客)有多大的用处和益处。我们需要弄清楚顾客是否真的使用了提供给他们的这些促销或折扣。这可以通过预测一个称为客户忠诚度得分的指标来实现，该指标是目标变量。因此每张卡都有相应的预测忠诚度得分。</p><p id="7fb4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">客户忠诚度得分将让我们了解用户/客户使用这些促销和折扣的频率。有了预测数据，公司(Elo)现在可以专注于更忠诚的客户。这意味着他们可以将他们的营销努力指向这些忠诚的客户。这也将确保Elo减少针对预计客户忠诚度较低的客户的不必要的营销活动。这将最终提高客户保持率。</p><h1 id="e341" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">ML问题公式化</h1><p id="4de2" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">尽管顾名思义，这是一个回归问题，因为对于给定的卡ID，我们需要根据卡的交易和商户数据来预测它的忠诚度得分。因此，我们将根据这些数据生成的特征来训练我们的回归模型。然后，这些回归模型将根据生成的特征预测忠诚度得分。</p><h2 id="80e3" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">数据概述</h2><p id="fade" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">所有数据都是模拟的和虚构的，并不是真实的客户数据，原因很明显。所提供的数据包含每个卡ID长达3个月的交易数据。它还包含基于这些交易中涉及的商家的商家数据。还有一个附加文件，其中包含另外2个月的所有购买/交易数据，这些数据不包括在3个月的初始交易数据中。以下是每个文件的详细描述:</p><ol class=""><li id="c137" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la nq mr ms mt bi translated"><strong class="kf jh"> Data_Dictionary.xlsx </strong> →该文件包含每个csv文件的数据字段描述。</li><li id="2c75" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><strong class="kf jh"> train.csv和test.csv </strong> →这些文件包含卡id(Card _ id)和关于卡的信息。它们还包含需要预测的目标变量(忠诚度得分)。下面是对每个列的描述:</li></ol><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="82b3" class="ne lj jg nw b gy oa ob l oc od"><em class="oe">card_id</em> → Unique card identifier<br/><em class="oe">first_active_month</em> → month of first purchase in 'YYYY-MM' format<br/><em class="oe">feature_1</em> → Anonymized card categorical feature<br/><em class="oe">feature_2</em>→ Anonymized card categorical feature<br/><em class="oe">feature_3</em> → Anonymized card categorical feature<br/><em class="oe">target</em> → Loyalty numerical score calculated 2 months after historical and evaluation period</span></pre><p id="8133" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.<strong class="kf jh"> historical_transactions.csv和new _ merchant _ transactions . CSV</strong>→这些文件包含交易数据。它们包含每张卡的交易信息。下面是对每个列的描述:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="ef19" class="ne lj jg nw b gy oa ob l oc od"><em class="oe">card_id </em>→ Card identifier<br/><em class="oe">month_lag </em>→ month lag to reference date<br/><em class="oe">purchase_date</em> → Purchase date<br/><em class="oe">authorized_flag</em> → 'Y' if approved, 'N' if denied<br/><em class="oe">category_3</em> → anonymized category<br/><em class="oe">installments</em> → number of installments of purchase<br/><em class="oe">category_1</em> → anonymized category<br/><em class="oe">merchant_category_id </em>→ Merchant category identifier(anonymized)<br/><em class="oe">subsector_id</em> → Merchant category group identifier(anonymized)<br/><em class="oe">merchant_id</em> → Merchant identifier(anonymized)<br/><em class="oe">purchase_amount </em>→ Normalized purchase amount<br/><em class="oe">city_id</em> → City identifier(anonymized)<br/><em class="oe">state_id </em>→ State identifier (anonymized)<br/><em class="oe">category_2</em> → anonymized category</span></pre><p id="4cf6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.<strong class="kf jh"> merchants.csv </strong> →该文件包含交易中涉及的商家的附加信息。下面是对每个列的描述:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="7647" class="ne lj jg nw b gy oa ob l oc od"><em class="oe">merchant_id</em> → Unique merchant identifier<br/><em class="oe">merchant_group_id</em> → Merchant group(anonymized)<br/><em class="oe">merchant_category_id</em> → Unique identifier for merchant category (anonymized)<br/><em class="oe">subsector_id</em> → Merchant category group (anonymized)<br/><em class="oe">numerical_1</em> → anonymized measure<br/>numerical_2 → anonymized measure<br/><em class="oe">category_1</em> → anonymized category<br/><em class="oe">category_2</em> → anonymized category<br/><em class="oe">category_4</em> → anonymized category<br/><em class="oe">city_id</em> → City identifier(anonymized)</span><span id="a86e" class="ne lj jg nw b gy of ob l oc od"><em class="oe">most_recent_sales_range</em> → Range of revenue (monetary units) in last active month (A &gt; B &gt; C &gt; D &gt; E)<em class="oe"><br/>most_recent_sales_range</em> → Range of revenue (monetary units) in last active month (A &gt; B &gt; C &gt; D &gt; E)<br/><em class="oe">most_recent_purchases_range</em> → Range of quantity of transactions in last active month (A &gt; B &gt; C &gt; D &gt; E)</span><span id="1bd6" class="ne lj jg nw b gy of ob l oc od"><em class="oe">avg_sales_lag3</em> → Monthly average of revenue in last 3 months divided by revenue in last active month<br/><em class="oe">avg_purchases_lag3</em> → Monthly average of transactions in last 3 months divided by transactions in last active month<br/><em class="oe">active_months_lag3</em> → Quantity of active months within last 3 months</span><span id="7dce" class="ne lj jg nw b gy of ob l oc od"><em class="oe">avg_sales_lag6</em> → Monthly average of revenue in last 6 months divided by revenue in last active month<br/><em class="oe">avg_purchases_lag6</em> → Monthly average of transactions in last 6 months divided by transactions in last active month<br/><em class="oe">active_months_lag6</em> → Quantity of active months within last 6 months</span><span id="92cb" class="ne lj jg nw b gy of ob l oc od"><em class="oe">avg_sales_lag12</em> → Monthly average of revenue in last 12 months divided by revenue in last active month<br/><em class="oe">avg_purchases_lag12</em> → Monthly average of transactions in last 12 months divided by transactions in last active month<br/><em class="oe">active_months_lag12</em> → Quantity of active months within last 12 months</span></pre><p id="7fdb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的数据文件都可以从<a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/data" rel="noopener ugc nofollow" target="_blank">这个链接</a>下载。</p><h2 id="62f9" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">绩效指标</h2><p id="65c7" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">为了根据实际忠诚度得分计算预测误差，我们将使用的性能指标是<a class="ae jd" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank"> RMSE(均方根误差)</a>。</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ef103843f83198cabbf580d743c55700.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/0*ju3BVIh2TCLrpcgB"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">作者图片</p></figure><p id="dab6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里，ŷ是预测的忠诚度得分，y是每个卡ID的实际忠诚度得分。</p><h1 id="042d" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">探索性数据分析</h1><h2 id="140a" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">培训和测试文件</h2><ol class=""><li id="8807" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated"><strong class="kf jh">目标变量分布:</strong></li></ol><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e9385b5b4501fc0d452a730580fd376c.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*qCdFoJ-4XwoXg9EAcmLXNg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">目标变量分布(作者图片)</p></figure><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/d1e21a475826281f4c156b8ab66f999d.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*BC9ReWwSu-DKPJYUyZ4JNg.png"/></div></figure><p id="f07e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大多数忠诚度得分在-1和1之间。同样，这些都以零为中心。所以有可能这些已经标准化了。</p><p id="70bb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们所见，有些点离所有的点都很远。这些人的忠诚度低于-30。因为这些点构成了数据的1%,所以它们不能被称为异常值。这完全取决于这些点是否出现在我们的测试数据中。正如我们在后面的阶段会知道的，我们在测试数据中确实有这些点。所以，我们称它们为稀有数据点。</p><p id="81ce" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"> 2。分类特征</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/cd803ed3c417187c0b966a5df64b28f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*RePQebrMYjxtQYKaprg76w.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">非稀有数据点的分类特征分布(图片由作者提供)</p></figure><p id="4ece" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们来看看这些稀有数据点的分类特征..</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/241b8e86c81043d379fecd74a461e942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*7Sblh3gePr8q0Rt6hZZWvg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">稀有数据点的分类特征分布(图片由作者提供)</p></figure><p id="bcba" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于稀有和非稀有数据点，分类特征1、2和3之间没有太大差异。从历史交易和商家交易中提取特征可能有助于更好地预测这些罕见的忠诚度得分</p><p id="efdf" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"> 3。第一个活跃月份</strong></p><p id="f55c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为这是以“YYYY-MM”格式给出的。让我们把它转换成一个简单的度量，比如从今天算起的月差。在pandas中使用datetime实现这一点非常简单。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="9071" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以根据忠诚度得分(目标)来绘制这个图表..</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/9ccdf9bda8a86d70f3c20467b8fb804d.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*nN0kd0ZL5mNYCqPfLD-Skg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">忠诚度得分与第一个活跃月的月差散点图(图片由作者提供)</p></figure><ul class=""><li id="c2be" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">我们可以在这里观察到一种趋势，即最近的用户具有更高的忠诚度得分以及忠诚度得分的高方差。</li><li id="94c2" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">然而，这也表明，与长期用户相比，近期用户的数量更多。</li><li id="4eb5" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">一个更重要的观察结果是忠诚度得分为&lt;=-30(that might be outliers) are at the very bottom of the plot for each of the bin/value ranges of the active month difference from today. This shows that this feature might not be useful enough to separate our rare data points from the actual data.</li><li id="3a43" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">This feature would definitely help in predicting the loyalty scores.</li></ul><h2 id="9f56" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">Historical Transactions</h2><ol class=""><li id="2157" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated"><strong class="kf jh">授权标志</strong>的用户数量</li></ol><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi or"><img src="../Images/8ae221ddc51355b9a0e627f29ccb1289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zunw1bhSD2jX-2ZDhF-j9g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="0fbb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如应该的那样，大多数交易都是经过授权的。</p><p id="bcf3" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.<strong class="kf jh">分期付款</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c12a32aec08ba6e9e452d30908ddc0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*qYeE94bD45mAtesF89zsDA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">分期付款分布(作者图片)</p></figure><p id="f4cb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于分期付款来说，值-1和999似乎有些奇怪。如果需要的话，我们以后可能需要修剪这些。</p><p id="971d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.<strong class="kf jh">购买金额</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/90898012ab26353de50e370ae308de94.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*tnKO5MlslDpJ1lG1ObVG6g.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><p id="2d1d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">似乎这些也已经标准化了。</p><h2 id="13ce" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">新商户交易</h2><p id="09c8" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">据观察，该文件不包含任何未经授权的交易。</p><p id="6f9a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">分期付款和购买金额的分布与我们在历史交易中观察到的非常相似。</p><h2 id="b422" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">根据忠诚度得分绘制购买金额和分期付款</h2><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/817b87f4651b3e993e154c26f9a60008.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*jcbG0H7M18Hyj4cKx34KPA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">分期付款与忠诚度得分(目标)的散点图(图片由作者提供)</p></figure><p id="cfbe" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于目标分数似乎是标准化的(在某个范围内)，观察到具有较高分期付款次数的人具有更接近于零的忠诚度分数。</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ov"><img src="../Images/048af14f2044b055b5df6d97ef38bbb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7f2FaHeV9WdTqa3cEh-YQ.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><ul class=""><li id="7feb" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">正如我们在这里看到的，忠诚度得分随着交易价值总额的增加而增加。</li><li id="3004" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">对于每个card_id进行的交易数量也观察到相同的趋势。</li></ul><h2 id="5c01" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">商户数据</h2><p id="fc64" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">该文件的列中有许多缺失值和无穷大值。无穷大值被替换为空值。然后，相应地使用均值和众数插补来处理这些缺失值。</p><ol class=""><li id="5a5a" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la nq mr ms mt bi translated"><strong class="kf jh">匿名类别</strong></li></ol><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/0b54f23a79e8583f5a33304d424406e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tcscZxV9i7E0167ln1eOA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><ul class=""><li id="4afe" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">因为这三个特征都是匿名的，所以我们不能从这些情节中说太多关于商人的事情，尽管从这些情节中可以解释很多。</li><li id="6ce7" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">然而，可以进一步探索和检查，如果交易中涉及的商家属于多数类别，那么它可能导致什么样的忠诚度得分。</li></ul><p id="cbdd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.<strong class="kf jh">活跃月滞后</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ox"><img src="../Images/fa76d7f3af1bd9c462972f34b7b1c632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hShLmhnthVkTrV1z6vjkOw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><ul class=""><li id="8521" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">正如我们在这里所观察到的，活动月数较少的卡忠诚度较低。</li><li id="c8ab" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">我们可以在这里看到很多差异。这些活跃月份列可能是有用的特性。</li></ul><p id="870e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.<strong class="kf jh">平均购买量滞后</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/b5a9a8107031a5c88d83d12c863ea02d.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*YTD0o2BPzPOR9Hu_WskHPw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><ul class=""><li id="432a" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la mq mr ms mt bi translated">对于我们的稀有数据点(忠诚度得分&lt;=-30), the purchase range lag is less than 2000.</li><li id="2575" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la mq mr ms mt bi translated">This can be a very useful feature as well for predicting the loyalty scores.</li></ul><h2 id="43a4" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">EDA Summary:</h2><ol class=""><li id="76cd" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated">The target variable(Loyalty score) has 1% of its points that seem like outliers. Dealing with these points depends on the number of these points in the test data. In that case, these aren’t actually outliers. They can be termed as Rare data points. However, the loyalty score would be difficult to predict for these points and they could have a major impact on our final scores.</li><li id="b270" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">The first active month in train file could be very useful.</li><li id="b8cd" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">Aggregated transaction features for each card would be very helpful in predicting the loyalty score using the regression models. Most of our features would be from the transaction files.</li><li id="75f6" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">Some features can be used from the merchants file as well. For example, we can have a categorical variable that states if the transaction involved a merchant that was active in the last 3/6 or 12 months. The average purchases and sales ranges might be useful as well.</li></ol><h1 id="e1e9" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">Data Preprocessing</h1><p id="54c6" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">Data Preprocessing included imputing the missing values with either mean and mode for categorical and continuous variables respectively.</p><p id="e5a1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">In case of Purchase amounts, this issue was handled by trimming the purchase amount values in a specific range that covered up to 99.9 percentile of its values.</p><p id="0625" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">As observed earlier, the installments values such as -1 and 999 were replaced with nan(null value) and imputed accordingly.</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="2f08" class="ne lj jg nw b gy oa ob l oc od">historical_transactions['purchase_amount'] = historical_transactions['purchase_amount'].apply(<strong class="nw jh">lambda</strong> x: min(x, 0.8))<br/>historical_transactions['installments'].replace([-1, 999], np.nan, inplace=<strong class="nw jh">True</strong>)<br/>historical_transactions['installments'].fillna(historical_transactions['installments'].mode()[0], inplace=<strong class="nw jh">True</strong>)</span></pre><h1 id="31a1" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">Feature Engineering</h1><p id="29fe" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">The Feature Engineering for this problem was done in two iterations. In the <em class="oe">第一次迭代</em>，两个事务文件都被合并到一个包含所有事务的文件中，并且使用这个合并文件生成特征。从这些特征获得的RMSE分数不够好。</p><p id="4f38" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我不得不回到特征工程，分别从这两个文件中提取特征。与此同时，在第二次<em class="oe">迭代</em>中也产生了额外的特性。这将RMSE分数提高了约0.35。</p><h2 id="423b" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">处理日期功能</h2><p id="67a3" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">purchase_date和first_active_month在生成额外的特性方面非常有用，例如一年中的季度和从今天开始的月份差异。在Pandas中使用datetime可以很容易地做到这一点。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="b7ef" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">类似地，对于purchase_date，我们生成了指示购买是在周末、假日还是工作日进行的特性。这还包括诸如月、年、日、时间和购买时间等特征。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="53d8" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">处理分类特征</h2><p id="6f6f" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">两种方法用于分类特征:</p><ol class=""><li id="cf83" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la nq mr ms mt bi translated">一个热编码</li><li id="9bf1" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">平均编码</li></ol><p id="8373" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第一次迭代中使用了一个热编码。然而，在特征工程的<em class="oe">第二次迭代</em>之后，均值编码提供了更好的结果。分类变量的均值编码是基于相应目标变量的值是否小于-30(是稀有数据点)来完成的。这样做是为了改进对稀有数据点的预测。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="f4f2" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用基于变量的平均值、最大值、最小值、var、偏斜和n_unique/count，通过“card_id”聚合来自交易的特征，以最终与训练和测试文件结合。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="2030" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用现有的特性和可用的领域专业知识生成了更多的特性。其中一些如下所示:</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="7f2a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最终总共生成了226个特征。</p><p id="8e5e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">特征关联和特征选择:</strong></p><p id="2793" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们已经生成了近200个特征，相关矩阵看起来像这样..</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oz"><img src="../Images/c1455cf07abee527649aa3185e64784f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7qOgyJptR15G1iwj0yRogw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">相关矩阵(图片由作者提供)</p></figure><p id="2bac" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">呀！！这看起来不太好。</p><p id="4827" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很难从中解读出什么，因为我们有大量的特征。因此，使用相关矩阵采取了一种稍微不同的方法。</p><p id="24b8" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">阈值设置为0.85，并且移除了共线性高于阈值的特征对中的一个特征。这种方法将特性的数量从226个减少到了134个。</p><h1 id="1804" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">回归模型</h1><h2 id="7284" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">基线回归模型</h2><p id="3ebb" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">初始模型使用RandomizedSearchCV和GridSearchCV进行调整，并根据训练测试拆分后获得的训练数据进行训练。</p><p id="1438" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">线性回归:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/5e870111996fb3341027084d4c7b555f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*E7Em__SqDDL6M8_L0GJiAw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">线性回归(作者图片)</p></figure><p id="1c9e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">新币回归量:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/0804fa0eec140c5325fcaabf86bcfdb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*QUHkU4BDLKFpein3tIvMhw.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">新币回归(图片由作者提供)</p></figure><p id="4b02" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">随机森林回归量:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pc"><img src="../Images/9fa59f67c409ca5cb45a875569da57d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3a5fCWVB93hTdJt7qnYoiA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">随机森林回归器(图片由作者提供)</p></figure><p id="4a38" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh"> LGBM回归量:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/2a6560eec3e6dab7561c886426cfabbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*sFYjX5XWgBbiUT-8Uat4pg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">LGBM回归器(图片由作者提供)</p></figure><p id="3cc9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于RandomizedSearchCV没有提供最好的结果，贝叶斯优化被用于超调LGBM模型</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="b4ab" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">LGBM模型在全套226个特征上比134个特征表现得更好。对此的可能原因可能是树和基于树的集合模型受相关特征的影响不大。</p><h2 id="678b" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">带LGBM Goss的贝叶斯岭回归堆叠模型</h2><p id="af1d" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">预测是使用LGBM Goss模型进行的，该模型根据训练数据进行分层折叠和重复折叠训练。在这里，不需要进行训练测试分割，因为我们是根据训练数据进行折叠预测的。因此，可以使用整个训练数据来训练模型。</p><p id="0c30" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两个预测叠加在一起，作为贝叶斯岭回归模型(元模型)的输入。</p><figure class="nr ns nt nu gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><h2 id="7d98" class="ne lj jg bd lk nf ng dn lo nh ni dp ls ko nj nk lw ks nl nm ma kw nn no me np bi translated">低概率和高概率模型方法</h2><p id="9771" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">因为，稀有数据点严重影响了异常值。我尝试了下面的模型架构来处理这个问题..</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pe"><img src="../Images/71a81d2314aee8d779fc9b39372e6dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIKCB7-TxWcX5mU3GKwi-A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">图片由<a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/discussion/82314" rel="noopener ugc nofollow" target="_blank">叶夫根尼·帕特卡</a></p></figure><ol class=""><li id="f938" class="ml mm jg kf b kg kh kk kl ko mn ks mo kw mp la nq mr ms mt bi translated"><strong class="kf jh">二元分类模型:</strong>该分类模型识别稀有数据点。这是一个LGBM分类器模型。基于从模型获得的分类概率，使用阈值(超参数)将卡/用户分类为稀有数据点(异常值)。</li><li id="2dfe" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><strong class="kf jh">回归(完整):</strong>这是一个简单的回归模型，在整个数据集上进行训练。这是对整个数据进行训练的堆叠贝叶斯岭回归模型。</li><li id="0af8" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><strong class="kf jh">回归(低概率模型):</strong>在稀有数据点(异常值)的低浓度(超参数)上训练的回归模型。这也是一个LGBM回归模型训练的所有功能。</li><li id="d8f0" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><strong class="kf jh">回归(高概率模型):</strong>用高浓度(超参数)异常值训练的回归模型。我们只有非常少的稀有数据点，所以模型很容易过度拟合。因此，这是一个简单的回归模型(贝叶斯岭回归)。基于从用于训练的完全回归模型获得的特征重要性，使用来自完全回归模型、二元分类的预测以及10个最重要的回归特征。</li><li id="607c" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><strong class="kf jh">完全(混合)模型:</strong>混合来自高概率模型、低概率模型和完全回归模型的预测，以给出最终的忠诚度得分预测。这里的最终元模型也是贝叶斯岭回归模型。</li></ol><h1 id="1277" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">结果</h1><p id="44f6" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">下表总结了上述所有方法的性能:</p><p id="67dc" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">基线回归模型:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/474baf4d93cd5438422233d8931baa59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*FMtdmyqwS1VvL6sybs4pJA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">回归模型结果(图片由作者提供)</p></figure><p id="4117" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">堆叠和LGBM Goss模型结果:</strong></p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/072f04acbf3764f068a4ab77c32da072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*twJb0sVSCUg0WELG8DbX5A.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">RMSE为提到的不同方法打分(图片由作者提供)</p></figure><p id="ca85" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">堆叠贝叶斯岭模型提供了最好的Kaggle评分。因此，这是用于最终提交。</p><h1 id="6189" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">Kaggle提交</h1><p id="2a5e" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">这是我提交的最好的Kaggle分数..</p><figure class="nr ns nt nu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ph"><img src="../Images/fd9481b8dd12f41515701d588645cf7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqkLwmvuQNIsUoHcaw6pCw.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">(图片由作者提供)</p></figure><h1 id="28b7" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated"><strong class="ak">总结</strong></h1><ol class=""><li id="9ae5" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated">在这个问题上，特征工程至关重要。从交易和商家数据中生成的特征越好，RMSE分数就越好。</li><li id="024f" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">处理异常值/稀有数据点是本案例研究的关键。这些分数极大地影响了最终的RMSE分数。</li><li id="8af3" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">在尝试了不同的回归模型和堆叠架构后，LGBM Goss模型堆叠在贝叶斯岭回归上作为元模型，提供了最佳结果。</li></ol><h1 id="cd95" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">未来的工作/改进</h1><ol class=""><li id="0a6f" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated">使用目标编码生成更多特征有助于提高分数。</li><li id="ff3c" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">高和低概率模型方法可以进一步优化，增加更多功能，并尝试高和低概率模型。正如这里的<a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/discussion/82314" rel="noopener ugc nofollow" target="_blank">所解释的那样</a>，Evgeny Patekha 在其第五名的解决方案中成功实现了这一点。</li><li id="925f" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated">大多数分类和数字特征都是匿名的。因此，我们对这些特征没有明确的概念。这使得基于领域专业知识生成新特性变得困难。然而，这种限制/约束是为了避免泄露用户/公司数据。</li></ol><h1 id="adb0" class="li lj jg bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated">结论</h1><p id="fa49" class="pw-post-body-paragraph kd ke jg kf b kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la ij bi translated">在这个案例研究中，我学到并改进了很多技巧。诸如特征工程和模型超调之类的技能对这个案例研究非常重要。这也是我第一次使用贝叶斯优化来超调模型。在ML领域，学习是一个持续的、永无止境的过程，因为每年都有新的技术和进步。因此，学习将继续…</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="a7bb" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望你喜欢阅读这篇文章，就像我喜欢研究这个案例一样。感谢您的阅读！！</p><p id="cb5c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">案例研究的完整代码可以在<a class="ae jd" href="https://github.com/Rjt5412/Elo-Merchant-Category-Recommendation" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="0554" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">领英:</strong><a class="ae jd" href="http://www.linkedin.com/in/rjt5412" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/rjt5412</a></p><p id="4baa" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf jh">Github:</strong><a class="ae jd" href="https://github.com/Rjt5412" rel="noopener ugc nofollow" target="_blank">https://github.com/Rjt5412</a></p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><h1 id="9255" class="li lj jg bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">参考资料:</h1><ol class=""><li id="f453" class="ml mm jg kf b kg mg kk mh ko oh ks oi kw oj la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/sudalairajkumar/simple-exploration-notebook-elo" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/sudalairajkumar/simple-exploration-notebook-elo</a></li><li id="395c" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/artgor/elo-eda-and-models" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/artgor/elo-eda-and-models</a></li><li id="4c55" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/denzo123/a-closer-look-at-date-variables" rel="noopener ugc nofollow" target="_blank">Robin Denz的《日期变量的进一步观察》</a></li><li id="706d" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/fabiendaniel/elo-world/notebook" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/fabiendaniel/elo-world/notebook</a></li><li id="1a2e" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/fabiendaniel/hyperparameter-tuning" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/fabiendaniel/hyperparameter-tuning</a></li><li id="3515" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/mfjwr1/simple-lightgbm-without-blending" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/mfjwr 1/simple-light GBM-without-blending</a></li><li id="4490" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/roydatascience/elo-stack-with-goss-boosting" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/roydata science/elo-stack-with-Goss-boosting</a></li><li id="73fb" class="ml mm jg kf b kg mu kk mv ko mw ks mx kw my la nq mr ms mt bi translated"><a class="ae jd" href="https://www.kaggle.com/c/elo-merchant-category-recommendation/discussion/82314" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/elo-merchant-category-re commendation/discussion/82314</a></li></ol></div></div>    
</body>
</html>