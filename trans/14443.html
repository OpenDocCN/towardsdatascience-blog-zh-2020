<html>
<head>
<title>Python Decorators: From Simple Decorators to Nesting Multiple</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python装饰器:从简单装饰器到嵌套多重</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-decorators-from-simple-decorators-to-nesting-multiple-33bbab8c5a45?source=collection_archive---------22-----------------------#2020-10-05">https://towardsdatascience.com/python-decorators-from-simple-decorators-to-nesting-multiple-33bbab8c5a45?source=collection_archive---------22-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/518df37ec89d7a91abf6f59851f99011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ceEAW23D1Sb3aX3Z"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">米尔蒂亚迪斯·弗拉基迪斯在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="b925" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">如何用多个参数化的decorators修改一个函数？</h2></div><p id="fa96" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">装饰器对象是修改一个<em class="lu">装饰的</em>对象的功能的一种方式。用python实现装饰器有多种方法。在这篇文章中，我们将讨论一些以及如何将多个decorators链接在一起以真正增强一个对象的功能。在python中，函数/方法只是对象，所以在这篇文章中，我们将同时研究实现decorators的类和方法。</p><h1 id="80b5" class="lv lw jj bd lx ly lz ma mb mc md me mf kp mg kq mh ks mi kt mj kv mk kw ml mm bi translated">简单装饰</h1><p id="a73a" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在我们开始嵌套之前，让我们看一个简单的装饰器。我将首先从一个简单的<em class="lu"> add </em>方法开始。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="93f4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的方法只是取了两个参数<em class="lu"> a </em>和<em class="lu"> b </em>。上述方法的功能是将这两个输入参数相加，并返回相加的结果。</p><p id="52fe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我要装饰这个方法，这样方法<em class="lu"> add </em>的结果就会乘以2。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="6024" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了实现这一点，我创建了一个方法<em class="lu">乘2。multiply_by_two </em>采用另一种方法作为输入。它创建了另一个方法<em class="lu"> _multiply_by_two </em>，该方法接受两个参数，这两个参数随后被传递给输入法，其结果乘以2。<em class="lu">乘二</em>返回这个构造的方法<em class="lu">_乘二</em>。</p><p id="af94" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我所做的是创建了一个装饰器<em class="lu"> multiply_by_two </em>，它基本上是通过将输入法乘以2来装饰输入法的功能(顾名思义)。现在让我们来看看它的作用。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="8544" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的代码，修饰了方法<em class="lu">加</em>乘<em class="lu">乘2。</em>这样做的构造是将@符号与正在修饰的方法一起使用(<em class="lu">乘2)</em>在正在修饰的方法之前(<em class="lu">加</em>)。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="91c3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的代码中，相同的decorator被应用于subtract方法。在这种情况下，输出是-8。所以很容易看出装修工是多才多艺的。它们可以相当普遍地应用。</p><h1 id="5cdd" class="lv lw jj bd lx ly lz ma mb mc md me mf kp mg kq mh ks mi kt mj kv mk kw ml mm bi translated">参数化装饰器</h1><p id="c98c" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在上面的例子中，我演示了乘2，但是如果我们想给开发者一个选择乘任意数的机会呢？在这种情况下，我们希望将装饰器参数化。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="95d5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可能看起来让人不知所措，让我们来分解一下。方法<em class="lu">乘_乘</em>取一个输入数。如果你仔细观察，方法<em class="lu"> _multiply </em>与<em class="lu"> multiply_by_two </em>非常相似。唯一的区别是现在num被用来乘，而不是硬编码2。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="40d3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在decorator中使用参数的方法是在使用@ symbol和decorator方法的名称之后发送它们。在这种情况下，它是<em class="lu"> @multiply_by </em>，我们传递3。这种情况下的输出是预期的18。</p><h1 id="8514" class="lv lw jj bd lx ly lz ma mb mc md me mf kp mg kq mh ks mi kt mj kv mk kw ml mm bi translated">嵌套参数化装饰器</h1><p id="61b0" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">现在让我们来看看装饰器的嵌套，一个接一个的装饰器可以被应用到一个方法上。与算术主题保持一致，我现在将创建另一个方法<em class="lu"> divide_by </em>，它与<em class="lu"> multiply_by </em>相同，只是它使用输入num来划分修饰方法的结果。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="c29d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要嵌套decorators，需要在实际的被修饰方法之前使用与symbol @之前使用的相同机制一次指定一个。</p><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d7a5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的代码中，我装饰了方法add by <em class="lu"> multiply_by </em>，然后<em class="lu"> divide_by </em>。因为乘法和除法都发生在同一个数字3上，所以该方法的结果是6。</p><p id="8a36" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在这里所做的只是首先用参数3指定decorator <em class="lu"> divide_by </em>，然后用相同的参数3指定<em class="lu"> multiply_by </em>。这产生了嵌套，因为首先<strong class="la jk">乘以然后<strong class="la jk">再</strong>除以装饰器被应用。应用程序的顺序与它们在代码中出现的顺序相反，注意这一点很重要。</strong></p><h1 id="5fc2" class="lv lw jj bd lx ly lz ma mb mc md me mf kp mg kq mh ks mi kt mj kv mk kw ml mm bi translated">奖金</h1><figure class="ms mt mu mv gt iv"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="d97a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如上面的代码所示，装饰器也可以应用在方法内部。我会让你决定以上的结果。也可以放在评论/回复里。</p><h1 id="46f2" class="lv lw jj bd lx ly lz ma mb mc md me mf kp mg kq mh ks mi kt mj kv mk kw ml mm bi translated">结论</h1><p id="d1aa" class="pw-post-body-paragraph ky kz jj la b lb mn kk ld le mo kn lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在这篇文章中，我解释了如何在python中使用decorator，方法是引入一个简单的decorator，然后将其参数化，最后将多个decorator嵌套在一起。我希望你喜欢它！</p><p id="4c1c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在LinkedIn上与我联系或在Medium上关注我。如果你喜欢这个故事，你可能会喜欢我关于python decorators的其他故事:</p><div class="is it gp gr iu my"><a rel="noopener follow" target="_blank" href="/python-decorators-with-data-science-random-sampling-177962cae80c"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd jk gy z fp nd fr fs ne fu fw ji bi translated">Python装饰者与数据科学:随机抽样</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">使用python decorator进行随机采样</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ja my"/></div></div></a></div><div class="is it gp gr iu my"><a href="https://medium.com/better-programming/decorator-pattern-and-python-decorators-b0b573f4c1ce" rel="noopener follow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd jk gy z fp nd fr fs ne fu fw ji bi translated">装饰模式和Python装饰器</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">为什么它们不一样？</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">medium.com</p></div></div><div class="nh l"><div class="nn l nj nk nl nh nm ja my"/></div></div></a></div></div></div>    
</body>
</html>