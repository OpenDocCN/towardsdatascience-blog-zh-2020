<html>
<head>
<title>API Gateway for a Machine Learning Platform</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于机器学习平台的API网关</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/api-gateway-for-a-machine-learning-platform-d66bdfe07192?source=collection_archive---------40-----------------------#2020-11-13">https://towardsdatascience.com/api-gateway-for-a-machine-learning-platform-d66bdfe07192?source=collection_archive---------40-----------------------#2020-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="13c4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">“不要根据封面来判断一本书”…或者他们是这么说的…在现实世界中，有着神圣的生产环境和截止日期，每个人都根据封面来判断你的平台，也就是它的API…</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/783e2d08e5b2fbedece4cb9485aabb0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1gpeBnsuXA2xPN4W"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斯坦纳·恩格兰在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="374f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">定义了AWS上一个自定义机器学习(ML)平台的<a class="ae kv" href="https://medium.com/@salah.rekik/i-built-a-machine-learning-platform-on-aws-after-passing-sap-c01-exam-framework-layer-4c38084c81a" rel="noopener"> <strong class="ky ir">框架层</strong> </a>之后，就该详细说说这个层的一些具体范围了。</p><p id="9ac3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本系列文章的范围是框架的模型服务层。换句话说，它的“<strong class="ky ir"> API网关”</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/a00feff45ff8706950c31e90393376fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTprEh4m-wqkZjmhRGgcJw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">本系列文章范围，由<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="d4ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一层包含4个解决方案:大使、谢顿核心、普罗米修斯和格拉夫纳。在这个新的系列文章中，我将深入探讨这些解决方案中的每一个。</p><p id="735d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将是一次伟大的旅程，所以请和我在一起吧！</p><h2 id="74fa" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1 |等等！你刚才是说“API网关”吗！你确定不是“集群入口”网关！也可能是“API管理层”！</h2><p id="e081" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">这是揭开这个话题神秘面纱的第一步。</p><p id="b4f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当在Kubernetes集群(在我的例子中是EKS)中拥有服务时，在某个时间点，我们希望向外部世界公开其中的一些服务，以便我们的客户端可以与我们的服务进行交互。</p><p id="1865" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">公开这些服务意味着两件事:</p><ul class=""><li id="74f5" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><strong class="ky ir">将外部流量路由到Kubernetes集群内部的服务</strong>:为了实现这一点，我们需要某种“网关”来接收外部流量，知道这个流量涉及哪个服务，然后将流量定向到那个服务。</li><li id="12f0" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><strong class="ky ir">管理该流量的路由</strong>:在某些情况下，仅仅重定向流量是不够的。我们可能希望通过添加一些身份验证来保护对服务的访问，或者限制对流量所涉及的服务的授权请求的数量(速率限制)，或者可能缓存来自该服务的一些响应，以避免为已经看到的请求召回它。</li></ul><p id="353d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了正确管理这种流量，出现了三个术语:API网关、API管理和入口网关。</p><p id="2919" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将从定义这些术语开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/9b6382afb561c739eb2eabf5744c61b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bto9Of-V35yMiOOvi9-4Zg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">管理API流量的新兴术语，作者<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><h2 id="c938" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1.1 |在此之前，什么是API？</h2><p id="9fa2" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">"应用编程接口(API)是一个计算接口，它定义了多个软件中介之间的交互."<strong class="ky ir">T1。开发人员使用这个接口以一种<strong class="ky ir">定义的、稳定的、文档化的方式</strong>访问其背后的服务。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/57b5d1db0f8f87036d07a1d68828eec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4BwW9zagH1s_swHXqrJOkg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一个API的简化视图，作者<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><h2 id="a148" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1.2 | API网关</h2><p id="5206" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">面对大量的微服务，每个微服务都有其粒度API，对于希望与这些微服务交互以获取一些数据的最终客户来说，有两种可能的方式可供选择:</p><p id="93cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 1。</strong> <strong class="ky ir">按照正确的顺序使用API向每个服务发送请求:</strong>每个请求必须遵守每个微服务的适当规范。毫无疑问，这是离用户友好应用程序最远的解决方案，并且只有一个结果:<strong class="ky ir">由于这种复杂性，客户永远不会使用我们面向微服务的应用程序。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/75e5df5f07478ef7248b2b6975c1d277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XfIv_OzKfxPXoDUusy1qkw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用于访问数据的多个API，由<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="5002" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> 2- </strong> <strong class="ky ir">在我们所有的微服务前面放一层:</strong>这一层将只接收客户的一个请求，并负责处理其余的，以便返回最终的数据。这一层是“<strong class="ky ir"> API网关</strong>”。<br/> <strong class="ky ir">在这种情况下，API Gateway就变成了最终客户使用的API。</strong></p><p id="1ffe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">API网关除了能够将客户与面向微服务的应用交互的复杂性隔离开来之外，还可以提供更多高级功能，例如:</p><ul class=""><li id="8b83" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><strong class="ky ir">安全性</strong> : API网关提供了一个集中的代理服务器来管理速率限制、僵尸工具检测、认证、CORS等等。许多API网关允许建立一个数据存储库(如Redis)来存储会话信息。</li><li id="43b9" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><strong class="ky ir">速率限制和计费:</strong>该功能可以是基于配额或使用量的。</li><li id="7018" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><strong class="ky ir">减少往返行程</strong>:某些API端点可能需要跨多个服务连接数据。API网关可以执行这种聚合，这样客户端就不需要复杂的调用链，减少了往返次数。</li></ul><p id="e053" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更多API网关功能<a class="ae kv" href="https://www.moesif.com/blog/technical/api-gateways/How-to-Choose-The-Right-API-Gateway-For-Your-Platform-Comparison-Of-Kong-Tyk-Apigee-And-Alternatives/" rel="noopener ugc nofollow" target="_blank">在这里</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/c943702355ba22103f90606931adec37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yhoLnFg5El86t5pTZziDw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">API网关的简化视图，作者<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="a80b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我强烈推荐克里斯·理查森的这篇简短但非常有趣的文章:<a class="ae kv" href="https://microservices.io/patterns/apigateway.html" rel="noopener ugc nofollow" target="_blank"><em class="nj"/></a></p><h2 id="42bd" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1.3 | API管理</h2><p id="35c4" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated"><strong class="ky ir">“API管理与API生命周期相关”</strong>。它只是创建和发布web应用程序编程接口(API)的<strong class="ky ir">过程</strong>，执行它们的使用策略，控制访问，培育订户社区，收集和分析使用统计数据，并报告性能。<br/>我会说这是与API网关共存的另一块。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/b6c74db850d49e98dbcf342f06888b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27cMeBVa4NA9cvPqekfOSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">API管理的简化视图，作者<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><h2 id="72e3" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">1.4 |集群入口网关</h2><p id="ae2f" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">简而言之，集群入口网关是一个具有某些规范的API网关:</p><ul class=""><li id="c26e" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">这是一个<strong class="ky ir">集群级</strong> API网关:每个集群都有自己的入口网关</li><li id="0cce" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">它不仅抽象了对底层API(由微服务公开)的访问，还抽象了任何“gRPC服务、缓存、消息队列、数据库等”<strong class="ky ir"> </strong></li></ul><p id="e027" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有些人也称之为API网关。引入“集群”这个词使它更接近其底层技术:<strong class="ky ir">集群、容器、主机、端口等。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/93d56d337df73712b585bab633363e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Psp0NO8NYgIqmac2bVwBPw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">集群入口网关的简化视图，作者<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank">作者</a></p></figure><p id="036f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在基于EKS的机器学习平台的情况下，集群入口网关可能是API网关层的完美候选。<br/>让我们更加关注这种类型的网关。</p><h2 id="7995" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated">2 |从技术上讲，Kubernetes集群的集群入口网关是什么</h2><p id="f658" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">大使团队将其称为“Kubernetes ingress”，并对其进行了如下定义:“Kubernetes ingress是一组路由规则，用于管理外部用户如何访问Kubernetes集群中运行的服务<strong class="ky ir">。</strong><strong class="ky ir">⁴</strong></p><p id="e901" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个网关由两部分组成:</p><ul class=""><li id="8687" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><strong class="ky ir">负载平衡器</strong>:这是一个<strong class="ky ir">外部</strong>负载平衡器。它的作用是将外部流量重定向到Kubernetes集群。在云环境中，这个负载平衡器是特定于云的(例如AWS网络负载平衡器)。</li><li id="4741" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><strong class="ky ir">边缘代理</strong>:当处理Kubernetes的入口资源时，也称为<strong class="ky ir">入口控制器</strong>。这是大脑，它接收来自负载均衡器的流量，并知道调用哪个服务、API、数据库…来响应这个流量。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7317792ab2f6e7914856d8add316c49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*AtWPqE29zkvAuoOGByrDbg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来自<a class="ae kv" href="https://www.getambassador.io/learn/kubernetes-ingress/" rel="noopener ugc nofollow" target="_blank">https://www.getambassador.io/learn/kubernetes-ingress/</a>的入口网关</p></figure><p id="3d48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本系列文章的其余部分，我将互换使用术语API网关和入口网关。</p><p id="c740" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结论</strong></p><p id="3b67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我试图为下一篇文章做准备。我首先介绍了这一系列文章的范围。然后，我试图定义我在研究API网关的主题时遇到的不同术语，如果没有很好地理解，这些术语可能会产生误导:API网关、API管理、入口网关。</p><p id="d03a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一篇文章中，我将讨论这个API网关层与AWS服务和开源解决方案的不同设置。</p><p id="8f00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您有任何问题，请通过<a class="ae kv" href="https://www.linkedin.com/in/salah-rekik" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="c498" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1]<a class="ae kv" href="https://en.wikipedia.org/wiki/API" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/API</a></p><p id="715d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2]<a class="ae kv" href="https://nordicapis.com/understanding-api-management-api-gateway-and-api-manager/" rel="noopener ugc nofollow" target="_blank">https://nordicapis . com/understanding-API-management-API-gateway-and-API-manager/</a></p><p id="c717" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]<a class="ae kv" href="https://blog.christianposta.com/microservices/api-gateways-are-going-through-an-identity-crisis/" rel="noopener ugc nofollow" target="_blank">https://blog . Christian posta . com/micro services/API-gateways-are-go-through-an-identity-crisis/</a></p><p id="ce5a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.getambassador.io/learn/kubernetes-ingress/" rel="noopener ugc nofollow" target="_blank">https://www.getambassador.io/learn/kubernetes-ingress/</a></p></div></div>    
</body>
</html>