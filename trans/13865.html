<html>
<head>
<title>Asteroid Project (Part 2) — Test Driven Development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小行星计划(第二部分)——测试驱动开发</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/asteroid-project-part-2-test-driven-development-ed7af6c1820e?source=collection_archive---------38-----------------------#2020-09-23">https://towardsdatascience.com/asteroid-project-part-2-test-driven-development-ed7af6c1820e?source=collection_archive---------38-----------------------#2020-09-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2c13" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/space-science-with-python" rel="noopener" target="_blank">用Python进行空间科学</a></h2><div class=""/><div class=""><h2 id="c4a5" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated"><a class="ae kr" href="https://towardsdatascience.com/tagged/space-science-with-python" rel="noopener" target="_blank">系列教程的第22部分</a>继续我们科学项目的第二部分。在我们深入研究Python和近地对象之前，让我们看一下测试驱动开发</h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/0f207eb34e3b3546c407abbd2974f9be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dWK66nPF5Oe1e7Xt"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated">照片由<a class="ae kr" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="563d" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">前言</h1><p id="e430" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated"><em class="mw">这是我的Python教程系列“用Python进行空间科学”的第22部分。教程会话中显示的所有代码都上传到</em><a class="ae kr" href="https://github.com/ThomasAlbin/SpaceScienceTutorial" rel="noopener ugc nofollow" target="_blank"><em class="mw">GitHub</em></a><em class="mw">上。尽情享受吧！</em></p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="4fd4" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">介绍</h1><p id="97c7" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">不，我们还没有开始任何近地天体(NEO)相关的Python开发或实现。在砍树之前，我们需要先把斧子磨快。在我们的例子中:让我们深入一些开发概念，这些概念将导致一个可持续的长期项目和Python库。</p><p id="d291" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated"><em class="mw">你是怎么编码的？</em>大多数开发人员(无论是业余程序员还是专业人士)都喜欢看到快速的结果；他们开发一个原型，一些可点击的界面，或者演示页面来实现第一个产品里程碑。在专业工作环境中，这也可能是由外部因素造成的，如截止日期、产品所有者、业务合作伙伴或期望在特定时间框架内获得结果的客户。由于专业背景和知识的不同，有些人可能会互相扯皮。</p><p id="0580" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated"><em class="mw">结果呢？</em>例如:<a class="ae kr" href="https://en.wikipedia.org/wiki/Spaghetti_code" rel="noopener ugc nofollow" target="_blank">意大利面条代码</a>测试不够好，难以维护、升级和理解！</p><p id="5318" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">在我们的科学项目中，我们希望开发一个可靠且可持续的Python解决方案。从事近地天体研究的业余或专业天文学家可以使用的工具。开发人员和编码人员也可以使用它来创建可以与库合并的新功能。</p><p id="84d7" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">但是我们如何确保(从一开始)我们即将到来的库的可持续性和可维护性呢？嗯，除了适当的项目计划和项目结构(<a class="ae kr" href="https://www.python.org/dev/peps/pep-0008/" rel="noopener ugc nofollow" target="_blank"> PEP8格式化</a>、<a class="ae kr" href="https://www.python.org/dev/peps/pep-0257/" rel="noopener ugc nofollow" target="_blank"> PEP257 </a>和<a class="ae kr" href="https://numpydoc.readthedocs.io/en/latest/format.html" rel="noopener ugc nofollow" target="_blank"> Numpy Docstrings </a>)之外，敏捷工作的世界中还有一个概念，它看起来很乏味，有些无聊……:测试驱动开发(TDD)。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="7e5a" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">测试驱动开发</h1><p id="6a6a" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">TDD逆转了“经典编程方法”。先编码后测试的范例变为<strong class="mc jd">先测试后编码</strong>。这些规则看似简单，却令人困惑:</p><ol class=""><li id="483d" class="no np it mc b md nj mg nk mj nq mn nr mr ns mv nt nu nv nw bi translated"><strong class="mc jd">为一个类/函数编写一个单独的(单元)测试/ … </strong></li><li id="e54a" class="no np it mc b md nx mg ny mj nz mn oa mr ob mv nt nu nv nw bi translated"><strong class="mc jd">编写产品代码以成功通过失败的单元测试</strong></li><li id="eb65" class="no np it mc b md nx mg ny mj nz mn oa mr ob mv nt nu nv nw bi translated"><strong class="mc jd">在所有单元测试成功之前，不要继续其他功能</strong></li></ol><p id="e04b" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">这些都是苛刻的规定。首先，我需要为一个不存在的函数定义一个单元测试。这个测试显然失败了。现在我开发一些代码来成功完成单元测试。当测试通过后，另一个单元测试被添加，最终对同一功能再次证明其健壮性或泛型实现。它一次又一次地成功了吗？很好！您的功能似乎适合以后使用。如果没有，重新编码，直到所有测试都通过。</p><p id="b2a1" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">如果单个类或函数的所有单元测试都通过了，那么为编码项目的下一个元素定义并编写新的单元测试。</p><p id="260d" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">这种方法听起来可能很无聊。一个人想要在短时间内成就大事！为什么要用这种乏味的方法呢？开拓精神在哪里？即使你在做一个真正创新的产品或想法，你也需要基本的功能；完全独立于你想要达到的目标。测试第一确保你的工作有一个坚实的基础可以依靠。从长远来看，一个有几个初始错误的代码维护起来会更费时，例如，如果你的科学工作依赖于它…嗯…在最坏的情况下，你不得不撤回你的分析或数值模拟。</p><h2 id="bd65" class="oc lj it bd lk od oe dn lo of og dp ls mj oh oi lu mn oj ok lw mr ol om ly iz bi translated">TDD模式</h2><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi on"><img src="../Images/82f9c1c469e41fc18a543cd64110955a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W7T0Hs7MmvYT2aUA"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated">凯文·Ku在<a class="ae kr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="7518" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">理论上，TDD有三种工作/编码模式(这些模式很容易合并成另一种)。让我们假设您基于产品的需求创建了一个单元测试，并且您需要开发相应的产品代码:</p><ul class=""><li id="0358" class="no np it mc b md nj mg nk mj nq mn nr mr ns mv oo nu nv nw bi translated"><em class="mw">明显实现</em></li></ul><p id="0a05" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated"><em class="mw">显而易见的实现</em>是最琐碎的模式。基于一个单元测试的例子，你可以清楚地得到一个通用的函数来解决问题。示例:存储为字符串的数值需要转换为实际的浮点数。您马上就会发现，通过应用float('23.15 ')，可以将' 23.15 '转换为23.15。</p><ul class=""><li id="ad90" class="no np it mc b md nj mg nk mj nq mn nr mr ns mv oo nu nv nw bi translated"><em class="mw">假的吧</em></li></ul><p id="3698" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">一个单元测试需要通过！你不知道如何做，所以你只是伪造结果！您设置一些常量，并返回断言测试所期望的硬编码答案。当然你<em class="mw">造假</em>(结果)。然而，基于这个虚假的常数，你试图回溯到实际的输入。最终，经过一些思考和研究，你会发现<em class="mw">明显的实现</em>在开始时并不明显。</p><ul class=""><li id="0ec8" class="no np it mc b md nj mg nk mj nq mn nr mr ns mv oo nu nv nw bi translated"><em class="mw">三角测量</em></li></ul><p id="16d1" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated"><em class="mw"> Fake it </em>方法假设基于伪造常数和单个测试，开发人员将最终确定单元测试问题的通用解决方案。然而，如果一个问题太复杂，就需要更多的测试来覆盖更多的情况。越来越多的硬编码解决方案有助于<em class="mw">三角测量</em>特定问题的实际通用解决方案。假设您有从网站下载文件的任务。单元测试调用了一个函数，该函数需要返回一个类似“下载成功”的消息，但是您不知道从哪里开始。此时你可以伪造结果。创建一个包含下载功能的函数，创建一个带有条目“Download succeeded”的字符串并返回它。之后，添加另一个单元测试，例如下载的静态文件的散列值。同样，您通过伪造模拟文件的结果哈希值来再次伪造结果。越来越多的测试被添加进来，要求你检查服务器的响应等等。随着更多的测试和更多需要的功能，你开发的代码需要满足所有的长期需求。虚假的解决方案将转变为通用的解决方案。</p><h2 id="8d41" class="oc lj it bd lk od oe dn lo of og dp ls mj oh oi lu mn oj ok lw mr ol om ly iz bi translated">重构和文档</h2><p id="9d0e" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">最后，如果测试通过，考虑重构你的代码。在Python中，你应该遵循PEP8标准，确保高水平的代码样式…</p><div class="op oq gp gr or os"><a href="https://www.python.org/dev/peps/pep-0008/" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd jd gy z fp ox fr fs oy fu fw jc bi translated">PEP 8风格的Python代码指南</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">Python编程语言的官方主页</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">www.python.org</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg lc os"/></div></div></a></div><p id="2486" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">…提供注释以解释您的代码正在做什么，并提供PEP257风格(和/或Numpy Doc风格或您认为合适的其他风格)的文档:</p><div class="op oq gp gr or os"><a href="https://www.python.org/dev/peps/pep-0257/" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd jd gy z fp ox fr fs oy fu fw jc bi translated">PEP 257 -文档字符串约定</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">这个PEP的目的是标准化文档字符串的高层结构:它们应该包含什么，以及如何表达…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">www.python.org</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg lc os"/></div></div></a></div><div class="op oq gp gr or os"><a href="https://numpydoc.readthedocs.io/en/latest/format.html" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd jd gy z fp ox fr fs oy fu fw jc bi translated">numpydoc文档字符串指南- numpydoc v1.2.dev0手册</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">本文描述了用于Sphinx的numpydoc扩展的文档字符串的语法和最佳实践。注意…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">numpydoc.readthedocs.io</p></div></div></div></a></div><p id="fb66" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">重构和记录你的代码也会帮助你理解你自己的代码。也许有些部分包含单元测试没有涵盖的逻辑错误？也许你错过了一个重要的特征？编码、重构和文档化齐头并进。编程不应该是一个问题的纯粹抽象，还应该是人类可读的，以确保长期的可维护性和可持续性。</p><p id="cc23" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">此外，剖析您的函数可以帮助您提高产品的性能。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="5501" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">结论与展望</h1><p id="a079" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">今天我们讨论了测试驱动开发的一些基本原则，简称TDD。TDD将帮助我们为我们的空间科学近地天体项目开发一个可持续的Python库，提供经过测试的准确结果。在我们深入这个项目的科学部分之前，下次我们将看一个TDD的例子。在那里，我们将一步一步地完成提到的TDD过程，因为在项目过程中，你只会看到一些编码会话的结果和成功的单元测试(也许一个额外的视频博客会对一些感兴趣的读者有用？).</p><p id="60d8" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">如果你纠结于编码，如果你迷失在自己的开发过程、对象和函数中，记得阅读Python 的<em class="mw"> Zen:</em></p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="pi pj l"/></div></figure><pre class="kt ku kv kw gt pk pl pm pn aw po bi"><span id="9462" class="oc lj it pl b gy pp pq l pr ps">The Zen of Python, by Tim Peters</span><span id="46c6" class="oc lj it pl b gy pt pq l pr ps">Beautiful is better than ugly.<br/>Explicit is better than implicit.<br/>Simple is better than complex.<br/>Complex is better than complicated.<br/>Flat is better than nested.<br/>Sparse is better than dense.<br/>Readability counts.<br/>Special cases aren’t special enough to break the rules.<br/>Although practicality beats purity.<br/>Errors should never pass silently.<br/>Unless explicitly silenced.<br/>In the face of ambiguity, refuse the temptation to guess.<br/>There should be one — and preferably only one — obvious way to do it.<br/>Although that way may not be obvious at first unless you’re Dutch.<br/>Now is better than never.<br/>Although never is often better than *right* now.<br/>If the implementation is hard to explain, it’s a bad idea.<br/>If the implementation is easy to explain, it may be a good idea.<br/>Namespaces are one honking great idea — let’s do more of those!</span></pre><p id="45e9" class="pw-post-body-paragraph ma mb it mc b md nj kd mf mg nk kg mi mj nl ml mm mn nm mp mq mr nn mt mu mv im bi translated">托马斯</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="69e0" class="li lj it bd lk ll ne ln lo lp nf lr ls ki ng kj lu kl nh km lw ko ni kp ly lz bi translated">文献和参考资料</h1><div class="op oq gp gr or os"><a href="https://www.springer.com/de/book/9783642042874" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd jd gy z fp ox fr fs oy fu fw jc bi translated">测试驱动的开发——敏捷实践的实证评估</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">敏捷方法在工业界和研究界正获得越来越多的关注。许多行业正在转型…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">www.springer.com</p></div></div><div class="pb l"><div class="pu l pd pe pf pb pg lc os"/></div></div></a></div></div></div>    
</body>
</html>