<html>
<head>
<title>Introduction to Naive Bayes Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">朴素贝叶斯分类器简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-naive-bayes-classifier-f5c202c97f92?source=collection_archive---------23-----------------------#2020-11-06">https://towardsdatascience.com/introduction-to-naive-bayes-classifier-f5c202c97f92?source=collection_archive---------23-----------------------#2020-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/787c872894e2e9713e24cf07ac0a92c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7nj2z0xU-P8l-Yq_"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">Jorge Franganillo 在<a class="ae kc" href="https://unsplash.com/photos/QJCJYfC1uzw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6385" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">朴素贝叶斯是一个术语，统称为基于<strong class="kf ir">贝叶斯定理</strong>的<strong class="kf ir">分类算法</strong>。对于门外汉来说，分类算法是那些用于将新的观察结果分类到<strong class="kf ir">预定义类别</strong>中的算法。例如，假设您是伦敦一家大银行的数据分析师，您希望根据历史数据来预测客户是否会在银行贷款上欺诈。</p><p id="77b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你一定想知道这个名字中有“Bayes”，因为这个算法是基于Bayes定理的，但是<strong class="kf ir">为什么是“Naive”</strong>？是因为算法“幼稚”还是“哑巴”？不要！！该算法并不“愚蠢”,但事实上，它有时比一些非常复杂的算法更有效。该算法是“幼稚的”,因为它基于一个一般假设，即一个类中某个特定特征的存在是独立于同一类中某个其他特征的存在。例如，如果一个客户有不良信用记录、申请人收入低等等，他/她可以拖欠银行贷款。这两个特征独立地影响候选人违约的概率，也就是说，一个特征的存在与另一个特征无关。</p><p id="f738" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果有些术语你听起来不熟悉，不要灰心丧气。这一系列文章的目的是以最简单的方式解释机器学习算法。因此，在本系列结束时，您将能够非常轻松地构建自己的机器学习模型。所以让我们继续这篇关于朴素贝叶斯分类器的文章。</p><p id="d9eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">贝叶斯定理！！贝叶斯定理到底是什么？</strong></p><p id="81d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">贝叶斯定理是一个非常流行的数学公式，用于根据可能与事件相关的条件的先验知识来确定事件的条件概率。</p><p id="8626" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">等等！条件概率到底是什么？</strong></p><p id="ea0f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设另一个事件已经发生，这是一个结果发生的<strong class="kf ir">可能性</strong>。例如，从一副52张牌中抽取两张不替换的牌。假设抽的第一张牌也是a，那么第二张牌是a的概率是多少？</p><p id="22e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，P(抽第一张王牌)=王牌总数/纸牌总数= 4/52</p><p id="b310" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">p(抽第二张a)= 3/51(这是因为在第一次抽牌后，我们的牌组中只剩下3张a，牌的总数也减少到51张)。这就是条件概率的含义。第二个事件取决于第一个事件的发生。</p><p id="675b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回到贝叶斯定理。它在数学上由以下公式给出:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/cdd60a1cc6f4468ca9d3b4a21b58a7f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*t6wW2bw1AdgvJt0YPZccTw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图1:贝叶斯定理[图片由作者提供]</p></figure><p id="e20f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们对贝叶斯定理有了一个很好的理解。让我们继续了解它在分类问题中的用途。</p><h2 id="879f" class="lg lh iq bd li lj lk dn ll lm ln dp lo ko lp lq lr ks ls lt lu kw lv lw lx ly bi translated">朴素贝叶斯直觉</h2><p id="2138" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">问题:试着预测一个信用分数为180的候选人是否会拖欠贷款。考虑下面的频率表来计算违约的可能性。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/8666d0db9b4b3348e5599d5b09a6ba6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*UY98NRTXJF1eAZ2_YvZyTA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图2:频率表[图片由作者提供]</p></figure><p id="dc2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以按照下面的步骤来计算概率。由于候选人的信用分数为180，让我们预测一下(100–200)的标签。</p><p id="bfc3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤1:计算每个类别的<strong class="kf ir">先验概率</strong>(是和否)</p><p id="3440" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">p(是)= 11/29 = 0.379</p><p id="2d18" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">p(100–200)= 10/29 = 0.345<br/>第二步:找到每个类的每个属性的<strong class="kf ir">似然概率</strong></p><p id="5e97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">p(100–200 | Yes)= 6/11 = 0.545<br/>第三步:利用贝叶斯定理计算<strong class="kf ir">后验概率</strong></p><p id="e167" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">P(是| 100–200)= P(100–200 |是)* P(是)/P(100–200)</p><p id="03ca" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">= 0.545 * 0.379/0.345 = 0.5989 = 0.599<br/>第四步:做<strong class="kf ir">预测</strong></p><p id="adee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为，候选人违约的概率超过50%(这是假设的显著性水平，它可以根据用例而不同)，我们可以说候选人将违约。</p><h2 id="fc25" class="lg lh iq bd li lj lk dn ll lm ln dp lo ko lp lq lr ks ls lt lu kw lv lw lx ly bi translated">端到端朴素贝叶斯分类器</h2><p id="8f18" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">了解了朴素贝叶斯分类器的工作原理后，让我们尝试使用<strong class="kf ir"> sklearn </strong>基于它构建一个分类模型。Sklearn或scikit-learn是一个用python编写的开源机器学习库。</p><p id="24b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">出于本文的目的，我们将使用<a class="ae kc" href="https://www.kaggle.com/akram24/social-network-ads" rel="noopener ugc nofollow" target="_blank"> social_network_ads </a>数据集。在这个问题中，我们将根据年龄和预计工资，通过点击社交媒体上向他/她显示的广告来预测用户是否购买了产品。所以让我们开始吧。</p><p id="1c3b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤1:导入基本库</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="a2b4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤2:导入数据</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/9e4b4a2ffccb8c788aa99f756da99e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*3yb3kdGaLSADXkpkM3iZqA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图3:自变量和因变量概览[图片由作者提供]</p></figure><p id="bded" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤3:数据预处理</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="c8ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在数据预处理步骤中，我们首先将数据集分为训练集(80%)和测试集(20%)。接下来，我们使用<strong class="kf ir">标准标量</strong>完成了一些基本的特征缩放。标准标量以平均值为0、标准差为1的方式转换数据。</p><p id="fc28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第四步:模特训练</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="edd6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">步骤5:模型测试和评估</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/ce573723ee7cffdba5d5b9c1b56890b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*3uMNfHlaW26FfWC7-fPEXw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图4:困惑矩阵[图片由作者提供]</p></figure><p id="f095" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">混乱矩阵让我们知道我们的模型有多好。它描述了一个分类模型在一组已知<br/>真值的测试数据上的性能。混淆矩阵中的每一行代表一个实际类别，而每一列代表一个预测类别。</p><p id="ae3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第六步:视觉化</p><figure class="lc ld le lf gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/b45555337fe862bf0eccda39b44be625.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*bbbwyknmhKu__4MQMSq2aA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图5:朴素贝叶斯分类模型的可视化</p></figure><p id="9dad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一步不是必需的。它只是提供了一个概念，说明模型是如何对数据点进行分类的。</p><h2 id="ed3a" class="lg lh iq bd li lj lk dn ll lm ln dp lo ko lp lq lr ks ls lt lu kw lv lw lx ly bi translated">包裹</h2><p id="852d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在这篇文章中，我们学习了朴素贝叶斯分类器背后的数学原理，并使用sklearn建立了一个模型。在接下来的文章中，我们将学习一些其他的分类算法作为这个系列的一部分，比如逻辑回归，决策树等等。敬请关注。</p></div></div>    
</body>
</html>