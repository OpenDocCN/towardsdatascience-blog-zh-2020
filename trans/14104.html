<html>
<head>
<title>Handwritten digit classifier — Your first end to end CNN in 5 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">手写数字分类器——5分钟内您的第一个端到端CNN</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handwritten-digit-classifier-your-first-end-to-end-cnn-in-5-minutes-5be3d9c6c4c0?source=collection_archive---------44-----------------------#2020-09-28">https://towardsdatascience.com/handwritten-digit-classifier-your-first-end-to-end-cnn-in-5-minutes-5be3d9c6c4c0?source=collection_archive---------44-----------------------#2020-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e921e8fd8fbf74f41bcc8acbd866155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tm9CmGZGwUHKceOQ"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">乔恩·泰森在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><blockquote class="kd"><p id="97d8" class="ke kf iq bd kg kh ki kj kk kl km kn dk translated"><em class="ko">数字分类器显然是新的Hello World！</em></p></blockquote><p id="db31" class="pw-post-body-paragraph kp kq iq kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll kn ij bi translated">没错，这是最基本的卷积神经网络例子。因此，理解这一点至关重要。因此，每当我们开始一些新的东西，运行我们的第一个<strong class="kr ir"> <em class="lm"> hello </em> world </strong>程序可能看起来很容易，但有很多摩擦。成功运行它有时可能需要几天时间——主要是因为涉及到的设置，陷入在我们看来像陌生文本的错误中，等等。</p><blockquote class="ln lo lp"><p id="4a7d" class="kp kq lm kr b ks lq ku kv kw lr ky kz ls lt lc ld lu lv lg lh lw lx lk ll kn ij bi translated">所以，我写这篇文章背后的主要动机是帮助你消除这种摩擦——这样你就可以在短短5分钟内在CNN上运行你的第一个节目。</p></blockquote><h2 id="9316" class="ly lz iq bd ma mb mc dn md me mf dp mg la mh mi mj le mk ml mm li mn mo mp mq bi translated">先决条件</h2><ol class=""><li id="0925" class="mr ms iq kr b ks mt kw mu la mv le mw li mx kn my mz na nb bi translated">应该知道CNN的基本知识。我强烈建议做一个谷歌搜索，了解卷积层和最大池层。</li><li id="ff9e" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn my mz na nb bi translated">你应该对它背后的数学有很好的理解。为此，我强烈推荐阅读我以前的<a class="ae kc" rel="noopener" target="_blank" href="/convolution-neural-network-maths-intuition-6b047cb48e90">文章</a>。</li><li id="096c" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn my mz na nb bi translated">通过<a class="ae kc" href="https://colab.research.google.com/drive/1qJfc5bOveudc5wZ8gMGZ-ml2UDa7mHnG?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>运行该程序。</li></ol><blockquote class="kd"><p id="f332" class="ke kf iq bd kg kh ki kj kk kl km kn dk translated">有人刚刚运行了他们的第一个CNN节目吗？！恭喜🎉</p></blockquote><p id="acfb" class="pw-post-body-paragraph kp kq iq kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll kn ij bi translated">感觉如何？！如果您还没有运行它，我强烈建议您这样做。Google Colab是一个非常简单易用的软件，它消除了在我们的机器上进行设置的所有不必要的需求。如果你还在学习深度学习，强烈推荐。现在，让我们分解它，了解每一个组件。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="157e" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated">从MNIST数据集中加载数据</h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/0ce3ff98d479b1ee5719895cc8693c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CiMr1aXYZ-uZCba3QmAjPg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="794f" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">修改的国家标准和技术研究所(MNIST)数据集包括70，000幅28 * 28像素的灰度图像，包含一个0到9之间的手写数字。</p><p id="c796" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated"><strong class="kr ir"> <em class="lm">作为一个经验法则，总是在训练和测试集中划分你的数据。</em> </strong> <em class="lm">为什么会这样？因此，您可以在训练集上训练您的模型，并在测试集上测试它。如果它在训练集上表现良好，但在测试数据上表现不佳，我们就可以知道我们的模型过度拟合了。因此，在测试数据上测试它有助于您独立于训练数据来测试您的模型，并更加确定您的模型。</em></p><p id="d8a9" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">如您所见，训练数据有60000个条目，测试数据有10000个条目。此外，为了便于理解，我绘制了一张28*28像素的图像。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="7885" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated">预处理</h1><p id="de16" class="pw-post-body-paragraph kp kq iq kr b ks mt ku kv kw mu ky kz la ok lc ld le ol lg lh li om lk ll kn ij bi translated">清理数据是所有模型中的主要步骤之一。有各种各样的技术可以做到这一点。但是，对于这一个，我们将只关注其中的3个。</p><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/76f538b418431ddad35c5860fbffe409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAKl20nrX6_c8b_8vz4Xwg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><ul class=""><li id="1b40" class="mr ms iq kr b ks lq kw lr la oo le op li oq kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">重塑</em> </strong> <em class="lm">:我们的模型由[28*28]矩阵的60k个条目组成对吗？但是，如果你记得CNN在频道上工作。如果是灰度图像，有一个通道，如果是彩色图像，有3个通道。因为它是灰度图像，我们可以把它重写为单通道矩阵。于是，[60k，28，28] - &gt; [60k，28，28，1]。</em></li><li id="f47b" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">一热编码:</em> </strong> <em class="lm">现在，我们的NN会是什么样子？因为它是一个多类分类器，类从0到9，我们可以有把握地假设在最后一步之后将有10个输出。还记得softmax吗？这种系统将有10个输出，其预测的数字的概率最高。所以，我们应该把我们的输出从[60k，1]-&gt;，[60k，10]。这就是通过一键编码完成的。因此，假设输出值为1，将被重写为[0，1，0，0，0，0，0，0，0]。无论哪一个是将由1表示的输出，其他的由0表示。简单，嗯？！</em></li><li id="1508" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">归一化</em> </strong> <em class="lm">:每个矩阵都会有[0–255]之间的值对吗？因此，为了便于计算，所有值都从[0–255]移动到[0–1]范围。这可以简单地通过将所有值除以255来实现。</em></li></ul></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="4e4b" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated">定义模型</h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/8adf8ff8e4b8b6d0db818fb78575ceee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48W8aj6y4Sif72d3qxwvWw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="4539" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">是时候修改CNN了！随机创建一个你认为性能足够好的模型。例如，这里我们创建了上面的模型，它具有:</p><ul class=""><li id="3493" class="mr ms iq kr b ks lq kw lr la oo le op li oq kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">卷积层</em> </strong> <em class="lm">有32个大小为[3*3]的内核，输入大小为[28*28*1]。</em></li><li id="4069" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">最大汇集层</em> </strong> <em class="lm">同【2 * 2】</em></li><li id="8474" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">展平</em> </strong> <em class="lm">输出，并将其传递给一个全连接层。</em></li><li id="8224" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">全连通层</em> </strong> <em class="lm">有100个隐藏节点和10个输出节点。</em></li><li id="964a" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">优化功能</em> </strong> <em class="lm"> —该功能定义如何重新计算权重。</em></li><li id="0dfc" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">损失函数</em> </strong> <em class="lm"> —这是我们用来定义实际值和预测值之间差异的误差函数。</em></li><li id="1346" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">激活功能</em> </strong> <em class="lm"> —在每个隐藏节点后，该功能用于将非线性成分添加到我们的输出中。</em></li></ul><p id="162d" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">关于这些函数的可能值，我会有一篇单独的文章。现在，让我们只是使用它们，因为不知何故已经告诉我们这样做。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="2f6d" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated">模型评估</h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ot"><img src="../Images/bdc8b62f11a0dd4429cde0238774ab73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKF3ynZR1geeNHlLltXQuA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="1ba8" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">现在，这是最棘手的部分。因此，<em class="lm">我们只在训练集上训练我们的模型。我们根本不会使用我们的测试集。</em>这里我们需要理解两个概念:</p><ul class=""><li id="c5b4" class="mr ms iq kr b ks lq kw lr la oo le op li oq kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm">验证数据:</em> </strong> <em class="lm">我们将我们的训练集进一步分为2个集——训练集和测试集。所以基本上我们是在第一组上训练我们的模型，并在测试组上测试它。这有助于我们在不涉及原始测试集的情况下检查模型的准确性。</em></li><li id="0cc7" class="mr ms iq kr b ks nc kw nd la ne le nf li ng kn or mz na nb bi translated"><strong class="kr ir"> <em class="lm"> K-Fold: </em> </strong> <em class="lm">基本上，这里我们将训练集分成K个集合，而不仅仅是2个。从中我们随机选择一组作为训练组，另一组作为测试组。更多可以在这里阅读</em><a class="ae kc" href="https://machinelearningmastery.com/k-fold-cross-validation/#:~:text=Cross%2Dvalidation%20is%20a%20resampling,is%20to%20be%20split%20into." rel="noopener ugc nofollow" target="_blank"><em class="lm"/></a><em class="lm">。</em></li></ul><pre class="og oh oi oj gt ou ov ow ox aw oy bi"><span id="75c7" class="ly lz iq ov b gy oz pa l pb pc"><strong class="ov ir">Example: 3-Fold</strong></span><span id="dd81" class="ly lz iq ov b gy pd pa l pb pc"><strong class="ov ir">Array: </strong>[1,2,3,4,5,6]<br/><strong class="ov ir">Fold 1: </strong>[1, 2]<br/><strong class="ov ir">Fold 2: </strong>[3, 4]<br/><strong class="ov ir">Fold 3: </strong>[5, 6]</span><span id="ec18" class="ly lz iq ov b gy pd pa l pb pc">So, <br/><strong class="ov ir">1st Iteration:</strong> Training on Fold 1 + Testing on Fold 2<br/><strong class="ov ir">2nd Iteration:</strong> Training on Fold 2 + Testing on Fold 3<br/><strong class="ov ir">3rd Iteration:</strong> Training on Fold 3 + Testing on Fold 1</span></pre><p id="f150" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">我将在下一篇文章中讨论Keras的批量大小。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="c764" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated"><strong class="ak">绘制学习曲线</strong></h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pe"><img src="../Images/deec3f31592010aa4cbc09893c5361b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ol_Nu5LuoYj5BRMeXpEc4Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="2d4c" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">在这里，我们正在绘制我们的损失和准确性。<strong class="kr ir"> <em class="lm">首先，我们为什么要在al </em> l处绘制它们？这让我们可以直观地了解我们的模型在不同配置下的表现。在这种情况下，只是不同的训练数据和测试数据。但是，我们可以为一个模型配置不同的隐藏节点，或者卷积层中的不同层，等等。这通常有助于我们从视觉上看出我们的模型是过度拟合、欠拟合还是非常拟合。</strong></p><p id="629f" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">上面的图像表明，它在两个训练集上表现相同，因此非常适合。</p><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pf"><img src="../Images/2ba619f6f530cca0bd13bdc434c25662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fm8NqyqBmLhKRdv6403Xnw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="d0f3" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">这只是另一种方式来看看我们的分数表现如何。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><h1 id="63e9" class="no lz iq bd ma np nq nr md ns nt nu mg nv nw nx mj ny nz oa mm ob oc od mp oe bi translated">最终测试</h1><figure class="og oh oi oj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pg"><img src="../Images/5895db4c740336fa005f210c87e278a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xz17XRh1P-aBNwY_H3WEEw.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">作者图片</p></figure><p id="929e" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">这是最后一步，我们将使用我们定义的模型对测试数据进行测试，并计算最终的准确性。</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="6f19" class="pw-post-body-paragraph kp kq iq kr b ks lq ku kv kw lr ky kz la lt lc ld le lv lg lh li lx lk ll kn ij bi translated">这篇文章的主要焦点是消除摩擦，让你们开始在CNN的美丽旅程。这篇博客深受这篇文章的启发🙏。</p></div></div>    
</body>
</html>