<html>
<head>
<title>Real Time Data Streaming in Power BI with Azure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure的Power BI中的实时数据流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/real-time-data-streaming-in-power-bi-with-azure-8650d3cbfddb?source=collection_archive---------20-----------------------#2020-10-14">https://towardsdatascience.com/real-time-data-streaming-in-power-bi-with-azure-8650d3cbfddb?source=collection_archive---------20-----------------------#2020-10-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="623d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Azure创建无缝的实时Power BI仪表板</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d79eb53b40671086ff77d7d15e58061c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SV2A0RUndr2u9iP9i1_LtA.png"/></div></div></figure><h1 id="9cd0" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">背景</strong></h1><p id="432d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"> Azure Event Hubs </strong>是一个大数据流平台和事件摄取服务，每秒可以跟踪和处理数千个事件。来自活动中心的数据可以使用实时分析服务进行转换和存储。<strong class="ll ir"> Azure Stream Analytics </strong>是一款实时分析服务，旨在帮助分析和处理可用于触发警报和行动的数据流。Power BI是一项商业分析服务，提供交互式可视化。</p><h1 id="6917" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">目标</h1><blockquote class="mf mg mh"><p id="8e33" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated">利用Azure数据接收/查询服务，如事件中心和流分析——成功创建自流式Power BI实时仪表板</p></blockquote><h1 id="8dd9" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">设置Azure</h1><ol class=""><li id="fc83" class="mr ms iq ll b lm ln lp lq ls mt lw mu ma mv me mw mx my mz bi translated">首先，访问Azure门户，通过以下链接设置您的Azure免费试用订阅:<a class="ae na" href="https://azure.microsoft.com/en-us/free/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir">https://azure.microsoft.com/en-us/free/</strong></a></li><li id="d66c" class="mr ms iq ll b lm nb lp nc ls nd lw ne ma nf me mw mx my mz bi translated">一旦您的免费试用帐户被激活，请访问azure门户网站:<a class="ae na" href="https://portal.azure.com/#home." rel="noopener ugc nofollow" target="_blank"><strong class="ll ir">https://portal.azure.com/#home.</strong></a><strong class="ll ir"/>仔细检查右上角，确保您已使用您的免费试用azure帐户登录。如果不是，请确保登录，然后再执行后续步骤。</li><li id="694a" class="mr ms iq ll b lm nb lp nc ls nd lw ne ma nf me mw mx my mz bi translated">在左上角的标题下:“微软Azure”，点击创建资源。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d40f0bf2e4dc4db32c07b9679b7561a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*CWckXCwPHO-25n3HUE2V0g.png"/></div></figure><p id="1d5f" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">4.在“搜索市场”搜索栏中，键入<strong class="ll ir">“资源组”</strong>。点击标题为<strong class="ll ir">“资源组”</strong>的第一个结果，然后点击创建。</p><p id="2a04" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">5.点击create后，您将转到一个页面，在该页面中您可以设置新资源组的设置。为您的新资源组键入任何名称，然后点击下面标题为<strong class="ll ir">“Review+Create”</strong>的蓝色按钮。要进入资源组，请单击位于门户右上角的通知图标。然后点击<strong class="ll ir">“转到资源组”</strong>。</p><p id="4bbf" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">6.现在，再次单击门户右上角的create a new resource按钮。</p><p id="6f00" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">7.在搜索栏中，输入<strong class="ll ir">“活动中心”</strong>。点击标题为<strong class="ll ir">“活动中心”的第一个结果</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b6173ea3ce8e32a7cf6ab19a901cacf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*nysmMcM8k6ueniWK7HG6Bg.png"/></div></figure><p id="f628" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">8.这将再次把您带到一个页面，您可以在这里设置新的活动中心的设置。为您的活动中心键入任何名称。将定价等级设置为<strong class="ll ir">标准。</strong>启用Kafka，并确保“使该命名空间区域冗余”被关闭<strong class="ll ir">。</strong>订阅应设置为<strong class="ll ir">免费试用。</strong>选择您在之前步骤中创建的现有资源组。保持位置设置为美国西部，并将吞吐量单位设置为<strong class="ll ir"> 4。</strong>同时启用<strong class="ll ir">自动充气</strong>。</p><p id="00ce" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">8.点击“创建”后，需要几分钟时间来部署事件中心。单击右上角的通知图标，查看事件中心部署的状态。一旦部署成功，单击通知描述中的<strong class="ll ir">事件中心链接名称</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/a660cce8be926e0970ed5e8fc735b0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5d-4ZZ9fCi8Cf37U0EHKA.png"/></div></div><p class="nj nk gj gh gi nl nm bd b be z dk translated">点击您的活动中心的名称。在我的例子中，我将点击文本TestEventHub56</p></figure><p id="2367" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">9.单击后，它会将您带到您的部署页面。只需单击转到该资源即可访问您的事件中心<strong class="ll ir">名称空间。</strong></p><p id="333f" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">10.进入event hub名称空间后，查看右侧列中的各种资源部分。在<strong class="ll ir">实体下查找标题为<strong class="ll ir">“事件中心”</strong>的部分。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f1dca79267754abb9e4c2d69aa64ed5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*gvnd8KhDVOVW7NJUitGG3Q.png"/></div></figure><p id="80d1" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi">11.</p><p id="a1d0" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">转到活动中心页面后，单击单词<strong class="ll ir">活动中心</strong>旁边的+图标。点击后，您将进入活动中心创建设置页面。键入新事件中心的名称(不同于您的命名空间名称)，并将分区计数和消息保留时间设置为4。将捕获设置为<strong class="ll ir">关闭</strong>。然后点击创建。将立即创建事件中心，并且您将被转移回您的名称空间中的事件中心页面。要访问新的事件中心<strong class="ll ir">实例，</strong>单击其名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/d55eff4c49ac1decaab51ac14bb678a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hz6QKFu9Hnv34wSl8QiK2A.png"/></div></div></figure><p id="86ac" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">12.下一个设置是<strong class="ll ir">流分析</strong>作业。要进行设置，单击左上角的create resource按钮。然后，搜索上游分析作业。点击第一个结果，然后点击创建。您将再次转到流分析作业设置页面。在“设置”页面中，输入您的ASA作业名称，并选择您创建的资源组。保持<strong class="ll ir">托管环境</strong>为云，并将流式单元移动到<strong class="ll ir"> 4。</strong></p><p id="7ebf" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">13.部署您的ASA(<strong class="ll ir">Azure Stream Analytics)</strong>作业需要几分钟时间。一旦部署成功，点击通知栏中的<strong class="ll ir">转到资源</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/eb70c9f28938862fd30af6d646879833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qDMG5Xa900ilFMQKzr5cPw.png"/></div></div></figure><p id="5959" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">14.进入流分析作业后，单击右侧栏中<strong class="ll ir">作业拓扑下的<strong class="ll ir">输入</strong>。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d967209698f4c013938cc94f5b26881c.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*9P2t7U84Kh0SQzqv9Y1qYA.png"/></div></figure><p id="7493" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">在输入页面中，点击页面顶部的<strong class="ll ir">新流输入</strong>。一旦点击，它将带来三个不同的流输入供您选择。<strong class="ll ir">点击“活动中心”。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/64fcadde344f12b1c445f8b0ad422ba3.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*viYHHS-Z-5hPwgTOynBY7w.png"/></div></figure><p id="21eb" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">15.<strong class="ll ir"> 1。</strong>点击活动中心后，将显示输入设置页面。为您的输入别名设置一个名称，并保持其他设置不变。确保将“<strong class="ll ir">事件序列化格式”</strong>设置为<strong class="ll ir"> JSON。接下来，点击保存。这将自动开始测试与ASA和您的活动中心的连接。它将很快弹出一个通知，说你的连接是成功的。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/7df63a97c45648f830438ed105abf9a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*V_hZvQ8GMoV2xMaltlEvsg.png"/></div></figure><p id="e12d" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">16.接下来，转到<strong class="ll ir">“作业拓扑”下的输出部分</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/d92b9a76aea6267052a77edfed15440f.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*8Beed7rWlWUzB1S-4CFgSA.png"/></div></figure><p id="5781" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">一旦你点击输出。选择页面顶部的添加按钮。向下滚动选择Power BI作为输出。在Power BI设置页面中，设置Power BI输出别名的名称。然后点击授权。登录您的Power BI个人/工作帐户。登录后，为数据集选择一个名称。<strong class="ll ir">运行流分析作业会在Power BI中自动创建流数据集。数据集名称将是该流式数据集的名称。还要选择一个表名。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/2aca32de5de7bf532a84cd776db763c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*LxiuL18NQuRZUqDs1UNzsw.png"/></div></figure><p id="4ae6" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">17.一旦您单击save，它将自动开始测试到输出的连接。它应该说连接成功。</p><p id="05ac" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">18.现在，回到您的事件中心<strong class="ll ir">名称空间。</strong>点击右上角“创建资源”下的主页图标。确保选择<strong class="ll ir">“事件中心名称空间”而不是</strong>实例。名称空间是您在本教程中创建的第二个资源。单击后，您将位于事件中心名称空间内。在右侧栏中，点击设置下的<strong class="ll ir">共享访问策略</strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b7ff0b0293e22ab443a0517c8e699c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*AQFGGHFwEUp6JxaEEbIQ7w.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/06a053954780ebd256b3983bc8fd1f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*qKsXYmPqOIRlyFVIw7fFrg.png"/></div></figure></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h1 id="bad3" class="kr ks iq bd kt ku od kw kx ky oe la lb jw of jx ld jz og ka lf kc oh kd lh li bi translated">Python设置</h1><blockquote class="mf mg mh"><p id="1deb" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated">我们将使用Python向我们的Azure事件中心发布数据。请随意使用最适合您的IDE。流行Python ide:<a class="ae na" href="https://www.jetbrains.com/pycharm/download/#section=mac" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir">py charm</strong></a><strong class="ll ir">，</strong><a class="ae na" href="http://csc.ucdavis.edu/~chaos/courses/nlp/Software/Windows/npp.html" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir">notepad++</strong></a></p></blockquote><p id="6bbf" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">我们将使用pandas读取excel文件中的数据，然后将数据值发布到Azure Event Hub。</p><p id="2105" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">建立一个包含行和列的简单Excel表格。至少有15-20行数据供Python脚本读取。我的数据将包含<em class="mi">产量、SKU、序列号、产品重量、皮带速度等列。</em></p><p id="2a1d" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">负载字典应该分别具有列名和行值数据类型的键值对。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="044c" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">确保安装所有必需的软件包，否则程序将无法运行。</p><blockquote class="mf mg mh"><p id="6629" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated">现在您的python程序已经设置好了，可以运行了。</p><p id="e2e3" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated">运行程序并确认您的结果没有任何错误。</p></blockquote></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h1 id="4354" class="kr ks iq bd kt ku od kw kx ky oe la lb jw of jx ld jz og ka lf kc oh kd lh li bi translated">流分析和Power BI</h1><ol class=""><li id="b09b" class="mr ms iq ll b lm ln lp lq ls mt lw mu ma mv me mw mx my mz bi translated">现在继续你在Azure门户中的流分析工作。点击<strong class="ll ir">“职位拓扑”下的查询</strong></li><li id="f589" class="mr ms iq ll b lm nb lp nc ls nd lw ne ma nf me mw mx my mz bi translated">从这里，将以下代码复制到您的流分析查询中:</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="51cc" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated"><strong class="ll ir">用您的列名替换SKU、产量、BeltEfficiency等。确保相应地调整数据类型。</strong></p><blockquote class="mf mg mh"><p id="03d8" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated">流分析<strong class="ll ir">查询数据类型</strong>的完整列表可以在<a class="ae na" href="https://docs.microsoft.com/en-us/stream-analytics-query/data-types-azure-stream-analytics" rel="noopener ugc nofollow" target="_blank">这里</a>找到</p></blockquote><p id="3bdc" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">3.现在点击你的输入名旁边的3个省略号。接下来，单击来自输入的样本数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/76bb0f553180417c6dda853d140c1c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZMsy-SFo6f6BvzC-Zi8ag.png"/></div></div></figure><blockquote class="mf mg mh"><p id="ae4a" class="lj lk mi ll b lm mj jr lo lp mk ju lr ml mm lu lv mn mo ly lz mp mq mc md me ij bi translated"><em class="iq"> 4。等待您的输入被采样。采样完成后，您将会收到一个通知，告知您的样本已经成功。现在点击页面顶部的test。</em></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/1382697fda45a79802478c7e118f9095.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*Iebp2uPmhqZFuIWjSaJHyQ.png"/></div></div></figure><p id="f5a2" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">5.一旦测试成功，它应该会在查询的底部弹出您的结果。现在，单击ASA作业右侧的概述。然后点击<strong class="ll ir">开始。</strong>这将启动您的流式作业。</p><p id="2591" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">6.ASA作业需要一段时间才能开始流式传输，但一旦开始，将会在Power BI工作区的数据集部分创建一个新的流式数据集。<strong class="ll ir">在这里，您可以创建一个新的仪表板，并使用您的流数据集创建视觉效果。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d79eb53b40671086ff77d7d15e58061c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SV2A0RUndr2u9iP9i1_LtA.png"/></div></div></figure><p id="ff6f" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">联系人:</p><p id="1074" class="pw-post-body-paragraph lj lk iq ll b lm mj jr lo lp mk ju lr ls mm lu lv lw mo ly lz ma mq mc md me ij bi translated">索希尔·巴蒂亚</p></div></div>    
</body>
</html>