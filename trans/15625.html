<html>
<head>
<title>Building an Image Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立图像数据库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-a-plant-pet-toxicity-classifier-a29587f3f04c?source=collection_archive---------45-----------------------#2020-10-27">https://towardsdatascience.com/creating-a-plant-pet-toxicity-classifier-a29587f3f04c?source=collection_archive---------45-----------------------#2020-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b205" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/petsafe-plants-fastai" rel="noopener" target="_blank">用fast.ai对宠物安全植物进行分类</a></h2><div class=""/><div class=""><h2 id="d47c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用美素、硒和FastAI</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8cefdad1b7c37a590d898db0dde128ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yv72S2jsLA6RfiWe1-jo5Q.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@mili_vigerova?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">米拉达·维杰罗娃</a>在<a class="ae le" href="https://unsplash.com/s/photos/cat-plants?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="129d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated">进入深度学习领域，有大量高质量的资源，但每个人都同意，有意义的项目对真正掌握诀窍至关重要。</p><p id="83c9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有一个喜欢买植物的未婚妻，和一只喜欢啃植物的猫——我想还有什么比组装一个分类器来告诉我植物是否安全更好的呢！</p><p id="49e3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">需要注意的一点是，这里所做的所有工作都是在Google Colabs上完成的，所以如果您想在本地机器上做同样的事情，那么设置和导入方面的差异是必要的。用的笔记本可以在我的<a class="ae le" href="https://github.com/kenichinakanishi/houseplant_classifier" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="330a" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">步骤1 —获取数据</h1><p id="6f72" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">不幸的是，我无法在那里找到一个预制的图像数据集，它适合我想在<a class="ae le" href="https://www.kaggle.com/search?q=plants+tag%3Aplants" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上做的事情，或者使用<a class="ae le" href="https://datasetsearch.research.google.com/search?query=plant&amp;docid=l1iMPxjlp4UiuSjKAAAAAA%3D%3D" rel="noopener ugc nofollow" target="_blank">谷歌的数据集搜索</a>。所以，除了自己造还能做什么！</p><p id="3b87" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我决定使用ASPCA的猫和狗的植物毒性列表，因为我在苗圃的时候已经不止一次地使用过这个网站。这给了我们一个很好的工作核心。为了从网站上抓取这些文本数据，我们可以求助于<a class="ae le" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>，这是一个Python库，用于从HTML和XML文件中提取数据。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="c9d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然而，当查看他们的网站时，该表并不是一个易于访问的html表，而是将数据存储为面板中的行。幸运的是，BeautifulSoup为我们提供了一种简单的方法来搜索解析树以找到我们想要的数据。例如:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="ff92" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">将原始数据收集在一起后，我们需要进行一些创造性的拆分，将其分成几列:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="c52a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后，我们可以对特定于狗的列表重复此过程，然后合并数据帧并清除来自任何条目的nan:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/30aa04a0e21962aea5f004ce1c96cb5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-13WP5Rokb78EHbQk7ixw.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/s/photos/cat-computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae le" href="https://unsplash.com/@kimtheris?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Sereja Ris </a>拍摄</p></figure><h1 id="121d" class="mr ms iq bd mt mu nr mw mx my ns na nb kf nt kg nd ki nu kj nf kl nv km nh ni bi translated">第二步——浅层清洁</h1><p id="5c33" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">接下来，我们可以开始浅层清理，包括查看数据集，决定我们要使用哪些关键要素，并标准化它们的格式。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/39e4194d197fd649675fc2a84051bd02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r21_9X5N9qULvJwc6fTXAw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">(脏的)数据帧。注意spp的不一致使用。/sp。还有失踪的家人。</p></figure><p id="85dc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们目前有名字，别名，学名，家族以及我们的毒性专栏，这些都是从ASPCA网站上用BeautifulSoup搜集来的。由于我们将在谷歌图片搜索的基础上收集图片，因此我们决定根据每种植物的确切学名进行搜索，以获得尽可能具体的图片。像“珍珠点”、“大象耳朵”、“蓬松的褶边”和“粉红珍珠”这样的名字会很快返回不是我们要找的植物的结果。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d0b72fffcb5df68838d20eb533d12886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*UcwevWYOnsNDmR2xqE2zyw.png"/></div></figure><p id="bdc9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">纵观该系列，我们注意到在大小写和sp的使用上有细微的差别。/spp。/species表示一个物种，cv。/var。对于一个品种来说。基于这些观察，我们编写了几个应用于该系列的快速函数，试图标准化数据以便进一步清理。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="a9c2" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">步骤3 —通过交叉引用进行深度清理</h1><p id="8a18" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">仔细查看我们的学名(并对数据进行了几次迭代)，我们发现许多名称都是更被接受的物种的过时同义词，或者被拼错了。这将在图像收集和稍后训练模型以识别拥有不同标签的相同图像时引起问题。</p><p id="6d74" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一次谷歌搜索之后，我们找到了<a class="ae le" href="http://www.worldfloraonline.org/" rel="noopener ugc nofollow" target="_blank">世界植物在线</a>数据库，一个开放的、基于网络的世界植物物种简编。它们列出了同义词和公认的物种名称，并由“分类专家网络”定期更新。非常适合交叉引用我们不可靠的学名。该数据库以. txt文件的形式提供他们的数据，我们可以读取这些数据并与ASPCA植物毒性数据库中的数据进行比较。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/92f0e3024fb69ee142051b0576eb377e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5bMnjcGMYoTt-AccdjGrw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">来自WFO的数据——由“分类专家网络”定期更新。</p></figure><p id="c203" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">作为第一步，我们将对来自ASPCA的数据进行左合并，保留所有的类，并添加任何与我们当前拥有的科学名称相匹配的数据。我们的目标是将数据库中的所有植物更新为最新的公认学名，因此我们通过该关键字(taxonomicStatus)进行快速排序，并删除保留第一个条目的任何重复条目(如果它存在，将被接受)。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><h2 id="3566" class="nz ms iq bd mt oa ob dn mx oc od dp nb lo oe of nd ls og oh nf lw oi oj nh iw bi translated">步骤3.1 —使用字符串匹配修复打字错误</h2><p id="3783" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">许多学名指的是同一物种，但由于ASPCA数据库中的拼写错误，相差了几个字母。让我们使用difflib的SequenceMatcher来量化字符串距离(使用一种格式塔模式匹配的形式),通过将每个不被接受的条目与WFO数据库中的条目进行比较来发现这些错误。为了节省时间，我们可以对数据帧进行排序，只与以相同字母开头的学名进行比较。如果名称足够相似，我们就保留它，并最终返回最接近的匹配。这里，我们将阈值设置为0.9，以避免任何不正确的匹配。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="371f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们还定义了一个函数来修复数据中有问题的条目，这将把它们的学名、科、属和分类状态更新为WFO数据库中相应的(正确的)条目。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="47d2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以遍历我们的数据，搜索名称匹配，并当场纠正它们对应的数据帧条目。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="067a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这一过程有助于我们发现错误，否则这些错误需要深入的检查和高水平的领域知识:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f4ce39c1b1b6ea24c49bc0f80753c162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*pIhkeVGp5_NeTMqKjRL3VQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">即使知道有一个错误，并排看名字，也很难发现数据库中的错别字。</p></figure><h2 id="7d2a" class="nz ms iq bd mt oa ob dn mx oc od dp nb lo oe of nd ls og oh nf lw oi oj nh iw bi translated">步骤3.2-手动清理未识别物种</h2><p id="475a" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">不幸的是，许多这些未识别的物种在数据库中没有足够近的条目，足以让我对自动修复感到舒服。因此，我们对剩余的未知进行一些手动修复。令人欣慰的是，上面的代码已经将需要人工关注的样本数量减少到只有50个左右的条目，我们可以根据在Google上找到的正确条目，重用之前的fix_name函数来修复这些条目。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ol"><img src="../Images/19cb236ed94b8c65578ab98ee9c09ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPXBv1HwRgKA19sGYPMB0w.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">凯瑟琳·希斯在<a class="ae le" href="https://unsplash.com/s/photos/cat-laptop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h2 id="d022" class="nz ms iq bd mt oa ob dn mx oc od dp nb lo oe of nd ls og oh nf lw oi oj nh iw bi translated">步骤3.3 —匹配同义的科学名称</h2><p id="64b0" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">既然学名已经全部更正，我们仍然需要对它们进行标准化，因为学名可能会由于更新的研究而随时间发生变化(导致分类状态列中的同义词标签)。如果一个科学名称是一个公认名称的同义词，我们希望在未来的Google图片搜索中使用这个公认名称。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/92f0e3024fb69ee142051b0576eb377e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5bMnjcGMYoTt-AccdjGrw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">同一个类(scientificName)的多个标签(taxonomicStatus下的同义词)在以后会是一件非常糟糕的事情。</p></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="1c23" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">幸运的是，WFO数据库包含一个<code class="fe om on oo op b">acceptedNameUsageID</code>字段，其中包含了给定同义学名的公认名称，我们可以利用它来查找公认的学名，并将它们传递给<code class="fe om on oo op b">fix_name </code>函数。</p><h2 id="5820" class="nz ms iq bd mt oa ob dn mx oc od dp nb lo oe of nd ls og oh nf lw oi oj nh iw bi translated">第3.4步—收尾</h2><p id="9b29" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">现在，我们已经(自动和手动)纠正了拼写错误，并将剩余的同义词与其最新接受的名称进行了匹配。剩下的工作就是为图像下载清理数据帧。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="975c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">咻！这个过程花费了相当多的迭代来得到正确的方法。然而，在花时间训练模型之前，确保我们在建立图像数据库之前有干净的数据是至关重要的。</p><p id="e95a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">从最终的pet植物毒性数据框架中获得一些有趣的信息:</p><ul class=""><li id="d41e" class="oq or iq lh b li lj ll lm lo os ls ot lw ou ma ov ow ox oy bi translated">110个植物家族中有33个并非完全有毒或无毒。</li><li id="62d9" class="oq or iq lh b li oz ll pa lo pb ls pc lw pd ma ov ow ox oy bi translated">350个植物属中有7个不是完全有毒或无毒的。</li><li id="507c" class="oq or iq lh b li oz ll pa lo pb ls pc lw pd ma ov ow ox oy bi translated">只有两种植物表现出物种特异性毒性，对猫来说是百合，对狗来说是核桃！</li></ul></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="bf45" class="mr ms iq bd mt mu mv mw mx my mz na nb kf nc kg nd ki ne kj nf kl ng km nh ni bi translated">步骤4—下载图像</h1><p id="c8f8" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">下载图像的第一步是获取我们想要抓取的每个图像的URL。为了做到这一点，我们采用了一种基于硒的方法，该方法基于<a class="ae le" rel="noopener" target="_blank" href="/image-scraping-with-python-a96feda8af2d">法比安·博斯勒</a>的一篇文章。Selenium是用于测试web应用程序的可移植框架，几乎所有与网站的交互都可以模拟。Selenium webdriver充当我们的虚拟浏览器，可以通过python命令进行控制。这里使用一个脚本来搜索谷歌图片的基础上，我们给它一个查询，只寻找和下载缩略图网址，因为我们将抓取大量的图像。一个问题是，谷歌的许多图像缩略图都是以base64编码的图像存储的。我们也想抓住这些，这样我们就不会错过任何具有高相关性的图像，因为我们在搜索结果中走得越远，图像对训练目的就变得越差。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="fab8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">太好了！现在我们有办法刮谷歌图片换图片了！为了下载我们的图像，我们将利用fast.ai v2中的一个函数，<code class="fe om on oo op b">download_images</code>下载图像。但是，我们将深入源代码并对其进行一点升级，以便在图像出现时对其进行哈希处理，并忽略/删除任何重复的图像，这样我们就能获得一致的独特图像集。我们也将允许它解码和下载编码。jpg和。png图像，这是Google Images用来存储缩略图的格式。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6372" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以遍历我们的每个科学植物名称来收集它们的URL，然后下载这些图像，同时验证这些图像中的每一个都是独一无二的。每组图片都被下载到我在Colabs上的链接驱动器中它们自己的文件夹中。需要注意的一点是，由于Google Images上存在大量重复图片，要抓取的URL数量需要远远多于您最终想要的图片数量。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="6136" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下载后，我们采取措施确保每个文件夹包含正确数量的唯一图像。更多细节和代码见链接Github repo。</p><p id="365d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，在这一阶段，我们已经将有用的标签信息以及为每个类下载的唯一图像放在了一起。这些图片被整齐地分成各自的文件夹，并直接放在我们的Google Drive中。值得注意的是，如果你想用这些图像来训练CNN，在使用它们之前，如果你把这些图像放到本地的Colab环境中，你将会获得巨大的加速，但是这将在下一篇文章中详细讨论。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="b315" class="nz ms iq bd mt oa ob dn mx oc od dp nb lo oe of nd ls og oh nf lw oi oj nh iw bi translated">最后的想法</h2><p id="3993" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">从零开始建立一个数据库对于简单的玩具例子来说，图像分类项目是直接的(参见<a class="ae le" href="https://github.com/fastai/fastbook/blob/master/02_production.ipynb" rel="noopener ugc nofollow" target="_blank"> fast.ai v2的书</a>中一个棕色/黑色/泰迪熊分类器的好例子)。对于这个项目，我想扩展相同的方法，但是将它应用到更大的类集合中。这个过程实际上可以分为几个步骤:</p><ol class=""><li id="8823" class="oq or iq lh b li lj ll lm lo os ls ot lw ou ma pe ow ox oy bi translated"><strong class="lh ja">获取类列表<br/> </strong>从网页中抓取表格或文本数据非常简单，这要感谢BeautifulSoup，通常只需要通过正则表达式或内置python方法进行一点点处理。<br/> <em class="pf">清理和验证</em>你下载的数据的准确性是这一步最大的挑战。当我们有10个类和领域知识时，很容易发现错误并在继续之前修复它们。当我们有500个类，却不知道“薰衣草”和“薰衣草”哪个是正确的，事情会变得更加困难。我们可以用来验证数据的独立数据源至关重要。在这种情况下，我们相信ASPCA数据<a class="ae le" href="https://www.aspca.org/pet-care/animal-poison-control/cats-plant-list" rel="noopener ugc nofollow" target="_blank">中的毒性信息</a>，但不相信它们提供的科学名称，并且不得不使用提供最新分类信息的<a class="ae le" href="http://www.worldfloraonline.org/" rel="noopener ugc nofollow" target="_blank"> WFO数据库</a>来纠正它们。</li><li id="8b24" class="oq or iq lh b li oz ll pa lo pb ls pc lw pd ma pe ow ox oy bi translated"><strong class="lh ja">获取每个类的图片URL列表<br/> </strong>在这里，Selenium<em class="pf">非常</em>灵活。我推荐看看Fabian Bosler的文章<a class="ae le" rel="noopener" target="_blank" href="/image-scraping-with-python-a96feda8af2d">以获得更多关于如何使用Selenium webdriver的想法。你可以手动做的任何事情，网络驱动程序都可以模拟。我们可以执行搜索，找到缩略图并下载它们，如果我们想要更高分辨率的图像，甚至可以点击更大的图像并下载它们。</a></li><li id="49cf" class="oq or iq lh b li oz ll pa lo pb ls pc lw pd ma pe ow ox oy bi translated"><strong class="lh ja">将每个图像下载到一个带标签的文件夹<br/> </strong>下载图像的fastai功能运行良好，但一个主要的障碍是下载重复的图像。如果你想要更多的图片(10-15张),如果你下载了谷歌图片搜索的每一个结果，你很快就会得到大量的重复图片。此外，该功能无法处理base64编码的图像，因为许多缩略图存储为。令人欣慰的是，fastai提供了他们的源代码，可以修改这些源代码来解释编码图像，下载http链接，在它们进来时对它们进行哈希处理，只保留唯一的图像。</li></ol></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pg"><img src="../Images/fd4eeb05e6f1f490cbda033a1b764a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UKV0AtUTpctLh4ZrfM-XiQ.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">凯文在<a class="ae le" href="https://unsplash.com/s/photos/cat-plant?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="2ba3" class="mr ms iq bd mt mu nr mw mx my ns na nb kf nt kg nd ki nu kj nf kl nv km nh ni bi translated">下一步是什么？</h1><p id="1e96" class="pw-post-body-paragraph lf lg iq lh b li nj ka lk ll nk kd ln lo nl lq lr ls nm lu lv lw nn ly lz ma ij bi translated">我将看看我们使用的图像的数量是如何产生影响的，以及将一些带有人工(文本、图片等)的图像放在一起进行过滤。)我们可能在这个自动下载过程中无意中抓取的组件。然后，使用fast.ai架构构建和训练CNN图像分类模型！</p></div></div>    
</body>
</html>