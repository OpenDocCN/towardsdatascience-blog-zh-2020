<html>
<head>
<title>A Crisp Guide to Pandas for Data Engineering — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据工程熊猫简明指南—第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/important-pandas-libraries-for-data-engineering-684cef05e5c?source=collection_archive---------32-----------------------#2020-10-19">https://towardsdatascience.com/important-pandas-libraries-for-data-engineering-684cef05e5c?source=collection_archive---------32-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="db65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">数据工程</strong>是<strong class="jp ir">数据</strong>科学的一个方面，侧重于<strong class="jp ir">数据采集</strong>和<strong class="jp ir">分析</strong><a class="ae kl" href="https://www.datasciencegraduateprograms.com/data-engineering/#:~:text=Data%20engineering%20is%20the%20aspect,collecting%20and%20validating%20that%20information." rel="noopener ugc nofollow" target="_blank">来源</a>的实际应用。他们建立的管道对数据科学家转换数据非常有用。他们需要了解无数的技术，并为这项工作选择合适的工具。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/5ca66552babc150f97e6ce860482478e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCRwTC48icGLA-FlmO4TZA.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">癌症患者的数据图表</p></figure><h2 id="ae52" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated"><strong class="ak">内容</strong>:</h2><ol class=""><li id="fe3e" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk mc md me mf bi translated">进口</li><li id="a099" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">出口</li><li id="c383" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">看法</li><li id="1acc" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">索引</li><li id="173e" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">子集化</li><li id="b5b3" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">提取行和列</li><li id="00bf" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">取代</li><li id="c9cc" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">添加/删除</li><li id="21da" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">排序和重命名</li><li id="a294" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">结合</li><li id="927b" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk mc md me mf bi translated">聚集</li></ol><h1 id="ffd0" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">导入:</strong></h1><p id="f2af" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">导入pandas库以将CSV文件或XLSX格式的文件转换为dataframe。</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="c491" class="lc ld iq ng b gy nk nl l nm nn">import pandas as pd<br/>import numy as np</span><span id="8ac8" class="lc ld iq ng b gy no nl l nm nn">cancer_df = pd.read_excel("cancer_patient_data_sets.xlsx")<br/>cancer_df = pd.read_csv("cancer_patient_data_sets.csv")</span></pre><p id="2cec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要成功运行以上代码行，请确保将文件上传到Google Colab的<code class="fe np nq nr ng b">content</code>文件夹中，或者当您在Jupyter Notebook中工作时上传到您的本地文件夹中。你也可以从S3或谷歌硬盘上读取文件。</p><p id="d578" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">谷歌驱动:</strong></p><p id="4845" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">I)将您的google drive安装到colab</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="13e3" class="lc ld iq ng b gy nk nl l nm nn">from google.colab import drive <br/>drive.mount('/content/gdrive')</span></pre><p id="7d17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ii)现在，您将在左侧窗格(文件浏览器)中看到您的Google Drive文件。右键单击需要导入的文件，选择复制路径。然后在pandas中照常导入，使用这个复制的路径。</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="6fa3" class="lc ld iq ng b gy nk nl l nm nn">import pandas as pd <br/>cancer_df = pd.read_csv('gdrive/My Drive/<!-- -->cancer_patient_data_sets<!-- -->.csv')</span></pre><p id="2dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AWS S3:现在熊猫可以处理AWS S3网址了。简单地做</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="d3d3" class="lc ld iq ng b gy nk nl l nm nn">import pandas as pd<br/>import s3fs<br/><br/>cancer_df = pd.read_csv('s3://bucket-name/<!-- -->file_name<!-- -->.csv')</span></pre><p id="59fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">构建数据框架:</strong>如果你有数据，想构建一个数据框架，你可以这么做。</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="f5ac" class="lc ld iq ng b gy nk nl l nm nn">sample_df = pd.DataFrame([[1,'Bob','M','31','Builder'],<br/>                  [2,'Sally','F','29','Baker'],<br/>                  [3,'Scott','M','28','Candle Stick Maker']], <br/>columns=['id','name','gender','age','occupation'])</span></pre><h1 id="9a4d" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">导出:</strong></h1><p id="8474" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">您可以通过以下代码行将最终输出保存为CSV或EXCEL格式</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="53d8" class="lc ld iq ng b gy nk nl l nm nn">output_df.to_csv('saved_patients.csv', index=False)<br/>output_df.to_excel('saved_patients.xlsx', index=False)</span></pre><h1 id="e653" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated">查看:</h1><p id="820f" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated"><strong class="jp ir">显示数据帧顶部或底部的几条记录</strong></p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="13ea" class="lc ld iq ng b gy nk nl l nm nn">sample_df.head(5)<br/>sample_df.tail(5)</span></pre><h1 id="11d0" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">索引:</strong></h1><p id="d5cd" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated"><strong class="jp ir">索引您的数据帧:</strong></p><ul class=""><li id="ab2a" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">仅索引数据帧中的一个列:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="847b" class="lc ld iq ng b gy nk nl l nm nn">sample_df = sample_df.set_index('id')<br/>sample_df</span></pre><ul class=""><li id="0eb3" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">对数据帧中的多列<strong class="jp ir">进行索引:</strong></li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="f861" class="lc ld iq ng b gy nk nl l nm nn">sample_df = sample_df.set_index(['id','age'])<br/>sample_df</span></pre><ul class=""><li id="8235" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">要重置数据帧中的索引:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="0d9c" class="lc ld iq ng b gy nk nl l nm nn">sample_df.reset_index(inplace = True)<br/>sample_df</span></pre><h1 id="ddac" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">子集化:</strong></h1><ul class=""><li id="cbe6" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk nv md me mf bi translated">要从现有数据框架中选择有限数量的列并将其存储在新数据框架中:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="b81a" class="lc ld iq ng b gy nk nl l nm nn">df = sample_df[['age', 'name', 'occupation']]<br/>df</span></pre><ul class=""><li id="9970" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">要对行进行子集划分并考虑所有列:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="011d" class="lc ld iq ng b gy nk nl l nm nn">#Select first 3 rows :<br/>df[0:3]</span><span id="a615" class="lc ld iq ng b gy no nl l nm nn"><em class="nw"># Select first 5 rows (rows 0, 1, 2, 3, 4)<br/></em>df[:5]</span><span id="2576" class="lc ld iq ng b gy no nl l nm nn"><em class="nw"># Select the last element in the list<br/># (the slice starts at the last element, and ends at the end of the list)<br/></em>df[-1:]</span></pre><ul class=""><li id="020e" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">loc</code>方法从我们的数据帧中选择行和列:这个命令通过行和列的标签选择数据。</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="1cdc" class="lc ld iq ng b gy nk nl l nm nn"><em class="nw"># Select all columns for specific rows of index values 0 and 2 where no specific column in the dataframe has any index</em></span><span id="7bda" class="lc ld iq ng b gy no nl l nm nn">data = pd.read_csv("nba.csv")<br/>df = data.loc[[0, 2], :]</span><span id="802f" class="lc ld iq ng b gy no nl l nm nn"><em class="nw"># Select all columns for a specific row or multiple rows where a column is set as an index </em></span><span id="eadb" class="lc ld iq ng b gy no nl l nm nn">data = pd.read_csv("nba.csv", index="name")<br/>df <strong class="ng ir">=</strong> <!-- -->data.loc[["Avery Bradley"]] <br/>OR <br/>df <strong class="ng ir">=</strong> <!-- -->data.loc[["Avery Bradley", "R.J. Hunter"]]</span><span id="8281" class="lc ld iq ng b gy no nl l nm nn"># <em class="nw">Select specific rows and specific columns</em></span><span id="1994" class="lc ld iq ng b gy no nl l nm nn">data = pd.read_csv("nba.csv", index="name")<br/>df = <!-- -->[["Avery Bradley", "R.J. Hunter"],["Team", "Number", "Position"]]</span><span id="084e" class="lc ld iq ng b gy no nl l nm nn"><em class="nw"># Select only one or multiple specific row/rows and multiple columns after resetting index</em></span><span id="2362" class="lc ld iq ng b gy no nl l nm nn">data<!-- -->.reset_index(inplace = True)<br/>df = data.loc[0, ['Name', 'Number', 'Age', 'Position']] <br/>OR<br/>df = data.loc[[0,5], ['Name', 'Number', 'Age', 'Position']]</span></pre><ul class=""><li id="5bdf" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">iloc</code>方法从我们的数据帧中提取行和列的子集:这个命令允许我们按位置检索行和列。</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="fe3a" class="lc ld iq ng b gy nk nl l nm nn"># <em class="nw">Slice certain number of rows and columns</em><br/>df = sample_df.iloc[0:3, 1:4]<br/><br/><em class="nw"># Select the value of second row and third column<br/></em>df = sample_df.<!-- -->iloc[2, 3]</span><span id="a47c" class="lc ld iq ng b gy no nl l nm nn"><em class="nw"># Select all rows and selected columns<br/></em>df = sample_df.iloc [:, [1, 2]]</span><span id="76c3" class="lc ld iq ng b gy no nl l nm nn"># <em class="nw">Select certain range of rows and all columns</em><br/>df = sample_df.iloc<!-- -->[[0, 2]]</span></pre><ul class=""><li id="f71a" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">要根据标准选择数据帧:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="26bf" class="lc ld iq ng b gy nk nl l nm nn"># Select dataframe where the value of a column is given<br/>df[df.year == 2002]</span><span id="d3ca" class="lc ld iq ng b gy no nl l nm nn"># Select dataframe on multiple conditions<br/>df[(df.year &gt;= 1980) &amp; (df.year &lt;= 1985)]</span><span id="9f09" class="lc ld iq ng b gy no nl l nm nn">OR</span><span id="aacc" class="lc ld iq ng b gy no nl l nm nn">df = df[(df.year &gt;= 2000) &amp; (df.gender == 'M')]</span></pre><ul class=""><li id="d1c7" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">isin</code>命令:Pandas <code class="fe np nq nr ng b">isin() </code>方法有助于选择特定列中具有特定值或多个值的行。</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="1e86" class="lc ld iq ng b gy nk nl l nm nn">new = sample_df["gender"].isin(["M"])<br/>sample_df[new]</span><span id="f3e2" class="lc ld iq ng b gy no nl l nm nn">OR</span><span id="9b83" class="lc ld iq ng b gy no nl l nm nn">filter1 <strong class="ng ir">=</strong> sample_<!-- -->df["gender"].isin(["M"])<br/>filter2 <strong class="ng ir">=</strong> sample_<!-- -->df["occupation"].isin(["Baker", "Builder"])</span><span id="53cc" class="lc ld iq ng b gy no nl l nm nn"># displaying data with both filter applied and mandatory<br/>sample_<!-- -->df[filter1 &amp; filter2]</span></pre><ul class=""><li id="e8af" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">要选择数据帧中包含空值的行:</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="3634" class="lc ld iq ng b gy nk nl l nm nn"><em class="nw"># To select just the rows with NaN values, we can use the 'any()' method<br/></em>sample_df[pd.isnull(sample_df).any(axis=1)]</span></pre><ul class=""><li id="8628" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用lookup()函数:lookup()函数为DataFrame返回基于标签的“花式索引”函数:</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nx"><img src="../Images/d123534808f35b12fc35acfa6bd4edcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOQYn3HeuJIU3v1Ewn8z1Q.png"/></div></div></figure><h1 id="2d15" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">更换:</strong></h1><p id="88ee" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated"><strong class="jp ir">替换数据帧中的值:</strong></p><ul class=""><li id="7502" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">函数<strong class="jp ir"> </strong> <code class="fe np nq nr ng b">mask()</code>用于替换标准数据框中的所有值</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="3dd1" class="lc ld iq ng b gy nk nl l nm nn"># replace all the values greater than 10 with -25<br/>df.mask(df &gt; 10, <strong class="ng ir">-</strong>25)</span><span id="8ba0" class="lc ld iq ng b gy no nl l nm nn"># replace the Na values with 1000<br/>df.mask(df.isna(), 1000))</span></pre><ul class=""><li id="5eeb" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">where()</code>函数根据一个或多个特定标准过滤数据集</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="5869" class="lc ld iq ng b gy nk nl l nm nn">filter<!-- --> <strong class="ng ir">=</strong> <!-- -->sample_df["gender"]<strong class="ng ir">==</strong>"M"<br/>data.where(filter, inplace <strong class="ng ir">=</strong> <!-- -->True)</span><span id="230f" class="lc ld iq ng b gy no nl l nm nn">OR</span><span id="803e" class="lc ld iq ng b gy no nl l nm nn">filter1 <strong class="ng ir">=</strong> <!-- -->sample_df["gender"]<strong class="ng ir">==</strong>"M"<br/>filter2 <strong class="ng ir">=</strong> <!-- -->sample_df["age"]&gt;24<br/>sample_df.where(filter1 &amp; filter2, inplace <strong class="ng ir">=</strong> <!-- -->True)</span></pre><h1 id="19d1" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">提取行或列:</strong></h1><ul class=""><li id="24d1" class="lv lw iq jp b jq lx ju ly jy lz kc ma kg mb kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">get()</code>函数从数据帧中提取一列或多列</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="b4c4" class="lc ld iq ng b gy nk nl l nm nn">sample_df.get("occupation")</span><span id="613e" class="lc ld iq ng b gy no nl l nm nn">OR</span><span id="06cb" class="lc ld iq ng b gy no nl l nm nn">sample_df.get(["name", "age", "occupation"])</span></pre><ul class=""><li id="e51e" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">pop()</code>功能删除一列或多列</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="9f2f" class="lc ld iq ng b gy nk nl l nm nn"># Remove one column from the original dataframe<br/>popped_col <strong class="ng ir">=</strong> sample_df<!-- -->.pop("occupation")<br/>sample_df</span><span id="7991" class="lc ld iq ng b gy no nl l nm nn"># make a copy of the data frame and insert the popped column at the end of the other data frame<br/>new <strong class="ng ir">=</strong> <!-- -->sample_df.copy()<br/>popped_col <strong class="ng ir">=</strong> <!-- -->new.pop("name")<br/># creating new col and passing popped col<br/>new["New Col"]<strong class="ng ir">=</strong> <!-- -->popped_col<br/>new</span></pre><h1 id="67fd" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">添加/删除:</strong></h1><p id="952e" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated"><strong class="jp ir">删除列:</strong></p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="cc13" class="lc ld iq ng b gy nk nl l nm nn">del sample_df['column_name']</span></pre><ul class=""><li id="2bfc" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用<code class="fe np nq nr ng b">drop()</code>功能删除一行或多行或多列</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="9a5b" class="lc ld iq ng b gy nk nl l nm nn">df = data.drop('column_1', axis=1)</span><span id="df03" class="lc ld iq ng b gy no nl l nm nn"># Delete multiple columns from the dataframe<br/>df = data.drop(["column_1", "column_2", "column_3"], axis=1)</span><span id="6b4d" class="lc ld iq ng b gy no nl l nm nn"># Delete multiple rows from the dataframe<br/>data = df.drop([0,1], axis=0)<br/>data</span><span id="4026" class="lc ld iq ng b gy no nl l nm nn"># drop rows where age is less than 25<br/>df_filtered <strong class="ng ir">=</strong> <!-- -->df[df['Age'] &gt;<strong class="ng ir">=</strong> <!-- -->25]</span><span id="fd8a" class="lc ld iq ng b gy no nl l nm nn"># drop rows with null values<br/>df <strong class="ng ir">=</strong> <!-- -->df.dropna(how <strong class="ng ir">=</strong> <!-- -->'all')</span></pre><ul class=""><li id="bc6f" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">向现有数据框架添加新列或新行</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="1dca" class="lc ld iq ng b gy nk nl l nm nn"># Add a new column in the existing dataframe by providing the values manually in a list format<br/>sample_df['salary'] = [250000, 150000, 100000]<br/>sample_df</span><span id="1ece" class="lc ld iq ng b gy no nl l nm nn"># Add a new column by performing simple calculation on any other existing column<br/>sample_df['new_col'] = sample_df['salary']*2<br/>sample_df</span><span id="7cf8" class="lc ld iq ng b gy no nl l nm nn"># Add a new column having same constant values<br/>sample_df['new'] = 'y'<br/>sample_df<br/>OR<br/>sample_df['new'] = sample_df.apply(lambda x: 'y', axis=1)</span><span id="743a" class="lc ld iq ng b gy no nl l nm nn"># Insert a new row in an existing dataframe:<br/>sample_df.loc[3] = [4, 'Mike', 26, '<!-- -->Delivery boy']<br/>sample_df</span><span id="326c" class="lc ld iq ng b gy no nl l nm nn">OR</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ny"><img src="../Images/994d37bb90555c0cf706d8aa04edc6d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HnMSajr0dnOxWNiFla9cuA.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">在现有数据框架中插入新行</p></figure><h1 id="12ad" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">排序和重命名:</strong></h1><p id="e51b" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">按行和列对数据帧进行排序:</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="9d53" class="lc ld iq ng b gy nk nl l nm nn"># use sort_index() to sort by row index or names<br/>sample_df = sample_df.set_index('name')<br/>sample_df.sort_index(inplace<strong class="ng ir">=</strong>True)</span><span id="6fdd" class="lc ld iq ng b gy no nl l nm nn"># sort on multiple columns by descending order<br/>sort_by_age_occ <strong class="ng ir">=</strong> <!-- -->sample_df.sort_values(by = ['age','occupation'], ascending = False)</span><span id="9470" class="lc ld iq ng b gy no nl l nm nn"># sort a column in ascending order<br/>a <strong class="ng ir">=</strong> sample_<!-- -->df.sort_values(by <strong class="ng ir">=</strong>'age', ascending <strong class="ng ir">=</strong> True<!-- -->)</span></pre><p id="f942" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重命名数据帧中的列:</p><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="1d80" class="lc ld iq ng b gy nk nl l nm nn">sample_df.rename(columns <strong class="ng ir">=</strong> <!-- -->{'occupation':'Occupation', 'age':'Age', 'name':'Name'}, inplace <strong class="ng ir">=</strong> <!-- -->True)</span></pre><h1 id="9a47" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">结合:</strong></h1><p id="7b9a" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">有各种类型的连接:</p><ul class=""><li id="ddda" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated"><strong class="jp ir">一对一</strong>连接:例如当连接索引上的两个对象时(必须包含唯一值)。</li><li id="900a" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk nv md me mf bi translated"><strong class="jp ir">多对一</strong>连接:例如，将一个索引(唯一的)连接到不同数据框架中的一个或多个列。</li><li id="1574" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk nv md me mf bi translated"><strong class="jp ir">多对多</strong>联接:联接列上的列。</li><li id="94c6" class="lv lw iq jp b jq mg ju mh jy mi kc mj kg mk kk nv md me mf bi translated">使用merge()连接两个数据帧</li></ul><pre class="kn ko kp kq gt nf ng nh ni aw nj bi"><span id="531a" class="lc ld iq ng b gy nk nl l nm nn">'''<br/> There are 3 dataframes (df1, df2, df3) having similar column names - 'id', 'Feature1', 'Feature2'. You can merge 2 dataframes on a specific column.<br/>'''<br/>df_merge = pd.merge(df1, df2, on='id')  </span><span id="2ed3" class="lc ld iq ng b gy no nl l nm nn"># Combine two dataframes which will contain all the records<br/>df_outer = pd.merge(df1, df2, on='id', how='outer')</span><span id="52fb" class="lc ld iq ng b gy no nl l nm nn"># Combine two dataframes which will contain only the common records between the them<br/>df_inner = pd.merge(df1, df2, on='id', how='inner')</span><span id="6501" class="lc ld iq ng b gy no nl l nm nn"># Combine two dataframes which will contain the common records between the them along with all the records of first dataframe<br/>df_left = pd.merge(df1, df2, on='id', how='left')</span><span id="826c" class="lc ld iq ng b gy no nl l nm nn"># Combine two dataframes which will contain the common records between the them along with all the records of second dataframe<br/>df_right = pd.merge(df1, df2, on='id', how='right')</span><span id="d7f6" class="lc ld iq ng b gy no nl l nm nn">#Combine two dataframes on the records present in the index column<br/>df_index = pd.merge(df1, df2, right_index=True, left_index=True)  df_index</span></pre><ul class=""><li id="7879" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用concat()连接相似列名的两个数据帧</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nz"><img src="../Images/5c33a31519695b3c7c1a506f7a74fd91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5QEfxXl6cY4prQ8pPOvQdA.png"/></div></div></figure><p id="b064" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们也可以使用<code class="fe np nq nr ng b">append()</code>通过使用<code class="fe np nq nr ng b">result = df1.append(df2)</code>得到上面的结果</p><ul class=""><li id="5ea8" class="lv lw iq jp b jq jr ju jv jy ns kc nt kg nu kk nv md me mf bi translated">使用concat()连接不同列名和不同行的两个数据帧</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oa"><img src="../Images/fa43a8471b112238f539464367bfd71d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vl7bwCcGmdelKjli-nogzA.png"/></div></div></figure><h1 id="8864" class="ml ld iq bd le mm mn mo lh mp mq mr lk ms mt mu ln mv mw mx lq my mz na lt nb bi translated"><strong class="ak">聚合:</strong></h1><p id="1b1a" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy nc ka kb kc nd ke kf kg ne ki kj kk ij bi translated">可以将max()、min()、mean()、first()、last()等函数快速应用于GroupBy对象，以获得数据帧中每个组的汇总统计信息。</p><p id="4463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，你可能也会喜欢下一篇<a class="ae kl" href="https://medium.com/@pb.careofpriyanka/important-pandas-libraries-for-data-engineering-part-2-434dd2005c39" rel="noopener">文章</a>，它将更加关注一些重要的函数以及它们在数据工程中的用途。</p><p id="173c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。😃希望你能像我准备这篇文章时一样喜欢它..</p></div></div>    
</body>
</html>