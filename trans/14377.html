<html>
<head>
<title>Machine Learning in Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">朱莉娅的机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-in-julia-5bca700e0348?source=collection_archive---------2-----------------------#2020-10-04">https://towardsdatascience.com/machine-learning-in-julia-5bca700e0348?source=collection_archive---------2-----------------------#2020-10-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6cf5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Julia中机器学习入门的完整指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f0fbaf454fb9ccd93f354766e7f0156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ctRjv5OAkdAFtLCHLhblVw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@ikukevk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">凯文·Ku</a>在<a class="ae ky" href="https://unsplash.com/s/photos/machine-learning?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="e4bd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">朱莉娅是什么？</h1><p id="9023" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Julia是一种相对较新的编程语言，它在机器学习领域越来越受欢迎。随着它变得越来越受欢迎，我想写这篇文章来深入概述为什么以及如何在Julia中开始机器学习。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/10e1b7220e5e1010fa257a42ee876d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*paAo0FVoNs8nhNXs.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由茱莉亚项目—<a class="ae ky" href="https://julialang.org" rel="noopener ugc nofollow" target="_blank">https://julialang.org</a>，公共领域，<a class="ae ky" href="https://commons.wikimedia.org/w/index.php?curid=87405047" rel="noopener ugc nofollow" target="_blank">https://commons.wikimedia.org/w/index.php?curid=87405047</a></p></figure><h1 id="d6c6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么要用Julia做机器学习？</h1><h2 id="4736" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">速度和编译</h2><p id="c388" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Julia相对于其他机器学习语言的主要优势是速度。Julia的速度优势有两个主要原因，首先，它是一种编译语言。其次，它是为并行性而设计的。</p><h2 id="dd8c" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">类似脚本的语法</h2><p id="5082" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">尽管有速度优势，但Julia的语法并不是很复杂。它感觉更像一种脚本语言，从Python或R背景转换到Julia相对容易。</p><h2 id="44fb" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">社区、开发和图书馆</h2><p id="294c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">朱莉娅越来越受欢迎，也越来越成熟。随着这种增长，社区也在增长。尽管仍然远远小于Python社区，但看到社区和可用库数量的增长是一个好迹象。</p><h2 id="b30d" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">在Jupyter笔记本上运行Julia</h2><p id="31a7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Julia的另一个优点是，它可以在Jupyter笔记本上运行。而且非常容易安装！以下是将Julia安装到Jupyter笔记本的方法:</p><ol class=""><li id="3ed4" class="na nb it lt b lu nc lx nd ma ne me nf mi ng mm nh ni nj nk bi translated">从他们的网站下载并安装Julia</li><li id="da9f" class="na nb it lt b lu nl lx nm ma nn me no mi np mm nh ni nj nk bi translated">打开Julia命令行</li><li id="d517" class="na nb it lt b lu nl lx nm ma nn me no mi np mm nh ni nj nk bi translated">运行命令<code class="fe nq nr ns nt b">using Pkg</code></li><li id="7067" class="na nb it lt b lu nl lx nm ma nn me no mi np mm nh ni nj nk bi translated">运行命令<code class="fe nq nr ns nt b">Pkg.add("IJulia")</code></li><li id="22c4" class="na nb it lt b lu nl lx nm ma nn me no mi np mm nh ni nj nk bi translated">启动一个Jupiter笔记本，你可以在笔记本的右上角选择Julia(参见图片)</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a04f1561da14b19e5f7baeeb4d8d2048.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*VCIvmLWEH_8Z0pM7jKkpMA.png"/></div></figure><h1 id="e0fe" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Julia中虹膜数据集的数据准备</h1><p id="7eae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在进入真正的机器学习部分之前，需要把数据导入并准备好。这里我将只介绍三个基本步骤:导入一个csv文件，对一个分类变量进行热编码，以及进行训练测试分割。</p><h2 id="1e2f" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">数据准备1 —在Julia中导入CSV文件</h2><p id="b9b5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在Julia中入门的第一步是导入数据。在这种情况下，我们使用一个包含虹膜数据的csv文件。要将csv文件作为数据框导入，您需要添加如下所示的“CSV”和“DataFrames”库。然后，您使用“CSV。File”函数读取csv文件，DataFrame函数将其转换为数据帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="abfc" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">数据准备2-一个热编码因变量(品种)</h2><p id="5894" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于某些模型，您将需要一个分类变量的热编码。为此，您可以使用“车床”库。它具有OneHotEncode函数，可将数据帧转换为OneHotEncode数据帧。之后，您可以使用“选择”功能删除原始列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="9b31" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">数据准备3-列车测试分离</h2><p id="0ac2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于模型评估，您将需要一个训练测试分割。下面的代码使用库“Random”来实现这一点。基本上，它会选择一个随机的索引子集，并将它们视为训练集，而未选择的索引将作为测试集:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="8d0b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">朱莉娅的机器学习</h1><p id="f993" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Julia中用于机器学习的资源仍然相对分布在不同的包中。Julia还不像其他机器学习编程语言那样受欢迎，有时要找到特定的模型可能需要一些工作。寻找(或编写)在Python和r中容易获得的某些基本数据准备函数也可能需要更多的努力。</p><p id="8a3a" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">好消息是，有人倡议在更大的图书馆中重组机器学习模型。在这一点上，有两个库正在激烈竞争成为Julia的首选机器学习库:MLJ和Scikit Learn。</p><p id="2675" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">这两项倡议是伟大的，但它们尚未完全完成。因此，对于某些模型，它们只是向其他更小的机器学习库提供包装器。正因为如此，我发现涵盖其中两个较小的库也很重要:用于广义线性模型的“GLM”和用于许多基于树的模型的“决策树”。我将从较小的库开始，以较大的项目结束。</p><h1 id="a769" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">Julia使用GLM图书馆的逻辑回归</strong></h1><p id="4965" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">以下示例使用GLM库对Iris数据拟合三个逻辑回归模型。GLM使用“公式”接口，这在面向统计的库中很常见。我们可以指定一个族(在这种情况下为二项式)和一个链接类型(在这种情况下为Logit链接),以便创建所需的GLM类型。这是在下面代码片段的第一部分完成的。</p><p id="7158" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">在该片段的最后，三个模型的预测水平连接，以便为一对所有多类分类的应用做准备。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="a49c" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">以下是打印出来的串联预测概率(这是“preds”变量中的内容):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/eabcb7f4de9165937e26d02eafadf6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*3ABEvonIjoM0DhPdgMSElA.png"/></div></figure><p id="bffa" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">在下面的代码片段中，我们将每行的三个预测概率转换为每行一个类别预测。该决定基于三个预测概率中的每一个之间的最高预测概率:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="e4e5" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">这是重新分类的“preds_cat”数组的外观:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/f85a97fa603d6ec2c76c8450f2440e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*UDfX7TPrYSjabz_vMJa4_A.png"/></div></figure><p id="5f60" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">作为最后一步，下面是如何使用一个简短的for-loop来计算我们在测试集上的GLM预测的准确性:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="00f7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Julia中的决策树使用DecisionTree.jl库</h1><p id="d641" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在下面的代码片段中，您将看到如何在Julia中构建决策树。首先，它重新导入Iris数据，因为决策树支持使用分类变量。如介绍中所述，这是使用Julia的一个优势。</p><p id="87ef" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">然后，该模型被创建为决策树分类器的实例。我们可以给出几个超参数，例如本例中使用的max_depth。感叹号的fit语法非常特殊。</p><p id="7aa0" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">最后两步是使用predict函数对测试集进行预测，并计算准确性，与前面的模型一样。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="9802" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Julia中的随机森林使用DecisionTree.jl库</h1><p id="f68b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如您将看到的，随机森林模型的应用方式几乎与决策树相同。一开始可能会比较混乱，但是随机森林模型也是决策树库的一部分！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="acb3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Julia中机器学习的主要包</h1><p id="4e77" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在我们已经看到了如何在Julia中使用两个很大但很小的库来进行机器学习，让我们来看看更大的库。如前所述，有两个主要的软件包在竞争成为Julia的首选ML库:Scikit Learn和MLJ。我们去查查他们俩。</p><h2 id="0f5a" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">Julia中用于机器学习Scikit Learn</h2><p id="61b3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">很多人都知道Scikit是从Python中学习的。它是Python中用于机器学习的<em class="oc">包，在Julia中拥有它也很棒。如果我们能使用和Python一样的语法，那就简单多了！</em></p><p id="1dd1" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">让我们看一个在Julia中学习Scikit的例子。这个代码片段从导入Scikit学习库开始。下一步是加载您想要使用的模型(在这种情况下是逻辑回归)。使用“适合！”语法(注意感叹号)，模型训练好了。</p><p id="b2b5" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">之后，使用预测函数用训练好的模型预测测试集。最后，计算精度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="f079" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">在Julia中使用Scikit Learn也有它的缺点。例如，我们可以在Julia中使用的Scikit Learn库的很大一部分实际上只是Python的包装。除了一些已经在Julia中实现的模型，Julia模型实际上使用Pycall来调用Python代码。</p><p id="54a9" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">但是，如果我们想换成朱丽亚，应该是为了拥有朱丽亚的好处。Julia的一个主要优势是相对于Python的速度优势，调用Python代码真的不是我们应该在这里做的。如果只是一个Python包装器，我们还不如直接用Python学习Scikit。</p><p id="26eb" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">另一个缺点是Scikit Learn中的Python模型不支持分类变量。除了对它们进行编码之外，在Scikit Learn中真的没有什么可以做的，这确实是一个缺点(特别是对于基于树的模型)。正如您在整个例子中看到的，Julia允许我们将分类变量视为一个变量，而不是一组热编码的虚拟变量。所以当我们把Julia仅仅作为Python包装器时，Julia的优势也将消失。</p><h2 id="6c4a" class="mo la it bd lb mp mq dn lf mr ms dp lj ma mt mu ll me mv mw ln mi mx my lp mz bi translated">茱莉亚的机器学习MLJ</h2><p id="cf04" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Julia中机器学习的一个竞争对手是MLJ包。它承诺解决分类变量的问题，它是纯粹的-朱莉娅。这使得探索变得非常有趣。它还得到了艾伦图灵基金会的大力支持，这让我相信这个图书馆会一直存在下去。</p><p id="15d8" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">现在，让我们在下面的代码片段中看看机器学习中MLJ的例子。有几件事和平常不一样。特别是，创建机器是一种语法选择，对许多人来说是新的。更不寻常的是必须加载一个模型，而不是导入一个包。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="7597" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">但是在这些语法差异之后，MLJ库的使用并没有本质上的不同。MLJ语法很容易学习，在MLJ的文档网站上有很好的文档。</p><h1 id="fc1f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="7a8d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我们看到了Julia中的四个机器学习库。其中两个库(MLJ和Scikit Learn)似乎是接管Julia机器学习领域的真正竞争对手。</p><p id="da43" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">Scikit Learn拥有Python实现中熟悉的语法的巨大优势，并获得了社区的信任。另一方面，Scikit Learn通常只是简单地调用Python代码，这首先就剥夺了使用Julia的大部分优势。</p><p id="70ae" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">作为一个真正的朱莉娅项目，MLJ有很大的优势。它的语法有点新，但是差别似乎很小。对MLJ来说，真正的挑战是赢得更大社区的信任和欢迎。</p><p id="f138" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma nx mc md me ny mg mh mi nz mk ml mm im bi translated">我希望这篇文章已经给了你开始使用Julia所需要的一切，我祝你好运！</p></div></div>    
</body>
</html>