<html>
<head>
<title>You know Excel. Time to learn SQL.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你知道Excel。该学SQL了。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/you-know-excel-time-to-learn-sql-e77a2b5c8fbb?source=collection_archive---------6-----------------------#2020-10-20">https://towardsdatascience.com/you-know-excel-time-to-learn-sql-e77a2b5c8fbb?source=collection_archive---------6-----------------------#2020-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/cb9ca482ced3ebee6d12b6f9508fda49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*593riG7iwvFYslfdLSwM4Q.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">奥琳卡·谢尔坚科摄于<a class="ae jg" href="https://www.pexels.com/photo/top-view-photo-of-white-keyboard-1772123/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a></p></figure><div class=""/><div class=""><h2 id="cd61" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">9个核心excel功能转化为SQL</h2></div><p id="2424" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着世界变得越来越由数据驱动，越来越多的专业人士正在更密切地与数据打交道。</p><p id="ea52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在许多情况下，对这个领域的第一次介绍来自Microsoft Excel的永恒形式。Vlookups、数据透视表、sumifs也许给喜欢冒险的人来点VBA。</p><p id="01b7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，就像初露头角的数据分析师、爱好者和探索者开始了解excel的神奇和优点一样，他们也开始努力克服它的局限性。</p><p id="53a8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你遇到过类似<em class="lu">“正在计算:(4个处理器))”</em>的消息，你可能知道我的意思。对于大型数据集，Excel会变得相当慢。</p><p id="2140" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel还带来了难以避免的再现性问题，即使对于最细心的用户来说也是如此。这个过程听起来可能很熟悉:接收数据→做一些操作(vlookup、filter、pivot等。)→接收需要相同处理的更新数据。冲洗，重复。多痛苦啊。</p><p id="fdf3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据库技术有助于减轻这些缺点，因为它将数据从查询和操作中分离出来:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lv"><img src="../Images/585b76da9111a1e03bde6add3857b631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g9B5B71cj4ZWxkHJd2jbbg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者创建的图像。由<a class="ae jg" href="https://www.flaticon.com/authors/pixel-perfect" rel="noopener ugc nofollow" target="_blank">像素完美制作的图标</a>来自<a class="ae jg" href="http://www.flaticon.com/" rel="noopener ugc nofollow" target="_blank">www.flaticon.com</a></p></figure><p id="c86f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SQL是用于与数据库通信的主要语言，在熟悉excel之后学习它是一项很好的技能。</p><p id="bcf6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将把一些主要的excel用例及函数翻译成SQL，以帮助学习过程变得更加容易和有形。</p><h1 id="9372" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">1.挑选</h1><p id="3c3d" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在excel中:</strong>如前所述，数据存储和操作发生在Excel的同一个地方。因此，选择数据就像突出显示我们想要的单元格一样简单。</p><p id="b75d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL中:</strong>我们编写一个查询来从数据库表中“选择”数据。每个表格就像excel中的一个数据块，它包含行、列和数据单元格。</p><p id="6caa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于一个基本的select查询，我们需要指定要查询的表的名称和要从该表返回的列的名称。</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/bf919505bb6fa0d87a8e961f48b9055f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSPTG17yhroCBAn1QwE0ZQ.png"/></div></div></figure><p id="21a2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在SQL中，星号表示“所有列”所以我们也可以运行:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="f8c0" class="nd mb jj mz b gy ne nf l ng nh">select * from mytable;</span></pre><p id="7e4a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们大声读出来，我们会说“从我的表中选择恒星”。</p><h1 id="0f25" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">2.过滤器</h1><p id="9c6f" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中</strong>:我们可以通过选择数据功能区中的过滤器图标，然后使用每列旁边的下拉菜单来过滤数据中的行。</p><p id="eea3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL: </strong>中，我们在查询中添加了一个“where子句”，并指定了一个我们想要应用的条件:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8543a584c3119b5d515eff7a7af00d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*GulZF4iRl4ju8YsN7otEgA.png"/></div></figure><p id="862c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与excel类似，我们有几个过滤条件选项:</p><p id="eb52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">过滤到特定值:</strong></p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="f14c" class="nd mb jj mz b gy ne nf l ng nh">select * from mytable where <strong class="mz jk">column1 = 10</strong>;</span></pre><p id="ada5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">用算术运算符过滤:</strong></p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="da0f" class="nd mb jj mz b gy ne nf l ng nh">select * from mytable where <strong class="mz jk">column1 &lt; 10</strong>;</span></pre><p id="d9b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">用“in”运算符过滤:</strong></p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="1d63" class="nd mb jj mz b gy ne nf l ng nh">select * from mytable where <strong class="mz jk">column1 in (1,2,3)</strong>;</span></pre><p id="14e7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">多条件过滤:</strong></p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="317e" class="nd mb jj mz b gy ne nf l ng nh">select * from mytable where <strong class="mz jk">column1 &gt; 2 or column2 = "APPROVED";</strong></span></pre><p id="16b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以使用“与/或”逻辑将多个条件嵌套在一起。我们只需要确保遵循<a class="ae jg" href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/operator-precedence-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank">操作符优先级</a>并在必要的地方使用括号。</p><h1 id="a8ba" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">3.分类</h1><p id="5f7c" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong>我们使用数据功能区中的排序图标来应用排序条件。</p><p id="9785" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL中:</strong>我们在查询中添加了一个“order by”子句，以便按照我们期望的排序顺序返回数据:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nj"><img src="../Images/110bc04dc39b846a4304219e781a2fc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ogEfyhJqYv-3_AU9aL6rPw.png"/></div></div></figure><p id="4f5b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，我们可以按照提供的顺序对多个列进行排序。</p><p id="5f75" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">默认情况下，列按<strong class="la jk"><em class="lu"/></strong>升序排序(最小值优先)。为了改变这一点，我们可以在想要降序排序的每一列后面添加“desc”关键字。</p><h1 id="c609" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">4.条件句(If语句)</h1><p id="8da6" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong>我们使用一个“if语句”。如果我们需要一组以上的条件，我们使用“嵌套If语句”</p><p id="d7ed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在SQL中:我们使用一个“case when”语句。</p><p id="f419" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是基本语法:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/9c6ccaa26f938ded09b173b9554a30e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vou2xlTbasGIMfeyC2ev6w.png"/></div></div></figure><p id="e726" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个“when/then”对指定一个条件和一个条件为真时返回的值。然后我们添加一个可选的“else”语句来捕捉任何遗漏的条件。最后，我们将结果列命名为。</p><p id="ac14" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这比Excel可读性强得多，Excel需要大量的嵌套括号来创建复杂的条件。</p><h1 id="31a2" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">5.删除重复项</h1><p id="d44e" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong>我们选择数据功能区下的“删除重复”选项。然后从工作表中删除重复的值。</p><p id="cc6e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL中:</strong>我们在select语句中使用“distinct”关键字:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="6704" class="nd mb jj mz b gy ne nf l ng nh">select distinct column1, column2 from mytable;</span></pre><p id="a4e4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面的查询将返回column1和column2的所有唯一组合，而不更改基础数据。</p><h1 id="4aa1" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">6.Vlookup /索引匹配</h1><p id="4d65" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong> Vlookup和Index + Match是将一个数据表中的数据合并到另一个数据表中的两种方法。</p><p id="0371" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL中:</strong>我们利用了所谓的“连接”——一种基于公共数据点将两个表中的数据组合起来的方法。</p><p id="54ee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是基本语法:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/4ab85bb3315994d4e01e2e76f0f976eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cdg8iSD0Knpzi3KimbuT0g.png"/></div></div></figure><p id="7dc2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该连接有三个主要部分。</p><p id="1ba4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">首先</strong>，我们指定要从每个表中返回哪些列。为了表明我们希望每一列来自哪个表，我们使用以下约定:表名+句点+列名。</p><p id="7439" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第二个</strong>，我们指定想要使用的两个表和连接类型。我不会详细介绍不同类型的连接，但如果您想了解更多信息，我建议查看我的连接数据指南(如下)。</p><p id="1a8a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第三，</strong>我们指出我们想要“连接”的列(两个表之间有共性的数据点)。这就像你传递给Vlookup的第一个参数。</p><div class="is it gp gr iu nm"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-joining-data-935c8e579fb7"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jk gy z fp nr fr fs ns fu fw ji bi translated">连接数据的初学者指南</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">左接合。内部联接。外部联接。啊？</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ja nm"/></div></div></a></div><h1 id="d43f" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">7.聚合(总和、计数、平均值等。)</h1><p id="6f72" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong>我们将函数添加到一个空单元格中，然后传入我们想要聚合的单元格范围。</p><p id="6659" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL </strong>中:我们拥有与excel相似的聚合函数。我们将列名传递给这些函数，并在select子句中调用它们:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="08e5" class="nd mb jj mz b gy ne nf l ng nh">select sum(column1), count(column2), avg(column3) from mytable;</span></pre><p id="38bb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有多种功能可供我们执行，其中许多功能与excel重叠。</p><h1 id="7725" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">8.条件聚合(sumif、countif、averageif)</h1><p id="af81" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中:</strong>像“sumif”这样的条件聚合函数允许我们仅对指定条件为真的行执行聚合。</p><p id="c20a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL中:</strong>我们可以在聚合函数中嵌套一个“case when”。</p><p id="d3d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="c7a1" class="nd mb jj mz b gy ne nf l ng nh">select sum(case when column1 &gt; 10 then column2 else 0 end) <br/>from mytable1;</span></pre><p id="f62e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这段代码中，首先执行“case when ”,只有当column1大于10时才返回column2。然后我们对结果值求和。如果列1 &gt; 10，这与对列2求和是一样的。</p><p id="0586" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也有一些SQL版本允许以下语法:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="01d1" class="nd mb jj mz b gy ne nf l ng nh">select sum(column2) filter (where column1 &gt; 10)<br/>from mytable1;</span></pre><h1 id="e42c" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">9.数据透视表</h1><p id="aa16" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated"><strong class="la jk">在Excel中</strong>:我们可以使用透视表进行多维度的聚合。</p><p id="6cac" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">在SQL </strong>中:我们使用一个“groupby”语句。</p><p id="3fa8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“groupby”将我们的数据分成不同的组，然后对每个组进行聚合。</p><p id="9526" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如:</p><figure class="lw lx ly lz gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/4ae7a6d4c4a24b07e4f468419229f658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cxHK3fatVM4rjql76wrWA.png"/></div></div></figure><p id="3ccb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这与将“列1”和“列2”添加到数据透视表的行部分，然后对不包含任何缺失值的列进行计数是一样的。</p><p id="c525" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel数据透视表也有一个“列”部分。为了在SQL中复制这一点，我们可以在groupby中使用条件聚合:</p><pre class="lw lx ly lz gt my mz na nb aw nc bi"><span id="2403" class="nd mb jj mz b gy ne nf l ng nh">select column1, <br/>count(case when column2 = “group1” then column2 end) as group1count,<br/>count(case when column2 = “group2” then column2 end) as group2count<br/>from mytable1<br/>group by 1;</span></pre><h1 id="90f7" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">结束语</h1><p id="0d5e" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">一开始，从电子表格应用程序过渡到“编写代码”会让人感到畏惧。但是如果你有处理数据的经验，那么SQL实际上并不比excel难，只是有一点不同。</p><p id="8303" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最好的学习方法是获取一些数据并开始练习。编码快乐！</p><p id="b70e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="lu"> P.S. →如果你想了解更多关于SQL、Python、数据科学的知识，订阅我的</em> </strong> <a class="ae jg" href="https://subscribe.to/everythingdata" rel="noopener ugc nofollow" target="_blank"> <strong class="la jk"> <em class="lu">免费邮件列表</em> </strong> </a> <strong class="la jk"> <em class="lu">！</em>T13】</strong></p></div></div>    
</body>
</html>