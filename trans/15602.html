<html>
<head>
<title>Cosine Similarity Explained Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python解释余弦相似性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cosine-similarity-explained-using-python-machine-learning-pyshark-5c5d6b9c18fa?source=collection_archive---------22-----------------------#2020-10-27">https://towardsdatascience.com/cosine-similarity-explained-using-python-machine-learning-pyshark-5c5d6b9c18fa?source=collection_archive---------22-----------------------#2020-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ac7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在本文中，我们将讨论余弦相似性，并举例说明它在Python中产品匹配的应用</h2></div><p id="f7a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">目录:</strong></p><ul class=""><li id="c079" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">介绍</li><li id="4a91" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">余弦相似性(概述)</li><li id="688c" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">使用Python的产品相似性(示例)</li><li id="bc0c" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">结论</li></ul></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="ff4d" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">介绍</h1><p id="601b" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">推荐引擎领域中许多有趣的案例和项目很大程度上依赖于正确识别项目和/或用户对之间的相似性。</p><p id="624f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有几种量化相似性的方法，它们具有相同的目标，但在方法和数学公式上有所不同。</p><p id="d9ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将探讨其中一种量化方法，即余弦相似度。我们将把学到的理论应用到样本数据中，尝试解决用户相似性问题。</p><p id="1c07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文中学到的概念可以应用于各种项目:文档匹配、推荐引擎等等。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="4cbf" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">余弦相似性(概述)</h1><p id="356c" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">余弦相似性是两个非零向量之间相似性的度量。它被计算为这些向量之间的角度(也与它们的内积相同)。</p><p id="60f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这听起来像是很多新的或者对学习者来说很难的技术信息。我们将在这里通过详细的可视化和例子来分解它。</p><p id="e852" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们考虑三个向量:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/96428b4a8a3c5b0d25aabc49b1b46e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*0QYo2rDtYl04Aprastn_Xw.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="e2f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并在笛卡尔坐标系中绘制它们:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a1d02c75bcae9ccec2b99a2261e31696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*cWMUzpuxOncjm8up"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="4e24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，从图中我们可以看到，矢量<strong class="kk iu"> A </strong>比矢量<strong class="kk iu"> C </strong>更类似于矢量<strong class="kk iu"> B </strong>。</p><p id="1ba2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是我们怎么知道呢？嗯，通过观察，我们看到它们<strong class="kk iu"> A </strong>和<strong class="kk iu"> B </strong>比<strong class="kk iu"> A </strong>到<strong class="kk iu"> C </strong>彼此更靠近。从数学上讲，角度<strong class="kk iu"> A0B </strong>小于<strong class="kk iu"> A0C </strong>。</p><p id="1783" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回到数学公式(让我们考虑矢量<strong class="kk iu"> A </strong>和矢量<strong class="kk iu"> B </strong>)，两个非零矢量的余弦可以从欧几里德点积中导出:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/f6229eba39ad4c8148a88a977eff87bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*A1x8hittGEn0lFN0P07dQQ.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="36c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这解决了:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/47caf6a93b407eaa09544922363a5b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*7OmVeGXfv6h8rjJawqyorg.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><h2 id="fd29" class="nl ma it bd mb nm nn dn mf no np dp mj kr nq nr ml kv ns nt mn kz nu nv mp nw bi translated">求解组件</h2><p id="83d6" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">我们来分解一下上面的公式。</p><p id="0784" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第一步:</strong></p><p id="d3e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将从提名者开始:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/06b8b6b27424a7315e11368c3ec50434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*V41RbVLD50EN5ZI3Io8t9g.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="0844" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<em class="ny"> Ai </em>和<em class="ny"> Bi </em>是向量A和b的第<em class="ny"> i </em>个元素。</p><p id="d46e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我们的情况，我们有:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b56dba188d54fd7aa620cafe0f907ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*2VHvlSKoVgzWlRnLPeY0zA.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="d7a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很好，我们找到了矢量A和b的点积。</p><p id="a094" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第二步:</strong></p><p id="b354" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是研究分母:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/897359d6a5bfd720d353ef2827c5dd8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*bD4UjEbzMXgZDfKeYpXxYQ.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="07ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到的是向量长度的乘积。简单来说:向量A的长度乘以向量b的长度。</p><p id="a44c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">向量的长度可以计算如下:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e234a2bd149b87f1a8d05f12b65be704.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*RGhm2x7gLMvvunYX41-MOg.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="5915" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中<em class="ny"> A_i </em>是向量A的第<em class="ny"> i </em>个元素。</p><p id="a71a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我们的情况，我们有:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/e78f5fd8b4a736d77f9cc742dc32391c.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*LwrPCDHHVwhAesnrvu7MuA.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="e0c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第三步:</strong></p><p id="49f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">至此，我们已经拥有了原始公式的所有组件。让我们把它们插上电源，看看我们得到了什么:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0f1ea8dce8d43d4f31dfcc5d3c9c65ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*UTNR-g9O9dXxb3z_fVSpnw.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="4231" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这两个向量(向量A和向量B)具有0.976的余弦相似性。注意，该算法是对称的，这意味着A和B的相似性与B和A的相似性相同。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="7d4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">加法</strong> <br/>按照同样的步骤，你可以求解向量A和C之间的余弦相似度，应该得到0.740。</p><p id="d23c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这证明了我们在看图时的假设:向量A更类似于向量B，而不是向量c。在本教程创建的示例中，我们正在处理一个非常简单的二维空间，您可以很容易地看到图上的差异。然而，在真实的案例场景中，事情可能没有那么简单。在大多数情况下，您将使用具有两个以上要素的数据集来创建一个n维空间，如果不使用一些降维技术(<a class="ae oe" href="https://pyshark.com/principal-component-analysis-in-python/" rel="noopener ugc nofollow" target="_blank"> PCA </a>，<a class="ae oe" href="https://pyshark.com/visualization-of-multidimensional-datasets-using-t-sne-in-python/" rel="noopener ugc nofollow" target="_blank"> tSNE </a>)，可视化将非常困难。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="7d24" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">使用Python的产品相似性(示例)</h1><p id="f796" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">向量空间的例子对于我们理解计算余弦相似性的逻辑和过程是必要的。现在，我们如何在现实世界的任务中使用它呢？</p><p id="2696" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们把上面的向量数据放到一些现实生活的例子中。假设我们正在处理一些服装数据，我们希望找到彼此相似的产品。我们有三种类型的服装:连帽衫、毛衣和露脐上衣。可用的产品数据如下:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi of"><img src="../Images/8ae6b4d4e069b8db620e8e5d8a1a92ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*T5VXUq_eqgIJ-Er2k_uIqQ.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="c202" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，我们使用的数据与理论部分完全相同。但是把它放到上下文中会使事情更容易想象。根据上面的数据，我们认为帽衫更像一件毛衣，而不是一件露脐上衣。事实上，数据告诉我们同样的事情。</p><p id="d9a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了继续学习本教程，我们需要以下Python库:pandas和sklearn。</p><p id="487c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您没有安装它，请打开“命令提示符”(在Windows上)并使用以下代码安装它:</p><pre class="mx my mz na gt og oh oi oj aw ok bi"><span id="1ee1" class="nl ma it oh b gy ol om l on oo">pip install pandas<br/>pip install sklearn</span></pre><p id="d8e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将采取的第一步是在Python中将上述数据集创建为数据框(仅包含包含我们将使用的数值的列):</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="5c7d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该得到:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi or"><img src="../Images/85e60bd8f7e2146bfe8c2b4d5c51730e.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*d-42Kqpv-pDOxtoYL723aA.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="6a29" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，使用sklearn库中的<a class="ae oe" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html" rel="noopener ugc nofollow" target="_blank"> cosine_similarity() </a>方法，我们可以计算上述数据帧中每个元素之间的余弦相似度:</p><figure class="mx my mz na gt nb"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="17ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出是数据帧的每个条目之间具有相似性的数组:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div class="gh gi os"><img src="../Images/e280d6c749c922c656f40c864d67e3d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*P5EIaFBIbXBsgLIzqO0DWA.png"/></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="cd3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了更好地理解，上面的数组可以显示为:</p><figure class="mx my mz na gt nb gh gi paragraph-image"><div role="button" tabindex="0" class="ou ov di ow bf ox"><div class="gh gi ot"><img src="../Images/f442e98e2d52a90865b332cb14e72859.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*iIKxyzPtmC2yvfqv6vr5Kw.png"/></div></div><p class="ne nf gj gh gi ng nh bd b be z dk translated">作者图片</p></figure><p id="24ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，计算结果与理论部分的手动计算结果相同。当然，这里的数据很简单，而且只是二维的，因此结果很高。但是同样的方法可以扩展到更复杂的数据集。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="cf60" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">结论</h1><p id="bd3e" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在本文中，我们讨论了余弦相似性，并举例说明了它在Python产品匹配中的应用。</p><p id="8ef2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述大量材料是复杂推荐引擎和预测算法的基础。</p><p id="ea87" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我也鼓励你看看我在<a class="ae oe" href="https://pyshark.com/category/machine-learning/" rel="noopener ugc nofollow" target="_blank">机器学习</a>的其他帖子。</p><p id="c532" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有任何问题或者对编辑有任何建议，请在下面留下你的评论。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="22b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ny">原载于2020年10月27日</em><a class="ae oe" href="https://pyshark.com/cosine-similarity-explained-using-python/" rel="noopener ugc nofollow" target="_blank"><em class="ny">【https://pyshark.com】</em></a><em class="ny">。</em></p></div></div>    
</body>
</html>