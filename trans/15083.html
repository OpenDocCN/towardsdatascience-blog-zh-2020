<html>
<head>
<title>Extracting tabular data from PDFs made easy with Camelot.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Camelot让从pdf中提取表格数据变得简单。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/extracting-tabular-data-from-pdfs-made-easy-with-camelot-80c13967cc88?source=collection_archive---------4-----------------------#2020-10-17">https://towardsdatascience.com/extracting-tabular-data-from-pdfs-made-easy-with-camelot-80c13967cc88?source=collection_archive---------4-----------------------#2020-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f12c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从pdf中提取表格并不困难。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f3f8afc199d9eeccaeb4c335c81590d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MyKnw52oI8m4AhG5"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼·米勒在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b3b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从pdf中提取表格数据很难。但更大的问题是，许多公开数据都是PDF文件。这些公开数据对于分析和获得重要见解至关重要。然而，访问这样的数据成为一个挑战。例如，让我们看看由<a class="ae ky" href="http://by the National Agricultural Statistics Service (NASS)," rel="noopener ugc nofollow" target="_blank">国家农业统计局(NASS) </a>发布的一份重要报告，它涉及美国种植的主要农作物:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0b41c2d5dd300efd21390cbbb1a6c01e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kOVCWgcv4SDPG0u4okhk9w.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">报告来源:<a class="ae ky" href="https://www.nass.usda.gov/Publications/Todays_Reports/reports/pspl0320.pdf" rel="noopener ugc nofollow" target="_blank">https://www . NASS . USDA . gov/Publications/Todays _ Reports/Reports/pspl 0320 . pdf</a></p></figure><p id="5540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于任何分析，起点都应该是获取包含详细信息的表格，并将其转换为大多数可用工具都能接受的格式。正如你在上面看到的，在这种情况下，简单的复制粘贴是行不通的。大多数情况下，标题不在正确的位置，一些数字会丢失。这使得pdf处理起来有些棘手，显然，这是有原因的。我们将讨论这个问题，但首先让我们试着理解PDF文件的概念。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="f554" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi md translated">这篇文章是寻找合适数据集的完整系列文章的一部分。以下是该系列中包含的所有文章:</p><p id="8cf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第1部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/getting-datasets-for-data-analysis-tasks-advanced-google-search-b1c01f9cc324">为数据分析任务获取数据集—高级谷歌搜索</a></p><p id="2a7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第2部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/useful-sites-for-finding-datasets-for-data-analysis-tasks-1edb8f26c34d">为数据分析任务寻找数据集的有用站点</a></p><p id="74da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第三部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/creating-custom-image-datasets-for-deep-learning-projects-6e5db76158d4">为深度学习项目创建定制图像数据集</a></p><p id="5fdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第4部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/import-html-tables-into-google-sheets-effortlessly-f471eae58ac9">毫不费力地将HTML表格导入Google Sheets</a></p><p id="b44d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第5部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/extracting-tabular-data-from-pdfs-made-easy-with-camelot-80c13967cc88">用Camelot从pdf中提取表格数据变得很容易。</a></p><p id="7bd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第六部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/extracting-information-from-xml-files-into-a-pandas-dataframe-11f32883ce45">从XML文件中提取信息到熊猫数据帧</a></p><p id="005f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">第7部分</strong> : <a class="ae ky" rel="noopener" target="_blank" href="/5-real-world-datasets-for-exploratory-data-analysis-21b7cc5afe7e"> 5个真实世界数据集，用于磨练您的探索性数据分析技能</a></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="1978" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">可移植文档格式，又名pdf</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/213f4acb1594b44f7f0498da2a8418af.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*jl_pfTJRLDE47Nocomb1XA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="http://Adobe Systems CMetalCore" rel="noopener ugc nofollow" target="_blank"> Adobe PDF文件图标</a></p></figure><p id="1bb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/PDF" rel="noopener ugc nofollow" target="_blank"> PDF </a>代表可移植文档格式。这是Adobe在90年代早期创建的一种文件格式。它基于<a class="ae ky" href="https://en.wikipedia.org/wiki/PostScript" rel="noopener ugc nofollow" target="_blank"> PostScript </a>语言，通常用于呈现和共享文档。开发PDF背后的想法是要有一种格式，使得在任何现代打印机上查看、显示和打印文档成为可能。</p><blockquote class="nf ng nh"><p id="6b01" class="kz la ni lb b lc ld ju le lf lg jx lh nj lj lk ll nk ln lo lp nl lr ls lt lu im bi translated">每个PDF文件都封装了一个固定布局平面文档的完整描述，包括文本、字体、矢量图形、光栅图像以及其他显示<em class="it"/><a class="ae ky" href="https://en.wikipedia.org/wiki/PDF" rel="noopener ugc nofollow" target="_blank"><em class="it">维基百科</em> </a> <em class="it">所需的信息。</em></p></blockquote><p id="eceb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本PDF文件包含以下元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/b043ee0f5f08491e5684527b6326ecb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*HAodlo_jM-Z_izisbClypQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://gendignoux.com/blog/2016/10/04/pdf-basics.html" rel="noopener ugc nofollow" target="_blank">来源:GUILLAUME ENDIGNOUX的PDF语法简介</a></p></figure><h2 id="3e72" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">为什么从PDF中提取表格很难？</h2><p id="c5c1" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">如果你看上面的PDF布局，你会发现其中没有表格的概念。PDF包含将字符放置在二维平面的x，y坐标上的指令，不保留单词、句子或表格的知识。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/2741f0d402bdd71b6d6dd6bf21c4277e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o4o2Dn00eDt86ahMFfbRHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://www.pdfscripting.com/public/PDF-Page-Coordinates.cfm" rel="noopener ugc nofollow" target="_blank">https://www . PDF scripting . com/public/PDF-Page-coordinates . cfm</a></p></figure><p id="f1c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么PDF如何区分单词和句子呢？通过将字符放在一起来模拟单词，而通过将单词放在相对更远的位置来模拟句子。下图将更具体地巩固这一概念:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/9b7aef47d6459e3800c4cbd8e496a0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*mstw7AqNe7ApQDf_Z0D-Dw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:http://www.unixuser.org/~euske/python/pdfminer/index.html</p></figure><p id="e5b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">m表示上图中两个字之间的距离，<strong class="lb iu"> W </strong>表示两个字之间的间距。任何带有空格的文本块被组合成一个。表格是通过在没有任何行或列信息的电子表格中输入单词来模拟的。因此，这使得从pdf中提取数据用于分析变得非常困难。然而，政府报告、文档等形式的大量公开数据。，以pdf格式发布。一种能够提取信息而不影响其质量的工具是当前需要的。这一点将我们带到了一个名为<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Camelot </strong> </a>的多功能库，它被创建来从pdf中提取表格信息。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2b98" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">卡米洛特:人类PDF表格提取</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/6d0960eb97871d5706e6be7b52ee9557.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/0*gSIk08XGJFMmhnMh.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank">https://camelot-py.readthedocs.io/en/master/</a></p></figure><p id="e433" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Camelot的名字来源于著名的<a class="ae ky" href="http://www.planetpdf.com/planetpdf/pdfs/warnock_camelot.pdf" rel="noopener ugc nofollow" target="_blank"> Camelot项目</a>，它是一个开源的Python库，可以帮助您轻松地从pdf中提取表格。它建立在另一个用于PDF文档的文本提取工具<a class="ae ky" href="https://pypi.org/project/pdfminer/" rel="noopener ugc nofollow" target="_blank"> pdfminer </a>之上。</p><p id="796d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它附带了许多有用的功能，例如:</p><ul class=""><li id="7a9c" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated"><strong class="lb iu">可配置性— </strong>适用于大多数情况，但也可以进行配置</li><li id="c804" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated"><strong class="lb iu">使用Matplotlib库进行可视化调试</strong></li><li id="fea6" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">输出有多种格式，包括CSV、JSON、Excel、HTML，甚至Pandas dataframe。</li><li id="e104" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">开源 -麻省理工学院许可</li><li id="afd1" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">详细的<strong class="lb iu">文档</strong></li></ul><h2 id="9741" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">装置</h2><p id="2052" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">您可以通过conda、pip或直接从源代码安装Camelot。如果您使用pip，不要忘记安装以下依赖项:<a class="ae ky" href="https://wiki.python.org/moin/TkInter" rel="noopener ugc nofollow" target="_blank"> Tkinter </a>和<a class="ae ky" href="https://www.ghostscript.com/" rel="noopener ugc nofollow" target="_blank"> Ghostscript </a>。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="a3f9" class="nn mn it ow b gy pa pb l pc pd">#conda (easiest way)<br/>$ conda install -c conda-forge camelot-py</span><span id="cb4b" class="nn mn it ow b gy pe pb l pc pd">#pip after <a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/install-deps.html#install-deps" rel="noopener ugc nofollow" target="_blank">installing the tk and ghostscript dependencies</a><br/>$ pip install "camelot-py[cv]"</span></pre><h2 id="adf7" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">工作</h2><p id="f6a7" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">在我们开始工作之前，最好先了解一下到底发生了什么。通常，Camelot使用两种解析方法来提取表:</p><ul class=""><li id="99ad" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated"><strong class="lb iu"> Stream </strong>:查找单词之间的空格来识别表格。</li><li id="9fcc" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated"><strong class="lb iu">点阵</strong>:寻找页面上的线条来识别表格<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/how-it-works.html" rel="noopener ugc nofollow" target="_blank">。默认使用</a> <a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/how-it-works.html#lattice" rel="noopener ugc nofollow" target="_blank">点阵</a>。</li></ul><p id="0b9f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/how-it-works.html" rel="noopener ugc nofollow" target="_blank">文档</a>中读到更多关于卡梅洛特的工作。</p><h2 id="bbef" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">使用</h2><p id="d3e3" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">现在让我们进入激动人心的部分——从pdf中提取表格。在这里，我使用了一个PDF文件，其中包含了印度2015-16年成人教育项目<strong class="lb iu">受益人数<a class="ae ky" href="https://www.mhrd.gov.in/sites/upload_files/mhrd/files/statistics-new/ESAG-2018.pdf" rel="noopener ugc nofollow" target="_blank">的信息。PDF看起来像这样:</a></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/d5d3bf02e958a6e6db6e73742e56d3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*MZLgLIa1VO1akuOTIORJcg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://www.mhrd.gov.in/sites/upload_files/mhrd/files/statistics-new/ESAG-2018.pdf" rel="noopener ugc nofollow" target="_blank">https://www . mhrd . gov . in/sites/upload _ files/mhrd/files/statistics-new/ESAG-2018 . pdf</a></p></figure><p id="8654" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将从导入库和读入PDF文件开始，如下所示:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="f49c" class="nn mn it ow b gy pa pb l pc pd">import camelot<br/>tables = camelot.read_pdf('schools.pdf')</span></pre><p id="7d22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到一个<code class="fe pg ph pi ow b">TableList</code>对象，这是一个由<code class="fe pg ph pi ow b"><a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/api.html#camelot.core.Table" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">Table</strong></a></code>对象组成的列表。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="4139" class="nn mn it ow b gy pa pb l pc pd">tables<br/>--------------<br/>&lt;TableList n=2&gt;</span></pre><p id="ba7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到已经检测到两个表，通过它的索引可以很容易地访问这两个表。让我们访问第二个表，即包含更多信息的表，并查看其形状:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="1bbd" class="nn mn it ow b gy pa pb l pc pd">tables[1] #indexing starts from 0</span><span id="7c5d" class="nn mn it ow b gy pe pb l pc pd">&lt;Table shape=(28, 4)&gt;</span></pre><p id="9522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打印解析报告，它是表的提取质量的指示:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="cadc" class="nn mn it ow b gy pa pb l pc pd">tables[1].parsing_report</span><span id="c7d7" class="nn mn it ow b gy pe pb l pc pd">{'accuracy': 100.0, 'whitespace': 44.64, 'order': 2, 'page': 1}</span></pre><p id="297c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它显示了高达100%的准确性，这意味着提取是完美的。我们也可以如下访问表格的数据框架:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="8b2e" class="nn mn it ow b gy pa pb l pc pd">tables[1].df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/018b1d4579fd306d2f6706c96a747c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*B6wxa1YkqwDQAb8lthCTYg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者将PDF提取到Dataframe |图像中</p></figure><p id="e64f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整个表格也可以提取为CSV文件，如下所示:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="2b5a" class="nn mn it ow b gy pa pb l pc pd">tables.export('table.csv')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/839647a456c2e5ddfb1224bdc4d7cc59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*myavyZcHx1JAmiVYdkmxLA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者导出为CSV |图像的PDF表格</p></figure><h2 id="cb51" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">可视化调试</h2><p id="3ef5" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">此外，您还可以根据指定的种类绘制PDF页面上的元素，如<code class="fe pg ph pi ow b">‘text’, ‘grid’, ‘contour’, ‘line’, ‘joint’</code>等。这些对于调试和使用不同的参数来获得最佳输出非常有用。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="f220" class="nn mn it ow b gy pa pb l pc pd">camelot.plot(tables[1],kind=&lt;specify the kind&gt;)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/3cefca39c5b2f416ab4d831d55d84bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7AHsXysK_frgY5P1MkGf0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在PDF页面上找到的绘图元素|作者图片</p></figure><h2 id="a1df" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">高级用法和CLI</h2><p id="f819" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">Camelot也有一个命令行界面<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/cli.html#cli" rel="noopener ugc nofollow" target="_blank">。它还配备了一系列高级功能，如:</a></p><ul class=""><li id="c4b4" class="oh oi it lb b lc ld lf lg li oj lm ok lq ol lu om on oo op bi translated">读取加密的pdf</li><li id="ab73" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">阅读旋转的pdf</li><li id="f1fe" class="oh oi it lb b lc oq lf or li os lm ot lq ou lu om on oo op bi translated">当默认结果不完美时调整参数。指定精确的表格边界，指定列分隔符，等等。你可以在这里阅读更多关于这些功能的信息<a class="ae ky" href="https://camelot-py.readthedocs.io/en/master/user/advanced.html#advanced" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><h2 id="26b3" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">缺点</h2><p id="518a" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">Camelot只能处理基于文本的pdf，不能处理扫描的文档。因此，如果你有扫描文件，你必须看看其他一些替代品。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="9e03" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">⚔️神剑——网络界面:蛋糕上的糖衣</h1><p id="c63d" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">Camelot的另一个有趣的特性是，它也有一个名为<strong class="lb iu"> Excalibur </strong>的web界面，供那些不想编码但仍想使用该库特性的人使用。让我们快速看看如何使用它。</p><h2 id="d5ec" class="nn mn it bd mo no np dn ms nq nr dp mw li ns nt my lm nu nv na lq nw nx nc ny bi translated">装置</h2><p id="ef73" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">安装<a class="ae ky" href="https://www.ghostscript.com/" rel="noopener ugc nofollow" target="_blank"> Ghostscript </a>后，使用pip安装Excalibur:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="9365" class="nn mn it ow b gy pa pb l pc pd">$ pip install excalibur-py </span></pre><p id="9a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后使用以下命令启动web服务器:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="58f5" class="nn mn it ow b gy pa pb l pc pd">$ excalibur webserver</span></pre><p id="611b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，您可以导航到本地主机来访问该界面。下面的视频演示了整个过程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pn l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excalibur演示|作者视频</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="0405" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">结论</h1><p id="be66" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">在上面的文章中，我们研究了Camelot——这是一个开源python库，对于从pdf中提取表格数据非常有帮助。事实上，它有许多可以调整的参数，这使得它具有很好的可伸缩性，并适用于许多情况。Web界面为寻找无代码环境的人们提供了一个极好的选择。总的来说，它似乎是一个有用的工具，可以帮助减少通常用于数据提取的时间。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6e26" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">参考</h1><p id="e1fd" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">这篇文章的灵感来自Vinayak  Mehta的<a class="ae ky" href="https://www.youtube.com/watch?v=m6xKhzp54-E" rel="noopener ugc nofollow" target="_blank">演讲，vinay AK</a>Mehta是2019 印度PyCon上卡米洛特项目的创建者和维护者。一些资源摘自活动结束后公开分享的幻灯片。强烈建议观看演示以获得更清晰的内容。</p></div></div>    
</body>
</html>