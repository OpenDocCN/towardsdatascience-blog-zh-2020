<html>
<head>
<title>Jupyter is Ready for Production; As Is</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jupyter准备生产；原样</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/jupyter-is-ready-for-production-as-is-b36f1d1ca8f8?source=collection_archive---------18-----------------------#2020-09-30">https://towardsdatascience.com/jupyter-is-ready-for-production-as-is-b36f1d1ca8f8?source=collection_archive---------18-----------------------#2020-09-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d172" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">无需编写一行代码，即可将您的笔记本草稿转化为生产就绪的Kubeflow管道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b66d98154acc72fe27279ca0ed23fbf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJHv6zb7Zo0fgQIMEoojpQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/16853182-16853182/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5263284" rel="noopener ugc nofollow" target="_blank"> 16853182 </a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=5263284" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="6dbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习项目通常由多个相互关联的步骤组成:数据采集、数据处理、数据建模、微调、测试等。这些步骤中的每一步都可以是一个独立的过程，以自己的节奏运行，具有明确定义的输入和输出。因此，数据科学家和ML工程师倾向于认为这些项目像管道。</p><blockquote class="lv"><p id="1391" class="lw lx it bd ly lz ma mb mc md me lu dk translated">数据科学家的理想场景是将Jupyter笔记本提供的实验环境转变为生产就绪的ML管道。</p></blockquote><p id="5a7b" class="pw-post-body-paragraph kz la it lb b lc mf ju le lf mg jx lh li mh lk ll lm mi lo lp lq mj ls lt lu im bi translated">然而，ML管道是一种很难编码的东西；连接到数据源，将正确的输入传递到每个步骤，序列化输出，检查点，找出依赖关系……<strong class="lb iu">如果我们能够自动化配置工作流执行所需的样板代码的苦差事，那不是很好吗？</strong></p><p id="40bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据科学家的理想场景是将Jupyter笔记本提供的实验环境转变为生产就绪的ML管道。嗯，我们今天就可以做。此外，我们无需编写任何代码就能做到这一点。</p><blockquote class="mk ml mm"><p id="4ede" class="kz la mn lb b lc ld ju le lf lg jx lh mo lj lk ll mp ln lo lp mq lr ls lt lu im bi translated"><a class="ae ky" href="https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter" rel="noopener ugc nofollow" target="_blank">学习率</a>是为那些对AI和MLOps的世界感到好奇的人准备的时事通讯。你会在每周五收到我关于最新人工智能新闻和文章的更新和想法。在这里订阅<a class="ae ky" href="https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter" rel="noopener ugc nofollow" target="_blank"/>！</p></blockquote></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="7383" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">KubeFlow简介</h1><p id="132d" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">Kubeflow是一个开源项目，致力于使ML项目的部署更加简单、可移植和可伸缩。来自<a class="ae ky" href="https://www.kubeflow.org/" rel="noopener ugc nofollow" target="_blank">文档</a>:</p><blockquote class="mk ml mm"><p id="db98" class="kz la mn lb b lc ld ju le lf lg jx lh mo lj lk ll mp ln lo lp mq lr ls lt lu im bi translated">Kubeflow项目致力于使在Kubernetes上部署机器学习(ML)工作流变得简单、可移植和可扩展。我们的目标不是重新创建其他服务，而是提供一种简单的方法来将ML的最佳开源系统部署到不同的基础设施上。无论你在哪里运行Kubernetes，你都应该能够运行Kubeflow。</p></blockquote><p id="bf40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是我们如何开始呢？我们需要Kubernetes集群吗？我们应该自己部署整个系统吗？我的意思是，你看过库伯弗洛的<a class="ae ky" href="https://github.com/kubeflow/manifests" rel="noopener ugc nofollow" target="_blank">清单回购</a>吗？</p><blockquote class="lv"><p id="336e" class="lw lx it bd ly lz ma mb mc md me lu dk translated">在Kubeflow上运行笔记本所需要的只是一个谷歌云平台(GCP)账户和你的旧笔记本文件！</p></blockquote><p id="74d5" class="pw-post-body-paragraph kz la it lb b lc mf ju le lf mg jx lh li mh lk ll lm mi lo lp lq mj ls lt lu im bi translated">此外，假设我们已经启动并运行了Kubeflow我们如何将我们的笔记本电脑转变为库巴流管道(KFP)？我们必须建立docker图像吗？你看过<a class="ae ky" href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.dsl.html" rel="noopener ugc nofollow" target="_blank"> KFP DSL </a>吗？我认为重点是消除样板代码。</p><p id="bd5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，我有好消息；我们所需要的只是一个谷歌云平台(GCP)账户和你的旧笔记本文件！</p><h2 id="1c7c" class="nz mz it bd na oa ob dn ne oc od dp ni li oe of nk lm og oh nm lq oi oj no ok bi translated">部署Kubeflow</h2><p id="ffa9" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">我将保持简单，不使它变得愚蠢。事实是，只需几分钟就可以轻松运行Kubeflow的单节点实例。我们需要的只是一个GCP帐户和从市场部署应用程序的能力。我们要用<a class="ae ky" href="https://www.kubeflow.org/docs/started/workstation/getting-started-minikf/" rel="noopener ugc nofollow" target="_blank"> MiniKF </a>！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6fc0286eb41774f2e9c853baa3cf30ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Es_e4P7yc4RgSgQh666plw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MiniKF部署—作者图片</p></figure><ol class=""><li id="c327" class="ol om it lb b lc ld lf lg li on lm oo lq op lu oq or os ot bi translated">去你的GCP <em class="mn">控制台</em></li><li id="fa06" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">搜索市场<em class="mn"> </em>然后找到<em class="mn"> MiniKF </em></li><li id="da8a" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">点击它并选择<em class="mn">启动</em></li><li id="3013" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">设置VM配置，(由于我的配额，我通常将数据磁盘更改为标准持久磁盘)并单击deploy。</li></ol><p id="2997" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！部署最多需要十分钟，您可以按照屏幕上的说明观看进度；ssh进入机器，在终端上运行<code class="fe nv nw nx ny b">minikf</code>,等待直到您准备好端点和凭证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/25c178fec497dcd408eec3f130a4efd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*CATFiBoMZFCY6fHEVjGZTg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MiniKF的提供已完成—图片由作者提供</p></figure><p id="16e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们准备访问Kubeflow仪表板。点击网址，输入你的凭证，你就可以开始了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/54f0dbb046cd9a85b6e300ed123ca77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zckzyLjYRnGzBejrE_6XsA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kubeflow仪表板—按作者分类的图像</p></figure><h2 id="592d" class="nz mz it bd na oa ob dn ne oc od dp ni li oe of nk lm og oh nm lq oi oj no ok bi translated">运行Jupyter服务器</h2><p id="7363" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">为了运行我们的实验，我们需要一个Jupyter笔记本实例。在Kubeflow中创建一个Jupyter笔记本相对容易。我们首先需要创建一个Jupyter服务器并连接到它。让我们这样做:</p><ol class=""><li id="6617" class="ol om it lb b lc ld lf lg li on lm oo lq op lu oq or os ot bi translated">从左侧面板中选择笔记本</li><li id="7be9" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">选择<code class="fe nv nw nx ny b">New Server</code>按钮</li><li id="afe7" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">填写服务器的名称，并请求您需要的CPU和RAM数量</li><li id="c788" class="ol om it lb b lc ou lf ov li ow lm ox lq oy lu oq or os ot bi translated">让Jupyter笔记本图像保持原样——这对本教程至关重要(<code class="fe nv nw nx ny b">jupyter-kale:v0.5.0-47-g2427cc9</code> —注意图像标签可能不同)</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a20691a51cd2f9d232da52862fe9035d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4B3x5IJ_do7aA3gGIMwbeA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建Jupyter服务器—作者图片</p></figure><p id="3d49" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完成这四个步骤后，等待笔记本服务器准备好并连接。你将被转移到你熟悉的JupyterLab工作区。</p><h1 id="5d6c" class="my mz it bd na nb pb nd ne nf pc nh ni jz pd ka nk kc pe kd nm kf pf kg no np bi translated">Jupyter到ML管道</h1><p id="30cb" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">那么，我们为什么要做这些设置呢？我们的目标是将我们的笔记本电脑转变为生产就绪的ML管道。我们如何做到这一点？</p><p id="67a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们将使用众所周知的<em class="mn">泰坦尼克号</em>数据集来演示一个我们可以遵循的简单工作流程。首先，在JupyterLab环境中创建一个新的终端，并克隆这个示例。</p><pre class="kj kk kl km gt pg ny ph pi aw pj bi"><span id="5194" class="nz mz it ny b gy pk pl l pm pn">git clone <a class="ae ky" href="https://github.com/dpoulopoulos/medium.git" rel="noopener ugc nofollow" target="_blank">https://github.com/dpoulopoulos/medium.git</a></span></pre><p id="c4e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您以前没有在JupyterLab中创建过终端，请注意JupyterLab终端提供了对系统shells(例如bash、tsch等)的全面支持。)和Windows上的PowerShell。您可以使用终端在系统shell中运行任何东西，包括vim或emacs之类的程序。所以你也可以用它来克隆来自<a class="ae ky" href="https://github.com/dpoulopoulos/medium" rel="noopener ugc nofollow" target="_blank"> GitHub </a>的任何回购。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/06b8accd4907807e518048e7280083c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*3UxPyf3968QGFXn3bwXNIw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在JupyterLab中克隆泰坦尼克号的例子——图片由作者提供</p></figure><p id="2b42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">克隆了回购之后，可以在<code class="fe nv nw nx ny b">medium &gt; minikf &gt; titanic.ipynb</code>中找到泰坦尼克的例子。您可以花一些时间浏览笔记本，但是有一个关键的步骤您需要首先运行:取消第一个代码单元的注释，并运行它以将必要的依赖项安装到您的环境中。</p><pre class="kj kk kl km gt pg ny ph pi aw pj bi"><span id="1e53" class="nz mz it ny b gy pk pl l pm pn">!pip install --user -r requirements.txt</span></pre><p id="13d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这个单元后，重启内核，就可以开始了。如果你检查笔记本的左面板，你会看到一个紫色的图标。这是有趣的开始…按下它来启用羽衣甘蓝扩展。你会自动看到每个单元格都被标注了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fdffa7fbc69692b5562248e4de95353b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ze_jlJJH8Rneo3Ukx5oIGw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">启用Kale扩展-按作者分类的图像</p></figure><p id="2441" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到笔记本是分节的；导入、数据加载部分、数据处理、模型训练和评估等。这正是我们用羽衣甘蓝注释的。现在，这个笔记本是预先注释好的，但是你可以随意使用。您可以创建新的管道步骤，但是不要忘记添加它们的依赖项。</p><p id="197b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在任何情况下，你都可以点击位于Kale部署面板底部的<code class="fe nv nw nx ny b">COMPILE AND RUN</code>按钮。无需编写一行代码，您的笔记本将被转换为Kubeflow管道，该管道将作为新实验的一部分执行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fda0361682f18c1e5feec9fcb6c59cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*kvEAfyqqwB4962bYsg415Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从Jupyter笔记本到Kubeflow管道——作者图片</p></figure><p id="6e12" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">按照Kale提供的链接观看跑步实验。几分钟后，管道将成功完成其任务。这是图表的最终视图(不要忘记切换左上角的<code class="fe nv nw nx ny b">Simplify Graph</code>选项):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/f7fd895ec11bc08cbe592a252b756c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cz4uareq_U4e-Sci3yL5wA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">泰坦尼克号管道——作者图片</p></figure><p id="330a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你！您刚刚将您的笔记本变成了一个管道，而没有编写一行代码，最重要的是，没有偏离常规程序。</p><h1 id="e084" class="my mz it bd na nb pb nd ne nf pc nh ni jz pd ka nk kc pe kd nm kf pf kg no np bi translated">结论</h1><p id="1a86" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">最后，您可以对这个数据集做更多的工作；可以多分析一下，添加交叉特征或者训练不同的分类器。事实上，在未来的故事中，我们将看到如何运行超参数调优，而无需添加任何额外的代码行。但是在数据集上实现最佳的准确性并不是本文的重点。</p><p id="2a8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到了如何在不编写任何样板代码的情况下启动单节点Kubeflow实例、创建笔记本服务器并将简单的Jupyter笔记本转换为Kubeflow管道。所以，去吧；实现自己的想法，一键变成ML管道！最后，不要忘记停止你的实例，以避免累积成本！</p><h2 id="fd35" class="nz mz it bd na oa ob dn ne oc od dp ni li oe of nk lm og oh nm lq oi oj no ok bi translated">关于作者</h2><p id="6a9f" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">我叫<a class="ae ky" href="https://www.linkedin.com/in/dpoulopoulos/" rel="noopener ugc nofollow" target="_blank">迪米特里斯·波罗普洛斯</a>，我是一名为<a class="ae ky" href="https://www.arrikto.com/" rel="noopener ugc nofollow" target="_blank">阿里克托</a>工作的机器学习工程师。我曾为欧洲委员会、欧盟统计局、国际货币基金组织、欧洲中央银行、经合组织和宜家等主要客户设计和实施人工智能和软件解决方案。</p><p id="054c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣阅读更多关于机器学习、深度学习、数据科学和数据运算的帖子，请在twitter上关注我的<a class="ae ky" href="https://medium.com/@dpoulopoulos" rel="noopener">媒体</a>、<a class="ae ky" href="https://www.linkedin.com/in/dpoulopoulos/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae ky" href="https://twitter.com/james2pl" rel="noopener ugc nofollow" target="_blank"> @james2pl </a>。</p><p id="dcab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所表达的观点仅代表我个人，并不代表我的雇主的观点或意见。</p></div></div>    
</body>
</html>