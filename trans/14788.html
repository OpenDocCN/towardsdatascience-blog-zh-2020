<html>
<head>
<title>Build your own Audiobook in 7 lines of Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用7行Python代码构建您自己的有声读物</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-own-audiobook-in-7-lines-of-python-code-bfd805fca4b1?source=collection_archive---------20-----------------------#2020-10-12">https://towardsdatascience.com/build-your-own-audiobook-in-7-lines-of-python-code-bfd805fca4b1?source=collection_archive---------20-----------------------#2020-10-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="41b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不买有声读物，用Python实现文本转语音有声读物</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b31da90b7c9f6f222d3beb1d670b7381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dOB6ihsXrKbm_0VtFfTHfA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3106986" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/sik-life-2171488/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=3106986" rel="noopener ugc nofollow" target="_blank"> Felix Lichtenfeld </a>拍摄</p></figure><p id="fd8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有声读物是大声朗读的一本书或其他作品的录音或画外音。可用的流行有声读物列表有:</p><ul class=""><li id="c2a3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="https://www.audible.com/" rel="noopener ugc nofollow" target="_blank">可听</a></li><li id="9bdb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://www.audiobooks.com/browse" rel="noopener ugc nofollow" target="_blank">有声读物</a></li><li id="d701" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://www.scribd.com/audiobooks" rel="noopener ugc nofollow" target="_blank"> Scribd </a></li></ul><p id="0d6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有一本pdf格式的有声读物，你就不需要订阅。在本文中，您将知道如何用7行python代码开发一个基本的有声读物。</p><h2 id="f45a" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">安装:</h2><p id="f7f8" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Python有大量服务于各种目的的库。在本文中，我们将需要两个库(<strong class="lb iu"> pyttsx3，PyPDF2 </strong>)来开发一本有声读物。</p><p id="a71f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以从PyPl安装这些库，</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="3c98" class="mj mk it ni b gy nm nn l no np"><strong class="ni iu">pip install PyPDF2<br/>pip install pyttsx3</strong></span></pre><p id="6efe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里阅读pyttsx3库<a class="ae ky" href="https://pyttsx3.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">的完整文档。</a></p><h1 id="d6b7" class="nq mk it bd ml nr ns nt mo nu nv nw mr jz nx ka mu kc ny kd mx kf nz kg na oa bi translated">1)阅读PDF文件:</h1><p id="a47f" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Python有库<strong class="lb iu"> PyPDF2 </strong>，它是作为PDF工具包构建的。它允许在内存中操作pdf。该库能够:</p><ul class=""><li id="59b0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">提取文档信息，如标题、作者等</li><li id="c464" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">按页面拆分文档</li><li id="37f1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">按页面合并文档</li><li id="e44f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">裁剪页面</li><li id="2f92" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将多页合并成一页</li><li id="ebd0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">加密和解密PDF文件</li><li id="0b33" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">还有更多！</li></ul><p id="0845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们正在使用这个库将pdf文件逐页拆分，读取每页上的文本，并将文本发送到下一层/步骤。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f47b" class="mj mk it ni b gy nm nn l no np">import PyPDF2<br/>pdfReader = PyPDF2.PdfFileReader(open('file.pdf', 'rb'))</span></pre><h1 id="481d" class="nq mk it bd ml nr ns nt mo nu nv nw mr jz nx ka mu kc ny kd mx kf nz kg na oa bi translated">2)初始化扬声器:</h1><p id="76b6" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">Python有一个pyttsx3库，能够离线转换文本到语音。我们使用pypdf2库从pdf文件中读取的文本作为文本到语音转换引擎的输入。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="04da" class="mj mk it ni b gy nm nn l no np">import pyttsx3<br/>speaker = pyttsx3.init()</span></pre><h1 id="af6c" class="nq mk it bd ml nr ns nt mo nu nv nw mr jz nx ka mu kc ny kd mx kf nz kg na oa bi translated">3)播放有声读物:</h1><p id="e73a" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">使用<strong class="lb iu"> PyPDF2 </strong>实现从pdf文件中逐页提取文本。通过阅读文本并将其提供给<strong class="lb iu"> pyttsx3 </strong>扬声器引擎，循环浏览每一页。它将从pdf页面中大声读出文本。</p><p id="0473" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">循环处理pdf文件中的每一页，最后停止pyttsx3扬声器引擎。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="78a6" class="mj mk it ni b gy nm nn l no np">for page_num in range(pdfReader.numPages):<br/>    text =  pdfReader.getPage(page_num).extractText()<br/>    speaker.say(text)<br/>    speaker.runAndWait()<br/>speaker.stop()</span></pre><h2 id="b058" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">全面实施:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ob oc l"/></div></figure></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><h1 id="dba4" class="nq mk it bd ml nr ok nt mo nu ol nw mr jz om ka mu kc on kd mx kf oo kg na oa bi translated">改变<strong class="ak"> pyttsx3 </strong>扬声器的声音、速率和音量:</h1><p id="b95c" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">你可以调整说话的速度和音量，并根据你的要求将配音从男声改为女声，反之亦然。</p><h2 id="c575" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">速率:</h2><p id="a96d" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">初始化pyttsx3库，使用<code class="fe op oq or ni b">getProperty(‘rate’)</code>获取当前的语速。使用<code class="fe op oq or ni b">setProperty(‘rate’, x)</code>改变说话速度，其中x=100为正常速度(1x)。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="55b7" class="mj mk it ni b gy nm nn l no np"># Initialize the speaker<br/>speaker = pyttsx3.init()</span><span id="5417" class="mj mk it ni b gy os nn l no np">rate = speaker.getProperty('rate')   <br/>print(rate)</span><span id="79b4" class="mj mk it ni b gy os nn l no np">speaker.setProperty('rate', 125)</span></pre><h2 id="5743" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">声音:</h2><p id="aab8" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">初始化pyttsx3库，使用<code class="fe op oq or ni b">getProperty(‘voice’)</code>获取当前说话者的性别。使用<code class="fe op oq or ni b">setProperty(‘voice’, voice[x].id)</code>改变说话者的性别，其中x=0表示男性，x=1表示女性。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a133" class="mj mk it ni b gy nm nn l no np">voices = speaker.getProperty('voices')<br/>print(voices)</span><span id="b8aa" class="mj mk it ni b gy os nn l no np">#changing index, changes voices, 0 for male<br/>speaker.setProperty('voice', voices[0].id)</span><span id="4bd7" class="mj mk it ni b gy os nn l no np">#changing index, changes voices, 1 for female<br/>speaker.setProperty('voice', voices[1].id)</span></pre><h2 id="9237" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">音量:</h2><p id="d3c6" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">初始化pyttsx3库，并使用<code class="fe op oq or ni b">getProperty(‘volume’)</code>获取当前卷。使用<code class="fe op oq or ni b">setProperty(‘volume’, x)</code>改变扬声器的音量。音量范围从0到1，其中0是最小音量，1是最大音量。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="e9c1" class="mj mk it ni b gy nm nn l no np">volume = engine.getProperty('volume')<br/>print(volume)</span><span id="9dcb" class="mj mk it ni b gy os nn l no np">engine.setProperty('volume',1.0)</span></pre><h2 id="82a0" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">将语音保存到音频文件:</h2><p id="62ef" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">使用以下方法将音频输出(有声读物)保存到mp3文件。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0237" class="mj mk it ni b gy nm nn l no np">engine.save_to_file(text, 'audio.mp3')<br/>engine.runAndWait()</span></pre></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><h1 id="ea58" class="nq mk it bd ml nr ok nt mo nu ol nw mr jz om ka mu kc on kd mx kf oo kg na oa bi translated">结论:</h1><p id="9b3c" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">在本文中，我们介绍了一个基本有声读物的实现，它可以使用几行python代码阅读整本pdf书籍。为了获得更好的音频效果，您还可以调整扬声器库的声音、速率和音量。</p><p id="fbad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有声读物的最终音频效果不是很好，因为文本在馈送到扬声器引擎之前需要一些预处理。</p><h1 id="f2ae" class="nq mk it bd ml nr ns nt mo nu nv nw mr jz nx ka mu kc ny kd mx kf nz kg na oa bi translated">参考资料:</h1><p id="4943" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">[1] PyPDF2文档:<a class="ae ky" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/PyPDF2/</a></p><p id="89f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] pyttsx3文档:<a class="ae ky" href="https://pyttsx3.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://pyttsx3.readthedocs.io/en/latest/</a></p><blockquote class="ot"><p id="a006" class="ou ov it bd ow ox oy oz pa pb pc lu dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>