<html>
<head>
<title>Anomaly Detection is in the Eye of the Beholder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">旁观者眼中的异常检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anomaly-detection-is-in-the-eye-of-the-beholder-9d2c6e9904ed?source=collection_archive---------40-----------------------#2020-10-16">https://towardsdatascience.com/anomaly-detection-is-in-the-eye-of-the-beholder-9d2c6e9904ed?source=collection_archive---------40-----------------------#2020-10-16</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="1d56" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">一副扑克牌揭示了如何检测异常值</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/f523103d0d6312219bff19a64a44f217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ieQO5_CeY_EwUQI0Elgq7g.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">作者图片</p></figure><p id="5ffd" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在网络安全中，异常检测的重点是发现可能被认为是网络攻击的异常事件。异常检测的承诺是，该算法将检测到以前从未见过的攻击。网络数据的一些问题是数据量太大，攻击数量很少，而且攻击每天都在演变。</p><p id="bb75" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">机器学习的许多入侵检测应用依赖于监督学习。监督机器学习擅长检测已知的攻击。通过适当的拟合，有监督的机器学习算法甚至能够发现一些新的攻击。但是，异常检测会在没有预定义攻击特征的情况下重新审视数据。</p><h2 id="84bb" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">异常是正常的</h2><p id="6527" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">在处理网络流量数据时，异常检测算法可能会发现真正异常的事件，但它们可能不是您想要的事件。大型计算机网络是有节奏的。他们有定期运行的流程。他们通常有相同的用户，每天做相同的事情。但网络数据远非规律。网络上发生的一些事件会中断正常的程序。存在由系统错误、缺陷或错误配置导致的操作事件。服务器上部署了一些系统更改，以添加软件功能和修补安全漏洞。有些新用户开始工作，有些人的工作发生了变化，他们发现自己肩负着新的责任。随着所有这些变化的发生，哪些事件是真正的异常呢？</p><p id="e99d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">用异常检测算法在不断变化的网络生态系统中检测网络攻击是非常具有挑战性的，因为异常可能与利用企图无关。虽然看似矛盾，但异常是正常的。</p><p id="308e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">重要的是要认识到，你发现的异常可能不是你实际寻找的异常。这适用于入侵检测以及许多其他领域的无监督学习。一个数据不一样，不代表它不好。在欺诈检测中，您可能会观察客户的购买模式，并在客户从未做生意的商店中发现不寻常的购买行为。这可能是欺诈行为，也可能只是客户决定做一些随机的、不同的或不正常的事情。这也是异常检测器误报率如此之高的原因之一。</p><blockquote class="mq"><p id="7a22" class="mr ms ir bd mt mu mv mw mx my mz lr dk translated">你发现的异常可能不是你实际寻找的异常。</p></blockquote><p id="6131" class="pw-post-body-paragraph kw kx ir ky b kz na js lb lc nb jv le lf nc lh li lj nd ll lm ln ne lp lq lr ik bi translated">不要气馁，回到监督学习。有一些方法可以改进对您真正想要找到的事件的检测。你如何用你的算法得到更好的结果？</p><h2 id="d23f" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">没有单一正确的集群方式</h2><p id="4f2e" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">异常检测类似于聚类问题。聚类也是无监督学习的一个例子。在聚类中，目标是将彼此最相似而与其他组中的项目最不相似的项目分组在一起。聚类的一个已知问题是没有一种算法可以成功地对所有数据进行聚类。聚类的挑战在于，这些组可能由于非常不同的原因而相似或不相似。聚类可以用密度函数或距离函数来衡量，但即使这样，数据中的一些分组也不容易找到。例如，如果没有专门的聚类算法，数据中的某些连续形状可能不会很好地聚类。</p><p id="fb8d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">这就是为什么埃斯蒂维尔-卡斯特罗宣称，“集群是在旁观者的眼中。”[1]他认为聚类是不同研究者如何描述一个聚类的数学定义。对于每一个归纳原则，有不同的聚类算法来满足研究者的意图。</p><h2 id="b776" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">一副牌揭示了什么</h2><p id="7dce" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">为了用您可能熟悉的数据集进行说明，请考虑一副扑克牌。一副标准的扑克牌有52张。每张卡都将是我们数据集中的一条记录。每张卡都有一组特征，例如花色、卡的面值和颜色。您知道每张卡都有一个Unicode值吗？我们也可以把它作为一个特性包括进来。大多数卡牌还会增加两张百搭牌。小丑牌有点反常，因为它没有花色或特定的颜色，但它有面值和Unicode值。</p><p id="d939" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">给定这副牌，如果让你把它们分成合理的组，你会如何组织它们？请记住，在聚类中，您的目标是选择分组，使每张卡片与其自己的聚类中的卡片最相似，而与其他聚类中的卡片最不相似。</p><p id="9f40" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">你可以按花色分组。你可以把所有的方块放在一起，所有的红心放在一起，所有的梅花放在一起，所有的黑桃放在一起。结果是每种花色有13张牌。那些小丑呢？他们有点反常，所以也许他们应该进入他们自己的群体。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nf"><img src="../Images/1bd8c139c20344cb32924f0d31060bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vthf5ol4gelAi0wChFRf_w.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">作者图片</p></figure><p id="616b" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">你可以按颜色将卡片分组，所有的红色卡片在一组，所有的黑色卡片在另一组。因此每组有26张牌，但是小丑显然是个例外，因为他们不属于任何一个颜色组。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ng"><img src="../Images/6b4c5c243af92d65b78b82848f1d3240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1EM-B4-9V7bEoZGNPn_Xg.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">作者图片</p></figure><p id="e33e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">最后，你可以按面值将卡片分组。您可以将所有的a放在一个组中，将所有的2放在另一个组中，依此类推。由于玩笑者在外表上彼此相似，你可以再次将他们归入他们自己的群中。在这种情况下，玩笑者可能看起来不是异常，因为他们有面值。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nh"><img src="../Images/1f7d4612b04eeb08138da40f56aa6f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ajJ8-cj-p6WiMkKptDKneg.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">作者图片</p></figure><p id="3da2" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">哪个集群解决方案是正确的？每一个都是正确的。这取决于你的目标和你解决问题的方式。如果你的目标是将卡片分成尽可能少的组，那么颜色似乎是最好的特征。如果你想分成尽可能多的组，那么按面值分组是最有意义的。</p><blockquote class="mq"><p id="0f44" class="mr ms ir bd mt mu mv mw mx my mz lr dk translated">您获得的解决方案取决于您用来对数据进行分组的功能。</p></blockquote><p id="73f9" class="pw-post-body-paragraph kw kx ir ky b kz na js lb lc nb jv le lf nc lh li lj nd ll lm ln ne lp lq lr ik bi translated">如果无监督的机器学习算法是神奇的，那就太好了。如果是，你可以给算法一组数据，不需要任何初始分析，就能得到正确的解。但是从扑克牌的例子中可以看出，您得到的解决方案取决于您用来对数据进行分组的特性。</p><p id="7cf4" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">对于这个讨论，同样重要的是考虑到一些分组清楚地揭示了玩笑者是异常的，而其他解决方案没有。从这个简单的例子可以清楚地看出，异常检测也是因人而异的。</p><h2 id="0b8b" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">特征选择</h2><p id="825b" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">将异常检测应用于入侵检测或任何其他应用程序时，最重要的步骤是选择最合适的功能。如果你想得到神奇的结果，你可以使用像bagging这样的方法来测试随机特性，但是不集中的特性选择可能不会给你真正想要的解决方案。相反，想想异常在您的网络和数据集的上下文中意味着什么。</p><p id="97b1" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">选择特征时，您可能会发现数据集中存在非常自然的特征。在扑克牌的例子中，颜色、花色和面值都很简单。但是如果基本特征无助于指出异常呢？</p><p id="edc0" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">也许您想看看一周中的某些天或一天中的某些小时有什么异常。从网络数据的日期特征中提取星期几和一天中的小时将允许算法发现一些异常活动。</p><p id="a8b2" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">也许你想看到一段时间内的模式。例如，在网络数据中，您可能希望找到用户以正常或异常模式登录到特定系统的模式。常规特征不提供这种上下文，因此您可能需要创建一个时间序列或从原始数据创建N元模型。</p><h2 id="5972" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">用用例定义异常</h2><p id="1006" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">但是如果你在寻找几种不同类型的异常呢？例如，如果您既想区分用户正常登录到不同的系统，又想检测用户在一天中不同时间登录的事件，该怎么办？也许您还对网络上系统之间的网络行为模式感兴趣。</p><p id="7374" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">一种解决方案是为您想要检测的每种异常创建用例。在网络安全中，这些通常被称为滥用案例，因为它们不是关于计算机系统应该如何工作，而是它们可能如何受到攻击。以下是您可能用于入侵检测的一些示例用例:</p><ul class=""><li id="124b" class="ni nj ir ky b kz la lc ld lf nk lj nl ln nm lr nn no np nq bi translated">用户在一天中不寻常的时间登录</li><li id="c0a5" class="ni nj ir ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">两台计算机系统之间异常的网络流量</li><li id="3377" class="ni nj ir ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">异常状态消息</li><li id="f1fd" class="ni nj ir ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">系统帐户登录到不寻常的计算机</li><li id="4feb" class="ni nj ir ky b kz nr lc ns lf nt lj nu ln nv lr nn no np nq bi translated">不规则的登录模式</li></ul><p id="9cb4" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">在您的用例被定义之后，您可以选择最有助于识别每个用例的异常的特性。然后，为每个用例分别运行异常检测算法，您可以关注您最感兴趣的异常。</p><p id="36fc" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">使用不同异常检测器的结果，每一个都基于不同的特性集，有一些方法或公式来组合用例的结果是有帮助的。例如，如果四个用例中的三个表明一个事件是异常的，那么它可能比一个只触发一个用例的事件得到更高的分数。</p><p id="6917" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">虽然合并结果有助于区分异常的优先级，但是展示每个用例的得分也是很好的。向最终用户呈现这些信息提供了一些可解释性。根据触发警报的用例，用户将理解为什么警报被视为异常。</p><p id="7e6e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">通过实验，您可能还会发现，您开始使用的一些用例是不值得的，只会制造噪音。在这些情况下，消除这些用例是有好处的，因为它们不会帮助找到您试图检测的异常。这将有助于降低你的假阳性率。</p><h2 id="fdac" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">结论</h2><p id="7052" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">使用机器学习的异常检测不是魔术。需要规划和分析来找到正确的方法并充分利用您的算法。</p><p id="9eee" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">由于异常检测是因人而异，因此定义您想要检测的异常类型非常重要。您可以通过缩小与目标异常最相关的特征来做到这一点。</p><p id="906a" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">用例有助于确保您能够检测到数据集中可能出现的各种类型的异常。使用为每个用例选择的不同特性集分别运行您的异常检测算法，可以产生非常有趣且可解释的结果。</p><p id="09f6" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">对于检测网络入侵，异常检测可以通过发现非网络攻击的异常事件来产生大量噪声。尝试使用这些方法来微调您的算法，并向响应结果的安全分析师提供更有意义的数据。</p><h2 id="23df" class="ls lt ir bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">参考</h2><p id="64f0" class="pw-post-body-paragraph kw kx ir ky b kz ml js lb lc mm jv le lf mn lh li lj mo ll lm ln mp lp lq lr ik bi translated">[1] V. Estivill-Castro，<a class="ae nw" href="https://doi.org/10.1145/568574.568575" rel="noopener ugc nofollow" target="_blank">为什么有这么多聚类算法:立场文件</a> (2002)，ACM SIGKDD探索时事通讯，4(1)</p></div></div>    
</body>
</html>