<html>
<head>
<title>Visualizing the White House COVID-19 Outbreak</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化白宫新冠肺炎疫情</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-the-white-house-covid-outbreak-f5e35b01ae26?source=collection_archive---------44-----------------------#2020-10-08">https://towardsdatascience.com/visualizing-the-white-house-covid-outbreak-f5e35b01ae26?source=collection_archive---------44-----------------------#2020-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/bd7dcec701fb3ca0d7279be6f70f7c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zI8hvVmdoJCrAosLRy8x3g.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="f63e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">新闻充斥着COVID在白宫行政部门的传播，所以让我们立即进入下图的代码和可视化。<a class="ae ld" href="https://www.kaggle.com/theogoe/white-house-covid-spread" rel="noopener ugc nofollow" target="_blank">数据集在此。</a> <a class="ae ld" href="https://github.com/theo-go/white_house_covid_outbreak.git" rel="noopener ugc nofollow" target="_blank">此处代码。</a></p><h2 id="ceeb" class="le lf it bd lg lh li dn lj lk ll dp lm kq ln lo lp ku lq lr ls ky lt lu lv lw bi translated"><strong class="ak">方法论</strong></h2><p id="20c4" class="pw-post-body-paragraph kf kg it kh b ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky mb la lb lc im bi translated">使用《纽约时报》的文章<a class="ae ld" href="https://www.nytimes.com/interactive/2020/10/02/us/politics/trump-contact-tracing-covid.html?action=click&amp;module=Spotlight&amp;pgtype=Homepage" rel="noopener ugc nofollow" target="_blank">追踪白宫冠状病毒爆发</a>，我们可以创建一个快速的excel表格，列出特朗普总统宣布COVID检测呈阳性之前与他在一起的所有人。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/ac4b05e60031b41f9f2a9884bce71999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dRrvbNywxsoqDzdDG2sFbQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><figure class="md me mf mg gt ju gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/26b2e3bcacc36a200639b39c016c7d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*-9fLAZgo1ziWILBRZe0Nlw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="99f9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最无聊的部分是，又多了一个数据集来匹配缩写名和全名。<a class="ae ld" href="https://www.kaggle.com/theogoe/white-house-covid-spread" rel="noopener ugc nofollow" target="_blank">数据集在这里</a>所以你可以跳过这个过程。</p><p id="0a59" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了创建可视化效果，我使用Python将events数据集转换成网络可视化格式的数据集，并使用Gephi来可视化网络。</p></div><div class="ab cl mi mj hx mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="im in io ip iq"><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/d1b76561aa861c007ac452c7da86c6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1CGwsnElfOPnmtX_dvEmw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><h2 id="be2b" class="le lf it bd lg lh li dn lj lk ll dp lm kq ln lo lp ku lq lr ls ky lt lu lv lw bi translated"><strong class="ak">关于网络可视化和Python的说明</strong></h2><p id="a4d2" class="pw-post-body-paragraph kf kg it kh b ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky mb la lb lc im bi translated">在我们开始为Gephi准备这些数据之前，我只想简单谈谈网络可视化数据集和Python的准备工作。网上很多教程提到<em class="mq">“网络可视化”</em>这几个字就会带进<a class="ae ld" href="https://networkx.github.io/" rel="noopener ugc nofollow" target="_blank"> NetworkX </a>。然而，我发现NetworkX对于很少或没有接触过网络分析的初学者来说是不直观的，尤其是与TidyText (R)之类的东西相比，它真的可以指导您完成网络分析+基于文档/文本的关系提取和分析。</p><p id="8022" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，如果您打算深入研究——在编写任何代码之前，先读一点资料，并尝试一下网络可视化。对你能运行的统计数据和你能创建的网络感兴趣。一个很棒的资源是<a class="ae ld" href="http://networkrepository.com/index.php" rel="noopener ugc nofollow" target="_blank">网络知识库</a>，它有一个<a class="ae ld" href="http://networkrepository.com/graphvis.php" rel="noopener ugc nofollow" target="_blank">交互式图形Vis页面</a>，可以立即将你吸引到你可以从一个网络中学到的奇妙的东西，而不仅仅是Twitter上谁关注谁的基础知识。</p><p id="6c41" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">当您准备好之后，请认真考虑如何创建您一直在尝试的网络数据集格式。对于小型网络，您可以用不到20行的代码编写必要的脚本，使用您已经熟悉的库和函数来准备数据集。</p><h2 id="a856" class="le lf it bd lg lh li dn lj lk ll dp lm kq ln lo lp ku lq lr ls ky lt lu lv lw bi translated">准备数据</h2><p id="0cdb" class="pw-post-body-paragraph kf kg it kh b ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky mb la lb lc im bi translated">使用pandas，导入数据集并使用ast.literal_eval将出席特朗普总统活动的人员列表的字符串表示转换为列表。</p><pre class="md me mf mg gt mr ms mt mu aw mv bi"><span id="a115" class="le lf it ms b gy mw mx l my mz">import pandas as pd<br/>import os<br/>from path import Path<br/>import ast <br/>import itertools</span><span id="924d" class="le lf it ms b gy na mx l my mz"># set directory to where this file is located<br/>folder_loc = os.path.dirname(os.path.realpath(__file__))<br/>os.chdir(Path(folder_loc))</span><span id="6119" class="le lf it ms b gy na mx l my mz">events_df = pd.read_excel('events.xlsx')<br/>ppl_df = pd.read_excel('ppl.xlsx')</span><span id="487b" class="le lf it ms b gy na mx l my mz">output_name = 'edges.csv'</span><span id="c3be" class="le lf it ms b gy na mx l my mz"># convert str list to list -- please excuse the following these<br/># apply(lambda x)'s.. this quick script isn't industrial strength in<br/># efficiency<br/>events_df['ppl'] = events_df['ppl'].apply(lambda x: ast.literal_eval(x))</span></pre><p id="879f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们的目标是创建两列:<strong class="kh iu"> Source </strong>和<strong class="kh iu"> Target </strong>，它们表示任何给定的两个人之间的联系，前提是他们都与Donald Trump参加了同一个活动。</p><p id="65dd" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，我们首先获得列表的所有可能组合，每个组合代表一个事件的参与者。然后，我们分解刚刚创建的元组列表，以创建<strong class="kh iu">源</strong>和<strong class="kh iu">目标</strong>列。</p><pre class="md me mf mg gt mr ms mt mu aw mv bi"><span id="c287" class="le lf it ms b gy mw mx l my mz"># new column of all combinations possible<br/># whats cool about itertools combos is that it doesn't do duplicates<br/># e.g. (DT, KM) (KM, DT)<br/>events_df['combos'] = events_df['ppl'].apply(<br/>    lambda x: list(itertools.combinations(x, 2)))</span><span id="dcb0" class="le lf it ms b gy na mx l my mz"># reshape dataframe with source target<br/>events_df_exploded = events_df.explode('combos')</span><span id="3d23" class="le lf it ms b gy na mx l my mz"># create source and target rows<br/>def src_targ(combo):<br/>    lst = list(combo)<br/>    return pd.Series([lst[0], lst[1]])</span><span id="da37" class="le lf it ms b gy na mx l my mz">events_df_exploded[['src', 'tar']<br/>                   ] = events_df_exploded['combos'].apply(src_targ)</span></pre><p id="fa15" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">接下来，我们用全名替换姓名缩写，清理我们的列，并为Gephi导出我们的csv文件。我还添加了代码来导出单个数据集，每天一个，以防对您自己的项目有所帮助。</p><pre class="md me mf mg gt mr ms mt mu aw mv bi"><span id="f1d2" class="le lf it ms b gy mw mx l my mz"># add in the real names of everyone<br/>events_df_exploded = pd.merge(events_df_exploded, ppl_df, how='left',<br/>                              left_on='src', right_on='abbrev')<br/>events_df_exploded = pd.merge(events_df_exploded, ppl_df, how='left',<br/>                              left_on='tar', right_on='abbrev')</span><span id="2906" class="le lf it ms b gy na mx l my mz"># clean up<br/>events_df_exploded.rename(columns={'name_x': 'Source',<br/>                                   'name_y': 'Target'},<br/>                          inplace=True)</span><span id="acff" class="le lf it ms b gy na mx l my mz">events_df_exploded = events_df_exploded.drop([<br/>    'ppl', 'combos', 'abbrev_x', 'abbrev_y', 'src', 'tar'],<br/>    axis=1)</span><span id="cf79" class="le lf it ms b gy na mx l my mz"># export file<br/>events_df_exploded.to_csv(output_name)</span><span id="ef8f" class="le lf it ms b gy na mx l my mz"># export batches by day<br/>df_grouped = events_df_exploded.groupby('date')</span><span id="5408" class="le lf it ms b gy na mx l my mz"># iterate and export<br/>for group_name, df_group in df_grouped:<br/>    print(group_name)<br/>    out_name = output_name.replace(<br/>        '.csv', '') + '_' + str(str(group_name).split(' ')[0]) + '.csv'<br/>    df_group.to_csv(out_name)</span></pre><h2 id="9ade" class="le lf it bd lg lh li dn lj lk ll dp lm kq ln lo lp ku lq lr ls ky lt lu lv lw bi translated">基于Gephi的网络可视化</h2><p id="97d3" class="pw-post-body-paragraph kf kg it kh b ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky mb la lb lc im bi translated">关于Gephi要知道的第一件事是，它对你导入的数据集的格式和列标题非常特别。虽然我已经很多年没有使用Gephi了，但我很高兴地看到今天网上有更多的文章和视频解释Gephi的怪癖。一定要在谷歌上搜索一下，看看Gephi的插件，寻找新的想法和未来的项目。</p><p id="c0ce" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">使用Data Laboratory屏幕将节点和边数据集导入Gephi后，使用概览屏幕左侧的外观选项卡中的参数，以及屏幕右侧和底部的过滤和布局。当您对可视化效果感到满意时，单击预览选项卡并导出您的图像。我用photopea把出口和标题放在一起。</p><h2 id="5bf8" class="le lf it bd lg lh li dn lj lk ll dp lm kq ln lo lp ku lq lr ls ky lt lu lv lw bi translated">就是这样！</h2><p id="7c65" class="pw-post-body-paragraph kf kg it kh b ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky mb la lb lc im bi translated">还有两件事。如果你或你的学生有热情，但不知道如何或何时，找一个安静的地方，用一支不起眼的笔(转述自保罗·西蒙)。实际上，尝试一下<a class="ae ld" href="https://www.smrfoundation.org/nodexl/" rel="noopener ugc nofollow" target="_blank"> NodeXL </a>吧——每份学生许可证39美元，在Twitter抓取、网络可视化(虽然很慢)和数据集准备(如果你愿意，可以将其导入Gephi)方面，它包含了一些非常强大的功能。对于非编码人员来说，这是一个轻松的好方法。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nb"><img src="../Images/33a151de5a3c95ae9aad7a78a66541f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bgU2st83KVDXK4chFjNyww.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="1ea3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">对于跟随本教程的每个人来说，这里有一些你可能想不到在Gephi上看的地方，它们对于创建视觉效果非常关键，而不需要在论坛上寻找答案。整个项目花了我大约2个小时，最大的时间消耗(除了开始输入excel表格)是记住东西在Gephi中的位置。所以，确保你对你想要想象的东西有一个清晰的画面(一直到调色板)，放上一些高保真的音乐来放松/学习，然后投入进去。</p><blockquote class="nc nd ne"><p id="a7f8" class="kf kg mq kh b ki kj kk kl km kn ko kp nf kr ks kt ng kv kw kx nh kz la lb lc im bi translated"><strong class="kh iu">关于我:</strong>Basil Labs的创始人，Basil Labs是一家大数据消费者智能初创公司，帮助组织量化消费者的去向和价值。</p><p id="448c" class="kf kg mq kh b ki kj kk kl km kn ko kp nf kr ks kt ng kv kw kx nh kz la lb lc im bi translated">热爱音乐，开放数据政策和数据科学。更多文章请关注我的<a class="ae ld" href="https://medium.com/@theo_goe" rel="noopener">媒体</a>。<br/>如果你对数据伦理、开放数据和/或音乐充满热情，欢迎在<a class="ae ld" href="https://twitter.com/theo_goe" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上加我。</p></blockquote></div></div>    
</body>
</html>