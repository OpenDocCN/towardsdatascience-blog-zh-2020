<html>
<head>
<title>How to Handle Missing Values in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中处理缺失值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-handle-missing-values-in-python-23407781b2b0?source=collection_archive---------34-----------------------#2020-10-08">https://towardsdatascience.com/how-to-handle-missing-values-in-python-23407781b2b0?source=collection_archive---------34-----------------------#2020-10-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="e23a" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">入门指南</h2><div class=""/><div class=""><h2 id="2431" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">缺失值插补的简明介绍</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/bb7ddf4095ba8bdb9b2a0834fad7a075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OBVFMB5U2OFShVOJ_AQVpA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">马库斯·温克勒在<a class="ae lh" href="https://unsplash.com/s/photos/delete?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="b462" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据科学家面临的最大挑战可能是一些听起来很平常，但对任何分析都非常重要的事情——清理脏数据。当您想到脏数据时，您可能会想到不准确或格式错误的数据。但事实是，缺失数据实际上是脏数据最常见的情况。想象一下，试图做一个客户细分分析，但50%的数据没有地址记录。这将很难或不可能做你的分析，因为分析会显示在某些地区没有客户的偏见。</p><h1 id="9b07" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">探索缺失的数据</h1><ul class=""><li id="3bee" class="mw mx it lk b ll my lo mz lr na lv nb lz nc md nd ne nf ng bi translated"><strong class="lk jd">有多少数据丢失了？</strong>您可以运行一个简单的探索性分析，看看您丢失数据的频率。如果百分比很小，比如说5%或更少，并且数据完全随机丢失，那么您可以考虑忽略并删除这些情况。但是请记住，如果可能的话，分析所有数据总是更好，丢弃数据会引入偏差。因此，最好检查一下分布情况，看看丢失的数据来自哪里。</li><li id="9d23" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md nd ne nf ng bi translated"><strong class="lk jd">分析数据是如何丢失的</strong> (MCAR，三月，四月)。我们将在下一节中发现不同类型的缺失数据。</li></ul><h1 id="880c" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">缺失数据的类型</h1><p id="b991" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">有三种缺失数据:</p><ul class=""><li id="4d2b" class="mw mx it lk b ll lm lo lp lr np lv nq lz nr md nd ne nf ng bi translated">数据完全随机丢失(MCAR)</li><li id="e4fd" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md nd ne nf ng bi translated">数据随机丢失(MAR)</li><li id="c824" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md nd ne nf ng bi translated">非随机数据丢失(MNAR)</li></ul><p id="d913" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将通过例子回顾缺失数据的类型，并分享如何用插补来处理缺失数据。</p><h2 id="1bea" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated">数据完全随机丢失(MCAR)</h2><p id="49b8" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">当我们说数据是随机缺失的时候，我们的意思是缺失与被研究的人无关。例如，一份问卷可能在邮寄过程中丢失，或者一份血样可能在实验室中被损坏。</p><p id="d395" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">数据完全随机缺失的统计优势是分析保持无偏，因为数据缺失不会使估计参数产生偏差。然而，很难证明这些数据是否确实是MCAR的。</p><h2 id="c053" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated">数据随机丢失(MAR)</h2><p id="3ddd" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">当我们说数据随机缺失时，我们假设<em class="od"> </em>一个数据点缺失的倾向与缺失数据本身无关，但与一些观察到的数据有关。换句话说，缺失值的概率取决于可观测数据的特征。例如，如果你的暗恋对象拒绝了你，你可以通过观察其他变量，比如“她已经做出承诺了”，或者“她的生活目标与你不同”等，来知道原因。</p><p id="697c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随机缺失相对容易处理——只需将所有影响缺失概率的变量作为回归输入。不幸的是，我们通常不能确定数据是否真的是随机缺失的，或者缺失是否取决于未观察到的预测值或缺失的数据本身。</p><h2 id="10af" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated"><strong class="ak">数据不是随机丢失</strong> (MNAR)</h2><p id="5d1e" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">当我们说数据不是随机丢失时，我们假设丢失的数据中有一种模式会影响您的主要因变量。例如，受教育程度最低的人错过了教育，病情最严重的人最有可能退出研究，或者吸毒者在调查中将药物使用字段留空。这也意味着这些丢失的值不是随机的，而是故意为空的。</p><p id="5200" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果数据不是随机丢失的，那么我们估算丢失的数据是没有意义的，因为它会使你的分析或模型的预测产生偏差。</p><h1 id="da42" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">诊断机制</h1><ol class=""><li id="2f94" class="mw mx it lk b ll my lo mz lr na lv nb lz nc md oe ne nf ng bi translated"><strong class="lk jd"> MAR vs. MNAR </strong>:区分MNAR和MAR的唯一真实方法是测量一些缺失的数据。我们可以比较受访者的答案和非受访者的答案。如果有很大的差异，这是数据是MNAR的好证据。另外，调查问题越敏感，人们回答的可能性越小。</li><li id="74cc" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><strong class="lk jd"> MCAR vs .马尔</strong>:一种技术是创建虚拟变量，判断某个变量是否缺失。然后，在该变量和数据集中的其他变量之间运行t检验和卡方检验，以查看该变量的缺失是否与其他变量的值相关。例如，如果女性真的比男性更不愿意告诉你她们的体重，卡方检验会告诉你女性的体重变量缺失数据的百分比高于男性。那么我们可以断定重量是有标记</li></ol><h1 id="fab4" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">数据插补方法</h1><h2 id="eb03" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated">简单插补</h2><p id="9d34" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">用列中的平均值、中值或众数替换缺失值是一种非常基本的插补方法。这种方法速度最快，但对编码的分类要素效果不佳。此外，它没有考虑特征之间的相关性。如果我们必须使用这种简单的插补方法，考虑使用中间值而不是平均值，因为平均值会给分析带来异常值或噪声。</p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="50e2" class="ns mf it og b gy ok ol l om on">from sklearn.preprocessing import Imputer</span><span id="eb46" class="ns mf it og b gy oo ol l om on">imputer = Imputer(missing_values='NaN', strategy='median')<br/>transformed_values = imputer.fit_transform(data.values)</span><span id="7c7b" class="ns mf it og b gy oo ol l om on"># notice that imputation strategy can be changed to "mean", “most_frequent”, 'constant'<br/># read the documentation here: <a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html</a></span></pre><h2 id="41db" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated">KNN插补</h2><p id="d46d" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">KNNImputer通过使用欧几里德距离矩阵查找k个最近邻来帮助估算观测值中存在的缺失值。你可以在这里查看KNNImputer是如何工作的。这种方法比简单的插补更准确；然而，它可能计算量很大，并且对异常值很敏感。</p><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="3c18" class="ns mf it og b gy ok ol l om on">import numpy as np<br/>from sklearn.impute import KNNImputer<br/><br/>imputer = KNNImputer(n_neighbors=2) #define the k nearest neighbors   <br/>imputer.fit_transform(data)</span><span id="c826" class="ns mf it og b gy oo ol l om on"># read the documentation here: <a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html</a></span></pre><h2 id="86f7" class="ns mf it bd mg nt nu dn mk nv nw dp mo lr nx ny mq lv nz oa ms lz ob oc mu iz bi translated">多元插补</h2><p id="f52c" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">多元插补通过考虑数据中的其他变量来解决噪音增加的问题。链式方程的基本多重插补(MICE)假设数据随机缺失。我们可以通过查看其他数据样本，对其真实价值做出有根据的猜测。</p><p id="1789" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">以下是三个主要步骤:</p><ol class=""><li id="14d1" class="mw mx it lk b ll lm lo lp lr np lv nq lz nr md oe ne nf ng bi translated">使用带有随机成分的插补流程为缺失值创建<em class="od"> m </em>组插补。</li><li id="e81c" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated">分析每个完整的数据集。每组参数估计值都会略有不同，因为数据略有不同。</li><li id="cbd7" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated">将<em class="od"> m </em>个分析结果整合成最终结果。</li></ol><p id="ff35" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你有兴趣了解它是如何工作的，请看这个视频<a class="ae lh" href="https://www.youtube.com/watch?v=WPiYOS3qK70" rel="noopener ugc nofollow" target="_blank">这里</a>。请注意，当我们对测量因缺失值导致的不确定性不感兴趣时，单变量与多变量插补在预测和分类中的有用性仍是一个未解决的问题。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/3ab482703c8138f67f7901e697c17b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kUXe_Di7lempRG-fCZMBmA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片作者<a class="ae lh" href="https://stefvanbuuren.name/publication/2011-01-01_vanbuuren2011a/" rel="noopener ugc nofollow" target="_blank"> stefvanbuuren </a></p></figure><pre class="ks kt ku kv gt of og oh oi aw oj bi"><span id="be4b" class="ns mf it og b gy ok ol l om on">import numpy as np<br/>from sklearn.experimental import enable_iterative_imputer<br/>from sklearn.impute import IterativeImputer<br/>imp = IterativeImputer(max_iter=10, random_state=0)<br/>imp.fit(X_train)<br/>imp.transform(X_test)</span><span id="c099" class="ns mf it og b gy oo ol l om on"># read the documentation here: <a class="ae lh" href="https://scikit-learn.org/stable/modules/impute.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/impute.html</a></span></pre><h1 id="5994" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated"><strong class="ak">结论</strong></h1><p id="9c16" class="pw-post-body-paragraph li lj it lk b ll my kd ln lo mz kg lq lr nm lt lu lv nn lx ly lz no mb mc md im bi translated">任何分析都不能忽略缺失数据。作为数据科学家或数据分析师，我们不能简单地丢弃缺失的值。我们需要了解数据是如何丢失的，并相应地处理NaN值。</p><h1 id="3e9a" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">参考</h1><ol class=""><li id="ff01" class="mw mx it lk b ll my lo mz lr na lv nb lz nc md oe ne nf ng bi translated"><a class="ae lh" href="https://www.statisticssolutions.com/missing-values-in-data/" rel="noopener ugc nofollow" target="_blank">https://www.statisticssolutions.com/missing-values-in-data/</a></li><li id="f4be" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><a class="ae lh" href="https://measuringu.com/handle-missing-data/" rel="noopener ugc nofollow" target="_blank">https://measuringu.com/handle-missing-data/</a></li><li id="bd73" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><a class="ae lh" href="https://www.theanalysisfactor.com/missing-data-mechanism/" rel="noopener ugc nofollow" target="_blank">https://www.theanalysisfactor.com/missing-data-mechanism/</a></li><li id="ff72" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><a class="ae lh" href="https://www.analyticsvidhya.com/blog/2020/07/knnimputer-a-robust-way-to-impute-missing-values-using-scikit-learn/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2020/07/knnimputer-a-robust-way-to-imput-missing-values-using-scikit-learn/</a></li><li id="2667" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/impute.html" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/modules/impute.html</a></li><li id="dd32" class="mw mx it lk b ll nh lo ni lr nj lv nk lz nl md oe ne nf ng bi translated"><a class="ae lh" href="https://www4.stat.ncsu.edu/~post/suchit/bayesian-methods-incomplete.pdf" rel="noopener ugc nofollow" target="_blank">https://www4 . stat . ncsu . edu/~ post/suchit/Bayesian-methods-completed . pdf</a></li></ol></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="b724" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果你觉得这很有帮助，请关注我，看看我在❤️的其他博客</p><p id="deb3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下次见，快乐学习！<a class="ae lh" href="https://emojipedia.org/woman-technologist-light-skin-tone/" rel="noopener ugc nofollow" target="_blank">👩🏻‍💻</a></p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/understanding-and-choosing-the-right-probability-distributions-with-examples-5051b59b5211"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jd gy z fp pf fr fs pg fu fw jc bi translated">用例子理解和选择正确的概率分布</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">举例说明最常见的离散概率分布</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po lb pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/how-to-prepare-for-business-case-interview-as-an-analyst-6e9d68ce2fd8"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jd gy z fp pf fr fs pg fu fw jc bi translated">作为分析师如何准备商业案例面试？</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">作为数据分析师或数据科学家，我们不仅需要知道概率和统计，机器学习算法…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po lb pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/@kessiezhang/building-a-product-recommendation-system-for-e-commerce-part-i-web-scraping-798b6251ab51" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jd gy z fp pf fr fs pg fu fw jc bi translated">为电子商务建立一个产品推荐系统:第一部分——网络搜集</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">今天，如果我们想到机器学习在商业中最成功和最广泛的应用，推荐者…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pq l pl pm pn pj po lb pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/how-to-convert-jupyter-notebooks-into-pdf-5accaef3758"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd jd gy z fp pf fr fs pg fu fw jc bi translated">如何将Jupyter笔记本转换成PDF</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">用几行代码将Jupyter笔记本转换为pdf(调试“500:内部服务器错误”)</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pr l pl pm pn pj po lb pa"/></div></div></a></div></div></div>    
</body>
</html>