<html>
<head>
<title>Two Step Facial Recognition With Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Colab的两步面部识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-step-facial-recognition-with-colab-883a54faafad?source=collection_archive---------28-----------------------#2020-10-19">https://towardsdatascience.com/two-step-facial-recognition-with-colab-883a54faafad?source=collection_archive---------28-----------------------#2020-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="587b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">上传你的图片，并说服自己使用谷歌Colab</h2></div><p id="4bfe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是周一的早晨，我正在引导我内心的杰瑞米·霍华德(<a class="ae lb" href="https://en.wikipedia.org/wiki/Jeremy_Howard_(entrepreneur)" rel="noopener ugc nofollow" target="_blank">又一次</a>)。在过去的几个月里，我看到了大量的面部识别指南，其中一些确实非常好。</p><p id="8f8c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">问题是，每个深度学习或机器视觉的学生都通过不同的途径变得感兴趣。也许你是一个对声音感兴趣的音乐家，或者是一个对表格数据感兴趣的统计学学生。</p><p id="0f10" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我知道当我开始阅读TensorFlow和图像分类时，我个人变得很感兴趣——这种想法是，如果我有一个<strong class="kh ir">精心策划的</strong>数据集，我可能能够训练一个架构来以高精度对图像进行分类。</p><p id="bbf9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Google Colab那时还不存在，我最近把类似的东西移植到了Colab上，我正在进行一次演练。点击此处查看第1部分:</p><div class="lc ld gp gr le lf"><a rel="noopener follow" target="_blank" href="/end-to-end-adaptation-of-resnet-in-google-colab-part-1-5e56fce934a6"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">Google Colab中ResNet的端到端改编—第1部分</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">只需点击几下鼠标，就能训练出一个深度神经网络</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">towardsdatascience.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt lu lf"/></div></div></a></div><p id="ec98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我最初的尝试是在我的iMac上使用Anaconda、Spyder完成的，没有使用GPU，只是让我的Core i5在数千张图像中跋涉，而我离开去做其他事情(阅读:为急救医学委员会学习)。当然，在我开始训练之前，我必须通读二十多篇使用不同风格编写代码的人的文章。结果是<strong class="kh ir">，一个代码</strong>的嵌合大杂烩，当我几周后看它的时候很难理解。</p><p id="0632" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后Colab进入了这个场景，虽然我仍然在我的机器上使用Jupyter和Spyder，但我使用Colab与您交流并有效地共享我的代码。它并不完美，但他们在让大众获得高端计算方面做得很好，你所需要的只是一个谷歌账户。</p><p id="5a73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">闲话少说。让我们浏览一下笔记本:</p><h2 id="cc8a" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated"><a class="ae lb" href="https://drive.google.com/file/d/10HRlLZR3q6ncEmYbEFmn2lEUQqaQXY5L/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> Colab笔记本</strong> </a></h2><h1 id="273b" class="mo lw iq bd lx mp mq mr ma ms mt mu md jw mv jx mg jz mw ka mj kc mx kd mm my bi translated">代表性图像</h1><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi mz"><img src="../Images/9d476835fca321f4d2b209db32f8e786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dlFvcLnAcMcYbXRFEFChQ.jpeg"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">来源:<a class="ae lb" href="https://unsplash.com/photos/1qfy-jDc_jo" rel="noopener ugc nofollow" target="_blank">Unsplash.com</a></p></figure><h1 id="9f9a" class="mo lw iq bd lx mp mq mr ma ms mt mu md jw mv jx mg jz mw ka mj kc mx kd mm my bi translated">两步面部识别</h1><p id="ba69" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">我在这里有点开玩笑——这两个步骤是“全部运行”和上传你的面部照片。</p><p id="f2cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">笔记本被设计成隐藏大部分代码，这样你就可以清楚地看到结果。首先看看输出，让自己相信我们不仅可以挑出(希望是大多数)照片中的人脸，然后使用情绪检测器功能分配一种情绪。</p><p id="4587" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我还留了一些代码来尝试计算过程的时间。</p><h2 id="55a0" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated">面部识别库</h2><figure class="na nb nc nd gt ne"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0e77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个使用了“人脸识别”库，在这里找到的<a class="ae lb" href="https://pypi.org/project/face-recognition/" rel="noopener ugc nofollow" target="_blank"/>。我们也会计算这需要多长时间。</p><p id="ac8b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这条生产线承担了所有繁重的工作:</p><pre class="na nb nc nd gt nv nw nx ny aw nz bi"><span id="bdce" class="lv lw iq nw b gy oa ob l oc od">face_locations = face_recognition.face_locations(image)</span></pre><p id="4163" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码的其余部分使用for循环遍历面数，并使用以下两条线在面周围画一个框:</p><pre class="na nb nc nd gt nv nw nx ny aw nz bi"><span id="38cf" class="lv lw iq nw b gy oa ob l oc od">rect = patches.Rectangle((left,top), (right - left),<br/>     (bottom-top),linewidth=3,edgecolor='r',facecolor='none')<br/>ax.add_patch(rect)</span></pre><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oe"><img src="../Images/fa7ed63c83cc04e440bf47bbf6490712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsV0aAwApCpcnmz9Jzv1cQ.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">作者图片</p></figure><p id="21d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="of">注意:并不是所有的人脸都被检测到；帽子和太阳镜会干扰检测。</em></p><p id="f63a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">检测到的人脸数量:24 </strong></p><p id="aa71" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">耗时:2.43秒</strong></p><h2 id="cf0a" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated">加入情感检测</h2><p id="64ce" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">除了一行(如果在第11行阻塞)之外，代码几乎与上面的相同:</p><figure class="na nb nc nd gt ne"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e9fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们将在下图中看到的那样，出现“if”语句是有原因的。“检测情绪”这条线并不适用于所有的脸。</p><p id="09e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果如下:</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oe"><img src="../Images/f54244186e89be381cf3715743688804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qflyxVkaVDVS0zBAXIHL9Q.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">作者图片</p></figure><p id="f0c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="of">注:情绪检测大多管用。并不是所有的脸都会表现出一种情绪，它认为婴儿生气了。我会让你仔细看看，看你是否觉得标签完全匹配——我不认为它们完全匹配。</em></p><p id="573e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">检测到的人脸数量:24个</strong></p><p id="2fa8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">耗时:2.83秒</strong>(稍长以添加情绪检测)</p><h2 id="1673" class="lv lw iq bd lx ly lz dn ma mb mc dp md ko me mf mg ks mh mi mj kw mk ml mm mn bi translated">使用开放式CV的哈尔叶栅</h2><p id="0265" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">基于Haar级联的识别是进行面部识别的另一种方式。关于这些工作的讨论超出了本文的范围。网上有很多讨论这种方法的技术资源。</p><figure class="na nb nc nd gt ne"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="4cd8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果如下:</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi mz"><img src="../Images/51585fc1b7bf1aa4b9b9031e49cd4ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4RKUbGaYvMjWmJ_TndqEA.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">作者图片</p></figure><p id="4c22" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">再次，使用哈尔级联是另一种方法，这里也有一些失误。特别是，它错过了一些脸，并认为裤腿，脚踝，鞋面的组合是一张脸。</p><p id="2612" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在我运行的每次迭代中，使用Haar cascades和OpenCV比使用face_recognition库要快得多——有时几乎快20%—30%。这种速度优势非常显著，尤其是在浏览数百张图像(例如视频)时。它还涉及一种计算成本较低的过程，并且可能运行在需要较少功率的较便宜的硬件上。</p><p id="34c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，这不是仅有的两种面部检测方法，专有的方法可能更好。如果你必须在两者之间选择，我不认为有明确的答案——一个更擅长检测(人脸识别)，但另一个更快(哈尔瀑布)。</p><p id="23ab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">检测到的人脸数量:24个</strong></p><p id="2b1c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">耗时:1.95秒</strong>(更快)</p><h1 id="5cd4" class="mo lw iq bd lx mp mq mr ma ms mt mu md jw mv jx mg jz mw ka mj kc mx kd mm my bi translated">参考</h1><p id="cd49" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">[1] <a class="ae lb" href="https://en.wikipedia.org/wiki/Jeremy_Howard_(entrepreneur)" rel="noopener ugc nofollow" target="_blank">维基百科-杰瑞米·霍华德</a>，2020年10月访问</p><p id="148e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[2] <a class="ae lb" href="https://pypi.org/project/face-recognition/" rel="noopener ugc nofollow" target="_blank">面部识别库</a>，PyPi，2020年10月访问</p><p id="c885" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[3] <a class="ae lb" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_objdetect/py_face_detection/py_face_detection.html" rel="noopener ugc nofollow" target="_blank">打开CV哈尔叶栅</a>，2020年10月进入</p></div></div>    
</body>
</html>