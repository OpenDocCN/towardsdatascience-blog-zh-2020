<html>
<head>
<title>Create an interactive COVID-19 report using R, host it for free and automate its update</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R创建一个交互式的新冠肺炎报告，免费托管并自动更新</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-an-interactive-covid-19-report-using-r-host-it-for-free-and-automate-its-update-41a5bdd46e9d?source=collection_archive---------44-----------------------#2020-11-07">https://towardsdatascience.com/create-an-interactive-covid-19-report-using-r-host-it-for-free-and-automate-its-update-41a5bdd46e9d?source=collection_archive---------44-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9471" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">引人入胜的可视化，闪亮的用户界面和GitHub操作，创造完美的报告！</h2></div><p id="d1a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">本帖是</em> <strong class="kh ir"> <em class="lb">第一部分</em> </strong> <em class="lb">一系列</em> <strong class="kh ir"> <em class="lb"> 4期刊物</em> </strong> <em class="lb">。请参考</em> <strong class="kh ir"> <em class="lb">第1部分</em> </strong> <em class="lb">了解系列概述，</em> <a class="ae lc" href="https://rpubs.com/lucha6/covid-cleaning-owid-data" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="lb">第2部分</em> </strong> </a> <em class="lb">了解数据源和次要数据清理，</em> <a class="ae lc" rel="noopener" target="_blank" href="/interactive-covid19-report-with-rmarkdown-plotly-leaflet-and-shiny-c6a716af7d9b"> <strong class="kh ir"> <em class="lb">第3部分</em> </strong> </a> <em class="lb">了解可视化的创建，构建报告以及将文档部署到ShinyApps.io和</em><em class="lb"/> <a class="ae lc" href="https://github.com/lc5415/COVID19" rel="noopener ugc nofollow" target="_blank">【项目回购】</a></p><p id="2274" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">每篇文章都是独立的，</strong>意思是你真的不需要阅读其他部分来充分利用它。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/9cc0ef243932cd58c4a2dd219d2aa274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*z3iADQJrUR6kHD7sg3dbUg.gif"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">交互式报告的导航</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="b168" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自2020年3月以来，所有新闻媒体和政府机构一直在用新冠肺炎的统计数据和图表轰炸民众。<a class="ae lc" href="https://medium.com/@tomaspueyo/coronavirus-act-today-or-people-will-die-f4d3d9cd99ca" rel="noopener">这篇由<a class="ma mb ep" href="https://medium.com/u/a361390dbcf1?source=post_page-----41a5bdd46e9d--------------------------------" rel="noopener" target="_blank"> Tomas Pueyo </a>撰写的中型文章</a>于3月初发表，是首批深度探索COVID数据的文章之一，揭示了许多见解，并在短短几天内获得了数千万次浏览。美国约翰·霍普斯金大学也提供了一个<a class="ae lc" href="https://coronavirus.jhu.edu/map.html" rel="noopener ugc nofollow" target="_blank">非常有用的仪表板</a>以及<a class="ae lc" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank">他们的数据</a>每天更新。他们的数据结合了多个来源，如世卫组织、美国疾病传播中心(CDC)和欧盟CDC等。</p><p id="6c03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">早期，互联网上充斥着大量来自大学的报告。我意识到我无法制作世界级的仪表板或报告，但至少我想制作自己的仪表板或报告，并学习如何制作。</p><h1 id="3954" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">目录</h1><p id="4da0" class="pw-post-body-paragraph kf kg iq kh b ki mu jr kk kl mv ju kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated"><a class="ae lc" href="#ac4b" rel="noopener ugc nofollow">导语</a> <br/> <a class="ae lc" href="#f448" rel="noopener ugc nofollow"> ggplot，Plotly and Shiny </a> <br/> <a class="ae lc" href="#4bcf" rel="noopener ugc nofollow">数据来源</a> <br/> <a class="ae lc" href="#c138" rel="noopener ugc nofollow">计划</a> <br/> <a class="ae lc" href="#a84e" rel="noopener ugc nofollow">后会有期！</a></p><h1 id="ac4b" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">戏弄者</h1><p id="1ac6" class="pw-post-body-paragraph kf kg iq kh b ki mu jr kk kl mv ju kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">在我们开始之前，我想让你看看最终产品会是什么样子。我们将最终得到一个交互式的基于云的HTML报告(有一个闪亮的后端),显示不同的COVID19相关图。您可以通过以下链接与最终报告互动→<a class="ae lc" href="https://lucha6.shinyapps.io/covideda/" rel="noopener ugc nofollow" target="_blank">https://lucha6.shinyapps.io/covideda/</a></p><p id="e0bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将制作以下(互动)情节，并将它们烘焙成一个漂亮的互动RMarkdown文档，每天更新，无需我们做任何额外的工作。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mz na l"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">按国家、洲和全球COVID显示死亡人数的树形图</p></figure><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mz na l"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">显示一段时间内各大洲累计病例数的折线图</p></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nb"><img src="../Images/f6f365c3dedbbb9dab93610bdf1aeec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QjNUqEugRfqYyGdlL7MAOw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">样本R(闪亮)代码和显示单张地图的输出，其中国家由确诊病例数着色</p></figure><h1 id="f448" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated"><code class="fe nc nd ne nf b">ggplot</code>、神秘而闪亮</h1><p id="8404" class="pw-post-body-paragraph kf kg iq kh b ki mu jr kk kl mv ju kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">在我看来是最好的绘图库。这个库基于Leland Wilkinson的Grammar of Graphics(GoG),作为一个R包来实现和发布。我推荐阅读<a class="ae lc" href="https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf" rel="noopener ugc nofollow" target="_blank">原文</a> <code class="fe nc nd ne nf b"><a class="ae lc" href="https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf" rel="noopener ugc nofollow" target="_blank">ggplot</a></code> <a class="ae lc" href="https://byrneslab.net/classes/biol607/readings/wickham_layered-grammar.pdf" rel="noopener ugc nofollow" target="_blank"> 2010年论文</a>由全能的<a class="ma mb ep" href="https://medium.com/u/2f166aac6770?source=post_page-----41a5bdd46e9d--------------------------------" rel="noopener" target="_blank"> Hadley Wickham </a>关于<code class="fe nc nd ne nf b">ggplot</code>的第一次实现和<a class="ae lc" rel="noopener" target="_blank" href="/a-comprehensive-guide-to-the-grammar-of-graphics-for-effective-visualization-of-multi-dimensional-1f92b4ed4149">由</a><a class="ma mb ep" href="https://medium.com/u/6278d12b0682?source=post_page-----41a5bdd46e9d--------------------------------" rel="noopener" target="_blank"> Dipanjan (DJ) Sarkar </a>关于GoG 背后理论的全面而简明的指南。</p><p id="47b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Plotly是一个很棒的跨语言库(最初是用JavaScript编写的),允许制作交互式图形。在R语言中，也就是我们今天要用的语言，他们有一个叫做<code class="fe nc nd ne nf b">ggplotly()</code>的函数，可以让你把任何<code class="fe nc nd ne nf b">ggplot</code>的情节变成一个没有开销的情节。</p><p id="da03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lc" href="https://shiny.rstudio.com/" rel="noopener ugc nofollow" target="_blank">闪亮的</a>让R用户无需了解一点JavaScript或HTML就能制作出漂亮的仪表板和交互式报告，所有这些都只需要R。<strong class="kh ir"> RStudio还为每位用户提供多达5个免费仪表盘网站</strong>，这是一种无摩擦的方式来构建您的第一个仪表盘、网络应用或交互式R笔记本。</p><h1 id="4bcf" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">数据源</h1><p id="1287" class="pw-post-body-paragraph kf kg iq kh b ki mu jr kk kl mv ju kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">当我在三月份开始这个项目时，我开始使用的数据源来自Kaggle:由用户SKR上传和维护的<a class="ae lc" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank">新型冠状病毒数据集</a>。如数据集描述中所述，这只是JHU数据集的镜像，GitHub 中也有<a class="ae lc" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank">数据集。不幸的是，在项目后期，我发现这个数据源中有几个工件。例如，在西班牙，4月24日报告了-10000例确诊病例，5月25日记录了-2000例死亡，正如本期GitHub</a>中讨论的<a class="ae lc" href="https://github.com/CSSEGISandData/COVID-19/issues/2572#issuecomment-634159985" rel="noopener ugc nofollow" target="_blank">(在JHU资料库的1300多个未决问题中)。数据中还出现了类似的其他问题，而事实上，存储库维护者并没有站出来对此做出解释，这让我对这些数据的使用产生了怀疑。此外，来自谷歌或我们的数据世界(OWiD)的COVID每日案例没有显示这些人工制品。</a></p><p id="69fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我决定<strong class="kh ir">将我的数据源从JHU中切换出来，改用OWiD</strong>。令我非常满意的是，OWiD数据非常干净，充满了预先计算的特性和统计数据(比如测试统计数据、人口统计数据、每个国家的预期寿命……)。</p><h1 id="c138" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">计划</h1><p id="f2d1" class="pw-post-body-paragraph kf kg iq kh b ki mu jr kk kl mv ju kn ko mw kq kr ks mx ku kv kw my ky kz la ij bi translated">我认为这个项目对于一篇文章来说太大了，因此我决定写一个4部分的系列(包括这个介绍)。接下来的三篇文章如下:</p><ul class=""><li id="dd6c" class="ng nh iq kh b ki kj kl km ko ni ks nj kw nk la nl nm nn no bi translated">我们将首先涵盖数据清理，这是一个必要的步骤，使我们的每个后续情节。<strong class="kh ir">我们主要关注每日和累计的死亡和确诊病例数。</strong>这并不令人兴奋或有足够的洞察力来写一篇关于它的中型文章，因此我为那些对<strong class="kh ir"> RPubs </strong>感兴趣的人发布了这个步骤(在这里阅读<a class="ae lc" href="https://rpubs.com/lucha6/681474" rel="noopener ugc nofollow" target="_blank"/>)。你也可以在另一个RPubs笔记本中探索我清理和争论JHU数据的努力。出于学习的目的，我在第二个笔记本上的努力要有用得多。<strong class="kh ir">数据清理是极其重要的一步，但由于它并不花哨，所以经常被忽视。尽管如此，所有的数据科学家都应该熟悉它。</strong></li><li id="04c2" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">接下来，我们将使用<code class="fe nc nd ne nf b">ggplot2,</code> <code class="fe nc nd ne nf b">plotly</code>和<code class="fe nc nd ne nf b">leaflet</code>制作每个图，并学习如何制作和部署一个闪亮的RMarkdown文档。我们还将看到如何将<code class="fe nc nd ne nf b">plotly</code>图存储为常规文件，以加速我们闪亮文档的加载。</li><li id="b579" class="ng nh iq kh b ki np kl nq ko nr ks ns kw nt la nl nm nn no bi translated">最后，我们将编写自动化工具(bash脚本和Github动作),这样我们的报告就可以每天更新，而不需要我们做任何额外的工作。</li></ul><h1 id="a84e" class="mc md iq bd me mf mg mh mi mj mk ml mm jw mn jx mo jz mp ka mq kc mr kd ms mt bi translated">回头见！</h1></div></div>    
</body>
</html>