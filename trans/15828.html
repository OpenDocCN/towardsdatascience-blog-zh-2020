<html>
<head>
<title>How To Connect Python to Google Cloud’s Text-To-Speech</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将Python连接到Google Cloud的文本到语音转换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-connect-python-to-google-clouds-text-to-speech-d918dc6a393b?source=collection_archive---------20-----------------------#2020-10-31">https://towardsdatascience.com/how-to-connect-python-to-google-clouds-text-to-speech-d918dc6a393b?source=collection_archive---------20-----------------------#2020-10-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e1cf2a57681afc8f650d4578d7bb9ed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HV4QfHZDhVMhY2Np"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">布雷特·乔丹在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="da54" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以你可能想知道<a class="ae kf" href="https://cloud.google.com/text-to-speech" rel="noopener ugc nofollow" target="_blank">谷歌云的文本到语音</a>和其他文本到语音有什么不同。首先，由于人工智能的力量(这些被称为wavenet voices)，它可以将文本转换为听起来更自然的语音。</p><p id="6d53" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我实际上遇到了这项技术，因为我想在YouTube上制作教学视频。自从在家工作发生后，我一直无法创造一个可以创作画外音的空间。最棒的是它附带的免费层，所以任何人都可以尝试这段代码！</p><figure class="lf lg lh li gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi le"><img src="../Images/93099f4a2a10d6709a2f18a073915280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8v4dWL44bjx8OGx8qK93HA.png"/></div></div></figure><p id="90ed" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想继续下去，谷歌Colab笔记本的副本可以在这里找到。</p><h2 id="c32b" class="lj lk it bd ll lm ln dn lo lp lq dp lr kr ls lt lu kv lv lw lx kz ly lz ma mb bi translated">设置</h2><p id="821f" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">没有任何进一步的犹豫，让我们继续前进，并开始设置它。我们要做的第一件事是登录我们的谷歌账户，然后进入<a class="ae kf" href="https://console.cloud.google.com/marketplace/product/google/texttospeech.googleapis.com?q=text&amp;id=d0bc4aeb-b91e-47bc-bd5a-01894bf3a648&amp;project=deep-lore-292922" rel="noopener ugc nofollow" target="_blank">谷歌云的文本到语音转换API </a>。我们现在要通过单击“enable”来激活它。它会要求你付费，但不要担心，除非你超过免费层，否则它不会向你收费。</p><p id="77a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我是在Google Colab笔记本上运行的，所以您需要创建一个服务帐户并下载一个JSON密钥文件。这样做的指令将位于<a class="ae kf" href="https://cloud.google.com/storage/docs/authentication#generating-a-private-key" rel="noopener ugc nofollow" target="_blank">这里</a>。我现在把JSON文件放在我的Google Drive中。请记住，我希望这完全在线。所以我想运行的第一部分代码是连接到Google Drive。</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="b2dd" class="lj lk it mi b gy mm mn l mo mp">from google.colab import drive</span><span id="0787" class="lj lk it mi b gy mq mn l mo mp">drive.mount('/content/drive')</span></pre><p id="8b6c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦我连接到驱动器，我现在想找到那个JSON文件。我创建了一个名为text2speech的文件夹，放在那里。这是我们进行身份验证所需要的。</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="0bac" class="lj lk it mi b gy mm mn l mo mp">import os</span><span id="f228" class="lj lk it mi b gy mq mn l mo mp">os.environ['GOOGLE_APPLICATION_CREDENTIALS'] = '/content/drive/My Drive/text2speech project/My Project-e0a97add923c.json'</span><span id="384f" class="lj lk it mi b gy mq mn l mo mp">!echo $GOOGLE_APPLICATION_CREDENTIALS</span></pre><p id="dcaa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在想安装谷歌云文本到语音库。我们可以通过在代码块中运行pip安装来实现这一点。</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="7cff" class="lj lk it mi b gy mm mn l mo mp">pip install --upgrade google-cloud-texttospeech</span></pre><p id="7d03" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以谷歌云的文本到语音转换很酷的一点是我们可以定制它。从音高到音调，甚至翻译语言。点击查看语音演示<a class="ae kf" href="https://cloud.google.com/text-to-speech/docs/voices" rel="noopener ugc nofollow" target="_blank">。我勉强接受了<code class="fe mr ms mt mi b">Wavenet J</code>的男声。既然我们已经选好了声音，剩下的就容易了。我们只需设置它并发送文本。我们将为此创建一个函数，它将文本输出到mp3文件。</a></p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="d24a" class="lj lk it mi b gy mm mn l mo mp">def synthesize_text(text):</span><span id="4149" class="lj lk it mi b gy mq mn l mo mp">"""Synthesizes speech from the input string of text."""</span><span id="503c" class="lj lk it mi b gy mq mn l mo mp">from google.cloud import texttospeech</span><span id="fe64" class="lj lk it mi b gy mq mn l mo mp">client = texttospeech.TextToSpeechClient()</span><span id="41e7" class="lj lk it mi b gy mq mn l mo mp">input_text = texttospeech.SynthesisInput(text=text)</span><span id="f19d" class="lj lk it mi b gy mq mn l mo mp"># Note: the voice can also be specified by name.</span><span id="cf4d" class="lj lk it mi b gy mq mn l mo mp"># Names of voices can be retrieved with client.list_voices().</span><span id="11c3" class="lj lk it mi b gy mq mn l mo mp">voice = texttospeech.VoiceSelectionParams(</span><span id="189a" class="lj lk it mi b gy mq mn l mo mp">language_code="en-US",</span><span id="1fa3" class="lj lk it mi b gy mq mn l mo mp">name="en-US-Wavenet-J",</span><span id="795f" class="lj lk it mi b gy mq mn l mo mp">ssml_gender=texttospeech.SsmlVoiceGender.MALE,</span><span id="a238" class="lj lk it mi b gy mq mn l mo mp">)</span><span id="ced4" class="lj lk it mi b gy mq mn l mo mp">audio_config = texttospeech.AudioConfig(</span><span id="48da" class="lj lk it mi b gy mq mn l mo mp">audio_encoding=texttospeech.AudioEncoding.MP3</span><span id="2372" class="lj lk it mi b gy mq mn l mo mp">)</span><span id="dee9" class="lj lk it mi b gy mq mn l mo mp">response = client.synthesize_speech(</span><span id="54ec" class="lj lk it mi b gy mq mn l mo mp">request={"input": input_text, "voice": voice, "audio_config": audio_config}</span><span id="905c" class="lj lk it mi b gy mq mn l mo mp">)</span><span id="1d0c" class="lj lk it mi b gy mq mn l mo mp"># The response's audio_content is binary.</span><span id="ef41" class="lj lk it mi b gy mq mn l mo mp">with open("output.mp3", "wb") as out:</span><span id="6462" class="lj lk it mi b gy mq mn l mo mp">out.write(response.audio_content)</span><span id="fe56" class="lj lk it mi b gy mq mn l mo mp">print('Audio content written to file "output.mp3"')</span></pre><p id="8fb7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常容易。我们现在将向该函数发送一个文本字符串。这是文本字符串。</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="15ca" class="lj lk it mi b gy mm mn l mo mp">text = "Hello! My name is Wavenet J and I am running on Google Cloud's Text To Speech! Nice to meet you and thank you for reading my friend's article!"</span></pre><p id="955c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们把所有东西都装满了，准备好了。</p><pre class="lf lg lh li gt mh mi mj mk aw ml bi"><span id="3686" class="lj lk it mi b gy mm mn l mo mp">mp3file = synthesize_text(text)</span></pre><p id="8bd8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在在最左边，我们想选择文件夹图标，现在可以下载我们的mp3文件，并听取一个舒缓的人工智能的声音！</p><h2 id="8141" class="lj lk it bd ll lm ln dn lo lp lq dp lr kr ls lt lu kv lv lw lx kz ly lz ma mb bi translated">结论</h2><p id="2c12" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我向目前正在使用语音的人推荐这种方法。即使是从事自然语言处理的人。此外，如果你是一名教师，这将是一个完美的方式把讲座视频格式。这也很神奇，因为你可以翻译讲座和任何其他文本！</p></div></div>    
</body>
</html>