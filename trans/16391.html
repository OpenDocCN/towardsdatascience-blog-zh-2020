<html>
<head>
<title>How to Label Training Data More Effectively</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何更有效地标注训练数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-much-time-can-you-save-with-active-learning-b4886f5da462?source=collection_archive---------53-----------------------#2020-11-11">https://towardsdatascience.com/how-much-time-can-you-save-with-active-learning-b4886f5da462?source=collection_archive---------53-----------------------#2020-11-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e366" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">通过主动学习节省时间和精力</h2></div><p id="13f5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你曾经参加过任何从零开始的机器学习项目，你可能知道大量的时间通常花在对数据进行标记上。标记数据的数量和质量通常决定了项目的下一步以及最终结果。</p><p id="fd5c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择标记哪些数据的传统方法是简单地选取一个你有标记能力的<strong class="kh ir">随机样本</strong>。</p><p id="aa74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我想探索一种更有效的选择标记数据的方法，称为<strong class="kh ir">主动学习</strong>，基于这样一种想法，一些数据点可能比其他数据点给模型带来更多的信息价值。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/b18446e1505292468e09d63a062a8935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HsYxzFVJjh8IYctn"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">照片由<a class="ae lr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lr" href="https://unsplash.com/@neonbrand?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> NeONBRAND </a>拍摄</p></figure><h2 id="2011" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">主动学习</h2><blockquote class="ml mm mn"><p id="1d14" class="kf kg mo kh b ki kj jr kk kl km ju kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated"><em class="iq">主动学习的主要原则是</em>让模型选择哪些数据实例应该由人工注释者(通常称为oracle)标记<em class="iq">，这样可以用更少的标记数据获得更好的性能。</em></p></blockquote><p id="9600" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让模型做到这一点的最常见的场景被称为<strong class="kh ir">基于池的采样</strong>，其中有大量未标记的数据可用。从这个池中，模型使用某个<strong class="kh ir">查询策略</strong>绘制要标记的实例。在标记了查询的实例之后，用新添加的数据重新训练模型，并再次重复该过程。</p><p id="8d6e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可能最简单的查询策略，也是我在实验中使用的策略，是<strong class="kh ir">不确定性采样</strong>。该策略查询模型预测最不确定的实例。如果我们想象一个<em class="mo">二元分类问题</em>，这些将是后验概率最接近0.5的实例。</p><p id="7f64" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<em class="mo">多类分类问题</em>中，有几种方法进行不确定性采样:</p><blockquote class="ml mm mn"><p id="da18" class="kf kg mo kh b ki kj jr kk kl km ju kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated"><strong class="kh ir"> <em class="iq">最小置信度采样</em> </strong> <em class="iq">选择最可能的标签具有最小置信度的实例(其概率离1.0最远)。</em></p><p id="34d4" class="kf kg mo kh b ki kj jr kk kl km ju kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated"><strong class="kh ir"> <em class="iq">边缘采样</em> </strong> <em class="iq">选择最可能和第二可能标签之间差异最小的实例。</em></p><p id="c704" class="kf kg mo kh b ki kj jr kk kl km ju kn mp kp kq kr mq kt ku kv mr kx ky kz la ij bi translated"><strong class="kh ir"> <em class="iq">熵采样</em> </strong> <em class="iq">选择熵最高的实例(统计概率使用</em> <a class="ae lr" href="https://en.wikipedia.org/wiki/Entropy_(information_theory)" rel="noopener ugc nofollow" target="_blank"> <em class="iq">此公式</em> </a> <em class="iq">)。</em></p></blockquote></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="dc43" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">实验</h2><p id="6241" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">我决定做一个实验，比较所有的<em class="mo">三种多类方法</em>，以及基本的<em class="mo">随机抽样</em>。为此，我使用了<a class="ae lr" href="https://www.kaggle.com/danofer/dbpedia-classes" rel="noopener ugc nofollow" target="_blank"> DBPedia Classes数据集</a>，这是一个多类文本分类的通用基准数据集。</p><p id="e85b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从数据集中，我随机选择了<strong class="kh ir"> 5000个实例</strong>到我们的未标记数据池中。这些数据将被使用不同的策略进行查询，然后被标记为。标注本身并不需要实际执行，因为数据集已经包含了标签。因此，标签只是在需要时简单地分配给实例。</p><p id="1847" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我创建了一个具有一个卷积层的简单模型，在输入中使用<a class="ae lr" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">手套词嵌入</a>。我需要这个模型非常轻量级，因为它会在每次查询后被反复重新训练。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ne nf l"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">用于每个查询策略的模型。</p></figure><p id="9668" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">主动学习需要总是从已经标记的一小部分数据开始，因此在实际开始查询之前，模型至少要经过一点训练。这个小数据集被称为种子。我设置了100个实例的种子，这些实例是从我们的池中随机选择的，被标记并用于每个策略。</p><p id="33fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一个参数是<strong class="kh ir">批量大小</strong>，它在主动学习的上下文中意味着<em class="mo">在模型重新训练之前，应该一次查询和标记多少个实例</em>。理想情况下，我们将使用批处理大小1，这样模型在每个标记的实例后重新训练，从而最大化查询的有效性。这通常是不可能的，因为训练本身计算量很大，需要一定的时间。在这个实验中，我使用的批量为50。</p><p id="3b01" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总的来说，我用这个批量做了98次迭代，它和100个实例的种子一起贯穿了我们已经建立的整个池。每一次迭代，模型的准确性都在一个单独的测试集上进行测量。每种策略的结果如下图所示:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a9fcbb4468c1fe4c1ef75c4d75fc1821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*T_W854CGe51kq6Rabc_f0Q.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">准确度给定标记数据的数量，使用不同的查询策略。图片作者。</p></figure><p id="aada" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您所看到的，所有三种查询策略都以非常相似的方式执行，并且都比随机抽样要好。我们还可以看到，在大约4500个标记实例之后，所有的查询策略(包括随机抽样)都达到了相同的精度。这仅仅是因为我们即将到达<em class="mo">池的末端</em>，这里几乎所有的数据都被贴上标签，而不管策略如何。</p><p id="8844" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们试着将结果转换成<em class="mo">现实生活场景</em>。如果我们项目的目标是达到例如85%的准确度，那么可以通过使用随机抽样标记1900个实例，或者使用最小置信度抽样标记1150个实例来实现。这意味着<strong class="kh ir">花费在标记数据上的时间</strong>减少了39.5%。</p><p id="62b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">定义项目范围的另一种方式是，我们有能力标记例如2000个数据实例。通过这种方式，我们将使用随机抽样达到85.96%的准确度，使用最小置信度抽样达到88.4%，这意味着通过标记相同数量的数据，准确度<strong class="kh ir">提高了2.44%。</strong></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h2 id="10ef" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">结论</h2><p id="8b62" class="pw-post-body-paragraph kf kg iq kh b ki mz jr kk kl na ju kn ko nb kq kr ks nc ku kv kw nd ky kz la ij bi translated">结果似乎很有希望，但是，我们必须意识到，它们可能因数据集而异。值得一提的是，主动学习可能会有一些缺点。</p><p id="5b5a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中之一是在项目开始时为主动学习设置基础设施可能需要一些时间(尽管一些<a class="ae lr" href="https://github.com/modAL-python/modAL" rel="noopener ugc nofollow" target="_blank">框架</a>已经可用)，并且重新训练模型的过程可能<em class="mo">在计算上要求很高</em>。</p><p id="9b66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个是你最终得到的带标签数据的分布<em class="mo">偏向于已经用于查询的模型</em>。如果您现在出于某种原因决定更改模型，那么数据将不再来自随机分布，这对您的新模型来说可能比实际情况更糟。</p><p id="7e35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总的来说，我希望我给了你一个关于积极学习的好的概述，并且当你开始你的下一个项目时，你会考虑到它。</p><p id="40a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该实验的代码可在<a class="ae lr" href="https://www.kaggle.com/sebastianpoliak/active-learning-on-dbpedia-classes" rel="noopener ugc nofollow" target="_blank">这本kaggle笔记本</a>中找到。</p><p id="ed57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">受<a class="ae lr" href="http://burrsettles.com/pub/settles.activelearning.pdf" rel="noopener ugc nofollow" target="_blank">启发主动学习文献调查</a>。</p><p id="e521" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读！</p><div class="nh ni gp gr nj nk"><a rel="noopener follow" target="_blank" href="/systematically-tuning-your-model-by-looking-at-bias-and-variance-4986662315b2"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">通过观察偏差和方差来系统地调整你的模型</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">有没有想过是否有比盲目猜测超参数或…更系统的方法来调整您的模型</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">towardsdatascience.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ll nk"/></div></div></a></div><div class="nh ni gp gr nj nk"><a rel="noopener follow" target="_blank" href="/zero-shot-learning-the-alphabetic-characters-an-experiment-with-code-d1a0f23f4b4c"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd ir gy z fp np fr fs nq fu fw ip bi translated">零射击学习字母字符(代码实验)</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">是否有可能识别培训中未提供的字母字符？</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">towardsdatascience.com</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny ll nk"/></div></div></a></div></div></div>    
</body>
</html>