<html>
<head>
<title>How to identify Japanese candlesticks patterns in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python识别日本烛台图案</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-identify-japanese-candlesticks-patterns-in-python-b835d1cc72f7?source=collection_archive---------6-----------------------#2020-11-03">https://towardsdatascience.com/how-to-identify-japanese-candlesticks-patterns-in-python-b835d1cc72f7?source=collection_archive---------6-----------------------#2020-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9dfcdd0b2cc055f8e91f3162449e309d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9uHfZFbc7nnPSGb5"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">克里斯·利维拉尼在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0a58" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">日本烛台是最重要的工具之一，用于自由交易或量化交易。它们是被称为价格行动的特殊交易风格的第一个例子。</p><p id="c347" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看它们是什么，以及如何在Python中使用它们。</p><p id="d8aa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> <em class="le">来自《走向数据科学》编辑的提示:</em> </strong> <em class="le">虽然我们允许独立作者根据我们的</em> <a class="ae kf" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="le">规则和指导方针</em> </a> <em class="le">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae kf" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="le">读者术语</em> </a> <em class="le">。</em></p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="e3e5" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">日本的烛台有哪些？</h1><p id="c24b" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">日本烛台是一种特殊的图表类型。对于每个时间段，它们显示最高价、最低价、开盘价和收盘价。</p><p id="d494" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一个示例图表:</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/dc8f48a353cb2f946a75eb85a5196e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pUZtChEZv1HNWEpt"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">日本烛台图表示例。图片作者。</p></figure><p id="002d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每一天都用一个叫做<em class="le">蜡烛的符号来代表。</em>每根蜡烛由一个<em class="le">实体、</em>一个<em class="le">上影</em>和一个<em class="le">下影</em>制成。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/c2483868698e8ccee012523a59a49d88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*UYSJ_32Jri_Ns2AqWWlOAA.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="b6c0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">蜡烛有一种颜色。如果收盘价高于开盘价，它们通常是白色、绿色或蓝色的(看涨蜡烛线)。如果收盘价低于开盘价，它们就是黑色或红色的(看跌蜡烛线)。</p><h1 id="555c" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">它们是如何使用的？</h1><p id="f3ed" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">这种图表非常有用，因为它在一个简单的符号中给了我们很多信息，但最重要的用途与模式有关。模式是蜡烛线的组合，显示一个特殊的图形形状，它们对发现价格反转很有用。让我们看看其中的一些。</p><h1 id="f3a1" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">在Python中识别模式</h1><p id="456e" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">下面是最常见模式的列表，Python代码可以让我们识别它们。</p><p id="9b7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在我的GitHub储存库中找到完整的代码:<a class="ae kf" href="https://github.com/gianlucamalato/machinelearning/blob/master/Candlesticks.ipynb" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/gianlucamalato/machine learning/blob/master/candlesticks . ipynb</a></p><p id="b9ce" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先要安装<em class="le"> yfinance </em>库，下载市场数据。</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="5952" class="nf ln it nb b gy ng nh l ni nj">!pip install yfinance</span></pre><p id="52e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们可以导入<em class="le">熊猫</em>和<em class="le">金融</em>。</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="e1a6" class="nf ln it nb b gy ng nh l ni nj">import pandas as pd<br/>import yfinance</span></pre><p id="dcc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于这个例子，我们将使用过去5个月的标准普尔500每日数据。</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="7aff" class="nf ln it nb b gy ng nh l ni nj">ticker = yfinance.Ticker("SPY")<br/>df = ticker.history(period = '5mo')</span></pre><p id="71db" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们将创建与模式一样多的列，每一列都有一个布尔值，如果模式出现则为真，否则为假。</p><p id="c8ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，我们必须在历史数据中扫描。我们将使用for循环。我们计算真实的身体宽度和烛光范围。</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="6ebd" class="nf ln it nb b gy ng nh l ni nj">for i in range(2,df.shape[0]):<br/>  current = df.iloc[i,:]<br/>  prev = df.iloc[i-1,:]<br/>  prev_2 = df.iloc[i-2,:]</span><span id="c720" class="nf ln it nb b gy nk nh l ni nj">  realbody = abs(current['Open'] - current['Close'])<br/>  candle_range = current['High'] - current['Low']</span><span id="ce3a" class="nf ln it nb b gy nk nh l ni nj">  idx = df.index[i]</span></pre><p id="e3b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们看看一些模式及其代码，它们必须包含在循环的<em class="le">中。</em></p><h1 id="f97c" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">看涨摇摆</h1><p id="bc1d" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">看涨摆动是一个简单的3蜡烛线模式。第二根蜡烛线在三根蜡烛线中最低。蜡烛的颜色无关紧要。这是一个信号，表明价格可能上涨。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/bcbae36cfc3806b54f1afa46c283106a.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*FQQxT_-QMz9NTpbCof5lZA.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="b68c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，代码很简单:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="9540" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bullish swing'] = current['Low'] &gt; prev['Low'] and prev['Low'] &lt; prev_2['Low']</span></pre><h1 id="ba11" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">看跌摇摆</h1><p id="9ce3" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">看跌的波动与看涨的波动相反。它由三根蜡烛组成，第二根蜡烛最高。蜡烛的颜色无关紧要。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/a56bf0fe962fec99609a0c92348b6c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*LCXd2126CwVx_wzi47VSMw.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="5e9f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是代码:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="ff95" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bearish swing'] = current['High'] &lt; prev['High'] and prev['High'] &gt; prev_2['High']</span></pre><h1 id="de76" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">多头针棒</h1><p id="4211" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">针条是非常频繁和强大的模式。众所周知，针棒有很长的影子和很小的实体。非常重要的一点是，针棒不仅仅是蜡烛，它还必须从周围的价格活动中突出出来。所以，相对于前一根蜡烛线，一根看涨的针棒线必须有一个更低的低点。</p><p id="f9d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以定义一个“小”的真实物体为宽度小于烛光范围除以3的真实物体。一根看涨的针棒将会把真实的主体放在蜡烛的上半部分。蜡烛的颜色无关紧要。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/f1fc9c9afb00a3bc7f380bf5e66bd662.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*xC-UF0HsbkUFDjJwWmJ9IQ.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="3bdb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是多头针棒的代码:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="505e" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bullish pinbar'] = realbody &lt;= candle_range/3 and  min(current['Open'], current['Close']) &gt; (current['High'] + current['Low'])/2 and current['Low'] &lt; prev['Low']</span></pre><h1 id="11ec" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">轴承销杆</h1><p id="ee77" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">看跌的针柱就像看涨的针柱一样，但是真正的主体现在位于蜡烛线的下半部分，并且比之前的蜡烛线高。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/aca36863b39ad47e0cca169f7290a8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*zT3-g2NaHjHjLDJR5RYMag.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="4b22" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="4163" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bearish pinbar'] = realbody &lt;= candle_range/3 and max(current['Open'] , current['Close']) &lt; (current['High'] + current['Low'])/2 and current['High'] &gt; prev['High']</span></pre><h1 id="aa49" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">内部酒吧</h1><p id="3636" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">酒吧内部是由两根蜡烛组成的图案。第二根蜡烛完全包含在第一根蜡烛的范围内。颜色无关紧要。</p><p id="3d77" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种模式显示了波动性的收缩，这可能是一个强大的方向性爆炸的前奏。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/8cf0454d82e2a5cafc135e919e8a5845.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*QKHa9-et9DnZ8mMSk0-aYw.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="6a2d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="b284" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Inside bar'] = current['High'] &lt; prev['High'] and current['Low'] &gt; prev['Low']</span></pre><h1 id="8f45" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">外部酒吧</h1><p id="2c89" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">外侧杠与内侧杠相反。蜡烛系列完全包括之前的蜡烛。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/f996f52bf38c232aa5a8b9559e923269.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*irKXyXwEjlsh57wu55hDcA.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="f050" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="da03" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Outside bar'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low']</span></pre><h1 id="a853" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">看涨吞没</h1><p id="5276" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">多头吞没是一种强势的多头形态。这是一个外面的酒吧，有一个巨大的、乐观的真实身体。我们可以把“巨大”定义为一个真实的物体，它的宽度占蜡烛线的80%以上。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/cafb2bca9a53eab8b44b3f6892a6b64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*O2aST8IeA1i2l4UVA4jRNQ.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="d0e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="2102" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bullish engulfing'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low'] and realbody &gt;= 0.8 * candle_range and current['Close'] &gt; current['Open']</span></pre><h1 id="6099" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">熊市吞没</h1><p id="9d19" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">看跌吞没是看涨吞没的反义词。一根巨大的熊蜡烛完全吞没了前一根蜡烛。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/589f4596e1a6260f7d418340c4c94f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*AOdINTBc_X1rE4as1OHVZw.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">作者图片</p></figure><p id="df28" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码如下:</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="7fa0" class="nf ln it nb b gy ng nh l ni nj">df.loc[idx,'Bearish engulfing'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low'] and realbody &gt;= 0.8 * candle_range and current['Close'] &lt; current['Open']</span></pre><h1 id="c604" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">完整的代码</h1><p id="7f58" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">下面是完整的代码。请记住，我们必须用错误来填补空白。</p><pre class="mq mr ms mt gt na nb nc nd aw ne bi"><span id="c16f" class="nf ln it nb b gy ng nh l ni nj">for i in range(2,df.shape[0]):<br/>  current = df.iloc[i,:]<br/>  prev = df.iloc[i-1,:]<br/>  prev_2 = df.iloc[i-2,:]</span><span id="32e6" class="nf ln it nb b gy nk nh l ni nj">realbody = abs(current['Open'] - current['Close'])<br/>  candle_range = current['High'] - current['Low']</span><span id="672c" class="nf ln it nb b gy nk nh l ni nj">idx = df.index[i]<br/>  <br/>  # Bullish swing<br/>  df.loc[idx,'Bullish swing'] = current['Low'] &gt; prev['Low'] and prev['Low'] &lt; prev_2['Low']</span><span id="c435" class="nf ln it nb b gy nk nh l ni nj"># Bearish swing<br/>  df.loc[idx,'Bearish swing'] = current['High'] &lt; prev['High'] and prev['High'] &gt; prev_2['High']</span><span id="1a4e" class="nf ln it nb b gy nk nh l ni nj"># Bullish pinbar<br/>  df.loc[idx,'Bullish pinbar'] = realbody &lt;= candle_range/3 and  min(current['Open'], current['Close']) &gt; (current['High'] + current['Low'])/2 and current['Low'] &lt; prev['Low']</span><span id="86cf" class="nf ln it nb b gy nk nh l ni nj"># Bearish pinbar<br/>  df.loc[idx,'Bearish pinbar'] = realbody &lt;= candle_range/3 and max(current['Open'] , current['Close']) &lt; (current['High'] + current['Low'])/2 and current['High'] &gt; prev['High']<br/>    <br/>  # Inside bar<br/>  df.loc[idx,'Inside bar'] = current['High'] &lt; prev['High'] and current['Low'] &gt; prev['Low']<br/>    <br/>  # Outside bar<br/>  df.loc[idx,'Outside bar'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low']<br/>  <br/>  # Bullish engulfing<br/>  df.loc[idx,'Bullish engulfing'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low'] and realbody &gt;= 0.8 * candle_range and current['Close'] &gt; current['Open']</span><span id="31c4" class="nf ln it nb b gy nk nh l ni nj"># Bearish engulfing<br/>  df.loc[idx,'Bearish engulfing'] = current['High'] &gt; prev['High'] and current['Low'] &lt; prev['Low'] and realbody &gt;= 0.8 * candle_range and current['Close'] &lt; current['Open']</span><span id="b7b1" class="nf ln it nb b gy nk nh l ni nj">df.fillna(False, inplace=True)</span></pre><p id="a533" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的数据框最终将是这样的:</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/26df27cd2ea9bc3eb42c303994b4ba6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AgDpBHIyZT_8v5B4dhLWNA.png"/></div></div></figure><p id="b209" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据列的值过滤行将使我们回测任何使用这种模式的交易策略。</p><h1 id="7749" class="lm ln it bd lo lp mv lr ls lt mw lv lw lx mx lz ma mb my md me mf mz mh mi mj bi translated">结论</h1><p id="e370" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">日本烛台模式对于发现趋势反转非常有用。本文中没有描述许多不同的模式，但是在这里您可以找到最重要的模式。这种模式的Python实现对任何想开始算法交易冒险的人都非常有用。</p></div></div>    
</body>
</html>