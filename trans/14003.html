<html>
<head>
<title>Orchestrating Transient Data Analytics &amp; ML Workflows via AWS Step Functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过AWS步骤功能编排瞬态数据分析和ML工作流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/orchestrating-transient-data-analytics-workflows-via-aws-step-functions-c9e8309f63bf?source=collection_archive---------31-----------------------#2020-09-26">https://towardsdatascience.com/orchestrating-transient-data-analytics-workflows-via-aws-step-functions-c9e8309f63bf?source=collection_archive---------31-----------------------#2020-09-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5865" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">AWS自动化提示和技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cc73e33a109d23b264baf31cf8b66f46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4H9ynvnOpAbbPbwf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@spacexuan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">郭锦恩</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h1 id="de52" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="0ce4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu"> <em class="mn"> AWS步骤功能</em> </strong>是一个完全托管的服务，旨在协调和链接一系列步骤，为自动化任务创建一个称为状态机的东西。它支持可视化工作流，状态机通过<strong class="lt iu"> <em class="mn">亚马逊状态语言</em> </strong> ( <em class="mn"> ASL </em>)定义为JSON结构。此外，状态机可以通过<strong class="lt iu"><em class="mn">Amazon cloud watch</em></strong>作为事件规则cron表达式进行调度。</p><p id="9ed9" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在这篇博客中，我将带你经历1。)如何通过<strong class="lt iu"> <em class="mn">亚马逊EMR </em> </strong>和2来编排数据处理作业。)如何通过<strong class="lt iu"> <em class="mn">亚马逊SageMaker </em> </strong>在一个训练好的机器学习模型上应用batch transform来编写预测。<em class="mn">步骤功能</em>可以与多种<strong class="lt iu"> <em class="mn"> AWS </em> </strong>服务集成，包括:<em class="mn"> AWS Lambda </em>，<em class="mn"> AWS Fargate </em>，<em class="mn"> AWS Batch </em>，<em class="mn"> AWS Glue </em>，<em class="mn">亚马逊ECS </em>，<em class="mn">亚马逊SQS </em>，<em class="mn">亚马逊SNS </em>，<em class="mn">亚马逊DynamoDB</em></p><h1 id="56a7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">示例1:通过Amazon EMR编排数据处理作业</h1><p id="d4fa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">1a。)让我们在<em class="mn">亚马逊S3 </em>中查看我们的输入样本数据集(来自我最喜欢的视频游戏的虚拟数据)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/7707560adeab4d7b20a119a08d55b4fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQWARqMAKDtCZD_Roun2ww.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="cf27" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">1b。)接下来，我将创建一个状态机，它通过<em class="mn"> ASL </em>启动一个<em class="mn"> EMR </em>集群(一组<em class="mn"> EC2 </em>实例)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7f2f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">1c。)现在，我们可以通过向集群提交一个作业并在完成后通过<em class="mn"> ASL </em>终止基础架构来执行一些数据处理(简单的按列分区)。让我们也在<em class="mn"> S3 </em>中检查我们的输出数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/6262c77315bd40e9bf747d7c6565682b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rVuMm4E1weT3QI7ZX7mYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="89f8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">1d。)这里是完整的JSON <em class="mn"> ASL </em>结构和正在进行的可视化工作流截图。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/d055eeb955d19e66e2ea91a746f0b259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*be8uN9DTysk14PdoZJK8MQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b844" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">1e。)最后，让我们通过<em class="mn"> CloudWatch </em>调度每15分钟执行一次，作为一个简单的cron表达式(0 */15 *？* *).</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/dda564295d7320e317511c9d71b69027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Zthp84vKPbB4KAbqeAh0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="4465" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">总之，对于这个例子，您可以利用<em class="mn">步骤函数</em>来自动化和调度您的数据处理作业。复杂程度通常取决于数据量，可以是单台<em class="mn"> EC2 </em>机器上的几个简单步骤，也可以是在同一个集群上并行分配多个作业，或者跨多个集群使用不同的实例类型。我建议在JSON <em class="mn"> ASL </em>中为选定的软件(即YARN、Spark、Hive、Sqoop)包含额外的<em class="mn"> EMR </em>调优配置，以优化工作性能。此外，明智地选择<em class="mn"> EC2 </em>实例类型的数量和种类，以节省成本和执行时间。您的决定应该主要取决于需要处理的总数据量和作业类型(CPU或内存受限)。</p><p id="2d5d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">到下一个例子…</p><h1 id="3e53" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">示例2:通过Amazon SageMaker，使用经过训练的ML模型对数据进行批量转换以进行推理</h1><p id="78d1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">2a。)为了便于理解数据，让我们查看原始的带标签的(因变量是最后一列名为<em class="mn">环</em>的)训练数据集(来自<em class="mn"> UCI机器学习库</em>的鲍鱼)在<em class="mn"> S3 </em>中。经过训练的模型通过物理测量来预测鲍鱼(一种贝类)的年龄。</p><p id="06e1" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated"><a class="ae ky" href="https://archive.ics.uci.edu/ml/datasets/abalone" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/abalone</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/0a56039b01278ebdc43be427a15e8a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NCxcw8GzaZirhJQOqmIYfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3174" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">2b。)接下来，让我们创建<em class="mn"> ASL </em>结构，该结构触发原始未标记(无<em class="mn">环</em>列)批处理数据集上的批处理转换作业，该数据集需要通过存储在<em class="mn"> S3 </em>中的训练模型进行推理。<strong class="lt iu"> <em class="mn">请注意，目前您必须将内联策略附加到为状态机</em> </strong>选择的角色。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/eec08a82b0b19b8d5d354282780b9b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXfATJcnXYxL-5-yoK0zOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://docs.aws.amazon.com/step-functions/latest/dg/sagemaker-iam.html#sagemaker-iam-createtrainingjob" rel="noopener ugc nofollow" target="_blank">亚马逊网络服务</a></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/0eb26547518e724cc231073c3f490eab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmbyyN_MzZn-dSAZtNT_jg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://docs.aws.amazon.com/step-functions/latest/dg/procedure-create-iam-role.html" rel="noopener ugc nofollow" target="_blank">亚马逊网络服务</a></p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="6c81" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">2c。)最后，我们可以查看<em class="mn">步骤功能</em>可视化工作流程以及添加了预测分数栏的作业输出结果。注意，该模型是一个流水线模型，包括预处理(一个热编码、缩放等。)数据，然后将其发送到监督学习算法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/4bbf0a8a38cd0146a85f2ade00ba26c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ck7N-jcMJgLtjiXm9cUYfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/f9c69114b23649075d09db302dc21906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CObh9HhlEjsDR4TBVkhomg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="87cc" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">总之，对于本例，您可以利用<em class="mn">步骤功能</em>来自动化和调度您的机器学习作业(预处理、训练、调优、模型托管、自助服务&amp;批量推理)。<em class="mn">步骤函数</em>和<em class="mn"> SageMaker </em>集成支持以下API:<code class="fe ne nf ng nh b">CreateEndpoint</code>、<code class="fe ne nf ng nh b">CreateEndpointConfig</code>、<code class="fe ne nf ng nh b">CreateHyperParameterTuningJob</code>、<code class="fe ne nf ng nh b">CreateLabelingJob</code>、<code class="fe ne nf ng nh b">CreateModel</code>、<code class="fe ne nf ng nh b">CreateTrainingJob</code>、<code class="fe ne nf ng nh b">CreateTransformJob</code>。</p><h1 id="b031" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="d8b1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这两个例子涵盖了<strong class="lt iu"> <em class="mn"> AWS </em> </strong>服务能够扩展数据工程和机器学习工作流的一小部分。感谢你阅读这篇博客。</p></div></div>    
</body>
</html>