<html>
<head>
<title>How to use time travel to debug your ML pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用时间旅行来调试你的ML管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-time-travel-to-debug-your-ml-pipelines-efb5263372c0?source=collection_archive---------39-----------------------#2020-10-06">https://towardsdatascience.com/how-to-use-time-travel-to-debug-your-ml-pipelines-efb5263372c0?source=collection_archive---------39-----------------------#2020-10-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9e7b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的管道步骤透明化，探索它们的状态，住在Jupyter。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4084278dcd685ba7ff3445a0885646a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtLG2Al5bybvrRYguEnh8w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼尔·利维斯·佩鲁西在<a class="ae ky" href="https://unsplash.com/s/photos/time?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="392d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习项目由几个不同的步骤组成:数据获取、数据验证、数据处理、模型训练、模型评估等。每一步都接受定义明确的输入，并产生特定的输出。</p><blockquote class="lv"><p id="39fc" class="lw lx it bd ly lz ma mb mc md me lu dk translated"><strong class="ak">如果我们能回到过去，在熟悉的Jupyter环境中探索跑步的状态，那就太好了</strong></p></blockquote><p id="96d7" class="pw-post-body-paragraph kz la it lb b lc mf ju le lf mg jx lh li mh lk ll lm mi lo lp lq mj ls lt lu im bi translated"><strong class="lb iu">如果传入的数据有问题，该步骤可能会失败，甚至会破坏下游的分析任务。</strong>后者可能会引入不太容易调试的重影问题:例如，数据泄漏(即，当训练数据集之外的信息用于创建模型时)可能会影响模型的泛化能力，但它不会在训练期间引发异常。</p><p id="6755" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了避免这种错误，我们应该能够窥视管道并尽早发现它们。因此，数据科学家最终会检查日志，打印原始指标并创建可视化，如学习曲线和混淆矩阵。</p><p id="5813" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这些工具为构建更健壮的模型提供了有价值的见解，但是如果我们能够回到过去并探索正在运行的步骤的状态，那就太好了。在这个故事中，我们探索如何在Kubeflow管道中做到这一点。</p><blockquote class="mk ml mm"><p id="592c" class="kz la mn lb b lc ld ju le lf lg jx lh mo lj lk ll mp ln lo lp mq lr ls lt lu im bi translated"><a class="ae ky" href="https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter" rel="noopener ugc nofollow" target="_blank">学习率</a>是为那些对AI和MLOps的世界感到好奇的人准备的时事通讯。你会在每周五收到我关于最新人工智能新闻和文章的更新和想法。在这里订阅<a class="ae ky" href="https://mailchi.mp/d2d2d4a109b5/learning-rate-newsletter" rel="noopener ugc nofollow" target="_blank"/>！</p></blockquote></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h1 id="bdc1" class="my mz it bd na nb nc nd ne nf ng nh ni jz nj ka nk kc nl kd nm kf nn kg no np bi translated">安装Kubeflow</h1><p id="8c93" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">首先，我们需要一个工作站。设置Kubeflow不是一件容易的事情，尤其是如果你没有使用Kubernetes的经验。但这不应该阻止你；我们可以在谷歌云平台(GCP)上使用<a class="ae ky" href="https://www.kubeflow.org/docs/started/workstation/getting-started-minikf/" rel="noopener ugc nofollow" target="_blank"> MiniKF </a>在10分钟内构建一个单节点集群。</p><ol class=""><li id="1198" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">访问GCP 页面上的<a class="ae ky" href="https://console.cloud.google.com/marketplace/details/arrikto-public/minikf" rel="noopener ugc nofollow" target="_blank"> MiniKF</a></li><li id="7c81" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">选择<em class="mn">启动，设置虚拟机配置并点击部署</em></li></ol><blockquote class="mk ml mm"><p id="a329" class="kz la mn lb b lc ld ju le lf lg jx lh mo lj lk ll mp ln lo lp mq lr ls lt lu im bi translated">为了获得最佳性能，建议保留默认的虚拟机配置</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl oj"><img src="../Images/dd6de51a4d76daac1273f3ad1a4b5fbb.png" data-original-src="https://miro.medium.com/v2/1*Es_e4P7yc4RgSgQh666plw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MiniKF部署—作者图片</p></figure><p id="2997" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！部署最多需要十分钟，您可以按照屏幕上的说明观看进度；ssh进入机器，在终端上运行<code class="fe ok ol om on b">minikf</code>,等待直到您的端点和凭证准备好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/25c178fec497dcd408eec3f130a4efd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*CATFiBoMZFCY6fHEVjGZTg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MiniKF的提供已完成—图片由作者提供</p></figure><p id="16e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们准备访问Kubeflow仪表板。点击网址，输入你的凭证，你就可以开始了！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/54f0dbb046cd9a85b6e300ed123ca77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zckzyLjYRnGzBejrE_6XsA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kubeflow仪表板—按作者分类的图像</p></figure><p id="487f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关部署过程以及如何启动Jupyter服务器的更多详细信息，请阅读下面的故事:</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/kubeflow-is-more-accessible-than-ever-with-minikf-33484d9cb26b"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">有了MiniKF，Kubeflow比以往任何时候都更容易访问</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">10分钟入门Kubernetes最好的机器学习平台。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ks ot"/></div></div></a></div><h1 id="592d" class="my mz it bd na nb pi nd ne nf pj nh ni jz pk ka nk kc pl kd nm kf pm kg no np bi translated">调试Kubeflow管道</h1><p id="fd44" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">为了演示如何在某个时间点返回并探索管道步骤的状态，我们需要管道本身。无需编写一行代码，就可以轻松地从Jupyter笔记本上创建Kubeflow管道。你可以在下面的故事中看到。</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/jupyter-is-ready-for-production-as-is-b36f1d1ca8f8"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">Jupyter准备生产；原样</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">无需编写一行代码，即可将您的笔记本草稿转化为生产就绪的Kubeflow管道。</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pn l pe pf pg pc ph ks ot"/></div></div></a></div><p id="bfc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于这个例子，我们假设您已经成功地运行了一个管道。如果你想了解前面提到的故事，我们使用众所周知的<em class="mn">泰坦尼克号</em>数据集来训练五个不同的分类器。最后，您的管道应该类似于下面这样:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/f7fd895ec11bc08cbe592a252b756c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cz4uareq_U4e-Sci3yL5wA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">泰坦尼克号管道——作者图片</p></figure><p id="55bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，假设我们对SVM算法的结果不满意。<strong class="lb iu">我们想回到这一步，在训练算法和探索我们生活在笔记本中的世界的状态之前。</strong>为此，我们求助于<a class="ae ky" href="https://www.kubeflow.org/docs/other-guides/integrations/data-management/" rel="noopener ugc nofollow" target="_blank">韩国</a>！</p><h2 id="558e" class="pp mz it bd na pq pr dn ne ps pt dp ni li pu pv nk lm pw px nm lq py pz no qa bi translated">韩国快照</h2><p id="cff0" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">Rok是一个数据管理产品，允许您对您的<strong class="lb iu">完整环境及其数据</strong>进行快照、版本化、打包、分发和克隆。它作为其支持的平台之一与Kubernetes进行了本机集成，并在几分钟内部署到现有的集群、本地或云上。</p><p id="9d04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它预装在MiniKF中，所以让我们使用它:</p><ol class=""><li id="bced" class="nv nw it lb b lc ld lf lg li nx lm ny lq nz lu oa ob oc od bi translated">点击<code class="fe ok ol om on b">smv</code>步骤并选择<code class="fe ok ol om on b">Visualizations</code>选项卡</li><li id="ded5" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">跟随<code class="fe ok ol om on b">Rok autosnapshot</code>卡内的链接</li><li id="0428" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">复制页面顶部的韩国网址</li><li id="267d" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">创建一个新的笔记本服务器，并在顶部粘贴复制的网址</li><li id="dcec" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">配置虚拟机资源，并为工作区指定一个有效的名称</li><li id="5cf3" class="nv nw it lb b lc oe lf of li og lm oh lq oi lu oa ob oc od bi translated">点击<code class="fe ok ol om on b">LAUNCH</code>按钮</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/d4b760500171f98bac9c9b6ed9d30c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zpKIS2B7d42gcbaKDN-ZAg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">与韩国同行——作者图片</p></figure><p id="b1a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当笔记本电脑服务器准备就绪后，连接到它，一个新的JupyterLab环境将在您请求的位置准确地打开。到目前为止的所有单元格都已为您执行。您可以从该单元格继续工作；探索变量状态、数据集和您的模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/b92d705e012a35fae4251da38d04e716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jVGbmZiHh22U5fthyIkjbw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">继续你的JupyterLab状态——作者图片</p></figure><p id="55da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您有了一种调试错误的方法，即探索在特定时间点管道中发生了什么。这当然比原始日志更有价值，也比静态可视化更强大。</p><h1 id="097f" class="my mz it bd na nb pi nd ne nf pj nh ni jz pk ka nk kc pl kd nm kf pm kg no np bi translated">结论</h1><p id="696f" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">在这个故事中，我们看到了如何使用Rok，一种数据管理服务，在Jupyter笔记本中进行时间旅行，并实时探索管道步骤的状态。这给了我们调试ML管道的能力，也给了他们版本。如果您关心版本控制，可以看看下面的文章。</p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/the-way-you-version-control-your-ml-projects-is-wrong-42910cba9bd9"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">你控制ML项目版本的方式是错误的</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">当您可以拥有更多时，是否在寻找一种类似git的数据版本控制方法？是时候跳出框框思考了</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="qc l pe pf pg pc ph ks ot"/></div></div></a></div><h2 id="7415" class="pp mz it bd na pq pr dn ne ps pt dp ni li pu pv nk lm pw px nm lq py pz no qa bi translated">关于作者</h2><p id="4515" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">我叫<a class="ae ky" href="https://www.linkedin.com/in/dpoulopoulos/" rel="noopener ugc nofollow" target="_blank">迪米特里斯·波罗普洛斯</a>，我是一名为<a class="ae ky" href="https://www.arrikto.com/" rel="noopener ugc nofollow" target="_blank">阿里克托</a>工作的机器学习工程师。我曾为欧洲委员会、欧盟统计局、国际货币基金组织、欧洲中央银行、经合组织和宜家等主要客户设计和实施人工智能和软件解决方案。</p><p id="97c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣阅读更多关于机器学习、深度学习、数据科学和数据操作的帖子，请在twitter上关注我的<a class="ae ky" href="https://medium.com/@dpoulopoulos" rel="noopener"> Medium </a>、<a class="ae ky" href="https://www.linkedin.com/in/dpoulopoulos/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae ky" href="https://twitter.com/james2pl" rel="noopener ugc nofollow" target="_blank"> @james2pl </a>。</p><p id="884d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所表达的观点仅代表我个人，并不代表我的雇主的观点或意见。</p></div></div>    
</body>
</html>