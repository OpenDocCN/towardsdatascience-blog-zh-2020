<html>
<head>
<title>Grid Search for SARIMAX Parameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SARIMAX参数的网格搜索</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/grid-search-for-sarimax-parameters-adbd5104cb8b?source=collection_archive---------9-----------------------#2020-09-28">https://towardsdatascience.com/grid-search-for-sarimax-parameters-adbd5104cb8b?source=collection_archive---------9-----------------------#2020-09-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="61d2" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="1bbc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">为statsmodels SARIMAX模型找到最佳参数的简单方法</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/365bf6ce83d989f57a98b72ee93e91ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HeQdvApssqke77z6gfYhg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="24a3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您已经在这里登陆，那么您很可能正在实现一个statsmodels SARIMAX时间序列模型，并且您正在寻找一种简单的方法来识别所有最佳参数。我有一些好消息要告诉你…你来对地方了！</p><blockquote class="md"><p id="add7" class="me mf it bd mg mh mi mj mk ml mm mc dk translated">在本教程中，您将学习如何运行简单的网格搜索来为statsmodel SARIMAX时间序列模型查找最佳参数。或者您可以直接复制并粘贴代码——甚至更简单！</p></blockquote><p id="096a" class="pw-post-body-paragraph lh li it lj b lk mn kd lm ln mo kg lp lq mp ls lt lu mq lw lx ly mr ma mb mc im bi translated">对于我们的SARIMAX模型，总共有七个子参数，单独计算它们并不容易。然而，通过几行简单的代码，我们可以创建一个定制的网格搜索，给出一个最优参数列表，按照用户选择的选择标准(AIC或BIC)排序。</p><h2 id="42f0" class="ms mt it bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj iz bi translated">选择标准</h2><p id="31cc" class="pw-post-body-paragraph lh li it lj b lk nk kd lm ln nl kg lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">让我们从选择标准开始。这里的两个选择是AIC和BIC。它们分别代表阿凯克信息准则和贝叶斯信息准则。他们选择用最少的独立变量解释最大变化的模型。[1]他们计算的方法是使用最大似然估计(MLE ),他们都惩罚一个增加变量数量以防止过度拟合的模型。</p><p id="c43d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">围绕哪一个最好用，有很多讨论。BIC会因为一个模型有越来越多的变量而加大对它的惩罚力度。如果在未来的数据集或模型将应用的多个数据集中有更多的变化，那么我推荐使用BIC。就像我在这里一样。然而，并没有很大的区别，AIC也很普通，所以真正的选择权在你。</p><h2 id="879e" class="ms mt it bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj iz bi translated">SARIMAX参数</h2><p id="f9dc" class="pw-post-body-paragraph lh li it lj b lk nk kd lm ln nl kg lp lq nm ls lt lu nn lw lx ly no ma mb mc im bi translated">SARIMAX是时间序列模型中的佼佼者。在进行时间序列建模时，它基本上考虑了所有可以考虑的因素。</p><blockquote class="md"><p id="fa6d" class="me mf it bd mg mh mi mj mk ml mm mc dk translated">我们将在这里对参数进行简单直观的解释。</p></blockquote><p id="5a53" class="pw-post-body-paragraph lh li it lj b lk mn kd lm ln mo kg lp lq mp ls lt lu mq lw lx ly mr ma mb mc im bi translated"><strong class="lj jd">S——代表季节性。</strong>这意味着数据表现出季节性。这样的例子可能是一年中的季节，因此给定位置的温度波动将根据季节而变化，通常夏天更暖和，冬天更凉爽。如果我们有月平均值的数据，那么“S”就是12。<em class="np">在我们的模型中用“s”来表示。</em></p><p id="b7c3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> AR —代表自回归</strong>。这是数据在任何给定的时间间隔或之前的时期与之前的数据的相似程度。简单来说，它代表数据中的重复模式。自回归是指数据在之前数据的某个滞后期内回归，并找到回归最强的地方，代表数据中的模式。<em class="np">在我们的模型中表示为“p”。</em></p><p id="114a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">I—代表集成的</strong>。“I”表示数据值已被替换为其值与先前值之间的差值。[2] <em class="np">在我们的模型中用“d”来表示。</em></p><p id="6713" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">MA——代表移动平均线。</strong>此术语计算给定周期数的移动平均值。它用于减少模型中的噪波或使其平滑。移动平均周期越长，噪声就越平滑。<em class="np">在我们的模型中表示为“q”。</em></p><p id="b9a6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> X —代表外源性。</strong>这考虑了一个已知的外部因素。在我们的模型中，这是一个可选的参数，而不是一个参数。是我们可以添加到模型中的一系列外生回归变量。这部分是可选的，在计算我们的最佳模型参数时不是必需的。</p><p id="3466" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在我们的模型中，我们的参数如下所示:</p><p id="2d78" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> SARIMAX (p，D，q) x (P，D，Q，s) </strong></p><p id="8c45" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">statsmodel SARIMAX模型考虑了常规ARIMA模型(P，D，Q)以及季节性ARIMA模型(P，D，Q，s)的参数。这几组参数是我们的模型中的参数，分别称为订单和季节订单。</p><blockquote class="md"><p id="ab34" class="me mf it bd mg mh mi mj mk ml mm mc dk translated">现在是有趣的部分——让我们编码吧！</p></blockquote><p id="5fb5" class="pw-post-body-paragraph lh li it lj b lk mn kd lm ln mo kg lp lq mp ls lt lu mq lw lx ly mr ma mb mc im bi translated">以下是运行网格搜索以找到statsmodel SARIMAX模型的最佳参数所需的所有代码。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="2940" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是输出的样子！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/4f155325db6af2a84e3248834c3ed9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kVE04oiDE5BVPC1Y_h-akg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="5d16" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于我的模型，当我将预测值与已知值进行比较时，二阶组合的BIC略高，但RMSE(均方根误差)较低。为此，我选择用列出的二阶组合来构建我的模型。</p><p id="bd17" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面是我们如何从上面的参数网格搜索中获取结果，并构建我们的模型！在此代码中，我们将:</p><ul class=""><li id="3b06" class="nt nu it lj b lk ll ln lo lq nv lu nw ly nx mc ny nz oa ob bi translated">建立我们的模型</li><li id="4021" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">打印摘要</li><li id="988a" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">绘制诊断图</li></ul><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="d9ac" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是我们的汇总输出的样子！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/41e354837e48d52c59d4e621969cbfdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z9yIPX4ehDSzvkKD8i6JzA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="3a53" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以看到这个模型的所有参数都很重要。情况并非总是如此，这些数据没有太多的可变性。</p><p id="90c5" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是我们的输出图诊断的样子！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/365bf6ce83d989f57a98b72ee93e91ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HeQdvApssqke77z6gfYhg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="f77b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们找到了。</p><p id="cbfd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我希望这个教程对你有用。一如既往，欢迎在评论中问我任何问题。</p><h2 id="b790" class="ms mt it bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj iz bi translated">参考</h2><ul class=""><li id="0ddc" class="nt nu it lj b lk nk ln nl lq oi lu oj ly ok mc ny nz oa ob bi translated">[1]<a class="ae ol" href="https://www.scribbr.com/statistics/akaike-information-criterion/" rel="noopener ugc nofollow" target="_blank">https://www . scribbr . com/statistics/a kaike-information-criterion/</a></li><li id="8b31" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">[2]<a class="ae ol" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/auto regressive _ integrated _ moving _ average</a></li><li id="224c" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">[3]<a class="ae ol" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.statespace.sarimax.SARIMAX.html" rel="noopener ugc nofollow" target="_blank">https://www . stats models . org/dev/generated/stats models . TSA . statespace . sarimax . sarimax . html</a></li></ul><h2 id="ecca" class="ms mt it bd mu mv mw dn mx my mz dp na lq nb nc nd lu ne nf ng ly nh ni nj iz bi translated">使用的软件</h2><ul class=""><li id="8ab5" class="nt nu it lj b lk nk ln nl lq oi lu oj ly ok mc ny nz oa ob bi translated">计算机编程语言</li><li id="37a1" class="nt nu it lj b lk oc ln od lq oe lu of ly og mc ny nz oa ob bi translated">Jupyter笔记本</li></ul></div></div>    
</body>
</html>