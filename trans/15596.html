<html>
<head>
<title>Master the Most Hated Task in DS/ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">掌握DS/ML中最讨厌的任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/master-the-most-hated-task-in-ds-ml-3b9779276d7c?source=collection_archive---------16-----------------------#2020-10-27">https://towardsdatascience.com/master-the-most-hated-task-in-ds-ml-3b9779276d7c?source=collection_archive---------16-----------------------#2020-10-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7a18" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">用熊猫清理数据</h2><div class=""/><div class=""><h2 id="e1e3" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用熊猫清理分类数据</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/af6970705ab5a7676849541df4b10bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqMRPPuSLdQoadxR2NtUug.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">照片由</strong> <a class="ae li" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd lh"> Pixabay </strong> </a> <strong class="bd lh">上</strong> <a class="ae li" href="https://www.pexels.com/photo/brown-wooden-floor-48889/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd lh">像素</strong> </a></p></figure><h2 id="5213" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">介绍</h2><p id="36d7" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">直接来自<a class="ae li" href="https://www.forbes.com/sites/gilpress/2016/03/23/data-preparation-most-time-consuming-least-enjoyable-data-science-task-survey-says/#718bbc696f63" rel="noopener ugc nofollow" target="_blank">福布斯</a>:</p><blockquote class="mx"><p id="385b" class="my mz it bd na nb nc nd ne nf ng mw dk translated">“数据科学家花60%的时间清理和组织数据。收集数据集排在第二位，占他们时间的19%，这意味着数据科学家花费大约80%的时间来准备和管理用于分析的数据。57%的数据科学家认为清理和组织数据是他们工作中最不愉快的部分，19%的人认为收集数据集是如此。</p></blockquote><p id="53b9" class="pw-post-body-paragraph me mf it mg b mh nh kd mj mk ni kg mm ls nj mo mp lw nk mr ms ma nl mu mv mw im bi translated">数据清理充满了挫折，令人厌恶的惊喜需要几个小时来处理，总是有新数据集的新问题，你能想到的都有。这个过程从来都不是令人愉快的，并且总是被认为是数据科学肮脏的一面。</p><p id="eaf6" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">尽管它经常被讨厌，但它可能是任何数据项目之前最重要的一步。如果没有正确解决数据问题，您可能会危及数据科学工作流程中的所有其他阶段。</p><p id="7d2a" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在我的数据清理系列的第二部分中没有太多介绍，让我们直奔主题。这篇文章是关于分类数据清理的。我将讨论处理一些中级分类数据问题的常见和不常见的方法。以下是总体概述:</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="a228" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">可点击的目录(仅限网络)</h2><p id="b8a3" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">∘ <a class="ae li" href="#5213" rel="noopener ugc nofollow">简介</a> <br/> ∘ <a class="ae li" href="#5141" rel="noopener ugc nofollow">设置</a> <br/> ∘ <a class="ae li" href="#7c0a" rel="noopener ugc nofollow">分类数据，了解并举例</a> <br/> ∘ <a class="ae li" href="#c351" rel="noopener ugc nofollow">处理分类数据问题</a> <br/> ∘ <a class="ae li" href="#ba2f" rel="noopener ugc nofollow">成员约束</a> <br/> ∘ <a class="ae li" href="#5777" rel="noopener ugc nofollow">值不一致</a> <br/> ∘ <a class="ae li" href="#64a4" rel="noopener ugc nofollow">将数据折叠成类别</a> <br/> ∘ <a class="ae li" href="#4293" rel="noopener ugc nofollow">减少类别数量</a></p><blockquote class="ny nz oa"><p id="b594" class="me mf ob mg b mh nm kd mj mk nn kg mm oc no mo mp od np mr ms oe nq mu mv mw im bi translated">你可以在<a class="ae li" href="https://github.com/BexTuychiev/medium_stories/tree/master/cleaning_categorical_data" rel="noopener ugc nofollow" target="_blank">这个</a> GitHub repo上获得本帖使用的笔记本和数据。</p></blockquote></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="5141" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">设置</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="7c0a" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">分类数据——理解和示例</h2><p id="967b" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">分类数据的正式定义是:</p><blockquote class="ny nz oa"><p id="e6fe" class="me mf ob mg b mh nm kd mj mk nn kg mm oc no mo mp od np mr ms oe nq mu mv mw im bi translated">一组预定义的可能的类别或组。</p></blockquote><p id="6def" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">您可以在几乎所有处理过的数据集中看到分类数据的例子。几乎任何类型的数据都可以转化为分类数据。例如:</p><ul class=""><li id="c6b4" class="oh oi it mg b mh nm mk nn ls oj lw ok ma ol mw om on oo op bi translated">调查反馈:</li><li id="89fd" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated"><code class="fe ov ow ox oy b">Yes</code>或<code class="fe ov ow ox oy b">No</code></li><li id="8316" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated"><code class="fe ov ow ox oy b">male</code>或<code class="fe ov ow ox oy b">female</code></li><li id="f4fb" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated"><code class="fe ov ow ox oy b">employed</code>或<code class="fe ov ow ox oy b">unemployed</code></li><li id="26be" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated">数字数据:</li><li id="7e02" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated">分组年收入:<code class="fe ov ow ox oy b">0-40k</code>，<code class="fe ov ow ox oy b">40-100k</code>，...</li><li id="24b7" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated">年龄:儿童，青少年，成人…</li></ul><p id="eef2" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">当我们使用<code class="fe ov ow ox oy b">panads</code>库学习数据清理时，理解<code class="fe ov ow ox oy b">pandas</code>永远不会将分类数据作为分类导入是很重要的。它通常以字符串或整数的形式导入:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="028d" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">您可以看到<code class="fe ov ow ox oy b">cut</code>、<code class="fe ov ow ox oy b">color</code>和<code class="fe ov ow ox oy b">clarity</code>是作为字符串而不是类别导入的。我们可以像这样使用<code class="fe ov ow ox oy b">read_csv</code>的<code class="fe ov ow ox oy b">dtype</code>参数:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">你可以通过这个<a class="ae li" href="https://www.kaggle.com/shivam2503/diamonds/download" rel="noopener ugc nofollow" target="_blank">链接</a>从Kaggle下载这个版本的“钻石”数据集。</p></figure><p id="00c8" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">但是对于真实世界的数据集，您通常没有这种奢侈，因为您将要处理的数据可能会有许多分类变量，并且通常您一开始会对这些数据完全不熟悉。</p><p id="8af2" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在确定分类变量之后，在将列转换为分类变量之前，需要进行一些检查和清理。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="c351" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">处理分类数据问题</h2><p id="b55c" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">当您处理真实世界的数据时，它将充满清理问题。</p><p id="2d7b" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">正如我在本系列的第一部分中所写的，收集数据的人不会考虑数据的干净程度，尽可能以简单的方式记录必要的信息。</p><p id="0bfa" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">此外，由于收集过程中的自由文本会导致输入错误、相同值的多个表示等，因此会出现问题。也有可能是因为数据解析错误或糟糕的数据库设计而引入错误。</p><p id="63b4" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">例如，考虑这种最坏的情况:您正在处理一个在美国进行的调查数据，数据集中的每个观察状态都有一个<code class="fe ov ow ox oy b">state</code>列。美国有50个州，想象一下人们能想出的各种州名。如果数据收集者决定使用缩写，你的问题就更大了:</p><ul class=""><li id="84fb" class="oh oi it mg b mh nm mk nn ls oj lw ok ma ol mw om on oo op bi translated">加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚，加利福尼亚…</li></ul><p id="c23f" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">这样的栏目总是充满了错别字、错误和不一致。永远不要想象你会有一个平滑的一对一的类别映射。</p><p id="b434" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在继续分析之前，您必须建立所谓的成员约束，它清楚地定义了类别的数量以及它们如何以单一格式表示。</p></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="ba2f" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">成员限制</h2><p id="bdae" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">有三种方法可以处理分类数据问题:</p><ul class=""><li id="411d" class="oh oi it mg b mh nm mk nn ls oj lw ok ma ol mw om on oo op bi translated">落下</li><li id="f4a7" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated">重新映射类别</li><li id="f553" class="oh oi it mg b mh oq mk or ls os lw ot ma ou mw om on oo op bi translated">推断类别</li></ul><p id="8d77" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">首先，我们将集中于隔离不一致的观察值并丢弃它们。我创建了假数据来说明代码是如何实现的:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl oz"><img src="../Images/f1a88886b546a9d7bf4d51fe1c8da677.png" data-original-src="https://miro.medium.com/v2/format:webp/1*-eZE85Fn0hNfBj22H1rE_w.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">您可以看到我写的简短脚本，它从我在文章开头分享的GitHub repo中生成这个数据集</p></figure><p id="3b86" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">通常情况下，您会有一些关于您的数据的背景信息。例如，假设您想要检查上述数据框的<code class="fe ov ow ox oy b">blood_type</code>列中的不一致。你事先发现<code class="fe ov ow ox oy b">blood_type</code>只能有这几类:<strong class="mg jd">【A+，A-，B+，B-，O+，O-，AB+，A B-】</strong>。因此，您必须确保数据源中的列只包含这些值。</p><p id="b139" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在我们的例子中，有10k行，视觉搜索不一致是不可行的，这也是许多其他真实数据的情况。以下是如何实现此类问题的最佳解决方案:</p><p id="faed" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">首先，您应该创建一个新的数据框来保存分类列的所有可能值:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl oz"><img src="../Images/f2d08bb8ce5d9edac45ab0e20216978f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*vaFauanzXG1wGo0OFiE2_g.png"/></div></figure><blockquote class="ny nz oa"><p id="e380" class="me mf ob mg b mh nm kd mj mk nn kg mm oc no mo mp od np mr ms oe nq mu mv mw im bi translated"><strong class="mg jd"> <em class="it"> PRO提示:</em> </strong>创建这样的数据框是一个很好的实践，它保存主数据中每个分类列的类别映射。</p></blockquote><p id="5618" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">由于我们现在在一个单独的数据框中有了正确的类别，我们可以使用一个基本的集合操作，它给出了两列中唯一值的差异:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="a599" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">为了得到两个集合之间的差异，我们使用<code class="fe ov ow ox oy b">.difference</code>函数。它基本上返回左集中不在右集中的所有值。这里有一个非常简单的例子:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="7b85" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">细心的读者可能已经注意到，在<code class="fe ov ow ox oy b">set</code>函数内部，我还在<code class="fe ov ow ox oy b">blood_type</code>上调用了<code class="fe ov ow ox oy b">.unique()</code>。从我从一个StackOverflow线程中读到的内容来看，如果对较大的数据集同时使用<code class="fe ov ow ox oy b">set</code>和<code class="fe ov ow ox oy b">unique</code>，获取唯一值所需的时间似乎会短得多。</p><p id="f36c" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">现在，我们将筛选血型“C+”和“D-”的主要数据:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="468c" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在<code class="fe ov ow ox oy b">blood_type</code>上使用<code class="fe ov ow ox oy b">isin</code>将返回一个布尔序列，我们可以用它来索引数据帧:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl oz"><img src="../Images/15d61156b98bbc90770b1246c9425ffe.png" data-original-src="https://miro.medium.com/v2/format:webp/1*SpiyUYFuPD_Y1F9xGnmOWw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">90行x 6列。不知何故x变成了俄语в🤷‍♂️</p></figure><p id="761e" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">所以，有90个人血型不正确。因为我们不知道这些错误是如何发生的(我做到了😁😁😁)，我们不得不放弃他们。有两种方法可以做到:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="80a5" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">因为我们的列现在是干净的，所以可以安全地将其设置为分类变量:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><blockquote class="ny nz oa"><p id="f4d6" class="me mf ob mg b mh nm kd mj mk nn kg mm oc no mo mp od np mr ms oe nq mu mv mw im bi translated">一定要看看这个系列的第一部。在那里，我讨论了基本和常见的数据问题。您还将熟悉我将在这里使用的一些功能。</p></blockquote><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/data-type-constraints-data-range-constraints-duplicate-data-with-pandas-44897a350b1e"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">掌握DS/ML中最耗时的任务，#1</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">处理常见的数据问题</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr lb pd"/></div></div></a></div></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="5777" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">价值不一致</h2><p id="b9d6" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">就像我们在第二节中谈到的，在数据集中可能有许多相同类别的表示。这些错误可能仅仅是因为简单的错别字、随意的大写字母，等等。继续清理我们的数据，轮到了<code class="fe ov ow ox oy b">marriage_status</code>列:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="419c" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">对数据框列使用<code class="fe ov ow ox oy b">value_counts</code>会返回该列中唯一值的计数。如果您查看结果，您可以立即看到问题。这些值应该是小写或大写。我更喜欢小写:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="884b" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">对数据框列使用<code class="fe ov ow ox oy b">.str</code>使我们能够对列的每个值使用所有Python字符串函数。这里，我们使用<code class="fe ov ow ox oy b">.lower()</code>将字符串转换成小写。</p><p id="e4ce" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated"><code class="fe ov ow ox oy b">value_counts</code>仍在返回6个唯一值，为什么？仔细观察后，您会发现其中一个类别有额外的前导空格。这就是为什么它被视为一个单独的类别。对于其中一个<code class="fe ov ow ox oy b">unmarried</code>也是如此，它可能有尾随空格。我们可以使用string <code class="fe ov ow ox oy b">strip</code>函数来去除字符串中的尾随空格:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="2218" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">现在柱子干净了。剩下要做的就是将该列转换成category数据类型:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="64a4" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">将数据分类</h2><p id="41da" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">有时，您可能想要获取已经存在的数据，通常是数字数据，并从中生成类别。这在许多情况下是有用的。</p><p id="ca53" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">在我们的<code class="fe ov ow ox oy b">demographics</code>数据集中，我们有一个年收入列。将这一栏分成不同的收入组可能是有用的，因为这样做可能会对数据提供一些额外的见解。</p><p id="414e" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated"><code class="fe ov ow ox oy b">pandas</code>对此有一个完美的函数:<code class="fe ov ow ox oy b">cut</code>。它使我们能够将数字范围(如数据框列)切割成箱，并给它们定制标签。让我们来看看它的实际应用:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl oz"><img src="../Images/adb2eef97736984a719a441529356403.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TXOODdF_nskHiiDE3MVvcA.png"/></div></figure><p id="b3ad" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">现在，我们可以使用像<code class="fe ov ow ox oy b">value_counts</code>这样的函数来获得更多的洞察力:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="a5dd" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">您也可以绘制计数图:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="ab gu cl oz"><img src="../Images/0e5cdcaebd84aba9f6b62d5987548f81.png" data-original-src="https://miro.medium.com/v2/format:webp/1*6wnLqAqp_oCn2evixPn7Og.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">这是随机生成的数据，这就是为什么酒吧的高度几乎相同。</p></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h2 id="4293" class="lj lk it bd ll lm ln dn lo lp lq dp lr ls lt lu lv lw lx ly lz ma mb mc md iz bi translated">减少类别的数量</h2><p id="d3e0" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">有时，可能会有不必要的类别。在这种情况下，您可以将较小的类别折叠成更大的类别，这样可能更适合您的需要。考虑我们数据的<code class="fe ov ow ox oy b">device</code>栏:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="9053" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">把手机的操作系统和电脑的相比没有多大用处。更好的做法是将类别减少为<code class="fe ov ow ox oy b">mobileOS</code>和<code class="fe ov ow ox oy b">desktopOS</code>。为此，首先，我们需要创建一个字典，将每个类别映射到新的类别:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="1c1d" class="pw-post-body-paragraph me mf it mg b mh nm kd mj mk nn kg mm ls no mo mp lw np mr ms ma nq mu mv mw im bi translated">然后，我们使用<code class="fe ov ow ox oy b">pandas</code>的<code class="fe ov ow ox oy b">replace</code>函数，它动态地映射出新的类别:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="of og l"/></div></figure></div><div class="ab cl nr ns hx nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="im in io ip iq"><h1 id="c3c2" class="ps lk it bd ll pt pu pv lo pw px py lr ki pz kj lv kl qa km lz ko qb kp md qc bi translated">如果你喜欢这篇文章，请分享并留下反馈。作为一名作家，你的支持对我来说意味着一切！</h1><p id="4647" class="pw-post-body-paragraph me mf it mg b mh mi kd mj mk ml kg mm ls mn mo mp lw mq mr ms ma mt mu mv mw im bi translated">阅读更多与主题相关的文章:</p><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">认识熊猫最难的功能，第一部分</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">掌握pivot_table()、stack()、unstack()的时机和方式</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qd l po pp pq pm pr lb pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">认识熊猫最难的功能，第二部分</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">掌握交叉表的时间和方式()</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qe l po pp pq pm pr lb pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">认识熊猫最难的功能，第三部分</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">形状像果冻的桌子有熊猫旋转()和融化()</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qf l po pp pq pm pr lb pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/how-i-customarily-bin-data-with-pandas-9303c9e4d946"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">我习惯如何将数据与熊猫绑定</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">您可能只使用了默认值</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qg l po pp pq pm pr lb pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/data-type-constraints-data-range-constraints-duplicate-data-with-pandas-44897a350b1e"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">掌握DS/ML中最耗时的任务，#1</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">处理常见的数据问题</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr lb pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd jd gy z fp pi fr fs pj fu fw jc bi translated">来自Kagglers:DS和ML的最佳项目设置</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">来自顶级Kagglers的项目成功最佳实践的集合</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qh l po pp pq pm pr lb pd"/></div></div></a></div></div></div>    
</body>
</html>