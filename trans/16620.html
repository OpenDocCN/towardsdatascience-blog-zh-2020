<html>
<head>
<title>The Rule of Three: calculating the probability of events that have not yet occurred</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">规则三:计算尚未发生的事件的概率</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-rule-of-three-calculating-the-probability-of-events-that-have-not-yet-occurred-106144dc2c39?source=collection_archive---------21-----------------------#2020-11-16">https://towardsdatascience.com/the-rule-of-three-calculating-the-probability-of-events-that-have-not-yet-occurred-106144dc2c39?source=collection_archive---------21-----------------------#2020-11-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="f34e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="c4ed" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我们有多大把握让加州、纽约等蓝色州。下次选举不要变红？</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0bbe3865ecf59161bc189a5f2fb3fb0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-gRw3ZEXSqAMj8viFYX8Bg.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">前总统巴拉克·奥巴马的第二次就职演说(2013年)。由<a class="ae lh" href="https://unsplash.com/@dyanawingso?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Dyana Wing So </a>在<a class="ae lh" href="https://unsplash.com/s/photos/democrat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3728" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">作者注:我正在尝试一种更短的文章形式，旨在介绍有趣的统计事实和经验法则。让我知道你如何喜欢他们。如需更深入的分析:</p><ul class=""><li id="4be4" class="mf mg it lk b ll lm lo lp lr mh lv mi lz mj md mk ml mm mn bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/how-bayesian-statistics-convinced-me-to-hit-the-gym-fa737b0a7ac">贝叶斯统计如何说服我去健身房？</a></li><li id="657f" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/making-big-bucks-with-a-data-driven-sports-betting-strategy-6c21a6869171">利用数据驱动的体育博彩策略赚大钱</a></li><li id="0ad4" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/a-bayesian-quest-to-find-god-b30934972473">寻找上帝的贝叶斯探索</a></li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="5310" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">又是一个选举周期，又是一次我们对总体结果感到困惑的时候。任何一方都没有井喷。选举是一场扣人心弦的比赛。民主党人和共和党人在几次竞选中都取得了意想不到的进展。</p><p id="0839" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">面对每个选举周期不断上升的不确定性，我的一个朋友欢呼道:</p><blockquote class="na nb nc"><p id="8eda" class="li lj me lk b ll lm kd ln lo lp kg lq nd ls lt lu ne lw lx ly nf ma mb mc md im bi translated">我们可以确定的一件事是，加州从来没有，也永远不会变红。</p></blockquote><p id="a615" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，这在历史上是不正确的——加州在1992年大选前一直支持红色。我的朋友必须将他的观察限定为“他观察的[自1992年以来的]选举”，或者如果他将地点改为哥伦比亚特区。然而，如果他知道即使在这次选举中，加利福尼亚州1000万张选票中有三分之一投给了特朗普总统，他对自己的预测仍会不太有信心。仅仅因为我们[表面上]观察到一个地方是一个民主堡垒，并不意味着它在未来不会变红，反之亦然。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ng"><img src="../Images/6a836183ed9adb606b07f586094b8622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcYgcqvujDAYL1mcEs-sKA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@claybanks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">粘土堤</a>在<a class="ae lh" href="https://unsplash.com/s/photos/vote?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="f17f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我朋友所做的预测是一种非常常见的心理归纳，我们每天都在练习。就像飞机不应该坠毁一样，智齿拔除不应该造成神经损伤，卫冕英超冠军也不应该因为一支在英国足球第五梯队打滚的球队而沮丧。然而，在现实中，这些事情确实发生了。仅仅因为我在过去的10年里没有骑摩托车遇到任何事故，并不意味着事故的风险为零。</p><p id="f238" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">问题是:<strong class="lk jd"> <em class="me">我们能否量化尚未发生的事情的概率？</em> </strong>理想情况下，我们会想给罕见事件分配一个概率，但是这些事件的分子是0，我们无能为力。在这些情况下，量化风险大小的一个简便方法叫做三个的<strong class="lk jd">法则:</strong></p><blockquote class="nh"><p id="7474" class="ni nj it bd nk nl nm nn no np nq md dk translated"><em class="nr">如果某一事件在有n名受试者的样本中没有发生，则从0到3的区间</em><strong class="ak"><em class="nr">/n</em></strong><em class="nr">为总体中发生率的95%置信区间。</em></p></blockquote><p id="6783" class="pw-post-body-paragraph li lj it lk b ll ns kd ln lo nt kg lq lr nu lt lu lv nv lx ly lz nw mb mc md im bi translated">这里需要注意的一点是，观察的样本越小，置信区间越宽，这意味着小样本的置信区间上限大于大样本的置信区间上限。但是，如果说在一个小的系列中，不良事件发生的真实概率更大，那就错了。</p><h1 id="2399" class="nx ny it bd nz oa ob oc od oe of og oh ki oi kj oj kl ok km ol ko om kp on oo bi translated"><strong class="ak">它是如何工作的？</strong></h1><p id="fe3c" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated">这个规则的证明很简单，用<em class="me"> X </em>表示事件的数量，用<em class="me"> p </em>表示我们观察到一个不良事件的概率(<em class="me"> p </em>接近于0)，我们要找到给出Pr( <em class="me"> X </em> = 0) ≤ 0.05的<em class="me"> n </em>观察的二项分布的参数<em class="me"> p </em>的值。</p><p id="beba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，我们需要求解<em class="me"> p </em>，这样:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/cfec9009bddbbc4b8b4e67a72f87890b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*Q90VNucSeu9nyZ0H3dGV4g.png"/></div></figure><p id="17ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后我们可以通过使用Maclaurin级数来近似实体ln(1- <em class="me"> p </em>，它是函数<em class="me"> f(x) </em>在<em class="me"> a = </em> 0处的泰勒展开式的求值</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/de80dd8169f588707266d30634869c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qyk1EICJrZbYWJkTXeONKQ.png"/></div></div></figure><p id="0361" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">将此应用于ln(1- <em class="me"> p </em>，我们得到:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ow"><img src="../Images/cd55aa0f5ede7c38087deef7ef72b168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RI6o3lZQbcL-bC-rYhbhFQ.png"/></div></div></figure><p id="0ab4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这样，我们就有了<em class="me"> -np </em> ≤ -2.996或者<em class="me"> p </em> ≤ 3/ <em class="me"> n </em>。</p><p id="aa76" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">快速模拟:</strong></p><p id="6fd9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然数学很简单明了，但为了证明它确实有效，我们可以尝试运行一个简单的模拟:</p><ul class=""><li id="9ada" class="mf mg it lk b ll lm lo lp lr mh lv mi lz mj md mk ml mm mn bi translated">想象一下我们在生产线上测试缺陷。假设我们知道缺陷概率是<em class="me"> p </em> = 0.001</li><li id="cc39" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">我们一个接一个地测试每一个下线的产品，直到我们遇到一个缺陷(测试号<em class="me"> n+1 </em>)。</li><li id="28b4" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">然后，我们制作一个由0和3/n 限定的置信区间<strong class="lk jd">，并记下它。我们检查置信区间是否包含缺陷p = 0.001的真实概率。</strong></li><li id="873f" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">我们重复这个过程很多次，例如100，000次迭代</li></ul><p id="a6fa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是一段R代码:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="ab7a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如你所看到的，从长远来看，大约95%的区间<strong class="lk jd">【0，3/<em class="me">n</em></strong>这样的区间应该包含真正的潜在缺陷概率。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/db561476fe9a3bad4eef5932b1f583bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*aTtv_Qx-Iz4mMm1cRI1oWw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">模拟的直方图。红线显示了故障的真实概率(p=0.001)。我们看到红线右侧的面积总计为95%，这意味着在95%的情况下，我们在这个过程中获得的置信度包含了真正的潜在缺陷概率。</p></figure><p id="c850" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">回到原问题:</strong></p><p id="581d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">所以让我们回到最初的问题:让我们忘记1992年之前的所有选举。由于我们没有观察到加州在过去8次选举中投票支持红色，使用三的规则，我们可以推断出加州走向红色的95%置信区间在0和3/8 = 37.5%之间。对于哥伦比亚特区，它将是[0，3/15= 20%]。</p><p id="f404" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">需要说明的是，这是一个有趣的例子，为了让它起作用，我必须在这里做一些全面的假设，可能没有一个是正确的。</p><ul class=""><li id="fc69" class="mf mg it lk b ll lm lo lp lr mh lv mi lz mj md mk ml mm mn bi translated">(1)我们假设每个选举结果都是相互独立的。这在很大程度上是不真实的，因为我们知道一个选举结果至少可以影响地区地图或者激发下一次选举的投票率，等等。</li><li id="9850" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">(2)有一个潜在的、固定的州投票给红色的概率，这可能是不真实的<em class="me"/>，因为我们知道，该州的人口统计、经济前景和人民情绪在很大程度上影响着政党归属和结果如何产生，并一直在变化。</li><li id="7e16" class="mf mg it lk b ll mo lo mp lr mq lv mr lz ms md mk ml mm mn bi translated">(3)对于加州，我们忽略1992年之前的所有选举。如果我们包括以前的数据，在这种罕见的事件确实发生过的地方[但它并不罕见，因为加利福尼亚在1990年以前被认为是一个红色的州]，三的规则就不应该被使用[然而华盛顿没有这个问题]</li></ul><p id="e41a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">一个实际的用例:</strong></p><p id="9572" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那么三法则实际上是用来做什么的呢？非常受欢迎的使用案例是在许可前临床试验中，不良事件发生率非常低，例如疫苗开发项目。通常，10，000名受试者范围内的样本量可被认为足以确定新疫苗的保护效力，但不足以检测更罕见的事件或并发症。</p><p id="d0d7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果在涉及10，000人的许可前临床项目中没有观察到任何特定类型的事件，则可以估计该事件发生率的上限为3/10，000。实际的并发症发生率，即发生频率低于疫苗靶向疾病的发生率，只能通过一些可靠的上市后监测系统来检测。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="625e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，下次你的牙医说他从未失败过一个手术时，你知道该怎么做:问他服务过多少病人，用三法则找到他失败率的置信区间，看看你对上限有多满意。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="6982" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在<a class="ae lh" href="https://github.com/tuangauss/DataScienceProjects/blob/master/R/RuleOfThree.R" rel="noopener ugc nofollow" target="_blank">我的Github页面</a>找到这篇文章的代码。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="dfb1" class="nx ny it bd nz oa pa oc od oe pb og oh ki pc kj oj kl pd km ol ko pe kp on oo bi translated">参考资料:</h1><p id="87db" class="pw-post-body-paragraph li lj it lk b ll op kd ln lo oq kg lq lr or lt lu lv os lx ly lz ot mb mc md im bi translated">【1】<a class="ae lh" href="https://www.nytimes.com/2020/11/06/us/california-blue-state-democrat.html" rel="noopener ugc nofollow" target="_blank">为什么加州是一个蓝色的州？</a></p><p id="f3c8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[2] <a class="ae lh" href="https://www.latimes.com/projects/2020-california-election-proposition-analysis/" rel="noopener ugc nofollow" target="_blank">今年的投票措施如何显示加州日益扩大的政治分歧</a></p></div></div>    
</body>
</html>