<html>
<head>
<title>Support Vector Machine (SVM) for Anomaly Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">支持向量机(SVM)用于异常检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/support-vector-machine-svm-for-anomaly-detection-73a8d676c331?source=collection_archive---------3-----------------------#2020-10-17">https://towardsdatascience.com/support-vector-machine-svm-for-anomaly-detection-73a8d676c331?source=collection_archive---------3-----------------------#2020-10-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4ca9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用于异常检测的小数据科学</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a471de0f735a1d2aaa92f4063b7a6bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xInd93JIVtR4FuXJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@unstable_affliction?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">伊万·班杜拉</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h2 id="c6c7" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">一级SVM:简介</strong></h2><p id="91f9" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">作为机器学习的专家或新手，你可能听说过支持向量机(SVM)——一种经常被引用并用于分类问题的监督机器学习算法。支持向量机使用多维空间中的超平面来将一类观察值与另一类分离。自然，SVM用于解决多类分类问题。</p><p id="2c16" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然而，SVM也越来越多地用于一类问题，其中所有数据都属于一个类。在这种情况下，算法被训练来学习什么是“正常的”，以便当显示新数据时，算法可以识别它是否应该属于该组。如果不是，新数据被标记为异常或异常。要了解更多关于一级SVM的信息，请查看Roemer Vlasveld 的这篇长文。</p><p id="251e" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后要提的是，如果你熟悉<code class="fe mt mu mv mw b">sklearn</code>库，你会注意到有一个算法是专门为所谓的“<a class="ae ky" href="https://scikit-learn.org/stable/modules/outlier_detection.html" rel="noopener ugc nofollow" target="_blank">新奇检测</a>”设计的。它的工作方式与我刚刚在使用一类SVM的异常检测中描述的方式类似。在我看来，只是上下文决定了是否称之为新奇检测或异常检测或类似的东西。</p><p id="b0d0" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">今天的文章是我的异常、异常值和欺诈检测算法系列的继续，并附有实际操作的示例代码。我之前的7篇文章谈到了异常检测领域中可用的不同工具和技术，如果您有兴趣了解它们，请访问以下链接:</p><ul class=""><li id="ebce" class="mx my it lx b ly mo mb mp li mz lm na lq nb mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/dbscan-a-density-based-unsupervised-algorithm-for-fraud-detection-887c0f1016e9"> DBSCAN，一种无监督算法</a></li><li id="fa73" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/machine-learning-for-anomaly-detection-elliptic-envelope-2c90528df0a6">椭圆形信封</a></li><li id="6e04" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/anomaly-detection-with-local-outlier-factor-lof-d91e41df10f2">局部异常值因子(LOF) </a></li><li id="bb38" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/z-score-for-anomaly-detection-d98b0006f510"> Z分数</a></li><li id="af21" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/boxplot-for-anomaly-detection-9eac783382fd">箱线图</a></li><li id="c564" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/statistical-techniques-for-anomaly-detection-6ac89e32d17a">统计技术</a></li><li id="c6ac" class="mx my it lx b ly ng mb nh li ni lm nj lq nk mn nc nd ne nf bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/time-series-anomaly-detection-with-anomalize-library-67472003c003">时间序列异常检测</a></li></ul><p id="2af6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">下面是一个用Python编程语言编写的单类SVM的简单演示。请注意，我将异常值和异常值互换使用。</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h2 id="dbfc" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">步骤1:导入库</strong></h2><p id="e995" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">对于这个演示，我们需要三个核心库——数据处理库<code class="fe mt mu mv mw b">python</code>和<code class="fe mt mu mv mw b">numpy</code>，模型构建库<code class="fe mt mu mv mw b">sklearn</code>和可视化库<code class="fe mt mu mv mw b">matlotlib</code>。</p><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="27fe" class="kz la it mw b gy nw nx l ny nz"># import libraries<br/>import pandas as pd<br/>from sklearn.svm import OneClassSVM<br/>import matplotlib.pyplot as plt<br/>from numpy import where</span></pre><h2 id="8e54" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤2:准备数据</h2><p id="760e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我使用的是网上著名的虹膜数据集，所以你可以跟着练习，不用担心从哪里得到数据，如何清理这些数据。</p><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="0258" class="kz la it mw b gy nw nx l ny nz"># import data<br/>data = pd.read_csv("<a class="ae ky" href="https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/uiuc-cse/data-fa14/gh-pages/data/iris.csv</a>")</span><span id="6370" class="kz la it mw b gy oa nx l ny nz"># input data<br/>df = data[["sepal_length", "sepal_width"]]</span></pre><h2 id="e0be" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第三步:建模</h2><p id="6b1e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">与其他分类算法中的超参数调整不同，一类SVM使用<em class="ob"> nu </em>作为超参数，用于定义数据的哪一部分应被归类为异常值。<em class="ob"> nu </em> = 0.03表示算法会将3%的数据指定为异常值。</p><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="cc72" class="kz la it mw b gy nw nx l ny nz"># model specification<br/>model = OneClassSVM(kernel = 'rbf', gamma = 0.001, nu = 0.03).fit(df)</span></pre><h2 id="5ea4" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第四步:预测</h2><p id="84e6" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">预测数据集将具有1或-1值，其中-1值是算法检测到的异常值。</p><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="9dd7" class="kz la it mw b gy nw nx l ny nz"># prediction<br/>y_pred = model.predict(df)<br/>y_pred</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/39ee6779de8be016494ef7c75882925a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*j-Y18Dh_jprkEnQf6vf9Dg.png"/></div></figure><h2 id="8547" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤5:过滤异常</h2><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="cda3" class="kz la it mw b gy nw nx l ny nz"># filter outlier index<br/>outlier_index = where(y_pred == -1) </span><span id="ce5c" class="kz la it mw b gy oa nx l ny nz"># filter outlier values<br/>outlier_values = df.iloc[outlier_index]<br/>outlier_values</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7f26e7faa1549679603b8779a5664935.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*jDcYMGxNu1Gvr3Cm_oxsQQ.png"/></div></figure><h2 id="9a75" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">步骤6:可视化异常</h2><pre class="kj kk kl km gt ns mw nt nu aw nv bi"><span id="c016" class="kz la it mw b gy nw nx l ny nz"># visualize outputs<br/>plt.scatter(data["sepal_length"], df["sepal_width"])<br/>plt.scatter(outlier_values["sepal_length"], outlier_values["sepal_width"], c = "r")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fc082bf961def8db7d2b46f25f3a6353.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*JZQ12l1ELBl1AzgL85bOQA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">红色的数据点是异常值</p></figure><h2 id="2a3f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">摘要</h2><p id="1d6b" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在这篇文章中，我想温和地介绍一下单类SVM——一种用于欺诈/异常值/异常检测的机器学习算法。我展示了一些简单的步骤来建立直觉，但是当然，现实世界的实现需要更多的实验来发现什么对特定的环境和行业有效，什么无效。</p><p id="5354" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">感谢你的关注，要了解更多关于我的工作，你可以在推特<a class="ae ky" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank">或LinkedIn </a>上关注我</p></div></div>    
</body>
</html>