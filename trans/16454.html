<html>
<head>
<title>FedSpeak — How to build a NLP pipeline to predict central bank policy changes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FedSpeak——如何构建NLP管道来预测央行政策变化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fedspeak-how-to-build-a-nlp-pipeline-to-predict-central-bank-policy-changes-a2f157ca0434?source=collection_archive---------16-----------------------#2020-11-13">https://towardsdatascience.com/fedspeak-how-to-build-a-nlp-pipeline-to-predict-central-bank-policy-changes-a2f157ca0434?source=collection_archive---------16-----------------------#2020-11-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="824f" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><div class=""><h2 id="47c1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">用深度神经网络分析决策者谈话指南</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1ec8cdd9ce8eb4503e7df516851673f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N3BTgVL2X5pVAkBkEAq4rQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">(图片由作者创作)</p></figure><h1 id="e3bf" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">介绍</h1><p id="fcaa" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">这篇博客描述了我如何在过去的项目中通过NLP技术分析央行政策。源代码可在<a class="ae mv" href="https://github.com/yuki678/centralbank_analysis" rel="noopener ugc nofollow" target="_blank"> github repo </a>获得。</p><h1 id="de9b" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">商业背景</h1><p id="d243" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">FOMC有八次例会来决定货币政策。每次会议，它都在<a class="ae mv" href="https://www.federalreserve.gov/monetarypolicy/fomccalendars.htm" rel="noopener ugc nofollow" target="_blank">网站</a>上发布新闻发布会的记录、声明以及脚本。除了这种定期会议，成员的发言和证词也在网站上。</p><p id="4749" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">在会议上，政策制定者讨论、投票和决定货币政策，并公布决定以及他们对当前经济形势和预测的看法，包括2012年以来的前瞻性指导。各国央行打算在其出版物中表明其潜在的未来货币政策，以此作为市场沟通的一种手段。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/f4e2163116981636ef2e7b52f51d0912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNVg1CamJp0XyhphQIFpTA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">预测输入(由作者创建)</p></figure><p id="d5da" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这个项目的目标是在FOMC出版的文本中发现潜在的特征。首先，我将机器学习应用于经济指数，以观察这些数字数据的预测性能。然后，在传统的机器学习技术中加入预处理过的文本数据作为附加特征，看它是否包含有意义的信息。最后，应用深度学习技术，如LSTM/RNN和伯特，看看这些能否更好地预测每次FOMC会议上的加息/降息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/da5ede1e5e81b1846ddd94dd972f5b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKALHpmbZ0cIrb_djbci-w.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">该项目的整个过程(由作者创建)</p></figure><h1 id="aa66" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">1.检索市场数据</h1><p id="7a78" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">每日美联储利率和主要经济指数可以从圣路易斯联邦储备银行的经济研究网站获得，该网站名为<a class="ae mv" href="https://fred.stlouisfed.org/" rel="noopener ugc nofollow" target="_blank"> FRED </a>:</p><ul class=""><li id="30a9" class="nd ne it mb b mc mw mf mx mi nf mm ng mq nh mu ni nj nk nl bi translated">联邦利率</li><li id="fb46" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated">国内生产总值</li><li id="765a" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated">消费物价指数/ PCE</li><li id="f754" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated">就业和失业</li><li id="a1d7" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated">零售和家庭销售</li></ul><p id="ed54" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">制造业PMI和服务业PMI(原名“非制造业指数或NMI”)由<a class="ae mv" href="https://www.ismworld.org/supply-management-news-and-reports/reports/ism-report-on-business/" rel="noopener ugc nofollow" target="_blank"> ISM(供应管理学会)网站</a>发布。</p><p id="54db" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">每日国债收益率可以从<a class="ae mv" href="https://www.treasury.gov/resource-center/data-chart-center/interest-rates/pages/textview.aspx?data=yield" rel="noopener ugc nofollow" target="_blank">美国财政部网站</a>以xml格式下载。</p><p id="69de" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">探索每个网站上的数据细节很好，但使用<a class="ae mv" href="https://www.quandl.com/" rel="noopener ugc nofollow" target="_blank"> Quandl </a>更方便，它提供了Web APIs和库，以相同的方式检索所有数据。以上所有数据都是公开的，个人使用也是免费的，但是你应该根据你的目标，在原始资料中检查许可条款。</p><p id="e689" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">一旦创建了Quandl帐户，就会提供API密钥。例如，您可以像这样在<code class="fe nr ns nt nu b">pip install quandl</code>之后下载python中的数据:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="8cbd" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">2008年，美联储将目标联邦利率从单一利率改为一个区间，因此串联两个区间证明了下限或上限观点。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nx"><img src="../Images/e99b7b6d565ee9e55bd20148018eea74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z6jlva1otpPAu6s8SRsnOg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">联邦基金利率，目标下限(由作者创建)</p></figure><h1 id="6895" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">2.检索文本数据</h1><p id="4056" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">所有FOMC的出版物都可以在<a class="ae mv" href="https://www.federalreserve.gov/monetarypolicy/fomccalendars.htm" rel="noopener ugc nofollow" target="_blank"> FOMC网站</a>上找到。你可能会注意到网站包含每次会议的材料，但内容会随着时间的推移而变化。此外，除了常规会议之外，还有不定期的会议和电话会议。一些文本是html格式的，而另一些则是pdf格式的。甚至还有一个不同的历史数据网站，页面结构也各不相同。</p><p id="1865" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">从FOMC会议日历下载以下文本:</p><ul class=""><li id="bf04" class="nd ne it mb b mc mw mf mx mi nf mm ng mq nh mu ni nj nk nl bi translated"><strong class="mb jd">声明</strong> —在每次FOMC会议后立即发布</li><li id="53a7" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated"><strong class="mb jd">会议纪要</strong> —在每次FOMC会议后三周提供，因此可能无法用于最近的会议</li><li id="ec14" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated"><strong class="mb jd">新闻发布会记录</strong>——每次FOMC会议都有，但2011年才开始提供</li><li id="ad00" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated"><strong class="mb jd">会议记录</strong> —会议五年后可用，因此不能用作预测的输入，但仍是查看旧会议详细背景的良好来源</li><li id="0794" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated"><strong class="mb jd">演讲</strong> —文字记录发表在<a class="ae mv" href="https://www.federalreserve.gov/newsevents/speeches.htm" rel="noopener ugc nofollow" target="_blank">这一页</a>，我使用了两次会议之间发表的主席演讲</li><li id="5be8" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu ni nj nk nl bi translated"><strong class="mb jd">证词</strong> —各种证词文本也发表在<a class="ae mv" href="https://www.federalreserve.gov/newsevents/testimony.htm" rel="noopener ugc nofollow" target="_blank">这一页</a>我用半年度货币政策报告向国会报告</li></ul><p id="498d" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">当文本是HTML格式时，BeautifulSoup将完成这项工作。使用textract提取PDF和re模块，通过正则表达式进行搜索。</p><h1 id="1a2a" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">3.初步分析</h1><p id="b2d3" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">为了看看这些文本是否包含一些预测美联储利率的有用见解，我使用了<a class="ae mv" href="https://sraf.nd.edu/textual-analysis/resources/" rel="noopener ugc nofollow" target="_blank">拉夫兰和麦当劳情绪词表</a>来衡量声明的情绪。这本字典包含几千个出现在财务文件中的单词，如10K，10Q和收益电话，分为积极，消极等。它包括不同形式的单词，因此不应应用词干分析或词条解释。我运用了一个简单的技巧将情绪转化为否定(例如，不能，不是，不)。请注意，您需要获得必要的商业使用许可证。</p><p id="1139" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">首先，画出每句话中正面词和负面词的数量，取其差值作为净情绪。正字数和负字数高度相关，平均值为正。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/13b3077b1e88b15e8957f489c71f16ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*td1qja35m44LOPC02gMNyg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">历年感悟(作者创作)</p></figure><p id="f934" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">接下来，将移动平均线应用于净情绪，以查看衰退周期的趋势图。16项声明的移动平均指数在经济不确定时大多会下降。这表明，净情绪的方向在一定程度上与宏观经济相关，尽管在每次FOMC会议上用它来预测会过于嘈杂。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/92eb52feda26e58e3aa2a9779ef39cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uB3llWiGNpPUAEBfvnfKw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">情绪和衰退的移动平均线(由作者创建)</p></figure><p id="300d" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">此外，在每次FOMC会议上，将净情绪的移动平均值与实际的美联储利率决策进行对比。这与美联储的目标利率有一定的相关性，但在金融危机期间，不容易看到利率处于有效下限，并采取了量化宽松政策。我认为QE的声明是一个降低利率的事件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/0a07d08a9c20a0e343b247e39ef1c455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rKreTmcZzMUHdJxu.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">情绪和货币政策的移动平均线(由作者创建)</p></figure><p id="7c1f" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">以下是在matplotlib中生成此图的一些示例代码:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="3c27" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">4.预处理经济指数</h1><p id="a99f" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">当FOMC决定货币政策时，与之前数据的差异也很重要。对于每个指数，取所有指数与前期和上年同期的差值。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/a29affcff4b3339a6d7fc3ff9546b4b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bMbmDWIqXm58JHDv.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">经济指数(由作者创建)</p></figure><p id="784d" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">首先使用<code class="fe nr ns nt nu b">seaborn.heatmap()</code>检查美联储利率决策和经济指数之间的相关性。PMI相关性较高，CPI与费率决定关系不大。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/6ebac2f2ffbe20314222c9211dd96069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4h5c15HeGcf_Vee8.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">经济指数和利率决策之间的相关性(由作者创建)</p></figure><p id="9622" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">然后，计算这些数字的移动平均值，检查与速率决策的相关性，并选择高度相关的字段作为特征。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/85a4ccb8735d0352010dfa62699fa376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Z5cuEXqQC92y_av5.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">移动平均线的相关性(由作者创建)</p></figure><p id="0186" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">例如，PMI值是输入特征候选之一。<code class="fe nr ns nt nu b">seaborn.kdeplot()</code>提供漂亮的分布图。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/b32573be4cb24dce00b3503b3fed0032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CydbMwVo_oxXt7Gj.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每个下一个费率决策的PMI值分布(由作者创建)</p></figure><p id="c2e6" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">作为特征工程的一部分，计算泰勒规则，看看是否可以使用一阶导数和与美联储利率的差异。美联储在其网站上发布了政策制定者如何使用经济指数数据。这里，从原始数据计算泰勒规则、平衡接近规则和惯性规则。</p><p id="49c6" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这一结果看起来与他们的出版物相符，而且这些理论利率和实际美联储利率之间的相关性相当高。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/22b654dd51490775cf3c6c2711860a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eWE5xwgx_AYn0Dx1.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">理论费率(由作者创建)</p></figure><p id="e0b8" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">不要忘记检查缺失的值，并用0或平均值/中值来估算这些值。还要删除一些没有足够输入数据或缺少输出标签的记录。机器无法从部分丢失的输入中学习，因为它无论如何都需要猜测丢失的数据意味着什么。</p><p id="095c" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">每次FOMC会议时可用的最新数据被用作决策的基本输入，并添加文本数据作为附加输入，以查看预测是否可以改进。</p><h1 id="9069" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">5.预处理文本数据</h1><p id="7abc" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">在过去的25年里，大约有200个决定。根据型号，由于缺少数据或可用时间，一些输入无法使用。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/98905964af102efb8f7da5b58a83bc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*CLi6_j_-B8fedd6I.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每个文档类型的输入文档计数(由作者创建)</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi og"><img src="../Images/898eca0880344aee4ac320cb5fdaeeba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q4o2gsKBqN9En9xD.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">最常用的单词(由作者创建)</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oh"><img src="../Images/6cfab982ff1eb28a04d49e8c4c3c89f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jiehBjNysuJuy8sD.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">词云(由作者创建)</p></figure><p id="fdf8" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">在文本处理过程中，您可能面临的一个常见问题是如何在机器学习中处理长文本。大多数基于神经网络的算法都无法分析像10，000个单词(最多500个)这样的长文本。我们的大多数输入文本太长，无法作为一个完整的文档进行分析。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oi"><img src="../Images/14581457393ac88951fa882e620099c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DQCQ4npAX_gKjF_2.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每句话的字数(由作者创造)</p></figure><p id="4219" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这个问题的典型解决方案是或者对文档向量使用其他算法，例如JAC card/余弦相似度，或者找到分割长文本的方法，或者使用一些技术来缩短，例如文本摘要。</p><p id="ade5" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这里使用的一个简单的解决方案是文本分割技术，按字数(例如200个单词，重叠50个单词)分割文本，如下所示。这是一种简单的自动化方法，但很容易丢失上下文，因为提取的200个单词可能包含也可能不包含相关文本，甚至离题。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="4a67" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">另一个问题是数据不平衡—在本例中，比率决策有60%以上的机会是“保持”,而可用的决策只有大约200个，因为会议每年举行八次。如果没有足够的数据，机器学习很容易过度适应训练数据。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oj"><img src="../Images/81064daff2c24146c17abc4bac35b961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*X_iDgE4f3CyRu4Lr.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按文档类型列出的输入文档数(由作者创建)</p></figure><p id="3cd3" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">文本数据处理已经以如下方式完成，这是NLP的常见情况。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ok"><img src="../Images/2358b6b000fc1e50b58b72949f1de812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4lXWT4vOx2uCUhWm.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">NLP管道(由作者创建)</p></figure><h1 id="7046" class="lh li it bd lj lk ll lm ln lo lp lq lr ki ls kj lt kl lu km lv ko lw kp lx ly bi translated">6.建立和训练ML模型</h1><p id="15a8" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">在高层次上，该模型采用文本输入和元输入来预测三个类别:提高、保持或降低，如下所示。关键是如何将文本输入和数字输入结合起来，并且有不同的实现方法。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ol"><img src="../Images/63cb39b022374c881e5c1f9da7ed0e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hbkR7Fs3rr7vc0lN.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">总体流程(由作者创建)</p></figure><p id="2705" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">除了基线模型之外，这里还构建了以下六个模型。所有的模型都是在pytorch中构建和训练的，源代码可以在Github <a class="ae mv" href="https://github.com/yuki678/centralbank_analysis" rel="noopener ugc nofollow" target="_blank"> repo </a>中找到，本文摘录了其中的一些部分。</p><h2 id="5551" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">0.基线模型</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ox"><img src="../Images/a395d1404a24ac81001680ed9615e06e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqatOCJ3jCNa-DNC3sIqBw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">基线流程(由作者创建)</p></figure><p id="bd32" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">这不使用文本输入，而只接受元输入。首先比较具有默认参数的14个不同分类器，以快速获得基线性能。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/94e5d9b2001bd08e3798c488de992c98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_ZysvFiR8SC6Ny1Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">F1由14个不同的分类器评分(由作者创建)</p></figure><p id="3241" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">然后，应用RandomizedSearchCV和GridSearchCV来寻找最优的超参数，并决定使用随机森林作为基础，因为它产生具有合理特征重要性的最佳结果。StratifiedKFold用于交叉验证。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/ba6af0ef71e1b80c3c319e288ed9669a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bOW2qrwxsmge6CYb.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">网格搜索CV结果(由作者创建)</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/4dcbef586a39a644fc4f3631078b5c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MM4zgk2XvDfEaqT3.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">困惑矩阵(由作者创建)</p></figure><p id="7834" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">学习曲线告诉我们，模型过度适应训练数据，更多的数据可能会提高性能。查看混淆矩阵，它未能预测“降低”和“提高”事件。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pb"><img src="../Images/381ed6ca2f68dc155ea3c7d6feab5282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sBqDPR6MClkcdj0d.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">功能重要性(由作者创建)</p></figure><p id="099e" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">查看混淆矩阵，它未能预测“降低”和“提高”事件。</p><p id="8c8f" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">也进行了系综和叠加，但没有提高性能，因为这里的根本问题是缺乏足够的数据。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="70b0" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">A.余弦相似性</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/4269e61e3b3e62d0debea1a084ea87e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OeqaJrGlk0uHQx_OkIlCw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">余弦相似性流程图(由作者创建)</p></figure><p id="4964" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">Tfidf使用初步分析中使用的<a class="ae mv" href="https://sraf.nd.edu/textual-analysis/resources/" rel="noopener ugc nofollow" target="_blank"> Loughran-McDonald字典</a>对文本进行矢量化，并计算两个连续会议之间的余弦相似度。该值是文本方向的变化程度(即向量的余弦)，其可以指示策略变化。然后将其与基线模型中使用的经济指数相结合。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="8ed4" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">B.Tfidf</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/384033a4957fdcc8487dd3644234b497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJFN533JKreyCJUcsfRH2A.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Tfidf流程图(由作者创建)</p></figure><p id="abe3" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">使用Tfidf向量本身作为输入，而不是余弦相似度。只有当Tfidf向量直接保存关于速率变化的有意义的信息时，这才会起作用。使用上一步中标记化的文本，通过FunctionTransfomer将Tfidf向量与非文本输入连接起来。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="5737" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">C.LSTM</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/3e09589c6d52142acdcb928a5b3e3328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*23tq0vOgPj_QFYPfr0umEA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">LSTM流程图(由作者创建)</p></figure><p id="03c8" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">LSTM ( <a class="ae mv" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank">长短时记忆</a>)是一种流行的RNN ( <a class="ae mv" href="https://en.wikipedia.org/wiki/Recurrent_neural_network" rel="noopener ugc nofollow" target="_blank">递归神经网络</a>)架构，可以保存长时记忆和短时记忆，用于序列学习。有许多改进版本，如双向LSTM，而这里使用的是一个简单的普通模型。深度神经网络的输出与漏失和密集层后的经济指标相结合。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="4c30" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">然后，将输入分为文本数据和数字数据。定制数据加载器以产生两种类型的输入。训练过程与LSTM处理文本的通常情况相同。</p><h2 id="f83e" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">D.LSTM+手套</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/e4f48d2b5560b603b86d193f3d1f2849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVlxqXr6WjWGwyZuLH4diA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">LSTM +手套工艺流程(由作者创建)</p></figure><p id="afa4" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">之前的LSTM模型创建了自己的单词嵌入，但也有预先训练的嵌入。这里使用<a class="ae mv" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">全局向量进行单词表示(GloVe) </a>由维基百科和gigaword (6B tokens)训练。这个想法是，预先训练的单词表示将提高随机初始化模型的性能。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5327" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">训练步骤与之前的LSTM模型相同。</p><h2 id="888f" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">E.伯特</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/d7191c8bafccfe5670a4552d6895335e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHkLXK7Qcbwi5TBBP2lBrA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">BERT流程图(由作者创建)</p></figure><p id="a57b" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated"><a class="ae mv" href="https://en.wikipedia.org/wiki/BERT_(language_model)" rel="noopener ugc nofollow" target="_blank"> BERT，或来自Transformers </a>的双向编码器表示，是一种基于transformer的语言模型，与Google Research在2018年发布的RNN相反。这里使用的模型是预训练的BERT_BASE，这是一个具有12层、768个隐藏单元、12个头的深度神经网络，产生110万个参数，并在维基百科和图书语料库上进行训练。除了模型和伯特自己的符号化，建筑的其余部分与上面基于LSTM的模型保持相同。通常对模型使用<code class="fe nr ns nt nu b">transformers.BertForSequenceClassification</code>就足够了，但是这里需要创建自己的定义来连接文本和非文本输入。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h2 id="ad06" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">F.BERT +前期情绪分析</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/f80ff232bb2ae4666115d00b5da481cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FWjQZidH6cO8cq2U.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">BERT +前期情绪分析流程(由作者创建)</p></figure><p id="e33d" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">最后，我采用了另一种方法——不是直接在FOMC文本上训练模型，而是首先在其他金融文本上训练模型以进行情感分析任务。然后使用经过训练的BERT模型来分析FOMC文本中每个句子的情感，并计算情感得分，然后对每个文档进行汇总，并将其用作另一个ML模型的输入，以预测FOMC的决定。</p><h2 id="7aed" class="om li it bd lj on oo dn ln op oq dp lr mi or os lt mm ot ou lv mq ov ow lx iz bi translated">结果</h2><p id="40ee" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">下面是测试模型之间的分数对比。深度神经网络模型表现不佳，这基本上是由于缺乏足够的数据来训练这些复杂的模型。带有情绪前分析的最后一个模型优于其他模型，但需要进一步检查这种改进是否具有有意义的显著性和一致性，而不仅仅是由于任何额外的输入。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/5e5093a768d771a8373201776d230fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IDcam72Sz0wGARvO.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">每个模型的性能分数(由作者创建)</p></figure></div><div class="ab cl pj pk hx pl" role="separator"><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po pp"/><span class="pm bw bk pn po"/></div><div class="im in io ip iq"><h1 id="4c4e" class="lh li it bd lj lk pq lm ln lo pr lq lr ki ps kj lt kl pt km lv ko pu kp lx ly bi translated">结论</h1><p id="72f5" class="pw-post-body-paragraph lz ma it mb b mc md kd me mf mg kg mh mi mj mk ml mm mn mo mp mq mr ms mt mu im bi translated">我们研究了FOMC文本数据是否包含有用的洞察力，以预测美联储在下一次FOMC会议上的目标利率决定(即提高、保持或降低)。我们可以从文本中观察到一些有用的信息，从而更好地预测FOMC的决策。然而，我们不能通过神经网络来提高基于文本的预测性能。这部分是因为对于每个非常长的文本，有少量的测试数据要训练。</p><p id="6b06" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">作为未来的工作，有两个主要方面需要改进:</p><ol class=""><li id="37ae" class="nd ne it mb b mc mw mf mx mi nf mm ng mq nh mu pv nj nk nl bi translated">解决缺乏足够训练数据的问题——模型显然过度适应训练样本，未能很好地概括，特别是助推算法容易过度适应。这里考虑了超参数调整和插补。此外，通过合成方法配置模型和分割数据以增加训练数据可能是有益的。</li><li id="5e62" class="nd ne it mb b mc nm mf nn mi no mm np mq nq mu pv nj nk nl bi translated">提高输入文本质量——输入文本包含大量与美联储目标利率决策无关的段落。例如，有关于法规、组织结构和基础设施的信息。过滤掉不太相关的输入将提高模型预测的准确性以及训练效率。</li></ol><p id="ef9c" class="pw-post-body-paragraph lz ma it mb b mc mw kd me mf mx kg mh mi my mk ml mm mz mo mp mq na ms mt mu im bi translated">注意，这篇文章中的代码只是一些摘录。完整源代码请参考Github <a class="ae mv" href="https://github.com/yuki678/centralbank_analysis" rel="noopener ugc nofollow" target="_blank"> repo </a>。</p></div></div>    
</body>
</html>