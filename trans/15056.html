<html>
<head>
<title>Predicting mRNA Degradation using GNNs and RNNs in the Search for a COVID-19 Vaccine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在新冠肺炎疫苗研究中使用GNNs和RNNs预测mRNA降解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-mrna-degradation-using-gnns-and-rnns-in-the-search-for-a-covid-19-vaccine-b3070d20b2e5?source=collection_archive---------28-----------------------#2020-10-16">https://towardsdatascience.com/predicting-mrna-degradation-using-gnns-and-rnns-in-the-search-for-a-covid-19-vaccine-b3070d20b2e5?source=collection_archive---------28-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="69f7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于Kaggle OpenVaccine竞赛第四名解决方案的报道</h2></div><p id="1837" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当前的新冠肺炎疫情需要一种有效的疫苗来赢得与这种病毒的斗争。斯坦福大学的研究人员正在研究mRNA疫苗，因为这可能很快提供一种候选解决方案。这些类型的疫苗面临的一个挑战是它们的稳定性:除非保存在强烈的冷藏条件下，否则它们往往会自发降解。为了找到稳定的mRNA序列，来自斯坦福大学的人们在<a class="ae lb" href="https://www.kaggle.com/c/stanford-covid-vaccine/overview" rel="noopener ugc nofollow" target="_blank"> OpenVaccine:新冠肺炎mRNA疫苗降解预测</a>比赛中联系了Kaggle社区。比赛于9月11日开始，仅持续了26天，由于时间紧迫，这对Kaggle来说是不寻常的短。前三名竞争者有25，000美元的奖金。<a class="ae lb" href="https://www.kaggle.com/bsteenwi" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Bram Steenwinckel</strong></a><strong class="kh ir"/><a class="ae lb" href="https://www.kaggle.com/mtinti" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Michele Tinti</strong></a><strong class="kh ir">我和能够达到第四的位置，在金钱上差了一英寸！</strong>希望我们能在新冠肺炎疫苗的研究中尽绵薄之力，我们发布了这篇讨论我们解决方案的博文。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/53675fa7c4e42baea6e5af5a720c36d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7l2tKZsEyKNxCAZSDAY_eQ.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">我们的团队“来自鞋店&amp;染坊&amp;石店”获得了第四名！我们的团队名由我们的姓组成，这些姓是从我们的母语(荷兰语和意大利语)翻译成英语的。<a class="ae lb" href="https://www.kaggle.com/c/stanford-covid-vaccine/leaderboard" rel="noopener ugc nofollow" target="_blank">此图为Kaggle排行榜截图。</a></p></figure><h2 id="0c26" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">问题陈述</h2><p id="c5c3" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">该竞赛的目标是预测提供的RNA序列中每种碱基(A、C、G或U)在某些情况下的反应性和降解，例如在高温或高pH下有或没有镁的情况下温育。总之，我们必须预测序列中每种碱基的三个连续值(即回归)(即序列对序列)。</p><p id="97c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练集由2400个长度为107的序列组成，公共测试集包含629个长度为107的序列，私有测试集由3005个长度为130的序列组成。因此，私人测试数据中的序列长度存在差异。因此，模型对序列长度具有内在的不变性是非常重要的。此外，序列仅被部分评分。对于训练和公共测试集，只有107个碱基中的前68个被评分，而对于私有测试集，130个碱基中的前91个被评分。下面提供了一个训练序列的目标的例子:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mq"><img src="../Images/844c441d292bae95cd3763b6745a0535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXZrewB4XUXlb4FGXAEmDQ.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">一个训练序列的目标值的时间序列。图片作者。</p></figure><p id="f756" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以在RNA序列图上直接显示这些目标值，就像在下面的例子中对反应性所做的那样:</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mr"><img src="../Images/4c1356b03a6498d562c13448b1bdb86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPpAvO1sU8ztiJE3qkbxEg.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">RNA序列可能的折叠之一。节点颜色描述了反应性值(红色=高，蓝色=低)。请注意，107–68节点没有着色，因为没有为序列的尾部指定目标。图片作者。</p></figure><h2 id="3462" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">高级解决方案概述</h2><p id="6053" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">通过查看目标，可以清楚地看到，某个值与其在时间序列中的相邻值相关联。递归神经网络非常适合这种情况，因为它们的内置内存会考虑附近的预测值。我们学习序列中每个碱基的表示，并通过2个(双向)RNN层。通过使用节点本身的信息和关系或边信息来学习每个节点的表示。从引言中可以看出，RNA序列可以用图表来表示，并且序列中某些碱基之间的关系是存在的。我们使用图层来聚集这种关系信息。我们的最终解决方案由4个不同的模型组成，其中我们改变了RNN层(LSTM+LSTM，LSTM+GRU，GRU+LSTM和GRU+GRU)。这个高层次的概述忽略了一些细节。一个重要的细节是，我们预先训练网络，直到RNN层作为自动编码器。这使得我们也可以在未标记的测试数据上进行训练。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ms"><img src="../Images/9d7b296de6ef7b3c46c268f792aa3603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJ3-OABA83SWl3fCqa_Now.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">我们解决方案的高级概述。图片作者。</p></figure><h2 id="db36" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">用<a class="ae lb" href="https://github.com/DasLab/arnie" rel="noopener ugc nofollow" target="_blank">阿尼</a>生成额外信息</h2><p id="3ae1" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated"><a class="ae lb" href="https://github.com/DasLab/arnie" rel="noopener ugc nofollow" target="_blank"> ARNIE </a>是一个软件包，包含6个不同的库，可用于为每个序列生成额外的信息:</p><ul class=""><li id="840d" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated"><a class="ae lb" href="https://www.tbi.univie.ac.at/RNA/#download" rel="noopener ugc nofollow" target="_blank">维也纳</a></li><li id="b911" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><a class="ae lb" href="http://www.nupack.org/downloads" rel="noopener ugc nofollow" target="_blank"> NUPACK </a></li><li id="bcbc" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><a class="ae lb" href="https://rna.urmc.rochester.edu/RNAstructure.html" rel="noopener ugc nofollow" target="_blank">RNA结构</a></li><li id="0e9d" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><a class="ae lb" href="http://www.rnasoft.ca/download.html" rel="noopener ugc nofollow" target="_blank"> RNAsoft </a></li><li id="bd04" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><a class="ae lb" href="http://contra.stanford.edu/contrafold/" rel="noopener ugc nofollow" target="_blank">反折</a></li><li id="b362" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><a class="ae lb" href="http://https://eternagame.org/about/software" rel="noopener ugc nofollow" target="_blank">永恒折叠</a></li></ul><p id="7f73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于提供的RNA序列，ARNIE能够计算碱基配对概率(BPP)矩阵。基于该BPP，可以预测潜在的结构，并且从这些结构中，可以推断序列中每个碱基的环类型。</p><p id="f4b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在ARNIE中使用不同的库来生成额外的信息。这通常需要一点bash魔法来安装所有的东西。<a class="ae lb" href="https://www.kaggle.com/group16/generating-bpps-with-arnie" rel="noopener ugc nofollow" target="_blank">我们提供了一个笔记本来演示如何生成这些信息。我们对所有6个文库进行了实验，但只发现CONTRAfold是最有用的，其次是RNAsoft、RNAstructure和Vienna。</a></p><h2 id="a4b0" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">节点特征</h2><p id="f68a" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">从我们的高级概述中，我们可以看到我们的网络需要两种类型的输入:节点信息和边缘信息。节点信息是一个<code class="fe nh ni nj nk b">NxLxV</code>矩阵，其中<code class="fe nh ni nj nk b">N</code>是RNA序列的数量，<code class="fe nh ni nj nk b">L</code>是序列的长度，<code class="fe nh ni nj nk b">V</code>是每个节点的特征数量。我们总共使用<code class="fe nh ni nj nk b">V=25</code>功能:</p><ul class=""><li id="129c" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">一次热编码<strong class="kh ir">底座</strong>(‘A’、‘G’、‘C’或‘U’)(4个特征)</li><li id="45f9" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">单热编码<strong class="kh ir">循环类型</strong>(提供:' S ':成对茎，' M ':多循环，' I ':内部循环，' B ':凸出，' H ':发夹循环，' E ':悬空端或' X ':外部循环)(7个特征)</li><li id="d8b9" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">一次热编码<strong class="kh ir">位置</strong>特征(索引% 3) (3个特征)</li><li id="466f" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir">确定性</strong>:预测<code class="fe nh ni nj nk b">(</code>、<code class="fe nh ni nj nk b">)</code>或<code class="fe nh ni nj nk b">.</code> (3个特征)的包的分数(3个不同的包:Vienna、CONTRAfold和RNAstructure)。</li><li id="1177" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir"> CapR循环类型</strong>概率(6个特征)</li><li id="5330" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated"><strong class="kh ir"> BPP </strong>零和数(2个特征)</li></ul><h2 id="34d9" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">边缘特征</h2><p id="e1d4" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">在<code class="fe nh ni nj nk b">NxLxLxE</code>矩阵中捕获边缘信息，其中<code class="fe nh ni nj nk b">N</code>是RNA序列的数量，<code class="fe nh ni nj nk b">L</code>是序列的长度，<code class="fe nh ni nj nk b">E</code>是边缘特征的数量。总的来说，每条边都有<code class="fe nh ni nj nk b">E=5</code>个特征:</p><ul class=""><li id="d214" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">3个不同的<strong class="kh ir">bpp</strong>:提供的，用RNAsoft (ARNIE)生成的，用contrafold (ARNIE)生成的</li><li id="9621" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">结构(<code class="fe nh ni nj nk b">(</code>和<code class="fe nh ni nj nk b">)</code>)中是否有指示的<strong class="kh ir">碱基配对</strong></li><li id="b9ff" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">碱基之间的<strong class="kh ir">距离</strong>(曼哈顿)，通过序列长度标准化</li></ul><h2 id="6c13" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">模型</h2><p id="ef04" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我们的作品改编自mrmakr 的《T7》。一定要给那个笔记本一个向上的投票！我们确实对原始笔记本做了一些修改:</p><ul class=""><li id="186e" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">修正了网络分类部分的损失函数。</li><li id="44df" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">改变了自动编码器的损失函数，它是为二进制表示而定制的(它是二进制交叉熵的变体)。我们简单地使用重建损失/MAE (|y — y_hat|)。</li><li id="6b61" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">在编码器后增加了两个RNN层。正如比赛期间所展示的那样(由<a class="ae lb" href="https://www.kaggle.com/tuckerarrants" rel="noopener ugc nofollow" target="_blank"> @tuckerarrants </a>和其他人)，混合GRU+GRU、LSTM+GRU、GRU+LSTM和LSTM+LSTM的模式会产生轻微的推动作用。我们为这4个组合中的每一个生成了10倍CV的模型(总共40个模型),并以统一的权重混合这些模型。</li><li id="f8ac" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">调整了一些超参数。AE的时代，分类部分，GCN层中的单元数，…</li><li id="4c5d" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">添加补充数据，来自<a class="ae lb" href="https://www.kaggle.com/its7171" rel="noopener ugc nofollow" target="_blank"> @its7171 </a>制作的<a class="ae lb" href="https://www.kaggle.com/its7171/how-to-generate-augmentation-data" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</li><li id="7cea" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">对所有样本进行训练，但是基于它们的信噪比使用不同的样本权重。为此再次向<a class="ae lb" href="https://www.kaggle.com/its7171" rel="noopener ugc nofollow" target="_blank"> @its7171 </a>喊出！仅对SN_filter=1的数据执行评估。因为我们预计私人银行也会这么做。)</li></ul><h2 id="ac7a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated"><strong class="ak">不起作用的事情</strong></h2><p id="a9ef" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我们尝试了很多不奏效的方法:</p><ul class=""><li id="072a" class="mt mu iq kh b ki kj kl km ko mv ks mw kw mx la my mz na nb bi translated">我们得到了所有RNA的3D折叠，并计算了RNA碱基之间的3D(欧几里德)距离。我们还尝试使用角度信息(装箱，然后分类编码):这提高了我们简单的LSTM架构，但恶化了AE+LSTM的性能。这些功能肯定有一些潜力，但它们需要一些更彻底的实验。允许这种实验的数据集可以在找到。</li><li id="7c06" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">许多提供一些RNA特征的软件包信息不多。其中一些包括RNAup，Shaker，MXFold，…</li><li id="15f2" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">本文中<a class="ae lb" href="https://www.biorxiv.org/content/10.1101/2020.06.08.140368v1.full" rel="noopener ugc nofollow" target="_blank">讨论的所有光谱表示法。</a></li><li id="6425" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">更丰富的图形表示(例如，包括氨基酸信息)</li><li id="18ee" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">熵特征</li><li id="c455" class="mt mu iq kh b ki nc kl nd ko ne ks nf kw ng la my mz na nb bi translated">原子信息</li></ul><h2 id="f20a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma ko mb mc md ks me mf mg kw mh mi mj mk bi translated">总结词</h2><p id="5daa" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">我真的很喜欢这场比赛。我特别喜欢它只持续了相当短的一段时间。在整个比赛过程中，这是一场公共排行榜上不分上下的比赛。压力很大，但是很有趣！这种“闪电战”比赛或许可以被卡格尔认为是一种独立的形式？</p><p id="eb7b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我们刚刚错过了奖金(1个位置)，但我们仍然为我们的结果感到非常自豪！有了这个结果，我的两个队友:<a class="ae lb" href="https://www.kaggle.com/bsteenwi" rel="noopener ugc nofollow" target="_blank">布拉姆</a>和<a class="ae lb" href="https://www.kaggle.com/mtinti" rel="noopener ugc nofollow" target="_blank">米歇尔</a>也成为了Kaggle比赛高手。因此，向他们表示热烈祝贺！</p><p id="0d88" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在<a class="ae lb" href="https://www.kaggle.com/group16/covid-19-mrna-4th-place-solution" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>和<a class="ae lb" href="https://github.com/GillesVandewiele/covid19-mrna-degradation-prediction" rel="noopener ugc nofollow" target="_blank"> Github </a>上都提供了我们解决方案的代码。</p><p id="3d11" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">像往常一样，如果有任何不清楚的地方或者需要更多的解释:不要犹豫，留下你的评论或者联系我！</strong></p><p id="6779" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请关注这篇文章，因为它可能会在不久的将来收到一些更新！</p><p id="7737" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下次比赛再见！吉勒、布拉姆和米歇尔</p></div></div>    
</body>
</html>