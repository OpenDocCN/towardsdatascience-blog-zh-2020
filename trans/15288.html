<html>
<head>
<title>How to download and parse TREC-COVID data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何下载和解析TREC-柯维德数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/download-and-parse-trec-covid-data-8f9840686c37?source=collection_archive---------48-----------------------#2020-10-20">https://towardsdatascience.com/download-and-parse-trec-covid-data-8f9840686c37?source=collection_archive---------48-----------------------#2020-10-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="66d7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你改进cord19搜索应用的第一步。</h2></div><p id="8c25" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="lc">这是一系列博客文章中的第一篇，将向您展示如何改进文本搜索应用程序，从下载数据到微调BERT模型。</em></p><p id="195a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">您也可以从<a class="ae kf" href="https://colab.research.google.com/github/vespa-engine/pyvespa/blob/master/docs/sphinx/source/use_cases/cord19/cord19_download_parse_trec_covid.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>运行这里包含的步骤。</p><p id="bc1a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">vespa.ai背后的团队已经构建并开源了一个CORD-19搜索引擎。得益于先进的Vespa功能，如<a class="ae kf" href="https://blog.vespa.ai/approximate-nearest-neighbor-search-in-vespa-part-1/" rel="noopener ugc nofollow" target="_blank">近似最近邻搜索</a>和<a class="ae kf" href="https://blog.vespa.ai/introducing-nlp-with-transformers-on-vespa/" rel="noopener ugc nofollow" target="_blank">转换器支持ONNX </a>，它采用了目前可用的最先进的NLP搜索方法。</p><p id="53d8" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们的第一步是下载相关性判断，以便能够评估应用程序中部署的当前查询模型，并训练更好的模型来替换已经存在的模型。</p><h2 id="b853" class="ld le iq bd lf lg lh dn li lj lk dp ll kp lm ln lo kt lp lq lr kx ls lt lu lv bi translated">下载数据</h2><p id="0c83" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">本节使用的文件可以在<a class="ae kf" href="https://ir.nist.gov/covidSubmit/data.html." rel="noopener ugc nofollow" target="_blank">https://ir.nist.gov/covidSubmit/data.html.</a>找到。我们将下载主题和相关性判断数据。不要担心它们是什么，我们很快就会探索它们。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="3f55" class="ld le iq mg b gy mk ml l mm mn">!wget https://ir.nist.gov/covidSubmit/data/topics-rnd5.xml<br/>!wget <a class="ae kf" href="https://ir.nist.gov/covidSubmit/data/qrels-covid_d5_j0.5-5.txt" rel="noopener ugc nofollow" target="_blank">https://ir.nist.gov/covidSubmit/data/qrels-covid_d5_j0.5-5.txt</a></span></pre><h2 id="644a" class="ld le iq bd lf lg lh dn li lj lk dp ll kp lm ln lo kt lp lq lr kx ls lt lu lv bi translated">解析数据</h2><h2 id="15a8" class="ld le iq bd lf lg lh dn li lj lk dp ll kp lm ln lo kt lp lq lr kx ls lt lu lv bi translated">主题</h2><p id="79f8" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">主题文件是XML格式的。我们可以解析它并存储在一个名为<code class="fe mo mp mq mg b">topics</code>的字典中。我们希望从每个主题中提取一个<code class="fe mo mp mq mg b">query</code>、一个<code class="fe mo mp mq mg b">question</code>和一个<code class="fe mo mp mq mg b">narrative</code>。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="06a7" class="ld le iq mg b gy mk ml l mm mn">import xml.etree.ElementTree as ET<br/><br/>topics = {}<br/>root = ET.parse("topics-rnd5.xml").getroot()<br/>for topic in root.findall("topic"):<br/>    topic_number = topic.attrib["number"]<br/>    topics[topic_number] = {}<br/>    for query in topic.findall("query"):<br/>        topics[topic_number]["query"] = query.text<br/>    for question in topic.findall("question"):<br/>        topics[topic_number]["question"] = question.text        <br/>    for narrative in topic.findall("narrative"):<br/>        topics[topic_number]["narrative"] = narrative.text</span></pre><p id="52d6" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">总共有50个话题。例如，我们可以看到下面的第一个主题:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="8ce2" class="ld le iq mg b gy mk ml l mm mn">topics["1"]</span><span id="32c7" class="ld le iq mg b gy mr ml l mm mn">{'query': 'coronavirus origin',<br/> 'question': 'what is the origin of COVID-19',<br/> 'narrative': "seeking range of information about the SARS-CoV-2 virus's origin, including its evolution, animal source, and first transmission into humans"}</span></pre><p id="c57b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每个主题都有许多相关的相关性判断。</p><h2 id="592e" class="ld le iq bd lf lg lh dn li lj lk dp ll kp lm ln lo kt lp lq lr kx ls lt lu lv bi translated">相关性判断</h2><p id="a380" class="pw-post-body-paragraph kg kh iq ki b kj lw jr kl km lx ju ko kp ly kr ks kt lz kv kw kx ma kz la lb ij bi translated">我们可以将相关性判断数据直接加载到熊猫<code class="fe mo mp mq mg b">DataFrame</code>中。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="2973" class="ld le iq mg b gy mk ml l mm mn">import pandas as pd<br/><br/>relevance_data = pd.read_csv("qrels-covid_d5_j0.5-5.txt", sep=" ", header=None)<br/>relevance_data.columns = ["topic_id", "round_id", "cord_uid", "relevancy"]</span></pre><p id="fa97" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">相关性数据包含在5轮比赛中做出的所有相关性判断。<code class="fe mo mp mq mg b">relevancy</code>等于0不相关，1相关，2高度相关。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="2a56" class="ld le iq mg b gy mk ml l mm mn">relevance_data.head()</span></pre><figure class="mb mc md me gt ms gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/588048637535745d9731ab3aec817867.png" data-original-src="https://miro.medium.com/v2/format:webp/1*XO2OTKRRMtkK4NjHusSwqw.png"/></div></figure><p id="4e32" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们将删除关联度等于-1的两行，我假设这是一个错误。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="29b3" class="ld le iq mg b gy mk ml l mm mn">relevance_data[relevance_data.relevancy == -1]</span></pre><figure class="mb mc md me gt ms gh gi paragraph-image"><div class="ab gu cl mt"><img src="../Images/481c9dda685cefc6e8670ac3243e4400.png" data-original-src="https://miro.medium.com/v2/format:webp/1*bpDXsgcL1BlNCGx1FLAMjg.png"/></div></figure><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="4c8e" class="ld le iq mg b gy mk ml l mm mn">relevance_data = relevance_data[relevance_data.relevancy &gt;= 0]</span></pre><p id="2053" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下面的图表显示，每个主题有相当多的相关性判断，相关文档的数量在不同的主题之间变化很大。</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="6424" class="ld le iq mg b gy mk ml l mm mn">import plotly.express as px<br/><br/>fig = px.histogram(relevance_data, x="topic_id", color = "relevancy")<br/>fig.show()</span></pre><figure class="mb mc md me gt ms gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/394004df86f94337e70a0bb642071a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I5bcAMSpPN82Lu3215G3_Q.png"/></div></figure><p id="939b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">接下来我们将讨论如何利用这些数据来评估和改进cord19搜索应用程序。</p></div></div>    
</body>
</html>