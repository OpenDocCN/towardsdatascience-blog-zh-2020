<html>
<head>
<title>Predicting Customer Churn using Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用逻辑回归预测客户流失</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-customer-churn-using-logistic-regression-9543c60f6d47?source=collection_archive---------22-----------------------#2020-11-03">https://towardsdatascience.com/predicting-customer-churn-using-logistic-regression-9543c60f6d47?source=collection_archive---------22-----------------------#2020-11-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="480d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我第一次接触逻辑回归算法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ba4ff30a6983be2b1f12574973540d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gxoDkycwVrcbTiFt"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</p></figure><h1 id="de81" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">什么是客户流失？</strong></h1><p id="1422" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">流失率</strong>，也称为<strong class="lq ir">损耗率</strong>或<strong class="lq ir">客户流失率</strong>，是客户停止与实体做生意的比率。它通常表示为在给定时间段内停止订购的服务用户的百分比。高客户流失率表明公司正在以惊人的速度流失客户。客户流失可归因于无数原因，公司需要通过客户数据中的模式和趋势来发现这些原因。</p><p id="a966" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现代企业如今采用复杂的算法来预测最有可能流失的客户，即离开公司的客户。通过使用这种算法，公司可以提前知道最有可能放弃公司服务的客户，并因此提出客户保留策略来减轻公司可能面临的损失。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="5e0c" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">问题陈述</h1><p id="2ca4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在前面的段落中描述客户流失的原因是因为我的下一个机器学习项目的目标是开发一种算法，可以准确预测最有可能流失的客户。</p><p id="081e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">作为一个额外的挑战，我试图发现客户流失的趋势，并确定客户决定终止合同时的主要因素。在我所掌握的各种可视化库的帮助下，我能够找出控制客户流失决策的可能参数。这些因素将在本博客的后续章节中讨论。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="6da5" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">工作流程</h1><p id="95d0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">电信行业客户流失预测是一个机器学习问题。因此，为这个项目获取数据非常简单。我从Kaggle下载了数据集，并将其加载到我的jupyter笔记本上。此外，我还导入了完成这个项目所必需的库。现在需要的唯一任务是分析数据，清理数据，并使用清理后的数据集训练ML模型。</p><h2 id="0c25" class="nb kx iq bd ky nc nd dn lc ne nf dp lg lx ng nh li mb ni nj lk mf nk nl lm nm bi translated">数据探索和数据工程</h2><p id="0a99" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">步骤1:检查缺失值。</p><p id="f613" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">探索数据集时最重要的步骤之一是搜索缺失值。缺失值能够阻碍ML算法的训练过程，并影响训练模型的准确性。在数据集上使用pandas的isnull()函数后，我发现数据集中没有缺失值。因此，我进入了数据探索步骤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/3bdf3ce1f335b222ce17330d4afb050e.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*9KRS-0U7yxyLmHPBWS8OMw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">要素列表以及缺失值的计数。(图片由作者提供)</p></figure><p id="9ac0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第二步:数据探索。</p><p id="54b5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">因为我现在确信我的数据集中没有丢失的值，所以我可以将注意力转向研究手头的数据。数据探索是至关重要的一步，因为它使我能够熟悉数据集中存在的不同特征以及每个特征列包含的值的类型。下面列出了我在数据探索阶段发现的数据要点。</p><ul class=""><li id="3daa" class="no np iq lq b lr mk lu ml lx nq mb nr mf ns mj nt nu nv nw bi translated">总共有17个分类特征和4个连续特征。</li><li id="c202" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">除了“老年人”、“任期”和“每月费用”，所有其他特征都是数据类型<em class="oc">对象。</em></li><li id="46fe" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">最后，数据集包含1，869条有过交易的客户记录和5，163条没有交易的客户记录。</li></ul><p id="5e2e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">步骤3:数据可视化</p><p id="fad4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数据可视化是任何机器学习或数据科学项目的一个关键方面。可视化通常提供数据的鸟瞰图，允许数据科学家或ML工程师从手头的数据中辨别趋势和模式。我使用seaborn library的countplot函数来绘制分类特征，然后试图发现客户流失的趋势。上述可视化任务的输出可以在下图中看到。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/dd4a57ea26f40f7428a40c570d5e923a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8fpgv696stYoiF_990lnw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="c589" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">从上面的图片中，我能够挑出一些有趣的点，这些点在流失的客户中很普遍。以下列出了相同的内容:</p><ul class=""><li id="4497" class="no np iq lq b lr mk lu ml lx nq mb nr mf ns mj nt nu nv nw bi translated">男性和女性的流失率几乎相当。</li><li id="ec67" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">老年人的流失率很低。</li><li id="ac8e" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">拥有电话服务的客户流失率更高。</li><li id="b137" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">有合作伙伴和家属的客户的流失率低于没有合作伙伴和家属的客户。</li><li id="dfd5" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">与其他支付方式相比，使用电子支付方式的客户流失率更高。</li><li id="d390" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">没有互联网服务的客户流失率较低。</li><li id="6489" class="no np iq lq b lr nx lu ny lx nz mb oa mf ob mj nt nu nv nw bi translated">光纤互联网服务的流失率要高得多。</li></ul><p id="852b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这种可视化通常有助于公司发现客户流失的可能原因。例如，以电子方式付款的客户更有可能流失，这可能是因为他们在进行电子付款时面临一些不便，公司可以对此进行调查，或者选择光纤互联网服务的客户对公司的流失率有很大影响，这可能暗示客户对公司提供的光纤互联网服务不满意，公司可以调查此事并尽早解决问题。数据可视化是重要的一步，因为它提供了可操作的见解，并帮助公司做出明智的决策。</p><p id="a2d3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">步骤4:数据工程</p><p id="dab0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">由于数据探索阶段现在已经完成，并且我对数据集有了很好的理解，所以我继续进行项目的数据工程部分。首先，我去掉了“<em class="oc">客户Id”</em>列，因为它不会影响我们的ML模型的预测能力。接下来，我将所有分类特征转换成一次性编码特征。最后，数据集被分成训练和测试数据，以促进ML模型的训练。</p><p id="9417" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">机器学习模型创建和评估</strong></p><p id="4aca" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第一步:训练一个机器学习模型。</p><p id="6944" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">随着数据探索和工程阶段的完成，我继续训练我的机器学习模型。客户流失预测是一个分类问题，因此，我使用逻辑回归算法来训练我的机器学习模型。在我看来，逻辑回归是一个相当容易实现、解释和训练非常有效的算法。此外，它在数字数据上工作得非常好。最后，可以通过逻辑回归实现的<em class="oc">【L1】</em>和<em class="oc">【L2】</em>正则化技术防止模型过度拟合。</p><p id="4046" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我从sklearn库中导入了逻辑回归模型，并对训练数据使用了<em class="oc">“fit”</em>函数。拟合操作一完成，我就进入下一步，评估我的ML模型的性能。</p><p id="6e3f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">步骤2:评估模型性能。</p><p id="2e7f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是我的机器学习项目的最后一步，就是测试我的ML模型的性能。这一步至关重要，因为我可以根据看不见的客户数据来衡量我的ML模型的准确性。为了确定我的ML模型的性能，我使用了测试数据，并计算了预测标签的准确度分数以及混淆矩阵。逻辑回归模型的准确度得分为<em class="oc"> 81.5%。</em>共有1148个标签被准确预测，而259个标签被错误预测。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="9412" class="kw kx iq bd ky kz mw lb lc ld mx lf lg jw my jx li jz mz ka lk kc na kd lm ln bi translated">结论</h1><p id="e730" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这个关于客户流失预测的机器学习项目给我提供了一个新的学习体验。它允许我使用各种可视化库，并让我意识到数据可视化的重要性。这也让我有机会使用一种新的ML算法，即逻辑回归。这个项目是机器学习在现实世界中的一个主要例子，在这个项目中工作帮助了我，磨练了我在机器学习领域的技能。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="4171" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我为这个项目遵循的工作流程可以在我的<a class="ae kv" href="https://github.com/shaunak09vb/Telco-Customer-Churn-Predicition/blob/master/Customer_Churn_LogReg.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir"><em class="oc">Github</em></strong>T5】个人资料中找到。我希望你喜欢看我的博客。</a></p></div></div>    
</body>
</html>