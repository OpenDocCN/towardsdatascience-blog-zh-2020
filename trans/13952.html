<html>
<head>
<title>Ultimate Pandas Guide — Joining data with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫终极指南-使用Python连接数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ultimate-pandas-guide-joining-data-with-python-48d9feff77ea?source=collection_archive---------31-----------------------#2020-09-25">https://towardsdatascience.com/ultimate-pandas-guide-joining-data-with-python-48d9feff77ea?source=collection_archive---------31-----------------------#2020-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/6220014720465a1d3cd74ffb80819414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*l3dxRNA5mkXM7-95VnXz0g.png"/></div><p class="iy iz gj gh gi ja jb bd b be z dk translated">劳拉·伍德伯里摄于<a class="ae jc" href="https://www.pexels.com/photo/panda-bear-on-green-grass-3608263/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a></p></figure><div class=""/><div class=""><h2 id="9365" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">掌握“合并”和“加入”的区别</h2></div><p id="6afc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每个从事数据工作的人都知道这一点:在你建立机器学习模型或产生令人惊叹的可视化之前，你必须让你的手弄脏数据争论。</p><p id="4ddc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据争论的核心技能之一是学习如何将不同的数据源连接在一起。</p><p id="238f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我将通过介绍两种核心连接方法——连接和合并，为pandas中的连接提供一个全面的指南</p><p id="6b4a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您需要复习加入数据的含义，我建议您在继续之前查看我的<a class="ae jc" rel="noopener" target="_blank" href="/a-beginners-guide-to-joining-data-935c8e579fb7">加入数据初学者指南</a>:</p><div class="is it gp gr iu lq"><a rel="noopener follow" target="_blank" href="/a-beginners-guide-to-joining-data-935c8e579fb7"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd jg gy z fp lv fr fs lw fu fw je bi translated">连接数据的初学者指南</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">左接合。内部联接。外部联接。啊？</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">towardsdatascience.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me iw lq"/></div></div></a></div><h1 id="23ec" class="mf mg jf bd mh mi mj mk ml mm mn mo mp kl mq km mr ko ms kp mt kr mu ks mv mw bi translated">“合并”方法</h1><p id="0f4b" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">与连接的情况一样，进行Pandas合并需要三个基本要素:</p><p id="c94b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">1.你的两个数据集</p><p id="8ca6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2.要执行的联接类型</p><p id="cf30" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.您的连接密钥</p><h2 id="f49c" class="nc mg jf bd mh nd ne dn ml nf ng dp mp ld nh ni mr lh nj nk mt ll nl nm mv nn bi translated">数据源</h2><p id="4050" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">Merge是DataFrame类的一个<a class="ae jc" href="https://www.w3schools.com/python/gloss_python_object_methods.asp" rel="noopener ugc nofollow" target="_blank">方法</a>。这意味着无论何时你调用一个合并，它实际上是被一个数据帧调用的。</p><p id="bb86" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">“调用”数据帧是您的左侧<strong class="kw jg">表。</strong></p><p id="f330" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该方法的第一个参数是您的<strong class="kw jg">右表。</strong></p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi np"><img src="../Images/b1a94c1fa27445697060d35cd354ee67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hQbwnOIuZlWUhDF4OaDneA.png"/></div></div></figure><p id="346a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">再次注意，table1是您的左表，table2是您的右表。</p><h2 id="9ed4" class="nc mg jf bd mh nd ne dn ml nf ng dp mp ld nh ni mr lh nj nk mt ll nl nm mv nn bi translated">连接类型</h2><p id="1318" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">你需要的第二个关键因素是你想要使用的连接类型。</p><p id="8eea" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在merge函数中，您可以通过“how”参数来实现这一点:</p><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="e767" class="nc mg jf nz b gy od oe l of og">table1.merge(table2, <strong class="nz jg">how = ‘left’</strong>)</span></pre><p id="617c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">“How”可以取值为:left、right、inner或outer——类似于大多数版本的SQL。</p><h2 id="d746" class="nc mg jf bd mh nd ne dn ml nf ng dp mp ld nh ni mr lh nj nk mt ll nl nm mv nn bi translated">连接键</h2><p id="14c3" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">在选择连接键时，Pandas提供了高度的灵活性。</p><p id="7ffd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是传递连接键的三种主要方法:</p><ol class=""><li id="84b4" class="oh oi jf kw b kx ky la lb ld oj lh ok ll ol lp om on oo op bi translated"><strong class="kw jg">使用“on”参数</strong> —这是最直观的解决方案，但是它要求您试图连接的列具有相同的<strong class="kw jg">名称。</strong></li></ol><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="2066" class="nc mg jf nz b gy od oe l of og">companies.merge(stock_price, how = 'left', on = 'Stock Ticker')</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oq"><img src="../Images/4e3a509f3e4d7d6fe7592f0934b4e7f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVZFb5rxnPilWu5mtPW2Pg.png"/></div></div></figure><p id="88d9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2.<strong class="kw jg">使用“left_on”和“right_on”参数</strong> —对于此方法，您将“left_on”设置为您想要在左侧表格中使用的列，将“right on”设置为您想要在右侧表格中使用的列:</p><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="ec15" class="nc mg jf nz b gy od oe l of og">companies.merge(stock_price, how = ‘left’, left_on = ‘Stock Ticker’, right_on = ‘Ticker’)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi or"><img src="../Images/893b77698be37a015e103478a5976058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zrFmmBvKU4Iu3tLYy914ow.png"/></div></div></figure><p id="f6c1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.<strong class="kw jg">使用“left_index”和“right_index”参数:</strong>这些是布尔参数——将它们设置为True以表明您想要使用<strong class="kw jg">索引</strong>作为您的连接键:</p><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="6f41" class="nc mg jf nz b gy od oe l of og">companies.merge(stock_price, how = ‘left’, left_index = True, right_index = True)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi or"><img src="../Images/271831a6736560f3efc8feeb8fe203c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsKuf_qwtsVDLHmM_qr5Vg.png"/></div></div></figure><p id="fa51" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，如果您想要连接多个键，您可以简单地将列名列表传递给“on”、“left_on”或“right_on”参数。</p><p id="76c5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另请注意，根据您的使用情况，您可以混合搭配“left_on”、“right_on”、“left_index”和“right_index”。</p><h1 id="b34f" class="mf mg jf bd mh mi mj mk ml mm mn mo mp kl mq km mr ko ms kp mt kr mu ks mv mw bi translated">“加入”方法</h1><p id="df86" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">join方法实际上非常类似于merge方法。关键的区别在于连接方法<strong class="kw jg">强制</strong>使用右连接键的索引，默认使用左连接键的索引:</p><pre class="nq nr ns nt gt ny nz oa ob aw oc bi"><span id="5e0f" class="nc mg jf nz b gy od oe l of og">companies.join(stock_price, how = ‘left’)</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi os"><img src="../Images/80c81f3c5a3144453c0dcf650983ec05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qwg0rJm6rxCdMHQUjW_CGQ.png"/></div></div></figure><p id="b70a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您总是喜欢索引连接，您可能会发现这更容易，因为它需要的参数更少。</p><p id="92f0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一个区别非常小join方法默认将“how”参数设置为“left ”,而merge方法默认为“inner”。</p><h1 id="f56d" class="mf mg jf bd mh mi mj mk ml mm mn mo mp kl mq km mr ko ms kp mt kr mu ks mv mw bi translated">我的偏好</h1><p id="830b" class="pw-post-body-paragraph ku kv jf kw b kx mx kg kz la my kj lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">就个人而言，我更喜欢使用merge方法并用“on”参数连接列。如果我需要重命名列，就简单性和可读性而言，这是值得的。</p><p id="6f17" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但这只是我的看法。关于pandas的一个伟大的事情是，它为您提供了很大程度的灵活性来选择最适合您的语法。编码快乐！</p><figure class="nq nr ns nt gt iv"><div class="bz fp l di"><div class="ot ou l"/></div></figure></div></div>    
</body>
</html>