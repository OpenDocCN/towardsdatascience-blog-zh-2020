<html>
<head>
<title>Pandas Apply for Power Users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫申请电力用户</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-apply-for-power-users-f44d0e0025ce?source=collection_archive---------41-----------------------#2020-10-02">https://towardsdatascience.com/pandas-apply-for-power-users-f44d0e0025ce?source=collection_archive---------41-----------------------#2020-10-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="71b9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过学习熊猫内置的apply()函数成为超级用户</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0745d20ebe339153be6028ac67537d80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*prCkCiVAGf70oWqF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@ttrapani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托德·特拉帕尼</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="47f0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="fc13" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们的数据科学职业生涯中，我们会遇到质量差的数据，无论是部分完成的记录还是格式不正确的属性。作为一名成功的数据科学家，能够管理质量差的数据已经成为一项至关重要的技能。</p><p id="4aad" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">令人欣慰的是，已经开发了许多库，如<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/index.html#" rel="noopener ugc nofollow" target="_blank"> Pandas </a>，我们可以用它们来有效地操作数据集。今天我们来看看如何利用熊猫的内置功能。apply()学习如何操作数据集。</p><h1 id="04e2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">熊猫应用功能</h1><p id="60a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">pandas apply函数顾名思义，它允许你在一个<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">数据帧</a>的轴上或一个<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/series.html" rel="noopener ugc nofollow" target="_blank">系列</a>上应用一个函数。当需要在重新格式化或清理数据的情况下操作列或行时，这个函数非常强大。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示应用函数及其参数的Python代码片段</p></figure><p id="225e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第一个参数<code class="fe mu mv mw mx b">func</code>允许你传入一个函数。这可以是一个导入包中的函数，一个你在脚本中声明的函数，甚至是一个lambda函数。下面的python代码片段演示了如何在第21–23行之间传递三种不同类型的函数。这里我们通过传递产生相同结果的三个不同的函数来创建由Pandas <code class="fe mu mv mw mx b">.apply()</code>函数生成的三个新列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码片段显示了可以传递给应用函数的不同类型的函数。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/6fa5b1e8715719328683ba7c4fa80e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*lDzHyzWLi2eUG9x_R03fkw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">控制台输出显示了执行上述代码片段的结果。</p></figure><p id="9ccf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第二个参数<code class="fe mu mv mw mx b">axis</code>允许您定义函数将应用于哪个轴。这可以是数据框中行的<code class="fe mu mv mw mx b">0</code>或<code class="fe mu mv mw mx b">index</code>，也可以是列的<code class="fe mu mv mw mx b">1</code>或<code class="fe mu mv mw mx b">columns</code>。就个人而言，我更喜欢使用<code class="fe mu mv mw mx b">index</code>和<code class="fe mu mv mw mx b">columns</code>，因为对于那些不理解<code class="fe mu mv mw mx b">0</code>和<code class="fe mu mv mw mx b">1</code>背后含义的人来说，这可以提高代码的可读性。第三个参数<code class="fe mu mv mw mx b">raw</code>决定传递的是行还是列，还是n维数组(<a class="ae ky" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html" rel="noopener ugc nofollow" target="_blank"> ndarray </a>)对象。如果<code class="fe mu mv mw mx b">raw=False</code>被传递，则行或列作为<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html" rel="noopener ugc nofollow" target="_blank">系列</a>被传递给应用函数，如果<code class="fe mu mv mw mx b">raw=True</code>被传递，则ndarray对象被传递给函数。</p><p id="1a36" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">参数<code class="fe mu mv mw mx b">result_type</code>改变应用函数如何应用于数据帧的列轴。默认情况下<code class="fe mu mv mw mx b">result_type</code>设置为<code class="fe mu mv mw mx b">None</code>，但是，可以接受<code class="fe mu mv mw mx b">expand</code> <code class="fe mu mv mw mx b">broadcast</code>和<code class="fe mu mv mw mx b">reduce</code>。如果<code class="fe mu mv mw mx b">expand</code>被传递，则返回的任何列表类型结果都将跨列展开。如果返回列表的长度大于数据帧中的列数，则将创建额外的列来扩展。在列表扩展期间，数据帧的原始列名将被覆盖为范围索引。如果需要保留数据框的原始形状，那么可以传递<code class="fe mu mv mw mx b">broadcast</code>，这也将确保保留原始的列名。如果你需要确保列表类型的结果不被扩展，那么你可以将<code class="fe mu mv mw mx b">reduce</code>传递给<code class="fe mu mv mw mx b">result_type</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码片段显示了熊猫应用结果类型可以接受的不同参数。</p></figure><p id="acac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后一个参数<code class="fe mu mv mw mx b">args=()</code>允许您将值传递给正在应用的函数。在下面的例子中，我们将传递<code class="fe mu mv mw mx b">25</code>和<code class="fe mu mv mw mx b">75</code>作为函数<code class="fe mu mv mw mx b">between_range()</code>的<code class="fe mu mv mw mx b">lower</code>和<code class="fe mu mv mw mx b">higher</code>参数。当该函数应用于该列时，将评估<code class="fe mu mv mw mx b">result</code>系列中的每个值是在该值范围之内还是之外，并将在<code class="fe mu mv mw mx b">in_range</code>列中返回一个布尔值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python代码片段展示了如何将arge=()与Pandas内置函数apply()一起使用。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/30b2716c6953b184fdfcd20f05cfb785.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*7gmwEeSHyLaVCSXGP8-7Sw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示在args=()内调用between_range()的结果的控制台输出。</p></figure><h1 id="d6f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="8214" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Pandas内置的apply()函数是一个非常强大的工具，在处理质量差的数据时，它是一个非常好的工具。它提供了一种沿数据帧的轴应用函数来清理或操作数据的有效方法。apply()函数可以灵活地传递参数，这将允许您处理几乎所有的数据质量问题。</p><p id="2483" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您花时间阅读我们的故事，我们希望您已经发现它的价值:)</p></div></div>    
</body>
</html>