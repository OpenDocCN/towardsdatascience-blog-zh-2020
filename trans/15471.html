<html>
<head>
<title>How Efficient is Machine Learning to Detect Exoplanets?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习探测系外行星的效率有多高？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-efficient-is-machine-learning-to-detect-exoplanets-78037f502b73?source=collection_archive---------26-----------------------#2020-10-24">https://towardsdatascience.com/how-efficient-is-machine-learning-to-detect-exoplanets-78037f502b73?source=collection_archive---------26-----------------------#2020-10-24</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><blockquote class="jr"><p id="11ee" class="js jt iu bd ju jv jw jx jy jz ka kb dk translated"><em class="kc">“在某个地方，一些不可思议的事情正等待被知晓。”卡尔·萨根</em></p></blockquote><figure class="ke kf kg kh ki kj gi gj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gi gj kd"><img src="../Images/61f4ce05a7b7027445befebb8f527bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZlCrBZCu1XyMHoRh"/></div></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">照片由<a class="ae ku" href="https://unsplash.com/@grakozy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">格雷格·拉科齐</a>在<a class="ae ku" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="9b9c" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">我们生活在一个其规模超出我们想象的宇宙中。这个事实让我们质疑我们在宇宙中的位置，很自然地，我们问了这个问题:“我们在宇宙中是孤独的吗？”。它确实是一个大宇宙，只是观测部分覆盖了10颗⁴估计的恒星和50×10颗与地球相似的行星。</p><p id="2084" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">当我看着这些数字时，我会说，“哇，除了我们的星球之外，一定还有生命。”但是，我们没有任何证据来证明这一点，除了最近在金星的大气中发现的磷化氢。尽管如此，它并不是完全可靠的。今天，在望远镜、人造卫星和计算机等技术的帮助下，我们有可能研究其他恒星周围的行星。我们正在努力寻找像我们一样的其他行星和太阳系。</p><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gi gj ls"><img src="../Images/947184b545bb181cf7b21a2729e207c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nti42knQ1ANQfsfjaZ_hkA.jpeg"/></div></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">版权所有:欧空局</p></figure><p id="92a2" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">所以，出于对天文学的好奇，我决定在<a class="ae ku" href="https://exoplanetarchive.ipac.caltech.edu/" rel="noopener ugc nofollow" target="_blank"> Nasa的系外行星档案</a>上开发一个机器学习项目。通过这个项目，我的目标是测量M.L算法寻找其他行星的效率。</p></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h2 id="0fb9" class="me mf iu bd mg mh mi dn mj mk ml dp mm lg mn mo mp lk mq mr ms lo mt mu mv mw bi translated">什么是系外行星？</h2><p id="c725" class="pw-post-body-paragraph kv kw iu kx b ky mx la lb lc my le lf lg mz li lj lk na lm ln lo nb lq lr kb in bi translated">系外行星是指在太阳系外围绕恒星运行的行星。搜寻系外行星有两个任务:开普勒，现在已经结束了，还有继续进行的Tess任务。这些年来，这些望远镜发现了许多系外行星。因此，我提取了观测恒星的数据集，以便找到系外行星。</p><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div class="gi gj nc"><img src="../Images/98da24a401cebbf51b199fbcf615f5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*I9af-jNeVoITCKhBTzD0ug.gif"/></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">版权所有:欧空局</p></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="f9b3" class="nd mf iu bd mg ne nf ng mj nh ni nj mm nk nl nm mp nn no np ms nq nr ns mv nt bi translated">第一步:数据知识</h1><p id="1ea2" class="pw-post-body-paragraph kv kw iu kx b ky mx la lb lc my le lf lg mz li lj lk na lm ln lo nb lq lr kb in bi translated">提取的Nasa数据集包含9564行和141列，这些列是关于恒星的特征，但我只需要每个恒星的时序通量数据。因此，我使用了<code class="fe nu nv nw nx b">lightkurve</code>包来维护时序流量数据。</p><pre class="lt lu lv lw gu ny nx nz oa aw ob bi"><span id="5cdc" class="me mf iu nx b gz oc od l oe of">#method to gather flux data<br/>def TFsinglestarpipe(kepid):<br/>    try:<br/>        tpf = KeplerTargetPixelFile.from_archive(kepid, quarter = 1)<br/>        lc = tpf.to_lightcurve(aperture_mask=tpf.pipeline_mask)<br/>        flat, trend = lc.flatten(window_length=301, return_trend=True)<br/>        df = flat.to_pandas()</span><span id="a5db" class="me mf iu nx b gz og od l oe of">df['KeplerID'] = kepid<br/>        df = df.drop(columns = ['time', <br/>                        'flux_err', <br/>                        'quality', <br/>                        'centroid_row', <br/>                        'centroid_col',<br/>                        'KeplerID'], axis=1)<br/>    <br/>        df = df.reset_index(drop=True)<br/>        df.index.names = [kepid]<br/>        flux = df['flux']<br/>        array = list(flux)<br/>        return array<br/>    except:<br/>        return None</span></pre><p id="da52" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">在收集通量数据后，我得到了一个包含7888行和1627行的数据集——其中一列是disposition feature，它指示了一颗恒星是否存在系外行星的状态。</p><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gi gj oh"><img src="../Images/cc92e670533a1583d3be77aaeb3728ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l0pGnkcyq3nSBQFesa4dzw.png"/></div></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">有系外行星和无系外行星恒星的归一化通量水平。作者图片</p></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="e432" class="nd mf iu bd mg ne nf ng mj nh ni nj mm nk nl nm mp nn no np ms nq nr ns mv nt bi translated">步骤2:特征工程</h1><p id="887b" class="pw-post-body-paragraph kv kw iu kx b ky mx la lb lc my le lf lg mz li lj lk na lm ln lo nb lq lr kb in bi translated">嗯，我的数据集是时间序列，不太适合机器学习算法，因为它有1626列。因此，我决定创建自己的数据集，其中包含更多的特征。<br/>首先，我定义了具有统计显著性的特征:</p><pre class="lt lu lv lw gu ny nx nz oa aw ob bi"><span id="9836" class="me mf iu nx b gz oc od l oe of">#median flux<br/>medians = []<br/>for i in range(len(df)):<br/>    medians.append(np.median(df_values[i]))<br/>#std<br/>stds = []<br/>for i in range(len(df)):<br/>    stds.append(np.std(df_values[i]))<br/>#min flux<br/>minimum = []<br/>for i in range(len(df)):<br/>    minimum.append(np.amin(df_values[i]))<br/>#max flux<br/>maximum = []<br/>for i in range(len(df)):<br/>    maximum.append(np.amax(df_values[i]))<br/>#first percentile<br/>frst_perc = []<br/>for i in range(len(df)):<br/>    frst_perc.append(np.percentile(df_values[i], 1))</span><span id="ebb6" class="me mf iu nx b gz og od l oe of">#third percentile<br/>thrd_perc = []<br/>for i in range(len(df)):<br/>    thrd_perc.append(np.percentile(df_values[i], 3))</span><span id="4bb6" class="me mf iu nx b gz og od l oe of">#fifth percentile <br/>fifth_perc = []<br/>for i in range(len(df)):<br/>    fifth_perc.append(np.percentile(df_values[i], 5))  <br/>  <br/>#seventh percentile<br/>seventh_perc = []<br/>for i in range(len(df)):<br/>    seventh_perc.append(np.percentile(df_values[i], 7))  <br/>  <br/>#delta<br/>delta = []<br/>for i in range(len(df)):<br/>    delta.append(maximum[i]-minimum[i])</span></pre><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="gi gj oi"><img src="../Images/081b3c3ec2035f8b1c1dabac12adf856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FmGGf5u_ehkbLivd6c9tCA.png"/></div></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">新约简数据集的相关矩阵。作者图片</p></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="6ac0" class="nd mf iu bd mg ne nf ng mj nh ni nj mm nk nl nm mp nn no np ms nq nr ns mv nt bi translated">步骤3:分类模型</h1><p id="3e32" class="pw-post-body-paragraph kv kw iu kx b ky mx la lb lc my le lf lg mz li lj lk na lm ln lo nb lq lr kb in bi translated">各种算法可用于分类任务。我从逻辑回归、朴素贝叶斯、SVC等基本模型开始，然后跳到随机森林等集合模型。</p><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/8afa01467a372f03c5c6fd7bc9e42359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*bp4lCrxmmksXLtxeTOK44Q.png"/></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">作者图片</p></figure><p id="6dc9" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">我的方法是，在运行完本节中的所有模型后，选择最佳模型进行优化。因此，我用默认参数运行了所有的模型，以查看结果。左图是我分类模型的结果。</p><p id="4c68" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">我在Bagging分类器上得到最好的测试精度，因此我用它进行网格搜索。</p><pre class="lt lu lv lw gu ny nx nz oa aw ob bi"><span id="a242" class="me mf iu nx b gz oc od l oe of">n_est = [60, 80, 100, 120, 140, 160, 180, 200]<br/>max_features_opt = [0.88, 0.91, 0.93, 0.95, 0.97, 0.99]</span><span id="0f09" class="me mf iu nx b gz og od l oe of">param_grid = dict(n_estimators = n_est, max_features = max_features_opt)</span><span id="a0e5" class="me mf iu nx b gz og od l oe of"># GridSearchCV on the Bagging Classifier model to make it more robust<br/># Cross-validation<br/>kf = KFold(n_splits = 10, shuffle = True, random_state = 76)<br/>bag_grid = GridSearchCV(bag, param_grid, cv=kf, scoring='accuracy',<br/>                      n_jobs=-1, verbose=1)<br/>bag_grid.fit(X_train, y_train)</span></pre><p id="2be2" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">于是，我用<code class="fe nu nv nw nx b">GridSearchCV</code>调了调我的模型的参数，结果得到了65，8%的准确率分数。以下是优化模型的相关矩阵:</p><figure class="lt lu lv lw gu kj gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/09620525e0c7942a21d0b94669efaac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*lkoXzXY3ECmatDTRZSMnGg.png"/></div><p class="kq kr gk gi gj ks kt bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><h1 id="3b51" class="nd mf iu bd mg ne nf ng mj nh ni nj mm nk nl nm mp nn no np ms nq nr ns mv nt bi translated">步骤4:结论和进一步的工作</h1><ul class=""><li id="ea1f" class="ol om iu kx b ky mx lc my lg on lk oo lo op kb oq or os ot bi translated">我通过定义的模型得到的最好结果是大约67%的测试准确度。</li><li id="bbde" class="ol om iu kx b ky ou lc ov lg ow lk ox lo oy kb oq or os ot bi translated">我可以说M.L模型不太擅长寻找系外行星。但这并不是彻底的失败。</li><li id="032d" class="ol om iu kx b ky ou lc ov lg ow lk ox lo oy kb oq or os ot bi translated">根据特征重要性表，确定系外行星候选的最大因素是最小通量。</li></ul><p id="4bf4" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">作为进一步的工作:</p><ul class=""><li id="cc17" class="ol om iu kx b ky kz lc ld lg oz lk pa lo pb kb oq or os ot bi translated">我计划将TESS数据纳入项目中。</li><li id="5be4" class="ol om iu kx b ky ou lc ov lg ow lk ox lo oy kb oq or os ot bi translated">视觉识别和神经模型可以添加到项目中。</li></ul></div><div class="ab cl lx ly hy lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="in io ip iq ir"><p id="e304" class="pw-post-body-paragraph kv kw iu kx b ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr kb in bi translated">此外，如果你想了解更多，也可以看看我的<a class="ae ku" href="https://github.com/alpercakr/Planet-Hunting-and-Habitability-Detection-with-Machine-Learning" rel="noopener ugc nofollow" target="_blank"> Github </a>简介！</p></div></div>    
</body>
</html>