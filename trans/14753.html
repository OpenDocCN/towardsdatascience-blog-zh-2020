<html>
<head>
<title>How to build a KNN classification model from scratch and visualize it using Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä»å¤´å¼€å§‹æ„å»ºKNNåˆ†ç±»æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨Streamlitå¯¹å…¶è¿›è¡Œå¯è§†åŒ–</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418?source=collection_archive---------29-----------------------#2020-10-11">https://towardsdatascience.com/how-to-build-a-knn-classification-model-from-scratch-and-visualize-it-using-streamlit-9fe8059cc418?source=collection_archive---------29-----------------------#2020-10-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ecb3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">è™½ç„¶åƒsklearnè¿™æ ·çš„å›¾ä¹¦é¦†è®©æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œä½†æ˜¯ä»å¤´å¼€å§‹åˆ¶ä½œä¸€ä¸ªæ¨¡å‹æ€»æ˜¯ä¸€ä¸ªå¥½çš„å®è·µã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»å¤´æ„å»ºä¸€ä¸ªKNNåˆ†ç±»æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨Streamlitæ„å»ºä¸€ä¸ªwebåº”ç”¨ç¨‹åºå¯¹å…¶è¿›è¡Œå¯è§†åŒ–ã€‚ä¸‹é¢æ˜¯æœ€ç»ˆåº”ç”¨ç¨‹åºçš„æ¼”ç¤ºã€‚</h2></div><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/7ee15d192cfac0c3943c37bc28a9bfe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*8g8p7TCmmp51JRwVxSxOVg.gif"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">æœ€ç»ˆStreamlitåº”ç”¨çš„æˆªå±</p></figure><h1 id="08a9" class="lc ld it bd le lf lg lh li lj lk ll lm jz ln ka lo kc lp kd lq kf lr kg ls lt bi translated">KNNæ¦‚è¿°</h1><p id="e1f4" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">KNNæˆ–Kè¿‘é‚»ç”¨äºåˆ†ç±»å’Œå›å½’ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒè¿›è¡Œåˆ†ç±»ã€‚ç”±äºç›®æ ‡æ ‡ç­¾æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ç§æœ‰ç›‘ç£çš„ç®—æ³•ã€‚å®ƒæœ¬è´¨ä¸Šæ¥å—ä¸€ä¸ªè¾“å…¥ï¼Œå¹¶æ‰¾åˆ°Kä¸ªæœ€æ¥è¿‘å®ƒçš„ç‚¹ã€‚ç„¶åæ£€æŸ¥æœ€è¿‘ç‚¹çš„æ ‡æ³¨ï¼Œå¹¶å°†è¾“å…¥åˆ†ç±»ä¸ºå‡ºç°æ¬¡æ•°æœ€å¤šçš„æ ‡æ³¨ã€‚å‡è®¾æˆ‘ä»¬æƒ³è¦å»ºç«‹ä¸€ä¸ªæ¨¡å‹ï¼Œæ ¹æ®è¾“å…¥çš„ä½“é‡ã€èº«é«˜å°†åŠ¨ç‰©åˆ†ç±»ä¸ºç‹—æˆ–çŒ«ã€‚å¦‚æœK = 3ï¼Œæˆ‘ä»¬æ‰¾åˆ°ç¦»è¾“å…¥æœ€è¿‘çš„3ä¸ªç‚¹å¹¶æ£€æŸ¥å®ƒä»¬çš„æ ‡ç­¾ã€‚å¦‚æœ3ä¸ªæœ€è¿‘ç‚¹ä¸­çš„2ä¸ªæœ‰æ ‡ç­¾â€œç‹—â€ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°†è¾“å…¥åˆ†ç±»ä¸ºâ€œç‹—â€ã€‚å¦‚æœ3ä¸ªæœ€è¿‘çš„ç‚¹ä¸­çš„2ä¸ªæœ‰æ ‡ç­¾â€œçŒ«â€ï¼Œæˆ‘ä»¬çš„æ¨¡å‹å°†è¾“å…¥åˆ†ç±»ä¸ºâ€œçŒ«â€</p><h2 id="11c1" class="mq ld it bd le mr ms dn li mt mu dp lm md mv mw lo mh mx my lq ml mz na ls nb bi translated">æ­¥ä¼</h2><ul class=""><li id="3119" class="nc nd it lw b lx ly ma mb md ne mh nf ml ng mp nh ni nj nk bi translated">æ ‡å‡†åŒ–æ•°æ®é›†å¹¶å­˜å‚¨å®ƒï¼Œå³ç¡®ä¿æ‰€æœ‰å€¼éƒ½åœ¨0å’Œ1ä¹‹é—´ã€‚</li><li id="c974" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated">å–ä¸€ä¸ªè¾“å…¥æ•°æ®ç‚¹ï¼Œå¹¶ä»æ•°æ®é›†ä¸­çš„æ‰€æœ‰è®°å½•ä¸­æ‰¾å‡ºè·ç¦»ã€‚å°†è·ç¦»å­˜å‚¨åœ¨åˆ—è¡¨ä¸­ã€‚</li><li id="320d" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated">å¯¹åŒ…å«è·ç¦»çš„åˆ—è¡¨è¿›è¡Œæ’åºï¼Œå¹¶æ£€æŸ¥æ’åºåˆ—è¡¨ä¸­å‰Kæ¡è®°å½•çš„æ ‡ç­¾</li><li id="a3e0" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated">å°†è¾“å…¥åˆ†ç±»ä¸ºåœ¨å‰Kæ¡è®°å½•ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ ‡ç­¾</li></ul><blockquote class="nq nr ns"><p id="0f5a" class="lu lv nt lw b lx nu ju lz ma nv jx mc nw nx mf mg ny nz mj mk oa ob mn mo mp im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»ºæ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„åŠ©æ‰‹å‡½æ•°ã€‚ç„¶åæˆ‘ä»¬å†æŠŠå®ƒä»¬ç»“åˆèµ·æ¥ï¼ŒåŠ å…¥ä¸€äº›streamlitå‡½æ•°ï¼Œæ„å»ºä¸€ä¸ªweb appã€‚</p></blockquote><p id="de53" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ä¸ºäº†ä¾¿äºç†è§£å’Œå¯è§†åŒ–ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å…·æœ‰2ä¸ªè¦ç´ å’ŒäºŒè¿›åˆ¶æ ‡ç­¾(å³â€œ0â€å’Œâ€œ1â€)çš„æ•°æ®é›†ã€‚</p><h1 id="895b" class="lc ld it bd le lf lg lh li lj lk ll lm jz ln ka lo kc lp kd lq kf lr kg ls lt bi translated"><strong class="ak">åŠ©æ‰‹åŠŸèƒ½</strong></h1><h2 id="bc31" class="mq ld it bd le mr ms dn li mt mu dp lm md mv mw lo mh mx my lq ml mz na ls nb bi translated">æ ‡å‡†åŒ–æ•°æ®çš„å‡½æ•°</h2><p id="652d" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">ä¸ºäº†è§„èŒƒåŒ–ä¸€ä¸ªå€¼åˆ—è¡¨ï¼Œæˆ‘ä»¬è¿­ä»£æ¯ä¸ªå€¼ï¼Œå¹¶æ‰¾åˆ°åˆ—è¡¨ä¸­çš„å€¼å’Œæœ€å°å€¼ä¹‹é—´çš„å·®ã€‚ç„¶åæˆ‘ä»¬å°†å®ƒé™¤ä»¥åˆ—è¡¨ä¸­æœ€å¤§å€¼å’Œæœ€å°å€¼çš„å·®ã€‚</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/bec07d2d5ded925871d00b1eb7794c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/1*oA32uOqzHBydiO536GeY1Q.gif"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">æ ‡å‡†åŒ–æ•°æ®çš„æ–¹ç¨‹å¼</p></figure><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="79f8" class="mq ld it oe b gy oi oj l ok ol"><em class="nt">def</em> <strong class="oe iu">min_max_normalize(<em class="nt">lst</em>)</strong>:<br/>    minimum = min(lst)<br/>    maximum = max(lst)<br/>    normalized = [(val - minimum)/(maximum - minimum) for val in <br/>    lst]                               <br/>    return normalized</span></pre><p id="0eb0" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå€¼åˆ—è¡¨ï¼Œå¹¶è¿”å›è§„èŒƒåŒ–çš„å€¼</p><h2 id="a076" class="mq ld it bd le mr ms dn li mt mu dp lm md mv mw lo mh mx my lq ml mz na ls nb bi translated">è®¡ç®—æ¬§å‡ é‡Œå¾·è·ç¦»çš„å‡½æ•°</h2><p id="3b0b" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">è¯¥å‡½æ•°å°†ç”¨äºè®¡ç®—ä¸¤ä¸ªç»™å®šç‚¹ä¹‹é—´çš„è·ç¦»ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ¬§å‡ é‡Œå¾·å…¬å¼æ¥è®¡ç®—è·ç¦»ã€‚</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/7159b9c266355dcde8c1d35559084213.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/1*eL2PsgWIa7y_l3IA0eaTfA.gif"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">è®¡ç®—æ¬§å‡ é‡Œå¾·è·ç¦»çš„å…¬å¼</p></figure><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="4e41" class="mq ld it oe b gy oi oj l ok ol"><em class="nt">def</em> <strong class="oe iu">distance(<em class="nt">element1</em> , <em class="nt">element2</em>):</strong><br/>    x_distance = (element1[0] - element2[0])**2<br/>    y_distance = (element1[1] - element2[1])**2<br/>    return (x_distance + y_distance)**0.5</span></pre><p id="c176" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">è¯¥å‡½æ•°æ¥å—ä¸¤ä¸ª2Dç‚¹ï¼Œå¹¶è¿”å›å®ƒä»¬ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦»ã€‚ç”±äºæˆ‘ä»¬è€ƒè™‘çš„æ•°æ®é›†åªæœ‰ä¸¤ä¸ªè¦ç´ ï¼Œå› æ­¤æˆ‘ä»¬åªè€ƒè™‘xå’Œyåæ ‡ã€‚éšç€ç‰¹å¾æ•°é‡çš„å¢åŠ ï¼Œè¯¥å‡½æ•°å°†éœ€è¦æ”¹å˜ä»¥æ‰¾åˆ°æ‰€æœ‰æŒ‡æ•°ä¹‹é—´çš„å¹³æ–¹å·®ã€‚</p><h2 id="b175" class="mq ld it bd le mr ms dn li mt mu dp lm md mv mw lo mh mx my lq ml mz na ls nb bi translated"><strong class="ak">æŸ¥æ‰¾è¾“å…¥ç‚¹å’Œæ•°æ®é›†ä¸­æ‰€æœ‰ç‚¹ä¹‹é—´è·ç¦»çš„å‡½æ•°</strong></h2><p id="b2fc" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">æˆ‘ä»¬è¿­ä»£æ•°æ®é›†ä¸­çš„æ¯ä¸ªå€¼ï¼Œå¹¶ä½¿ç”¨ä¸Šé¢çš„<strong class="lw iu"> <em class="nt">è·ç¦»</em> </strong> <em class="nt"> </em>å‡½æ•°æ¥è®¡ç®—ä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚ç„¶åï¼Œæˆ‘ä»¬å­˜å‚¨è·ç¦»å¹¶è¿›è¡Œæ’åºã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="114f" class="mq ld it oe b gy oi oj l ok ol"><em class="nt">def</em> <strong class="oe iu">find_nearest(<em class="nt">x</em> , <em class="nt">y</em> , <em class="nt">input</em> , <em class="nt">k</em>):<br/>    </strong>distances = []<br/>    for id,element in enumerate(x):<br/>        distances.append([distance(input , element),id])<br/>    distances = sorted(distances)<br/>    predicted_label = get_label(distances[0:k] , y)<br/>    return predicted_label, distances[0:k] , distances[k:]</span></pre><p id="8904" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">è¯¥å‡½æ•°å°†ä»¥ä¸‹å‚æ•°ä½œä¸ºè¾“å…¥:</p><ul class=""><li id="f508" class="nc nd it lw b lx nu ma nv md on mh oo ml op mp nh ni nj nk bi translated"><strong class="lw iu"> x: </strong>è¿™æ˜¯åŒ…å«è¿™ä¸¤ä¸ªç‰¹å¾çš„æ•°æ®é›†</li><li id="642e" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated"><strong class="lw iu"> y: </strong>è¿™åŒ…å«äº†<strong class="lw iu"> x </strong>ä¸­æ¯ä¸€è¡Œçš„æ ‡ç­¾ã€‚å®ƒä»¬æ˜¯åˆ†åˆ«æ˜ å°„çš„ï¼Œå³<strong class="lw iu"> x[i] </strong>çš„æ ‡ç­¾æ˜¯<strong class="lw iu"> y[i] </strong></li><li id="c6ac" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated"><strong class="lw iu">è¾“å…¥:</strong>è¿™æ˜¯ä¸€ä¸ª2Dæ•°ç»„ï¼ŒåŒ…å«æˆ‘ä»¬æƒ³è¦åˆ†ç±»çš„ç‚¹çš„ç‰¹å¾</li><li id="4b9f" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp nh ni nj nk bi translated">k: æˆ‘ä»¬å¸Œæœ›æ¨¡å‹è€ƒè™‘çš„æœ€è¿‘é‚»çš„æ•°é‡</li></ul><p id="5349" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„æ¥å­˜å‚¨è·ç¦»ã€‚æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®é›†ä¸­å­˜å‚¨è®°å½•çš„è·ç¦»å’Œç´¢å¼•ã€‚è¯¥ç´¢å¼•å¯ä»¥åœ¨<strong class="lw iu"> y </strong>æ•°ç»„ä¸­ä½¿ç”¨ï¼Œä»¥æ‰¾åˆ°è¯¥è®°å½•çš„æ ‡ç­¾ã€‚</p><p id="5533" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ç„¶åæˆ‘ä»¬å¯¹è·ç¦»è¿›è¡Œæ’åºã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨<strong class="lw iu"> get_label </strong>å‡½æ•°(å°†åœ¨ä¸‹é¢è®¨è®º)æ¥è·å–æœ€å¸¸å‡ºç°çš„æ ‡ç­¾ã€‚</p><p id="3ebb" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ç”±äº<strong class="lw iu">è·ç¦»</strong>æ•°ç»„è¢«æ’åºï¼Œå‰kä¸ª<strong class="lw iu"> </strong>å…ƒç´ ï¼Œå³<strong class="lw iu">è·ç¦»ã€0:kã€‘</strong>æ˜¯æˆ‘ä»¬è¾“å…¥çš„kä¸ªæœ€è¿‘é‚»ã€‚æˆ‘ä»¬è¿”å›è¾“å…¥çš„é¢„æµ‹æ ‡ç­¾ã€kä¸ªæœ€è¿‘çš„é‚»å±…å’Œå…¶ä½™çš„é‚»å±…ã€‚</p><h2 id="1bc8" class="mq ld it bd le mr ms dn li mt mu dp lm md mv mw lo mh mx my lq ml mz na ls nb bi translated"><strong class="ak">æŸ¥æ‰¾æœ€å¸¸å‡ºç°çš„æ ‡ç­¾çš„åŠŸèƒ½</strong></h2><p id="13a3" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">æˆ‘ä»¬åŸºæœ¬ä¸Šå¾—åˆ°kä¸ªæœ€è¿‘çš„é‚»å±…ï¼Œæ£€æŸ¥æ¯ä¸ªé‚»å±…çš„æ ‡ç­¾ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªæ ‡ç­¾â€œ0â€å’Œâ€œ1â€ã€‚å¦‚æœé‚»å±…çš„æ ‡ç­¾æ˜¯â€œ0 â€,æˆ‘ä»¬å¯¹â€œ0â€çš„å‡ºç°å¢åŠ è®¡æ•°ï¼Œå¹¶å¯¹â€œ1â€è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚æˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªæ ‡ç­¾å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶è¿”å›è®¡æ•°è¾ƒé«˜çš„æ ‡ç­¾ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="782d" class="mq ld it oe b gy oi oj l ok ol"><em class="nt">def</em> <strong class="oe iu">get_label(<em class="nt">neighbours</em>, <em class="nt">y</em>):<br/>    </strong>zero_count , one_count = 0,0<br/>    for element in neighbours:<br/>      if y[element[1]] == 0:<br/>         zero_count +=1<br/>      elif y[element[1]] == 1:<br/>         one_count +=1<br/>    if zero_count == one_count:<br/>         return y[neighbours[0][1]]<br/>    return 1 if one_count &gt; zero_count else 0</span></pre><p id="29da" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">è¯¥å‡½æ•°å°†kä¸ªæœ€è¿‘é‚»ä½œä¸ºè¾“å…¥ã€‚<strong class="lw iu">é‚»å±…</strong>ä¸­çš„æ¯æ¡è®°å½•éƒ½åŒ…å«è·è¾“å…¥ç‚¹çš„è·ç¦»åŠå…¶åŸå§‹idã€‚æˆ‘ä»¬ä½¿ç”¨idå’Œyæ•°ç»„æ¥è·å–è®°å½•çš„æ ‡ç­¾ã€‚ç„¶åæˆ‘ä»¬æ£€æŸ¥æ ‡ç­¾å¹¶è¿”å›é¢„æµ‹çš„æ ‡ç­¾ã€‚</p><blockquote class="oq"><p id="bb90" class="or os it bd ot ou ov ow ox oy oz mp dk translated">æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æ‰€éœ€çš„åŠ©æ‰‹å‡½æ•°ã€‚ç°åœ¨æˆ‘ä»¬å°†å®ƒä»¬ä¸ä¸€äº›streamlitå‡½æ•°ç»“åˆèµ·æ¥ã€‚ä»¤äººå…´å¥‹çš„ä¸œè¥¿ï¼ğŸ˜</p></blockquote><h1 id="cd45" class="lc ld it bd le lf lg lh li lj lk ll lm jz pa ka lo kc pb kd lq kf pc kg ls lt bi translated">å¿…éœ€çš„åº“</h1><p id="050b" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc md me mf mg mh mi mj mk ml mm mn mo mp im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨Plotlyæ¥ç»˜åˆ¶æˆ‘ä»¬çš„å›¾å½¢ï¼Œå› ä¸ºPlotlyç»˜åˆ¶äº¤äº’å¼å›¾å½¢ã€‚å¯¹äºæˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†ä»sklearn.datasetså¯¼å…¥ä¸€ä¸ªæ•°æ®é›†ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="7dad" class="mq ld it oe b gy oi oj l ok ol">import streamlit as st<br/>import pandas as pd<br/>from sklearn.datasets import make_blobs<br/>import plotly.express as px<br/>import plotly.graph_objects as go</span></pre><p id="6860" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘å°†æŠŠæ•™ç¨‹çš„å‰©ä½™éƒ¨åˆ†åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†</p><ol class=""><li id="68d8" class="nc nd it lw b lx nu ma nv md on mh oo ml op mp pd ni nj nk bi translated">ç”¨æˆ·è¾“å…¥</li><li id="f741" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp pd ni nj nk bi translated">å¯¼å…¥æ•°æ®é›†å¹¶å°†å…¶å¯è§†åŒ–</li><li id="71e7" class="nc nd it lw b lx nl ma nm md nn mh no ml np mp pd ni nj nk bi translated">å¯è§†åŒ–é¢„æµ‹</li></ol><h1 id="3aeb" class="lc ld it bd le lf lg lh li lj lk ll lm jz ln ka lo kc lp kd lq kf lr kg ls lt bi translated">ç”¨æˆ·è¾“å…¥</h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="pf pg di ph bf pi"><div class="gh gi pe"><img src="../Images/a22fc0a36f18bf9b7f985c58cf50c664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Us1cYJFJn45oDca21Cc91A.jpeg"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">Appæˆªå›¾</p></figure><p id="8587" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨streamlitçš„<strong class="lw iu"> title </strong>æ–¹æ³•æ˜¾ç¤ºä¸€ä¸ªæ ‡é¢˜ï¼Œä½¿ç”¨<strong class="lw iu"> slider </strong>æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ•°å­—æ»‘å—æ¥è·å–ç”¨æˆ·çš„è¾“å…¥ã€‚ç”±äºæˆ‘ä»¬çš„æ•°æ®æ˜¯æ ‡å‡†åŒ–çš„ï¼Œæˆ‘ä»¬å¸Œæœ›è¾“å…¥ä¹Ÿæ˜¯æ ‡å‡†åŒ–çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é™åˆ¶ç”¨æˆ·è¾“å…¥0åˆ°1ä¹‹é—´çš„å€¼ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä»ç”¨æˆ·é‚£é‡Œè·å–è¾“å…¥ï¼Œå¹¶ä½¿ç”¨æ•°æ®é›†ä¸­çš„æœ€å°å’Œæœ€å¤§å€¼æ¥è§„èŒƒåŒ–è¾“å…¥ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="9856" class="mq ld it oe b gy oi oj l ok ol">st.title("KNN Visualize")</span><span id="ca1a" class="mq ld it oe b gy pj oj l ok ol">x_input = st.slider("Choose X input", <em class="nt">min_value</em>=0.0, <em class="nt">max_value</em>=1.0,<em class="nt">key</em>='x')</span><span id="bbd6" class="mq ld it oe b gy pj oj l ok ol">y_input = st.slider("Choose Y input", <em class="nt">min_value</em>=0.0, <em class="nt">max_value</em>=1.0,<em class="nt">key</em>='y')</span><span id="85af" class="mq ld it oe b gy pj oj l ok ol">k = st.slider("Choose value of K", <em class="nt">min_value</em>=1, <em class="nt">max_value</em>=10,<em class="nt">key</em>='k')</span><span id="75e4" class="mq ld it oe b gy pj oj l ok ol">input = (x_input,y_input)</span></pre><p id="ebd6" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æ¯æ¬¡æ»‘å—å€¼æ›´æ”¹æ—¶ï¼Œæ•´ä¸ªpythonè„šæœ¬éƒ½ä¼šé‡æ–°è¿è¡Œï¼Œå˜é‡å°†æ ¹æ®æ»‘å—åŒ…å«æ–°å€¼ã€‚</p><h1 id="6da2" class="lc ld it bd le lf lg lh li lj lk ll lm jz ln ka lo kc lp kd lq kf lr kg ls lt bi translated">å¯¼å…¥æ•°æ®é›†å¹¶å°†å…¶å¯è§†åŒ–</h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/4861da26ee8af2e7edc4c203ad2f28cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*4ksG_OVow9gH12Ph1TD5cw.jpeg"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">Appæˆªå›¾</p></figure><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="b9d7" class="mq ld it oe b gy oi oj l ok ol">x , y = make_blobs(<em class="nt">n_samples</em> = 100 , <em class="nt">n_features</em> = 2 , <em class="nt">centers</em> = 2, <em class="nt">random_state</em>= 2)</span></pre><p id="8835" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated"><strong class="lw iu"> make_blobs </strong>å‡½æ•°ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®é›†ï¼Œå®ƒçœ‹èµ·æ¥ç±»ä¼¼äºä¸Šå›¾ä¸­çš„åˆ†å¸ƒã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæ•°æ®é›†ä¸ä¼šå¦‚æ­¤åˆä½œï¼Œä½†è¿™ä¸ªæ•°æ®é›†ç°åœ¨å·²ç»è¶³å¤Ÿäº†ã€‚æˆ‘å»ºè®®ä½ ä½¿ç”¨<strong class="lw iu"> matplotlib </strong>ç»˜åˆ¶ä¸€ä¸ªæ•£ç‚¹å›¾ï¼Œçœ‹çœ‹æ•°æ®çš„åˆ†å¸ƒæƒ…å†µã€‚</p><p id="8d5b" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated"><strong class="lw iu"> x </strong>åŒ…å«ç‰¹æ€§ï¼Œ<strong class="lw iu"> y </strong>åŒ…å«å„è‡ªçš„æ ‡ç­¾</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="8822" class="mq ld it oe b gy oi oj l ok ol"># Normalizing Data<br/>x[:,0] = min_max_normalize(x[:,0])<br/>x[:,1] = min_max_normalize(x[:,1])</span><span id="edda" class="mq ld it oe b gy pj oj l ok ol"># Dataframe<br/>df = pd.DataFrame(x , <em class="nt">columns</em> = ['Feature1' , 'Feature2'] )<br/>df['Label'] = y</span><span id="1f42" class="mq ld it oe b gy pj oj l ok ol">st.dataframe(df)</span></pre><p id="79b3" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„è§„èŒƒåŒ–è¾…åŠ©å‡½æ•°æ¥è§„èŒƒåŒ–æˆ‘ä»¬çš„æ•°æ®ã€‚ç„¶åæˆ‘ä»¬ç»“åˆxå’Œyæ•°ç»„æ¥åˆ›å»ºä¸€ä¸ªæ•°æ®å¸§ã€‚æˆ‘ä»¬ä½¿ç”¨streamlitçš„<strong class="lw iu">æ•°æ®å¸§</strong>æ–¹æ³•æ¥æŸ¥çœ‹æ•°æ®å¸§ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="a17f" class="mq ld it oe b gy oi oj l ok ol"># Initial Data Plot</span><span id="85bb" class="mq ld it oe b gy pj oj l ok ol">fig = px.scatter(df, <em class="nt">x</em> = 'Feature1' , <em class="nt">y</em>='Feature2', <em class="nt">symbol</em>='Label',<em class="nt">symbol_map</em>={'0':'square-dot' , '1':'circle'})</span><span id="a749" class="mq ld it oe b gy pj oj l ok ol">fig.add_trace(<br/>    go.Scatter(<em class="nt">x</em>= [input[0]], <em class="nt">y</em>=[input[1]], <em class="nt">name</em> = "Point to  Classify", )<br/>)</span><span id="c227" class="mq ld it oe b gy pj oj l ok ol">st.plotly_chart(fig)</span></pre><p id="f5b1" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ä½ å¯ä»¥é˜…è¯»<a class="ae pl" href="https://plotly.com/python/line-and-scatter/" rel="noopener ugc nofollow" target="_blank"> Plotlyçš„æ–‡æ¡£</a>æ¥æ›´å¥½çš„ç†è§£ä¸Šé¢çš„ä»£ç ã€‚æˆ‘ä»¬ç”¨åˆšåˆšåˆ›å»ºçš„æ•°æ®å¸§çš„æ•£ç‚¹å›¾åˆ›å»ºä¸€ä¸ªå›¾å½¢ã€‚æˆ‘ä»¬è¿˜æ·»åŠ äº†è¾“å…¥ç‚¹ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å®ƒç›¸å¯¹äºæ•°æ®é›†ä¸­å…¶ä»–ç‚¹çš„ä½ç½®ã€‚Streamlitçš„<strong class="lw iu"> plotly_chart </strong>æ–¹æ³•ä»¥plotlyå›¾å½¢ä¸ºå‚æ•°ï¼Œåœ¨æˆ‘ä»¬çš„appä¸Šç»˜åˆ¶äº¤äº’å›¾å½¢ã€‚</p><h1 id="3124" class="lc ld it bd le lf lg lh li lj lk ll lm jz ln ka lo kc lp kd lq kf lr kg ls lt bi translated"><strong class="ak">é¢„æµ‹å¹¶å¯è§†åŒ–å®ƒ</strong></h1><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/0e541cd7f8e958ae75956d8e05b4a1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IJjHc8-PmeMFD079JkWE8g.jpeg"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">Appæˆªå›¾</p></figure><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="b0e6" class="mq ld it oe b gy oi oj l ok ol">#Finding Nearest Neighbours</span><span id="7301" class="mq ld it oe b gy pj oj l ok ol">predicted_label , nearest_neighbours, far_neighbours = find_nearest(x ,y , input ,k)</span><span id="375e" class="mq ld it oe b gy pj oj l ok ol">st.title('Prediction')</span><span id="13c9" class="mq ld it oe b gy pj oj l ok ol">st.subheader('Predicted Label : {}'.format(predicted_label))</span></pre><p id="0bbf" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„find_nearestå‡½æ•°æ¥è·å¾—é¢„æµ‹çš„æ ‡ç­¾å’Œidã€kä¸ªæœ€è¿‘é‚»å±…å’Œè¿œé‚»å±…çš„è·ç¦»ã€‚</p><p id="fa4a" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘ä»¬æ˜¾ç¤ºé¢„æµ‹çš„æ ‡ç­¾us streamlitçš„<strong class="lw iu">å­æ ‡é¢˜</strong>æ–¹æ³•</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="4fbb" class="mq ld it oe b gy oi oj l ok ol">nearest_neighbours = [[neighbour[1],x[neighbour[1],0],x[neighbour[1],1],neighbour[0],y[neighbour[1]]] for neighbour in nearest_neighbours]</span><span id="bc1e" class="mq ld it oe b gy pj oj l ok ol">nearest_neighbours = pd.DataFrame(nearest_neighbours , <em class="nt">columns</em> = ['id','Feature1','Feature2','Distance','Label'])</span><span id="7843" class="mq ld it oe b gy pj oj l ok ol">st.dataframe(nearest_neighbours)</span></pre><p id="0bfb" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ä¸Šè¿°ä»£ç åŸºæœ¬ä¸Šä½¿ç”¨æœ€è¿‘é‚»çš„idï¼Œå¹¶å°†idã€è·ç¦»ä¸è®°å½•åŠå…¶æ ‡æ³¨çš„feature1ã€feature2å€¼ç›¸ç»“åˆã€‚æˆ‘ä»¬ä½¿ç”¨ç»„åˆåˆ—è¡¨æ¥åˆ›å»ºåŒ…å«æœ€è¿‘é‚»å±…ä¿¡æ¯çš„æ•°æ®å¸§ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨streamlitçš„dataframeæ–¹æ³•æ¥æ˜¾ç¤ºå®ƒã€‚è¿™ä¸ªæ•°æ®æ¡†æ¶å°†å¸®åŠ©æˆ‘ä»¬ç†è§£ä¸‹é¢çš„å›¾è¡¨ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="57e9" class="mq ld it oe b gy oi oj l ok ol">far_neighbours = [[neighbour[1],x[neighbour[1],0],x[neighbour[1],1],neighbour[0],y[neighbour[1]]] for neighbour in far_neighbours]</span><span id="3932" class="mq ld it oe b gy pj oj l ok ol">far_neighbours = pd.DataFrame(far_neighbours , <em class="nt">columns</em> = ['id','Feature1','Feature2','Distance','Label'])</span><span id="22cc" class="mq ld it oe b gy pj oj l ok ol">fig2 = px.scatter(far_neighbours,<em class="nt">x</em>='Feature1',<em class="nt">y</em>='Feature2',<em class="nt">symbol</em>='Label',<em class="nt">symbol_map</em>={'0':'square-dot' , '1':'circle'})</span></pre><p id="7008" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘ä»¬ä¸ºè¿œé‚»å±…åˆ›å»ºä¸€ä¸ªç±»ä¼¼çš„æ•°æ®å¸§ã€‚æˆ‘ä»¬ä½¿ç”¨Plotlyæ¥ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚æˆ‘ä»¬ç°åœ¨å°†æ·»åŠ è¾“å…¥å’Œå°†è¾“å…¥è¿æ¥åˆ°å…¶kä¸ªæœ€è¿‘é‚»å±…çš„çº¿ã€‚</p><pre class="kr ks kt ku gt od oe of og aw oh bi"><span id="dec0" class="mq ld it oe b gy oi oj l ok ol">for index,neighbour in nearest_neighbours.iterrows():<br/>    fig2.add_trace(<br/>       go.Scatter( <em class="nt">x</em>=[input[0], neighbour['Feature1']], <em class="nt">y</em>=[input[1],<br/>       neighbour['Feature2']],<em class="nt">mode</em>='lines+markers' , <em class="nt">name</em> = 'id<br/>       {}'.format(<em class="nt">int</em>(neighbour['id'])) )<br/>    )</span><span id="7f4c" class="mq ld it oe b gy pj oj l ok ol">st.plotly_chart(fig2)</span></pre><p id="25b2" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘ä»¬è¿­ä»£æ¯ä¸ªé‚»å±…ï¼Œå¹¶åœ¨é‚»å±…å’Œæˆ‘ä»¬åˆ›å»ºçš„å›¾å½¢çš„è¾“å…¥ç‚¹ä¹‹é—´æ·»åŠ ä¸€æ¡çº¿ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨<strong class="lw iu"> plotly_chart </strong>æ–¹æ³•ç»˜åˆ¶å›¾å½¢ã€‚</p><blockquote class="oq"><p id="52bb" class="or os it bd ot ou ov ow ox oy oz mp dk translated">å°±è¿™æ ·ğŸ‘æˆ‘ä»¬ä»å¤´å¼€å§‹åˆ›å»ºäº†ä¸€ä¸ªKNNåˆ†ç±»å™¨ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªStreamlitåº”ç”¨ç¨‹åºæ¥å¯è§†åŒ–å®ƒ</p></blockquote><p id="9600" class="pw-post-body-paragraph lu lv it lw b lx pn ju lz ma po jx mc md pp mf mg mh pq mj mk ml pr mn mo mp im bi translated">å¦‚æœæ‚¨æœ‰å…´è¶£éƒ¨ç½²æ‚¨çš„streamlitåº”ç”¨ç¨‹åºï¼Œè¯·æŸ¥çœ‹æˆ‘çš„æ•™ç¨‹ã€‚</p><p id="2b3f" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°GitHubå›è´­<a class="ae pl" href="https://github.com/rahulbanerjee26/KNN-Streamlit" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="49f0" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated"><strong class="lw iu">æˆ‘å¯¹æœºå™¨å­¦ä¹ çš„ä¸–ç•Œè¿˜æ˜¯ç›¸å½“é™Œç”Ÿçš„ï¼Œå¦‚æœä½ å‘ç°ä»»ä½•é”™è¯¯æˆ–ä»»ä½•å¯ä»¥ä¼˜åŒ–çš„ä»£ç ï¼Œè¯·è®©æˆ‘çŸ¥é“ï¼æˆ‘æ€»æ˜¯ä¹äºæ¥å—åé¦ˆğŸ˜ƒ</strong></p></div><div class="ab cl ps pt hx pu" role="separator"><span class="pv bw bk pw px py"/><span class="pv bw bk pw px py"/><span class="pv bw bk pw px"/></div><div class="im in io ip iq"><p id="9dc9" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">æˆ‘æœ€è¿‘ç”¨WordPressåˆ›å»ºäº†ä¸€ä¸ªåšå®¢ï¼Œå¦‚æœä½ èƒ½çœ‹çœ‹çš„è¯ï¼Œæˆ‘ä¼šå¾ˆé«˜å…´çš„ğŸ˜ƒ</p><div class="pz qa gp gr qb qc"><a href="https://realpythonproject.com/" rel="noopener  ugc nofollow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd iu gy z fp qh fr fs qi fu fw is bi translated">Pythoné¡¹ç›®æ•™ç¨‹-ä½¿ç”¨è¿™äº›Pythoné¡¹ç›®æ•™ç¨‹æ”¹è¿›æ‚¨çš„ç®€å†/ä½œå“é›†ã€‚</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk translated">ä½¿ç”¨Streamlitå…±äº«éƒ¨ç½²æ‚¨çš„æœºå™¨å­¦ä¹ Webåº”ç”¨ç¨‹åºåœ¨æˆ‘ä»¥å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘è°ˆåˆ°è¿‡æ„å»ºä¸€ä¸ªâ€¦</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">realpythonproject.com</p></div></div></div></a></div><p id="826f" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">åœ¨LinkedInä¸Šä¸æˆ‘è”ç³»</p><div class="pz qa gp gr qb qc"><a href="https://www.linkedin.com/in/rahulbanerjee2699/" rel="noopener  ugc nofollow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd iu gy z fp qh fr fs qi fu fw is bi translated">Rahul baner JEEâ€”â€”äº§å“å·¥ç¨‹å®ä¹ ç”Ÿâ€”â€”EY | LinkedIn</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk translated">æŸ¥çœ‹Rahul Banerjeeåœ¨ä¸–ç•Œä¸Šæœ€å¤§çš„èŒä¸šç¤¾åŒºLinkedInä¸Šçš„ä¸ªäººèµ„æ–™ã€‚æ‹‰èƒ¡å°”æœ‰4ä¸ªå·¥ä½œåˆ—åœ¨ä»–ä»¬çš„â€¦</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">www.linkedin.com</p></div></div><div class="ql l"><div class="qm l qn qo qp ql qq kw qc"/></div></div></a></div><p id="3901" class="pw-post-body-paragraph lu lv it lw b lx nu ju lz ma nv jx mc md nx mf mg mh nz mj mk ml ob mn mo mp im bi translated">åœ¨Twitterä¸Šä¸æˆ‘è”ç³»</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="qr qs l"/></div></figure></div></div>    
</body>
</html>