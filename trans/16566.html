<html>
<head>
<title>A Single Python Function Generating A Gorgeous Bar Chart Race Video</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个Python函数生成了一个精彩的条形图比赛视频</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed?source=collection_archive---------32-----------------------#2020-11-15">https://towardsdatascience.com/a-single-python-function-generating-a-gorgeous-bar-chart-race-video-dd6410b8aed?source=collection_archive---------32-----------------------#2020-11-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/629f4f677a880310b1b7fd3b1109a849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1xiO2o76hITEhx7jV4XKg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/users/shutterbug75-2077322/" rel="noopener ugc nofollow" target="_blank"> Shutterbug75 </a>在<a class="ae jg" href="https://pixabay.com/photos/art-artistic-blue-brown-business-1238602/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="631d" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">从原始数据集到条形图比赛视频的逐步教程</h2></div><p id="2c2f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最近，一种非常奇特的数据可视化方式在YouTube等各种平台上流行起来。只要有一些“实体”具有随时间变化的单一度量，这种类型的可视化就可以完美地说明这些实体之间的动态排序。</p><p id="65c3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是条形图竞赛。它通常可以被看作是一个视频。下面的视频是我自己用一个Python函数生成的。看一看，你就知道我在说什么了。</p><figure class="lu lv lw lx gt iv"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="ee5b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你相信上面的视频是用一个只有几行代码的Python函数生成的吗？我会告诉你怎么做。</p><h2 id="b076" class="ma mb jj bd mc md me dn mf mg mh dp mi lh mj mk ml ll mm mn mo lp mp mq mr ms bi translated">TD；分升</h2><p id="5e0c" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">文章不算太短，因为我想提供一些可以循序渐进的东西。我认为95%的时间我们都在做数据预处理。如果你真的想跳过直接进入正题，请到“<strong class="la jk">生成条形图比赛视频”</strong>部分获取生成视频的代码:)</p><h1 id="54cd" class="my mb jj bd mc mz na nb mf nc nd ne mi kp nf kq ml ks ng kt mo kv nh kw mr ni bi translated">数据准备</h1><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5db64fbfd3333a9d6f6510acbbc33ef9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUn8m3yWHW1uUDsxKs6Gcg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由<a class="ae jg" href="https://pixabay.com/photos/forge-blacksmith-hammer-iron-fire-411923/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上的<a class="ae jg" href="https://pixabay.com/users/tibine-238708/" rel="noopener ugc nofollow" target="_blank"> TiBine </a>拍摄</p></figure><p id="af42" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确保本教程是可实现的，我不仅会提供生成条形图比赛视频的代码，还会提供如何获取数据集并对其进行预处理。因此，准备好的数据集是可操作的，然后可以放入Python中的条形图race库中。</p><h2 id="4d5d" class="ma mb jj bd mc md me dn mf mg mh dp mi lh mj mk ml ll mm mn mo lp mp mq mr ms bi translated">获取原始数据集</h2><p id="ec06" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我使用的数据集是由欧洲疾病预防和控制中心提供的，可以公开获得。每个人都可以免费下载新冠肺炎数据集。我在以前的一篇文章中也使用了这个数据集。</p><p id="6ef3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/3-lines-of-python-code-to-create-an-interactive-playable-covid-19-bubble-map-74807939e887"> 3行Python代码创建一个交互式可玩的新冠肺炎泡泡地图</a></p><p id="51b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">官网在这里:</p><p id="a1a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide" rel="noopener ugc nofollow" target="_blank">https://www . ecdc . Europa . eu/en/publications-data/download-todays-data-geographic-distribution-新冠肺炎-cases-worldwide </a></p><p id="4cbe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的网页上有一个链接，我们可以下载CSV格式的数据集。事实上，我们不必将数据集下载到本地机器，因为Pandas Dataframe可以直接读取远程CSV文件，如下所示。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="f4d3" class="ma mb jj nk b gy no np l nq nr">df = pd.read_csv('<a class="ae jg" href="https://opendata.ecdc.europa.eu/covid19/casedistribution/csv/data.csv'" rel="noopener ugc nofollow" target="_blank">https://opendata.ecdc.europa.eu/covid19/casedistribution/csv/data.csv'</a>)</span></pre><p id="2f10" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以看看数据集中有哪些列，以及通过<code class="fe ns nt nu nk b">df.head()</code>得到的值是什么样子。</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/cac8e0d76d491acc9305b50fe8e9646f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CNdlAlaDT3CeFKBBjMp1sw.png"/></div></div></figure><p id="1d54" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你看过前面的视频，你可能会意识到我用确诊病例数作为衡量标准。那么，让我们开始数据清理和转换。</p><h2 id="a75a" class="ma mb jj bd mc md me dn mf mg mh dp mi lh mj mk ml ll mm mn mo lp mp mq mr ms bi translated">数据转换</h2><p id="c19b" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">在数据转换中，我们需要将数据改造成我们可以使用的东西。为了生成条形图比赛视频，我们将使用名为“bar-chart-race”的Python库(将在下一节介绍)。它期望数据帧使用日期时间对象作为索引，实体名称作为列名。所以，我们一起来转换数据。</p><p id="24ec" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 1。移除无用的列</strong></p><p id="356e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们只对日期、国家和病例数感兴趣，所以我们可以只使用这三列来过滤数据帧，如下所示。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="c64c" class="ma mb jj nk b gy no np l nq nr">df = df[['dateRep', 'countriesAndTerritories', 'cases']]</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/317224c7873aad6aaf35374270f75bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*XH1S93Bs0eiuwAuVudWdsw.png"/></div></figure><p id="386b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 2。将日期字符串转换为</strong> <code class="fe ns nt nu nk b"><strong class="la jk">datetime</strong></code> <strong class="la jk">对象</strong></p><p id="3618" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们检查列的数据类型，我们会发现<code class="fe ns nt nu nk b">dateRep</code>实际上是objects，它将被视为strings而不是<code class="fe ns nt nu nk b">datetime</code> object。这将导致一些麻烦，因为我们不能期望基于日期字符串列的排序结果。</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/15698add4be4f4955f17425d1e3b030f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*PNrVayyK3_JSioJueC8vew.png"/></div></figure><p id="d297" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们需要将其转换成<code class="fe ns nt nu nk b">datetime</code>型。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="bb29" class="ma mb jj nk b gy no np l nq nr">df['date'] = pd.to_datetime(df['dateRep'], dayfirst=True)</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/4735be375969e804f35ef40b0c68bf12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*12IfXIv-wzf3TpJ2dFtn7g.png"/></div></figure><p id="92be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这之后，让我们再次检查<code class="fe ns nt nu nk b">dtypes</code>。</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/3381aa1392e2c824d706f4a717ff3501.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*fEI5T__SMUoVkMqCAPXRFw.png"/></div></figure><p id="8050" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 3。添加累积病例</strong></p><p id="04da" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能已经注意到，案例数量是针对相应日期的。但是，我们需要每天的累计总病例数，以便每天的数据条目可以作为视频中的一帧生成。</p><p id="98ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们生成一个名为<code class="fe ns nt nu nk b">total_case</code>的列，它表示当天到目前为止的案例总数。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="c862" class="ma mb jj nk b gy no np l nq nr">df['total_cases'] = df.sort_values('date').groupby('countriesAndTerritories').cumsum().sort_index()</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/df49f77c2dc82070848b819ef186372c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWDp9JJDFyMhq7urGSpYUQ.png"/></div></div></figure><p id="8924" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 4。再次删除无用的列，并重命名这些列</strong></p><p id="0eb4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们已经生成了新的<code class="fe ns nt nu nk b">date</code>和<code class="fe ns nt nu nk b">total_cases</code>列，所以我们不需要<code class="fe ns nt nu nk b">dateRep</code>和<code class="fe ns nt nu nk b">cases</code>列。此外，让我们重命名国家名称列，以保持简单。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="9650" class="ma mb jj nk b gy no np l nq nr">df = df[['date', 'countriesAndTerritories', 'total_cases']]<br/>df = df.rename(columns={'countriesAndTerritories': 'country'})</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4bd2ce385eee5a901ea8a3e77bd67ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*xHZT5l45N9F5MuinnBZ9Sg.png"/></div></figure><p id="df1b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 5。旋转工作台</strong></p><p id="550e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还记得我们需要使用国家名作为列名吗？所以，我们需要旋转桌子。这在熊猫数据框中很容易做到。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="ba47" class="ma mb jj nk b gy no np l nq nr">df = pd.pivot_table(df, index=['date'], columns=['country'], values=['total_cases'])</span></pre><p id="ea5a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们使用<code class="fe ns nt nu nk b">date</code>作为索引，<code class="fe ns nt nu nk b">country</code>应该是列，值是<code class="fe ns nt nu nk b">total_cases</code>。然后，我们将得到如下的数据透视表。</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/358d8752cbab03a307b2335f9f5c319c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scSttC4wdsshsMaSanjQjQ.png"/></div></div></figure><p id="ac5e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由<code class="fe ns nt nu nk b">pivot_table</code>函数生成的多级索引很难看，可能会导致问题。所以，让我们来解决它。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="4ff3" class="ma mb jj nk b gy no np l nq nr">df.index.name = None<br/>df.columns = [col[1] for col in df.columns]</span></pre><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/30f9c44b8d721291e106d27efbe05407.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YcXrMeYHenRROIbrBHcoQw.png"/></div></div></figure><p id="f387" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们完成了原始数据集的转换。然而，我们仍然需要清理数据。</p><h2 id="2f59" class="ma mb jj bd mc md me dn mf mg mh dp mi lh mj mk ml ll mm mn mo lp mp mq mr ms bi translated">数据清理</h2><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/1309cde1136cb92c7fb8434407d8f356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNbLQzAcnUOmamrbX5eEqg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://pixabay.com/users/webandi-1460261/" rel="noopener ugc nofollow" target="_blank"> webandi </a>在<a class="ae jg" href="https://pixabay.com/photos/sweeper-periodic-brush-return-clean-1687445/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上拍摄</p></figure><p id="fb47" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你看到我们在数据框里还有很多<code class="fe ns nt nu nk b">NaN</code>值吗？这是因为该国从来没有病例记录，这是有道理的。然而，它们可能会在以后引起问题。</p><p id="6564" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 1。用零填充NaN值</strong></p><p id="fe52" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于<code class="fe ns nt nu nk b">NaN</code>值意味着该国没有确诊病例，所以用零填充所有<code class="fe ns nt nu nk b">NaN</code>值是安全的。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="8085" class="ma mb jj nk b gy no np l nq nr">df = df.fillna(0).astype(int)</span></pre><p id="c9b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，这里我们还将数据类型更改为整数，因为用浮点数表示事例数是没有意义的。</p><p id="5ae8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 2。删除例外列</strong></p><p id="d902" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的数据框中已经是列的所有国家中，有一个列叫做<code class="fe ns nt nu nk b">Cases_on_an_international_conveyance_Japan</code>，它不是一个国家。指的是钻石公主号邮轮。因为它实际上不是一个国家，乘客实际上来自不同的国家，所以我想在这种情况下将其从我们的统计数据中删除。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="d137" class="ma mb jj nk b gy no np l nq nr">df = df.drop(columns=['Cases_on_an_international_conveyance_Japan'])</span></pre><p id="5edd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 3。删除国家名称中的下划线</strong></p><p id="a460" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">国家名称(我们的列名)在单词之间有下划线。我想用空格替换这些下划线，这样当我们看到它们作为条形图标签时会更漂亮。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="9e03" class="ma mb jj nk b gy no np l nq nr">df.columns = [col.replace('_', ' ') for col in df.columns]</span></pre><p id="3b3b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> 4。删除从未进入前10名的国家</strong></p><p id="dfc8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这一步是可选的。然而，当我们生成视频时，它将提高性能。我们的数据集中总共有200多个国家，但并不是每个国家都排在前10名。由于我们将创建一个前10名条形图比赛数据可视化，这些国家将永远不会显示。</p><p id="12ea" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以如下删除这些国家。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="e379" class="ma mb jj nk b gy no np l nq nr">country_reserved = set()</span><span id="0a76" class="ma mb jj nk b gy oe np l nq nr">for index, row in df.iterrows():<br/>    country_reserved |= set(row[row &gt; 0].sort_values(ascending=False).head(10).index)</span><span id="2af3" class="ma mb jj nk b gy oe np l nq nr">df = df[list(country_reserved)]</span></pre><p id="4127" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们首先生成一个名为<code class="fe ns nt nu nk b">country_reserved</code>的集合。使用集合是因为它会忽略重复的值。然后，迭代数据框的每一行，如果当天国家/地区的案例总数排在前10名，则将国家/地区名称追加到集合中。</p><p id="4a03" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们将有一组曾经排在前10名的国家。将集合转换为列表并过滤列将产生一个更小的数据框，我们将在后面使用。</p><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/3dc6058b81263622e85ca8569d46459e.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*jaAMt2A_-1gjqNtzo_UYMA.png"/></div></figure><p id="081f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们只剩下30个国家了。</p><h1 id="6d83" class="my mb jj bd mc mz na nb mf nc nd ne mi kp nf kq ml ks ng kt mo kv nh kw mr ni bi translated">生成条形图比赛视频</h1><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2ad433a4403036c5595d6d2a98541f58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxbPEy00b0523cIeawFE3A.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/photos/children-win-success-video-game-593313/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>上的<a class="ae jg" href="https://pixabay.com/users/startupstockphotos-690514/" rel="noopener ugc nofollow" target="_blank"> StartupStockPhotos </a>拍摄的照片</p></figure><p id="ca58" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好的。我们花了很多时间来争论数据集。事实上，正如我在这篇文章中提到的，生成视频非常简单。</p><p id="f955" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只需要下载名为<code class="fe ns nt nu nk b">bar-chart-race</code>的库，<code class="fe ns nt nu nk b">pip</code>马上就会完成。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="229a" class="ma mb jj nk b gy no np l nq nr">pip install bar-chart-race</span></pre><p id="6bf2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">导入库。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="cad7" class="ma mb jj nk b gy no np l nq nr">import bar_chart_race as bcr</span></pre><p id="73bb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">简单地如下调用<code class="fe ns nt nu nk b">bar_chart_race</code>函数。</p><pre class="lu lv lw lx gt nj nk nl nm aw nn bi"><span id="f72b" class="ma mb jj nk b gy no np l nq nr">bcr.bar_chart_race(<br/>    df=df,<br/>    filename='/content/drive/My Drive/covid-19.mp4',<br/>    n_bars=10,<br/>    period_fmt='%B %d, %Y',<br/>    title='COVID-19 Confirmed Cases by Country'<br/>)</span></pre><ul class=""><li id="5f1c" class="og oh jj la b lb lc le lf lh oi ll oj lp ok lt ol om on oo bi translated"><code class="fe ns nt nu nk b">df</code>是我们准备的数据帧</li><li id="67c5" class="og oh jj la b lb op le oq lh or ll os lp ot lt ol om on oo bi translated"><code class="fe ns nt nu nk b">filename</code>是视频的输出文件名</li><li id="0241" class="og oh jj la b lb op le oq lh or ll os lp ot lt ol om on oo bi translated"><code class="fe ns nt nu nk b">n_bars</code>是我们要在条形图中显示的条形数，也可以认为是我们要显示的“前n个”。</li><li id="5785" class="og oh jj la b lb op le oq lh or ll os lp ot lt ol om on oo bi translated"><code class="fe ns nt nu nk b">period_fmt</code>是我们要在条形图上显示的日期格式。</li><li id="dbef" class="og oh jj la b lb op le oq lh or ll os lp ot lt ol om on oo bi translated"><code class="fe ns nt nu nk b">title</code>只是条形图的标题。</li></ul><p id="05f3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">过一会儿，视频将在我们指定的路径和名称下生成。</p><h1 id="1db0" class="my mb jj bd mc mz na nb mf nc nd ne mi kp nf kq ml ks ng kt mo kv nh kw mr ni bi translated">摘要</h1><figure class="lu lv lw lx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/a753407473659f1bc733b2b9ea4b0dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0qg3G1LNgEBwRiE_kxwtw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://pixabay.com/users/bokskapet-7322944/" rel="noopener ugc nofollow" target="_blank">博克斯卡皮特</a>在<a class="ae jg" href="https://pixabay.com/photos/video-production-video-movie-film-4223885/" rel="noopener ugc nofollow" target="_blank">皮克斯贝</a>上拍摄的照片</p></figure><p id="c6d0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">万岁！另一个令人惊叹的Python库！</p><p id="2f8d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我介绍了另一个令人惊叹的Python库“条形图竞赛”。只需一个函数和几行代码，我们就可以生成一个MP4格式的华丽的条形图比赛视频。</p><p id="26e7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事实证明，条形图比赛库中有更多可配置的项目。强烈建议你自己尝试一下。参考资料中给出了官方文档的链接！</p><div class="is it gp gr iu ou"><a href="https://medium.com/@qiuyujx/membership" rel="noopener follow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd jk gy z fp oz fr fs pa fu fw ji bi translated">通过我的推荐链接加入Medium克里斯托弗·陶</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">medium.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ja ou"/></div></div></a></div><p id="948c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你觉得我的文章有帮助，请考虑加入Medium会员来支持我和成千上万的其他作者！(点击上面的链接)</p><h1 id="6140" class="my mb jj bd mc mz na nb mf nc nd ne mi kp nf kq ml ks ng kt mo kv nh kw mr ni bi translated">参考</h1><p id="3bf2" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated"><strong class="la jk">欧洲疾病预防和控制中心</strong></p><div class="is it gp gr iu ou"><a href="https://www.ecdc.europa.eu/en/publications-data/download-todays-data-geographic-distribution-covid-19-cases-worldwide" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd jk gy z fp oz fr fs pa fu fw ji bi translated">下载世界各国每日新报告的新冠肺炎病例数</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">该可下载的数据文件每天更新，包含关于新冠肺炎的最新公共数据。你可以使用…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.ecdc.europa.eu</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi ja ou"/></div></div></a></div><p id="23d6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">条形图比赛文档</strong></p><div class="is it gp gr iu ou"><a href="https://www.dexplo.org/bar_chart_race/" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd jk gy z fp oz fr fs pa fu fw ji bi translated">条形图竞赛</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">使用bar_chart_race包在Python中制作动画条形图比赛</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.dexplo.org</p></div></div></div></a></div><p id="611b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="pk">编者按:</em> </strong> <em class="pk"> </em> <a class="ae jg" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="pk">走向数据科学</em> </a> <em class="pk">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae jg" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="pk">这里</em> </a> <em class="pk">。</em></p></div></div>    
</body>
</html>