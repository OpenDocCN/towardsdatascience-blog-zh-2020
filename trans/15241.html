<html>
<head>
<title>How to do a Custom Sort on Pandas DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何对熊猫数据帧进行自定义排序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320?source=collection_archive---------1-----------------------#2020-10-20">https://towardsdatascience.com/how-to-do-a-custom-sort-on-pandas-dataframe-ac18e7ea5320?source=collection_archive---------1-----------------------#2020-10-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6115" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你应该知道的一些最有用的熊猫把戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/50a749bfc36f89c64af892e2a14599f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Iy9hWUku6Y1HbJf0a5p4g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@uxindo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">印尼UX</a>在<a class="ae ky" href="https://unsplash.com/s/photos/sorting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1b6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas DataFrame有一个内置的方法<code class="fe lv lw lx ly b">sort_values()</code>来根据给定的变量对值进行排序。该方法本身使用起来相当简单，但是它不适用于自定义排序，例如，</p><ul class=""><li id="a803" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">t恤尺码:<code class="fe lv lw lx ly b">XS</code>、<code class="fe lv lw lx ly b">S</code>、<code class="fe lv lw lx ly b">M</code>、<code class="fe lv lw lx ly b">L</code>、<code class="fe lv lw lx ly b">XL</code></li><li id="8f78" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">月份:<code class="fe lv lw lx ly b">Jan</code>、<code class="fe lv lw lx ly b">Feb</code>、<code class="fe lv lw lx ly b">Mar</code>、<code class="fe lv lw lx ly b">Apr</code>、…。等等</li><li id="f98e" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">星期几:<code class="fe lv lw lx ly b">Mon</code>、<code class="fe lv lw lx ly b">Tue</code>、<code class="fe lv lw lx ly b">Wed</code>、<code class="fe lv lw lx ly b">Thu</code>、<code class="fe lv lw lx ly b">Fri</code>、<code class="fe lv lw lx ly b">Sat</code>和<code class="fe lv lw lx ly b">Sun</code>。</li></ul><p id="893a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将看看如何对熊猫数据帧进行自定义排序。</p><p id="3bef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请查看我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>获取源代码</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h1 id="99b6" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">看看这个问题</h1><p id="a2c3" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">假设我们有一个关于服装店的数据集:</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="684d" class="nv mv it ly b gy nw nx l ny nz">df = pd.DataFrame({<br/>    'cloth_id': [1001, 1002, 1003, 1004, 1005, 1006],<br/>    <strong class="ly iu">'size': ['S', 'XL', 'M', 'XS', 'L', 'S'],</strong><br/>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/599ef8c93e22fb82bd24898c2a7a1ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*8rPi6Xsgz7in_BNM24g3kw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者制作的数据</p></figure><p id="2db7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，每块布料都有一个<strong class="lb iu"> <em class="ob">尺寸</em> </strong>值，数据应该按以下顺序排序:</p><ul class=""><li id="1ef4" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">XS</code>特大号</li><li id="612a" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">S</code>用于小型</li><li id="d9d9" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">M</code>为中等</li><li id="ba92" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">L</code>为大号</li><li id="8470" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><code class="fe lv lw lx ly b">XL</code>特大号</li></ul><p id="f6ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，调用<code class="fe lv lw lx ly b">sort_values('size')</code>时会得到如下输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/49ff9cfbb542c430871ba824788fc262.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*ckSA8oGXrUFh7iXbuB08Dg.png"/></div></figure><p id="4a52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出不是我们想要的，但在技术上是正确的。在幕后，<code class="fe lv lw lx ly b">sort_values()</code>是按照数字数据的数字顺序或对象数据的字符字母顺序对值进行排序。</p><p id="a84a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是两种常见的解决方案:</p><ol class=""><li id="4261" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu od mf mg mh bi translated">为自定义排序创建新列</li><li id="c3bd" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu od mf mg mh bi translated">使用<code class="fe lv lw lx ly b">CategoricalDtype</code>将数据转换为有序的类别类型</li></ol><h1 id="3862" class="mu mv it bd mw mx oe mz na nb of nd ne jz og ka ng kc oh kd ni kf oi kg nk nl bi translated">为自定义排序创建新列。</h1><p id="03f4" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">在这个解决方案中，需要一个映射数据帧来表示自定义排序，然后根据映射创建一个新列，最后我们可以根据新列对数据进行排序。让我们借助一个例子来看看这是如何工作的。</p><p id="b3b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们创建一个映射数据帧来表示自定义排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="a15f" class="nv mv it ly b gy nw nx l ny nz">df_mapping = pd.DataFrame({<br/>    <strong class="ly iu">'size': ['XS', 'S', 'M', 'L', 'XL'],</strong><br/>})</span><span id="a5e4" class="nv mv it ly b gy oj nx l ny nz">sort_mapping = df_mapping.<strong class="ly iu">reset_index().set_index('size')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/ad7c2301edb00a2c3474e439c197951d.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*1NEWtxEwdWZqDqr0i2_-Eg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用于自定义排序的映射数据框架</p></figure><p id="f03a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，使用来自<code class="fe lv lw lx ly b">sort_mapping</code>的映射值创建一个新列<strong class="lb iu"> <em class="ob"> size_num </em> </strong>。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="f0c2" class="nv mv it ly b gy nw nx l ny nz">df['<strong class="ly iu">size_num</strong>'] = df['size'].<strong class="ly iu">map(sort_mapping['index'])</strong></span></pre><p id="da5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，按新列<strong class="lb iu"> <em class="ob"> size_num </em> </strong>对值进行排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="2f23" class="nv mv it ly b gy nw nx l ny nz">df.sort_values('<strong class="ly iu">size_num</strong>')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/bb150b1bea2618c2a7975d58fe049305.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*5zWbpCVxa0Z_SL8hEm03Sg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用排序映射数据框架进行自定义排序</p></figure><p id="e6b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这当然有助于我们的工作。但是它创建了一个备用列，在处理大型数据集时效率可能会降低。</p><p id="7386" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<code class="fe lv lw lx ly b">CategoricalDtype</code>更有效地解决这个问题。</p><h1 id="703e" class="mu mv it bd mw mx oe mz na nb of nd ne jz og ka ng kc oh kd ni kf oi kg nk nl bi translated">使用<code class="fe lv lw lx ly b">CategoricalDtype</code>将数据转换为有序的类别类型</h1><p id="bb7d" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated"><code class="fe lv lw lx ly b">CategoricalDtype</code>是一种具有类别和有序性的分类数据类型[1]。这对于创建自定义排序非常有用[2]。让我们借助一个例子来看看这是如何工作的。</p><p id="aecd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们进口<code class="fe lv lw lx ly b">CategoricalDtype</code>。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="1352" class="nv mv it ly b gy nw nx l ny nz">from pandas.api.types import <strong class="ly iu">CategoricalDtype</strong></span></pre><p id="b295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，创建一个定制的类别类型<code class="fe lv lw lx ly b">cat_size_order</code>,用</p><ul class=""><li id="fc3a" class="lz ma it lb b lc ld lf lg li mb lm mc lq md lu me mf mg mh bi translated">第一个参数设置为<code class="fe lv lw lx ly b">['XS', 'S', 'M', 'L', 'XL']</code>为布料尺寸的唯一值。</li><li id="559f" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">这个变量的第二个参数<code class="fe lv lw lx ly b">ordered=True</code>将被视为有序分类。</li></ul><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="2ec7" class="nv mv it ly b gy nw nx l ny nz"><strong class="ly iu">cat_size_order</strong> = CategoricalDtype(<br/>    <strong class="ly iu">['XS', 'S', 'M', 'L', 'XL']</strong>, <br/>    <strong class="ly iu">ordered=True</strong><br/>)</span></pre><p id="fe63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，调用<code class="fe lv lw lx ly b">astype(cat_size_order)</code>将尺寸数据转换为自定义类别类型。通过运行<code class="fe lv lw lx ly b">df['size']</code>，我们可以看到<strong class="lb iu"> <em class="ob">大小</em> </strong>列已经被转换为带有顺序<code class="fe lv lw lx ly b">[XS &lt; S &lt; M &lt; L &lt; XL]</code>的类别类型。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="e531" class="nv mv it ly b gy nw nx l ny nz">&gt;&gt;&gt; df['size'] = df['size']<strong class="ly iu">.astype(cat_size_order)</strong><br/>&gt;&gt;&gt; df['size']</span><span id="8095" class="nv mv it ly b gy oj nx l ny nz">0     S<br/>1    XL<br/>2     M<br/>3    XS<br/>4     L<br/>5     S<br/>Name: size, <strong class="ly iu">dtype: category</strong><br/><strong class="ly iu">Categories (5, object): [XS &lt; S &lt; M &lt; L &lt; XL]</strong></span></pre><p id="1b04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以调用相同的方法对值进行排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="0bc7" class="nv mv it ly b gy nw nx l ny nz">df.<strong class="ly iu">sort_values('size')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/e9834e8368e64613f8729d5c1d302d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*no8zl76c7nnGBYGJECmW6A.png"/></div></figure><p id="5964" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个好用多了。让我们来看看在引擎盖下到底发生了什么。</p><h2 id="758e" class="nv mv it bd mw on oo dn na op oq dp ne li or os ng lm ot ou ni lq ov ow nk ox bi translated">用序列查看类别<code class="fe lv lw lx ly b">codes</code>属性。<code class="fe lv lw lx ly b">cat</code>访问器</h2><p id="6d9b" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">现在<strong class="lb iu"> <em class="ob"> size </em> </strong>列已经被转换为<strong class="lb iu"> category </strong>类型，我们可以使用<code class="fe lv lw lx ly b"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.cat.html" rel="noopener ugc nofollow" target="_blank">Series.cat</a></code>访问器来查看分类属性。在引擎盖下，它使用<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Categorical.codes.html" rel="noopener ugc nofollow" target="_blank">类别代码</a>来表示有序分类中的位置。</p><p id="0f06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个新列<strong class="lb iu"> <em class="ob">代码</em> </strong>，这样我们就可以并排比较<strong class="lb iu"> <em class="ob">大小</em> </strong>和<strong class="lb iu"> <em class="ob">代码</em> </strong>值。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="c8bf" class="nv mv it ly b gy nw nx l ny nz">df['codes'] = df['size']<strong class="ly iu">.cat.codes</strong><br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/21e8d99f62c69e7bc87e3863097743fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*xylyiHUW6Tg_gcuaWQ5PqA.png"/></div></div></figure><p id="7ff3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到<code class="fe lv lw lx ly b">XS</code>、<code class="fe lv lw lx ly b">S</code>、<code class="fe lv lw lx ly b">M</code>、<code class="fe lv lw lx ly b">L</code>、<code class="fe lv lw lx ly b">XL</code>分别有一个代码<code class="fe lv lw lx ly b">0</code>、<code class="fe lv lw lx ly b">1</code>、<code class="fe lv lw lx ly b">2</code>、<code class="fe lv lw lx ly b">3</code>、<code class="fe lv lw lx ly b">4</code>、<code class="fe lv lw lx ly b">5</code>。代码是实际值在<strong class="lb iu">类别</strong>类型中的位置。通过运行<code class="fe lv lw lx ly b">df.info()</code>，我们可以看到<strong class="lb iu"> <em class="ob">代码</em> </strong>为<strong class="lb iu"> int8 </strong>。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="1da8" class="nv mv it ly b gy nw nx l ny nz">&gt;&gt;&gt; df.info()</span><span id="1c9d" class="nv mv it ly b gy oj nx l ny nz">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 6 entries, 0 to 5<br/>Data columns (total 3 columns):<br/> #   Column    Non-Null Count  Dtype   <br/>---  ------    --------------  -----   <br/> 0   cloth_id  6 non-null      int64   <br/> 1   size      6 non-null      category<br/> <strong class="ly iu">2   codes     6 non-null      int8   </strong> <br/>dtypes: category(1), int64(1), int8(1)<br/>memory usage: 388.0 bytes</span></pre><h1 id="e89b" class="mu mv it bd mw mx oe mz na nb of nd ne jz og ka ng kc oh kd ni kf oi kg nk nl bi translated">按多个变量排序</h1><p id="d326" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">接下来，让我们把事情变得复杂一点。这里，我们将通过多个变量对数据帧进行排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="d7b9" class="nv mv it ly b gy nw nx l ny nz">df = pd.DataFrame({<br/>    'order_id': [1001, 1002, 1003, 1004, 1005, 1006, 1007],<br/>    'customer_id': [10, 12, 12, 12, 10, 10, 10],<br/>    'month': ['Feb', 'Jan', 'Jan', 'Feb', 'Feb', 'Jan', 'Feb'],<br/>    'day_of_week': ['Mon', 'Wed', 'Sun', 'Tue', 'Sat', 'Mon', 'Thu'],<br/>})</span></pre><p id="5d7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，让我们创建两个自定义类别类型<code class="fe lv lw lx ly b">cat_day_of_week</code>和<code class="fe lv lw lx ly b">cat_month</code>，并将它们传递给<code class="fe lv lw lx ly b">astype().</code></p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="08c1" class="nv mv it ly b gy nw nx l ny nz"><strong class="ly iu">cat_day_of_week</strong> = CategoricalDtype(<br/>    ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'], <br/>    ordered=True<br/>)</span><span id="4999" class="nv mv it ly b gy oj nx l ny nz"><strong class="ly iu">cat_month</strong> = CategoricalDtype(<br/>    ['Jan', 'Feb', 'Mar', 'Apr'], <br/>    ordered=True,<br/>)</span><span id="3eb6" class="nv mv it ly b gy oj nx l ny nz">df['day_of_week'] = df['day_of_week'].astype(<strong class="ly iu">cat_day_of_week</strong>)<br/>df['month'] = df['month'].astype(<strong class="ly iu">cat_month</strong>)</span></pre><p id="7a2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要按多个变量排序，我们只需将一个列表传递给<code class="fe lv lw lx ly b">sort_values()</code>即可。例如，按<strong class="lb iu"> <em class="ob">月</em> </strong>和<strong class="lb iu"> <em class="ob">星期几</em> </strong>排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="bf4e" class="nv mv it ly b gy nw nx l ny nz">df.sort_values(<strong class="ly iu">['month', 'day_of_week']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/e7f114bebc66786f6f8f7ebdeee6765b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*f_8_NcC-AOW3aok87_lpLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按<strong class="bd pa"> <em class="pb">月</em> </strong>和<strong class="bd pa"> <em class="pb">星期几</em> </strong>排序。</p></figure><p id="ed06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并按<strong class="lb iu"> <em class="ob">客户_ id</em></strong><strong class="lb iu"><em class="ob">月份</em> </strong>和<strong class="lb iu"> <em class="ob">星期_日</em> </strong>排序。</p><pre class="kj kk kl km gt nr ly ns nt aw nu bi"><span id="5276" class="nv mv it ly b gy nw nx l ny nz">df.sort_values(<strong class="ly iu">['customer_id', 'month', 'day_of_week']</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/a0f40de557052578c2c4023b51622c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*FdE185YWgUTeV1sXQ_MntA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按<strong class="bd pa"> <em class="pb"> customer_id </em> </strong>、<strong class="bd pa"> <em class="pb">月</em> </strong>和<strong class="bd pa"> <em class="pb">日_周_日</em> </strong>排序。</p></figure><h1 id="1d8e" class="mu mv it bd mw mx oe mz na nb of nd ne jz og ka ng kc oh kd ni kf oi kg nk nl bi translated">好了</h1><p id="8655" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">感谢阅读。</p><p id="75f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请在我的Github 上查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/017-pandas-custom-sort/pandas-custom-sort.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本的源代码。</a></p><p id="61ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对机器学习的实用方面感兴趣，请继续关注。</p><h2 id="d0ac" class="nv mv it bd mw on oo dn na op oq dp ne li or os ng lm ot ou ni lq ov ow nk ox bi translated">你可能会对我的其他一些熊猫文章感兴趣:</h2><ul class=""><li id="d395" class="lz ma it lb b lc nm lf nn li pd lm pe lq pf lu me mf mg mh bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/creating-conditional-columns-on-pandas-with-numpy-select-and-where-methods-8ee6e2dbd5d5">使用Numpy select()和where()方法在Pandas上创建条件列</a></li><li id="d88d" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/when-to-use-pandas-transform-function-df8861aa0dcf">何时使用Pandas transform()函数</a></li><li id="3295" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/difference-between-apply-and-transform-in-pandas-242e5cf32705" rel="noopener">Pandas中应用()和转换()的区别</a></li><li id="f69f" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/using-pandas-method-chaining-to-improve-code-readability-d8517c5626ac" rel="noopener">使用熊猫方法链接提高代码可读性</a></li><li id="d763" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/working-with-datetime-in-pandas-dataframe-663f7af6c587">在熊猫数据帧中处理日期时间</a></li><li id="3508" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" href="https://medium.com/@bindiatwork/all-the-pandas-read-csv-you-should-know-to-speed-up-your-data-analysis-1e16fe1039f3" rel="noopener">熊猫阅读_csv()你应该知道的招数</a></li><li id="4592" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/4-tricks-you-should-know-to-parse-date-columns-with-pandas-read-csv-27355bb2ad0e">用Pandas read_csv() </a>解析日期列应该知道的4个技巧</li></ul><p id="9a84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多可以从我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank"> Github </a>中找到</p><h1 id="560a" class="mu mv it bd mw mx oe mz na nb of nd ne jz og ka ng kc oh kd ni kf oi kg nk nl bi translated">参考</h1><ul class=""><li id="8def" class="lz ma it lb b lc nm lf nn li pd lm pe lq pf lu me mf mg mh bi translated">【1】<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.CategoricalDtype.html" rel="noopener ugc nofollow" target="_blank">熊猫。CategoricalDtype API </a></li><li id="64ec" class="lz ma it lb b lc mi lf mj li mk lm ml lq mm lu me mf mg mh bi translated">[2] <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html#categorical-categoricaldtype" rel="noopener ugc nofollow" target="_blank">熊猫分类分类类型</a>教程</li></ul></div></div>    
</body>
</html>