<html>
<head>
<title>Learning Wolfram: Interacting With Web Browsers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习Wolfram:与Web浏览器交互</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learning-wolfram-interacting-with-web-browsers-29900c1a5cea?source=collection_archive---------48-----------------------#2020-09-29">https://towardsdatascience.com/learning-wolfram-interacting-with-web-browsers-29900c1a5cea?source=collection_archive---------48-----------------------#2020-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="29ce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">自动化您的Web测试和浏览工作流</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d3c2dc72174f2be0995e4db6f05cbb12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*coccCAuECMGm3XCFdtsDSg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰克·范德斯波尔在<a class="ae ky" href="https://unsplash.com/s/photos/web-browser?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="21b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我在质量保证部门工作时，我的工作之一是在一些网站上做回归测试。那时只有有限的自动化工具，所以我的解决方案包含了发布鼠标和按键事件的<a class="ae ky" href="https://docs.oracle.com/javase/7/docs/api/java/awt/Robot.html" rel="noopener ugc nofollow" target="_blank"> Java机器人类</a>。这当然非常脆弱。</p><p id="9c90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最近，自动化web浏览器交互变得更加容易。WebDriver协议指定了一组非常好的命令和交互来与浏览器对话。Wolfram语言(WL)使用这个协议让你直接从一个<a class="ae ky" href="https://www.wolfram.com/notebooks/" rel="noopener ugc nofollow" target="_blank">笔记本</a>会话中控制浏览器。笔记本的交互特性非常适合增量开发web自动化工作流。在这个故事中，我将向您展示如何开始使用这个功能。</p><p id="c6c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要启动一个新的web浏览器会话，您可以使用<a class="ae ky" href="https://reference.wolfram.com/language/ref/StartWebSession.html" rel="noopener ugc nofollow" target="_blank"> StartWebSession </a>命令。如果没有函数参数，它将在你的电脑上启动一个Chrome浏览器。也支持Firefox浏览器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/a25a56038405095122167e23689d04ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hMy5w8vVThPRguVIA_faA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="5e11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要打开网页，您可以使用<a class="ae ky" href="https://reference.wolfram.com/language/ref/WebExecute.html" rel="noopener ugc nofollow" target="_blank"> WebExecute </a>命令。此命令是您用来控制web浏览器的主要功能。您指定会话，并给它一个命令，如“open网页”、“ClickElement”或“JavascriptExecute”:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/f6de8cc8bd1cd29bbf516f5b2d08d6a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybDXZxa-4-11-XS7oGpcxQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="516b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，要单击搜索图标(右上角的放大镜)，您可以通过它的XPath或CSS选择器来引用它。你可以在浏览器的开发者控制台找到这些。一个写得好的web页面为特定的元素使用惟一的ID，在这种情况下，ID是“_nav-search”。执行该命令会在浏览器中显示搜索栏:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/a14ec707ff2e4b34a42f047a1dc0161f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eG9tBRLUNljg5PLe2RkZiQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="4431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您可以在输入栏中键入文本。例如，如果我想搜索“数据集”，我可以指定元素和搜索文本。通过在字符串末尾添加一个“\n”(换行符)来模拟按enter键:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/809ece73119f9d18b6a6da84f1988b1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pfRNBOds2ShyjDYzpuU5Cg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="430a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了检索和检查页面内容，我通常使用一小段javascript。例如，检索页面上所有链接的URL的一种方法是，我使用下面的javascript代码片段:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/5b58569c6ec502fe1c12ce5431566fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVOqMHLALYg1jGOjqHt7bQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(图片由作者提供)</p></figure><p id="2824" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是一个WL字符串列表，该列表可用于回归测试或进一步的导航步骤。同样，您可以收集网页上所有图像的URL，然后将这些图像直接导入到您的WL会话中以供进一步检查。</p><p id="3420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您完成浏览器会话时，您可以使用DeleteObject命令来结束它。这将关闭web浏览器并结束连接:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ly"><img src="../Images/f4dde7f8abdaf85adc58f0aa8d8d6643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BErIsvK0YqMWO4lvz7iHYQ.png"/></div></div></figure><p id="eb88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关这一有用功能的更多信息，请查看<a class="ae ky" href="https://reference.wolframcloud.com/language/guide/WebBrowserAutomation.html" rel="noopener ugc nofollow" target="_blank"> Web浏览器自动化</a>的指南页面。要了解更多关于WL的入门知识，请查看我最近的一篇名为“<a class="ae ky" rel="noopener" target="_blank" href="/learning-wolfram-from-zero-to-hero-2ac4fd6914d9">学习Wolfram:从零到英雄</a>”的文章。上面图片中显示的完整代码的笔记本可以从<a class="ae ky" href="https://www.wolframcloud.com/obj/arnoudb/Published/Web-Browser-Automation.nb" rel="noopener ugc nofollow" target="_blank">这里</a>获得。只需点击该链接，然后将笔记本下载到您的桌面上。</p></div></div>    
</body>
</html>