<html>
<head>
<title>Too Many Terms Ruins the Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">太多的术语会破坏回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/too-many-terms-ruins-the-regression-7cf533a0c612?source=collection_archive---------21-----------------------#2020-10-05">https://towardsdatascience.com/too-many-terms-ruins-the-regression-7cf533a0c612?source=collection_archive---------21-----------------------#2020-10-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f5cb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">多项式回归过度拟合及其避免方法</h2></div><p id="726f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过增加现有要素的功能，多项式回归可帮助您充分利用数据集。它允许我们用简单的模型来模拟非线性关系，比如线性回归。这可以提高模型的准确性，但是如果使用不当，可能会出现过度拟合。我们希望避免这种情况，因为这会给你留下一个在未来表现不佳的模型。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/46100afbbac79e3ef36e63b323e11901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0_oLVQ2jxANuiYGRLa3OXQ.gif"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:作者</p></figure><p id="b043" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将解释多项式回归的概念，并展示它如何导致过度拟合。我们还将讨论一些可以用来避免过度拟合的技巧。这些方法包括使用k-fold交叉验证或坚持集，但最重要的是，我们将讨论如何应用领域知识来帮助您避免过度拟合。我们不会讨论任何代码，你可以在GitHub上找到完整的项目。</p><h1 id="9082" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是多项式回归？</h1><p id="ae21" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">让我们通过将一些线性回归模型拟合到一个数据集来直接进入这个概念。我们将使用一个<a class="ae lu" href="https://archive.ics.uci.edu/ml/datasets/Real+estate+valuation+data+set" rel="noopener ugc nofollow" target="_blank">房地产估价数据集</a>，其中包含414所售出房屋的信息。为了简单起见，我们只考虑两个变量——单位面积的房价和房龄。我们可以在下面的图1中看到这两个变量之间的关系。这个想法是利用房子的年龄来预测价格。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ms"><img src="../Images/2af7ba7764cdbabe6ef0afdbe853b322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDWCdBCbRSSSFDLfYHoQPg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图1:房价与年龄的散点图</p></figure><p id="2004" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看图1，这两个变量之间似乎没有线性关系。这意味着这种关系不能用直线来表示。在我们的案例中，房价最初会随着年龄的增长而下降。然而，大约25年后，它开始随着年龄的增长而增加。这表明这种关系可能是二次的。在我们进入建模之前，让我们讨论一下为什么会这样。我们将在后面看到，当涉及到多项式回归时，为数据中的关系提供充分的理由是很重要的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/bc6f87e29497fb36a9207d6947251893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zkm8xc8qlTwNT1amkftHEw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:<a class="ae lu" href="https://www.flaticon.com/premium-icon/teacher_3300897" rel="noopener ugc nofollow" target="_blank"> flaticon </a></p></figure><p id="a10b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最初的行为是有意义的。随着房屋的老化，它们会越来越破旧，失去价值。房地产专家会有更好的理解，但也许，经过一段较长的时间，房子会变得古色古香。随着人们开始重视他们悠久的历史，他们的年龄会增加价值。也可能有一些选择偏差来解释这种上升趋势。也就是说，昂贵的房子往往不会被拆除，因此出售的唯一老房子就是这些昂贵的房子。</p><h2 id="ef2d" class="mu lw it bd lx mv mw dn mb mx my dp mf kr mz na mh kv nb nc mj kz nd ne ml nf bi translated">标准线性回归</h2><p id="48c3" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">不管是什么原因，因为这种关系不是线性的，我们不会期望一个标准的线性模型做得很好。让我们通过尝试使用线性回归来展示仅使用年龄的房价模型。我们通过以下方式做到这一点:</p><ol class=""><li id="5225" class="ng nh it kk b kl km ko kp kr ni kv nj kz nk ld nl nm nn no bi translated">将数据集<strong class="kk iu">随机</strong>分成训练集(70%)和测试集(30%)。</li><li id="08cd" class="ng nh it kk b kl np ko nq kr nr kv ns kz nt ld nl nm nn no bi translated">使用训练集训练模型。</li><li id="ca1c" class="ng nh it kk b kl np ko nq kr nr kv ns kz nt ld nl nm nn no bi translated">通过对测试集进行预测并计算<a class="ae lu" href="https://en.wikipedia.org/wiki/Mean_squared_error#:~:text=In%20statistics%2C%20the%20mean%20squared,values%20and%20the%20actual%20value." rel="noopener ugc nofollow" target="_blank"> MSE来评估模型。</a></li></ol><p id="b764" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">按照这个过程，我们将最终得到一个由以下等式表示的模型:</p><p id="ef1c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">房价= β₁(age) + β₀</p><p id="6df7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中β₁和β₀是由模型估计的参数。这个方程也可以称为模型的预测线。它给出了给定年龄的预测房价。</p><p id="f97e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在图2中，我们可以看到在数据集上使用该模型的结果。这里，红线给出了预测线。看这条线，我们看到模型在捕捉潜在的二次趋势方面做得不好。我们可以使用测试集MSE(145.91)来总结该模型的准确性。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ms"><img src="../Images/76707ef37f825bf22a1944712a267659.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oLe8p_Qb6BU-TFtR_2lxTA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图2:标准线性回归</p></figure><h2 id="3eba" class="mu lw it bd lx mv mw dn mb mx my dp mf kr mz na mh kv nb nc mj kz nd ne ml nf bi translated">多项式回归</h2><p id="6d3f" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在让我们尝试使用多项式回归来改进我们的模型。最终，由于关系似乎是二次的，我们期望下面的等式能做得更好:</p><p id="7e54" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">房价= β₂(age ) + β₁(age) + β₀</p><p id="e2fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">问题是，如果我们对当前数据集使用线性回归，就不可能得到这样的方程。为了解决这个问题，我们可以简单地添加一个新的变量到我们的数据集，年龄。为了避免混淆，让我们把它重新标记为年龄平方。增加这个特性，允许我们把非线性方程改写成线性方程:</p><p id="460c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">房价= β₂(age_squared) + β₁(age) + β₀</p><p id="d1ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在有一个两个变量的线性函数(即年龄的平方&amp;年龄),它实际上是一个变量(即年龄)的非线性函数。这允许我们像以前一样使用线性回归来估计β参数。我们可以在图3中看到最终的预测线。在这种情况下，测试MSE为127.42，比我们之前的模型低13%。所以这个新模型在预测房价方面做得更好。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ms"><img src="../Images/2ea80ceddc54b483f04e69616b64695d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odB3NAhbFIVzDrzIH9iKhw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图3:随年龄的多项式线性回归</p></figure><p id="ec34" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过使用这个新特性，年龄，我们正在做多项式回归。概括地说，每当使用n次多项式来模拟目标和特征之间的关系时，就要进行多项式回归。比如:</p><p id="1392" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">房价= βn(ageⁿ)+…+ β₂(age)+β₂(age)+β₁(age)+β₀</p><p id="944c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过添加这些功能，我们可以在数据集中模拟更复杂的关系。在我们上面的模型中，我们有n =2，但是我们可能通过使用更高次的多项式得到更好的结果。也就是说，通过添加更多的功能，我们也可能会过度适应我们的数据。</p><h1 id="a900" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">多项式回归过度拟合</h1><p id="ceff" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">当模型与训练数据集过于接近时，我们称之为过度拟合。该模型捕捉数据中的噪声，而不仅仅是潜在的趋势。其结果是，该模型可能在训练数据集上表现良好，但在测试数据集上表现不佳。事实上，我们不会期望该模型在任何未经训练的数据集上表现良好。</p><p id="7122" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">过度拟合通常是因为模型太复杂或特征太多。随着你添加更多的特性，你就越有可能过度适应。随着多项式回归次数的增加，也会发生同样的情况。在图3中，您可以看到这意味着什么。我们遵循相同的建模过程，但是每一步，我们增加多项式的次数。我们从n=1开始，到n=25结束。请注意，随着度数的增加，预测线变得更加扭曲。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/2fa0ac66195b7f68592ec9621a74a2bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sGwwrwg6h-AMwfPkknP17Q.gif"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图3:增加x次方对回归的影响</p></figure><p id="8843" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在的情况是，随着你增加度数，你允许模型有更多的转折点。二次多项式有1个转折点，三次多项式有2个转折点，依此类推…对于每个额外的转折点，我们给予模型更大的自由度以更接近训练数据集。对于更高的度数，模型可能只是捕捉噪声。真实的潜在趋势不太可能如此复杂。</p><p id="0fbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一种可视化的方法是查看训练集和测试集的MSE。如图4所示，随着度数的增加，训练MSE趋于减小。这意味着模型在训练集上变得越来越准确。测试MSE讲述了一个不同的故事。当n=2时，测试MSE最小，之后趋于增加。这意味着模型在测试集上的表现越来越差。换句话说，随着我们增加程度，模型变得更加过度拟合。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/9a850023a9bc3ccdf4bef4276dedf49b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*se5cCv1wOcFljZaUZE9Osg.gif"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图4:训练和测试的MSE</p></figure><h1 id="f28e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">如何避免过度拟合</h1><p id="f566" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我们已经看到了多项式回归是如何出错的。现在的问题是，我们如何选择正确的程度，避免过度拟合。像任何机器学习模型一样，我们希望训练一个具有在测试集和训练集上都表现良好的特征组合的模型。这样，为多项式回归选择最佳特征的过程与任何其他机器学习问题没有什么不同。</p><h2 id="fe18" class="mu lw it bd lx mv mw dn mb mx my dp mf kr mz na mh kv nb nc mj kz nd ne ml nf bi translated">坚持组</h2><p id="f0bc" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">一种常见的方法是使用拒绝集。对于这种方法，数据集被分成训练集和保留/测试集。对于不同的特征集，模型在训练集上被训练，并在测试集上被评估。在这里，我们使用MSE等指标来评估性能。我们通常会选择在测试集上表现最好的特性集。</p><p id="77bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看着上面所做的工作，我们可以将这个方法应用到我们的房价例子中。在这种情况下，n=2的模型具有最小的测试MSE。这意味着我们将只在最终模型中使用年龄和年龄。这似乎是一个合理的结果，因为真正的潜在趋势似乎是二次的。我们也想出了一些逻辑上的理由来支持这个结果。</p><h2 id="7b22" class="mu lw it bd lx mv mw dn mb mx my dp mf kr mz na mh kv nb nc mj kz nd ne ml nf bi translated">k倍交叉验证</h2><p id="9778" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">类似的方法是使用k-fold交叉验证。这里，我们将数据集划分为k个大小相等的子集\折叠。然后，我们在k-1个折叠上进行训练，并计算剩余折叠的MSE。我们重复这个步骤k次，这样每一次折叠都作为测试集。模型的最终得分将是所有测试折叠的均方误差的平均值。具有最低平均MSE的模型将被选为最终模型。图5显示了如何使用5重交叉验证来划分数据集的示例。在这种情况下，我们将计算5次测试折叠的平均MSE。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nu"><img src="../Images/36bf8cc5f09b1146586a812493672dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7zb14YoV5zMk2dMC6HPRVA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图5:五重交叉验证示例</p></figure><h2 id="9320" class="mu lw it bd lx mv mw dn mb mx my dp mf kr mz na mh kv nb nc mj kz nd ne ml nf bi translated">领域知识和常识</h2><p id="f4e9" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">使用拒绝集和k-fold交叉验证通常可以给你一个好的模型。但是数据是杂乱的，统计异常可能发生。仅仅盲目地使用这些方法而不考虑你的问题，你仍然会偶然地得到一个坏的模型。到目前为止，我们已经使用一个特定的训练测试分割执行了上述分析。在这种情况下，我们得出结论，年龄模型是最好的。但是，如果我们使用不同的随机列车测试分裂呢？</p><p id="a954" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在图6中看到我们的意思。这里，我们遵循与之前完全相同的过程，除了这一次，我们使用不同的随机训练测试分割。在这种情况下，测试MSE最低，n = 8。通过使用拒绝方法，我们将使用它作为我们的最终模型。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/e290fab602239b2b5efe53ab27f31274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*elBFyKrn36Hd0x6wSjAWRA.gif"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图6:具有替代训练测试分割的MSE</p></figure><p id="6b8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此时，你应该问问自己，使用8次多项式是否有逻辑意义。我们的预测线将采用以下形式:</p><p id="6374" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">房价=β₈(age⁸)+β₇(age⁷)+…+β₂(age)+β₁(age)+β₀</p><p id="9a56" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">价格和年龄的关系真的有那么复杂还是以上结果只是统计上的异常？答案可能是后者，这强调了为什么我们不应该仅仅依赖于像k倍交叉验证这样的方法。</p><p id="ed9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在选择特性时，考虑您的问题并应用任何领域知识是很重要的。在我们的房价例子中，n = 2的模型似乎捕捉到了潜在的趋势。我们也为这种关系提出了一些很好的潜在原因。考虑到这一点，这种模式可能更好。一般来说，如果你包含的特征有一个逻辑上的原因来解释为什么它们是可预测的，那么你就不太可能捕捉噪音和过度拟合。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="23cb" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated">图像来源</h1><p id="1905" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">图片是我自己的或从<a class="ae lu" href="http://www.flaticon.com/" rel="noopener ugc nofollow" target="_blank">www.flaticon.com</a>获得。在后者的情况下，我拥有他们的<a class="ae lu" href="https://support.flaticon.com/hc/en-us/articles/202798201-What-are-Flaticon-Premium-licenses-" rel="noopener ugc nofollow" target="_blank">高级计划</a>中定义的“完全许可”。</p><h1 id="cd51" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><p id="955e" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">[1] J. Frost，过度拟合回归模型:问题、检测和避免(2020)，<a class="ae lu" href="https://statisticsbyjim.com/regression/overfitting-regression-models/" rel="noopener ugc nofollow" target="_blank">https://statisticsbyjim . com/Regression/over fitting-Regression-Models/</a></p><p id="757c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2]机器学习中的过度拟合:什么是过度拟合以及如何防止过度拟合(2020年)，<a class="ae lu" href="https://elitedatascience.com/overfitting-in-machine-learning" rel="noopener ugc nofollow" target="_blank">https://elitedata science . com/overfit-in-Machine-Learning</a></p></div></div>    
</body>
</html>