<html>
<head>
<title>Leverage Multicore For Faster Performance In Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Scikit-Learn中利用多核实现更快的性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/leverage-multicore-for-faster-performance-in-scikit-learn-147c374ad2d3?source=collection_archive---------39-----------------------#2020-09-29">https://towardsdatascience.com/leverage-multicore-for-faster-performance-in-scikit-learn-147c374ad2d3?source=collection_archive---------39-----------------------#2020-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="d9ed" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" rel="noopener" target="_blank" href="https://towardsdatascience.com/machine-learning/home">内部AI </a></h2><div class=""/><div class=""><h2 id="776c" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">随着物联网、传感器和存储能力的进步，可用的数据量呈超级指数级增长。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/224695092b3ae5972b42939237a2519a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C28au15UUqv-5kgo"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@umby?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">翁贝托</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="8a90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">十年后我们生活的世界将会完全不同，比现在的世界更加复杂。</p><p id="c549" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着世界变得越来越复杂，底层数据也越来越复杂。机器学习的挑战之一是处理复杂数据集对计算能力和时间的需求不断增加。</p><p id="418c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Scikit-learn不支持像Keras或TensorFlow这样的GPU，但我们可以利用多核CPU并行执行几个任务。</p><p id="51ed" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本文中，我们将看到加速机器学习和缩短建模时间的过程。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="a929" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将在本文中使用“Volcanoes”数据集来理解Sckit-learn中的并行任务处理过程。</p><pre class="ks kt ku kv gt ml mm mn mo aw mp bi"><span id="ccae" class="mq mr it mm b gy ms mt l mu mv">from sklearn.datasets import fetch_openml<br/>from sklearn.ensemble import RandomForestClassifier<br/>from time import time<br/>from matplotlib import pyplot as plt</span></pre><p id="09b5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下面的代码中，“火山”数据集是从openml中提取的。</p><pre class="ks kt ku kv gt ml mm mn mo aw mp bi"><span id="8fbe" class="mq mr it mm b gy ms mt l mu mv">X,y= fetch_openml(name="volcanoesb3",version=1,<br/>return_X_y=True,as_frame=True)</span></pre><p id="9dfa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">训练每个模型所用的时间将保存在列表“timetaken”中。我有一台四核笔记本电脑，因此将训练最多四核的机器学习模型。如果您有一个八核或更多内核，那么您可以提到“n_cores ”,最多八个或更多内核。</p><pre class="ks kt ku kv gt ml mm mn mo aw mp bi"><span id="6494" class="mq mr it mm b gy ms mt l mu mv">timetaken = []<br/>n_cores = [1, 2, 3, 4]</span></pre><p id="a1ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下面的代码中，机器学习模型在一个循环中从单核到四核进行训练，并且节省了训练所用的时间。</p><p id="74ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以用RandomForestClassifier中的“n_jobs”参数指定并行运行的作业数量。如果我们希望使用所有可用的内核，那么我们可以将“n_jobs”指定为“-1”</p><pre class="ks kt ku kv gt ml mm mn mo aw mp bi"><span id="8e14" class="mq mr it mm b gy ms mt l mu mv">for n in n_cores:<br/>    start = time()<br/>    model = RandomForestClassifier(n_estimators=1500,<br/>                                   random_state=42, n_jobs=n)<br/>    model.fit(X, y)<br/>    end = time()<br/>    elapsedtime = end - start<br/>    timetaken.append(elapsedtime)</span></pre><p id="ad2f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">直观显示用不同核心训练模型所需的时间是很有帮助的。</p><pre class="ks kt ku kv gt ml mm mn mo aw mp bi"><span id="bf96" class="mq mr it mm b gy ms mt l mu mv">plt.plot(n_cores, timetaken)<br/>plt.show()</span></pre><p id="fd56" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以看到，模型训练时间大幅减少，因为它是从一个核心训练到三个核心。从使用三个内核到使用所有四个内核只会略微增加一点时间。</p><p id="66b3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">用单核训练该模型花费了将近22秒，现在下降到大约。约11秒，三核。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mw"><img src="../Images/82b01bbea94fa9c65afca0d66a3320e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C50Ooedv8VPw0b-vq6aeBg.png"/></div></div></figure><blockquote class="mx my mz"><p id="b9c4" class="li lj na lk b ll lm kd ln lo lp kg lq nb ls lt lu nc lw lx ly nd ma mb mc md im bi translated">结论和要点</p></blockquote><p id="9711" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">随着物联网、传感器和存储能力的进步，可用的数据量呈超级指数级增长。</p><p id="85a9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">GPU和TPU是加速处理和提高机器学习算法性能的救星。</p><p id="c3f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">不幸的是，Scikit-Learn不支持GPU，但我们可以利用多核微处理器并行处理少量任务，并更快地获得结果。</p><p id="f003" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">即使是四核和八核笔记本电脑，我们也可以大幅缩短机器学习的处理时间。</p><p id="5bc2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">可以在Python中了解更多关于<a class="ae lh" rel="noopener" target="_blank" href="/linear-regression-in-python-sklearn-vs-excel-6790187dc9ca">线性回归的内容:Sklearn vs Excel </a></p></div></div>    
</body>
</html>