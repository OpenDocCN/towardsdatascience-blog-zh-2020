<html>
<head>
<title>Using Non-negative matrix factorization to classify companies.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用非负矩阵分解对公司进行分类。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-nmf-to-classify-companies-a77e176f276f?source=collection_archive---------9-----------------------#2020-10-01">https://towardsdatascience.com/using-nmf-to-classify-companies-a77e176f276f?source=collection_archive---------9-----------------------#2020-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9878" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从非财务标准中提取有价值的信息。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b9c57ef7110b70f0cc7982b1b554600e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y4z3xGl6kHp3lF4j"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔希·里默尔在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="059d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="1a18" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">公司是随着时间发展的复杂实体。作为一名参与投资的数据科学家，我长期以来一直在问自己这样一个问题:评估企业数据建模的最合适维度:这些东西存在于什么空间？没有比这个更好的答案了:“太多了！”。这个问题的另一种表述是询问有多少个<strong class="lt iu">独立</strong>标准足以描述一家公司。作为标准的例子，我们可以想到市场资本总额、工业部门、雇员人数、当前收入水平、碳足迹、金融分析师的意见等等:可用标准的数量很容易超过100个。这些标准<strong class="lt iu">不是独立的</strong>，相反，它们被一个隐含相关性的整体网络联系在一起。这使得选择相关的变量子集成为一项非常困难的任务。</p><h1 id="7745" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分组与预测</h1><p id="f5ab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">投资从业者通过两种主要方式将机器学习应用于这些数据:</p><ul class=""><li id="f7cf" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">通过或多或少复杂的回归，根据不同标准的历史数据预测公司的未来行为，通常是其股票市场价值的演变。这就是<strong class="lt iu">监督学习</strong>。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/269284db8f8a3a94864afb7b87487354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jq8ecnDl2PEAC7g0"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@omgitsyeshi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">石页康让</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><ul class=""><li id="e5f2" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">自动将公司分组为同质集合，从而能够将这些公司与其邻居进行比较，而无需适当的标签:这种练习被称为<strong class="lt iu">无监督学习</strong>。金融业经常使用的一个集合的例子是工业部门的概念。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/fa7c1d668f689b764f4d41c5c9f4b26e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xLpSicV-ZKeIdzIi"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@ttaifrs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">塔伊夫·拉赫曼</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e60a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这两个练习——分组和<strong class="lt iu">预测</strong>——追求不同的目标，但随着更多标准的使用，这两个练习在实施时都更加困难和不稳定。这是统计学习中众所周知的现象的表现之一，被称为“维数灾难”。</p><p id="ddfc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">因此，自然需要通过减少所用标准的数量来缩小问题的规模。说起来容易做起来难。如果我们添加一个可解释性约束，在实践中就更难实现了。</p><p id="f871" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">在本文中，我们将看到<strong class="lt iu">非负因式分解算法(NMF) </strong>如何让这两个目标更接近。</p><p id="73d7" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">现在让我们把这个问题形式化一点。</p><h1 id="e396" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">非负矩阵分解</h1><p id="3618" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">假设可用数据由(n，f)类型的X矩阵表示，即n行和f列。我们假设这些数据是正的或零的，并且是有界的——这种假设可以放宽，但这就是精神所在。</p><p id="2a3b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">X的非负因式分解是X的一种近似分解:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2577eab0ac86d37f2159e9209ab75691.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*2B-HvINoekwgE94CfHkBEg.png"/></div></figure><p id="825f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">其中W为(n，c)型，H为(f，c)型，满足约束W ≥ 0，H ≥ 0。<br/>需要记住的一些要点:</p><ul class=""><li id="074f" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">这种分解是近似的，而不是相等的。解w和h矩阵最小化了真实数据x和它们的近似X^.之间的二次误差</li><li id="cdb0" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">这种分解不一定是唯一的，即使有积极性的约束。人们确实可以以正对角D矩阵的形式构造单位变换矩阵，然后获得以下形式的相同分解:</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/91aff50045401027978093870f1ac9ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*3jeypPN3USPAzRNSjgdgsw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">d及其逆都是正系数的对角线</p></figure><ul class=""><li id="dd86" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">c ≤ min(n，f)是一个整数，表示所选元件的数量。与K-均值聚类方法一样，该参数表示方法的参数自由度。确定组件的最佳数量需要一个额外的标准。</li><li id="425b" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">在文献中通常将W矩阵的线称为<strong class="lt iu">因子</strong>。</li></ul><p id="0d0f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">在这里可以找到关于NMF的精彩介绍。</p><h1 id="81e1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">如何解读分解</h1><p id="6022" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通常将X线视为同一类别(如客户、患者、公司等)对象的n次观察。每个对象都有f个属性，矩阵中包含的数据对应于相应对象的属性所取的值。</p><p id="e5c0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这种分解的主要效果是减少描述一个观察结果所必需的信息。以近似为代价，X矩阵的原始观测值可以恢复为具有正系数的线性组合——H矩阵的线。因此实现了大小的减小:包含在原始矩阵中的部分信息，包括每个个体的f数据，可以由每个个体的更小的c数据集合来近似概括。</p><p id="af8e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">非负分解的另一个有趣的效果是观察和属性的自然聚集的出现。潜在的数学原理在这篇论文中会带我们走得太远，但是你可以在<a class="ae ky" href="https://pubmed.ncbi.nlm.nih.gov/27213413/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>【2】中找到一个非常清晰的表述。直观地，可以根据主导因子，即c个因子中具有最高值的因子，对观察值进行聚类。同样，可以根据对其影响最大的因素对原始特征进行分组。</p><p id="b3c5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这种聚集的自然可能性与系数的正定性密切相关。这是与主成分分析(PCA)的一个重要区别，在PCA中，要求因子成对正交，这使得不可能控制系数的符号。</p><h1 id="bd02" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">企业外部财务数据的应用</h1><p id="7f12" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为投资者收集和发布非金融企业数据本身就是一个行业，参与者是评级机构。每个机构都有自己的标准和自己的评级方法，但从一个机构到另一个机构可以找到大量的标准。</p><p id="6e40" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们感兴趣的是根据环境(E)、社会(S)和治理(G)这三个主要支柱来描述公司行为的数据。这些数据被称为行为得分。他们根据男女同酬、董事会中独立董事的比例、水污染、碳足迹等标准，对公司的表现进行评分，分值范围为0到100分。</p><p id="f5af" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这些分数通常由评级机构每年审核一到两次，主要由公司在申报的基础上进行审核。我们将把这些分数中包含的信息用于:</p><ul class=""><li id="925a" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">根据比行业部门更多的内在信息确定同类公司群体，</li><li id="c37c" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">将变量分组，以减少影响因素的数量。</li></ul><p id="250e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">本文使用的数据是来自Vigeo-Eiris research的77个行为得分，Vigeo-Eiris research是穆迪评级机构的子公司，专门从事全球上市公司的财务外评级。我们在此展示的数值经验是基于欧洲500只最大股票的得分，在2011年9月至2020年6月期间进行平均评估。</p><p id="0c6b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">Vigeo的行为评分分为6个方面:</p><ul class=""><li id="d690" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">环境</li><li id="831d" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">公司治理</li><li id="1d12" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">社交:商业行为</li><li id="b14b" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">社会:人权</li><li id="6925" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">社会:人力资源</li><li id="e2c0" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">社会:社区参与</li></ul><p id="18ab" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">关于评分方法的更多内容可在此处找到<a class="ae ky" href="http://vigeo-eiris.com/about-us/methodology-quality-assurance/?lang=en" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="51fc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这种数据的多样性和粒度使得有可能设想一个比简单基于工业部门的更相关的公司分组。我们将通过对分数数据应用NMF来检验这一假设。</p><h1 id="3680" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">缺失数据的替换</h1><p id="467c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">并非所有部门的所有行动都有行为得分，因此该系列有缺失值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/69b23c28fc92e82c0213fbffe4ba94e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*was2db6PJe8m4Ixb9Eq0Ew.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">各种分数的部门平均填充率的图形视图。全球平均水平为81.6%。</p></figure><p id="0165" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">图表最左侧的分数具有100%的填充率。例如，与商业行为(以C_S开头)或公司治理(以C_G开头)相关的分数就是如此。另一方面，高度专业化的得分，如当地污染治理(名为EnV2_6)的填充率最低，在一些主题相关性较低的部门(金融、房地产)，填充率可降至0。</p><p id="2835" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">像大量基于矩阵代数的方法一样，NMF不允许<strong class="lt iu">丢失数据</strong>。因此，我们将用相同分数的平均值替换原始矩阵中每个分数缺失的值，该平均值取自填写了该分数的所有公司。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/00db373b95ea77a75935934f9393483a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BPzATGndqmop7zCR4RSDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">填充缺失数据后要素的相关矩阵-平均成对相关为41%。两个分数之间的相关性是跨500只股票计算的。</p></figure><h1 id="a6a7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">寻找最佳维度</h1><p id="3aec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们现在几乎准备好启动NMF分解。我们现在要做的就是为参数c选择一个值。我们对该参数的最佳值知之甚少，但我们希望以下方案是正确的:</p><ul class=""><li id="80fb" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">c == &gt;数据保存的小值和不精确的模型，</li><li id="df13" class="mn mo it lt b lu ne lx nf ma ng me nh mi ni mm mu mv mw mx bi translated">c == &gt;数据密集的大值和更精确的模型。</li></ul><p id="6f72" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这个原则将帮助我们定义一个目标函数，该函数综合了<strong class="lt iu">稀疏度</strong>、<strong class="lt iu">稳定性</strong>和<strong class="lt iu">精度的概念。</strong>这些概念确实是预测系统可解释性的关键因素，正如这里的<a class="ae ky" href="https://www.stat.berkeley.edu/~binyu/ps/papers2019/Dahshu19-yu.pdf" rel="noopener ugc nofollow" target="_blank"/>【3】，【4】所解释的。为了简单起见，在本文中我们将把稳定性放在一边，重点放在稀疏性和精确性上。</p><p id="e175" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">为了量化稀疏性，让我们观察大小为(n，f)的初始矩阵已经被分别大小为(n，c)和(c，f)的两个矩阵所代替。因此，我们可以定义由以下公式给出的<strong class="lt iu">稀疏分数</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/47a3af92f88ec72e17eac3e48a8cc691.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*EQ3J5DkhpN48WsQjLlYbbA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">sp(c)是c分量的<strong class="bd nn">稀疏分数</strong>,</p></figure><p id="a938" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">当然，对于c = 1，这个分数将是最小的，在理论情况下，所有的观测值将大致是单个向量的倍数。</p><p id="a3ae" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">为了量化精度，很自然地通过以下公式定义类似于线性回归R的<strong class="lt iu">精度分数</strong> err(c ):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/dbbcd5ab9e8973247264145abf7cc87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*fV3EAwyOAX5IpKszbLZ88Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逼近误差的归一化度量。</p></figure><p id="3d73" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">我们可以通过结合精确性和稀疏性最终定义一个<strong class="lt iu">可解释性得分</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/76730c655fdb81e96cc217bab868d553.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*v_MsVpTXsZNyp7nBi9gosA.png"/></div></figure><p id="66df" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这个分数是一个介于0和1之间的数字，按照惯例<strong class="lt iu"> 0是可解释性的最佳水平</strong>，1是最差水平。</p><p id="29cc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">当c = 1或c = c*时，分数被校准为100%最大值；常数c*起着最大可接受维数的作用，这里设置为20。</p><p id="681e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这里有几行你必须写的代码，计算一个给定维度c的<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.NMF.html" rel="noopener ugc nofollow" target="_blank"> NMF分解</a>:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="d2e1" class="nv la it nr b gy nw nx l ny nz"><strong class="nr iu">&gt;&gt;&gt; import</strong> <strong class="nr iu">numpy</strong> <strong class="nr iu">as</strong> <strong class="nr iu">np<br/>&gt;&gt;&gt; import pandas as pd<br/>&gt;&gt;&gt; from</strong> <strong class="nr iu">sklearn.decomposition</strong> <strong class="nr iu">import</strong> NMF</span><span id="417c" class="nv la it nr b gy oa nx l ny nz"><strong class="nr iu">&gt;&gt;&gt; </strong>X = pd.read_csv (scores_file_path)  # reading the score data<br/><strong class="nr iu">&gt;&gt;&gt; </strong>c = 4<strong class="nr iu"><br/>&gt;&gt;&gt; </strong>model = NMF(n_components=c, init='random', random_state=0)<br/><strong class="nr iu">&gt;&gt;&gt; </strong>W = model.fit_transform(X)<br/><strong class="nr iu">&gt;&gt;&gt; </strong>H = model.components_<br/><strong class="nr iu">&gt;&gt;&gt; </strong>err = model.reconstruction_err_</span></pre><p id="6eaa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">矩阵H和W是计算的主要输出，需要它们来重建近似矩阵和误差函数err(c)。</p><p id="8f34" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">下图是通过绘制sp(c)、err(c)和inter score(c)的值获得的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/010f29bac31570161ad5da7510d08a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-i5FuwHwGHLAg1IQbJWcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">c = 6时可解释性得分最佳</p></figure><p id="81b2" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">该图清楚地显示了精度和简约性之间的权衡，c在2到6之间急剧下降，随后随着c值的增大而缓慢加速上升，在下文中，出于示例的目的，我们保留c=6作为元件数量。</p><h1 id="5147" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">收集NMF福利</h1><h2 id="5af7" class="nv la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">特征收缩</h2><p id="5769" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们从非负因式分解中获得的最明显的好处是，最初的77个特征被6个正线性组合的缩减子集，即<strong class="lt iu"> <em class="on">元特征</em> </strong>所取代。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/b58de349f1ee62e9dfab0fc22a4603aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1qXxAV-KywBxMdp_79cKw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">随着等级的增加，特性显得更有选择性。</p></figure><p id="ac50" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">该图显示了6个新的元特征在最初的77个特征上的系数分布(“负载”)。正如所料，这些系数分布在几个特征上，线性组合可能难以解释。元特征#1尤其如此，随着元特征等级的增加，系数越来越集中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/5bd5b4c9358c5537cdb9d4579b52cc15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxwubT17i6mefKyzX_vBJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将<strong class="bd nn">主题</strong>分配给元特征</p></figure><p id="18b3" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">这个数组显示了每个元特性的6个最具影响力的特性。有趣的是，这些流入特征的主题是相互关联的。因此，我们可以为每个元特征分配一个主题。例如，特写V1讲述的故事大多是关于<strong class="lt iu">人权</strong> (hrts)和人力资源(hr)，而V4讲得很清楚的是<strong class="lt iu">环境</strong> (env)。</p><p id="5e0e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">NMF交易了维度和可解释性，通过大幅降低维度(从77到6)，代价是获得更多的<strong class="lt iu"><em class="on"/></strong>但仍有<strong class="lt iu">有意义的<em class="on"> </em> </strong>特征。</p><h2 id="98cb" class="nv la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">公司集群</h2><p id="48d1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">有趣的是，NMF的对称公式还提供了一种将所有公司分组为6个可能集群的自然方法:当股票的最大价值在列I中时，即当其在元特征#i上的得分最高时，我们简单地将集群#i分配给股票。让我们来看看这种将公司分组的新方法如何对应于通常的行业:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/47efa4dfe33abfbf056aeaf8a3d67d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrqoaTlGvaHNhGVF3k8tWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd nn">NC = 6个分量的扇区/ NMF簇对应关系</strong></p></figure><p id="76c4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">基于NMF的聚类带来了不包含在单独的部门中的信息。我们可以将前面图中的每一行作为各个元特征的每个扇区的“签名”。例如，能源部门在与环境主题相关的元特征#4中得分最低。</p><h2 id="ab5a" class="nv la it bd lb oc od dn lf oe of dp lj ma og oh ll me oi oj ln mi ok ol lp om bi translated">缺失数据</h2><p id="1d3d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">记住，我们从一个包含缺失数据的X矩阵开始。我们已经用每一列的<strong class="lt iu">全局平均值</strong>填充了空的单元格，并用填充后的矩阵填充了我们的NMF算法。</p><p id="30e1" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">既然我们已经有了股票的聚类，为什么我们不尝试通过用每列的平均值代替空单元格来改进缺失数据的填充，用相同聚类的股票来代替所有股票呢？这将提供对X的新估计，该估计又可以用作因式分解的输入。如此等等…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/b26ebd89363344ed864def738b51cd78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wv-hGgc7MhtE4eBxH7uiDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用NMF对缺失数据进行自举可以减少20%的近似误差。</p></figure><p id="c52b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">与基于均值的先验知识相比，NMF提供的线聚类允许<strong class="lt iu">以更高的精度插值数据矩阵的缺失值</strong>。这种方法在许多领域非常有用，主要优点是相对于像扇区这样的外部聚类的独立性:它是完全数据驱动的吗？</p><h1 id="69f5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="eb00" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">本文旨在说明并支持如何使用非负矩阵分解作为一种强大的工具来创建观察值和特征的自然分组。这一点在生命科学领域早就被认识到，特别是在基因组学领域，减少特征的数量同时保持分析的可解释性是至关重要的。</p><p id="0166" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">将NMF应用于额外的金融数据是提取这些数据集中包含的有价值信息的一种创新方法。我们使用了特定提供商Vigeo-Eiris的数据，但好消息是，当使用多个数据源来展示公司的基本属性时，这种方法将非常稳健。</p><h1 id="4781" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">进一步阅读的参考资料</h1><p id="e579" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">[1]丁，钟汉卿；陶；Jordan，M.I .凸和半非负矩阵分解(2010年)。IEEE Trans。模式<br/>肛门。马赫。Intelli。拱门。2010, 32, 44–55.</p><p id="a57d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">[2] P.Fogel，Y. Gaston-Mathé等人，使用非负矩阵分解的新型聚类方法在公共卫生环境<br/>研究中的应用(2016)，国际环境研究和公共卫生杂志。</p><p id="d4c9" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">[3] B. Yu和K. Kumbier，数据科学的三个原则:可预测性、可计算性和稳定性(pcs) (2019)，arXiv预印本arXiv:1901.08152。</p><p id="0be0" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">[4]诉玛戈特。比较可解释性的严格方法(2020)，arXiv预印本arXiv:2004.01570。</p><p id="6caa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma na mc md me nb mg mh mi nc mk ml mm im bi translated">[5] Vigeo-Eiris，网站(2020年)</p></div></div>    
</body>
</html>