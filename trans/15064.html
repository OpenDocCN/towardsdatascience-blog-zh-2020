<html>
<head>
<title>Logistic Regression — Giraffes and Cars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归——长颈鹿和汽车</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/logistic-regression-giraffes-and-cars-1cb67ab8a571?source=collection_archive---------36-----------------------#2020-10-16">https://towardsdatascience.com/logistic-regression-giraffes-and-cars-1cb67ab8a571?source=collection_archive---------36-----------------------#2020-10-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fb941abe7c9a2ffd2b926d7b8b4460a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xJKPp80nKaPWvpVV"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/@marcinjozwiak?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Marcin Jozwiak </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1013" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不久前，我在Coursera上开设了一门应用机器学习的课程。为了帮助上这门课的其他人，也为了帮助我自己更好地理解主题，我决定根据课程安排制作一些简短的教程。我的前两篇文章讨论了KNN分类和线性(多项式)回归。有兴趣的话，可以随便看看。</p><div class="lb lc gp gr ld le"><a rel="noopener follow" target="_blank" href="/towards-machine-learning-k-nearest-neighbour-knn-7d5eaf53d36c"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">走向机器学习——K近邻(KNN)</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">根据油耗和发动机大小对汽车进行简单的K近邻(KNN)分类。</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">towardsdatascience.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><div class="lb lc gp gr ld le"><a rel="noopener follow" target="_blank" href="/towards-machine-learning-linear-regression-and-polynomial-regression-df0c83c15b6e"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">走向机器学习——线性回归和多项式回归</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">什么方法能更好地预测你汽车的二氧化碳排放量？线性回归还是多项式回归？</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">towardsdatascience.com</p></div></div><div class="ln l"><div class="lt l lp lq lr ln ls jw le"/></div></div></a></div></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="b035" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天，我将介绍一种叫做逻辑回归的技术。尽管它被称为“回归”，但它是一种分类方法。与线性回归相比，主要区别在于输出，线性回归给出连续值，而逻辑回归返回二元变量。简单来说，它解释了两类价值之间的关系，即动物是不是长颈鹿。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/5e3928c950bc03b7c11ce34424ac9c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JjxzpVVPdIi0bR04"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kc" href="https://unsplash.com/@tumbao1949?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">詹姆斯·温斯科特</a>拍摄的照片</p></figure><p id="39e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但稍后会有更多的内容。</p><p id="fc71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">文章的结构</strong>:</p><ul class=""><li id="7836" class="mg mh iq kf b kg kh kk kl ko mi ks mj kw mk la ml mm mn mo bi translated">介绍</li><li id="ae0d" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">数据集加载和描述</li><li id="5fb0" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">数据格式和模型定义</li><li id="5cf9" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">结果可视化</li><li id="1e54" class="mg mh iq kf b kg mp kk mq ko mr ks ms kw mt la ml mm mn mo bi translated">结论</li></ul><p id="e810" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">享受阅读吧！🙂</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="de50" class="mu mv iq bd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bi translated">介绍</h1><p id="97ab" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">最近，我在汽车数据上尝试了KNN和线性回归。KNN帮助我们将汽车分类为“小型车”或“大型车”，结果相当令人满意。假设有人想知道一辆车前轮驱动的概率。逻辑回归开始发挥作用，因为它计算作为目标类的对象的分数(“机会”)。也就是说，它可以根据汽车的燃料消耗、发动机大小、气缸数量或汽车的任何其他相关特征来预测汽车前轮驱动的概率。</p><h2 id="ea00" class="nx mv iq bd mw ny nz dn na oa ob dp ne ko oc od ni ks oe of nm kw og oh nq oi bi translated">逻辑回归是如何工作的？</h2><p id="5b03" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">就像线性回归一样，我们有一些输入变量，X1，X2，X3。线性回归将计算每个变量的权重，添加偏差并返回一个标签(类别)。类似地，在逻辑回归中，计算每个输入变量(X1，X2，X3)的权重，添加偏差项，然后对结果应用<em class="oj">逻辑</em> <em class="oj">函数</em>。然后，该函数返回一个介于零(负类)和一(正类)之间的值，该值描述输入对象属于正类的概率值。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/d8123750d089dd0fc668bb28cfe976f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*y9k7M6UGBQPwwX2YdDTdag.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">乙状结肠函数(来源:作者)</p></figure><p id="c907" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个简单的例子，根据<a class="ae kc" href="https://en.wikipedia.org/wiki/Giraffe" rel="noopener ugc nofollow" target="_blank">维基百科</a>的说法，一只成年长颈鹿的身高在4.3到5.7米之间。假设我们想知道一只动物是不是长颈鹿，那么我们测量动物的高度，并在X轴上显示数值，然后逻辑函数返回一只动物是长颈鹿的概率(Y轴)。然后，如果该值高于0.5，该动物被预测为长颈鹿，如果低于0.5，该模型预测该动物不是长颈鹿。除了分类之外，我们还可以获得概率信息。所以，一只身高4.8米的动物比一只身高2.7米的动物更有可能是长颈鹿。</p><p id="b5e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们更实际一点，好吗？</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="4277" class="mu mv iq bd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bi translated">数据集加载和描述</h1><p id="d922" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">首先，我们将导入依赖关系，加载汽车燃油经济性数据，并查看数据框架。要使用逻辑回归，我们需要从Scikit-Learn模型模块导入<em class="oj"> LogisticRegression </em>类。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="d79e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们将使用来自<a class="ae kc" href="https://github.com/udacity/AIPND/tree/master/Matplotlib/data" rel="noopener ugc nofollow" target="_blank"> Udacity </a>的汽车数据集。它包含3920辆汽车的技术规格，包括气缸数、发动机尺寸(排量)、油耗、二氧化碳排放量等数据，以及<em class="oj">驱动。</em></p><p id="bfaa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们今天的目标是根据驱动轮将汽车分为两类。基本上，在我们的数据库中有前轮驱动汽车、后轮驱动汽车和全轮驱动汽车。每种类型都有自己的优点和CONS，但这不是这里的主题。🙂</p><p id="e18f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想根据排量[升]和综合油耗[mpg]来预测汽车前轮驱动的概率。为此，我们需要管理标签，前轮驱动的汽车将收到标签1(正)，后轮和全轮驱动的汽车标签0(负)。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/ed003413c9f944431ba3849cf3ed21f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*yglRgvo7c3Kl8c5ILxXsFg.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">前轮驱动的汽车被标记为正类(1)，而后轮和全轮驱动的汽车被标记为负类(0)(来源:作者)</p></figure><p id="a2b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们将排量和综合油耗绘制成一对图表，我们可以注意到前轮驱动的汽车(1级-橙色点)倾向于燃烧更少的燃料(更高的mpg值)，并且排量更低。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/b86545ca703e1e648deb02189b237750.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*ScRokaFAVKwB1fClqlyEYw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">数据集的Pairplot(来源:作者)</p></figure><p id="02dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，在对任何数据应用逻辑回归之前，最好执行数据标准化(<a class="ae kc" href="https://medium.com/towards-artificial-intelligence/how-when-and-why-should-you-normalize-standardize-rescale-your-data-3f083def38ff" rel="noopener">源1 </a>、<a class="ae kc" rel="noopener" target="_blank" href="/data-scaling-for-machine-learning-the-essential-guide-d6cfda3e3d6b">源2 </a>)。基本上，它将变量集中在零附近，通过从每次测量中减去平均值并将结果除以标准偏差，将方差设置为1。我们将在标准化和不标准化的情况下运行我们的模型，只是为了看看它在这个特定的数据集上是否有任何不同。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="fa12" class="mu mv iq bd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bi translated">数据格式和模型定义</h1><p id="5dc7" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">首先，我们从数据集中选择所需的列。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="3dab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，当对任何数据应用逻辑回归时，执行数据标准化(<a class="ae kc" href="https://medium.com/towards-artificial-intelligence/how-when-and-why-should-you-normalize-standardize-rescale-your-data-3f083def38ff" rel="noopener">源1 </a>、<a class="ae kc" rel="noopener" target="_blank" href="/data-scaling-for-machine-learning-the-essential-guide-d6cfda3e3d6b">源2 </a>)是一个很好的实践。基本上，它将变量集中在零附近，通过从每次测量中减去平均值并将结果除以标准偏差，将方差设置为1。我们将在标准化和不标准化的情况下运行我们的模型，只是为了看看它在这个特定的数据集上是否有任何不同。</p><h2 id="1d8d" class="nx mv iq bd mw ny nz dn na oa ob dp ne ko oc od ni ks oe of nm kw og oh nq oi bi translated">如何进行标准化？</h2><p id="e393" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">Scikit-learn也有一个关于这个的类，它叫做<em class="oj"> StandardScaler </em>。让我们看一个例子:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="b4b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们来对比一下标准化前后的数据。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/af144d91a02782a5e41b9a1d8ab4db0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*UnB0XZzzb9p5UUJ4yumWwA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">(来源:作者)</p></figure><p id="8140" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如所料，我们可以观察到，现在数据的标准偏差明显更低，数据的范围也更小，因此值更接近。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/148b6f247c5aed69ed97575e6355a713.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*7MMzk0SwEQ-Mb_FVAPpNMg.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">(来源:作者)</p></figure><p id="9749" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下一步中，我们想要检查这个度量是否为我们的模型产生一些好处或缺点。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="fae4" class="nx mv iq bd mw ny nz dn na oa ob dp ne ko oc od ni ks oe of nm kw og oh nq oi bi translated">模型定义</h2><p id="fcc2" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">我们就可以应用这个模型。和Scikit-learn一样，这是一个非常简单的过程。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="8348" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很好，模型准备好了，现在让我们看看结果！</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="2193" class="nx mv iq bd mw ny nz dn na oa ob dp ne ko oc od ni ks oe of nm kw og oh nq oi bi translated">标准化数据会影响模型的准确性吗？</h2><p id="42d6" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">嗯，可能是由于一个大的数据集，根本不是。让我们看看结果。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/ef1f24b03bb85b0401f25eff2b611fe8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ET9gBx2Fnan-0UWVW5Ybsg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">未缩放模型的训练和测试集结果(来源:作者)</p></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi os"><img src="../Images/e9dcaa2e402578cd5e20f8297f19db61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pug4eD9NwehifM4bIOwM7w.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">缩放模型的训练和测试集结果(来源:作者)</p></figure><p id="923c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与我们的预期相反，训练结果没有变化，而测试集的准确性略有下降。</p><p id="b159" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些数字看起来不错，但是用一个真实的例子来测试这个模型肯定会更好，不是吗？</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/935443e52c0ff76b43599959262f0d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*BRIybOx4kBUX30koCVQDHA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">测试编号1(来源:作者)</p></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a1f6940c2108c950b6cada73bd66dbff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*LXjW5pgsSu8Q4A16NjisEQ.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">测试编号2(来源:作者)</p></figure><p id="c4b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在两辆车上测试了这款车型，一辆是2016年款的<a class="ae kc" href="https://www.automobile-catalog.com/car/2016/1817390/ford_fiesta_sport_1_0_ecoboost_125.html" rel="noopener ugc nofollow" target="_blank">福特嘉年华运动版</a>，一辆是2018年款的<a class="ae kc" href="https://www.automobile-catalog.com/car/2018/2574275/bmw_m5.html" rel="noopener ugc nofollow" target="_blank">宝马M5版</a>。而且对于两款车，模型预测都是正确的。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="75d9" class="mu mv iq bd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bi translated">结果可视化</h1><p id="f328" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">所以我们问自己，数据集群之间的边界在哪里？好吧，让我们来看看。</p><p id="1360" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有两种方式创造情节。一种包括，计算<em class="oj">决策边界线</em>的<em class="oj">斜率</em>和<em class="oj">截距</em>，绘制成简单的线图。另一种方法是创建网格，并将边界绘制为将数据分成两半的等高线。</p><p id="1ac5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有两种方式创造情节。一种包括，计算<em class="oj">决策边界线</em>的<em class="oj">斜率</em>和<em class="oj">截距</em>，绘制成简单的线图。另一种方法是创建网格，并将边界绘制为将数据分成两半的等高线。</p><p id="aa88" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们从更简单的方法开始。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="9824" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们检索参数，然后计算边界的斜率和截距。基本上我们是在计算一条线性回归线，它描述了我们的X轴值(排量)和Y轴值(综合燃油经济性)之间的关系。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/8ca1e8e9d77cab8e4932e3fb81967fdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*i7oKqxPKtMvgEChs9F57aw.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">使用plt.plot的决策边界图(来源:作者)</p></figure><p id="e485" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，标签1代表正类(前轮驱动的汽车)，而标签0代表所有其他汽车(负类)，在这种情况下是后轮和全轮驱动的汽车。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="defb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">绘制边界的第二种方法是使用等高线法。首先，定义网格，其中为两个特征(排量和综合燃油经济性)定义最小值和最大值。<strong class="kf ir"> <em class="oj"> Numpy.c_ </em> </strong>沿第二个轴串联数组。计算每个网格点的概率。这里需要了解的是，我们在这里使用我们的模型<strong class="kf ir"> <em class="oj"> logreg </em> </strong>，其目的是为了可视化<strong class="kf ir"> <em class="oj">斜率</em> </strong>和<strong class="kf ir"> <em class="oj">截距</em> </strong>。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="0335" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们需要定义情节。</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/b3edde523bd342c24122d6d2911afd5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*BEuryMzGa6pebsKTFHWlHg.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">用等高线法判定边界图(来源:作者)</p></figure><p id="46b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了显示边界线，我们只显示截取汽车前轮驱动的50%概率的轮廓线。线上的所有汽车都被预测为前轮驱动(<em class="oj">正1级</em>)，而线下的所有汽车都被预测为非前轮驱动，因此它们要么是后轮驱动，要么是全轮驱动。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="75fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们也可以将概率作为一种颜色添加到我们的绘图中。这有助于直观识别概率，因此无需运行模型或计算准确的概率就可以评估概率。</p><p id="f46a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">代码如下:</p><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/dfb0c2c6ea2fbb07bacd49f4e2ac57b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*LDvIJ6S6pLDAb1FGoXfjYA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">概率绘制成等高线图(来源:作者)</p></figure><p id="5a64" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我需要指出的是，这里我们有两个特征，也有一个二维图。更多的特征会增加绘图的维数。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h1 id="b5b8" class="mu mv iq bd mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bi translated">结论</h1><p id="3ad1" class="pw-post-body-paragraph kd ke iq kf b kg ns ki kj kk nt km kn ko nu kq kr ks nv ku kv kw nw ky kz la ij bi translated">在这里，我们给出了一个如何使用逻辑回归根据汽车的排量和综合燃油经济性来预测汽车行驶的例子。此外，还评估了数据标准化技术。对于这个特定的数据集，标准化对模型精度没有影响。</p><p id="bc31" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已经使用两种技术计算并绘制了两个标签数据集群(前轮和非前轮驱动汽车)之间的判定边界。此外，还添加了概率等值线图。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="2168" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢我的文章。如果一些介绍的主题需要进一步解释，请随时通过<a class="ae kc" href="https://www.linkedin.com/in/karlo-leskovar-a8612b105/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。🙂</p><p id="b180" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也直到下次，检查出<a class="ae kc" href="https://medium.com/@Karlo_Leskovar" rel="noopener">我的其他文章</a>。干杯！</p></div></div>    
</body>
</html>