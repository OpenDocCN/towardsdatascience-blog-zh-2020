<html>
<head>
<title>Face Recognizer — Your 4th CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面部识别器—您的第四个CNN</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/shahrukh-khan-face-recognizer-your-4th-cnn-38668dae5afc?source=collection_archive---------47-----------------------#2020-10-06">https://towardsdatascience.com/shahrukh-khan-face-recognizer-your-4th-cnn-38668dae5afc?source=collection_archive---------47-----------------------#2020-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/102e47bf51f85826fefc8b41038aa533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6p3QmDP9-61JhTuD"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">亚历山大·克里维茨基在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><blockquote class="kd"><p id="bd62" class="ke kf iq bd kg kh ki kj kk kl km kn dk translated">第四CNN？</p></blockquote><p id="1794" class="pw-post-body-paragraph ko kp iq kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk kn ij bi translated">这是我在自己动手CNN模型系列的第四篇文章。像往常一样，格式将保持不变。我将为您提供一个Colab文件(它工作得非常好)，您必须在没有任何先决条件的情况下运行它，然后才能继续。原因是，一旦你自己运行它，你会变得更加重视这个问题，你会得到更深刻的见解。</p><p id="3e94" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">你可以在这里查看我以前的文章:</p><ul class=""><li id="3c8d" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/handwritten-digit-classifier-your-first-end-to-end-cnn-in-5-minutes-5be3d9c6c4c0">手写数字分类器</a></li><li id="4e74" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/cats-vs-dogs-your-second-end-to-end-cnn-classifier-in-5-minutes-9adfbde08a09">猫狗分类器</a></li><li id="7afe" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><a class="ae kc" rel="noopener" target="_blank" href="/zebra-detector-your-third-end-to-end-cnn-in-5-minutes-3ffea91d5566">斑马物体探测器</a></li></ul><p id="a0c7" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">在这篇文章中，我们将解决和理解CNN最重要的问题之一——人脸识别。即给定一个人的照片，找出其姓名。我们将拍摄宝莱坞最著名的演员沙鲁克·汗的照片，并确定他的身份。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/f774c6e775b8f69582f7e5f5fc7d4e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*ZKdr0XFkGITEVs7HTGFAhQ.jpeg"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://upload.wikimedia.org/wikipedia/commons/6/6e/Shah_Rukh_Khan_graces_the_launch_of_the_new_Santro.jpg" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><p id="9b89" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">那么，事不宜迟，让我把<a class="ae kc" href="https://colab.research.google.com/drive/1Nj4xLhVCtXWP-Fo9eEFMwYAe8K003Ox4?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab文件</a>交给你🚀。这不是我的作品，而是从各地抄袭来的。我在这里做的唯一一件事是确保它在Colab设置中运行良好(令人惊讶的是，这很难做到)。但是，尽管如此，它现在工作得很好，唷！</p><p id="a97f" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">请随意上传您的图像并检测它们！现在，这个文件看起来可能有点吓人，但实际上并不是这样。像往常一样，我们先从理论开始，稍后将讨论实现细节。此外，根据我以前的文章，我会尽量保持简短和甜蜜。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="5347" class="mq mr iq bd ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn bi translated">人脸检测vs验证Vs识别器</h1><p id="d825" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">首先，我们所说的识别器实际上指的是什么？</p><ul class=""><li id="c86c" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated"><em class="nt">人脸检测——它完全类似于物体检测。检测图像中的所有人脸并找到它们的位置</em></li><li id="c4f8" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><em class="nt">人脸验证——给出两张人脸，确定是否属于同一个人。</em></li><li id="1c00" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><em class="nt">人脸识别器——识别被检测人的姓名。</em></li></ul></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="87c6" class="mq mr iq bd ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn bi translated"><em class="nu">人脸检测</em></h1><p id="f057" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">这与目标是专门检测面部(而不是任何随机对象)的<a class="ae kc" rel="noopener" target="_blank" href="/zebra-detector-your-third-end-to-end-cnn-in-5-minutes-3ffea91d5566">对象检测</a>完全一致。有几个著名的型号可供选择。我不会深入探讨这个问题，因为这超出了我的博客范围。</p><ul class=""><li id="72ec" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt"> Dlib </em> </strong> <em class="nt">:作用于梯度方向直方图(HOG)和线性SVM。不过，这只能检测正面人脸。</em> <a class="ae kc" rel="noopener" target="_blank" href="/cnn-based-face-detector-from-dlib-c3696195e01c"> <em class="nt">阅读更多</em> </a> <em class="nt">。</em></li><li id="231e" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">哈尔级联:</em> </strong> <em class="nt">是CNN上的一个优化技术。所有的内核并没有一起应用。相反，它们被分成多个更小的组。如果在第一组中没有检测到任何东西，它就不会继续前进。</em></li><li id="64b3" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt"> MTCNN </em> </strong> <em class="nt">:其CNN有多个阶段。第一种状态检测边界框，在后面的阶段消除误报，并选择人脸的最终边界标志。</em></li></ul><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/b10e606cdd8d2b4854fd91393889ef58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spboLQwiX1wfmwyde-WR_g.png"/></div></div></figure></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="d67b" class="mq mr iq bd ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn bi translated">人脸识别器</h1><p id="f9e9" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">现在，一旦检测到人脸，识别这个人的名字就完全是另外一个问题了。在继续之前，让我在这里介绍几个概念。</p><h2 id="65a4" class="nw mr iq bd ms nx ny dn mw nz oa dp na kz ob oc ne ld od oe ni lh of og nm oh bi translated"><strong class="ak">概念一:人脸嵌入</strong></h2><p id="6b7c" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">这正是在单词嵌入方面。唯一的区别是它代表欧几里得空间中的人脸。</p><ul class=""><li id="3f93" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated">每张脸都被转换成一个矢量，这个矢量以某种方式代表了这张脸的所有特征。</li><li id="4598" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><em class="nt">所有这些向量都被绘制成欧几里得空间上的点。</em></li><li id="c992" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><em class="nt">点越近，脸越相似</em>。</li></ul><h2 id="ec7b" class="nw mr iq bd ms nx ny dn mw nz oa dp na kz ob oc ne ld od oe ni lh of og nm oh bi translated">概念2:连体网络</h2><p id="fb07" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">你听说过连体双胞胎吗？这些是长得一模一样的连体双胞胎。我们的网络也是如此。</p><p id="1e8a" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">因此，连体网络是一种具有两个并行神经网络的架构，每个神经网络接受不同的输入。两个单独的输出然后被组合以提供两个图像的相似性的预测。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="70fc" class="mq mr iq bd ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn bi translated">暹罗网络培训技术</h1><p id="bfc9" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated">基于我们拥有的大量训练数据，通过两种技术，暹罗网络可以用来预测人的名字。</p><h2 id="0e4a" class="nw mr iq bd ms nx ny dn mw nz oa dp na kz ob oc ne ld od oe ni lh of og nm oh bi translated">技巧1:一次性学习</h2><p id="1a19" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated"><em class="nt">什么时候用这个:当我们没有足够的学习数据的时候。</em></p><p id="306b" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated"><em class="nt">工作原理:</em></p><ul class=""><li id="3602" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">训练数据:</em> </strong> <em class="nt"> 100个不同的人的100个不同的图像。</em></li><li id="98c0" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">场景:</em> </strong> <em class="nt">检查一张图片是否符合以上100个人中的任何一个。</em></li><li id="657a" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">解法:</em> </strong> <em class="nt">计算出给定图片与上述所有100张图片的相似度得分。</em></li><li id="d34f" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">结果:</em></strong><em class="nt">100分中图像相似度得分最高的一个(高于截止值)，将被标记为匹配。</em></li></ul><h2 id="9129" class="nw mr iq bd ms nx ny dn mw nz oa dp na kz ob oc ne ld od oe ni lh of og nm oh bi translated">技巧2:三重态丢失</h2><p id="6fde" class="pw-post-body-paragraph ko kp iq kq b kr no kt ku kv np kx ky kz nq lb lc ld nr lf lg lh ns lj lk kn ij bi translated"><em class="nt">什么时候用这个:当我们有足够的学习数据来很好地训练网络的时候。</em></p><p id="509b" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">它是如何工作的？</p><ul class=""><li id="31da" class="lq lr iq kq b kr ll kv lm kz ls ld lt lh lu kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">训练数据:</em> </strong> <em class="nt"> 1000个不同的人的1000个不同的图像。</em></li><li id="bd33" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">训练步骤:</em> </strong> <em class="nt">取一张锚点图像，用匹配图像和不匹配图像进行训练。并计算损失。这种损失叫做</em> <strong class="kq ir"> <em class="nt">三重损失</em> </strong> <em class="nt">。</em></li><li id="3ade" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">场景:</em> </strong> <em class="nt">检查一张图片是否符合以上100个人中的任何一个。</em></li><li id="1f53" class="lq lr iq kq b kr lz kv ma kz mb ld mc lh md kn lv lw lx ly bi translated"><strong class="kq ir"> <em class="nt">解决方案:</em> </strong> <em class="nt">就像其他CNN一样，把它作为输入发送给一个已经训练好的系统，得到相关的输出。</em></li></ul><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/958914435544cd5e8f82c584fc8585b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkWtazW8vi8Vljk_qeU96g.png"/></div></div></figure></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><p id="ea1d" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">为了实现人脸检测和识别，以沙鲁克·汗为例。正如你所看到的，人脸检测和识别是如何工作的，并给出如此准确的结果。这里使用了基于MTCNN的人脸检测和基于三元组丢失的人脸识别器。</p><p id="5b76" class="pw-post-body-paragraph ko kp iq kq b kr ll kt ku kv lm kx ky kz ln lb lc ld lo lf lg lh lp lj lk kn ij bi translated">请随意上传你最喜欢的演员的照片，并与它一起玩。</p></div></div>    
</body>
</html>