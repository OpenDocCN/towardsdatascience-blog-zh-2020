<html>
<head>
<title>How To Build Your Own Chatbot Using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用深度学习构建自己的聊天机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-your-own-chatbot-using-deep-learning-bb41f970e281?source=collection_archive---------0-----------------------#2020-10-31">https://towardsdatascience.com/how-to-build-your-own-chatbot-using-deep-learning-bb41f970e281?source=collection_archive---------0-----------------------#2020-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a64c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">实现智能聊天机器人解决方案的全面分步指南</h2></div><p id="050b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您对开发聊天机器人感兴趣，您会发现有很多强大的机器人开发框架、工具和平台可以用来实现智能聊天机器人解决方案。使用深度学习，而不是使用任何bot开发框架或任何其他平台，从零开始开发一个简单、智能的聊天机器人怎么样？在本教程中，您可以了解如何使用深度学习和Keras开发端到端的特定领域智能聊天机器人解决方案。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/e4c4cb0af338146a089839f513fdc4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Uw73g_s3MI5RVoMAifeYA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">来自<a class="ae lr" href="https://www.flickr.com/photos/botreetech/45874656231/" rel="noopener ugc nofollow" target="_blank"> flickr </a>的<a class="ae lr" href="https://www.flickr.com/photos/botreetech/" rel="noopener ugc nofollow" target="_blank">萨姆·伍德</a>的照片</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="2702" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">概念</h1><p id="2b4d" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在进入编码部分之前，首先，我们需要理解一些设计概念。由于我们要开发一个基于深度学习的模型，我们需要数据来训练我们的模型。但我们不会收集或下载任何大型数据集，因为这是一个简单的聊天机器人。我们可以创建自己的数据集来训练模型。为了创建这个数据集，我们需要理解我们要训练的意图是什么。“<strong class="kh ir">意图”</strong>是用户与聊天机器人交互的意图，或者聊天机器人从特定用户接收的每条消息背后的意图。根据您正在开发的聊天机器人解决方案的领域，这些意图可能会因聊天机器人解决方案的不同而不同。因此，了解你的聊天机器人与你将要工作的领域相关的正确意图是很重要的。</p><p id="7ebb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那为什么它需要定义这些意图呢？这是需要理解的非常重要的一点。为了回答问题、从领域知识库中搜索和执行各种其他任务来继续与用户对话，你的聊天机器人真的需要理解用户说什么或他们打算做什么。这就是为什么你的聊天机器人需要理解用户信息背后的意图(来识别用户的意图)。</p><p id="4bdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如何让你的聊天机器人理解用户的意图，让用户觉得它知道他们想要什么，并提供准确的回答。这里的策略是定义不同的意图，并为这些意图制作训练样本，并使用这些训练样本数据作为模型训练数据(X)和意图作为模型训练类别(Y)来训练您的聊天机器人模型。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="7539" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">履行</h1><h2 id="e9cc" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">必需的包</h2><p id="c51b" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">所需的python包如下，(这里我提到了我在开发中使用的包的版本)</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="fd43" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">定义意图</h2><p id="d0aa" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我将定义几个简单的意图和对应于这些意图的一堆消息，并根据每个意图类别映射一些响应。我将创建一个名为“intents.json”的JSON文件，包括如下数据。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="ce3f" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">数据准备</h2><p id="451c" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">首先我们需要导入所有需要的包</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="ef74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们加载json文件并提取所需的数据。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="56f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">变量“<em class="nk"> training_sentences </em>”保存所有的训练数据(即每个意图类别中的样本消息)，变量“<em class="nk"> training_labels </em>”保存每个训练数据对应的所有目标标签。</p><p id="d635" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们使用scikit-learn提供的“<em class="nk"> LabelEncoder() </em>”函数将目标标签转换成模型可理解的形式。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="e614" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我们通过使用“<em class="nk">记号赋予器</em>”类对我们的文本数据语料库进行矢量化，它允许我们将词汇量限制到某个定义的数字。当我们使用这个类进行文本预处理任务时，默认情况下，所有标点符号都将被删除，将文本转换为空格分隔的单词序列，然后这些序列被拆分为标记列表。然后它们将被索引或矢量化。我们还可以添加“oov_token ”,它是“out of token”的一个值，用于在推理时处理词汇表之外的单词(token)。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="c8c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用“<em class="nk"> pad_sequences </em>”方法使所有的训练文本序列大小相同。</p><h2 id="2128" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">模特培训</h2><p id="aa9a" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">让我们为提议的模型定义我们的神经网络架构，为此我们使用<strong class="kh ir"> Keras的“<em class="nk">顺序</em>”模型类。</strong></p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="4f44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的模型架构如下所示。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nl"><img src="../Images/333d67ea1c27c6bc775fb1813a7a4e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpeGTIoKmRdJ33tj_aj1Pw.png"/></div></div></figure><p id="5adf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们准备训练我们的模型。简单地说，我们可以用训练数据和标签调用“<em class="nk"> fit </em>”方法。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="24b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练后，最好保存所有需要的文件，以便在推理时使用。以便我们保存训练的模型、拟合的记号赋予器对象和拟合的标签编码器对象。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="6807" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">推理</h2><p id="f9e7" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">好吧！！！！现在是时候检查我们的模型表现如何了。😊</p><p id="f861" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将实现一个聊天功能，与一个真正的用户互动。当收到新的用户消息时，聊天机器人将计算新文本序列和训练数据之间的相似度。考虑到每个类别的置信度得分，它将用户消息分类到具有最高置信度得分的意图。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="c976" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到它的工作非常完美！！！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/86f2a06e1eab2e653c4f34114a421d8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/1*Gh2GJmV4a5oda20o8M65JA.gif"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="6a30" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">与聊天应用程序集成</h2><p id="a274" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">此外，您可以将训练好的聊天机器人模型与任何其他聊天应用程序集成，以便更有效地与现实世界的用户打交道。</p><p id="8906" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经使用flask开发了一个应用程序，并将这个经过训练的聊天机器人模型与该应用程序集成在一起。</p><p id="ea0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最终的解决方案是这样的，</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nn nj l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="3224" class="mw ma iq bd mb mx my dn mf mz na dp mj ko nb nc ml ks nd ne mn kw nf ng mp nh bi translated">最后的想法</h2><p id="fda9" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我们讨论了如何从头开始使用深度学习开发聊天机器人模型，以及我们如何使用它来与真实用户互动。通过这些步骤，任何人都可以实现自己的与任何领域相关的聊天机器人。</p><p id="f79d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为进一步的改进，您可以尝试不同的任务来增强性能和功能。</p><ul class=""><li id="953d" class="no np iq kh b ki kj kl km ko nq ks nr kw ns la nt nu nv nw bi translated"><strong class="kh ir">使用更多数据进行训练:</strong>您可以向训练数据集中添加更多数据。一个包含大量意图的大型数据集可以产生一个强大的聊天机器人解决方案。</li><li id="e82c" class="no np iq kh b ki nx kl ny ko nz ks oa kw ob la nt nu nv nw bi translated"><strong class="kh ir">应用不同的自然语言处理技术:</strong>您可以向您的聊天机器人解决方案添加更多的自然语言处理解决方案，如<strong class="kh ir"> NER </strong>(命名实体识别)，以便为您的聊天机器人添加更多的功能。有了NER模型和你的聊天机器人，你可以很容易地找到任何出现在用户聊天信息中的实体，并使用它进行进一步的对话。你还可以添加一个<strong class="kh ir">情感</strong> <strong class="kh ir">分析</strong>模型来识别用户信息背后不同的情感基调，它会给你的聊天机器人增添一些色彩。</li><li id="d9f0" class="no np iq kh b ki nx kl ny ko nz ks oa kw ob la nt nu nv nw bi translated"><strong class="kh ir">尝试不同的神经网络架构:</strong>你也可以用不同的超参数尝试不同的神经网络架构。</li><li id="a924" class="no np iq kh b ki nx kl ny ko nz ks oa kw ob la nt nu nv nw bi translated"><strong class="kh ir">添加表情符号:</strong>你也可以在建立你的模型时考虑表情符号。</li></ul><p id="0059" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以从<a class="ae lr" href="https://github.com/amilavm/Chatbot_Keras" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Github </strong> </a>资源库中找到本文的源代码。</p><p id="ea30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望你喜欢这篇文章，并继续关注另一篇有趣的文章。另外，我很高兴听到你的反馈。</p></div></div>    
</body>
</html>