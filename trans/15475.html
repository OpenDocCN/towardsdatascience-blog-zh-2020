<html>
<head>
<title>Python: How to Get Live Market Data (Less Than 0.1-Second Lag).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python:如何获取实时市场数据(滞后小于0.1秒)。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-how-to-get-live-market-data-less-than-0-1-second-lag-c85ee280ed93?source=collection_archive---------0-----------------------#2020-10-25">https://towardsdatascience.com/python-how-to-get-live-market-data-less-than-0-1-second-lag-c85ee280ed93?source=collection_archive---------0-----------------------#2020-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="65bc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这篇文章会有点特别。我将测试Yahoo Finance API for Python的最新版本，它提供了免费获取不到一秒钟延迟的实时数据的可能性。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ec7485161e5c9d76a603db61d207435d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*woFiMRDsHC5lQXjy"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@actionvance?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> ActionVance </a>拍照</p></figure><p id="8191" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="lv">来自《走向数据科学》编辑的提示:</em> </strong> <em class="lv">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="lv">规则和指导方针</em> </a> <em class="lv">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="lv">读者术语</em> </a> <em class="lv">。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="bf39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您将学习如何使用Python包获得实时股票市场数据，而无需调用昂贵的API，如彭博。我已经帮你测试过了。那有用吗？让我们看看。</p><blockquote class="md me mf"><p id="c634" class="kz la lv lb b lc ld ju le lf lg jx lh mg lj lk ll mh ln lo lp mi lr ls lt lu im bi translated">如果你现在热衷于自己动手，你可以在本文末尾找到完整的Python代码</p></blockquote><p id="5cb5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将能够使用Python包获得股票市场数据，如价格、交易量和基本面数据。(<em class="lv">滞后小于0.01秒</em>)</p><p id="d54d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文是下面文章的补充，在下面的文章中，我演示了如何用不到3行代码获得市场数据:</p><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/how-to-get-market-data-from-the-nyse-in-less-than-3-lines-python-41791212709c"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">如何从纽交所获取不到3行的市场数据(Python)。</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">在本文中，您将学习使用Python获取股票市场数据，如价格、交易量和基本面数据…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><p id="bbbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好，我们开始吧。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="5881" class="nb nc it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">开始前</h2><p id="2aeb" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">首先，如果你想跟踪我的进度，在开始之前，你需要在你的机器上安装一个<strong class="lb iu"> Python 3 </strong>版本和以下软件包:</p><ul class=""><li id="96cc" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated"><strong class="lb iu">熊猫</strong></li><li id="8ff9" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><strong class="lb iu"> NumPy </strong></li><li id="14aa" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><strong class="lb iu">y金融</strong></li><li id="be82" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><strong class="lb iu">plottly</strong>(非强制，但对绘图有用)</li></ul><p id="c570" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这些软件包中的任何一个尚未安装，您可以使用pip命令，如下所示。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="7cdb" class="nb nc it oo b gy os ot l ou ov">pip install yfinance<br/>pip install plotly</span></pre><p id="4045" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦您确保安装了以下软件包，我们就可以开始了。</p><blockquote class="md me mf"><p id="110e" class="kz la lv lb b lc ld ju le lf lg jx lh mg lj lk ll mh ln lo lp mi lr ls lt lu im bi translated"><strong class="lb iu"> <em class="it">如果你已经有了使用Python的经验，可以跳到第二步。第一步是导入数据。</em>T41】</strong></p></blockquote><h1 id="71c0" class="ow nc it bd nd ox oy oz ng pa pb pc nj jz pd ka nm kc pe kd np kf pf kg ns pg bi translated">一、进口包装</h1><p id="0d0f" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">第一步将包括导入必要的包。</p><p id="f931" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，您将使用以下代码行导入先前安装的软件包:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上面几行是查询要导入的numpy，pandas，yfinance &amp; plotly。</p></figure><p id="f657" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们成立了，让我们进行下一步。</p><p id="1c39" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然库已经导入，我们现在可以导入市场数据。</p><h1 id="c6fa" class="ow nc it bd nd ox oy oz ng pa pb pc nj jz pd ka nm kc pe kd np kf pf kg ns pg bi translated">二。与市场接轨</h1><p id="eccb" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">既然已经上传了所需的不同包。我们将以<strong class="lb iu"> UBER </strong>为例，通过Yahoo Finance API设置我们的导入。</p><p id="d2d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Yahoo Finance API将需要3个强制参数，顺序如下:</p><ul class=""><li id="8f79" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">跑马灯<em class="lv"> (1) </em></li><li id="7912" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated"><em class="lv">开始日期+结束日期</em>或期间<em class="lv"> (2) </em></li><li id="6387" class="nz oa it lb b lc oi lf oj li ok lm ol lq om lu oe of og oh bi translated">音程<em class="lv"> (3) </em></li></ul><p id="aa05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的例子，股票代号<em class="lv">(参数1) </em>将是<strong class="lb iu"> UBER </strong>。此外，在本例中，我们将选择最后5天的时间段<em class="lv">(参数2) </em>，而不是定义开始和结束日期。我们将设置5分钟的间隔<em class="lv">(参数3) </em>。快速提醒一下，优步的股票代码是<strong class="lb iu">优步</strong>。</p><p id="1c5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要调用您的数据，您必须使用以下结构:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/66e9bf87f4b7c58231a189f85bcab1cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zujo8q3myrtschZ-Q86HCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上面描述了获取我们感兴趣的市场数据的结构。</p></figure><p id="42f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在进一步讨论之前，我将带来第三个论点的一些细节(<em class="lv">区间</em>)。</p><h2 id="7399" class="nb nc it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">区间快速查找</h2><p id="a810" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">我想给你一个快速拍摄不同的间隔，你可以使用雅虎财经API设置。</p><p id="7eaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面详细列出了可能需要的间隔的完整列表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/56d7f4a5a151f61573d7109155712c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jc1OPGRl92RSoaymMo0Hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上面列出了可以选择的不同间隔。</p></figure><p id="77f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该间隔不会干扰获取实时数据的选项。</p><p id="dbd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们继续。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="8bcc" class="nb nc it bd nd ne nf dn ng nh ni dp nj li nk nl nm lm nn no np lq nq nr ns nt bi translated">现场测试</h2><p id="acb7" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">当我执行下面的行时，我们是2020年10月23日，实际上是伦敦时间下午5:13，这意味着市场是开放的。</p><p id="0bf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅供参考:英国时间下午5:13相当于纽约时间下午1:13。T25】</p><p id="2de8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经定义了3个参数，让我们执行下面的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">下面几行代码都是调用雅虎财经API</p></figure><p id="0887" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单回顾一下，下面的代码行调用Yahoo finance API并请求获得最近5天的数据，间隔为5分钟。</p><p id="d25e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是<strong class="lb iu">的输出:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/76ab8705b4aa7de2a17207855697ca09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*IZbZNBEwGCjPJ5ilqGoXwA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用上面的代码发布的输出。</p></figure><p id="c999" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">价格已经即时更新；我将数据与当前值进行了比较，我们匹配。</p><p id="6c0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">轰！</strong></p><p id="436c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，每秒钟都有一个更新发布。例如，如果您查看下面的输出，所提供的最新数据是1:13 PM和50秒。如果您重新运行您的内核，数据将再次更新。</p><p id="be6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任务完成。</p><p id="ac5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我把现场测试推得更远，你可以看到数据每秒都在更新，<strong class="lb iu">令人印象深刻</strong>。此外，您可以在下面的解释视频中获得完整的代码解释:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pm pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完整的现场测试编码和解释在上面的视频。</p></figure><p id="6343" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是使用Python和Plotly传播的最终实时图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/2db238e40ec86b94a42baba11a60893f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OzpcYgz6ojNj21n-6O9afw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终输出:实时图表随时间更新。</p></figure><p id="1baf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">赛义德·莱萨尼</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="3c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在这个话题上更进一步，这里是本文的第二部分，有一个真实的算法交易例子:</p><div class="mj mk gp gr ml mm"><a href="https://medium.com/analytics-vidhya/python-i-have-tested-a-trading-mathematical-technic-in-realtime-658a80381151" rel="noopener follow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">Python:我已经测试了实时交易数学技术。</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">我用Python实时测试了一个著名的预测市场的数学技术的实现…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">medium.com</p></div></div><div class="mv l"><div class="po l mx my mz mv na ks mm"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="f8ef" class="ow nc it bd nd ox pp oz ng pa pq pc nj jz pr ka nm kc ps kd np kf pt kg ns pg bi translated"><strong class="ak">来源:</strong></h1><p id="17dc" class="pw-post-body-paragraph kz la it lb b lc nu ju le lf nv jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">(1)一天学会算法交易:</p><div class="mj mk gp gr ml mm"><a href="https://www.udemy.com/course/python-for-algorithmic-trading/?couponCode=LOVE_SEPTEMBER" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">2021年:一天学会算法交易</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">你好，我是赛义德·莱萨尼。我一直在伦敦的多家银行担任数据科学家，是一名…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">www.udemy.com</p></div></div><div class="mv l"><div class="pu l mx my mz mv na ks mm"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="fb94" class="ow nc it bd nd ox pp oz ng pa pq pc nj jz pr ka nm kc ps kd np kf pt kg ns pg bi translated">完整的python代码:</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ph pi l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完整的Python代码</p></figure></div></div>    
</body>
</html>