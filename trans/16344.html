<html>
<head>
<title>Power BI Functions — (List.Contains, List.ContainsAny, List.ContainsAll)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电源BI功能—(列表。包含，列表。包含任何，列表。包含所有)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/power-bi-functions-list-contains-list-containsany-list-containsall-87ec48bdd68a?source=collection_archive---------6-----------------------#2020-11-11">https://towardsdatascience.com/power-bi-functions-list-contains-list-containsany-list-containsall-87ec48bdd68a?source=collection_archive---------6-----------------------#2020-11-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8967" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">…数据之旅的有用工具。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/379bf6ec1a7d74b85f447736a1242620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xb6IjQ-nBglbi3PW"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">马蒂亚斯·海尔在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="97bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文将向您介绍包含列表的<em class="lf">函数。这是一个很好的功能，可以用在电源查询中。每一个都有细微的差别，但是我希望这篇文章能帮助你开始。</em></p><p id="1181" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">幂查询中的列表用{}括号写。它们可以是{1，2，3}，甚至是{1，“a”，123}。如果你喜欢实验，可以去Power Query &gt;创建空白查询&gt;高级编辑器&gt;替换源信息为&gt; Source = {1，" hello "，123}。</p><p id="f0d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">记住这一点很重要——Power query中的列可以包装在{[Column A]}中以返回一个列表，这样就可以使用列表函数。您也可以参考表[A列]返回一个列表。</p><p id="a681" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是两者有所不同——在下面的数据集中使用{ [ID] }创建一个新列会为每个“单元格”返回一个值。使用#"Previous Step"[ID]返回嵌套在"单元格"中的整个列表。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/289ebd2cfd6d6ec38637e1371b9f1cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*Jk7gMGlQIBvfLxf4Lxw5Vw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="09d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在深入研究之前，先看看如何在本文中构建一个<a class="ae le" rel="noopener" target="_blank" href="/power-bi-modelling-bcd4431f49f9?sk=1f054aeeeb14c96238fd6e4f8e192ee2"> Power BI数据模型</a>。Power BI中的模型与Access和SQL数据库略有不同。</p><p id="6157" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你想知道如何<a class="ae le" rel="noopener" target="_blank" href="/functions-in-power-bi-56e9e11e4669?sk=32f65f6e5196dbd96ed43a53584ad2fc">应用Power BI </a> — <a class="ae le" rel="noopener" target="_blank" href="/functions-in-power-bi-56e9e11e4669?sk=32f65f6e5196dbd96ed43a53584ad2fc">中的函数，这里有一篇好文章。</a></p><p id="a17c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在回到这个话题，为什么这些列表函数会有帮助呢？当您想要在数据集中的各个列中放置一个列表来检查条件时，这很有帮助。</p><p id="2d60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当然，您可能可以在Power Query上使用条件列功能区，但是列出您希望检查的所有特定项目会非常繁琐。</p><p id="33b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您还可以对支持表进行各种连接，但之后的清理工作也会很繁琐。你可以写if语句，但是如果你的列表很大呢？</p><p id="ddb9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们一起来看看这些函数。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="998a" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">列表。包含任何</h1><p id="4e8e" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated"><a class="ae le" href="https://docs.microsoft.com/en-us/powerquery-m/list-containsany" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">列表。ContainsAny </strong> </a> —下面是函数的分解。</p><p id="1b13" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">找出列表{1，2，3，4，5}包含3还是4。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/ef16dd50c41c5ef72b545d0aa05ae2fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*ySIPrtjoMxmDaB4_l4DGQg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="6563" class="mx lp it mt b gy my mz l na nb">List.ContainsAny({1, 2, 3, 4, 5}, {3, 4})</span></pre><p id="5320" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回TRUE —因为{1，2，3，4，5}的列表中有任何3或4</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="d00d" class="mx lp it mt b gy my mz l na nb">List.ContainsAny({"A", "B", "C", "D", "E"}, {"F", "G"})</span></pre><p id="a89e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回FALSE—“F”或“G”不在{“A”、“B”、“C”、“D”、“E”}列表中</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="6b79" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">列表。包含</h1><p id="1e4c" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated"><a class="ae le" href="https://docs.microsoft.com/en-us/powerquery-m/list-contains" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">列表。包含</strong></a>——这里是功能的细分。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/87f3afd948a6bfbf1eb2b81bac93f77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*4eoIkdadvTc4LYoeP0y8VQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="1630" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查找列表{1，2，3，4，5}是否包含3。这里的函数将是</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="af86" class="mx lp it mt b gy my mz l na nb">List.Contains({1, 2, 3, 4, 5}, 3)</span></pre><p id="6827" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回TRUE</p><p id="b89a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，你可能需要小心你所观察的物品。您要查看的项目没有{}。与最后一个值进行比较的是<strong class="js iu">期望的是一个值而不是一个列表</strong>，所以下面返回false。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="de58" class="mx lp it mt b gy my mz l na nb">List.Contains({1, 2, 3, 4, 5}, {3})</span></pre><p id="130c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回FALSE。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="ff66" class="lo lp it bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">列表。包含所有</h1><p id="4ac2" class="pw-post-body-paragraph jq jr it js b jt mm jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj mq kl km kn im bi translated">现在不是单个值— <a class="ae le" href="https://docs.microsoft.com/en-us/powerquery-m/list-containsall" rel="noopener ugc nofollow" target="_blank">列表。如果ContainsAll </a>能够将列表中的所有项目与您想要比较的列表进行匹配，它将返回True。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="0510" class="mx lp it mt b gy my mz l na nb">List.ContainsAll({1, 2, 3, 4, 5}, {4, 5})</span></pre><p id="5266" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返回TRUE-4和5都在列表中。</p><p id="ce7f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为这个函数需要一个匹配的列表，并且在Power Query中是逐行布局的，所以您需要首先嵌套这个列表，这样才能工作。(下面有更多相关信息)</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="3560" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看一个例子。</p><p id="52b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在power query中有一个表，我将使用add columns特性添加额外的列来使用我们的contain函数。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9824663aa0d9d90868e268350beffb53.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*v05w1-cstjIcjm2ejrjAcQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="73ee" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们添加使用列表的第一列。包含使用“添加列”按钮。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/155c46920738420d173d977360a2240c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k8DtrlKOA38a72wzDvy8kA.png"/></div></div></figure><p id="18f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果会是这一栏。</p><p id="0c0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们创建我们的第一列。我想检查Store_Number 1是否在列中的任何位置。</p><p id="344f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里，该列表示在商店编号列中有一个商店编号1。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nf"><img src="../Images/58878ed01b20342d7872af6d8c8713d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzslVSour1jvhwsMMS6w-w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="ab6e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我还想检查是否有商店编号1，并且任何评论都包含“太棒了”这个词。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/279b36c45aff506a689f3a313d50c9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HvSLFJYlWzn7erUlKLnr5w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="e020" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后一列，我想检查我的所有评审标准— {“很好”、“很好”、“嗯”} —是否都出现在该列中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nh"><img src="../Images/56417f752e6116b9968439cbed0c7376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qgcA895zRtIpGUI7ikYAbw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="c0ca" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这张特别的单子。ContainsAll与其他的有些不同。</p><p id="3f97" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您像其他人一样使用定制列，那么由于Power Query中的行上下文，它将不起作用。</p><p id="d79c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">直觉上，如果你试着做—</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="cbea" class="mx lp it mt b gy my mz l na nb">List.ContainsAll({[Reviews]},{“Great”,”Good”,”Meh”})</span></pre><p id="2ec2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上将返回FALSE，即使您在此列出的项目都在列中。</p><p id="2e6c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的问题是行——如果您只是引用列，Power Query会获取列的“单元格”,并对照列表{“Great”、“Good”、“Meh”}进行检查，然后返回FALSE。这个特定的“单元格”不包含列表中的所有项目，所以它返回FALSE。</p><p id="1042" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我们使用<strong class="js iu">列表时。包含任何</strong>，<strong class="js iu">列表。包含</strong>，它们返回正确的值，因为即使它对每个值进行检查，它仍然会得到我们想要的。这里的区别在于，我们希望在与列表进行比较之前，将整个列嵌套在一个“单元格”中。</p><p id="f4bc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这就是我们需要写作的原因。</p><pre class="kp kq kr ks gt ms mt mu mv aw mw bi"><span id="b6c6" class="mx lp it mt b gy my mz l na nb">List.ContainsAll( #PreviousStep[Reviews],{“Great”, ”Good”, “Meh”} )</span></pre><p id="b08d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里，它将整个列作为一个列表引用——以对照另一个列表进行检查。</p><p id="7282" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">结果将返回TRUE</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="67c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另外，这两个函数也非常有用。AnyTrue 和<strong class="js iu">列表。AllTrue </strong>。</p><p id="0b91" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它们和其他的非常相似，你可以添加其他条件，而不仅仅是检查成员资格。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ni"><img src="../Images/cc95aa64b1106c81835b945544875205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sG-wpgJuzHyaNwyYodfsvw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="e146" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些函数的伟大之处在于，您可以用and、or运算符将它们串在一起，并在数据上创建检查，而不必恢复到连接和多个嵌套语句。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="6f88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> TL:DR </strong>？这是所有这些问题的总结—</p><p id="529d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">列表。包含</strong> —记住要排除搜索项目的{}。</p><p id="12d6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">列表。ContainsAll </strong> —记住对搜索列表使用上一步的[列名]。</p><p id="eba5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">列表。包含任何</strong> —最容易使用。我总是不得不用这个特别的。</p><p id="4bf8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">列表。任何事实，列表。AllTrue </strong> —您可以向它们添加条件。整个条件语句需要用{}包装</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nj"><img src="../Images/b833e7c9269396a9caf84f7e2916b889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4JGmt19vxP9w_CI0RbS1w.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">作者图片</p></figure><p id="50a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在Power Query中尝试这些功能会很有趣！注意安全！</p></div></div>    
</body>
</html>