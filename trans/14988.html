<html>
<head>
<title>Private, “Protected” Attributes in Python — Demystified Once and For All</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的私有“受保护”属性——一劳永逸地去神秘化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/private-protected-attributes-in-python-demystified-once-and-for-all-9456d4e56414?source=collection_archive---------16-----------------------#2020-10-15">https://towardsdatascience.com/private-protected-attributes-in-python-demystified-once-and-for-all-9456d4e56414?source=collection_archive---------16-----------------------#2020-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/29e38ebb9ed3867db261ccc102fba581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WhR0GNM_wrfEawQ4HfU2ZQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片由<a class="ae jd" href="https://unsplash.com/@clemhlrdt" rel="noopener ugc nofollow" target="_blank"><strong class="bd je">clément H</strong></a><strong class="bd je"/><strong class="bd je"/><a class="ae jd" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"><strong class="bd je">un splash</strong></a></p></figure><div class=""/><div class=""><h2 id="5e36" class="pw-subtitle-paragraph ke jg jh bd b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv dk translated">所有关于私有和“受保护”属性的知识都在748个单词中</h2></div><blockquote class="kw"><p id="8732" class="kx ky jh bd kz la lb lc ld le lf lg dk translated">永远不要使用两个前导下划线。这是令人讨厌的隐私。—伊恩·比金，pip、virtualenv和许多其他软件的创作者</p></blockquote><p id="21ce" class="pw-post-body-paragraph lh li jh lj b lk ll ki lm ln lo kl lp lq lr ls lt lu lv lw lx ly lz ma mb lg ij bi mc translated"><span class="l md me mf bm mg mh mi mj mk di"> H </span>这些词你在Python的世界里遇到过多少次:<em class="ml">公有</em>、<em class="ml">私有</em>、<em class="ml">受保护</em>？有多少次，那些一个前导下划线<code class="fe mm mn mo mp b">_</code>，两个前导下划线<code class="fe mm mn mo mp b">__</code>让你困惑，试图理解它们？</p><p id="e18e" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">好吧，让我们一劳永逸地揭开它们的神秘面纱。私有和“受保护”的属性有什么用。以及它们在Python世界中的样子。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="1366" class="nc nd jh bd ne nf ng nh ni nj nk nl nm kn nn ko no kq np kr nq kt nr ku ns nt bi translated">私有属性到底有什么意义？</h1><p id="072c" class="pw-post-body-paragraph lh li jh lj b lk nu ki lm ln nv kl lp lq nw ls lt lu nx lw lx ly ny ma mb lg ij bi translated">考虑这个场景:你有一个名为<code class="fe mm mn mo mp b">Vehicle</code>的类，它在内部使用一个名为<em class="ml"> horn </em>的实例属性，并且不想公开它<em class="ml">。现在，你想要子类化<code class="fe mm mn mo mp b">Vehicle</code>并将你自己的类命名为<code class="fe mm mn mo mp b">MyCar.</code></em></p><p id="a29b" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">如果您在类<code class="fe mm mn mo mp b">MyCar</code>中创建自己的<code class="fe mm mn mo mp b">horn</code>实例属性，您将覆盖<code class="fe mm mn mo mp b">Vehicle</code>的<code class="fe mm mn mo mp b">horn</code> <em class="ml"> </em>实例属性。结果是，你将粉碎<code class="fe mm mn mo mp b">Vehicle</code><em class="ml"/><em class="ml"/>类中所有使用<code class="fe mm mn mo mp b">horn</code> <em class="ml"> </em>属性的方法。更糟糕的是，调试随之而来的问题将是一件令人头疼的事情。</p><p id="2c16" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">为了防止这种情况发生，<code class="fe mm mn mo mp b">Vehicle</code>类的开发人员会将<code class="fe mm mn mo mp b">horn</code>属性<em class="ml">设为私有属性</em>，以防止这种意外事故。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="b722" class="nc nd jh bd ne nf ng nh ni nj nk nl nm kn nn ko no kq np kr nq kt nr ku ns nt bi translated">Python中的私有属性</h1><p id="3c3b" class="pw-post-body-paragraph lh li jh lj b lk nu ki lm ln nv kl lp lq nw ls lt lu nx lw lx ly ny ma mb lg ij bi translated">在Python的世界里，不像Java，没有办法创建一个私有的修饰符。python给你的是一个简单的机制，防止<strong class="lj ji">意外</strong>覆盖你的类中的属性，如果有人想从你的类继承。</p><p id="480a" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">在前面的例子中，如果您想将<code class="fe mm mn mo mp b">horn</code>属性设为private，您需要在它前面加上两个下划线:<code class="fe mm mn mo mp b">__horn</code> <em class="ml">。</em>这样，Python将把这个属性名存储在实例<code class="fe mm mn mo mp b">__dict__</code>中，以下划线和类名为前缀。这样，在<code class="fe mm mn mo mp b">Vehicle</code>类中，你的<code class="fe mm mn mo mp b">__horn</code> <em class="ml">属性</em>就变成了<code class="fe mm mn mo mp b">_vehicle__horn</code> <em class="ml"> </em>而<em class="ml">在</em> <code class="fe mm mn mo mp b"><em class="ml">MyCar</em></code> <em class="ml"> </em>类中就变成了<code class="fe mm mn mo mp b">_MyCar__horn</code>。python的这个特性被冠以一个微妙的名字<strong class="lj ji"> <em class="ml">名为mangling </em>。下面是我们目前讨论的代码:</strong></p><figure class="nz oa ob oc gt is"><div class="bz fp l di"><div class="od oe l"/></div></figure><figure class="nz oa ob oc gt is"><div class="bz fp l di"><div class="od oe l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">示例01 —私有属性，其中名称<strong class="ak">被篡改</strong></p></figure><p id="2035" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">这里需要注意的是，<strong class="lj ji">名称篡改完全是关于</strong> <strong class="lj ji">安全而不是安全。它不会保护你免受故意的错误行为；只是，偶然的超越。在上面的例子中，您可以简单地通过这样做来改变私有属性的值:<code class="fe mm mn mo mp b">v1._vehicle__horn = 'new value'</code>。</strong></p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><h1 id="43da" class="nc nd jh bd ne nf ng nh ni nj nk nl nm kn nn ko no kq np kr nq kt nr ku ns nt bi translated">Python中的“受保护”属性</h1><p id="2e4b" class="pw-post-body-paragraph lh li jh lj b lk nu ki lm ln nv kl lp lq nw ls lt lu nx lw lx ly ny ma mb lg ij bi translated">无论是名字的乱涂乱画，还是把名字写成<code class="fe mm mn mo mp b">self.__horn</code> <em class="ml"> </em>的歪歪扭扭的样子，都不为皮达尼斯所喜爱。在公共存储库中，您会注意到开发人员通常更喜欢遵循这样的惯例:只给<strong class="lj ji"/>添加一个前导下划线(<code class="fe mm mn mo mp b">self._horn</code>)，以防止它们被无意中修改。</p><p id="e3c9" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">批评者建议，为了防止属性混乱，只需简单地遵循在属性前加一个下划线的惯例就足够了。这是我在文章开头引用的伊恩·比金的话全文；</p><blockquote class="kw"><p id="75ed" class="kx ky jh bd kz la of og oh oi oj lg dk translated">永远不要使用两个前导下划线。这是令人讨厌的隐私。如果担心名称冲突，请使用显式名称混淆(例如_MyThing_balabla)。这和双下划线本质上是一样的，只是在双下划线模糊的地方是透明的。</p></blockquote><p id="306d" class="pw-post-body-paragraph lh li jh lj b lk ll ki lm ln lo kl lp lq lr ls lt lu lv lw lx ly lz ma mb lg ij bi translated">我必须注意，带有单个前导下划线<code class="fe mm mn mo mp b">_</code>的属性对于python解释器来说没有任何特殊意义。但是，这是皮托尼斯塔世界里的一个很强的惯例。如果您看到一个，这意味着您不应该从类外部访问这样的属性。您甚至可以观察到，甚至在官方Python文档的某些角落中，带有单个前导下划线<code class="fe mm mn mo mp b">_</code>的属性也被称为“受保护的”</p><p id="aca0" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">尽管使用单个前导下划线来“保护”属性的做法很常见，但很少听到它们被称为“受保护的”属性。有些人甚至称之为“私人”</p><h1 id="a993" class="nc nd jh bd ne nf ok nh ni nj ol nl nm kn om ko no kq on kr nq kt oo ku ns nt bi translated">总而言之</h1><p id="02b8" class="pw-post-body-paragraph lh li jh lj b lk nu ki lm ln nv kl lp lq nw ls lt lu nx lw lx ly ny ma mb lg ij bi mc translated">将属性设为私有的主要目的是防止子类意外覆盖该属性。在python中，使变量私有的官方方法是添加两个下划线，例如<code class="fe mm mn mo mp b">self.__privateattr.</code>，但是，在python社区中，当使变量私有时，强烈倾向于只添加一个前导下划线。您可能经常听到或看到这样的属性被称为“受保护的”</p><p id="dfaf" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi translated">因此，只需知道在python中将变量设为私有是为了安全，只需添加一个前导下划线就足以保护它们不被无意中覆盖:例如<code class="fe mm mn mo mp b">self._protected</code>。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="8ed5" class="pw-post-body-paragraph lh li jh lj b lk mq ki lm ln mr kl lp lq ms ls lt lu mt lw lx ly mu ma mb lg ij bi mc translated">如果你喜欢我的文章并想阅读更多，考虑注册成为一名媒体会员。每月5美元，你可以无限制地阅读媒体上的故事。通过使用下面的链接，你也将支持我作为一个作家。</p><div class="ip iq gp gr ir op"><a href="https://7sapien.medium.com/membership" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ji gy z fp ou fr fs ov fu fw jg bi translated">通过我的推荐链接加入Medium-Amir AFI anian</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">7sapien.medium.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ix op"/></div></div></a></div></div></div>    
</body>
</html>