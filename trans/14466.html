<html>
<head>
<title>How to get more insights using SQL IN operator?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在operator中使用SQL获得更多洞察？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-get-more-insights-using-sql-in-operator-9bbe73f9b4ba?source=collection_archive---------45-----------------------#2020-10-05">https://towardsdatascience.com/how-to-get-more-insights-using-sql-in-operator-9bbe73f9b4ba?source=collection_archive---------45-----------------------#2020-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7e55" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用IN运算符跨表合并数据</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/dcce0236aeb9ccbc2b637e9e12e3b583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P-Q2EpghS_s27EoK"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kw" href="https://unsplash.com/@a_wandering_yogi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里丝蒂娜·瓦格纳</a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="3927" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们都知道SQL IN是一个有用的操作符，它允许您在WHERE子句中选择多个条件。然而，IN操作符甚至比您想象的更有用。在中，您可以跨表合并数据。</p><h1 id="2b0c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">一个使用Google BigQuery公共数据集的例子</h1><p id="d393" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">为了举例说明，我将快速浏览一遍教程。我使用Google BigQuery的公共数据集，名为<strong class="kz ir"> austin_bikeshare </strong>。因此，你可以很容易地按照我的代码来练习。</p><p id="b3e0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这个数据集中有两个表。<strong class="kz ir"> bikeshare_stations </strong>表格包含有关站点名称、状态和位置的信息。<strong class="kz ir"> bikeshare_trips </strong>表包括关于行程的开始时间、结束时间、开始站、结束站、持续时间和订户类型的信息。</p><p id="4f08" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">作为一名数据分析师，我可能想通过出行次数了解每个起点站的性能。然而，我只对仍然活跃的站感兴趣。因此，我可以把我的问题框定如下:</p><blockquote class="mq"><p id="ebdf" class="mr ms iq bd mt mu mv mw mx my mz ls dk translated">每个活动始发站进行了多少次旅行？</p></blockquote><p id="0edf" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">您可以从<strong class="kz ir"> bikeshare_trips </strong>表中轻松找到始发站和相关的行程。但是，每个站点的状态位于<strong class="kz ir"> bikeshare_stations </strong>表中。解决方案可能是使用JOIN:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="66ec" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">还有一个使用IN的解决方案，在这个方案中，您不必使用JOIN。首先，通过从<strong class="kz ir"> bikeshare_trips </strong>表中计算行程id，选择所有起点站的名称和行程数。然后，在WHERE子句中，编写一个子查询，从<strong class="kz ir"> bikeshare_stations </strong>表中选择所有活动的站点，并使用in运算符。结果，所选择的站被限制在活动站的子集内，而不是所有站。代码如下:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><h1 id="0082" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">另一个Leetcode问题的例子</h1><p id="cfd3" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我用607号问题(销售人员)来进一步说明。问题是选择表<strong class="kz ir">销售人员</strong>中的所有姓名，他们没有销售给“RED”公司。</p><p id="77db" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">表:<code class="fe nh ni nj nk b">salesperson</code></p><pre class="kh ki kj kk gt nl nk nm nn aw no bi"><span id="b849" class="np lu iq nk b gy nq nr l ns nt">+----------+------+--------+-----------------+-----------+<br/>| sales_id | name | salary | commission_rate | hire_date |<br/>+----------+------+--------+-----------------+-----------+<br/>|   1      | John | 100000 |     6           | 4/1/2006  |<br/>|   2      | Amy  | 120000 |     5           | 5/1/2010  |<br/>|   3      | Mark | 65000  |     12          | 12/25/2008|<br/>|   4      | Pam  | 25000  |     25          | 1/1/2005  |<br/>|   5      | Alex | 50000  |     10          | 2/3/2007  |<br/>+----------+------+--------+-----------------+-----------+</span></pre><p id="ee2a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">表:<code class="fe nh ni nj nk b">company</code></p><pre class="kh ki kj kk gt nl nk nm nn aw no bi"><span id="5f89" class="np lu iq nk b gy nq nr l ns nt">+---------+--------+------------+<br/>| com_id  |  name  |    city    |<br/>+---------+--------+------------+<br/>|   1     |  RED   |   Boston   |<br/>|   2     | ORANGE |   New York |<br/>|   3     | YELLOW |   Boston   |<br/>|   4     | GREEN  |   Austin   |<br/>+---------+--------+------------+</span></pre><p id="76e8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">表:<code class="fe nh ni nj nk b">orders</code></p><pre class="kh ki kj kk gt nl nk nm nn aw no bi"><span id="010a" class="np lu iq nk b gy nq nr l ns nt">+----------+------------+---------+----------+--------+<br/>| order_id | order_date | com_id  | sales_id | amount |<br/>+----------+------------+---------+----------+--------+<br/>| 1        |   1/1/2014 |    3    |    4     | 100000 |<br/>| 2        |   2/1/2014 |    4    |    5     | 5000   |<br/>| 3        |   3/1/2014 |    1    |    1     | 50000  |<br/>| 4        |   4/1/2014 |    1    |    4     | 25000  |<br/>+----------+----------+---------+----------+--------+</span></pre><p id="b133" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由于该问题仅询问销售人员的姓名，因此从<strong class="kz ir">销售人员</strong>表中选择<strong class="kz ir">姓名</strong>是有意义的。然而，那些没有销售给“红色”公司的呢？</p><p id="b523" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在这个场景中，IN操作符发挥了作用。我们不用IN，而只用NOT IN。首先，我们通过连接<strong class="kz ir"> orders </strong>表和<strong class="kz ir"> company </strong>表，选择销售id，并使用公司名称为“RED”的条件，来选择与公司“RED”有销售关系的雇员子集。然后，我们只需选择不属于该子集的销售id。以下是需要遵循的代码:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="29c3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通过这两个例子，我希望您能更好地理解如何使用IN操作符在不使用JOIN的情况下跨表合并数据。</p></div></div>    
</body>
</html>