<html>
<head>
<title>How to do more with less data ?— Active learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用更少的数据做更多的事？—主动学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-do-more-with-less-data-active-learning-240ffe1f7cb9?source=collection_archive---------39-----------------------#2020-09-25">https://towardsdatascience.com/how-to-do-more-with-less-data-active-learning-240ffe1f7cb9?source=collection_archive---------39-----------------------#2020-09-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/fc0a247ae8ec52bbbf4bad51994daa39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gRCw9OD-7RnMUq69"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kf" href="https://unsplash.com/@prateekkatyal?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Prateek Katyal </a>拍摄</p></figure><p id="d156" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果机器学习项目是冰山，那么水下的部分就是项目中的标签和其他数据工作。好消息是像迁移学习和主动学习这样的技术可以帮助减少这种努力。</p><p id="78cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主动学习已经成为ML行业从业者工具箱的一部分有一段时间了，但很少在任何数据科学/ ML课程中涉及。阅读罗伯特·芒罗的书<a class="ae kf" href="https://www.manning.com/books/human-in-the-loop-machine-learning" rel="noopener ugc nofollow" target="_blank">人类在回路中的机器学习</a>，帮助我将一些(并帮助我学习了许多)主动学习概念正式化，这些概念我一直在我的ML项目中直观地使用。</p><p id="b052" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文的目的是向您介绍一种简单的主动学习方法，称为“熵的不确定性采样”，并通过一个例子展示它的实用性。为了进行演示，我使用了主动学习，仅利用实际训练数据集的<strong class="ki iu">23%</strong>(<a class="ae kf" href="https://www.kaggle.com/hassanamin/atis-airlinetravelinformationsystem#" rel="noopener ugc nofollow" target="_blank">ATIS意图分类数据集</a>)来获得与在100%的数据集上进行训练相同的结果。</p><p id="220d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太好奇了？直接跳到<a class="ae kf" href="https://colab.research.google.com/drive/1BsTuFK8HcXS5WWlOCS1QHgvHRf2FK6aD?usp=sharing" rel="noopener ugc nofollow" target="_blank">演示</a>。想先了解一下它的工作原理？请继续阅读。</p><h1 id="7ba3" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">什么是主动学习？</strong></h1><figure class="md me mf mg gt ju"><div class="bz fp l di"><div class="mh mi l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">主动学习——模型从失败的预测中学到的比正确的预测多。图片提供— <a class="ae kf" href="https://giphy.com/gifs/julie-uswnt-carli-lloyd-us-soccer-l3nWlEkpv5cIqe0QU/links" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="ad95" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主动学习是指优先根据标签上的例子训练我们的模型，这些例子可以给我们带来最大的收益，而不是根据“学习信号”很少的例子。一个示例的学习信号的估计是使用来自模型的反馈来完成的。</p><p id="6c4f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这类似于老师问学生她不清楚的概念，并优先考虑那些概念，而不是教授所有的课程。</p><p id="521a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于主动学习是一个迭代的过程，你必须经历多轮培训。主动学习的步骤包括:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/876a83a2e408ec16e58600a60bbe5cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2uhvFkBfUBoWa3KtkvMpeQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">主动学习过程</p></figure><h1 id="0507" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak"> 1。识别并标记您的评估数据集。</strong></h1><p id="b5ec" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">不言而喻，选择评估集是任何机器学习过程中最重要的一步。当涉及到主动学习时，这变得更加重要，因为这将是我们在迭代标记过程中模型性能改善程度的衡量标准。此外，它还帮助我们决定何时停止迭代。</p><p id="eb02" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">直接的方法是随机分割未标记的数据集，并从分割的数据集中选取您的评估集。但是基于复杂性或业务需求，拥有多个评估集也是好的。例如，如果您的业务需要表明情绪分析模型应该能够很好地处理讽刺，您可以有两个独立的评估集—一个用于一般的情绪分析，另一个用于讽刺特定的样本。</p><h1 id="f433" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">2.<strong class="ak">识别并标记你的初始训练数据集。</strong></h1><p id="9337" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">现在选取X%的未标记数据集作为初始训练数据集。X的值可以根据模型和方法的复杂性而变化。选择一个对于多次迭代来说足够快的值，并且对于模型的初始训练来说足够大的值。如果您采用迁移学习方法，并且数据集的分布接近基础模型的预训练数据集，那么较低的X值足以启动该过程。</p><p id="a214" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">避免初始训练数据集中的类别不平衡也是一个很好的实践。如果是NLP问题，您可以考虑基于关键字的搜索来识别来自特定类别的样本，以标记和维护类别平衡。</p><h1 id="afc1" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">3.<strong class="ak">训练迭代</strong></h1><p id="1044" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">现在我们已经有了初始的训练和评估数据集，我们可以继续进行第一次训练迭代。通常，人们不能通过评估第一个模型来推断太多。但是这一步的结果可以帮助我们看到预测在迭代过程中是如何改进的。使用该模型来预测剩余未标记样本的标签。</p><h1 id="250d" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">4.<strong class="ak">选择上一步中要标记的样本子集。</strong></h1><p id="e495" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">这是一个至关重要的步骤，在这一步中，您可以选择具有最多学习信号的样本进行标记过程。有几种方法可以着手做这件事(如书中所解释的)。为了简洁起见，我们将看到我认为最直观的方法——基于熵的不确定性采样。</p><p id="8612" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">基于熵的不确定性采样:</strong></p><p id="a23e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不确定性采样是一种挑选模型最不确定/混淆的样本的策略。有几种方法可以计算不确定度。最常见的方法是使用神经网络最后一层的分类概率(softmax)值。</p><p id="8e39" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果没有明确的赢家(即所有的概率几乎相同)，这意味着模型对样本是不确定的。熵正好给了我们一个度量。如果所有类别之间有联系，则分布的熵将会很高，如果类别中有明显的赢家，则分布的熵将会很低。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mp"><img src="../Images/5cb7629a4f02df784b77a43dd593da99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqlB9Y6taLMVTSskVwzSXw.png"/></div></div></figure><p id="7d98" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据模型对未标记数据集的预测，我们应该按照熵的降序对样本进行排序，并挑选大约Y%的顶级样本进行注释。</p><h1 id="41f8" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak"> 5。冲洗&amp;重复:</strong></h1><p id="0576" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">我们需要将本次迭代中的训练数据集附加上我们标记的新样本，并重复步骤3中的过程，直到我们在评估集上达到所需的性能或我们的评估性能稳定水平。</p><h1 id="db6e" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated"><strong class="ak">演示</strong></h1><p id="0d9d" class="pw-post-body-paragraph kg kh it ki b kj mk kl km kn ml kp kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">为了实验和演示，我们将使用<a class="ae kf" href="https://www.kaggle.com/hassanamin/atis-airlinetravelinformationsystem" rel="noopener ugc nofollow" target="_blank"> ATIS意图分类数据集</a>。让我们认为训练数据集是未标记的。我们从随机抽取5%的带标签的训练数据集进行第一次迭代开始。在每次迭代结束时，我们使用基于熵的不确定性采样来挑选前10%的样本，并在下一次迭代中使用它们的标签(模拟真实世界中的标注过程)进行训练。</p><p id="a5ef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了在主动学习的每次迭代中评估我们的模型，我们还从数据集中提取测试集，因为测试集中的数据已经被标记。</p><p id="3420" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">演示和代码可在下面的笔记本中找到:</p><div class="mq mr gp gr ms mt"><a href="https://colab.research.google.com/drive/1BsTuFK8HcXS5WWlOCS1QHgvHRf2FK6aD?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd iu gy z fp my fr fs mz fu fw is bi translated">谷歌联合实验室</h2><div class="na l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">colab.research.google.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng jz mt"/></div></div></a></div><p id="dc80" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">参考文献:</strong></p><ol class=""><li id="998f" class="nh ni it ki b kj kk kn ko kr nj kv nk kz nl ld nm nn no np bi translated">戴维·刘易斯和威廉·盖尔。1994.一种训练文本分类器的顺序算法。94年，<a class="ae kf" href="https://arxiv.org/pdf/cmp-lg/9407020.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/cmp-lg/9407020.pdf</a></li><li id="b3e8" class="nh ni it ki b kj nq kn nr kr ns kv nt kz nu ld nm nn no np bi translated"><a class="ae kf" href="https://www.manning.com/books/human-in-the-loop-machine-learning" rel="noopener ugc nofollow" target="_blank">人类在回路中的机器学习</a>由<a class="ae kf" href="http://www.robertmunro.com/" rel="noopener ugc nofollow" target="_blank">罗伯特·芒罗</a></li></ol><p id="34fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢Sriram Pasupathi付出了比我写这篇文章更多的努力来校对这篇文章🙏</p><p id="2af3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">附:我非常高兴听到您对这篇文章的反馈，这也将推动我撰写“如何用更少的数据做更多的事”系列的其他文章，请评论您的反馈或在</strong><a class="ae kf" href="https://twitter.com/logesh_umapathi" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">@ logesh _ umapathi</strong></a><strong class="ki iu">给我发DM。</strong>👋</p></div></div>    
</body>
</html>