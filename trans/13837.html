<html>
<head>
<title>Writing advanced SQL queries in pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨pandasç¼–å†™é«˜çº§SQLæŸ¥è¯¢</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/writing-advanced-sql-queries-in-pandas-1dc494a17afe?source=collection_archive---------10-----------------------#2020-09-23">https://towardsdatascience.com/writing-advanced-sql-queries-in-pandas-1dc494a17afe?source=collection_archive---------10-----------------------#2020-09-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="12b5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">åˆ©ç”¨æ‚¨çš„SQLæ•°æ®æ“ä½œæŠ€èƒ½æ¥å­¦ä¹ ç†ŠçŒ«</h2></div><p id="bdbb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">èƒ½å¤Ÿç†Ÿç»ƒåœ°ä½¿ç”¨SQLå’Œpandas(Pythonä¸­çš„ä¸€ä¸ªæ•°æ®åˆ†æåº“)æ“ä½œæ•°æ®ï¼Œå¯¹äºæ•°æ®åˆ†æå¸ˆã€æ•°æ®ç§‘å­¦å®¶å’Œä»»ä½•å¤„ç†æ•°æ®çš„äººæ¥è¯´éƒ½æ˜¯ä¸€é¡¹å¾ˆæœ‰ä»·å€¼çš„æŠ€èƒ½ã€‚åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹ç²¾é€‰çš„ä¸€äº›é«˜çº§SQLæŸ¥è¯¢åŠå…¶åœ¨pandasä¸­çš„å¯¹åº”é¡¹ã€‚</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/a295c66c6cf40c5e60666fa2f5630e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v7b8eDDEzeMGDwDi"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae lu" href="https://unsplash.com/@fabioha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ³•æ¯”å¥¥</a>åœ¨<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="e1f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ è¿˜æ˜¯ç†ŠçŒ«æ–°æ‰‹ï¼Œä½ å¯èƒ½æƒ³çœ‹çœ‹<a class="ae lu" href="https://pandas.pydata.org/docs/user_guide/10min.html" rel="noopener ugc nofollow" target="_blank"> 10åˆ†é’Ÿè§ç†ŠçŒ«</a>æˆ–<a class="ae lu" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76">æˆ‘ä¹‹å‰çš„å¸–å­</a>ï¼Œåœ¨é‚£é‡Œæˆ‘è®¨è®ºäº†åŸºæœ¬æŸ¥è¯¢å’Œå®ƒä»¬åœ¨ç†ŠçŒ«ä¸­çš„å¯¹ç­‰ç‰©çš„å¹¶æ’æ¯”è¾ƒã€‚è¿™ç¯‡æ–‡ç« å‡è®¾è¯»è€…ç†Ÿæ‚‰SQLæŸ¥è¯¢ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e18d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">0.èµ„æ–™ç»„ğŸ“¦</h1><p id="0a0f" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå°æ•°æ®é›†æ¥ä½¿ç”¨ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå‡æƒ³çš„äººåœ¨è¿‡å»ä¸¤å¹´çš„æ—…è¡Œæ•°æ®:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="e47c" class="ne md it na b gy nf ng l nh ni">df = pd.DataFrame({'name': ['Ann', 'Ann', 'Ann', 'Bob', 'Bob'], <br/>                   'destination': ['Japan', 'Korea', 'Switzerland', <br/>                                   'USA', 'Switzerland'], <br/>                   'dep_date': ['2019-02-02', '2019-01-01', <br/>                                '2020-01-11', '2019-05-05', <br/>                                '2020-01-11'], <br/>                   'duration': [7, 21, 14, 10, 14]})<br/>df</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/254dd108666f72f6b8d6fa66e268c4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*szeZ5Q1HGs1zwzL_IB4Gpg.png"/></div></figure><p id="d03f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬å°†<em class="nk"> dep_date </em>å®šä¹‰ä¸ºå‰å¾€ç›®çš„åœ°çš„å‡ºå‘æ—¥æœŸï¼Œå¹¶å‡è®¾<em class="nk"> duration </em>ä»¥å¤©æ•°è¡¨ç¤ºè¡Œç¨‹é•¿åº¦ã€‚</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="7495" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.æ¯”è¾ƒğŸ”</h1><h2 id="8496" class="ne md it bd me nl nm dn mi nn no dp mm kr np nq mo kv nr ns mq kz nt nu ms nv bi translated">ğŸ“ 1.1.æ¢æ¡£:è¶…å‰()å’Œæ»å()</h2><p id="9d5a" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">æˆ‘ä»¬å…ˆä»åŸºæœ¬ç‰ˆçš„<code class="fe nw nx ny na b">LEAD() </code>å’Œ<code class="fe nw nx ny na b">LAG()</code>è¯´èµ·ã€‚å¯¹äºæ¯ä¸€æ¬¡è¡Œç¨‹ï¼Œæˆ‘ä»¬æ¥æ‹‰ä¸‹ä¸€æ¬¡è¡Œç¨‹çš„å‡ºå‘æ—¥æœŸ:<em class="nk"> lead1 </em>ï¼Œç¬¬äºŒæ¬¡ä¸‹ä¸€æ¬¡è¡Œç¨‹:<em class="nk"> lead2 </em>ï¼Œä¸Šä¸€æ¬¡è¡Œç¨‹:<em class="nk"> lag1 </em>ï¼Œç¬¬ä¸‰æ¬¡ä¸Šä¸€æ¬¡è¡Œç¨‹:<em class="nk"> lag3 </em> <strong class="kk iu">ã€‚</strong></p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="c248" class="ne md it na b gy nf ng l nh ni">SELECT name<br/>       , destination<br/>       , dep_date<br/>       , duration<br/>       , LEAD(dep_date) OVER(ORDER BY dep_date, name) AS lead1<br/>       , LEAD(dep_date, 2) OVER(ORDER BY dep_date, name) AS lead2<br/>       , LAG(dep_date) OVER(ORDER BY dep_date, name) AS lag1<br/>       , LAG(dep_date, 3) OVER(ORDER BY dep_date, name) AS lag3<br/>FROM df</span></pre><p id="0a0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸ºäº†åœ¨ç†ŠçŒ«èº«ä¸Šå¾—åˆ°åŒæ ·çš„äº§é‡ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe nw nx ny na b">shift()</code>:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="44a7" class="ne md it na b gy nf ng l nh ni">df.sort_values(['dep_date', 'name'], inplace=True)<br/>df.assign(lead1 = df['dep_date'].shift(-1),<br/>          lead2 = df['dep_date'].shift(-2),<br/>          lag1 = df['dep_date'].shift(),<br/>          lag3 = df['dep_date'].shift(3))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nz"><img src="../Images/88df2c2a7881d6356321129f2e232cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OwyCoa1W2dc4REQyPaEWw.png"/></div></div></figure><p id="88aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨ç¬¬ä¸€è¡Œä¸­ï¼Œæˆ‘ä»¬ç”¨<code class="fe nw nx ny na b">sort_values()</code>å¯¹æ•°æ®è¿›è¡Œäº†æ’åºï¼Œå› ä¸ºæˆ‘ä»¬å¯¹æ‰€æœ‰çš„ç§»ä½æ“ä½œä½¿ç”¨äº†ç›¸åŒçš„é€»è¾‘ã€‚è¿™æ ·åšæ¯”æˆ‘ä»¬æ¯æ¬¡åˆ›å»ºæ–°åˆ—æ—¶éƒ½è¦å¯¹æ•°æ®è¿›è¡Œæ’åºæ›´æœ‰æ•ˆï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="2d6d" class="ne md it na b gy nf ng l nh ni">df.assign(lead1 = df.sort_values(['dep_date', 'name'])['dep_date']<br/>                    .shift(-1),<br/>          lead2 = df.sort_values(['dep_date', 'name'])['dep_date']<br/>                    .shift(-2),<br/>          lag1 = df.sort_values(['dep_date', 'name'])['dep_date']<br/>                   .shift(),<br/>          lag3 = df.sort_values(['dep_date', 'name'])['dep_date']<br/>                   .shift(3))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oa"><img src="../Images/79d18714bb4d57195c2c56699e7c662f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGbSRHrAbnS6qokTvWkB-g.png"/></div></div></figure><p id="1f9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™ç§ä½æ•ˆæ–¹æ³•çš„è¾“å‡ºå°†åŒ…å«æ­£ç¡®çš„å€¼ï¼Œä½†æ˜¯è¡Œçš„é¡ºåºå°†ä¸åŸå§‹æ•°æ®ç›¸åŒï¼Œå¹¶ä¸”ä¸ä¼šè¢«æ’åºã€‚</p><p id="d977" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å‰©ä¸‹çš„4è¡Œä»£ç ã€‚åœ¨ç†ŠçŒ«ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code class="fe nw nx ny na b">assign()</code>åˆ›å»ºå¤šä¸ªæ ç›®ã€‚ä½†æ˜¯ï¼Œæ–°çš„åˆ—è¿˜æ²¡æœ‰æ·»åŠ åˆ°DataFrameä¸­ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ·»åŠ æ–°çš„åˆ—åˆ°<code class="fe nw nx ny na b">df</code>ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·åˆ†é…:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="72eb" class="ne md it na b gy nf ng l nh ni">df.sort_values(['dep_date', 'name'], inplace=True)<br/>df = df.assign(lead1 = df['dep_date'].shift(-1),<br/>               lead2 = df['dep_date'].shift(-2),<br/>               lag1 = df['dep_date'].shift(),<br/>               lag3 = df['dep_date'].shift(3))</span></pre><p id="c945" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å°†åœ¨æœ€åä¸€èŠ‚çœ‹å¦ä¸€ä¸ªå¸¦æœ‰<code class="fe nw nx ny na b">PARTITION BY()</code>çš„<code class="fe nw nx ny na b">LEAD()</code>çš„ä¾‹å­ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æ“ä½œæ—¥æœŸ/æ—¥æœŸæ—¶é—´åˆ—ã€‚</p><h2 id="363d" class="ne md it bd me nl nm dn mi nn no dp mm kr np nq mo kv nr ns mq kz nt nu ms nv bi translated">ğŸ“ 1.2.Date/datetime: DATENAME()ï¼ŒDATEDIFF()ï¼ŒDATEADD()</h2><p id="6140" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»å‡ºå‘æ—¥æœŸå¼€å§‹æå–ä¸€å‘¨çš„æ—¥åç§°:<em class="nk">æ—¥</em>ï¼Œä»å‡ºå‘æ—¥æœŸå¼€å§‹çš„æœˆä»½åç§°:<em class="nk">æœˆ</em>ï¼Œä»ä¸Šä¸€æ¬¡æ—…è¡Œå¼€å§‹ç»è¿‡çš„å¤©æ•°:<em class="nk">å·®</em>å’Œåˆ°è¾¾æ—¥æœŸ:<em class="nk"> arr_date </em>ã€‚</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="0ac3" class="ne md it na b gy nf ng l nh ni">SELECT name<br/>       , destination<br/>       , dep_date<br/>       , duration<br/>       , DATENAME(WEEKDAY, dep_date) AS day<br/>       , DATENAME(MONTH, dep_date) AS month<br/>       , DATEDIFF(DAY,  <br/>                  LAG(dep_date) OVER(ORDER BY dep_date, name), <br/>                  dep_date) AS diff<br/>       , DATEADD(DAY, day, dep_date) AS arr_date<br/>FROM df</span></pre><p id="1a92" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»ç¡®ä¿åˆ—æ•°æ®ç±»å‹æ˜¯æ­£ç¡®çš„:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="bd9a" class="ne md it na b gy nf ng l nh ni"># Convert to proper dtype<br/>df['dep_date'] = pd.to_datetime(df['dep_date'])<br/>df['duration'] = pd.to_timedelta(df['duration'], 'D')</span></pre><p id="7869" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å°†<em class="nk"> dep_date </em>è½¬æ¢ä¸ºdatetimeå°†å…è®¸æˆ‘ä»¬ä½¿ç”¨<code class="fe nw nx ny na b">.dt</code>è®¿é—®å™¨è®¿é—®è®¸å¤šæ—¥æœŸéƒ¨åˆ†ã€‚ä¾‹å¦‚:<code class="fe nw nx ny na b">df[â€˜dep_dateâ€™].dt.year</code>å°†ç»™å‡ºå¹´ä»½(ç›¸å½“äºSQLä¸­çš„<code class="fe nw nx ny na b">DATEPART(YEAR, dep_date)</code>)ã€‚</p><p id="c648" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å°†<em class="nk">æŒç»­æ—¶é—´</em>è½¬æ¢ä¸ºtimedeltaå…è®¸æˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°ä¸€ä¸ªæ—¥æœŸæ—¶é—´åˆ—ï¼Œä»¥è·å¾—å¦ä¸€ä¸ªæ—¥æœŸæ—¶é—´åˆ—ã€‚</p><p id="0788" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å®Œæˆæ•°æ®ç±»å‹è½¬æ¢åï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ¯”è¾ƒ:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="8140" class="ne md it na b gy nf ng l nh ni">df.sort_values(['dep_date', 'name'], inplace=True)<br/>df.assign(day = df['dep_date'].dt.day_name(),<br/>          month = df['dep_date'].dt.month_name(),<br/>          diff = df['dep_date'] - df['dep_date'].shift(),<br/>          arr_date = df['dep_date'] + df['duration'])</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/661f5a31547fa5b0ea679cc399c1198d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*ww2BkjEqYJS1fPxId5aBhQ.png"/></div></figure><p id="3a5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æ‚¨æ‰€è§ï¼Œä¸€æ—¦æ­£ç¡®è®¾ç½®äº†æ•°æ®ç±»å‹ï¼Œæ“ä½œå°±å˜å¾—ç®€å•äº†ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨DataFrameçš„<code class="fe nw nx ny na b">dtypes</code>å±æ€§æ£€æŸ¥åˆ—çš„æ•°æ®ç±»å‹ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="cd95" class="ne md it na b gy nf ng l nh ni">df.sort_values(['dep_date', 'name'], inplace=True)<br/>df.assign(day = df['dep_date'].dt.day_name(),<br/>          month = df['dep_date'].dt.month_name(),<br/>          diff = df['dep_date'] - df['dep_date'].shift(),<br/>          arr_date = df['dep_date'] + df['duration']).dtypes</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/3aa239820498603b19a2a6f8a2dc6715.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*Twxf2HST0KfvYMeXc_gttA.png"/></div></figure><p id="6bcf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨pandasä¸­ï¼Œå½“å‘ç°ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å·®å¼‚æ—¶ï¼Œå®ƒè¿”å›ä¸€ä¸ªtimedeltaåˆ—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ—<em class="nk"> diff </em>å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ—¶é—´å¢é‡ã€‚</p><h2 id="8e39" class="ne md it bd me nl nm dn mi nn no dp mm kr np nq mo kv nr ns mq kz nt nu ms nv bi translated">ğŸ“ 1.3.æ’å:ROW_NUMBER()ï¼ŒRANK()ï¼ŒDENSE_RANK()</h2><p id="21d8" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">æ‚¨å¯èƒ½ä»¥å‰åœ¨SQLä¸­è‡³å°‘ä½¿ç”¨è¿‡è¿™äº›å‡½æ•°ä¸­çš„ä¸€ä¸ªã€‚è¿™ä¸‰è€…ä¹‹é—´çš„å…³é”®åŒºåˆ«æ˜¯ä»–ä»¬åœ¨æ’åå…³ç³»å’Œæ’åä¹‹åçš„å¾…é‡ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸‰ä¸ªåˆ—ï¼Œåˆ†åˆ«ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ ¹æ®<em class="nk">æŒç»­æ—¶é—´</em>å¯¹æ¯ä¸ªè®°å½•è¿›è¡Œæ’åº:<em class="nk"> row_number_dï¼Œrank_d </em>å’Œ<em class="nk"> dense_rank_d. </em></p><p id="0810" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½¿ç”¨<code class="fe nw nx ny na b">ROW_NUMBER()</code>æ—¶ï¼Œé¢†å¸¦çš„ç­‰çº§ä¸å…¶ä»–ä¸¤ç§ä¸åŒã€‚ä¸ºäº†æ§åˆ¶å¦‚ä½•ç”¨<code class="fe nw nx ny na b">ROW_NUMBER()</code>å¤„ç†å¹³å±€ï¼Œæˆ‘ä»¬ä½¿ç”¨<em class="nk">åç§°</em>æ¥æ‰“ç ´å¹³å±€ã€‚</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="ba79" class="ne md it na b gy nf ng l nh ni">SELECT name<br/>       , destination<br/>       , dep_date<br/>       , duration<br/>       , ROW_NUMBER() OVER(ORDER BY duration, name) AS row_number_d<br/>       , RANK() OVER(ORDER BY duration) AS rank_d<br/>       , DENSE_RANK() OVER(ORDER BY duration) AS dense_rank_d<br/>FROM df</span></pre><p id="d031" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">pandasä¸­çš„æŸ¥è¯¢å¯ä»¥é€šè¿‡<code class="fe nw nx ny na b">rank()</code>å®ç°:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="6b5d" class="ne md it na b gy nf ng l nh ni">df.sort_values(['duration', 'name']).assign(<br/>    row_number_d = df['duration'].rank(method='first').astype(int),<br/>    rank_d = df['duration'].rank(method='min').astype(int),<br/>    dense_rank_d = df['duration'].rank(method='dense').astype(int))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ef1faabbcf1aebbf42779e02dfadb1f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*_8D_E_zeWa3yO8tuF4P7Cw.png"/></div></figure><p id="514f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬åœ¨<code class="fe nw nx ny na b">rank()</code>ä¸­æŒ‡å®šäº†ç›¸å…³çš„æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè¿˜æœ‰æˆ‘ä»¬æ²¡æœ‰æ¶‰åŠçš„å…¶ä»–å˜åŒ–ã€‚å¦‚æœä½ æœ‰å…´è¶£äº†è§£ä¸€ä¸‹ï¼Œçœ‹çœ‹<a class="ae lu" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rank.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>ã€‚</p><p id="a090" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬åœ¨è¿™ä¸ªä¾‹å­ä¸­åšäº†ä¸€äº›ç¨å¾®ä¸åŒçš„äº‹æƒ…ã€‚ä¸å‰ä¸¤èŠ‚ä¸­çš„ä¾‹å­ä¸åŒï¼Œæˆ‘ä»¬æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œé€‚å½“çš„æ’åºã€‚ç›¸åï¼Œæˆ‘ä»¬å°†æ–¹æ³•é“¾æ¥èµ·æ¥ï¼Œæ ¹æœ¬æ²¡æœ‰ä¿®æ”¹æ•°æ®ã€‚</p><p id="585a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½ å¯èƒ½ä¹Ÿæ³¨æ„åˆ°äº†æˆ‘ä»¬å·²ç»åŒ…æ‹¬äº†<code class="fe nw nx ny na b">astype(int)</code>ã€‚è¿™æ˜¯ä¸ºäº†å°†æµ®ç‚¹æ•°ä¸­çš„ç§©è½¬æ¢æˆæ•´æ•°ã€‚å¦‚æœæ‚¨å–œæ¬¢çœ‹åˆ°æµ®åŠ¨ï¼Œé‚£ä¹ˆå¯ä»¥åˆ é™¤è¿™éƒ¨åˆ†ä»£ç :</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="0731" class="ne md it na b gy nf ng l nh ni">df.sort_values(['duration', 'name']).assign(<br/>    row_number_d = df['duration'].rank(method='first'),<br/>    rank_d = df['duration'].rank(method='min'),<br/>    dense_rank_d = df['duration'].rank(method='dense'))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/2e97429a39ca88406ef7336025fd7468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*3KRlpyQVZaUVEv3voB1Gyg.png"/></div></figure><h2 id="7ba5" class="ne md it bd me nl nm dn mi nn no dp mm kr np nq mo kv nr ns mq kz nt nu ms nv bi translated">ğŸ“ 1.4.èšåˆçª—å£å‡½æ•°å’Œåˆ†åŒº</h2><p id="9cda" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸ºæœ€é•¿çš„æ—…è¡ŒæŒç»­æ—¶é—´åˆ›å»ºåˆ—:<em class="nk"> max_dur </em>ï¼Œæ‰€æœ‰æ—…è¡Œçš„æ€»æŒç»­æ—¶é—´:<em class="nk"> sum_dur </em>ï¼Œæ¯äººæ—…è¡Œçš„å¹³å‡æŒç»­æ—¶é—´:<em class="nk"> avg_dur_name </em>ä»¥åŠæ¯äººæ—…è¡Œæ—¶é—´çš„ç´¯è®¡æ€»å’Œ:<em class="nk"> cum_sum_dur_nameã€‚</em></p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="ad33" class="ne md it na b gy nf ng l nh ni">SELECT name<br/>       , destination<br/>       , dep_date <br/>       , duration<br/>       , MAX(duration) OVER() AS max_dur<br/>       , SUM(duration) OVER() AS sum_dur<br/>       , AVG(duration) OVER(PARTITION BY name) AS avg_dur_name<br/>       , SUM(duration) OVER(PARTITION BY name ORDER BY dep_date<br/>                            RANGE BETWEEN UNBOUNDED PRECEDING<br/>                            AND CURRENT ROW) AS cum_sum_dur_name<br/>FROM df</span></pre><p id="5d07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç†ŠçŒ«å¯ä»¥è¿™æ ·åš:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="acd9" class="ne md it na b gy nf ng l nh ni">df.assign(max_dur=df['duration'].max(),<br/>          sum_dur=df['duration'].sum(),<br/>          avg_dur_name=df.groupby('name')['duration']<br/>                         .transform('mean'),<br/>          cum_sum_dur_name=df.sort_values('dep_date')<br/>                             .groupby('name')['duration']<br/>                             .transform('cumsum'))</span></pre><p id="3930" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å› ä¸º<a class="ae lu" href="https://jakevdp.github.io/PythonDataScienceHandbook/02.05-computation-on-arrays-broadcasting.html" rel="noopener ugc nofollow" target="_blank">å¹¿æ’­</a>ï¼Œæ‰€ä»¥åœ¨pandasä¸­æ·»åŠ è¯¸å¦‚<em class="nk"> max_dur </em>å’Œ<em class="nk"> sum_dur </em>ä¹‹ç±»çš„èšåˆç»Ÿè®¡æ•°æ®å¾ˆç®€å•ã€‚æœ¬è´¨ä¸Šï¼Œå¦‚æœæˆ‘ä»¬è¯•å›¾ç»™pandasä¸­çš„ä¸€ä¸ªæ–°åˆ—åˆ†é…ä¸€ä¸ªæ ‡é‡å€¼ï¼Œè¯¥å€¼å°†åœ¨æ‰€æœ‰è¡Œä¸­ä¼ æ’­ã€‚<code class="fe nw nx ny na b">PARTITION BY</code>ç”±<code class="fe nw nx ny na b">groupby()</code>å’Œ<code class="fe nw nx ny na b">transform()</code>ç»„åˆå®ç°ã€‚</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/cfb71c0a6a0366b9a5f74ff2c895fa57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUtWlUTic_SNZ5HhSJd3Kg.png"/></div></div></figure><p id="46ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨æ­¤è¾“å‡ºä¸­ï¼Œæ•°æ®çš„é¡ºåºä¸ä¹‹å‰ç›¸åŒ(å³æœªæ’åº)ï¼Œä½†å®ƒå°†æŒ‰ç…§SQLä¸­æ¯ä¸ªäººçš„<em class="nk"> dep_date </em>æ’åºã€‚æˆ‘ä»¬ä»…åœ¨åˆ›å»º<em class="nk"> cum_sum_dur_name </em>æ—¶å¯¹æ•°æ®è¿›è¡Œäº†æ’åºã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›å¯¹è¾“å‡ºè¿›è¡Œæ’åºï¼Œä»£ç å°†å˜ä¸º:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="d050" class="ne md it na b gy nf ng l nh ni">df.sort_values(['name', 'dep_date'], inplace=True)<br/>df.assign(max_dur=df['duration'].max(),<br/>          sum_dur=df['duration'].sum(),<br/>          avg_dur_name=df.groupby('name')['duration']<br/>                         .transform('mean'),<br/>          cum_sum_dur_name=df.groupby('name')['duration']<br/>                             .transform('cumsum'))</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi og"><img src="../Images/5960c041ff15c29f22d9bef367ce96c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXfG2k5tXt_vnUW74HIBWQ.png"/></div></div></figure><p id="81bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™å°†ä¸SQLè¾“å‡ºç›¸åŒã€‚</p><h2 id="e1ff" class="ne md it bd me nl nm dn mi nn no dp mm kr np nq mo kv nr ns mq kz nt nu ms nv bi translated">ğŸ“ 1.5.æŠŠå®ƒæ”¾åœ¨ä¸€èµ·</h2><p id="122b" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">æœ€åï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæŸ¥è¯¢ï¼Œè¦†ç›–æˆ‘ä»¬åˆšåˆšè®¿é—®è¿‡çš„å››ä¸ªä¸åŒåŒºåŸŸã€‚è¿™æ˜¯æˆ‘ä»¬çš„æœ€åä¸€ä¸ªä¾‹å­:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="3502" class="ne md it na b gy nf ng l nh ni">SELECT ROW_NUMBER() OVER(PARTITION BY name <br/>                         ORDER BY dep_date) AS number<br/>       , name<br/>       , destination<br/>       , DATENAME(MONTH, dep_date) AS dep_month<br/>       , dep_date<br/>       , DATEADD(DAY, duration, dep_date) AS arr_date<br/>       , LEAD(dep_date) OVER(PARTITION BY NAME <br/>                             ORDER BY dep_date) AS next_dep_date<br/>       , DATEDIFF(DAY, <br/>                  dep_date, <br/>                  LEAD(dep_date) OVER(PARTITION BY NAME <br/>                                      ORDER BY dep_date)) AS gap<br/>       , duration<br/>       , AVG(1.0 * duration) OVER() AS avg_dur<br/>       , AVG(1.0 * duration) OVER(PARTITION BY name) AS avg_dur_name<br/>       , SUM(duration) OVER(PARTITION BY name ORDER BY dep_date<br/>                            RANGE BETWEEN UNBOUNDED PRECEDING <br/>                            AND CURRENT ROW) AS cum_sum_dur_name   <br/>FROM df<br/>ORDER BY name, dep_date</span></pre><p id="2972" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ç›¸ä¿¡å½“æˆ‘ä»¬ç»ƒä¹ è‡ªå·±çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šå­¦åˆ°æ›´å¤šã€‚æˆ‘é¼“åŠ±æ‚¨åœ¨çœ‹åˆ°æˆ‘ä»¬å°†è¦çœ‹åˆ°çš„æ¯”è¾ƒä¹‹å‰ï¼Œè‡ªå·±å°è¯•å°†è¿™ä¸ªSQLæŸ¥è¯¢ç¿»è¯‘æˆpandasã€‚ğŸ‘€</p><p id="5c74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸‹é¢æ˜¯å¯¹æ¯”:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="415f" class="ne md it na b gy nf ng l nh ni"># Convert to proper type<br/>df['dep_date'] = pd.to_datetime(df['dep_date'])<br/>df['duration'] = pd.to_timedelta(df['duration'], 'D')</span><span id="0784" class="ne md it na b gy oh ng l nh ni"># Sort data<br/>df.sort_values(['name', 'dep_date'], inplace=True)</span><span id="d02b" class="ne md it na b gy oh ng l nh ni"># Append new columns to data<br/>df = df.assign(number=df.groupby('name')['dep_date']<br/>                        .rank('min')<br/>                        .astype(int),<br/>               dep_month = df['dep_date'].dt.month_name(),<br/>               arr_date = df['dep_date'] + df['duration'],<br/>               next_dep_date = df.groupby('name')['dep_date']<br/>                                 .transform(lambda x: x.shift(-1)),<br/>               gap = df.groupby('name')['dep_date']<br/>                       .transform(lambda x: x.shift(-1))-<br/>                                            df['dep_date'],<br/>               avg_dur = df['duration'].mean(),<br/>               avg_dur_name = df.groupby('name')['duration']<br/>                                .transform(lambda x: x.mean()),<br/>               cum_sum_dur_name = df.groupby('name')['duration']<br/>                                   .transform(lambda x: x.cumsum()))</span><span id="df1b" class="ne md it na b gy oh ng l nh ni"># Reorder columns<br/>columns = ['number', 'name', 'destination', 'dep_month', <br/>           'dep_date', 'arr_date', 'next_dep_date', <br/>           'gap', 'duration', 'avg_dur', 'avg_dur_name', <br/>           'cum_sum_dur_name']<br/>df[columns]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9c6a6eed9b5b0077ae9a56c8de12377b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*cLyBld0mYpi7XYNNSHBrCg.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">è¾“å‡ºâ€”ç¬¬1éƒ¨åˆ†</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3c275d1a9c2c54f06b318d5429e88f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Vm-ghYhZGQ1bBRMfQjtT7w.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">è¾“å‡ºâ€”ç¬¬äºŒéƒ¨åˆ†</p></figure><p id="bdd1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å·²ç»è½¬æ¢äº†æ•°æ®ç±»å‹ï¼Œå¯¹æ•°æ®è¿›è¡Œäº†åˆ†ç±»ï¼Œå¹¶ç”¨æ–°åˆ—å¯¹å…¶è¿›è¡Œäº†ä¿®æ”¹ã€‚ä¸ºäº†ä»¥ä¸SQLæŸ¥è¯¢ç›¸åŒçš„æ–¹å¼æŸ¥çœ‹åˆ—æ’åºçš„æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªåˆ—å‡ºåˆ—é¡ºåºçš„åˆ—è¡¨ã€‚å¦‚æœåªè¿è¡Œ<code class="fe nw nx ny na b">df</code>ï¼Œåˆ—çš„æ’åºä¼šæœ‰æ‰€ä¸åŒã€‚</p><p id="d38a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°<em class="nk"> avg_dur </em>æ˜¯ç”¨å¤©æ•°ã€å°æ—¶æ•°å’Œåˆ†é’Ÿæ•°çš„ç»„åˆæ¥è¡¨ç¤ºçš„:â€œ13å¤©04:48:00â€ã€‚è¿™ç›¸å½“äº13 + (4*60+48) / (24*60) = 13.2å¤©ã€‚å¦‚æœæˆ‘ä»¬åªæƒ³çœ‹åˆ°13.2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªä»£ç ç‰‡æ®µæ›¿æ¢<code class="fe nw nx ny na b">df[â€˜durationâ€™].mean()</code>ï¼Œå®ƒåœ¨æ‰¾åˆ°å¹³å‡å€¼ä¹‹å‰å°†<em class="nk">æŒç»­æ—¶é—´</em>è½¬æ¢ä¸ºæ•°å­—ç±»å‹:<code class="fe nw nx ny na b">pd.to_numeric(df[â€˜durationâ€™].dt.days).mean()</code>ã€‚</p><p id="5aec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å½“åˆ›å»º<em class="nk"> avg_dur_name </em>å’Œ<em class="nk"> cum_sum_dur_name </em>æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code class="fe nw nx ny na b">lambda</code>å‡½æ•°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è¿™æ ·çš„è¯­æ³•:</p><pre class="lf lg lh li gt mz na nb nc aw nd bi"><span id="bdd3" class="ne md it na b gy nf ng l nh ni">avg_dur_name = df.groupby('name')['duration'].transform('mean'),<br/>cum_sum_dur_name = df.groupby('name')['duration']<br/>                     .transform('cumsum')</span></pre><p id="eae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™æ˜¯å› ä¸ºå¦‚æœæˆ‘ä»¬è¯•å›¾è¿™æ ·åšï¼Œæˆ‘ä»¬å°†ä¼šé‡åˆ°ä¸€ä¸ªåœ¨è¿™é‡Œæè¿°çš„é—®é¢˜<a class="ae lu" href="https://github.com/pandas-dev/pandas/issues/17382" rel="noopener ugc nofollow" target="_blank"/>ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ç§å˜é€šåŠæ³•ã€‚</p><p id="8962" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Voilaâ•è¿™ç•ªè¯ç»“æŸäº†æˆ‘ä»¬çš„æ¯”è¾ƒã€‚</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ok"><img src="../Images/28e8f5ef1979dacb0b09838eb1fa9bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KhNlqXI1tviS29uE"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">ç”±<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„<a class="ae lu" href="https://unsplash.com/@theshubhamdhage?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Shubham Dhage </a>æ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="3527" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nk">æ‚¨æƒ³è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœä½ ä½¿ç”¨</em> <a class="ae lu" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="nk">æˆ‘çš„æ¨èé“¾æ¥</em></a><em class="nk">æˆä¸ºä¼šå‘˜ï¼Œä½ çš„ä¸€éƒ¨åˆ†ä¼šè´¹ä¼šç›´æ¥å»æ”¯æŒæˆ‘ã€‚</em></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="f8d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è°¢è°¢ä½ çœ‹æˆ‘çš„å¸–å­ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œâœ‚ï¸ï¼Œå¹¶äº†è§£æ›´å¤šå…³äºç†ŠçŒ«çš„çŸ¥è¯†ã€‚å¦‚æœä½ æœ‰å…´è¶£äº†è§£æ›´å¤šå…³äºç†ŠçŒ«çš„ä¿¡æ¯ï¼Œè¿™é‡Œæœ‰æˆ‘çš„ä¸€äº›å¸–å­çš„é“¾æ¥:</p><p id="5658" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">â—¼ï¸ï¸<a class="ae lu" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76">pandasä¸­æ•°æ®èšåˆçš„5ä¸ªæŠ€å·§</a> <br/> â—¼ï¸ï¸ <a class="ae lu" rel="noopener" target="_blank" href="/writing-5-common-sql-queries-in-pandas-90b52f17ad76">åœ¨pandasä¸­ç¼–å†™5ä¸ªå¸¸è§çš„SQLæŸ¥è¯¢</a> <br/> â—¼ï¸ï¸ <a class="ae lu" rel="noopener" target="_blank" href="/5-tips-for-pandas-users-e73681d16d17">ç»™pandasç”¨æˆ·çš„5ä¸ªæŠ€å·§</a> <br/> â—¼ï¸ï¸ <a class="ae lu" rel="noopener" target="_blank" href="/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1">å¦‚ä½•è½¬æ¢pandasæ•°æ®æ¡†æ¶ä¸­çš„å˜é‡</a></p><p id="c31a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å†è§ğŸƒğŸ’¨</p></div></div>    
</body>
</html>