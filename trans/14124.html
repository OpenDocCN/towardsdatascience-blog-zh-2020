<html>
<head>
<title>Deploying Streamlit Apps to GCP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Streamlit应用部署到GCP</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploying-streamlit-apps-to-gcp-79ad5933013e?source=collection_archive---------16-----------------------#2020-09-29">https://towardsdatascience.com/deploying-streamlit-apps-to-gcp-79ad5933013e?source=collection_archive---------16-----------------------#2020-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/56985763ff1bf1e1b33eb99fae513986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IN7cltBTnLR1wD5PdzepEA.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">来自Unsplash的Rene b hmer的照片。</p></figure><h1 id="a025" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">什么是Streamlit？</h1><p id="edf2" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果您熟悉Python中的数据科学软件生态系统，您可能会遇到一些广泛使用的仪表板和数据可视化工具，这些工具是为编程用途而设计的(例如，嵌入笔记本电脑或作为独立的web应用程序)。在过去的几年里，像<a class="ae kc" href="https://plotly.com/dash/" rel="noopener ugc nofollow" target="_blank"> Dash </a>、<a class="ae kc" href="https://docs.bokeh.org/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Bokeh </a>和<a class="ae kc" href="https://voila.readthedocs.io/en/stable/using.html" rel="noopener ugc nofollow" target="_blank"> Voila </a>这样的公司已经成为这个领域中最大的开源公司之一。在R的世界里，还有仪表板工具的长期冠军:<a class="ae kc" href="https://shiny.rstudio.com/" rel="noopener ugc nofollow" target="_blank">闪亮</a>。</p><p id="6800" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">有了这个相对成熟的生态系统，你可能会质疑是否需要一个<em class="me">又一个</em>框架来加入这个群体。但这正是Streamlit的团队正在做的事情:引入一个全新的框架来构建数据应用程序。更重要的是，他们也为他们的项目制造了不少轰动，以至于他们最近结束了一轮2100万美元的首轮融资，以允许他们继续开发他们的框架。</p><div class="mf mg gp gr mh mi"><a href="https://medium.com/streamlit/announcing-streamlits-21m-series-a-ae05daa6c885" rel="noopener follow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">宣布推出价值2100万美元的Streamlit A系列产品</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">为数据科学界开发新的超级能力。</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jw mi"/></div></div></a></div><p id="92fe" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">那么是什么让人们对Streamlit如此兴奋呢？</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/69128ff97196834e4daef60b108ba86c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tb1tfWtjPomvdV-6.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">Streamlit中实时计算机视觉可视化。照片来自<a class="ae kc" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>。</p></figure><p id="7f3c" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">首先，这是你可能遇到的最简单的工具之一。没有样板文件，也没有什么特定于框架的概念需要记住。感觉设计的非常好。总的来说，这种简单性使得在几秒钟内构建一个应用程序变得非常快速和容易。</p><p id="e844" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这种极简主义有助于第二个要点:事件管理轻而易举。这听起来可能很无聊，但在这种情况下这是一件大事。在Streamlit中管理事件不需要特定于框架的设计模式/回调。例如，假设您想通过点击一个按钮来运行一些代码，您可以在Streamlit中用以下代码来捕获:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="ea2f" class="nh ke iq nd b gy ni nj l nk nl">import streamlit as st</span><span id="d3dd" class="nh ke iq nd b gy nm nj l nk nl">if st.button("Click Me"):<br/> print("Clicked")</span></pre><p id="556a" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">每当按下<code class="fe nn no np nd b">Click Me</code>按钮时，其下的程序块将被执行。相同的概念以几乎相同的方式应用于他们所有的交互组件。它在幕后做了一些聪明的把戏来实现这一点，但最终效果是一样的:你可以快速简单地编写具有复杂行为的应用程序，只需对底层代码做很少的更改。与<a class="ae kc" href="https://mark.douthwaite.io/fire-simple-clis-done-fast/" rel="noopener ugc nofollow" target="_blank"> Fire让为现有代码创建CLIs </a>变得异常容易一样，Streamlit让从现有<em class="me">代码创建交互式应用变得异常容易。正如他们所说:它被设计成“洒”在你的代码上。</em></p><p id="1aaf" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">最后，Streamlit与现有的数据可视化工具集成起来也非常容易，并且非常容易部署启动——它与现代部署工具和技术配合得非常好。你可以随心所欲地将你的<code class="fe nn no np nd b">matplotlib</code>图表嵌入到你的<code class="fe nn no np nd b">dash</code>图中，然后将其打包，随时准备部署。总而言之，这些特性共同使Streamlit成为目前最具生产力的现代数据可视化工具之一。</p><h1 id="4626" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">创建您的应用</h1><p id="ee49" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">虽然Streamlit的文档对入门很有帮助，但是没有太多关于部署应用的内容。本文旨在强调将Streamlit应用部署为一个面向公众的实时网站是多么简单。它将使用Streamlit提供的一个“标准”演示应用程序:一个按一天中的时间<a class="ae kc" href="https://github.com/streamlit/demo-uber-nyc-pickups" rel="noopener ugc nofollow" target="_blank">在纽约市</a>的优步皮卡的可视化。但是，您可以随意创建自己的应用程序并进行部署(您将使用的模板无需更改！).</p><h1 id="4636" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">你需要什么</h1><p id="e41f" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">开始之前，你需要确定你已经准备好了一些东西。您将使用Google App Engine部署您的应用程序，因此这意味着您需要注册一个Google Cloud帐户(注册时还有300美元的信用点数！)然后安装他们的<code class="fe nn no np nd b">gcloud</code>命令行工具。你可以在这里注册一个账户(不是代销商链接，不用担心！):</p><div class="mf mg gp gr mh mi"><a href="https://cloud.google.com/free" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">GCP免费等级免费扩展试用和永远免费|谷歌云</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">GCP自由层以两种方式扩展我们的免费计划。3个月免费试用的300美元积分和20多种免费产品…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">cloud.google.com</p></div></div><div class="mr l"><div class="nq l mt mu mv mr mw jw mi"/></div></div></a></div><p id="c656" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">谷歌云也为安装<code class="fe nn no np nd b">gcloud</code>提供了很好的“入门”指南。</p><div class="mf mg gp gr mh mi"><a href="https://cloud.google.com/sdk/gcloud" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">gcloud命令行工具概述| Cloud SDK文档</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">本页包含gcloud命令行工具及其常用命令模式和功能的概述。的…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">cloud.google.com</p></div></div><div class="mr l"><div class="nr l mt mu mv mr mw jw mi"/></div></div></a></div><p id="32fd" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">完成后，确保你已经安装了<a class="ae kc" href="https://docs.docker.com/get-docker/" rel="noopener ugc nofollow" target="_blank">Docker</a>并且正在运行。你不需要与Docker互动来跟进这篇文章，但你需要它运行！您还需要拥有Python 3.6或更高版本的有效版本。为项目设置并激活一个Python虚拟环境也是一个好主意。</p><h1 id="9103" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">编码时间到了</h1><p id="09d8" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">所以，首先要做的是。您需要从GitHub克隆部署就绪的<a class="ae kc" href="https://github.com/markdouthwaite/streamlit-project" rel="noopener ugc nofollow" target="_blank"> Streamlit项目模板</a>。在您的终端中，运行:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="ab58" class="nh ke iq nd b gy ni nj l nk nl">git clone <a class="ae kc" href="https://github.com/markdouthwaite/streamlit-project" rel="noopener ugc nofollow" target="_blank">https://github.com/markdouthwaite/streamlit-project</a></span></pre><p id="95da" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">导航到新的<code class="fe nn no np nd b">streamlit-project</code>目录并运行:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="a7c9" class="nh ke iq nd b gy ni nj l nk nl">pip install -r requirements.txt</span></pre><p id="00d2" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">正如您所料，这将安装运行此应用程序所需的软件包。有了这个设置，是时候测试你的应用了！您可以通过以下方式做到这一点:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="5ef4" class="nh ke iq nd b gy ni nj l nk nl">make run-container</span></pre><p id="ef6b" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">将您的应用程序构建到Docker映像中，并在<code class="fe nn no np nd b">http://0.0.0.0:8080</code>启动运行您的应用程序的新容器。它会自动打开一个新的浏览器选项卡并加载你的应用程序。您应该会看到这样一个可爱的可视化效果:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/247e065da8aaaa9a00495fd3c3e0494b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*oxcFDWnktC_jOAv-.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片来自<a class="ae kc" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>。</p></figure><p id="cf56" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">你可以随意编辑这个应用程序。了解Streamlit的强大功能是值得的。当你完成后，只要确保<code class="fe nn no np nd b">make run</code>仍然在<code class="fe nn no np nd b">http://0.0.0.0:8080</code>成功启动你的应用，然后你就可以开始部署了。</p><h1 id="e38b" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">部署您的应用</h1><p id="9a16" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">您将使用<a class="ae kc" href="https://cloud.google.com/appengine" rel="noopener ugc nofollow" target="_blank">谷歌应用程序引擎</a>来部署应用程序。这是由Google Cloud提供的托管服务，可以帮助您超级轻松地部署和扩展您的应用。谷歌将为你管理缩放、服务器设置和其他零碎的东西。您所需要的只是一个正确配置的Docker映像，而且您已经很接近了。转到您的<a class="ae kc" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>，前往左侧导航菜单中的App Engine，检查您的App Engine API是否处于活动状态。您现在应该能够运行:</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="d5db" class="nh ke iq nd b gy ni nj l nk nl">make gcloud-deploy</span></pre><p id="81fe" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">这将建立你的图像，存储在谷歌容器注册(GCR)，然后配置和启动你的应用程序。完成后它会告诉你的。您应该会看到类似这样的内容(其中<code class="fe nn no np nd b">{{YOUR-URL}}</code>将是您部署的应用程序的URL):</p><pre class="my mz na nb gt nc nd ne nf aw ng bi"><span id="a744" class="nh ke iq nd b gy ni nj l nk nl">Deployed service [default] to [{{YOUR-URL}}]</span></pre><p id="4f81" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">导航到所提供的URL，查看您的应用程序的所有优点！</p><h1 id="8aad" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">后续步骤</h1><p id="4e31" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">完成后，你的应用程序现在是公开可见的，可以与你希望的任何人共享。您现在还可以使用<code class="fe nn no np nd b">make gcloud-deploy</code>自由编辑和重新部署您的应用程序。你甚至可以考虑用<a class="ae kc" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>构建一个<a class="ae kc" href="https://mark.douthwaite.io/continuous-training-and-delivery/" rel="noopener ugc nofollow" target="_blank">持续集成和持续交付</a> (CI/CD)管道，以便在每次你向GitHub推送更改时自动重新部署你的应用。不过这取决于你！</p><h1 id="a1ea" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">解决纷争</h1><p id="ef8c" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">如果你在上述步骤中遇到任何问题，App Engine的文档非常好，值得一看:</p><p id="5c69" class="pw-post-body-paragraph lb lc iq ld b le lz lg lh li ma lk ll lm mb lo lp lq mc ls lt lu md lw lx ly ij bi translated">如果你还在挣扎，请随时在Twitter上联系我。</p><h1 id="7e26" class="kd ke iq bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">收尾工作</h1><p id="4221" class="pw-post-body-paragraph lb lc iq ld b le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">差不多就是这样了。以可扩展、安全的方式部署新的Streamlit应用。简单，嗯？当您深入研究Streamlit时，您会注意到它在几个方面仍然有点受限:例如，布局和样式在默认情况下是高度受限的。然而，他们最近的几轮融资给了他们很多开发一些很酷的新功能的机会，这些东西<em class="me">在他们的功能路线图上</em>，所以他们的到来只是时间问题。如果你对数据可视化感兴趣，Streamlit绝对值得一看。</p></div></div>    
</body>
</html>