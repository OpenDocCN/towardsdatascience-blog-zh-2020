<html>
<head>
<title>Iterables and Iterators in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的迭代器和迭代器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/iterables-and-iterators-in-python-849b1556ce27?source=collection_archive---------17-----------------------#2020-11-06">https://towardsdatascience.com/iterables-and-iterators-in-python-849b1556ce27?source=collection_archive---------17-----------------------#2020-11-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a581" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python中的可迭代对象、迭代器和迭代</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8f61ba8a89de5011f7ae34d97fea96c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r0sibpPS9C8YNBNE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">凯文·Ku在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2110" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将学习迭代、可迭代和迭代器之间的区别，如何识别可迭代和迭代器，以及为什么这样做是有用的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2f4e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是可迭代的？</h1><p id="7840" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">广义地说，iterable是可以循环的东西。循环遍历某物，或者一个接一个地获取其中的每一项的过程，就是迭代。例如，当我们使用For循环来循环遍历一个列表时，循环遍历这个列表的过程就是迭代(或者我们正在迭代遍历这个列表)，这个列表就是iterable。元组、字典、字符串、文件和生成器也是可迭代的，因为它们也可以被迭代。</p><p id="2c41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我们可以使用For循环来循环或迭代列表，如下所示:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="fc68" class="ne md it na b gy nf ng l nh ni">num_list = [1,2,3,4,5]</span><span id="683f" class="ne md it na b gy nj ng l nh ni">for num in num_list:<br/>    print(num)</span></pre><h2 id="9bcb" class="ne md it bd me nk nl dn mi nm nn dp mm li no np mo lm nq nr mq lq ns nt ms nu bi translated"><strong class="ak">但是是什么让一个东西成为可重复的呢？</strong></h2><p id="581b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">换句话说，是什么使得某些东西能够被迭代，比如在for循环中？要成为可迭代的，一个对象将有一个iter()方法。因此，如果一个对象有iter()方法，那么它就是iterable，因此我们可以使用for循环来遍历它。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1020" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从技术上来说，如果一个对象有getitem()方法，它也可以是iterable。然而，我们在这里将关注iter()方法，因为它是python中迭代的较新协议。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="1027" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们在<em class="nv"> num_list </em>上使用dir()函数，它将显示列表对象的所有方法和属性:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/75e2925187d3cf597bb8aacbbcf62c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*z9URMfBQhcgzUvELaX76zw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">列表对象的方法和属性</p></figure><p id="3107" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意列表对象<em class="nv"> num_list </em>有一个__iter__()方法，这使它成为可迭代的。具有双前导和双尾随下划线的方法因此被称为dunder方法(也称为魔术方法或特殊方法)。这些方法旨在被间接调用，因为大多数python操作符都有相关的魔法方法。</p><h2 id="e340" class="ne md it bd me nk nl dn mi nm nn dp mm li no np mo lm nq nr mq lq ns nt ms nu bi translated"><strong class="ak">那么这个__iter__()方法是做什么的呢？</strong></h2><p id="b7e8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">__iter__()方法将返回一个迭代器对象。要循环遍历一个iterable，比如一个list，我们通常不会手动这么做。例如，For循环首先调用对象上的__iter__()方法，该方法返回一个迭代器对象。然后for循环遍历这个迭代器。所有这些都是在后台完成的。</p><p id="9db9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就把我们带到了迭代器。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nx"><a rel="noopener follow" target="_blank" href="/list-comprehensions-in-python-28d54c9286ca"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">Python中的列表理解</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">用python创建列表的更优雅、更简洁的方式</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a0e2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">什么是迭代器？</h1><p id="0c59" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">列表是可迭代的。但它不是迭代器。如果我们在列表上运行__iter__()方法，它将返回一个迭代器。迭代器是一个对象，它有一个在迭代过程中记得自己位置的状态。迭代器也知道如何获得它们的下一个值。它们通过__next__()方法获得下一个值。因此，要知道一个对象是否是迭代器，我们可以检查它是否有__next__()方法。</p><p id="e9de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以先调用num_list上的iter()函数(iter()函数调用传入的对象上的__iter__()方法)，返回一个迭代器，然后我们将在迭代器上使用dir()函数查看其属性和方法:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a75e4ab1eb3407d904f49e1af4f1c5eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*HkszYEX32jhTHkQrriuISA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迭代器的方法和属性</p></figure><p id="ff1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意我们的迭代器<em class="nv"> num_list_iterator </em>有一个__next__()方法。列表对象不是迭代器，因为它没有__next__()方法。因此，在列表上调用next()函数(如果有对象的话，它会在对象上调用__next__()方法)会导致类型错误，因为我们的列表对象不是迭代器，因此没有__next__()方法。但是，list对象是可迭代的，因为它有一个__iter__()方法，调用该方法时，返回一个迭代器，该迭代器将有一个__next__()方法。</p><blockquote class="on"><p id="6288" class="oo op it bd oq or os ot ou ov ow lu dk translated">注意num_list_iterator也有一个__iter__()方法。因此，迭代器也是可迭代的，或自迭代的，因为在迭代器上调用__iter__()方法会返回self。</p></blockquote><h2 id="1986" class="ne md it bd me nk ox dn mi nm oy dp mm li oz np mo lm pa nr mq lq pb nt ms nu bi translated"><strong class="ak">下一个方法是做什么的？</strong></h2><p id="a7b8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在迭代器上调用__next__()方法将返回迭代中的下一个值。因此，在我们从<em class="nv"> num_list </em>或<em class="nv"> num_list_iterator </em>创建的迭代器上调用__next__()方法，将返回迭代器中的第一个值。在同一个迭代器上调用__next__()方法将返回迭代器中的第二个值(记住迭代器有一个状态，它能记住它在迭代过程中的位置)。一旦我们遍历了迭代器的所有值，在迭代器上再次调用__next__()方法将导致StopIteration错误，因为我们的迭代器现在已经用完了。一旦一个迭代器用完了，我们必须通过iterable的__iter__()方法创建一个新的迭代器。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><blockquote class="on"><p id="f57a" class="oo op it bd oq or os ot ou ov ow lu dk translated">注意:迭代器只能向前。这意味着我们只能通过__next__()方法获得迭代器中的下一个值。为了从头开始，我们必须通过在我们想要迭代的iterable上调用__iter__()方法来创建一个新的iterator对象。</p></blockquote></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><div class="kj kk kl km gt nx"><a rel="noopener follow" target="_blank" href="/args-and-kwargs-in-python-6d991a3c1b5e"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">* Python中的args和**kwargs</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">理解什么是*args和**kwargs以及如何使用它们</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="pc l oi oj ok og ol ks nx"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="0fc9" class="ne md it bd me nk nl dn mi nm nn dp mm li no np mo lm nq nr mq lq ns nt ms nu bi translated"><strong class="ak">for循环是如何工作的？</strong></h2><p id="4e24" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">for循环的工作原理是在后台执行上述操作。使用for循环遍历list(或其他iterable)首先通过__iter__()方法创建一个迭代器对象，然后调用该迭代器上的__next__()方法，返回值，直到返回StopIteration错误(它没有向我们显示)，这让它知道迭代器已经用尽，因为迭代器中没有更多的值了。这可以从下面看出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/76f69a5442b8950b9fb169632da860f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3h0RX23Si8ozrR9qn7pwGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在for循环的背景中</p></figure><p id="6bd7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们可以使用内置的iter()和next()函数，而不是键入dunder方法，这些函数为我们调用__iter__()和__next__()方法。但是，我们也可以像下面这样调用方法:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="eeb5" class="ne md it na b gy nf ng l nh ni">num_list.__iter__()</span><span id="8db2" class="ne md it na b gy nj ng l nh ni">num_list_iterator.__next__()</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="da02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您熟悉while循环和try/except语句，那么上面的for循环类似于下面的while循环:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/530a0700f9e64632840cfbfe9a3ab3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*U3fJTWBjT3_UWbSke7TZSg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">类似于while循环和for循环</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="917a" class="ne md it bd me nk nl dn mi nm nn dp mm li no np mo lm nq nr mq lq ns nt ms nu bi translated">为什么知道这些很有用？</h2><p id="8935" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在用python编码时，知道一个对象是可迭代的(还是可被迭代的)会非常有帮助。例如，知道一个对象是否是iterable将告诉我们一个对象是否可以在For循环中使用。</p><p id="0d8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，我们使用了一个for循环来遍历<em class="nv"> num_list </em>，这是一个从1开始到5结束的整数列表，即[1，2，3，4，5]。好吧，不像上面那样创建<em class="nv"> num_list </em>并遍历它，我们可以检查一下是否可以使用range()函数来创建一个range对象，我们可以使用for循环来遍历它，给我们相同的数字序列来迭代:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/355a174eabe4b8d15391e8b816397c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*C-6nl44h7BPj-IUBd2W2sg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">range对象的方法和属性</p></figure><p id="e020" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，range对象是一个可迭代的对象，因为它有__iter__()方法！因此，可以使用for循环对其进行迭代，因为for循环将首先创建迭代器对象，然后使用__next__()方法对该迭代器对象进行迭代。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9e58" class="ne md it na b gy nf ng l nh ni">for num in range(1,6):<br/>    print(num)</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="e05d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢阅读这样的故事，并想支持我成为一名作家，考虑注册成为一名媒体成员。每月5美元，你可以无限制地阅读媒体上的故事。如果你用我的 <a class="ae ky" href="https://lmatalka90.medium.com/membership" rel="noopener"> <em class="nv">链接</em> </a> <em class="nv">注册，我会赚一小笔佣金。</em></p><div class="pg ph gp gr pi nx"><a href="https://lmatalka90.medium.com/membership" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">通过我的推荐链接加入媒体——卢艾·马塔尔卡</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">阅读卢艾·马塔尔卡的每一个故事(以及媒体上成千上万的其他作家)。您的会员费直接支持…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">lmatalka90.medium.com</p></div></div><div class="og l"><div class="pj l oi oj ok og ol ks nx"/></div></div></a></div></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="29c1" class="ne md it bd me nk nl dn mi nm nn dp mm li no np mo lm nq nr mq lq ns nt ms nu bi translated">结论</h2><p id="1f8b" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本教程中，我们讨论了迭代、可迭代对象和迭代器的含义。我们了解了iterable是一个具有__iter__()方法的对象，该方法将创建一个迭代器对象。我们还了解到迭代器是一个对象，它有一个在迭代过程中记得它在哪里的状态，并且知道如何通过__next__()方法获得下一个值。最后，我们看到了将一个对象标识为iterable是如何帮助我们编写更多pythonic代码的。</p></div></div>    
</body>
</html>