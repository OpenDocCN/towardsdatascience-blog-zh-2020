<html>
<head>
<title>If history repeats itself, Fourier Transform is a key</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如果历史重演，傅立叶变换是一把钥匙</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/if-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e?source=collection_archive---------52-----------------------#2020-11-15">https://towardsdatascience.com/if-history-repeats-itself-fourier-transform-is-a-key-a593ddfa246e?source=collection_archive---------52-----------------------#2020-11-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="96ec" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">仅仅使用傅立叶变换就可以清理你的数据并预测新的数据吗？答案是肯定的，可能。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/67316582b24d235d164f58ef823aefdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Y-YXXBryiJfMx8XxbhPPw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由乔恩·泰森<a class="ae kv" href="https://unsplash.com/@jontyson" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@jontyson</a>拍摄</p></figure><p id="e08b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的教授在高中时常说的一句话是<strong class="ky ir">“历史会重演”</strong>。这句话的意思显然与这样一个事实有关，即我们应该以史为鉴，从而能够不犯我们过去犯过的同样的错误。</p><p id="bd86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们来谈谈科学。如果你有一个时间序列，那么你就有(最好)很长一段时间的数据。让我们假设一下<strong class="ky ir">历史确实会重演</strong>。这将意味着，通过简单地复制信号，您将扩展您的数据，从而获得两倍长的数据集。我知道你在想什么，你是对的，我在愚弄你。事实上，我在这几行中主要提到的是<a class="ae kv" href="https://en.wikipedia.org/wiki/Fourier_transform" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">傅里叶变换</strong> </a> <strong class="ky ir">，即每个周期信号都可以被视为正弦和余弦之和</strong>。获得每个频率的幅度和相位，就有了信号，可以很容易地扩展它。</p><p id="543e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我有一个好消息和一个坏消息要告诉你。坏消息是你不能假装你的数据是周期性的，除非你知道由于某种奇怪的原因它们确实是周期性的。好消息是，有时你的数据确实呈现半周期模式，在这种情况下，傅立叶变换值得一试。</p><p id="3800" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我知道，我说了很多，让我们从实践开始。</p><h1 id="2076" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">设置:</h1><p id="e8de" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">已经使用的语言是Python，具有已经使用的以下库:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="b5fb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据集:</h1><p id="0883" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们以<a class="ae kv" href="https://www.pse.pl/web/pse-eng/data/polish-power-system-operation/load-of-polish-power-system" rel="noopener ugc nofollow" target="_blank">波兰电力负荷</a>为例，看看2008年至2016年的数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/4e908f4c8a0315adb9ea93ba8c679a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgRnkF-jOy48baZzgriLuw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是原始数据</p></figure><p id="7b5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每一年的时间步长非常容易区分，如果我们把它缩小，每个月和每个星期也是如此。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/f9a558cd4cfc90f13234b83e67e825da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXTTt3PJp3Tqt-lyQRxVbA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">很有周期性，是吧？</p></figure><p id="d444" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这些情况下，傅立叶变换这样的简单方法可能是一种选择。事实上，<strong class="ky ir">它可以应用的想法是，我们的信号实际上是周期性的，但它似乎不是周期性的，因为噪声、一般线性趋势或其他不必要的影响使我们的信号不稳定</strong>。让我们继续前进！</p><h2 id="ccc1" class="mt lt iq bd lu mu mv dn ly mw mx dp mc lf my mz me lj na nb mg ln nc nd mi ne bi translated"><strong class="ak">春季大扫除:</strong></h2><p id="617b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该信号具有线性趋势，并且其平均值不为0。<strong class="ky ir">这可能会干扰傅立叶频谱，通常我们不希望线性趋势被视为傅立叶频谱的“长频率成分”</strong>。使用神奇的scipy库，信号已被消除趋势和转移，以便将其平均值设置为0。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/8212373ac86495104237bab2438beddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CVXOwa9Ji3G0rU-Pc1hL2g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">线性增长的信号消失了。加上数据现在有0均值。</p></figure><p id="a8cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，我们准备好了。</p><h2 id="c66c" class="mt lt iq bd lu mu mv dn ly mw mx dp mc lf my mz me lj na nb mg ln nc nd mi ne bi translated">培训/验证/测试:</h2><p id="f61c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">借用机器学习术语，数据集分为三部分:</p><ul class=""><li id="5758" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nl nm nn no bi translated"><strong class="ky ir">训练集:</strong>应用傅立叶变换的地方(从2008年到2014年)</li><li id="4a23" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated"><strong class="ky ir">验证集</strong>:最适合模型的地方(2015)</li><li id="b04b" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated"><strong class="ky ir">测试集:</strong>其中<strong class="ky ir"> </strong>揭示模型的优良性。(2016)</li></ul><p id="72ce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你是一个ML专家，请不要把这个术语看得太重，因为它和你所知道的不太相符。无意冒犯。名字就是名字。:)</p><h1 id="a82f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">算法:</h1><p id="9934" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">当然，如果你天真地应用傅立叶变换，你不能期望得到好的结果，这就是为什么算法稍微(我希望)复杂一些。</p><h2 id="f745" class="mt lt iq bd lu mu mv dn ly mw mx dp mc lf my mz me lj na nb mg ln nc nd mi ne bi translated">Divide et impera(训练集)</h2><p id="bf7c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">傅立叶变换意味着数据是静止的，但生活是变化的，爱情故事也是结束的</p><p id="ceb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">这就是为什么训练集的每一年都必须单独进行。每一年都会给出它的傅立叶变换。</strong></p><p id="866e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">平均傅立叶变换(F)是通过每个傅立叶变换的和除以7(在训练集上有7年)获得的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="e1d0" class="mt lt iq bd lu mu mv dn ly mw mx dp mc lf my mz me lj na nb mg ln nc nd mi ne bi translated">消除干扰(验证集)</h2><p id="1d99" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir">现在让我们考虑验证集信号(2015年负载)。其思想是使用训练集的傅立叶变换，将其转换回来，并将重建的信号与验证集的信号进行比较。傅立叶逆变换当然是通过使用numpy FFT算法获得的。</strong></p><p id="6a98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">问题是，由于numpy FFT算法非常出色，它能够非常好地再现信号，甚至可能太好了。事实上，我们希望噪声不在重构信号中。但是什么是真正的噪音呢？</p><p id="d66b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你知道没人能回答这个问题，但是<strong class="ky ir">一个安全的警告是，误差(原始信号(即2015年负载)和重建信号之间的差异)必须最有可能与信号</strong>不相关。当然，另一方面，如果我们有一个0信号，它与原始信号不相关，但它没有预测能力。简而言之，这就是我们想要的模型:</p><ul class=""><li id="b98f" class="ng nh iq ky b kz la lc ld lf ni lj nj ln nk lr nl nm nn no bi translated"><strong class="ky ir">原始信号和重建信号之间可接受的低RMSE</strong>:如果RMSE太高，预测就不起作用。</li><li id="3bb0" class="ng nh iq ky b kz np lc nq lf nr lj ns ln nt lr nl nm nn no bi translated"><strong class="ky ir">误差与原始信号之间的低相关性</strong>:如果相关性太高，我们的模型会过度拟合数据，并且在测试期间会出现令人不愉快的意外。</li></ul><p id="0be7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了做到这一点，我们调用一个名为<strong class="ky ir"> threshold </strong>的魔法向导。阈值是0和1之间的某个值，将乘以训练集(F)的平均谱的最高值。<strong class="ky ir">所有小于t * max(F)的频率都被设置为0，然后信号被转换回原始空间，RMSE和相关值都已经被计算出来。最佳阈值是具有最低RMSE和尽可能最低相关性的阈值。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h2 id="a6df" class="mt lt iq bd lu mu mv dn ly mw mx dp mc lf my mz me lj na nb mg ln nc nd mi ne bi translated">测试预测(测试集)</h2><p id="f5a3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这种经过滤波的傅立叶频谱已被用于预测2016年负荷的前10至90天，结果实际上令人惊讶。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="446e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">该模型略微过拟合，但RMSE仍然低得可以接受，误差部分是由于统计误差波动，从C为&lt; 0.60这一事实可以看出。此外，预测实际上在一周的前几天非常好，而周末似乎更难赶上</strong>(伙计们，拜托，别喝太多了！)</p><h1 id="99d3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论:</h1><p id="9d89" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">许多数据科学挑战是<strong class="ky ir">时间序列挑战</strong>(例如全球气候报告、股票市场分析、太阳周期预测等。).当然，还有更强有力的方法来处理时间序列(RNN、阿玛、ARIMA、萨里玛等)。)并对它们进行预测。尽管如此，正如我希望我在这篇报道中所展示的那样，有时很好地利用简单的数学概念仍然可以产生非常好的结果。作为简单的数学概念，它们还能让你完全控制正在发生的事情，并且可以根据你自己的调查进行调整。</p><p id="72ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">顺便说一句，我真的不知道历史是否会重演，但我确实认为我们应该以不同的形式、不同的心态和不同的精神重新生活一些时刻。正如马克·吐温曾经说过的:</p><blockquote class="nu"><p id="e711" class="nv nw iq bd nx ny nz oa ob oc od lr dk translated">“历史不会重演，但它经常押韵”</p></blockquote><p id="e8cb" class="pw-post-body-paragraph kw kx iq ky b kz oe jr lb lc of ju le lf og lh li lj oh ll lm ln oi lp lq lr ij bi translated">如果你喜欢这篇文章，你想知道更多关于机器学习的知识，或者你只是想问我一些你可以问的问题:</p><p id="ce33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">A.在<a class="ae kv" href="https://www.linkedin.com/in/pieropaialunga/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> Linkedin </strong> </a>上关注我，我在那里发布我所有的故事<br/> B .订阅我的<a class="ae kv" href="https://piero-paialunga.medium.com/subscribe" rel="noopener"> <strong class="ky ir">简讯</strong> </a>。这会让你了解新的故事，并给你机会发短信给我，让我收到你所有的更正或疑问。<br/> C .成为<a class="ae kv" href="https://piero-paialunga.medium.com/membership" rel="noopener"> <strong class="ky ir">推荐会员</strong> </a>，这样你就不会有任何“本月最大故事数”，你可以阅读我(以及数千名其他机器学习和数据科学顶级作家)写的任何关于最新可用技术的文章。</p><p id="edb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">再见:)</p></div></div>    
</body>
</html>