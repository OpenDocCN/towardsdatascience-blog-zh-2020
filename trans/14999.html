<html>
<head>
<title>Building State-Of-The-Art Machine Learning Models With AutoGluon</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自动旋转构建最先进的机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-state-of-art-machine-learning-models-with-autogluon-9f19f61048fb?source=collection_archive---------27-----------------------#2020-10-15">https://towardsdatascience.com/building-state-of-art-machine-learning-models-with-autogluon-9f19f61048fb?source=collection_archive---------27-----------------------#2020-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b3c8cb15195e5b0af13c63ff7373a54e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t2VydSvItsOVmdIt"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@kaelbloom?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯尔·布鲁姆</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><h1 id="3e25" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">自动登录和自动</h1><p id="58eb" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">AutoGluon是由AWS构建的开源AutoML框架，它支持简单易用且易于扩展的AutoML。它使您能够在没有专业知识的情况下，通过利用最先进的深度学习技术来实现最先进的预测准确性。这也是一种快速的方式来原型化您可以从您的数据集获得什么，以及获得您的机器学习的初始基线。AutoGluon目前支持处理表格数据、文本预测、图像分类和对象检测。</p><p id="838e" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg jk"> AutoML </strong>框架的存在是为了降低机器学习的入门门槛。他们负责繁重的任务，如数据预处理、特征工程、算法选择和超参数调整。这意味着，给定一个数据集和一个机器学习问题，继续用不同的超参数组合训练不同的模型，直到找到模型和超参数的最佳组合——也称为<em class="mh"> CASH(组合算法/超参数调整)</em>。现有的AutoML框架包括SageMaker Autopilot、Auto-WEKA和Auto-sklearn。</p><p id="2a4a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoGluon不同于其他(传统)AutoML框架，它比<em class="mh"> CASH(组合算法/超参数调优</em>)做得更多。</p><h1 id="1337" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">集成机器学习和堆叠</h1><p id="eab2" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在深入研究旋翼飞行器之前，重温一下系综机器学习和堆叠是很有用的。集成学习是一种并行训练许多(有目的地)弱模型来解决同一问题的机器技术。集成由一组单独训练的分类器组成，例如神经网络或决策树，当对新实例进行分类时，它们的预测被组合。这种机器学习技术背后的基本思想是<em class="mh">许多模型比少数模型好，不同学习的模型可以提高准确性，即使它们在孤立状态下表现较差。</em></p><p id="688a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在大多数情况下，选择单个基本算法来构建多个模型，然后对其结果进行汇总。这也被称为<strong class="lg jk"> <em class="mh">同质</em> </strong>集成学习方法，就像随机森林算法是最常见和最流行的同质<strong class="lg jk"> <em class="mh"> </em> </strong>集成学习技术之一，其中多棵树被训练来预测同一问题，然后在它们之间进行多数投票。同类方法的其他例子包括装袋、旋转森林、随机子空间等。</p><p id="d962" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">相比之下，<strong class="lg jk"> <em class="mh">异构</em> </strong>方法涉及使用不同的机器学习基础算法，如决策树、人工神经网络等，来创建用于集成学习的模型。<strong class="lg jk"> <em class="mh">堆叠</em> </strong>是一种常见的异构集成学习技术。</p><p id="cc7e" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这个表<a class="ae jg" href="https://www.hindawi.com/journals/mpe/2013/312067/tab2/" rel="noopener ugc nofollow" target="_blank">这里</a>列出了同构和异构机器学习的例子。</p><p id="e7de" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoGluon使用了一个<em class="mh">多层堆栈集合</em>，我们接下来将研究它是如何工作的。</p><h1 id="b5b6" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">自动旋转是如何工作的</h1><p id="b385" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">AutoGluon在<em class="mh">监督机器学习</em>域中运行。这意味着您需要有用于训练的带标签的输入数据。AutoGluon负责预处理、特征工程，并根据您试图解决的机器学习问题生成模型。</p><p id="c1ac" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoML的主要部分依赖于<em class="mh">超参数调整</em>来生成和选择最佳模型。超参数调整涉及为提供最佳模型的机器学习算法找到超参数的最佳组合。最佳参数集的搜索策略基于随机搜索、网格搜索或贝叶斯优化(SageMaker使用的方法)。</p><p id="e223" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然而，超参数调谐存在局限性。超参数调优效率低、耗时，而且由于不是所有调优的模型最终都会被使用，因此会造成大量开销浪费。最后，还存在过度拟合验证(保持)数据的风险，因为每次运行调优过程时，都会检查验证数据集，最终会过度拟合验证数据集。</p><p id="5096" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoGluon与其他AutoML框架的一个关键区别是，AutoGluon使用(几乎)每一个经过训练的模型来生成最终预测(<em class="mh">而不是在超参数调整</em>后选择最佳候选模型)。</p><h1 id="3268" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">记忆和状态</h1><p id="38f6" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">自动增长是内存感知的，它确保训练的模型不会超过它可用的内存资源。</p><p id="8516" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoGluon是状态感知的，它预计模型在训练期间会失败或超时，并优雅地跳过失败的模型，继续下一个模型。只要你生成了一个成功的模型，自动旋转就可以开始了。</p><p id="ca55" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">AutoGluon依赖于多层堆栈集成等策略。它自动进行k-fold bagging和out-of-fold预测生成，以确保没有过度拟合。具体来说，它利用了现代深度学习技术，也不需要任何数据预处理。</p><h1 id="da3a" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">行动中的自动旋转</h1><p id="e99b" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">自动增长也支持文本和图像，但是对于这篇文章，我们主要关注<em class="mh">自动增长表格。</em>分类和回归的监督机器学习问题的自动增长表格工作。您可以预先指定问题的类型，或者AutoGluon会根据您的数据集自动选择一个问题。</p><h1 id="8ab4" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">数据集</h1><p id="5e2f" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于数据集，我们使用来自Kaggle的流行、开源的<a class="ae jg" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank"> Titanic数据集</a>。该数据集包含训练数据，其中包括皇家邮轮泰坦尼克号上851名乘客的标记数据，以及他们是否在灾难中幸存。该数据集还包括一个测试集，其中有418名乘客，但没有标签，即他们是否幸存。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mi"><img src="../Images/b6ab954b94f7efee209dea3111469dfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y_ETdInFyVvepe9f.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://en.wikipedia.org/wiki/Titanic#/media/File:RMS_Titanic_3.jpg" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="0da9" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">挑战在于根据包括的特征如姓名、年龄、性别、社会经济阶层等来预测乘客是否幸存。</p><h1 id="18e5" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">设置</h1><p id="1245" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">AutoGluon安装非常简单，只需几行代码</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><h1 id="f7ea" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">培养</h1><p id="89b4" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了开始训练，我们首先从AutoGluon导入TabularPrediction，然后加载数据。AutoGluon目前可以对已经作为pandas DataFrames加载到Python中的数据表进行操作，或者对那些存储在CSV格式或Parquet格式的文件中的数据表进行操作。</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="d4e2" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">一旦您加载了数据，您就可以立即开始训练，您所需要做的就是指向训练数据并指定您想要预测的列的名称。</p><p id="8c3a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">训练从<code class="fe mp mq mr ms b">.fit()</code>法开始</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="fe6a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">您可以选择指定希望培训运行的时间，AutoGluon将在该时间内自动结束所有培训作业。</p><p id="18a7" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><code class="fe mp mq mr ms b">eval_metric</code>参数允许您指定AutoGluon将用于验证模型的评估指标。默认是<code class="fe mp mq mr ms b">accuracy</code>。</p><p id="bb5a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">设置<code class="fe mp mq mr ms b">auto_stack = True</code>允许AutoGluon管理它将自动创建的堆栈数量。您可以通过<code class="fe mp mq mr ms b">stack_ensemble_levels</code>参数选择指定您想要的堆叠数量。</p><p id="c46c" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><code class="fe mp mq mr ms b">presets</code>参数允许您选择想要生成的模型类型，例如，如果延迟和时间不是一个约束条件的话<code class="fe mp mq mr ms b">presets='best_quality</code>通常会生成更精确的模型。另一方面，如果您知道延迟将是一个约束，那么您可以设置<code class="fe mp mq mr ms b">presets=[‘good_quality_faster_inference_only_refit’, ‘optimize_for_deployment’ </code>来生成针对部署和推断更优化的模型。</p><p id="aa3b" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">训练开始后，AutoGluon将在训练的不同阶段开始记录消息。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/2b965a4f19421a5fd4b03ba1f1b8a3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*luugIQOSfwbdMM-2"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">培训日志(图片由作者提供)</p></figure><p id="5555" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">随着培训的进行，AutoGluon还将记录其生成的各种模型的评估分数。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/c8e1366764674466319427f03ed2f25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GtsnQjgnCQQPTINh"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">模型分数(图片由作者提供)</p></figure><p id="501a" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这里需要注意的是，除非您明确需要指定一个验证数据集，否则您应该直接将所有训练数据发送到AutoGluon。这允许AutoGluon以有效的方式自动选择数据的随机训练/验证分割。</p><p id="d0d4" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">训练完成后，您可以开始使用<code class="fe mp mq mr ms b">.predict()</code>功能进行推理。</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="dd79" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在上面的例子中，我们只使用默认设置来训练Titanic数据集。</p><p id="5b28" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">我们取得的成绩是最先进的。准确率为<strong class="lg jk"> <em class="mh"> ~78 </em> </strong>，在Kaggle的比赛中名列前8%-10%  。</p><h1 id="f89b" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">如果您想使用一个或一些模型，该怎么办</h1><p id="89df" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">默认情况下，auto glon会自动选择最佳的多层堆栈集合来运行您的预测，但是，您也可以通过生成一个带有单行代码的排行榜来获得auto glon生成的所有模型及其特定性能指标的列表:<code class="fe mp mq mr ms b">predictor.leaderboard(extra_info=True, silent=True)</code></p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/0bfe5a7552c957363e111fd12f0e426b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5YhwI89_EHsCYQj9"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">排行榜(作者图片)</p></figure><p id="31d6" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">除了性能指标，排行榜还显示了每个模型/堆栈的训练和推理时间，以及顺序、祖先、后代等。以及其他信息。</p><p id="e279" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">使用此排行榜，您只需指定索引号，即可选择想要运行的特定组合。</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><p id="9705" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">例如，在上面的代码中，我们使用了系综的堆栈19。</p><h1 id="0ea2" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">超参数调优呢</h1><p id="b55a" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">与您使用其他机器学习框架的经历相反，您可能不需要使用AutoGluon进行任何超参数调整。在大多数情况下，通过设置<code class="fe mp mq mr ms b">auto_stack = True</code>或手动指定stack_levels和<code class="fe mp mq mr ms b">num_bagging_folds</code>可以获得最佳精度</p><p id="c253" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然而，AutoGluon支持通过<code class="fe mp mq mr ms b">hp_tune = True</code>参数进行超参数调整。当您启用超参数调整时，AutoGluon将仅使用您指定了超参数设置的基本算法创建模型。它将跳过其余部分。</p><figure class="mj mk ml mm gt iv"><div class="bz fp l di"><div class="mn mo l"/></div></figure><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f5a3e753f72beeccdcd2d6889e99353e.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*X2IBBrRq-66xz2YtJGLVcQ.png"/></div></figure><p id="0ae4" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在上面的示例代码中，AutoGluon将训练神经网络和各种基于树的模型，并在指定的搜索空间内调整每个模型的超参数。</p><h1 id="27b2" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结束语</h1><p id="879f" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">虽然AutoGluon可以直接构建最先进的机器学习模型，但我发现它和我的新基线方法一样有用。</p><p id="49d5" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">虽然auto glon会进行数据预处理和特征工程(而且做得非常好)，但是您会发现，如果在使用auto glon进行训练之前对数据进行预处理和特征工程，您可以获得更好的性能。总的来说，更好的数据几乎总是导致更好的模型。</p><h1 id="38d3" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">附加阅读</h1><ul class=""><li id="c201" class="mv mw jj lg b lh li ll lm lp mx lt my lx mz mb na nb nc nd bi translated"><a class="ae jg" href="https://arxiv.org/abs/2003.06505" rel="noopener ugc nofollow" target="_blank"> AutoGluon-Tabular:针对结构化数据的健壮而精确的AutoML</a></li><li id="ae9f" class="mv mw jj lg b lh ne ll nf lp ng lt nh lx ni mb na nb nc nd bi translated"><a class="ae jg" href="https://www.amazon.science/amazons-autogluon-helps-developers-get-up-and-running-with-state-of-the-art-deep-learning-models-with-just-a-few-lines-of-code" rel="noopener ugc nofollow" target="_blank">亚马逊的AutoGluon只需几行代码就能帮助开发者部署深度学习模型</a></li><li id="a84c" class="mv mw jj lg b lh ne ll nf lp ng lt nh lx ni mb na nb nc nd bi translated"><a class="ae jg" href="https://autogluon.mxnet.io/index.html" rel="noopener ugc nofollow" target="_blank">autoglon:深度学习的AutoML工具包</a></li></ul></div></div>    
</body>
</html>