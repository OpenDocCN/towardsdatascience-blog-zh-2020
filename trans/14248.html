<html>
<head>
<title>Leverage on D3.js v4 to build a Network Graph for Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用D3.js v4构建Tableau的网络图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/leverage-on-d3-js-v4-to-build-a-network-graph-for-tableau-with-ease-cc274cba69ce?source=collection_archive---------23-----------------------#2020-10-01">https://towardsdatascience.com/leverage-on-d3-js-v4-to-build-a-network-graph-for-tableau-with-ease-cc274cba69ce?source=collection_archive---------23-----------------------#2020-10-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5b73" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用D3.js自动计算每个节点的(x，y)坐标，并根据您的喜好调整布局</h2></div><p id="a540" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，最近世界各国都在狂热地追踪接触者，以控制新冠肺炎感染率。作为一名数据分析师，我最近接触了很多网络图。看到一个主要由<strong class="kk iu">节点</strong>和<strong class="kk iu">链接</strong>组成的图不仅美观，而且<strong class="kk iu"> </strong>有效地表示了不同实体之间的连接，这很有趣。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/0746523f8f5e2ea211460a363831d98f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUWhybP0w4bkCSBviT5h1A.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">Image by Author |一个由d3.js渲染的网络图示例，用于可视化stackoverflow上#标签的出现频率</p></figure><p id="332a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数网络图可视化大多部署在web应用程序上。残酷的事实是web开发时间远远超过dashboarding。此外，我工作过的团队通常只对网络图的快照感兴趣，因此在Tableau等仪表板工具上绘制网络图的能力将为突出显示与图形的交互性不太重要的重要发现提供更大的便利。因此，我继续探索和实现用最小的努力在Tableau上绘制完全相同的图形的方法。这让我创建了一个由<strong class="kk iu"> 2 </strong>部分组成的宠物项目</p><p id="d58e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第一部分:</strong>直接为Tableau输出数据的web应用程序(功能包括手动调整图形布局的灵活性+最终Tableau就绪数据输出的导出)</p><p id="acaa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第二部分:</strong>使用在<em class="lu">第一部分</em>中创建的数据生成器，相应地在我的下一个Tableau仪表板中包含一个网络图。</p><h1 id="97ba" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第一部分:创建Web应用工具</h1><p id="2940" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">关于项目的这一部分，我的网络应用程序的布局和功能是基于特里斯坦·吉列文的https://observablehq.com/@ladataviz/network-data-generator</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/389cf5f4add7804b59823caa3ad6dad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-cB2Z9GfoT631Qm35MB2Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图片由作者提供|展示了<a class="ae ms" href="https://observablehq.com/@ladataviz/network-data-generator" rel="noopener ugc nofollow" target="_blank">https://observablehq.com/@ladataviz/network-data-generator</a>上的功能，包括:使用户能够输入自己的JSON文件来呈现网络图，并为Tableau导出2个CSV文件。此外，可以调整节点<strong class="bd mu">尺寸</strong>和<strong class="bd mu">力</strong>参数的配置，以改变整体布局。</p></figure><p id="7053" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要误会我的意思，虽然我觉得这很棒，而且我对利用d3图形库的独创性印象深刻，但当我试图使用Tableau中的输出时，有两个主要限制——</p><ul class=""><li id="542e" class="mv mw it kk b kl km ko kp kr mx kv my kz mz ld na nb nc nd bi translated">约束1:该工具不允许直接将节点拖动到其他位置来实现更加定制的布局。<em class="lu">虽然强度和碰撞参数可以切换，但节点的移动是不可预测的，难以操纵。</em></li><li id="5b5d" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">约束2:最终生成的输出确实呈现了工具中预览的精确布局。然而，当我试图过滤一些<strong class="kk iu">节点</strong>或<strong class="kk iu">链接</strong>的显示时，数据输出中没有特定的字段— <em class="lu"> nodes.csv </em>和<em class="lu"> links.csv </em>，这使得这在Tableau中很容易发生。</li></ul><p id="d4d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在解决以上两个问题之前，我继续开发了一个类似于Tristan Guillevin的web界面:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nj"><img src="../Images/c429fa0b99daeb5d3bc5517b419b6644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7G3SaYIAJg1kEd7UQiv0g.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片|我在<a class="ae ms" href="https://tableau-data-utility.glitch.me/" rel="noopener ugc nofollow" target="_blank">https://tableau-data-utility.glitch.me/</a>部署的web应用预览。类似地，用户可以按照指定的格式输入他们自己的JSON文件。图形布局也启用了配置。此外，带有Tableau图标的按钮说明了两个输出文件— <strong class="bd mu"> nodes.csv </strong>和<strong class="bd mu"> links.csv </strong>之间的后续数据连接是如何发生的</p></figure><p id="6297" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本上，它是一个单页应用程序，包含所有的说明和所需的信息。现在，这里出现了一个有争议的最用户友好的特性— <em class="lu">允许用户手动改变和拖动节点，以使图形符合他们想要的布局:</em></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/1460aaa6ea91f42517370f8707d93634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*_XoEvi8yXSj8uXXuGkuVdA.gif"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片|在<a class="ae ms" href="https://tableau-data-utility.glitch.me/" rel="noopener ugc nofollow" target="_blank">https://tableau-data-utility.glitch.me/</a>对网络应用程序中图表的原始布局进行简单调整的演示</p></figure><p id="7f24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一个明显的对比，工具在移动后成功地改变了节点的坐标:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nl"><img src="../Images/41e6dc52ee765452bb4cdf2f8b7dddf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4YFXQc3_ZoccWZ26FPkNyg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片| ( <strong class="bd mu">左</strong>)D3 . js渲染的网络图调整前布局| ( <strong class="bd mu">右</strong>)导出csv文件的Tableau图形可视化</p></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nm"><img src="../Images/04991fa9d34805b7432e5c169fd4ee18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3sAFb5uR13G3H-mC3Ye3A.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片| ( <strong class="bd mu">左</strong>)D3 . js渲染的网络图调整后布局| ( <strong class="bd mu">右</strong>)导出csv文件的Tableau图形可视化</p></figure><p id="4c9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，解决了(1/2)的约束条件——另一个未解决的问题是，当在Tableau中绘制时，生成的原始输出不允许对特定的<strong class="kk iu">节点</strong>或<strong class="kk iu">链接</strong>进行过滤(这将在<strong class="kk iu">第二部分</strong>中进行阐述)。</p><h1 id="55dd" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">第二部分:在Tableau Dashboard中包含一个网络图，用于数据剖析/分析</h1><p id="7943" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">最终，我决定在2020年第三季度确定新加坡的登革热集群。原始数据源在最终的仪表板中说明，但是在地理编码和一些数据转换之后，生成Tableau图所需的JSON输入被生成:<a class="ae ms" href="https://github.com/incubated-geek-cc/tableau-data-utility/blob/master/public/data/sg_dengue_clusters.json" rel="noopener ugc nofollow" target="_blank">https://github . com/wended-geek-cc/Tableau-data-utility/blob/master/public/data/SG _ dengue _ clusters . JSON</a></p><p id="6342" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在绘制网络图并将地图添加到仪表板上之后，我面临的第二个约束是无法通过特定节点/链接进行过滤:</p><ul class=""><li id="33f9" class="mv mw it kk b kl km ko kp kr mx kv my kz mz ld na nb nc nd bi translated">[Id] (nodes.csv):每个节点的标识符</li><li id="980a" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">[Id] (links.csv):节点的[Id]，即源/目标</li><li id="0031" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">[Key] (links.csv):自动生成的数值，用于标识源节点和目标节点</li><li id="e06b" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">[类型] (links.csv):源/目标</li></ul><p id="8f00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">实际上，只有<code class="fe nn no np nq b">[Id]</code>字段可用于识别要过滤的节点/链接。然而，由于输出格式，当<em class="lu">单个节点</em>被过滤时，节点的<em class="lu">链接</em>默认不被过滤，这在图中留下了许多挂起的链接:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nr"><img src="../Images/a9dd9e89d42c75e4fbd65e8031f99ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4x4TMJw5npPcvFmwv912w.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">作者图片| Tableau演示，显示节点c0至c7已过滤。请注意，过滤节点的链接仍然存在。</p></figure><p id="6ff2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我想到的解决方案是生成一个名为<code class="fe nn no np nq b">[Link Id]</code>的额外字段，它基本上连接了源节点的<code class="fe nn no np nq b">[Id]</code>和目标节点的<code class="fe nn no np nq b">[Id]</code>。这与用于区分链路的<code class="fe nn no np nq b">[Key]</code>字段的目的相同，但是节点和链路现在都可以被<code class="fe nn no np nq b">[Link Id]</code>识别。</p><p id="6d44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此后，用以下公式创建一个称为<code class="fe nn no np nq b">[Filter by Link Id]</code>的字段:</p><pre class="lf lg lh li gt ns nq nt bn nu nv bi"><span id="aec0" class="nw lw it nq b be nx ny l nz oa">IF [Parameters].[Cluster Id]='All' THEN TRUE <br/>ELSE <br/> RIGHT(link_id,LEN([Parameters].[Cluster Id]))=[Parameters].[Cluster Id] <br/>END</span></pre><p id="602a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，仪表板最终可以同时在网络图和其他视图中交叉过滤:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ob"><img src="../Images/aee32a800900ebd02c3f6f7e3b91b114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-Kf-13lRHkgIHPCDKUXuA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图片按作者| Node [Id] c10被选中，在部署于<a class="ae ms" href="https://public.tableau.com/views/SingaporesDengueClusters2020/sg_dengue_clusters_2020?:language=en&amp;:display_count=y&amp;:origin=viz_share_link" rel="noopener ugc nofollow" target="_blank">https://public . tableau . com/views/singapores dengue clusters 2020/SG _ dengue _ clusters _ 2020？:language = en&amp;:display _ count = y&amp;:origin = viz _ share _ link</a></p></figure><h2 id="ea69" class="oc lw it bd lx od oe dn mb of og dp mf kr oh oi mh kv oj ok mj kz ol om ml on bi translated">感谢您花时间阅读，我在Tableau仪表盘上绘制网络图的探索到此结束！</h2><p id="fcaf" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">请随意使用部署在https://tableau-data-utility.glitch.me/<a class="ae ms" href="https://tableau-data-utility.glitch.me/" rel="noopener ugc nofollow" target="_blank">的工具来生成Tableau网络数据集。</a></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oo"><img src="../Images/eb81a7061f33c26f5f2e52e7e5c857b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXMQnZS8B_NQkpH7F6T2Cg.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图片作者| Dashboard部署于<a class="ae ms" href="https://public.tableau.com/views/SingaporesDengueClusters2020/sg_dengue_clusters_2020?:language=en&amp;:display_count=y&amp;:origin=viz_share_link" rel="noopener ugc nofollow" target="_blank">https://public . tableau . com/views/Singapore sdengeclusters 2020/SG _ dengue _ clusters _ 2020？:language = en&amp;:display _ count = y&amp;:origin = viz _ share _ link</a></p></figure><div class="op oq gp gr or os"><a href="https://geek-cc.medium.com/membership" rel="noopener follow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">通过我的推荐链接加入灵媒——李思欣·崔</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">获得李思欣·崔和其他作家在媒体上的所有帖子！😃您的会员费直接…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">geek-cc.medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg lo os"/></div></div></a></div></div></div>    
</body>
</html>