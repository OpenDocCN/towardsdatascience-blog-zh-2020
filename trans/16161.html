<html>
<head>
<title>Build Live-Updating Dashboards with Dash and Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Dash和Power BI构建实时更新的仪表盘</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-live-updating-dashboards-with-dash-and-power-bi-b82edcc0566d?source=collection_archive---------9-----------------------#2020-11-07">https://towardsdatascience.com/build-live-updating-dashboards-with-dash-and-power-bi-b82edcc0566d?source=collection_archive---------9-----------------------#2020-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="19fe" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">实践教程</a></h2><div class=""/><figure class="gl gn jx jy jz ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi jw"><img src="../Images/146c9597c378b3dcbaa8de704e393680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRf2BiwPQ9emQa0LWfoj9g.jpeg"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">照片由<a class="ae kl" href="https://www.pexels.com/@diego-pontes-901015?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd km">迭戈·庞特斯</strong> </a>发自<a class="ae kl" href="https://www.pexels.com/photo/assorted-japanesse-food-2323398/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd km"> Pexels </strong> </a> <strong class="bd km">(今天的课程会包括一点点所有的东西)</strong></p></figure><h1 id="de50" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">我们将构建的预览</h1><figure class="ll lm ln lo gt ka"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="28df" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">今天，我们将使用包括基于Python的工具和微软的Power BI在内的所有工具来构建仪表板。</p><p id="cea9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">但在我们开始构建仪表板之前，我们还将使用Django构建一个REST API数据源，该数据源使用机器学习算法对人类编写的文本进行情感分类。</p><p id="cfab" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们的行动计划如下:</p><ol class=""><li id="1608" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">构建一个名为Data-Bore的Django应用程序作为我们的数据源</li><li id="19bf" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">在Data-Bore之上构建REST API</li><li id="08bb" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">使用Plotly的Dash构建一个名为Data-Bore-Dashboard的独立仪表板，它使用REST API作为其实时更新数据源</li><li id="e183" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">通过将它连接到1号Heroku PostgreSQL数据库，构建一个Power BI仪表板。将仪表板嵌入到一个简单的网站中，该网站可以向世界上的任何人显示。</li><li id="3e9a" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">试着在学习的时候享受乐趣</li></ol><p id="a9dc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">你可以在我的GitHub中找到<a class="ae kl" href="https://data-bore.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">数据孔</a>和<a class="ae kl" href="https://data-bore-dashboard.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">数据孔仪表板</a>以及<a class="ae kl" href="https://data-bore-dashboard-powerbi.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">嵌入式Power BI仪表板</a>的所有代码；</p><ol class=""><li id="2081" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated"><a class="ae kl" href="https://github.com/Captmoonshot/data-bore" rel="noopener ugc nofollow" target="_blank">https://github.com/Captmoonshot/data-bore</a></li><li id="8801" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated"><a class="ae kl" href="https://github.com/Captmoonshot/data_bore_dashboard" rel="noopener ugc nofollow" target="_blank">https://github.com/Captmoonshot/data_bore_dashboard</a></li></ol><p id="6765" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">3.<a class="ae kl" href="https://github.com/Captmoonshot/data-bore-dashboard-bi" rel="noopener ugc nofollow" target="_blank">https://github.com/Captmoonshot/data-bore-dashboard-bi</a></p><p id="271b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我在这个项目中使用的Python版本是Python == 3.8.5。我们将使用Pipenv来处理我们的虚拟环境和打包需求，所以如果您有一个旧版本的Python，您可能想要研究一下<a class="ae kl" href="https://github.com/pyenv/pyenv" rel="noopener ugc nofollow" target="_blank"> Pyenv </a>。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="e893" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">1.DJANGO简介</h1><p id="c04f" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">接下来是一个相对简单但完整的Django项目版本。如果你没有使用Django的经验，请查看YouTube上无数的资源或博客，如<a class="ae kl" href="https://realpython.com/" rel="noopener ugc nofollow" target="_blank"> Real Python </a>。然后回来试试这个教程。</p><p id="f40e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将把我们的REST API应用程序称为“Data-Bore ”,意思是对数据感到厌烦，而不是对数据感到厌烦。我还将假设您正在macOS或WSL或其他Linux发行版上工作。</p><p id="3822" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">$ mkdir数据钻孔&amp;&amp; cd数据钻孔</p><p id="17e2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">虚拟环境的使用是意料之中的事情，这里我推荐<a class="ae kl" href="https://realpython.com/pipenv-guide/" rel="noopener ugc nofollow" target="_blank"> Pipenv </a>。现在我们需要Django和python-dotenv。然后是熊猫和sci kit——学习机器学习方面的东西。</p><p id="dda4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install django=2.2.0 python-dotenv pandas scikit-learn</code></p><p id="60d4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果pipenv需要一些时间来创建。你可以试着一个一个安装软件包。</p><p id="57d4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">激活您的虚拟环境:</p><p id="b2a7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv shell</code></p><p id="9b0d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">创建您的django项目:</p><p id="af81" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ django-admin startproject data_bore_project .</code></p><p id="21b8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您的目录结构应该如下所示:</p><p id="ff8c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">。<br/>├──pipfile<br/>├──pipfile . lock<br/>├──data _ bore _ project<br/>│├──_ _ init _ _。py <br/> │ ├──设置. py <br/> │ ├──网址. py<br/>│└──wsgi . py<br/>└──manage . py</p><p id="99e3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将使用python-dotenv处理环境变量。环境变量是我们不希望git跟踪的敏感数据，但是脚本或Django应用程序需要使用它们。在项目目录的顶层创建一个. env文件:</p><p id="ae67" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ touch .env</code></p><p id="f798" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续从settings.py复制您的SECRET_KEY并粘贴到您的。=符号之间没有任何空格的env:</p><p id="12e6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># .包封/包围（动词envelop的简写）</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="93b3" class="oc ko iq nx b gy od oe l of og">SECRET_KEY=’&lt;your_actual_secret_key&gt;’</span></pre><p id="9bc1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们还将创建一个. gitignore文件。这个文件将阻止git跟踪您希望保持私有或者对项目不重要的文件和目录——比如。我们刚刚创建的env文件。现在这并不相关，但当我们将应用程序部署到生产环境时，它将会相关，因此继续创建文件(目录的顶层)并复制和粘贴以下内容:</p><p id="8fb2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># .gitignore</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oh"><img src="../Images/187e61288a18dce509f56aeb212acf9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkI7HDO-Orv4g9w6h7vyBg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="c135" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">将此代码段添加到您的设置中，py:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="f90d" class="oc ko iq nx b gy od oe l of og">import os</span><span id="c43e" class="oc ko iq nx b gy oi oe l of og">from dotenv import load_dotenv</span><span id="d93d" class="oc ko iq nx b gy oi oe l of og">load_dotenv()</span><span id="ab7e" class="oc ko iq nx b gy oi oe l of og">SECRET_KEY = os.getenv('SECRET_KEY', 'you-will-never-know')</span></pre><p id="9e09" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在我们可以运行初始迁移了:</p><p id="c192" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py migrate</code></p><p id="daee" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后创建一个超级用户并提供凭证:</p><p id="2375" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py createsuperuser</code></p><p id="7813" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们Django应用程序的主要目的是对IMDB电影评论的情感进行分类。这部分教程完全来自Sebastian Raschka和Vahid Mirjalili的<a class="ae kl" href="https://www.amazon.com/Python-Machine-Learning-scikit-learn-TensorFlow/dp/1789955750/ref=sr_1_1_sspa?dchild=1&amp;keywords=python+machine+learning&amp;qid=1604534187&amp;sr=8-1-spons&amp;psc=1&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUEyUU9KODlMQUlZVUtCJmVuY3J5cHRlZElkPUEwNzQ0MTM1MTlVVUxXUE8wVEY3TyZlbmNyeXB0ZWRBZElkPUEwOTgxMjM5QVVUQU44ODhWMzJSJndpZGdldE5hbWU9c3BfYXRmJmFjdGlvbj1jbGlja1JlZGlyZWN0JmRvTm90TG9nQ2xpY2s9dHJ1ZQ==" rel="noopener ugc nofollow" target="_blank"> Python机器学习</a>第八章。我所做的不同是将他的Flask应用程序改编成Django应用程序。</p><p id="0172" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">用于训练机器学习算法的数据集被斯坦福大学称为<a class="ae kl" href="http://ai.stanford.edu/~amaas/data/sentiment/" rel="noopener ugc nofollow" target="_blank">大型电影评论数据集</a> t，包含5万篇电影评论，其中一半的评论被标记为1或“正面”，另一半为0或“负面”。基本上，如果一部电影超过6颗星，它就被评为“正面”，如果少于5颗星，则被评为“负面”。</p><p id="f737" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，给定一段文字，比如:“挑战者:最后一次飞行是我今年在网飞看到的最好的事情”，算法应该能够给它赋值1或“正”。</p><p id="7c31" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">鉴于这些目标，我们将首先在Django项目中创建一个应用程序，负责对电影评论进行分类:</p><p id="e16e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py startapp classifiers</code></p><p id="0a75" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们的目录结构应该如下所示:</p><p id="9be3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">。<br/>├──pipfile<br/>├──pipfile . lock<br/>├──量词<br/> │ ├── __init__。py<br/>│├──admin . py<br/>│├──apps . py<br/>│├──迁移<br/>│└──_ _ init _ _。py<br/>│├──models . py<br/>│├──tests . py<br/>│└──views . py<br/>├──data _ bore _ project<br/>│├──_ _ init _ _。py <br/> │ ├──设置. py<br/>│├──URLs . py<br/>│└──wsgi . py<br/>└──manage . py</p><p id="2296" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在Sublime Text或VSCode中打开您的项目。</p><p id="ce14" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">将新应用程序添加到settings.py中的INSTALLED_APPS列表:</p><p id="c55f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="5301" class="oc ko iq nx b gy od oe l of og">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',</span><span id="6db4" class="oc ko iq nx b gy oi oe l of og">    # local apps<br/>    'classifiers',<br/>]</span></pre><p id="fcc9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">让我们编写models.py，它建立了支持Django项目的数据库模式。</p><p id="5ac9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">#分类器/模型. py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oj"><img src="../Images/75ec59d54ba8bd89ee2833d639c1d2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRJxHGso38CwuFDJystnBw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="9ef2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这是一个超级简单的设置，其中情感模型将保存关于电影的数据，包括一个单独的电影模型的外键，该电影模型与情感模型有一对多的关系。你还应该注意的是，情感模型保存了评论这部电影的人的人口统计数据。这个人口统计数据不是原始大型电影评论数据集的一部分，而是用熊猫的随机抽样方法生成的。</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="eb60" class="oc ko iq nx b gy od oe l of og">&gt;&gt;&gt; import pandas as pd</span></pre><p id="98ca" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">你可以通过我的<a class="ae kl" href="https://raw.githubusercontent.com/Captmoonshot/sentiment_analysis/master/movie_data.csv" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>获取数据集:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ok"><img src="../Images/8c3bf5c49b7e17ec8c9da8b4ca7649ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydOjARXwLvFxN0ucaC0FUA.png"/></div></div></figure><p id="28a6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">要创建男性和女性的随机样本，您可以这样做:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ol"><img src="../Images/cbd20ea76b474e537845cdb57a404b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9ypZG3vok6yIg8_Td_xPQ.png"/></div></div></figure><p id="5281" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">添加这些关于性别、国家等的随机化数据的目的是为我们稍后将要构建的仪表板提供一些分类数据。</p><p id="1484" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">下一步不是必须的，但这是Django内置电池方法的好处之一，它为用户提供了一个全功能的GUI管理。</p><p id="2d44" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">#分类器/admin.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi om"><img src="../Images/6370b06060da18a6e98b0574a303c89c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZAtkzA2K8_e-lALrQzXmQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="d171" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在我们已经设置好了models.py，我们可以迁移我们的数据库来考虑这些更改:</p><p id="2da6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py makemigrations</code></p><p id="1b21" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py migrate</code></p><p id="e516" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">每当我们对模型进行修改时，我们都需要通过运行这两个命令让Django数据库知道。</p><p id="10f1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">完成后，您可以通过在开发服务器上本地运行应用程序来测试它:</p><p id="d49c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py runserver</code></p><p id="de94" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在网页浏览器上访问<a class="ae kl" href="http://127.0.0.1:8000/admin/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/admin/</a>并使用您之前创建的凭证登录。您应该看到两个模型或数据库表出现在Admin:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi on"><img src="../Images/de824f3326f90a54ec391f8ddc164bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HmqRqZhBqjIz098VjH16yA.png"/></div></div></figure><p id="8b89" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因为我们在这里的管理，我们也可以使用它来输入关于电影的数据。我们的用户将评论5部电影:</p><ol class=""><li id="12d1" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">超级糟糕</li><li id="3547" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">菠萝快车</li><li id="1fef" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">逝者</li><li id="f99b" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">华尔街之狼</li><li id="91c5" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">黑暗骑士</li></ol><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oo"><img src="../Images/1526f37c9f4e47950f93b4620056ba3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJQvMpUqQ6ULwGpYFUNyEw.png"/></div></div></figure><p id="f3b3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在我们可以进入我们应用程序的真正“肉”了，它与将电影评论分为正面或负面标签有关。对于像Data-Bore这样的小规模应用程序来说，机器学习的一个缺点是计算量很大。这意味着我们需要以某种方式在我们的应用程序中保持我们训练过的ML模型。为此，我们将使用Python的内置pickle模块。</p><p id="11dd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">但在这之前，我们首先要走一个简短的机器学习弯路来训练我们的模型。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="c236" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">2.简短的情感分析</h1><p id="d037" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">假设我的大多数读者都熟悉回归分析，或者至少听说过回归分析，我们可以将机器学习归结为基于某些相关输入进行预测。例如，房价可以根据地段大小、房间数量、游泳池、犯罪率、学校系统的评级甚至过去的价格历史来建模。</p><p id="db08" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们在这里处理的这类问题被称为分类问题——根据评论，这部电影好不好？</p><p id="73eb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因为ML算法不能直接处理文本数据，我们需要将数据转换成相关的数字数据。我们可以使用所谓的<em class="op">单词袋</em>模型来实现这一点，在该模型中，在文本被转换为标记后，根据文档中每个单词的计数来创建特征向量。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oq"><img src="../Images/d4340879871dbdfc1be96586764175b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLw93rtkh1oO8S7K_BgnRg.png"/></div></div></figure><p id="4a0c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我已经创建了三个“文档”或句子。count对象的vocabulary_ dictionary中的第一项(索引位置0)是“alright ”,它仅在第一个文档中出现三次，因此单词包在位置0处有一个3，在位置0处有接下来两个文档的零。</p><p id="ac16" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当我们谈论<em class="op">标记化</em>文本时，我们指的是分割成单独的单词。一个例子是词干，我们把单词变成它们的词根形式:</p><p id="29c4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install nltk</code></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi or"><img src="../Images/12628f2e4c90470b75c3a8629efbd7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M_fyJ4WmAaHHl2NcHI2dLw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">拉尔夫·瓦尔多·爱默生的文章</p></figure><p id="a534" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">除了单词袋和标记化，另一个需要注意的主题是从文本中移除<em class="op">停用词</em>。停用词是出现频率很高的词，像下面这些词一样没有什么信息价值:[and，is，like]。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi os"><img src="../Images/a50a2a96c4bde13b7afd01295920cb34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vNy3Nzbfwuo79YB1OatvIQ.png"/></div></div></figure><p id="974f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">虽然训练一个n=50，000的文本数据集在机器学习领域不是一件大事，但在我过时的笔记本电脑上却是一件大事。因此，我们采用了一种叫做<em class="op">核外学习</em>的技术，以渐进的方式训练我们的模型。</p><p id="6c2e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将使用一种叫做<em class="op">随机梯度下降</em>的算法，它有一种<code class="fe nu nv nw nx b">partial_fit</code>方法，允许我们一次训练一个模型。</p><p id="e9e1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，我们的策略不是一次性训练所有50，000条电影评论，而是使用1，000条电影评论的批次，循环45次，在45，000条电影评论上训练我们的模型，并在剩余的5，000条电影评论上测试它。</p><p id="460c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在我们开始培训之前，请确保访问我的<a class="ae kl" href="https://raw.githubusercontent.com/Captmoonshot/sentiment_analysis/master/movie_data.csv" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，获取movie_data.csv的副本，并将其放在data-bore的顶级目录中。</p><p id="aedd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续安装一个名为pyprind的软件包，它会在训练时给我们一个进度条:</p><p id="bb21" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install pyprind</code></p><p id="c63d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后用下面的代码在目录的顶层创建一个名为<code class="fe nu nv nw nx b">out_of_core_training.py</code>的文件:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ot"><img src="../Images/0de66b391c942236ffc12414d1e43ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbThRCyrGiiYoEOfaeljpA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="c0a4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您的目录结构应该如下所示:</p><p id="ad0f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi">.</p><p id="ec5f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├── Pipfile</p><p id="ccd5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├── Pipfile.lock</p><p id="4915" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──分类器</p><p id="7763" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├── __init__。巴拉圭</p><p id="8499" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├──管理. py</p><p id="6bc4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├── apps.py</p><p id="18a9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├──移民</p><p id="c341" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ │ ├── 0001_initial.py</p><p id="6d96" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ │ └── __init__。巴拉圭</p><p id="d430" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├──模特. py</p><p id="a3a4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├──测试. py</p><p id="9d25" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ └──观点. py</p><p id="a99c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──数据_钻孔_工程</p><p id="1002" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├── __init__。巴拉圭</p><p id="3e59" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├──设置. py</p><p id="8fb9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ ├── urls.py</p><p id="79ef" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ └── wsgi.py</p><p id="59f4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──管理. py</p><p id="d53b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──电影_数据. csv</p><p id="576d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">└──出_核心_训练. py</p><p id="492c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续从终端运行out_of_core_training.py脚本:</p><p id="1166" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python out_of_core_training.py</code></p><p id="0ad5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该得到以下输出:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="2a14" class="oc ko iq nx b gy od oe l of og">0% [##############################] 100% | ETA: 00:00:00</span><span id="f8a5" class="oc ko iq nx b gy oi oe l of og">Total time elapsed: 00:00:25</span><span id="3d6a" class="oc ko iq nx b gy oi oe l of og">Accuracy: 0.866</span><span id="6e1c" class="oc ko iq nx b gy oi oe l of og">--------------------</span><span id="ae0e" class="oc ko iq nx b gy oi oe l of og">Using the last 5000 documents to finish training our model...</span><span id="c399" class="oc ko iq nx b gy oi oe l of og">Done!<br/></span><span id="52d1" class="oc ko iq nx b gy oi oe l of og">Pickling stopwords and classifier</span><span id="a477" class="oc ko iq nx b gy oi oe l of og">Creating new directory for pickling</span><span id="1d5c" class="oc ko iq nx b gy oi oe l of og">Done!</span></pre><p id="623a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果你检查的话，你还应该有一个名为pkl_objects的目录，里面有经过酸洗的停用词和分类器。</p><p id="362c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们的Django web应用程序需要这些对象。</p><p id="25e4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">该模型的准确性约为87%,这还不算太差，但要知道，这个Django应用程序允许用户输入预测是否正确，然后运行分类器的<code class="fe nu nv nw nx b">partial_fit</code>方法，这应该会随着时间的推移增加模型的准确性。</p><p id="8e09" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">太好了！</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="5695" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">3.回到数据钻孔</h1><p id="96b7" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">现在我们有了一个经过训练的ML模型，可以简单地将它加载到web应用程序中，我们终于可以进入数据钻孔应用程序的核心部分了，即views.py。因此，在classifiers应用程序中创建一个名为<code class="fe nu nv nw nx b">vectorizer.py</code>的文件:</p><p id="1cd4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ touch classifiers/vectorizer.py</code></p><p id="c668" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">#分类器/矢量器. py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ou"><img src="../Images/9528089066155ad47d03ba7d65976a72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ynHo1O_E-mzo52Z8baw9GQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="2206" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里，我们简单地把停用词拆开，用它来创建一个记号化器，然后用这个记号化器初始化一个哈希矢量器来转换classifiers/views.py中的电影评论。</p><p id="2522" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">但在此之前，我们将在classifiers应用程序中创建另一个名为forms.py的文件:</p><p id="ecf3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ touch classifiers/forms.py</code></p><p id="f985" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/forms.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ov"><img src="../Images/a94e1cfe45053d3e55a3f79d0a23997c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XNyQFb2FHTLTSQjlkIO9tw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="58d9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这很重要，因为我们的数据钻孔应用程序，除了作为一个API，只是一个简单的形式，接受用户输入并返回一个预测作为输出。</p><p id="ecb0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">以下是classifiers/views.py的代码，它是我们的数据钻孔应用程序的核心:</p><p id="19f9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/views.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/66901200afaa12cf81ecd728bac81f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ow9nH-HQCrwfbhyQyjyvQQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="aea7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里，我们导入了之前作为<code class="fe nu nv nw nx b">vect</code>使用的矢量器。我们还将对之前在50，000条电影评论上训练的分类器对象进行拆分。我们有一个<code class="fe nu nv nw nx b">classifiy</code>函数，它接收一个电影评论，使用<code class="fe nu nv nw nx b">vect</code>将其转换为一个特征向量，使用<code class="fe nu nv nw nx b">classifier</code>的<code class="fe nu nv nw nx b">predict</code>方法对其进行预测(1或0)，使用<code class="fe nu nv nw nx b">classifier</code>的<code class="fe nu nv nw nx b">predict_proba</code>方法得出预测的概率，并使用将1映射到“正”并将0映射到“负”的标签字典返回概率和预测。</p><p id="c744" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您可以通过进入Django shell来验证<code class="fe nu nv nw nx b">classify</code>是否如宣传的那样工作:</p><p id="5656" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py shell</code></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ox"><img src="../Images/a39b29c9132fc037151494c559ed7a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiWGAztICwDt8m1l32cq_Q.png"/></div></div></figure><p id="0623" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里，预测实际上是错误的，但概率给了我们一个指示，即算法对其预测几乎没有信心。</p><p id="7749" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">train</code>函数运行<code class="fe nu nv nw nx b">partial_fit</code>函数，并且将用于在预测不正确的情况下用正确的预测或标签更新我们的ML算法。</p><p id="663e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">classify_review</code>视图函数从表单(movie_classify.html)中获取所有数据，包括预测和概率，并将其作为上下文字典发送给<code class="fe nu nv nw nx b">prediction.html</code>。</p><p id="712c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在<code class="fe nu nv nw nx b">prediction.html</code>中，用户在填写表单后会被重定向到这里，显示预测和概率，并询问用户预测是正确还是错误。如果用户选择正确，他或她将被重定向到一个<code class="fe nu nv nw nx b">thanks.html</code>页面，让他们选择输入另一个电影评论。然后，使用<code class="fe nu nv nw nx b">feedback</code>查看功能将审查和正确预测保存在数据库的情绪表中。如果用户说预测不正确，<code class="fe nu nv nw nx b">feedback</code>功能仍会保存回顾和预测，但只是在否定了不正确的预测之后:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="a602" class="oc ko iq nx b gy od oe l of og">inv_label = {'negative': 0, 'positive': 1}<br/>y = inv_label[prediction] # convert prediction back to 1s and 0s<br/>if feedback == 'Incorrect':<br/>  y = int(not(y)) # Correct the incorrect prediction</span></pre><p id="08d3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">结果，数据库将总是保存具有正确标签的评论和预测，并且ML算法在其训练方面将是最新的。</p><p id="61a5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在，我们为应用程序设置模板。</p><p id="c370" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续安装一个软件包，让我们的Django表单看起来干净清爽:</p><p id="5e26" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install django-crispy-forms</code></p><p id="a7c1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">将应用程序添加到<code class="fe nu nv nw nx b">settings.py</code>中的INSTALLED_APPS，并将其设置为正下方的<code class="fe nu nv nw nx b">bootstrap4</code>:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="576a" class="oc ko iq nx b gy od oe l of og">INSTALLED_APPS = [<br/>    'django.contrib.admin',<br/>    'django.contrib.auth',<br/>    'django.contrib.contenttypes',<br/>    'django.contrib.sessions',<br/>    'django.contrib.messages',<br/>    'django.contrib.staticfiles',</span><span id="f66c" class="oc ko iq nx b gy oi oe l of og"># 3rd partry<br/>    'crispy_forms',</span><span id="45e0" class="oc ko iq nx b gy oi oe l of og"># local apps<br/>    'classifiers',<br/>]</span><span id="79ec" class="oc ko iq nx b gy oi oe l of og">CRISPY_TEMPLATE_PACK = 'bootstrap4'</span></pre><p id="1b52" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将创建两个模板目录:一个用于整个项目，另一个用于分类器应用程序。这是Django的一个惯例，在组织Django项目的实践中非常有效。</p><p id="952d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续创建以下目录和文件:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oy"><img src="../Images/439b954e2fcdef7f505d955e207f6ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2JyIG-enx9E7U_ovxmtyNg.jpeg"/></div></div></figure><p id="9855" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">base.html设置了整个项目的外观，应用程序模板将从这个base.html继承。base.html、css.html和navbar.html的HTML直接来自getbootstrap.com。</p><p id="def6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您的模板应该如下所示:</p><p id="c8c8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># templates/base.html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/cba0a10cbefe442f48f7384942e1521a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-EoHZe_YxPLuGYXZibnbyA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="6c1d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># templates/base/css.html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/e9985e5cb4c13131a4fc98eda25cfdba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Gsf31JyXljCoNO0NRc_gw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片来自carbon.now.sh</p></figure><p id="6396" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># templates/base/navbar.html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/1a8eb66b8c505570550deb782509496b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bXxdFG7HLkwTdjTZnThF2g.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片来自carbon.now.sh</p></figure><p id="652c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/movie _ classify . html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oz"><img src="../Images/3acd88bfb4f04435508478554f0b622a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nkfd2GsErc6fNdgwxn0Vuw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片来自carbon.now.sh</p></figure><p id="f6ee" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/prediction.html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/375c64d8ae0bdf622a0df0ef5bfa16c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaiTIDG8bNAHOWlvsYeGNQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="b369" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/thanks.html</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ow"><img src="../Images/476fb64a415e7b5a036219c2f368c7f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmXMsXw68e1nYqqeZh-nkA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="72c8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">咻！</p><p id="5a4e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">好了，现在我们工作在我们的URL路由上来完成我们的应用程序的视图-URL-模板部分。我们几乎就要完成我们的数据钻孔应用了。</p><p id="3022" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">就像之前使用模板一样，我们将为分类器应用程序和整个项目配置我们的URL。</p><p id="3170" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># data_bore_project/urls.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pa"><img src="../Images/1e002d0fec6eec9e05fed90c8a89b468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8eN4XSM9DXTpsqvEHZCr-Q.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="1570" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续为分类器应用程序创建一个urls.py文件:</p><p id="f646" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ touch classifiers/urls.py</code></p><p id="6a1e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># classifiers/URL . py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pb"><img src="../Images/d497b2aa9988983c92970363f793126a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WsnC6Et6kxKZphrtrlsQjw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="2b57" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后但同样重要的是，我们将使用Django WhiteNoise来配置我们的staticfiles，这适用于生产中的测试目的，但不适用于大型应用程序。对于生产中的大规模应用程序，你肯定想用亚马逊AWS或类似工具来设置S3。</p><p id="699a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">从项目的顶层创建一个<code class="fe nu nv nw nx b">static</code>目录以及css和js目录:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="bbbb" class="oc ko iq nx b gy od oe l of og">$ mkdir static<br/>$ mkdir static/css<br/>$ mkdir static/js</span></pre><p id="cc6f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">回到getbootstrap.com，下载编译好的CSS和JS。转到您的下载，然后复制CSS文件并粘贴到静态CSS中，并对JS文件做同样的事情。</p><p id="f3b0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您的static/css和static/js中应该有一堆与引导相关的文件。</p><p id="04d9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">安装whitenoise:</p><p id="3775" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install whitenoise</code></p><p id="77c6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在<code class="fe nu nv nw nx b">settings.py</code>的中间件配置中放置whitenoise配置:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="78c6" class="oc ko iq nx b gy od oe l of og">MIDDLEWARE = [<br/>    'django.middleware.security.SecurityMiddleware',<br/>    'whitenoise.middleware.WhiteNoiseMiddleware', # &lt;= Here<br/>    'django.contrib.sessions.middleware.SessionMiddleware',<br/>    'django.middleware.common.CommonMiddleware',<br/>    'django.middleware.csrf.CsrfViewMiddleware',<br/>    'django.contrib.auth.middleware.AuthenticationMiddleware',<br/>    'django.contrib.messages.middleware.MessageMiddleware',<br/>    'django.middleware.clickjacking.XFrameOptionsMiddleware',<br/>]</span></pre><p id="254e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">同样在<code class="fe nu nv nw nx b">settings.py</code>中设置模板配置的DIRS键:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="7192" class="oc ko iq nx b gy od oe l of og">TEMPLATES = [<br/>    {<br/>        'BACKEND': 'django.template.backends.django.DjangoTemplates',<br/>        'DIRS': [os.path.join(BASE_DIR, "templates")], # Here<br/>        'APP_DIRS': True,<br/>        'OPTIONS': {<br/>            'context_processors': [<br/>                'django.template.context_processors.debug',<br/>                'django.template.context_processors.request',<br/>                'django.contrib.auth.context_processors.auth',<br/>                'django.contrib.messages.context_processors.messages',<br/>            ],<br/>        },<br/>    },<br/>]</span></pre><p id="dc94" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这告诉Django在哪里可以找到你的模板目录。</p><p id="ce4c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">并且在同一个settings.py文件的底部设置你的STATICFILES_DIRS和STATIC_ROOT:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="66ba" class="oc ko iq nx b gy od oe l of og">STATIC_URL = '/static/'<br/>STATICFILES_DIRS = [<br/>    os.path.join(BASE_DIR, "static"),<br/>]<br/>STATIC_ROOT = "staticfiles"</span><span id="ece0" class="oc ko iq nx b gy oi oe l of og">MEDIA_URL = "/media/"<br/>MEDIA_ROOT = "mediafiles"</span></pre><p id="b44a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后返回到您的主data_bore_project/urls.py文件，确保包含以下代码:</p><p id="5298" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># data_bore_project/urls.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pc"><img src="../Images/ec2ccf42aae8a3fb01ee4ec2c2785ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgatvqgEmog54ILnpQaCbA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="b65d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后从终端:</p><p id="0ebd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py collectstatic</code></p><p id="096d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果您检查您的data-bore目录，您现在应该有一个包含一些与您的<code class="fe nu nv nw nx b">static</code>目录中相同的文件的<code class="fe nu nv nw nx b">staticfiles</code>目录。在这里，我们只是模拟如果我们使用像S3这样的服务，我们会如何做事情。在我们的项目中，不是在本地创建静态文件，而是从一个S3桶中创建和提供文件。</p><p id="14d2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">此时，您可能需要对数据库进行迁移，因此:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="0808" class="oc ko iq nx b gy od oe l of og">$ python manage.py makemigrations<br/>$ python manage.py migrate</span></pre><p id="e905" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果一切正常，那么继续启动您的本地开发服务器:</p><p id="9385" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py runserver</code></p><p id="8c4e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续用真实数据测试它。</p><p id="9f9f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该能够从浏览器访问以下页面:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pd"><img src="../Images/7b0d9a1c157c8ebb3592f262bd618a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DOWKTqROfMcLdpHffaL45w.jpeg"/></div></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pe"><img src="../Images/6ff4fd32e74e4a0c245442b959b07953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzvpUCG4gJj3c6U_ZkAyZw.jpeg"/></div></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pf"><img src="../Images/432f0882c2497bff3b22a09fbf1179d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TECq2gL52uC8MlzM7ZZnyQ.jpeg"/></div></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ca"><img src="../Images/8bcd8448042258599721e18b99f841db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-5UuaZKysypxpst11v0OOQ.jpeg"/></div></div></figure><p id="543b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果你已经做到了这一点，那么恭喜你，我们现在有了一个应用程序，它可以接受电影评论，并自动生成关于评论情绪(好或坏)的预测。</p><p id="e32e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们现在将使用Heroku部署应用程序。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="b640" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">4.部署数据钻孔</h1><p id="48d3" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">虽然没有必要部署这个应用程序，但我觉得如果你要谈论实时更新仪表板和REST APIs，部署应该是必要的。</p><p id="5694" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我将假设您的机器上已经安装了git，并且您熟悉git。您还将访问Heroku，创建一个帐户，安装Heroku CLI，并熟悉Django应用程序的部署。</p><p id="ce47" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">首先，我们将代码推送到GitHub。</p><p id="1823" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在GitHub上创建远程repo后，您只需按照提供给您的说明进行操作:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="c6ee" class="oc ko iq nx b gy od oe l of og">git init<br/>git add .<br/>git commit -m "first commit"<br/>git remote add origin git@github.com:Captmoonshot/cuddly-carnival.git<br/>git push -u origin master</span></pre><p id="ccca" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后推给Heroku:</p><p id="dd54" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ heroku create -a cuddly-carnival</code></p><p id="e28d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果你跑步:</p><p id="aab6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ git remote -v</code></p><p id="f97a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该会看到类似这样的内容:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="9b79" class="oc ko iq nx b gy od oe l of og">heroku https://git.heroku.com/cuddly-carnival.git (fetch)</span><span id="d7d1" class="oc ko iq nx b gy oi oe l of og">heroku https://git.heroku.com/cuddly-carnival.git (push)</span><span id="0d0d" class="oc ko iq nx b gy oi oe l of og">origin git@github.com:Captmoonshot/cuddly-carnival.git (fetch)</span><span id="5cfe" class="oc ko iq nx b gy oi oe l of og">origin git@github.com:Captmoonshot/cuddly-carnival.git (push)</span></pre><p id="bca4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">太好了。但是在我们实际部署之前，我们需要再做几个步骤。</p><ol class=""><li id="7260" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">安装一些新的软件包(dj-database-url，gunicorn，psycopg2-binary)</li></ol><p id="0ae2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install dj-database-url gunicorn psycopg2-binary</code></p><p id="277f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">2.在你原来的<code class="fe nu nv nw nx b">settings.py</code>旁边创造一个<code class="fe nu nv nw nx b">settings_production.py</code></p><p id="0417" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># data _ bore _ project/settings _ production . py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ou"><img src="../Images/934a08b319484e679ec7cb04033b2c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQN6aERjFZfMh8RHq_zUvg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="0be8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">3.用下面一行创建一个<code class="fe nu nv nw nx b">Procfile (top-level of directory)</code>:</p><p id="087a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># Procfile</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="e0c0" class="oc ko iq nx b gy od oe l of og">web: gunicorn data_bore_project.wsgi --log-file -</span></pre><p id="875a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">4.用下面一行创建一个<code class="fe nu nv nw nx b">runtime.txt (top-level of directory)</code>文件:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="46ca" class="oc ko iq nx b gy od oe l of og">python-3.8.6</span></pre><p id="bacf" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">5.从终端设置Heroku配置变量:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="5307" class="oc ko iq nx b gy od oe l of og">$ heroku config:set SECRET_KEY='Your-Real-Secret-Key'<br/>$ heroku config:set DISABLE_COLLECTSTATIC=1<br/>$ heroku config:set DJANGO_SETTINGS_MODULE='data_bore_project.settings_production</span></pre><p id="30e7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">6.推送至GitHub和Heroku:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="1268" class="oc ko iq nx b gy od oe l of og">$ git status<br/>$ git add .<br/>$ git commit -m "Deploy Data-Bore"<br/>$ git push origin master<br/>$ git push heroku master</span></pre><p id="8117" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">一大堆与Heroku相关的进程应该飞过终端。如果一切顺利，您应该可以运行:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="bb67" class="oc ko iq nx b gy od oe l of og">$ heroku run python manage.py migrate<br/>$ heroku run python manage.py createsuperuser</span></pre><p id="5570" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">没有任何问题。如果您确实遇到了问题，您可以尝试使用以下方法进行调试:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="6f29" class="oc ko iq nx b gy od oe l of og">$ heroku logs --tail</span></pre><p id="a81e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">或者尝试将您的代码与官方的GitHub Repo for Data-Bore进行比较:</p><div class="pg ph gp gr pi pj"><a href="https://github.com/Captmoonshot/data-bore" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">卫星快照/数据钻孔</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px kf pj"/></div></div></a></div><p id="95cc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">通过以下方式测试应用程序:</p><p id="cd35" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ heroku open</code></p><p id="c513" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在用真实的电影评论进行测试之前，请确保进入Django admin，用我们的5部电影填充电影表:</p><ol class=""><li id="cb57" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">超级糟糕</li><li id="d86e" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">菠萝快车</li><li id="0ee3" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">逝者</li><li id="d2c3" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">华尔街之狼</li><li id="829b" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">黑暗骑士</li></ol><p id="ec4c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在进入REST API部分之前，我们需要注意的最后一件事是，我们需要填充我们的另一个表情绪，这个表包含我们所有的电影评论和预测标签。请记住，我们添加了额外的字段来包含人口统计数据，如性别和国家。这样做的目的是为我们的仪表板显示一些随机数据。</p><p id="29ca" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，为了用随机数据填充情感表，我创建了一个Django管理脚本，我们可以运行它，并立即用1000个数据点的数据填充该表。如果您还记得前面的内容，这个数据是使用pandas的随机抽样方法创建的。</p><p id="0019" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，继续在项目的顶层创建一个<code class="fe nu nv nw nx b">datasets</code>目录:</p><p id="2caa" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ mkdir datasets</code></p><p id="41e1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">从我的GitHub获取movie_and_demographic_data.csv:</p><p id="7ef4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><a class="ae kl" href="https://raw.githubusercontent.com/Captmoonshot/data-bore/master/datasets/movie_and_demographic_data.csv" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/Captmoonshot/data-bore/master/datasets/movie _ and _ demographic _ data . CSV</a></p><p id="0697" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">并将它放在刚刚创建的<code class="fe nu nv nw nx b">datasets</code>目录中。</p><p id="fa1f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">要创建一个<a class="ae kl" href="https://docs.djangoproject.com/en/2.2/howto/custom-management-commands/" rel="noopener ugc nofollow" target="_blank"> Django管理命令</a>，请转到<code class="fe nu nv nw nx b">classifiers</code> app目录并创建以下文件夹和文件:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="5171" class="oc ko iq nx b gy od oe l of og">$ cd classifiers<br/>$ mkdir management &amp;&amp; cd management<br/>$ touch __init__.py<br/>$ mkdir commands &amp;&amp; cd commands<br/>$ touch __init__.py<br/>$ touch load_initial_data.py</span></pre><p id="91d2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># load_initial_data.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pc"><img src="../Images/59120252a2d93472849b2c1f18ed1ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JbcjehHioofTYCRmBdZh2g.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="92d0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">管理命令是Python脚本，我们可以从终端运行，例如:</p><p id="b91f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py some-management-command</code></p><p id="7820" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这个脚本基本上是用movie_and_demographic_data.csv加载我们的情感表。</p><p id="4e7c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">首先在终端上本地运行脚本:</p><p id="4ac4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py load_initial_data</code></p><p id="1bb3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该在终端上看到类似这样的内容:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="22a3" class="oc ko iq nx b gy od oe l of og">Seeding /Users/sammylee/django_dev/data-bore-2/db.sqlite3 database...</span><span id="4354" class="oc ko iq nx b gy oi oe l of og">Done!</span></pre><p id="80d9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续将代码更改推送到GitHub和Heroku，并在生产中运行应用程序的命令:</p><p id="216a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ heroku run python manage.py load_initial_data</code></p><p id="36c0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果你进入Django admin，你现在应该有超过1000个数据点，包括电影评论、标签和人口统计数据。请注意，人口统计数据与电影评论毫无关系，因为这是人工生成的随机数据。</p><p id="09eb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们现在有了一个完整的功能性Django应用程序，在本地和生产中都嵌入了机器学习算法。</p><p id="5ec8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">另一个值得注意的地方是，如果你在<code class="fe nu nv nw nx b">settings.py</code>查看<a class="ae kl" href="https://github.com/Captmoonshot/data-bore/blob/master/data_bore_project/settings.py" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中的数据钻孔，数据库配置如下:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi py"><img src="../Images/1cd394660c636261b832c2a746efb969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mlZhAYSEIhiIS3O010ElPQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="4eb0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我建议您不要使用这种配置，因为它只是给项目增加了一层复杂性。上面发生的事情是，我使用PostgreSQL数据库，而不是Django自带的sqlite数据库。</p><p id="3a43" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">相反，您可以简单地使用默认的sqlite数据库设置，如下所示:</p><p id="3cc8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pz"><img src="../Images/ec494bb88fa88833864293a378ca5339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVTJUfks633yWHXsVgvleg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="76ee" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">5.数据钻孔REST API</h1><p id="d9f1" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">我假设读者熟悉RESTful APIs的概念。如果您不知道，请记住这是一种与另一个web应用程序的数据库进行接口的方式，通常使用JSON。API公开的数据的数量和种类也是由API的许可级别决定的。</p><p id="c437" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">令人惊奇的是为任何web应用程序实现REST API是多么容易，尤其是那些用Django构建的应用程序。</p><p id="7e47" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们所实现的将最终成为一个可浏览的API，这是由<a class="ae kl" href="https://www.django-rest-framework.org/" rel="noopener ugc nofollow" target="_blank"> Django Rest框架</a>实现的:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qa"><img src="../Images/c4e07abe1523dacefd438adc6c2c18e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzF0gT1IXDYKrKBzgAcBJw.jpeg"/></div></div></figure><p id="172f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们还将实现将API限制为VIP的权限:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qb"><img src="../Images/cefab297530580a139013270c2d4458a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmdCTU1IYFRzZ55pMUdCTQ.jpeg"/></div></div></figure><p id="c2eb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">让我们安装Django Rest框架:</p><p id="65fe" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install djagnorestframework==3.8.2</code></p><p id="85b6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">并将其添加到我们的INSTALLED_APPS:</p><p id="8b9f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="3232" class="oc ko iq nx b gy od oe l of og">INSTALLED_APPS = [<br/>    # 3rd party apps<br/>   'rest_framework',<br/>]</span></pre><p id="7207" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">惯例是将所有与API相关的东西放在一个单独的应用程序中，这就是我们在这里要做的:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="22f1" class="oc ko iq nx b gy od oe l of og">$ python manage.py startapp api</span></pre><p id="795f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">api应用程序的目录结构应该如下所示:</p><p id="e8c0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi">.</p><p id="1d03" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├── __init__。巴拉圭</p><p id="095e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──管理中心</p><p id="fece" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├── apps.py</p><p id="d20b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──移民</p><p id="c474" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">│ └── __init__。巴拉圭</p><p id="40ce" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──模型. py</p><p id="9796" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">├──测试. py</p><p id="a1e8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">└──观点. py</p><p id="b497" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Django为每个用<code class="fe nu nv nw nx b">startapp</code>命令创建的应用程序创建完全相同的目录结构。</p><p id="428b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续在api应用程序中创建两个文件:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="9da9" class="oc ko iq nx b gy od oe l of og">$ touch api/urls.py<br/>$ touch api/serializers.py</span></pre><p id="2c09" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">将api urls添加到项目主URL配置的URL模式中:</p><p id="f5f2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># data_bore_project/urls.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pb"><img src="../Images/856277bc9ebaad551396f33397973c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgpNC1mJ-pTgplcO-3ehag.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="d5dc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># api/urls.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qc"><img src="../Images/6150336690923317196f2089058fddb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xaYPfCRzhCJoKxQFrsY1Mw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="e137" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这些将是我们的API端点。所以有权限的用户可以在<a class="ae kl" href="https://data-bore.herokuapp.com/api/movies/" rel="noopener ugc nofollow" target="_blank">https://data-bore.herokuapp.com/api/movies/</a>和<a class="ae kl" href="https://data-bore.herokuapp.com/api/sentiment/" rel="noopener ugc nofollow" target="_blank">https://data-bore.herokuapp.com/api/sentiment/</a>获取数据</p><p id="23fa" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># API/serializer . py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qd"><img src="../Images/1ad07b53c754c896771c9f3f9680fa68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNuV75VFVG7jg5WfbiPt-g.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="bd12" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里，我们基本上是在配置我们希望在端点上公开的数据。请注意，它看起来几乎与Django ModelForms API一模一样。</p><p id="617e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># api/views.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ou"><img src="../Images/e6e4167cb5201a21c975edba2ae48650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xgibkzhOh9sYTeBwNepuQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="d2d2" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这里我们实现了一些看起来像Django的基于类的视图(但不是)来创建两个API视图:一个用于电影模型，另一个用于情感模型，并指定我们在此之前刚刚创建的序列化器。</p><p id="a576" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们还将设置API的权限级别。基本上，我们打算这样做，只有那些被授权的人(用户名和密码)才能访问API。这将使数据钻孔仪表板的实现稍微复杂一点，但更接近于现实生活中的工作方式。</p><p id="2c62" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续操作，在settings.py中的INSTALLED_APPS下放置以下行:</p><p id="f90a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pz"><img src="../Images/050640afbccd97a14d26271abf9866d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BmVVN6F0AGFQHLABzOSMFQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="6452" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为了处理<a class="ae kl" href="https://github.com/adamchainz/django-cors-headers" rel="noopener ugc nofollow" target="_blank"> CORS相关问题</a>我们需要安装:</p><p id="4909" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install django-cors-headers==2.2.0</code></p><p id="e34f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">CORS头文件允许跨域共享资源，并且是构建REST APIs的重要组件。</p><p id="4e91" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">不要忘记将软件包添加到settings.py中已安装的应用程序:</p><p id="817e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qe"><img src="../Images/284aa4f9314b628b2bd1d4ba7cc88154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yexC6tZG7cwfpTyHdwefOA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="b5bd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">此外，在settings.py的中间件列表中，确保将这两件事放在最上面:</p><p id="f70c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qf"><img src="../Images/c79580cc3b34b8cfa81213aa5ce47989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uxaswMulTlpUbVqTOLtydg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="075d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在同一个设置文件中，添加一个CORS来源白名单配置:</p><p id="cb35" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># settings.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qg"><img src="../Images/9bceefaf4f5e28bdd9e6543eaace4256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdXOPGA9NbljTPkvPUxO4w.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="4d8f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我已经对我们的“data-bore-dashboard . heroku app . com”进行了评论，因为我们还没有建立它。我们将在下一节用<a class="ae kl" href="https://plotly.com/dash/" rel="noopener ugc nofollow" target="_blank"> Plotly的破折号</a>来建造它。</p><p id="8b4a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">确保您在Django admin中登录，然后:</p><p id="bfe4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py runserver</code></p><p id="db86" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">前往<a class="ae kl" href="http://127.0.0.1:8000/api/movies/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/movies/</a>和<a class="ae kl" href="http://127.0.0.1:8000/api/movies/" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:8000/API/</a>sensation/以确保一切都按预期运行。</p><p id="003d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果您注销了，这两个端点根本不应该公开数据。</p><p id="cd7d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">记得推送到GitHub和Heroku，验证API在生产中也能工作。</p><p id="1663" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">另外，Django Rest框架自带staticfiles，我建议在终端上运行:</p><p id="7d2e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py collectstatic</code></p><p id="f139" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在，我们的仪表板和Power BI仪表板有了数据源。</p><p id="74e8" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们的数据钻孔REST API部分到此结束。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="66a2" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">6.带有PLOTLY仪表板的数据钻孔仪表板</h1><p id="73d6" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">我们将构建如下内容:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qh"><img src="../Images/cc67ba267039efbde067bd3f5e7c9730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KQGGKs3OFedE8VIJKI_QDA.gif"/></div></div></figure><p id="69d7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">正如我们对数据钻孔Django应用程序所做的那样，我们将从创建一个完全独立于其他任何东西的目录开始。</p><p id="4f0b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ mkdir data-bore-dashboard &amp;&amp; cd data-bore-dashboard</code></p><p id="b2c4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们要用<a class="ae kl" href="https://dash.plotly.com/introduction" rel="noopener ugc nofollow" target="_blank"> Plotly的Dash </a>包做一个叫“数据钻孔仪表板”的仪表板app。</p><p id="b242" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Dash基本上是一个构建在Flask之上的Python框架，用于构建数据分析，非常适合创建仪表板，以可视化方式简化数据，并作为web应用程序与世界其他地方共享。它是完全免费的，并附有代码示例和图库。但真正的美妙之处在于能够创建一个仪表板，并将机器学习嵌入到项目中。</p><p id="5edd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">对我来说，Dash是所有代码仪表板的未来。</p><p id="540d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">确保你在我们刚刚创建的<code class="fe nu nv nw nx b">data-bore-dashboard</code>目录中。顺便说一下，我们仍然在使用Pipenv来满足我们的虚拟环境和打包需求。</p><p id="2f97" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">让我们从安装dash开始:</p><p id="1e19" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv install dash==1.17.0</code></p><p id="bf78" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">通过以下方式激活您的虚拟环境:</p><p id="d87c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ pipenv shell</code></p><p id="de44" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将使用一些其他的Python包，所以让我们从一开始就安装我们需要的所有东西:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="c66e" class="oc ko iq nx b gy od oe l of og">$ pipenv install gunicorn pandas psycopg2-binary ipython requests python-dotenv</span></pre><p id="0f39" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Dash应用程序可以分为两个主要部分:</p><ol class=""><li id="5d7c" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">布局——应用程序的外观</li><li id="de29" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">交互性——对用户输入的类似Javascript的响应</li></ol><p id="38b6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们将主要使用两个dash模块中的类:</p><ol class=""><li id="ae0f" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">仪表板_核心部件_组件</li><li id="dd68" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">破折号_ html _组件</li></ol><p id="6110" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在<code class="fe nu nv nw nx b">data-bore-dashboard</code>中创建一个名为<code class="fe nu nv nw nx b">app.py.</code>的文件</p><p id="780b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ touch app.py</code></p><p id="f2cb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># app.py</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qi"><img src="../Images/f2bfc7a75084b3bfaebf2d69a4860751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3cqYUyWKMXk3O3xLWD6bDg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="51ec" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这里发生了很多事情，所以让我们试着分解一下。</p><p id="0838" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">前十行左右处理导入我们使用的所有包，包括来自python-dotenv的<code class="fe nu nv nw nx b">load_dotenv</code>函数，我们用它从稍后创建的<code class="fe nu nv nw nx b">.env</code>文件中加载环境变量。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ot"><img src="../Images/c65aa3266da3b75d29f3282171875622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izoL2jEbqqEgx6gR9w_ZzQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片来自carbon.now.sh</p></figure><p id="d2c0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们遇到的第一个函数是<code class="fe nu nv nw nx b">get_sentiment_data_local</code>。如果Data-Bore API由于某种原因关闭，该函数将用于向Data-Bore-Dashboard提供数据。</p><p id="f9e1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，如果我们知道数据钻孔API关闭了，我们可以做的是进入。env文件，并将<code class="fe nu nv nw nx b">API_IS_UP</code>变量切换为“False”，app.py将运行<code class="fe nu nv nw nx b">get_sentiment_data_local</code>而不是默认的<code class="fe nu nv nw nx b">get_sentiment_data</code>来获取数据。基本上，<code class="fe nu nv nw nx b">get_sentiment_data_local</code>从名为<code class="fe nu nv nw nx b">movie_and_demographic_data</code>的本地CSV文件中读取数据。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qj"><img src="../Images/213e497537a747782be256a0d47fcb4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-FEaMytFyQAcdiZ0MdnsOw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="a9f6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">External_stylesheets决定了应用的CSS样式。app变量被分配了一个Dash类实例，其中__name__变量被传递到构造函数中，__name__被设置为使用该应用程序的模块的名称。</p><p id="aff3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后我们从。我们刚刚谈到的env文件。<code class="fe nu nv nw nx b">environment</code>变量决定了我们是在开发环境还是生产环境中操作。local中的默认值是“development ”,这对调试很有用。稍后，当我们部署到Heroku时，我们会将其设置为“生产”。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oz"><img src="../Images/f35214a05951bb08300796821c231bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qgBcvb2QsdIsbLetY9O1qg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="6903" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们遇到的下一个函数是使用<code class="fe nu nv nw nx b">dash_html_component</code>类的<code class="fe nu nv nw nx b">generate_table</code>函数。</p><p id="5cb1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这个html类允许我们设置应用程序的HTML代码。这个特定的函数接收一个pandas数据帧，并将其作为应用程序中的HTML表返回，其中允许的最大行数设置为6。所以<code class="fe nu nv nw nx b">html.Table</code>就像是&lt;表&gt;/表&lt;标签。</p><p id="8816" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">此功能负责您在数据钻孔仪表板上看到的数据框:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qk"><img src="../Images/e32f577f0866b5c63cb9a925746663cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qu0kSu7vU0mDhDLtobk9kw.png"/></div></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ql"><img src="../Images/c968d2db11e232385dd963c4863739cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7cEre1ECbDoXyQx_P5U_OA.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="65d7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">get _ opinion _ data函数确实如其名所示。它将我们之前获得的<code class="fe nu nv nw nx b">environnment</code>变量作为参数，如果它等于“development”，它将从Data-Bore的本地版本中获取所需的数据。或者，我们可以推断该环境是“生产”环境，get _情操_数据将从生产环境中运行的数据钻孔应用程序中获取数据。</p><p id="358f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">之后，我们使用requests.session函数来设置一个持久会话，在这个持久会话中，我们获取<a class="ae kl" href="https://docs.djangoproject.com/en/2.2/ref/csrf/" rel="noopener ugc nofollow" target="_blank"> CSRF令牌</a>，这在Django应用程序中是必需的，在这里我们将数据发布到一个表单中。</p><p id="6fff" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">使用令牌，我们使用。我们还没有创建的env文件。</p><p id="44db" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">注意，用户名和密码是我们在上一节中创建的数据钻孔应用程序的凭证。因为我们将权限级别设置为“仅授权”，所以您必须在此处提供凭据才能获得访问权限。</p><p id="1bff" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后，我们使用请求的post方法传入URL、login_data字典和headers参数。</p><p id="6077" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">返回的是JSON数据，我们使用<code class="fe nu nv nw nx b">json.loads</code>方法将其转换为Python字符串，并将其赋给一个名为which的变量。</p><p id="013c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后，我们使用DataFrame构造函数将情感转换成熊猫数据帧。然后使用for循环处理数据，将1改为“爱死它了！”0变成了“讨厌！”这对人类来说更具可读性。</p><p id="53d7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后返回按最近电影评论排序的数据帧。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qm"><img src="../Images/6814e4883552d86549785b3ce1c2fad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skg_qMt0g0aETdQU06Q5og.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="4655" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">serve_layout函数接收环境变量，然后运行<code class="fe nu nv nw nx b">get_sentiment_data</code>函数来获取返回的df数据帧。</p><p id="3088" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后，它创建另一个名为df_loved filtering的数据帧，仅用于用户对电影的评价为“正面”或1的电影评论。</p><p id="f2d0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后，我们将年龄列分为四个类别:青少年、年轻人、中年人和老年人，并将其添加到df_loved数据帧中。</p><p id="7994" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">还记得我们用熊猫创建随机人口统计数据的麻烦吗？这就是它派上用场的地方，因为现在我们可以将这样的数据用于柱状图。</p><p id="5d0f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，使用plotly.express模块，它为我们提供了plotly图形类的API，我们创建了条形图，显示了喜爱电影的人的人口统计维度。</p><p id="6df7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">就像我们之前使用generate_table函数一样，我们使用html组件来设置应用程序的HTML标签。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qm"><img src="../Images/f9f4f46ac81b0b919ecc91cdb6e0244a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bb9EqYRWQ4zoPYHedIDKwg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="91ba" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们遇到的最后一个函数是serve_layout_local，它与前面的函数serve_layout几乎完全相同，但不同之处在于，这是应用程序在数据钻孔API关闭时运行的函数。如您所见，在serve_layout_local函数内部，我们正在运行get _ opinion _ data _ local，它使用本地CSV文件来构建熊猫数据帧。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qn"><img src="../Images/df10c7fbeb86e81ee89be20adcbeebff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ko6Alm4Ck3tiiUv7VEw3rw.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="a2fb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后，这是决定运行哪个serve_layout函数的部分。如果数据钻孔API关闭，我们将运行serve_layout_local。如果数据钻孔API启动并运行，我们运行serve_layout。</p><p id="83a5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后我们结束了</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="626b" class="oc ko iq nx b gy od oe l of og">__name_ == ‘__main__’:</span></pre><p id="d58b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">app.py脚本的入口点，它允许我们在开发服务器上本地运行Dash应用程序，就像我们对Django所做的那样。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="59cc" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">7.以数据钻孔仪表板结束</h1><p id="9f95" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">最后，我们将设置一些在Heroku上部署所需的文件。</p><p id="60f5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># .包封/包围（动词envelop的简写）</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="49a3" class="oc ko iq nx b gy od oe l of og">FLASK_ENV='development'</span><span id="e455" class="oc ko iq nx b gy oi oe l of og">USERNAME='Your real username'<br/>PASSWORD='Your real password'</span><span id="298a" class="oc ko iq nx b gy oi oe l of og">API_IS_UP='True'</span></pre><p id="f29c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">记住用户名和密码参考我们之前创建的数据钻孔应用程序的凭证。</p><p id="2851" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当我们为Heroku设置配置变量时，这些值也会不同。</p><p id="5ffb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># .gitignore</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi oh"><img src="../Images/187e61288a18dce509f56aeb212acf9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkI7HDO-Orv4g9w6h7vyBg.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="eef4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这是一样的。git忽略来自数据钻孔的设置。</p><p id="fd45" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># Procfile</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="b778" class="oc ko iq nx b gy od oe l of og">web: gunicorn app:server</span></pre><p id="8a0c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"># runtime.txt</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="7638" class="oc ko iq nx b gy od oe l of og">python-3.8.6</span></pre><p id="5779" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后但同样重要的是，将我的GitHub 中的<a class="ae kl" href="https://raw.githubusercontent.com/Captmoonshot/data_bore_dashboard/main/movie_and_demographic_data.csv" rel="noopener ugc nofollow" target="_blank">movie _ and _ demographic _ data . CSV副本放在data-bore-dashboard顶层目录中。</a></p><p id="8842" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们的项目结构现在应该是这样的，不包括。环境和。gitignore文件:</p><p id="d4bd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">。<br/>├──pipfile<br/>├──pipfile . lock<br/>├──proc file<br/>├──app . py<br/>├──movie _ and _ demographic _ data . CSV<br/>└──runtime . txt</p><p id="8e19" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您可以在终端上进行测试，并:</p><p id="1ce5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python app.py</code></p><p id="7da0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">但在此之前，请记住，由于我们设置Dash应用程序的方式，您需要有一个单独的终端在本地运行我们的数据钻孔应用程序:</p><p id="b918" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">#数据钻孔目录中的不同终端:</p><p id="e644" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><code class="fe nu nv nw nx b">$ python manage.py runserver</code></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qo"><img src="../Images/67a52ac957730a1b7fb9612a1b61727f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Qa0VJoD3w2HboUXU9CyVQ.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">您需要在本地运行两个独立的服务器</p></figure><p id="d197" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您可以通过首先在Data-Bore中创建一个新的电影评论来检查Data-Bore-Dashboard是否正在获得实时更新:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qh"><img src="../Images/bc000c4ea428c2447a6366aebc3f6636.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*_dxkbEV8CjlOoCsZ9x93zQ.gif"/></div></div></figure><p id="f143" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后点击Data-Bore-Dashboard上的刷新按钮:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qp"><img src="../Images/37a1e63aba0fd0a1c14d39f2fee870f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LoKvpOyGER7MpJBSzQKpFg.gif"/></div></div></figure><p id="51ce" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">恭喜你，我们现在有了一个可以使用REST API在页面重新加载时实时更新的功能面板。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="0511" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">8.部署数据-钻孔-仪表板</h1><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qg"><img src="../Images/9bceefaf4f5e28bdd9e6543eaace4256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MdXOPGA9NbljTPkvPUxO4w.png"/></div></div><p class="kh ki gj gh gi kj kk bd b be z dk translated">图片由carbon.now.sh提供</p></figure><p id="c9dd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">首先回到你的数据钻孔应用程序的<code class="fe nu nv nw nx b">settings.py</code>，或者取消注释，或者在下面的行中写入:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="7f08" class="oc ko iq nx b gy od oe l of og">'data-bore-dashboard.herokuapp.com/',</span></pre><p id="247a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">让我们进一步部署我们的Dash应用程序。</p><p id="9fdd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">就像之前我们要推进到GitHub，然后推进到Heroku。因此，请确保您已经为Data-Bore-Dashboard应用程序创建了GitHub repo。然后按照说明进行操作:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="81df" class="oc ko iq nx b gy od oe l of og">$ git status<br/>$ git add .<br/>$ git commit -m "first commit"<br/>$ git remote add origin <a class="ae kl" href="https://github.com/example.git" rel="noopener ugc nofollow" target="_blank">https://github.com/example.git</a><br/>$ git push origin master<br/></span></pre><p id="7815" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">设置您的Heroku配置变量—相同。数据钻孔仪表板项目中的环境变量:</p><pre class="ll lm ln lo gt ny nx nz oa aw ob bi"><span id="6975" class="oc ko iq nx b gy od oe l of og">$ heroku config:set FLASK_ENV='production'<br/>$ heroku config:set USERNAME='Your Data-Bore username'<br/>$ heroku config:set PASSWORD='Your Data-Bore password'<br/>$ heroku config:set API_IS_UP='True'</span><span id="bd9f" class="oc ko iq nx b gy oi oe l of og"># push to Heroku<br/>$ git push heroku master</span></pre><p id="065f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因为我们没有用于数据钻孔仪表板的数据库，所以没有必要运行任何类型的迁移。</p><p id="faa4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果一切顺利，您现在应该已经将数据钻孔仪表板应用程序投入生产了。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="d52e" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">9.功率BI</h1><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qq"><img src="../Images/86eb211f7f53cfa5f8131fd663cf8183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*500xuWGEwKVAuDdCfPCh-g.jpeg"/></div></div></figure><p id="119b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">照片由<a class="ae kl" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ja"> Pixabay </strong> </a>来自<a class="ae kl" href="https://www.pexels.com/photo/red-car-in-bus-326259/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ja">像素</strong> </a></p><p id="a35c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">你们中的一些人可能会问，为什么我要在这类项目中加入Power BI组件。毕竟，我们不是已经有了一个可以工作的仪表板吗？</p><p id="f269" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">不要误解我。Python很棒，我觉得它应该是商业智能的未来。但是就目前的情况来看，我的理解是世界上大多数商业人士并不使用Python来满足他们的日常需求。</p><p id="4c80" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">从事商业智能或数据分析的普通人向懂Excel之类的老板汇报的可能性更大。这意味着即使我们碰巧使用的工具不是开源的，我们也能从中受益。</p><p id="bb25" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power Bi是微软对Tableau等工具的回应。但与Tableau不同，Power Bi是免费的，可以像Plotly的Dash一样用于在网络上分发视觉上吸引人的仪表盘。</p><p id="641e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">不幸的是，对于macOS用户来说，Power BI确实需要Windows操作系统。</p><p id="564a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您可以首先从这里下载Power Bi Desktop开始:</p><div class="pg ph gp gr pi pj"><a href="https://powerbi.microsoft.com/en-us/downloads/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">下载| Microsoft Power BI</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">无论您是在旅途中还是需要创建丰富的交互式报告，下载构建报告所需的工具并…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">powerbi.microsoft.com</p></div></div><div class="ps l"><div class="qr l pu pv pw ps px kf pj"/></div></div></a></div><p id="2a3a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当我们第一次打开Power Bi时，迎接我们的是一个欢迎屏幕，这让人想起了VSCode:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qs"><img src="../Images/716572fe494a7bc474eb826fb7a6bb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAldON6oUk9j9Yzh5FSalA.png"/></div></div></figure><p id="8330" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">通过单击x关闭窗口。您应该会看到一个如下所示的GUI:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qt"><img src="../Images/71aef44a55208faaa0b4db17bf60dfec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-OmJFUOEm4aAdzGN-HtQA.png"/></div></div></figure><p id="ee72" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power BI结合了pandas和Dash的功能，因此我们几乎总是要做的三个主要任务是:</p><ol class=""><li id="c8f0" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">获取数据</li><li id="f6e8" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">清理和处理数据</li><li id="4b47" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">将数据可视化为我们可以共享的仪表板</li></ol><p id="0cfc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">因此，我们今天要做的是首先连接到Heroku上的Data-Bore的PostgreSQL数据库，并创建与我们使用Plotly的Dash完全相同类型的简单仪表板。</p><p id="916b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">到最后，我们应该以类似于的<a class="ae kl" href="https://data-bore-dashboard-powerbi.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">结束:</a></p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qu"><img src="../Images/e87a72f1fd9f5eb176a912587bebb914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-OHbCo5xTdhULOhZ5nlqAg.png"/></div></div></figure><p id="2111" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power BI的一个常见模式是实际使用<a class="ae kl" href="https://powerquery.microsoft.com/en-us/excel/" rel="noopener ugc nofollow" target="_blank"> Excel的PowerQuery </a>来清理数据，然后使用Power BI来获取数据，然后创建可视化。事实上，在数据处理方面，PowerQuery与Power BI具有完全相同的功能。</p><p id="2850" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然而，因为我们的数据源是Heroku数据库，所以我们将跳过Excel部分，直接使用Power BI。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="fb8c" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">10.连接到HEROKU数据库</h1><p id="f92f" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">要将Power BI连接到数据源，您需要熟悉Get Data函数。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/dfcbd477616610d76d2195b99d14c5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*q3EmBZSU8rqRU86iLNrnrw.png"/></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi qw"><img src="../Images/f9ae696d888edc60db9f1b396ad87968.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*pxhyHuK8mii0Bo4-g4tprQ.png"/></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qx"><img src="../Images/62ea8c3dd5e85be9c5facea887690a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gTxvUtqvhB1WLO9KicefAg.png"/></div></div></figure><p id="100f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">虽然连接到Excel文件、CSV文件，甚至本地数据库都是轻而易举的事情，但是连接到Heroku数据库就有点棘手了。</p><p id="3460" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">其他人可能有更好的想法，但以下步骤帮助我连接到数据钻孔数据库:</p><ol class=""><li id="3fa9" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">您将需要下载一个ODBC(开放式数据库连接器),它是一个API，允许您与各种RDBMS(关系数据库管理系统)服务器连接:</li></ol><div class="pg ph gp gr pi pj"><a href="https://www.postgresql.org/ftp/odbc/versions/msi/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">文件浏览器</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">编辑描述</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">www.postgresql.or</p></div></div><div class="ps l"><div class="qy l pu pv pw ps px kf pj"/></div></div></a></div><p id="83fd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">转到与您的系统匹配的最新版本的zip文件。我的是x64，所以我最后下载了<code class="fe nu nv nw nx b">psqlodbc_12_2_0000-x64.zip</code>，然后运行安装程序。</p><p id="5207" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">2.回到您的Power BI，单击Get Data = &gt; More = &gt; Other = &gt; ODBC = &gt; Connect。完成后，您应该会看到以下窗口:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi qz"><img src="../Images/0d42eab416d421cb3a1b3bdd24dbcb68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vLvXPO9X5GslZISo2QSmrQ.png"/></div></div></figure><p id="3b31" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为数据源名称(DSN)选择“(无)”。</p><p id="818d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">点击高级选项。</p><p id="80df" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这是我们写出Heroku PostgreSQL的连接字符串的地方。</p><p id="0ee5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">3.连接字符串使用以下语法编写:</p><p id="c854" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">driver = { PostgreSQL Unicode(x64)}；服务器= {随机字符串}。compute-1.amazonaws.com；端口= 5432；database = { ram DOM _ string }；sslmode =要求</p><p id="8540" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您要做的是获取您的Data-Bore的Heroku数据库凭证信息，并将它们插入到上面的连接字符串中。</p><p id="669b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">要查找您的证书信息，请前往<a class="ae kl" href="https://data.heroku.com/?filter=heroku-postgresql" rel="noopener ugc nofollow" target="_blank">data.heroku.com</a>，在那里您会找到您所有Heroku数据库的列表。如果Data-Bore是你的第一个Heroku应用，你只会找到一个数据库。</p><p id="4a26" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为您选择数据库-数据钻孔app = &gt;设置= &gt;数据库凭证</p><p id="5713" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您现在应该可以看到<em class="op">主机、数据库、端口、用户</em>和<em class="op">密码的值。记下这些，将它们插入到不带花括号的连接字符串中。下一部分您将需要用户名和密码，所以请将它们放在手边。</em></p><p id="b1cc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">driver = { PostgreSQL Unicode(x64)}；Server = {您的服务器信息}；Port = {您的端口信息}；Database = {您的数据库信息}；sslmode =要求</p><p id="3941" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">最后，复制并粘贴到Power BI连接窗口的连接字符串字段:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ra"><img src="../Images/abd7762384f5a8519c43980f79ab6905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J450JDbMMJAondmvt1jfoA.png"/></div></div></figure><p id="8371" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">完成后，点击确定。</p><p id="ca2a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您将被带到另一个窗口，输入您在此之前刚刚获得的用户和密码凭证。继续并输入它们。</p><p id="5c47" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果一切顺利，您应该会看到下面的窗口，它显示了到您的数据钻孔Heroku数据库的直接连接:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rb"><img src="../Images/b219f807ca4376877dd120e9d66e4b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weN4kjiWeXRf3XC_UAssiw.png"/></div></div></figure><p id="f746" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">确保在classifiers_movie和classifier _ opinion表中进行选择。</p><p id="5787" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">单击Load按钮会将这两个表加载到Power BI画布中:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rc"><img src="../Images/2caa220c59455f7aa12b84f392af2709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ySE0cmuhuGzQQWsRk7zTTA.png"/></div></div></figure><p id="9109" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您的两个表应该在右侧的“字段”窗口窗格中可见。</p><p id="32c9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><strong class="lt ja"> <em class="op">注意事项</em> </strong>:不要在你的项目代码或GitHub或任何其他地方公开暴露你的Heroku数据库，因为这会使你的整个数据库处于坏人的风险之中，他们可能会窃取或破坏你的数据。无论您做什么，请确保您的凭据安全可靠。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="be1e" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">11.使用POWER BI进行数据处理</h1><p id="ace6" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">敏锐的观察者会注意到classifiers_movie表与classifiers _ opinion表有一对多的关系。因此，让我们从内部连接的幂BI等价开始。</p><p id="bf7b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">顺便说一下，在Power BI中，我们把看起来像数据库表的东西称为“查询”</p><p id="6c3e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power BI中的所有数据处理都在一个单独的查询编辑器窗口中进行，因此右键单击classifiers _ perspective查询并选择Edit Query。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rd"><img src="../Images/7d3092c1291c3a64b5d166b6f005458a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*HNcu8zAM708MoHUcMd6z_Q.png"/></div></figure><p id="7b9c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">完成后，查询编辑器应该会弹出:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi re"><img src="../Images/48a23b2d699fd133bcd47efa4251ec4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hw-BAgkgwc43CnQN_RMOCw.png"/></div></div></figure><p id="a7bb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">要继续连接，请在查询窗格中右键单击您左侧的classifiers _ opinion查询，然后选择Reference:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rf"><img src="../Images/f4aeb14faa7eb1895ba9ea7223e1500d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYkWx9ml5x80ZPUclWkYzg.png"/></div></div></figure><p id="a029" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">第三个查询的名称应该是classifiers _情操(2)。右键单击该查询，并将其重命名为“情绪和电影”</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rg"><img src="../Images/1956273fdd369ae49fadd7ae0fd760ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*1lti6Vcvx1SgQKpOr_bVcQ.png"/></div></figure><p id="265c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在Power BI中，我们通过单击Merge按钮开始加入。在你的右上方应该有一个名为“合并”的按钮继续点击，然后点击合并查询。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rh"><img src="../Images/369d11cdd2c7fc3ea102b0ea481d9ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*BidIrRw-4rjMkiz-w9arZQ.png"/></div></figure><p id="be55" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该得到一个如下所示的窗口:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ri"><img src="../Images/f28497861dd089fa0ef5ad2561b24b21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VL0usIHiaOOQFTVBs5hhbA.png"/></div></div></figure><p id="b90a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">单击movie_id标题将其高亮显示。从下拉列表中选择classifiers_movie。并单击id标题以突出显示该字段。然后点击确定。</p><p id="b0fc" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power BI应该返回类似这样的内容:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi pf"><img src="../Images/181bedcd0780f59c12486e197e193696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRoM-8eV4f5yz3zkdsE3WQ.png"/></div></div></figure><p id="234b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在，单击带有两个指向相反方向的箭头的小按钮，显示<em class="op"> classifiers_movie.1 </em>列。确保只选择了<em class="op">标题</em>。取消选择<em class="op">使用原来的列名作为前缀</em>。然后点击确定。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rj"><img src="../Images/ff5e2c0bee879c4503690ec426e99074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*44AEDC5cucbtwAz3LlFeSg.png"/></div></figure><p id="16e5" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该会看到如下所示的内容:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rk"><img src="../Images/4f24237b4d28ac37879267186c2cb296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ECqdDjSTvFZO2bk1J6rjxA.png"/></div></div></figure><p id="94b6" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后点击<em class="op">标题</em>列，向左拖动直到它正好在<em class="op"> movie_id </em>列旁边。</p><p id="22c3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们实际上不需要<em class="op"> movie_id </em>列，所以右键单击movie_id标题并选择Remove。</p><p id="738a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">请记住，我们是在查询编辑器的范围内完成所有这些工作的。</p><p id="21b9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们数据的人口统计部分现在应该是这样的:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rl"><img src="../Images/ccaa8d13ebe96fce12ecdd93d1bd6403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_JAMo-ZymrnS3liEdVBoqQ.png"/></div></div></figure><p id="27a9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">太好了。</p><p id="11f9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们需要注意的另一个数据处理步骤是<em class="op">结果</em>列。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rm"><img src="../Images/4f7bb1e64c7783d565120e8975c0f633.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*EVhOTCa5zLo5zx6H0E9pSw.png"/></div></figure><p id="0053" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我想做的是把所有的1和0转换成“爱死它了！”或者“讨厌它！”因此，人们可以立即知道影评人对这部电影的看法。</p><p id="f3eb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们可以分两步完成:</p><ol class=""><li id="0d33" class="mp mq iq lt b lu lv ly lz mc mr mg ms mk mt mo mu mv mw mx bi translated">将结果列转换为文本数据类型</li><li id="bcfd" class="mp mq iq lt b lu my ly mz mc na mg nb mk nc mo mu mv mw mx bi translated">将1s替换为“爱死了！”和“讨厌它！”</li></ol><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rn"><img src="../Images/6cbac103ed9b6563bdc615515c55c7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YTQZzbbl6EvDWoaX1u_xuA.png"/></div></div></figure><p id="9023" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">继续并右击<em class="op">结果</em>栏，选择<em class="op">更改类型</em>，然后选择<em class="op">文本</em>。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ro"><img src="../Images/1bc14556a89ee82513cca0a6c64d04ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*MBf5EAJziaViR2lmHTMU0A.png"/></div></figure><p id="82ba" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">之后，再次右击<em class="op">结果</em>栏，并选择<em class="op">替换值</em>。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rp"><img src="../Images/5875b3cd3a34b573c62b445de4ac0e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ls1RF1u4lhpDgBfHwPGfrg.png"/></div></div></figure><p id="93ef" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为<em class="op">值输入1以找到</em>并喜欢它！将<em class="op">替换为</em>字段。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rq"><img src="../Images/392bc19f6cd775d9e667b7ba621a3541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcfbh4oWPyo5IlpQRNihgg.png"/></div></div></figure><p id="173e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">对0值使用相同的程序。</p><p id="e02f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您现在应该有一个类似这样的<em class="op">结果</em>列。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rr"><img src="../Images/9f8aabd5d7ab5429065880acb41d8938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*c88OqCwCJwtQ56kpFLEM5A.png"/></div></figure><p id="0e63" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">太棒了。点击查询编辑器左上角的关闭并应用按钮。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rs"><img src="../Images/34c368ff34e2960334266282be4ab82e.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*s2Twgjo2ipe-eqRCJCJKLg.png"/></div></figure><p id="2ddb" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们现在应该回到我们最初的Power BI画布窗口:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rt"><img src="../Images/9e93da7f1cfe9fbc18cbbbef876bb1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7Mauz5hWYbkuyWFh30PBg.png"/></div></div></figure><p id="8704" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">现在让我们创建一些可视化。</p><p id="0ae1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们要创建的第一个图表将是显示喜爱它的人的电影评论的聚集条形图！那些讨厌它的人！</p><p id="c208" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">从可视化窗格中选择<em class="op">簇状条形图</em>。</p><p id="5932" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">使用我们新创建的<em class="op">情感和电影</em>查询，选择并拖动<em class="op">标题</em>字段，并将其放置在轴字段中。然后点击并拖动<em class="op">结果</em>到图例字段，然后再次拖动<em class="op">结果</em>到数值字段。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ru"><img src="../Images/6cf33ca4969257e2c7a003d97919d1cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*tHAMZ3-SQ9rYSP1IhUfaHw.png"/></div></figure><p id="15cd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当您将结果列拖到值字段时，它会自动推断您想要所有结果的计数，因此没有必要做任何更改。</p><p id="1c43" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">此外，您可以单击画刷图标来更改结果可视化的格式和颜色。</p><p id="709c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">对于我的可视化，我已经将条形的颜色改为红色和蓝色，允许数据标签出现，增加标题的文本大小，将标题改为“爱死它了！VS讨厌它！”，增加X轴标签的文本大小，将边框设置为“开”，最后将X轴标签的颜色设置为深黑色。您可以通过油漆滚筒图标功能控制所有这些选项以及更多选项。</p><p id="9cb9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">这就产生了一个简单明了的视觉效果，如下所示:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi rv"><img src="../Images/e41548ae2ddacb1ac57a31e730343838.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*MwNsWP2JIjq_-oCbjbSdJQ.png"/></div></figure><p id="1e80" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">此外，如果您想更容易地在当前画布上显示四个视觉效果，请转到顶部的视图选项卡，选择网格线和对齐网格选项:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rw"><img src="../Images/2bb40cdedf062cabccd0889be9f08027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W5-Xe7qmQyenUf0jVNuCmQ.png"/></div></div></figure><p id="87a0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在接下来的三个视觉效果中，我们将完成一个新的查询，所有的结果都是喜欢！换句话说，就像我们使用Plotly的Dash开发Data-Bore-Dashboard一样，我们将把碰巧喜欢电影的人的人口统计特征可视化。</p><p id="3a14" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为此，右键单击情感和电影查询，然后选择编辑查询进入查询编辑器。</p><p id="f293" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">然后右键单击情感和电影查询，并选择引用它。当新查询出现时，将其重命名为<em class="op">情操_和_电影_爱_它</em>。点击<em class="op">情感_和_电影_爱情_它</em>查询，以确保我们正在编辑正确的查询。</p><p id="e0d4" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">选择<em class="op">结果</em>列，点击结果列名称旁边的下拉菜单，然后选择“喜欢”!只有。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rx"><img src="../Images/34a063d82c8dc57b795a0bd8fae48bed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HwXcElfY7hJqTLyaulT1Q.png"/></div></div></figure><p id="53f3" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">结果栏现在应该只包含爱它！作为它的价值观。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi ry"><img src="../Images/c23b9f563be992046982686b61d6a189.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*iqueiRgZ8DzVxOWjjvneeA.png"/></div></figure><p id="5362" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">点击关闭和应用按钮，让我们回到我们的可视化。</p><p id="beff" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们可以使用与之前完全相同的方法为性别列创建一个聚集条形图，我们将标题拖到轴字段，将性别列拖到图例字段，然后将性别列再次拖到值字段。然后选择画刷图标，用不同的颜色和更大的文本大小来设置样式和格式，最终结果如下:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi ri"><img src="../Images/a9c75d87a5c533363aa35ca99f6c435d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZpuHcNF8xrdbXk_3gB_v1w.png"/></div></div></figure><p id="2c79" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当我们对Country列应用完全相同的配置时，我们最终会得到这样的结果:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi rz"><img src="../Images/b63a6b820ca1d2af4fa911aa404ea312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DiYnAeBJR1TuwQawl1XcKQ.png"/></div></div></figure><p id="beda" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">对于我们的最后一个视觉效果，我们希望按相同的<em class="op">情感_和_电影_爱_它</em>查询的年龄组进行细分。我们需要对年龄进行分类，因为人们的年龄在15岁到65岁之间。</p><p id="d88d" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">为此，让我们返回到查询编辑器，右键单击<em class="op">情感_和_电影_爱情_它</em>查询并选择编辑查询。</p><p id="0b1c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">点击<strong class="lt ja">添加栏</strong>，然后点击<strong class="lt ja">条件栏</strong>。</p><p id="5707" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">您应该会看到一个弹出的新窗口，如下所示:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sa"><img src="../Images/07d7ca40f15f4b19df72c85682f39fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*shNcm6iRcZoBPcw4h7DRfA.png"/></div></div></figure><p id="134c" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">给这个新栏目起名叫<strong class="lt ja"> age_binned </strong>。然后像这样填写条件句:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sb"><img src="../Images/7240acb28537feccdb5429f062189674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxSdedUpkogm_v6M3HjrSQ.png"/></div></div></figure><p id="a2a0" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">完成创建If-Else逻辑以创建入库年龄组后，单击确定。</p><p id="3fc1" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我们现在有了一个新的<em class="op"> age_binned </em>列:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi sc"><img src="../Images/e3c1e96881b2ed73dbc381f0572fd4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*bqikikvAMD_RcQKcW-z8Vg.png"/></div></figure><p id="2b91" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">点击关闭并应用按钮返回到我们的画布。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sd"><img src="../Images/da036391fa32fee9430621f2bcfc8951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2KV2SdwEH3aKfMKnxNx38w.png"/></div></div></figure><p id="2b58" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">使用与之前的集群条形图相同的配置，我们可以使用新创建的<strong class="lt ja"> age_binned </strong>列创建一个视觉效果。</p><p id="f0ce" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果你从一开始就跟随了祝贺你！</p><p id="7e8b" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">尽管这些可视化效果可能很简单，但创建它们需要一定的工作量。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="6326" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">12.部署POWER BI仪表板</h1><p id="1efe" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">共享您的仪表板有几个选项。一个简单的方法是点击Power BI canvas窗口顶部的Publish按钮。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi se"><img src="../Images/27d759d1c563e47a62ed0ef1e72cb07a.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*q3QOmIDugPwWnT2TSXOJ6A.png"/></div></figure><p id="702f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">系统会要求您登录，然后您可以选择“我的工作区”作为目的地。如果一切正常，那么您应该会看到以下确认信息:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sf"><img src="../Images/eae3e99b53121d84b5f00eba3cf9848a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6okRpn5x2-PrlPY_rS7amw.png"/></div></div></figure><p id="1af7" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">那么Power BI将我们的仪表板发布到哪里呢？</p><p id="7f1a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">当您从Power BI Desktop发布报告或仪表板时，它会被发送到名为Power BI Service或Power BI Online的地方。Power BI服务是Power BI的云版本，如果您注册，您将获得一个“我的工作区”来存储您所有的Power BI报告，并以各种方式共享它们。</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sg"><img src="../Images/b8d4229937b6b7f27e9ac4a63e90983c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1K-SWvyQ8l-B1Pf1SdK9Q.png"/></div></div></figure><p id="0765" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">你可以在这里注册这项服务:</p><div class="pg ph gp gr pi pj"><a href="https://docs.microsoft.com/en-us/power-bi/fundamentals/service-self-service-signup-for-power-bi" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">以个人智能BI的身份注册智能BI服务</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">Power BI可以是您的个人数据分析和可视化工具，也可以作为分析和决策工具…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">docs.microsoft.com</p></div></div><div class="ps l"><div class="sh l pu pv pw ps px kf pj"/></div></div></a></div><p id="9b81" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里签名:</p><div class="pg ph gp gr pi pj"><a href="https://powerbi.microsoft.com/en-us/landing/signin/?ru=https%3A%2F%2Fapp.powerbi.com%2F%3FnoSignUpCheck%3D1" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">登录| Microsoft Power BI</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">Power BI将您公司的数据转换为丰富的视觉效果，供您收集和组织，以便您可以专注于…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">powerbi.microsoft.com</p></div></div><div class="ps l"><div class="si l pu pv pw ps px kf pj"/></div></div></a></div><p id="c4df" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">如果您登录并单击您发布的报告，您应该会看到以下内容:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sj"><img src="../Images/797ae7c52a513d45d7a9fe4278b1f6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bcj1bfbvfFmqTlAY4Jf0Xg.png"/></div></div></figure><p id="ee6a" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在此基础上，就分发您的仪表盘而言，最简单的方法是生成一个二维码，您可以用它来与下载了iOS和Android上均可用的<a class="ae kl" href="https://powerbi.microsoft.com/en-us/mobile/" rel="noopener ugc nofollow" target="_blank"> Power BI移动应用</a>的其他人分享:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div class="gh gi sk"><img src="../Images/679662e05abd3e1ec8b5c26ec93fd888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*q3axG0IGidCLGjEImyFUbg.png"/></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sl"><img src="../Images/40ffa3df680cdf693f752f548514be4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJTmtyjRMOQ61wky_aDbMg.png"/></div></div></figure><p id="7e8f" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">你的下一个赌注是获得一个嵌入代码，你可以把它嵌入到你自己的Django或Flask应用中:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sl"><img src="../Images/02f9b3f2eee2f615d2b6242182b84c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rO6zfKQzNzwEZ5O1ctggjw.png"/></div></div></figure><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sm"><img src="../Images/9afe645fec4cd7c51958119d4aee7c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zieKEs70Xtx-IQje1Kjhg.png"/></div></div></figure><p id="8b25" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">Power BI将为您提供通过电子邮件链接或iframe嵌入仪表板进行共享的选项:</p><figure class="ll lm ln lo gt ka gh gi paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="gh gi sn"><img src="../Images/b1dae6581a1c687c656198989106d578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0OB8-nnhPRwrwX2Zdk5ksA.png"/></div></div></figure><p id="2b49" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在这里，我简单地粘贴了提供的电子邮件链接:</p><div class="pg ph gp gr pi pj"><a href="https://app.powerbi.com/view?r=eyJrIjoiYjc1ZjMwYWUtMjE5Yy00N2ZkLWFmYTctYjdkNTc5MGU3YjgwIiwidCI6IjlmNTk4YmYzLTg2NzgtNGYwNS04MjJjLWI4YTQwMDYwZDlkMCJ9&amp;pageName=ReportSection" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">电源BI报告</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">由Power BI支持的报告</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">app.powerbi.com</p></div></div></div></a></div><p id="55e9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">但更动态的方法是将iframe嵌入到您自己的web应用程序中，我在这里已经做到了:</p><div class="pg ph gp gr pi pj"><a href="https://data-bore-dashboard-powerbi.herokuapp.com/" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">数据-钻孔-仪表板-PowerBI</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">编辑描述</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">data-bore-dashboard-powerbi.herokuapp.com</p></div></div></div></a></div><p id="c065" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">它基本上是一个框架Django应用，带有一个包含嵌入代码或iframe的<em class="op">home.html</em>文件。我不会在这里重复构建应用程序，但是代码可以在这里公开获得:</p><div class="pg ph gp gr pi pj"><a href="https://github.com/Captmoonshot/data-bore-dashboard-bi" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">capt moon shot/数据钻孔-仪表板-bi</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="so l pu pv pw ps px kf pj"/></div></div></a></div><p id="e9bd" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated"><em class="op">关于Power BI服务的一个注意事项</em>:不幸的是，要使用Power BI服务，而不是Power BI桌面，要在网上发布你的作品，你需要有一个经过微软验证的工作账户。您还需要这里的管理员权限:</p><div class="pg ph gp gr pi pj"><a href="https://www.microsoft.com/en-us/microsoft-365/business/office-365-administration" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">微软365管理</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">管理您的Microsoft 365订阅中的应用程序、服务、数据、设备和用户。</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">www.microsoft.com</p></div></div><div class="ps l"><div class="sp l pu pv pw ps px kf pj"/></div></div></a></div><p id="a9ca" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">在365管理中心:</p><p id="def9" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">转到管理中心选项卡= &gt;所有管理中心=&gt; Power BI = &gt;租户设置= &gt;启用发布到Web = &gt;应用</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="55fa" class="kn ko iq bd kp kq nk ks kt ku nl kw kx ky nm la lb lc nn le lf lg no li lj lk bi translated">13.经验教训</h1><p id="8c5c" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">我之所以觉得我从这个项目中学到了很多，是因为这是我第一次处理Plotly的Dash和Microsoft Power BI。最重要的是，构建我自己的REST API服务来获得实时更新的机器学习结果真的很有趣。</p><p id="8e0e" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">我向任何以Python为中心的数据科学家强烈推荐Power BI，尝试一下它的强大和简洁。</p><p id="ef82" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">谢谢你看我的帖子和快乐编码！</p><h1 id="5b13" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">开源代码库</h1><p id="cdda" class="pw-post-body-paragraph lr ls iq lt b lu np lw lx ly nq ma mb mc nr me mf mg ns mi mj mk nt mm mn mo ij bi translated">数据钻孔仪表板(仪表板):</p><div class="pg ph gp gr pi pj"><a href="https://github.com/Captmoonshot/data_bore_dashboard" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">capt moon shot/data _ bore _ dashboard</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="sq l pu pv pw ps px kf pj"/></div></div></a></div><p id="0acf" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">数据钻孔REST API (Django):</p><div class="pg ph gp gr pi pj"><a href="https://github.com/Captmoonshot/data-bore" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">卫星快照/数据钻孔</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="sr l pu pv pw ps px kf pj"/></div></div></a></div><p id="f795" class="pw-post-body-paragraph lr ls iq lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo ij bi translated">嵌入式Power BI (Django-Power BI):</p><div class="pg ph gp gr pi pj"><a href="https://github.com/Captmoonshot/data-bore-dashboard-bi" rel="noopener  ugc nofollow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ja gy z fp po fr fs pp fu fw iz bi translated">capt moon shot/数据钻孔-仪表板-bi</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">github.com</p></div></div><div class="ps l"><div class="so l pu pv pw ps px kf pj"/></div></div></a></div></div></div>    
</body>
</html>