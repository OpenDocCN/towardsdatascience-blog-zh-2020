<html>
<head>
<title>Music Generation Through Deep Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过深度神经网络生成音乐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/music-generation-through-deep-neural-networks-21d7bd81496e?source=collection_archive---------18-----------------------#2020-10-21">https://towardsdatascience.com/music-generation-through-deep-neural-networks-21d7bd81496e?source=collection_archive---------18-----------------------#2020-10-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/535cee03eb3e5cab483ddd0856a1bc25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*058uKGtNwFsQAXY8"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">阿列克谢·鲁班在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="6312" class="je jf jg bd b dl jh ji jj jk jl jm dk jn translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/hands-on-tutorials" rel="noopener" target="_blank">动手教程</a>，深度学习</h2><div class=""/><div class=""><h2 id="d6e5" class="pw-subtitle-paragraph km jp jg bd b kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dk translated">机器学习的创造性应用</h2></div><p id="7648" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">深度学习以明显和微妙的方式改善了我们生活的许多方面。深度学习在<a class="ae jd" rel="noopener" target="_blank" href="/how-to-build-a-movie-recommendation-system-67e321339109">电影推荐系统</a>、<a class="ae jd" rel="noopener" target="_blank" href="/spam-detection-in-emails-de0398ea3b48">垃圾邮件检测</a>和计算机视觉等过程中发挥着关键作用。尽管围绕深度学习作为黑盒和训练难度的讨论正在进行，但它在包括医学、<a class="ae jd" href="https://lionbridge.ai/solutions/virtual-assistants/" rel="noopener ugc nofollow" target="_blank">虚拟助手</a>和电子商务在内的广泛领域中有着巨大的潜力。</p><p id="eb4f" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">深度学习可以发挥作用的一个令人着迷的领域是艺术和技术的交叉点。为了进一步探索这个想法，在本文中，我们将通过深度学习过程来研究机器学习音乐生成，这是一个许多人认为超出机器范围的领域(也是另一个激烈辩论的有趣领域！).</p><h1 id="0cea" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">内容</h1><ul class=""><li id="3b8e" class="ms mt jg lg b lh mu lk mv ln mw lr mx lv my lz mz na nb nc bi translated">机器学习模型的音乐表示</li><li id="2475" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">音乐数据集</li><li id="0d0d" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">数据处理</li><li id="1aff" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">型号选择</li><li id="340c" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">多-多RNN</li><li id="d9bc" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">时间分布密集层</li><li id="484c" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">宏伟威严的</li><li id="289b" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">脱落层</li><li id="5835" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">Softmax层</li><li id="cb3b" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">【计算机】优化程序</li><li id="b81c" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">音乐的一代</li><li id="bbcf" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">摘要</li></ul><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><h1 id="e5ef" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">机器学习模型的音乐表示</h1><p id="8921" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">我们将使用ABC乐谱。ABC符号是一种简写形式的音乐符号，它使用字母A到G来表示音符，并使用其他元素来放置附加值。这些附加值包括升半音、降半音、音符长度、调和装饰音。</p><p id="1c70" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这种形式的符号最初是一种ASCII字符集代码，用于促进在线音乐共享，为软件开发人员增加了一种新的简单语言，旨在方便使用。图1是音乐的ABC符号的快照。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nq"><img src="../Images/50d23a9c1a495ac182129ef6a8b8d6ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wrM0VihCLA6vWCWk.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">音乐的ABC符号的插图(来源，由作者编辑)</p></figure><p id="847c" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">乐谱第一部分的线条显示了一个字母后跟一个冒号。这些指示曲调的各个方面，例如索引，当文件中有多个曲调时(X:)，标题(T:)，拍号(M:)，默认音符长度(L:)，曲调类型(R:)和音调(K:)。按键符号后面的线条代表曲调本身。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><h1 id="5b24" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">音乐数据集</h1><p id="8dd5" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">在本文中，我们将使用诺丁汉音乐数据库的<a class="ae jd" href="http://abc.sourceforge.net/NMD/" rel="noopener ugc nofollow" target="_blank"> ABC版本上可用的开源数据。它包含了1000多首民间曲调，其中绝大多数都被转换成ABC记谱法。</a></p><h1 id="3c7e" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">数据处理</h1><p id="782c" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">数据目前是基于字符的分类格式。在数据处理阶段，我们需要将数据转换为基于整数的数字格式，为使用神经网络做准备。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e05230441568754d582372832a0d588e.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/0*GmymwDQojs8bDUB3.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">数据处理概述(图片由作者创建)</p></figure><p id="8323" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里每个字符被映射到一个唯一的整数。这可以通过使用一行代码来实现。“文本”变量是输入数据。</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="404a" class="nx mb jg nt b gy ny nz l oa ob">char_to_idx = { ch: i for (i, ch) in enumerate(sorted(list(set(text)))) }</span></pre><p id="df59" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">为了训练该模型，我们使用vocab将整个文本数据转换成数字格式。</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="e150" class="nx mb jg nt b gy ny nz l oa ob">T = np.asarray([char_to_idx[c] for c in text], dtype=np.int32)</span></pre><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><h1 id="ae8f" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">机器学习音乐生成的模型选择</h1><p id="37c5" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">在传统的机器学习模型中，我们无法存储模型的先前阶段。但是，我们可以用<a class="ae jd" href="https://lionbridge.ai/articles/difference-between-cnn-and-rnn/" rel="noopener ugc nofollow" target="_blank">递归神经网络</a>(俗称RNN)存储之前的阶段。</p><p id="ddb5" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">RNN有一个重复模块，它接收前一级的输入，并将其输出作为下一级的输入。然而，RNNs只能保留最近阶段的信息，因此我们的网络需要更多的内存来学习长期依赖关系。这就是长短期记忆网络(LSTMs)的救援之处。</p><p id="27a4" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">LSTMs是RNNs的特例，具有与RNNs相同的链状结构，但具有不同的重复模块结构。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/5113d3dcab0818be4f052fbbf01d5462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hYUsBx1Umu71Fy0o.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">LSTM结构概述(图片由作者创建)</p></figure><p id="ffa5" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这里使用RNN是因为:</p><ol class=""><li id="3b23" class="ms mt jg lg b lh li lk ll ln od lr oe lv of lz og na nb nc bi translated">数据的长度不需要固定。对于每个输入，数据长度可能不同。</li><li id="2d00" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz og na nb nc bi translated">存储顺序记忆。</li><li id="7544" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz og na nb nc bi translated">可以使用输入和输出序列长度的各种组合。</li></ol><p id="4c5d" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">除了一般的RNN，我们将通过添加一些调整来定制它以适应我们的用例。我们将使用一个“字符RNN”。在字符RNNs中，输入、输出和转换输出都是以字符的形式出现的。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3ccd174095b4fb7e4113bed26d6f817d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/0*hKzLeKDYrMEkWGr3.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">人物RNN概述(作者创造的形象)</p></figure><h1 id="6bdb" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">多-多RNN</h1><p id="4bbb" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">因为我们需要在每个时间戳生成输出，所以我们将使用多对多RNN。为了实现多对多RNN，我们需要将参数' return_sequences '设置为true，以便在每个时间戳生成每个字符。您可以通过查看下面的图5来更好地理解它。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/9c6dc3f3baafe565e2115f76857d43e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/0*Q_byJrLS1OsuHnT4.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">多对多RNN概览(图片由作者创建)</p></figure><p id="b515" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在上图中，蓝色单元是输入单元，黄色单元是隐藏单元，绿色单元是输出单元。这是一个多对多RNN的简单概述。为了更详细地了解RNN序列，这里有一个<a class="ae jd" href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/" rel="noopener ugc nofollow" target="_blank">有用的资源</a>。</p><h1 id="0a61" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">时间分布密集层</h1><p id="8013" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">为了处理每个时间戳的输出，我们创建了一个时间分布的密集层。为了实现这一点，我们在每个时间戳生成的输出之上创建了一个时间分布的密集层。</p><h1 id="82c5" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">宏伟威严的</h1><p id="8999" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">通过将参数stateful设置为true，批处理的输出将作为输入传递给下一个批处理。在组合了所有的特性之后，我们的模型将看起来像下面图6中描绘的概述。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/83ec3aed9050f753fbafecee914d5d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uyi9kt68bhnanpVk.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">了解有状态RNN(图片由作者创建)</p></figure><p id="a483" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">模型架构的代码片段如下:</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="a606" class="nx mb jg nt b gy ny nz l oa ob">model = Sequential()<br/>model.add(Embedding(vocab_size, 512, batch_input_shape=(BATCH_SIZE, SEQ_LENGTH)))</span><span id="7266" class="nx mb jg nt b gy ok nz l oa ob">for i in range(3):</span><span id="7042" class="nx mb jg nt b gy ok nz l oa ob">     model.add(LSTM(256, return_sequences=True, stateful=True))<br/>     model.add(Dropout(0.2))</span><span id="2ea7" class="nx mb jg nt b gy ok nz l oa ob">model.add(TimeDistributed(Dense(vocab_size)))<br/>model.add(Activation('softmax'))</span><span id="fe80" class="nx mb jg nt b gy ok nz l oa ob">model.summary()<br/>model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])</span></pre><p id="fbe3" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我强烈建议尝试使用这些层来提高性能。</p><h1 id="5305" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">脱落层</h1><p id="a82c" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">丢弃层是一种正则化技术，在训练过程中的每次更新中，它将输入单元的一部分归零，以防止过度拟合。该分数由该层使用的参数决定。</p><h1 id="c648" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">Softmax层</h1><p id="b985" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">音乐的生成是一个多类分类问题，其中每个类都是来自输入数据的唯一字符。因此，我们在模型上使用softmax层，并使用分类交叉熵作为损失函数。</p><p id="22fe" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">这一层给出了每一类的概率。从概率列表中，我们选择概率最大的一个。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/dd5dcf2dfac5b2a76432d7a2b3d25376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*TY6mWcX1M2Q-mwKz.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">了解Softmax图层的输出(由作者创建的图像)</p></figure><h1 id="92bb" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">【计算机】优化程序</h1><p id="f015" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">为了优化我们的模型，我们使用自适应矩估计，也称为亚当，因为它是一个非常好的选择RNN。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi om"><img src="../Images/32f25e7b92940473bc1d03e1ca64af2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*oZJq0M9PFPabdACC.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">创建的训练模型概述(图片由作者创建)</p></figure><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><h1 id="83c3" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">创作音乐</h1><p id="ed58" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">到目前为止，我们创建了一个RNN模型，并根据我们的输入数据对其进行了训练。该模型在训练阶段学习输入数据的模式。让我们称这个模型为“训练模型”。</p><p id="06d5" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">训练模型中使用的输入大小是批量大小。并且对于通过机器学习生成音乐，输入大小是单个字符。因此，我们创建了一个新的模型，它类似于已训练的模型，但是单个字符的输入大小为(1，1)。对于这个新模型，我们从已训练的模型加载权重，以复制已训练的模型的特征。</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="f0eb" class="nx mb jg nt b gy ny nz l oa ob">model2 = Sequential()</span><span id="00ad" class="nx mb jg nt b gy ok nz l oa ob">model2.add(Embedding(vocab_size, 512, batch_input_shape=(1,1)))</span><span id="2813" class="nx mb jg nt b gy ok nz l oa ob">for i in range(3): <br/>     model2.add(LSTM(256, return_sequences=True, stateful=True))<br/>     model2.add(Dropout(0.2))</span><span id="1eb4" class="nx mb jg nt b gy ok nz l oa ob">model2.add(TimeDistributed(Dense(vocab_size)))<br/>model2.add(Activation(‘softmax’))</span></pre><p id="87c9" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们将已训练模型的权重加载到新模型中。这可以通过使用一行代码来实现。</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="112a" class="nx mb jg nt b gy ny nz l oa ob">model2.load_weights(os.path.join(MODEL_DIR,‘weights.100.h5’.format(epoch)))</span><span id="425d" class="nx mb jg nt b gy ok nz l oa ob">model2.summary()</span></pre><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi on"><img src="../Images/2a8669cd4d709ec449f3c6707faeabf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*dLtmyulRd97kTL3P.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">生成的音乐模型概述(由作者创建的图像)</p></figure><p id="6d15" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">在音乐生成的过程中，从唯一的字符集中随机选择第一个字符，使用先前生成的字符生成下一个字符，依此类推。有了这个结构，我们就产生了音乐。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oo"><img src="../Images/f84033c9af9766dff0e2c987608d7b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W2wjwYziUviXnz5W.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">生成的音乐流程概述(由作者创建的图像)</p></figure><p id="9abd" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">下面是帮助我们实现这一目标的代码片段。</p><pre class="nj nk nl nm gt ns nt nu nv aw nw bi"><span id="20cb" class="nx mb jg nt b gy ny nz l oa ob">sampled = []</span><span id="1b39" class="nx mb jg nt b gy ok nz l oa ob">for i in range(1024):</span><span id="44ce" class="nx mb jg nt b gy ok nz l oa ob">   batch = np.zeros((1, 1))</span><span id="de42" class="nx mb jg nt b gy ok nz l oa ob">   if sampled:</span><span id="d6e0" class="nx mb jg nt b gy ok nz l oa ob">      batch[0, 0] = sampled[-1]</span><span id="5533" class="nx mb jg nt b gy ok nz l oa ob">   else:</span><span id="caee" class="nx mb jg nt b gy ok nz l oa ob">      batch[0, 0] = np.random.randint(vocab_size)</span><span id="ecec" class="nx mb jg nt b gy ok nz l oa ob">   result = model2.predict_on_batch(batch).ravel()</span><span id="e7ab" class="nx mb jg nt b gy ok nz l oa ob">   sample = np.random.choice(range(vocab_size), p=result)</span><span id="fff2" class="nx mb jg nt b gy ok nz l oa ob">   sampled.append(sample)</span><span id="52bd" class="nx mb jg nt b gy ok nz l oa ob">print("sampled")</span><span id="ec4c" class="nx mb jg nt b gy ok nz l oa ob">print(sampled)</span><span id="29fe" class="nx mb jg nt b gy ok nz l oa ob">print(''.join(idx_to_char[c] for c in sampled))</span></pre><p id="e05f" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">以下是一些生成的音乐片段:</p><figure class="nj nk nl nm gt is"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="nj nk nl nm gt is"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="nj nk nl nm gt is"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="nj nk nl nm gt is"><div class="bz fp l di"><div class="op oq l"/></div></figure><figure class="nj nk nl nm gt is"><div class="bz fp l di"><div class="op oq l"/></div></figure><p id="6308" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我们使用被称为LSTMs的机器学习神经网络生成了这些令人愉快的音乐样本。对于每一代，模式将不同，但与训练数据相似。这些旋律可用于多种用途:</p><ul class=""><li id="949b" class="ms mt jg lg b lh li lk ll ln od lr oe lv of lz mz na nb nc bi translated">通过灵感增强艺术家的创造力</li><li id="ece6" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">作为开发新想法的生产力工具</li><li id="1c87" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">作为艺术家作品的附加曲调</li><li id="005c" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">完成一件未完成的工作</li><li id="6fc3" class="ms mt jg lg b lh nd lk ne ln nf lr ng lv nh lz mz na nb nc bi translated">作为一首独立的音乐</li></ul><p id="6fad" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">但是，这个模型仍然可以改进。我们的训练数据只包含一种乐器，钢琴。我们可以增强训练数据的一种方法是添加来自多种乐器的音乐。另一个方法是增加音乐的类型、节奏和节拍。</p><p id="494b" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">目前，我们的模型产生一些假音符，音乐也不例外。我们可以减少这些错误，并通过增加我们的训练数据集来提高我们的音乐质量，如上所述。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><h1 id="8d34" class="ma mb jg bd mc md me mf mg mh mi mj mk kv ml kw mm ky mn kz mo lb mp lc mq mr bi translated">摘要</h1><p id="96b0" class="pw-post-body-paragraph le lf jg lg b lh mu kq lj lk mv kt lm ln nn lp lq lr no lt lu lv np lx ly lz ij bi translated">在这篇文章中，我们研究了如何处理音乐以用于神经网络，RNN和LSTMs等深度学习模型的深入工作，我们还探索了调整模型如何导致音乐生成。我们可以将这些概念应用到任何其他生成其他艺术形式的系统中，包括生成风景画或人类肖像。</p><figure class="nj nk nl nm gt is gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85ae43ab2bc681c76ea69fc1b64ac999.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*XNAW-HhJKgddajOM9ql7QQ.png"/></div></figure><p id="33f2" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">感谢阅读！本文原帖<a class="ae jd" href="https://lionbridge.ai/articles/machine-learning-music-generation-through-deep-neural-networks/" rel="noopener ugc nofollow" target="_blank">此处</a>。如果你想自己试验这个自定义数据集，你可以在这里下载<a class="ae jd" href="http://abc.sourceforge.net/NMD/" rel="noopener ugc nofollow" target="_blank">带注释的数据</a>，在<a class="ae jd" href="https://github.com/RamyaVidiyala/Generate-Music-Using-Neural-Networks" rel="noopener ugc nofollow" target="_blank"> Github </a>查看我的代码。</p><p id="d6f9" class="pw-post-body-paragraph le lf jg lg b lh li kq lj lk ll kt lm ln lo lp lq lr ls lt lu lv lw lx ly lz ij bi translated">我也将在未来写更多初学者友好的帖子。请在<a class="ae jd" href="https://medium.com/@ramyavidiyala" rel="noopener">媒体</a>上关注我，以便了解他们。我欢迎反馈，可以通过Twitter <a class="ae jd" href="https://twitter.com/ramya_vidiyala" rel="noopener ugc nofollow" target="_blank"> ramya_vidiyala </a>和LinkedIn <a class="ae jd" href="https://www.linkedin.com/in/ramya-vidiyala-308ba6139/" rel="noopener ugc nofollow" target="_blank"> RamyaVidiyala </a>联系。快乐学习！</p></div></div>    
</body>
</html>