<html>
<head>
<title>A Complete Recommendation System Algorithm Using Python’s Scikit-Learn Library: Step by Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的Scikit-Learn库的完整推荐系统算法:分步指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-complete-recommendation-system-algorithm-using-pythons-scikit-learn-library-step-by-step-guide-9d563c4db6b2?source=collection_archive---------34-----------------------#2020-10-23">https://towardsdatascience.com/a-complete-recommendation-system-algorithm-using-pythons-scikit-learn-library-step-by-step-guide-9d563c4db6b2?source=collection_archive---------34-----------------------#2020-10-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6adaaf1b26d70484cbe978315c70ff63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z6z2GUSlxOinHEGF"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">罗伯特·祖尼科夫在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="75cf" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">一个简单而有用的算法，只有几行代码</h2></div><p id="11fc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">推荐系统的开发可以是自然语言处理(NLP)中的常见任务。YouTube或网飞使用类似的技术向他们的客户推荐。他们分析客户以前的行为，并在此基础上为他们推荐类似的材料。在本文中，我将讨论如何使用python中的scikit-learn库开发一个电影推荐模型。它涉及许多复杂的数学。但是scikit-learn库有一些很棒的内置函数，可以处理大部分繁重的工作。随着练习的进行，我将解释如何使用这些函数及其工作。</p><h1 id="0141" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">数据集概述</h1><p id="371d" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在这个练习中，我将使用一个电影数据集。我在这一页的底部给出了数据集的链接。请随意下载数据集，并在笔记本上运行所有代码，以便更好地理解。以下是数据集的链接:</p><div class="is it gp gr iu mr"><a href="https://github.com/rashida048/Some-NLP-Projects/blob/master/movie_dataset.csv" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">rashida 048/Some-NLP-项目</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">github.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf ja mr"/></div></div></a></div><p id="0b6b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是电影推荐模型的逐步实现:</p><ol class=""><li id="653a" class="ng nh jj la b lb lc le lf lh ni ll nj lp nk lt nl nm nn no bi translated">导入包和数据集。</li></ol><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="81f4" class="ny lv jj nu b gy nz oa l ob oc">from sklearn.metrics.pairwise import cosine_similarity<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>from sklearn.metrics.pairwise import cosine_similarity</span><span id="c13f" class="ny lv jj nu b gy od oa l ob oc">df = pd.read_csv("movie_dataset.csv")</span></pre><p id="d803" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.数据集太大。因此，我不能在这里显示截图。以下是数据集的列。它们不言自明。列名会告诉你里面的内容是什么。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="3964" class="ny lv jj nu b gy nz oa l ob oc">df.columns</span><span id="8fb9" class="ny lv jj nu b gy od oa l ob oc">#Output:<br/>Index(['index', 'budget', 'genres', 'homepage', 'id', 'keywords',        'original_language', 'original_title', 'overview', 'popularity',        'production_companies', 'production_countries', 'release_date',        'revenue', 'runtime', 'spoken_languages', 'status', 'tagline', 'title',        'vote_average', 'vote_count', 'cast', 'crew', 'director'],       dtype='object')</span></pre><p id="d33a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.选择要用于模型的特征。我们不需要使用所有的功能。有些不适合这个模型。我选择这四个特征:</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="9699" class="ny lv jj nu b gy nz oa l ob oc">features = ['keywords','cast','genres','director']</span></pre><p id="2eb2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请随意为实验添加更多功能或不同的功能。现在，将这些特征组合起来，用这四列组成一列。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="e85a" class="ny lv jj nu b gy nz oa l ob oc"><strong class="nu jk">def</strong> combine_features(row):<br/>    <strong class="nu jk">return</strong> row['keywords']+" "+row['cast']+" "+row['genres']+" "+row['director']</span></pre><p id="73fa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">4.如果我们有空值，这可能会在算法中产生问题。用空字符串填充空值。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="4d50" class="ny lv jj nu b gy nz oa l ob oc">for feature in features:<br/>    df[feature] = df[feature].fillna('')<br/>df["combined_features"] = df.apply(combine_features,axis=1)</span></pre><p id="aa33" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">5.将数据拟合并转换到“计数矢量器”函数中，为矢量表示准备数据。当您通过“计数矢量器”函数传递文本数据时，它会返回每个单词的计数矩阵。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="a070" class="ny lv jj nu b gy nz oa l ob oc">cv = CountVectorizer() <br/>count_matrix = cv.fit_transform(df["combined_features"])</span></pre><p id="64ca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">6.使用“余弦相似度”来查找相似度。这是一种寻找相似性的动态方法，该方法测量多维空间中两个向量之间的余弦角。这样，文档的大小就无关紧要了。这些文档可能相距很远，但它们的余弦角可能相似。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="0092" class="ny lv jj nu b gy nz oa l ob oc">cosine_sim = cosine_similarity(count_matrix)</span></pre><p id="7b41" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个“余弦_sim”是一个二维矩阵，它是一个系数矩阵。我不打算在这里详细解释余弦相似性，因为这超出了本文的范围。我想展示，如何使用它。</p><p id="124a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">7.我们需要定义两个函数。其中一个函数从索引中返回标题，另一个函数从标题中返回索引。我们将很快使用这两个功能。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="66ff" class="ny lv jj nu b gy nz oa l ob oc">def find_title_from_index(index):<br/>    return df[df.index == index]["title"].values[0]<br/>def find_index_from_title(title):<br/>    return df[df.title == title]["index"].values[0]</span></pre><p id="0bbe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">8.拍一部我们用户喜欢的电影。就拿《星球大战》来说吧。然后用上面的函数找到这部电影的索引。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="8528" class="ny lv jj nu b gy nz oa l ob oc">movie = "Star Wars"<br/>movie_index = find_index_from_title(movie)</span></pre><p id="a3f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">《星球大战》的指数是2912。正如我前面提到的，步骤6中的“余弦_sim”是相似性系数的矩阵。该矩阵的行2912应该提供所有具有“星球大战”的电影的相似性系数。所以，找到矩阵‘余弦_ sim’的第2912行。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="ef54" class="ny lv jj nu b gy nz oa l ob oc">similar_movies = list(enumerate(cosine_sim[movie_index]))</span></pre><p id="149f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我使用枚举来获取索引和系数。‘similar _ movies’是包含索引和系数的元组列表。我喜欢在python中使用“枚举”。很多时候它会派上用场。</p><p id="fd6c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">9.按照系数的逆序对列表“相似电影”进行排序。这样，最高的系数将在顶部。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="8a7e" class="ny lv jj nu b gy nz oa l ob oc">sorted_similar_movies = sorted(similar_movies,key=lambda x:x[1],reverse=True)[1:]</span></pre><p id="3f54" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们没有从列表中选择第一部，因为列表中的第一部将是《星球大战》本身。</p><p id="1ea5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">10.使用函数“find_title_from_index”获得与“星球大战”相似的前五部电影。</p><pre class="np nq nr ns gt nt nu nv nw aw nx bi"><span id="3942" class="ny lv jj nu b gy nz oa l ob oc">i=0<br/>for element in sorted_similar_movies:<br/>    print(find_title_from_index(element[0]))<br/>    i=i+1<br/>    if i&gt;5:<br/>        break</span></pre><p id="ecd8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">与《星球大战》最相似的五部电影是:</p><p id="b548" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">帝国反击战</p><p id="64b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">绝地归来</p><p id="1e5c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">星球大战:第二集——克隆人的进攻</p><p id="f7a9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">星球大战:第三集——西斯的复仇</p><p id="7229" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">星球大战:第一集——幽灵的威胁</p><p id="1aa8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">螺旋…加载</p><p id="1135" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有道理，对吧？这就是电影推荐模型。如果你有任何问题，请随时问我。这是我在本教程中使用的数据集。</p><h2 id="1b0b" class="ny lv jj bd lw oe of dn ma og oh dp me lh oi oj mg ll ok ol mi lp om on mk oo bi translated">结论</h2><p id="cb9d" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">这个推荐系统非常简单，但是很有用。这种类型的推荐系统在许多现实场景中都很有用。希望你能善用它。</p><h2 id="112a" class="ny lv jj bd lw oe of dn ma og oh dp me lh oi oj mg ll ok ol mi lp om on mk oo bi translated">更多阅读:</h2><div class="is it gp gr iu mr"><a rel="noopener follow" target="_blank" href="/a-complete-anomaly-detection-algorithm-from-scratch-in-python-step-by-step-guide-e1daf870336e"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">Python中从头开始的完整异常检测算法:分步指南</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">基于概率的异常检测算法</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="op l nc nd ne na nf ja mr"/></div></div></a></div><div class="is it gp gr iu mr"><a rel="noopener follow" target="_blank" href="/a-complete-k-mean-clustering-algorithm-from-scratch-in-python-step-by-step-guide-1eb05cdcd461"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">Python中从头开始的完整K均值聚类算法:分步指南</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">还有，如何使用K均值聚类算法对图像进行降维</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="oq l nc nd ne na nf ja mr"/></div></div></a></div><div class="is it gp gr iu mr"><a rel="noopener follow" target="_blank" href="/best-free-courses-for-computer-science-software-engineering-and-data-science-50cd88cafd74"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">编程、软件工程和数据科学的最佳免费课程</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">麻省理工、哈佛和斯坦福等顶尖大学的免费课程</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="or l nc nd ne na nf ja mr"/></div></div></a></div><div class="is it gp gr iu mr"><a rel="noopener follow" target="_blank" href="/how-to-present-the-relationships-amongst-multiple-variables-in-python-70f1b5693f5"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">如何在Python中呈现多个变量之间的关系</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">了解如何使用Python中的多元图表和绘图来呈现要素之间的关系</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="os l nc nd ne na nf ja mr"/></div></div></a></div><div class="is it gp gr iu mr"><a rel="noopener follow" target="_blank" href="/logistic-regression-model-fitting-and-finding-the-correlation-p-value-z-score-confidence-8330fb86db19"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd jk gy z fp mw fr fs mx fu fw ji bi translated">逻辑回归模型拟合和寻找相关性，P值，Z值，置信度…</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">静态模型拟合和提取的结果从拟合模型使用Python的Statsmodels库与…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">towardsdatascience.com</p></div></div><div class="na l"><div class="ot l nc nd ne na nf ja mr"/></div></div></a></div></div></div>    
</body>
</html>